!function(){var requirejs,require,define,PVg,QVg,ZBl,$Bl;!function(p){var o,a,f,m,g={},_={},v={},y={},r=Object.prototype.hasOwnProperty,i=[].slice,b=/\.js$/;function C(e,t){return r.call(e,t)}function s(e,t){var r,i,n,o,a,s,l,u,c,d,h,p=t&&t.split("/"),f=v.map,m=f&&f["*"]||{};if(e){for(a=(e=e.split("/")).length-1,v.nodeIdCompat&&b.test(e[a])&&(e[a]=e[a].replace(b,"")),"."===e[0].charAt(0)&&p&&(e=p.slice(0,p.length-1).concat(e)),c=0;c<e.length;c++)if("."===(h=e[c]))e.splice(c,1),c-=1;else if(".."===h){if(0===c||1===c&&".."===e[2]||".."===e[c-1])continue;0<c&&(e.splice(c-1,2),c-=2)}e=e.join("/")}if((p||m)&&f){for(c=(r=e.split("/")).length;0<c;c-=1){if(i=r.slice(0,c).join("/"),p)for(d=p.length;0<d;d-=1)if((n=f[p.slice(0,d).join("/")])&&(n=n[i])){o=n,s=c;break}if(o)break;!l&&m&&m[i]&&(l=m[i],u=c)}!o&&l&&(o=l,s=u),o&&(r.splice(0,s,o),e=r.join("/"))}return e}function w(t,r){return function(){var e=i.call(arguments,0);return"string"!=typeof e[0]&&1===e.length&&e.push(null),a.apply(p,e.concat([t,r]))}}function S(t){return function(e){g[t]=e}}function T(e){if(C(_,e)){var t=_[e];delete _[e],y[e]=!0,o.apply(p,t)}if(!C(g,e)&&!C(y,e))throw new Error("No "+e);return g[e]}function l(e){var t,r=e?e.indexOf("!"):-1;return-1<r&&(t=e.substring(0,r),e=e.substring(r+1,e.length)),[t,e]}function E(e){return e?l(e):[]}f=function(e,t){var r,i,n=l(e),o=n[0],a=t[1];return e=n[1],o&&(r=T(o=s(o,a))),o?e=r&&r.normalize?r.normalize(e,(i=a,function(e){return s(e,i)})):s(e,a):(o=(n=l(e=s(e,a)))[0],e=n[1],o&&(r=T(o))),{f:o?o+"!"+e:e,n:e,pr:o,p:r}},m={require:function(e){return w(e)},exports:function(e){var t=g[e];return void 0!==t?t:g[e]={}},module:function(e){return{id:e,uri:"",exports:g[e],config:(t=e,function(){return v&&v.config&&v.config[t]||{}})};var t}},o=function(e,t,r,i){var n,o,a,s,l,u,c,d=[],h=typeof r;if(u=E(i=i||e),"undefined"===h||"function"===h){for(t=!t.length&&r.length?["require","exports","module"]:t,l=0;l<t.length;l+=1)if("require"===(o=(s=f(t[l],u)).f))d[l]=m.require(e);else if("exports"===o)d[l]=m.exports(e),c=!0;else if("module"===o)n=d[l]=m.module(e);else if(C(g,o)||C(_,o)||C(y,o))d[l]=T(o);else{if(!s.p)throw new Error(e+" missing "+o);s.p.load(s.n,w(i,!0),S(o),{}),d[l]=g[o]}a=r?r.apply(g[e],d):void 0,e&&(n&&n.exports!==p&&n.exports!==g[e]?g[e]=n.exports:a===p&&c||(g[e]=a))}else e&&(g[e]=r)},requirejs=require=a=function(e,t,r,i,n){if("string"==typeof e)return m[e]?m[e](t):T(f(e,E(t)).f);if(!e.splice){if((v=e).deps&&a(v.deps,v.callback),!t)return;t.splice?(e=t,t=r,r=null):e=p}return t=t||function(){},"function"==typeof r&&(r=i,i=n),i?o(p,e,t,r):setTimeout(function(){o(p,e,t,r)},4),a},a.config=function(e){return a(e)},requirejs._defined=g,(define=function(e,t,r){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(r=t,t=[]),C(g,e)||C(_,e)||(_[e]=[e,t,r])}).amd={jQuery:!0}}(),define("Core/appendForwardSlash",[],function(){"use strict";return function(e){return 0!==e.length&&"/"===e[e.length-1]||(e+="/"),e}}),define("Core/defined",[],function(){"use strict";return function(e){return null!=e}}),define("Core/DeveloperError",["./defined"],function(t){"use strict";function e(e){var t;this.name="DeveloperError",this.message=e;try{throw new Error}catch(e){t=e.stack}this.stack=t}return t(Object.create)&&((e.prototype=Object.create(Error.prototype)).constructor=e),e.prototype.toString=function(){var e=this.name+": "+this.message;return t(this.stack)&&(e+="\n"+this.stack.toString()),e},e.throwInstantiationError=function(){throw new e("This function defines an interface and should not be called directly.")},e}),define("Core/Check",["./defined","./DeveloperError"],function(r,n){"use strict";var o={};function i(e,t,r){return"Expected "+r+" to be typeof "+t+", actual typeof was "+e}return o.typeOf={},o.defined=function(e,t){if(!r(t))throw new n(e+" is required, actual value was undefined")},o.typeOf.func=function(e,t){if("function"!=typeof t)throw new n(i(typeof t,"function",e))},o.typeOf.string=function(e,t){if("string"!=typeof t)throw new n(i(typeof t,"string",e))},o.typeOf.number=function(e,t){if("number"!=typeof t)throw new n(i(typeof t,"number",e))},o.typeOf.number.lessThan=function(e,t,r){if(o.typeOf.number(e,t),r<=t)throw new n("Expected "+e+" to be less than "+r+", actual value was "+t)},o.typeOf.number.lessThanOrEquals=function(e,t,r){if(o.typeOf.number(e,t),r<t)throw new n("Expected "+e+" to be less than or equal to "+r+", actual value was "+t)},o.typeOf.number.greaterThan=function(e,t,r){if(o.typeOf.number(e,t),t<=r)throw new n("Expected "+e+" to be greater than "+r+", actual value was "+t)},o.typeOf.number.greaterThanOrEquals=function(e,t,r){if(o.typeOf.number(e,t),t<r)throw new n("Expected "+e+" to be greater than or equal to"+r+", actual value was "+t)},o.typeOf.object=function(e,t){if("object"!=typeof t)throw new n(i(typeof t,"object",e))},o.typeOf.bool=function(e,t){if("boolean"!=typeof t)throw new n(i(typeof t,"boolean",e))},o.typeOf.number.equals=function(e,t,r,i){if(o.typeOf.number(e,r),o.typeOf.number(t,i),r!==i)throw new n(e+" must be equal to "+t+", the actual values are "+r+" and "+i)},o}),define("Core/freezeObject",["./defined"],function(e){"use strict";var t=Object.freeze;return e(t)||(t=function(e){return e}),t}),define("Core/defaultValue",["./freezeObject"],function(e){"use strict";function t(e,t){return null!=e?e:t}return t.EMPTY_OBJECT=e({}),t}),define("Core/arrayFill",["./Check","./defaultValue","./defined"],function(u,c,d){"use strict";return function(e,t,r,i){if(u.defined("array",e),u.defined("value",t),d(r)&&u.typeOf.number("start",r),d(i)&&u.typeOf.number("end",i),"function"==typeof e.fill)return e.fill(t,r,i);for(var n=e.length>>>0,o=c(r,0),a=o<0?Math.max(n+o,0):Math.min(o,n),s=c(i,n),l=s<0?Math.max(n+s,0):Math.min(s,n);a<l;)e[a]=t,a++;return e}}),define("ThirdParty/mersenne-twister",[],function(){var e=function(e){null==e&&(e=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,this.init_genrand(e)};return e.prototype.init_genrand=function(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<this.N;this.mti++){e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&e)>>>16)<<16)+1812433253*(65535&e)+this.mti,this.mt[this.mti]>>>=0}},e.prototype.genrand_int32=function(){var e,t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var r;for(this.mti==this.N+1&&this.init_genrand(5489),r=0;r<this.N-this.M;r++)e=this.mt[r]&this.UPPER_MASK|this.mt[r+1]&this.LOWER_MASK,this.mt[r]=this.mt[r+this.M]^e>>>1^t[1&e];for(;r<this.N-1;r++)e=this.mt[r]&this.UPPER_MASK|this.mt[r+1]&this.LOWER_MASK,this.mt[r]=this.mt[r+(this.M-this.N)]^e>>>1^t[1&e];e=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^e>>>1^t[1&e],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,(e^=e>>>18)>>>0},e.prototype.random=function(){return this.genrand_int32()*(1/4294967296)},e}),define("Core/Math",["../ThirdParty/mersenne-twister","./defaultValue","./defined","./DeveloperError"],function(t,o,a,s){"use strict";var i={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,GRAVITATIONALPARAMETER:3986004418e5,SOLAR_RADIUS:6955e5,LUNAR_RADIUS:1737400,SIXTY_FOUR_KILOBYTES:65536,sign:function(e){return 0<e?1:e<0?-1:0},signNotZero:function(e){return e<0?-1:1},toSNorm:function(e,t){return t=o(t,255),Math.round((.5*i.clamp(e,-1,1)+.5)*t)},fromSNorm:function(e,t){return t=o(t,255),i.clamp(e,0,t)/t*2-1},sinh:function(e){return.5*(Math.pow(Math.E,e)-Math.pow(Math.E,-1*e))},cosh:function(e){return.5*(Math.pow(Math.E,e)+Math.pow(Math.E,-1*e))},lerp:function(e,t,r){return(1-r)*e+r*t}};i.PI=Math.PI,i.ONE_OVER_PI=1/Math.PI,i.PI_OVER_TWO=.5*Math.PI,i.PI_OVER_THREE=Math.PI/3,i.PI_OVER_FOUR=Math.PI/4,i.PI_OVER_SIX=Math.PI/6,i.THREE_PI_OVER_TWO=3*Math.PI*.5,i.TWO_PI=2*Math.PI,i.ONE_OVER_TWO_PI=1/(2*Math.PI),i.RADIANS_PER_DEGREE=Math.PI/180,i.DEGREES_PER_RADIAN=180/Math.PI,i.RADIANS_PER_ARCSECOND=i.RADIANS_PER_DEGREE/3600,i.toRadians=function(e){if(!a(e))throw new s("degrees is required.");return e*i.RADIANS_PER_DEGREE},i.toDegrees=function(e){if(!a(e))throw new s("radians is required.");return e*i.DEGREES_PER_RADIAN},i.convertLongitudeRange=function(e){if(!a(e))throw new s("angle is required.");var t=i.TWO_PI,r=e-Math.floor(e/t)*t;return r<-Math.PI?r+t:r>=Math.PI?r-t:r},i.clampToLatitudeRange=function(e){if(!a(e))throw new s("angle is required.");return i.clamp(e,-1*i.PI_OVER_TWO,i.PI_OVER_TWO)},i.negativePiToPi=function(e){if(!a(e))throw new s("angle is required.");return i.zeroToTwoPi(e+i.PI)-i.PI},i.zeroToTwoPi=function(e){if(!a(e))throw new s("angle is required.");var t=i.mod(e,i.TWO_PI);return Math.abs(t)<i.EPSILON14&&Math.abs(e)>i.EPSILON14?i.TWO_PI:t},i.mod=function(e,t){if(!a(e))throw new s("m is required.");if(!a(t))throw new s("n is required.");return(e%t+t)%t},i.equalsEpsilon=function(e,t,r,i){if(!a(e))throw new s("left is required.");if(!a(t))throw new s("right is required.");if(!a(r))throw new s("relativeEpsilon is required.");i=o(i,r);var n=Math.abs(e-t);return n<=i||n<=r*Math.max(Math.abs(e),Math.abs(t))};var n=[1];i.factorial=function(e){if("number"!=typeof e||e<0)throw new s("A number greater than or equal to 0 is required.");var t=n.length;if(t<=e)for(var r=n[t-1],i=t;i<=e;i++)n.push(r*i);return n[e]},i.incrementWrap=function(e,t,r){if(r=o(r,0),!a(e))throw new s("n is required.");if(t<=r)throw new s("maximumValue must be greater than minimumValue.");return t<++e&&(e=r),e},i.isPowerOfTwo=function(e){if("number"!=typeof e||e<0)throw new s("A number greater than or equal to 0 is required.");return 0!==e&&0==(e&e-1)},i.nextPowerOfTwo=function(e){if("number"!=typeof e||e<0)throw new s("A number greater than or equal to 0 is required.");return--e,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},i.clamp=function(e,t,r){if(!a(e))throw new s("value is required");if(!a(t))throw new s("min is required.");if(!a(r))throw new s("max is required.");return e<t?t:r<e?r:e};var r=new t;return i.setRandomNumberSeed=function(e){if(!a(e))throw new s("seed is required.");r=new t(e)},i.nextRandomNumber=function(){return r.random()},i.randomBetween=function(e,t){return i.nextRandomNumber()*(t-e)+e},i.acosClamped=function(e){if(!a(e))throw new s("value is required.");return Math.acos(i.clamp(e,-1,1))},i.asinClamped=function(e){if(!a(e))throw new s("value is required.");return Math.asin(i.clamp(e,-1,1))},i.chordLength=function(e,t){if(!a(e))throw new s("angle is required.");if(!a(t))throw new s("radius is required.");return 2*t*Math.sin(.5*e)},i.logBase=function(e,t){if(!a(e))throw new s("number is required.");if(!a(t))throw new s("base is required.");return Math.log(e)/Math.log(t)},i.fog=function(e,t){var r=e*t;return 1-Math.exp(-r*r)},i}),define("Core/arrayRemoveDuplicates",["./Check","./defaultValue","./defined","./Math"],function(l,u,c,e){"use strict";var d=e.EPSILON10;return function(e,t,r){if(l.defined("equalsEpsilon",t),c(e)){r=u(r,!1);var i,n,o,a=e.length;if(a<2)return e;for(i=1;i<a&&!t(n=e[i-1],o=e[i],d);++i);if(i===a)return r&&t(e[0],e[e.length-1],d)?e.slice(1):e;for(var s=e.slice(0,i);i<a;++i)t(n,o=e[i],d)||(s.push(o),n=o);return r&&1<s.length&&t(s[0],s[s.length-1],d)&&s.shift(),s}}}),define("Core/defineProperties",["./defined"],function(e){"use strict";var t=function(){try{return"x"in Object.defineProperty({},"x",{})}catch(e){return!1}}(),r=Object.defineProperties;return t&&e(r)||(r=function(e){return e}),r}),define("Core/Fullscreen",["./defined","./defineProperties"],function(a,e){"use strict";var s,l={requestFullscreen:void 0,exitFullscreen:void 0,fullscreenEnabled:void 0,fullscreenElement:void 0,fullscreenchange:void 0,fullscreenerror:void 0},r={};return e(r,{element:{get:function(){if(r.supportsFullscreen())return document[l.fullscreenElement]}},changeEventName:{get:function(){if(r.supportsFullscreen())return l.fullscreenchange}},errorEventName:{get:function(){if(r.supportsFullscreen())return l.fullscreenerror}},enabled:{get:function(){if(r.supportsFullscreen())return document[l.fullscreenEnabled]}},fullscreen:{get:function(){if(r.supportsFullscreen())return null!==r.element}}}),r.supportsFullscreen=function(){if(a(s))return s;s=!1;var e=document.body;if("function"==typeof e.requestFullscreen)return l.requestFullscreen="requestFullscreen",l.exitFullscreen="exitFullscreen",l.fullscreenEnabled="fullscreenEnabled",l.fullscreenElement="fullscreenElement",l.fullscreenchange="fullscreenchange",l.fullscreenerror="fullscreenerror",s=!0;for(var t,r=["webkit","moz","o","ms","khtml"],i=0,n=r.length;i<n;++i){var o=r[i];"function"==typeof e[t=o+"RequestFullscreen"]?(l.requestFullscreen=t,s=!0):"function"==typeof e[t=o+"RequestFullScreen"]&&(l.requestFullscreen=t,s=!0),t=o+"ExitFullscreen","function"==typeof document[t]?l.exitFullscreen=t:(t=o+"CancelFullScreen","function"==typeof document[t]&&(l.exitFullscreen=t)),t=o+"FullscreenEnabled",void 0!==document[t]?l.fullscreenEnabled=t:(t=o+"FullScreenEnabled",void 0!==document[t]&&(l.fullscreenEnabled=t)),t=o+"FullscreenElement",void 0!==document[t]?l.fullscreenElement=t:(t=o+"FullScreenElement",void 0!==document[t]&&(l.fullscreenElement=t)),t=o+"fullscreenchange",void 0!==document["on"+t]&&("ms"===o&&(t="MSFullscreenChange"),l.fullscreenchange=t),t=o+"fullscreenerror",void 0!==document["on"+t]&&("ms"===o&&(t="MSFullscreenError"),l.fullscreenerror=t)}return s},r.requestFullscreen=function(e,t){r.supportsFullscreen()&&e[l.requestFullscreen]({vrDisplay:t})},r.exitFullscreen=function(){r.supportsFullscreen()&&document[l.exitFullscreen]()},r}),define("Core/FeatureDetection",["./defaultValue","./defined","./Fullscreen"],function(e,r,t){"use strict";var i,n,o,a,s,l,u,c,d,h,p,f,m,g,_,v,y;function b(e){for(var t=e.split("."),r=0,i=t.length;r<i;++r)t[r]=parseInt(t[r],10);return t}function C(){if(!r(n)&&(n=!1,!E())){var e=/ Chrome\/([\.0-9]+)/.exec(i.userAgent);null!==e&&(n=!0,o=b(e[1]))}return n}function w(){if(!r(a)&&(a=!1,!C()&&!E()&&/ Safari\/[\.0-9]+/.test(i.userAgent))){var e=/ Version\/([\.0-9]+)/.exec(i.userAgent);null!==e&&(a=!0,s=b(e[1]))}return a}function S(){if(!r(l)){l=!1;var e=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(i.userAgent);null!==e&&(l=!0,(u=b(e[1])).isNightly=!!e[2])}return l}function T(){var e;r(c)||(c=!1,"Microsoft Internet Explorer"===i.appName?null!==(e=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(i.userAgent))&&(c=!0,d=b(e[1])):"Netscape"===i.appName&&null!==(e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(i.userAgent))&&(c=!0,d=b(e[1])));return c}function E(){if(!r(h)){h=!1;var e=/ Edge\/([\.0-9]+)/.exec(i.userAgent);null!==e&&(h=!0,p=b(e[1]))}return h}function A(){if(!r(f)){f=!1;var e=/Firefox\/([\.0-9]+)/.exec(i.userAgent);null!==e&&(f=!0,m=b(e[1]))}return f}function x(){if(!r(y)){var e=document.createElement("canvas");e.setAttribute("style","image-rendering: -moz-crisp-edges;image-rendering: pixelated;");var t=e.style.imageRendering;(y=r(t)&&""!==t)&&(v=t)}return y}var P={isChrome:C,chromeVersion:function(){return C()&&o},isSafari:w,safariVersion:function(){return w()&&s},isWebkit:S,webkitVersion:function(){return S()&&u},isInternetExplorer:T,internetExplorerVersion:function(){return T()&&d},isEdge:E,edgeVersion:function(){return E()&&p},isFirefox:A,firefoxVersion:function(){return A()&&m},isWindows:function(){return r(g)||(g=/Windows/i.test(i.appVersion)),g},hardwareConcurrency:e((i="undefined"!=typeof navigator?navigator:{}).hardwareConcurrency,3),supportsPointerEvents:function(){return r(_)||(_="undefined"!=typeof PointerEvent&&(!r(i.pointerEnabled)||i.pointerEnabled)),_},supportsImageRenderingPixelated:x,imageRenderingValue:function(){return x()?v:void 0},supportsFullscreen:function(){return t.supportsFullscreen()},supportsTypedArrays:function(){return"undefined"!=typeof ArrayBuffer},supportsWebWorkers:function(){return"undefined"!=typeof Worker}};return P}),define("Core/arraySlice",["./Check","./defaultValue","./defined","./FeatureDetection"],function(a,e,s,t){"use strict";var i=function(e,t,r){return a.defined("array",e),s(t)&&a.typeOf.number("begin",t),s(r)&&a.typeOf.number("end",r),e.slice(t,r)};if(t.supportsTypedArrays()&&"function"!=typeof new Uint8Array(1).slice){var l=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];i=function(e,t,r){if(a.defined("array",e),s(t)&&a.typeOf.number("begin",t),s(r)&&a.typeOf.number("end",r),"function"==typeof e.slice)return e.slice(t,r);for(var i=Array.prototype.slice.call(e,t,r),n=l.length,o=0;o<n;++o)if(e instanceof l[o]){i=new l[o](i);break}return i}}return function(e,t,r){return i(e,t,r)}}),define("Core/AssociativeArray",["./defined","./defineProperties","./DeveloperError"],function(n,e,o){"use strict";function t(){this._array=[],this._hash={}}return e(t.prototype,{length:{get:function(){return this._array.length}},values:{get:function(){return this._array}}}),t.prototype.contains=function(e){if("string"!=typeof e&&"number"!=typeof e)throw new o("key is required to be a string or number.");return n(this._hash[e])},t.prototype.set=function(e,t){if("string"!=typeof e&&"number"!=typeof e)throw new o("key is required to be a string or number.");t!==this._hash[e]&&(this.remove(e),this._hash[e]=t,this._array.push(t))},t.prototype.get=function(e){if("string"!=typeof e&&"number"!=typeof e)throw new o("key is required to be a string or number.");return this._hash[e]},t.prototype.remove=function(e){if(n(e)&&"string"!=typeof e&&"number"!=typeof e)throw new o("key is required to be a string or number.");var t=this._hash[e],r=n(t);if(r){var i=this._array;i.splice(i.indexOf(t),1),delete this._hash[e]}return r},t.prototype.removeAll=function(){var e=this._array;0<e.length&&(this._hash={},e.length=0)},t}),define("Core/Cartesian2",["./Check","./defaultValue","./defined","./DeveloperError","./freezeObject","./Math"],function(o,i,a,n,e,s){"use strict";function l(e,t){this.x=i(e,0),this.y=i(t,0)}l.fromElements=function(e,t,r){return a(r)?(r.x=e,r.y=t,r):new l(e,t)},l.fromCartesian3=l.clone=function(e,t){if(a(e))return a(t)?(t.x=e.x,t.y=e.y,t):new l(e.x,e.y)},l.fromCartesian4=l.clone,l.packedLength=2,l.pack=function(e,t,r){return o.typeOf.object("value",e),o.defined("array",t),r=i(r,0),t[r++]=e.x,t[r]=e.y,t},l.unpack=function(e,t,r){return o.defined("array",e),t=i(t,0),a(r)||(r=new l),r.x=e[t++],r.y=e[t],r},l.packArray=function(e,t){o.defined("array",e);var r=e.length;a(t)?t.length=2*r:t=new Array(2*r);for(var i=0;i<r;++i)l.pack(e[i],t,2*i);return t},l.unpackArray=function(e,t){o.defined("array",e);var r=e.length;a(t)?t.length=r/2:t=new Array(r/2);for(var i=0;i<r;i+=2){var n=i/2;t[n]=l.unpack(e,i,t[n])}return t},l.fromArray=l.unpack,l.maximumComponent=function(e){return o.typeOf.object("cartesian",e),Math.max(e.x,e.y)},l.minimumComponent=function(e){return o.typeOf.object("cartesian",e),Math.min(e.x,e.y)},l.minimumByComponent=function(e,t,r){return o.typeOf.object("first",e),o.typeOf.object("second",t),o.typeOf.object("result",r),r.x=Math.min(e.x,t.x),r.y=Math.min(e.y,t.y),r},l.maximumByComponent=function(e,t,r){return o.typeOf.object("first",e),o.typeOf.object("second",t),o.typeOf.object("result",r),r.x=Math.max(e.x,t.x),r.y=Math.max(e.y,t.y),r},l.magnitudeSquared=function(e){return o.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y},l.magnitude=function(e){return Math.sqrt(l.magnitudeSquared(e))};var r=new l;l.distance=function(e,t){return o.typeOf.object("left",e),o.typeOf.object("right",t),l.subtract(e,t,r),l.magnitude(r)},l.distanceSquared=function(e,t){return o.typeOf.object("left",e),o.typeOf.object("right",t),l.subtract(e,t,r),l.magnitudeSquared(r)},l.normalize=function(e,t){o.typeOf.object("cartesian",e),o.typeOf.object("result",t);var r=l.magnitude(e);if(t.x=e.x/r,t.y=e.y/r,isNaN(t.x)||isNaN(t.y))throw new n("normalized result is not a number");return t},l.dot=function(e,t){return o.typeOf.object("left",e),o.typeOf.object("right",t),e.x*t.x+e.y*t.y},l.multiplyComponents=function(e,t,r){return o.typeOf.object("left",e),o.typeOf.object("right",t),o.typeOf.object("result",r),r.x=e.x*t.x,r.y=e.y*t.y,r},l.divideComponents=function(e,t,r){return o.typeOf.object("left",e),o.typeOf.object("right",t),o.typeOf.object("result",r),r.x=e.x/t.x,r.y=e.y/t.y,r},l.add=function(e,t,r){return o.typeOf.object("left",e),o.typeOf.object("right",t),o.typeOf.object("result",r),r.x=e.x+t.x,r.y=e.y+t.y,r},l.subtract=function(e,t,r){return o.typeOf.object("left",e),o.typeOf.object("right",t),o.typeOf.object("result",r),r.x=e.x-t.x,r.y=e.y-t.y,r},l.multiplyByScalar=function(e,t,r){return o.typeOf.object("cartesian",e),o.typeOf.number("scalar",t),o.typeOf.object("result",r),r.x=e.x*t,r.y=e.y*t,r},l.divideByScalar=function(e,t,r){return o.typeOf.object("cartesian",e),o.typeOf.number("scalar",t),o.typeOf.object("result",r),r.x=e.x/t,r.y=e.y/t,r},l.negate=function(e,t){return o.typeOf.object("cartesian",e),o.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t},l.abs=function(e,t){return o.typeOf.object("cartesian",e),o.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t};var u=new l;l.lerp=function(e,t,r,i){return o.typeOf.object("start",e),o.typeOf.object("end",t),o.typeOf.number("t",r),o.typeOf.object("result",i),l.multiplyByScalar(t,r,u),i=l.multiplyByScalar(e,1-r,i),l.add(u,i,i)};var c=new l,d=new l;l.angleBetween=function(e,t){return o.typeOf.object("left",e),o.typeOf.object("right",t),l.normalize(e,c),l.normalize(t,d),s.acosClamped(l.dot(c,d))};var h=new l;return l.mostOrthogonalAxis=function(e,t){o.typeOf.object("cartesian",e),o.typeOf.object("result",t);var r=l.normalize(e,h);return l.abs(r,r),t=r.x<=r.y?l.clone(l.UNIT_X,t):l.clone(l.UNIT_Y,t)},l.equals=function(e,t){return e===t||a(e)&&a(t)&&e.x===t.x&&e.y===t.y},l.equalsArray=function(e,t,r){return e.x===t[r]&&e.y===t[r+1]},l.equalsEpsilon=function(e,t,r,i){return e===t||a(e)&&a(t)&&s.equalsEpsilon(e.x,t.x,r,i)&&s.equalsEpsilon(e.y,t.y,r,i)},l.ZERO=e(new l(0,0)),l.UNIT_X=e(new l(1,0)),l.UNIT_Y=e(new l(0,1)),l.prototype.clone=function(e){return l.clone(this,e)},l.prototype.equals=function(e){return l.equals(this,e)},l.prototype.equalsEpsilon=function(e,t,r){return l.equalsEpsilon(this,e,t,r)},l.prototype.toString=function(){return"("+this.x+", "+this.y+")"},l}),define("Core/Cartesian3",["./Check","./defaultValue","./defined","./DeveloperError","./freezeObject","./Math"],function(h,l,u,c,e,o){"use strict";function d(e,t,r){this.x=l(e,0),this.y=l(t,0),this.z=l(r,0)}d.fromSpherical=function(e,t){h.typeOf.object("spherical",e),u(t)||(t=new d);var r=e.clock,i=e.cone,n=l(e.magnitude,1),o=n*Math.sin(i);return t.x=o*Math.cos(r),t.y=o*Math.sin(r),t.z=n*Math.cos(i),t},d.fromElements=function(e,t,r,i){return u(i)?(i.x=e,i.y=t,i.z=r,i):new d(e,t,r)},d.fromCartesian4=d.clone=function(e,t){if(u(e))return u(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t):new d(e.x,e.y,e.z)},d.packedLength=3,d.pack=function(e,t,r){return h.typeOf.object("value",e),h.defined("array",t),r=l(r,0),t[r++]=e.x,t[r++]=e.y,t[r]=e.z,t},d.unpack=function(e,t,r){return h.defined("array",e),t=l(t,0),u(r)||(r=new d),r.x=e[t++],r.y=e[t++],r.z=e[t],r},d.packArray=function(e,t){h.defined("array",e);var r=e.length;u(t)?t.length=3*r:t=new Array(3*r);for(var i=0;i<r;++i)d.pack(e[i],t,3*i);return t},d.unpackArray=function(e,t){if(h.defined("array",e),h.typeOf.number.greaterThanOrEquals("array.length",e.length,3),e.length%3!=0)throw new c("array length must be a multiple of 3.");var r=e.length;u(t)?t.length=r/3:t=new Array(r/3);for(var i=0;i<r;i+=3){var n=i/3;t[n]=d.unpack(e,i,t[n])}return t},d.fromArray=d.unpack,d.maximumComponent=function(e){return h.typeOf.object("cartesian",e),Math.max(e.x,e.y,e.z)},d.minimumComponent=function(e){return h.typeOf.object("cartesian",e),Math.min(e.x,e.y,e.z)},d.minimumByComponent=function(e,t,r){return h.typeOf.object("first",e),h.typeOf.object("second",t),h.typeOf.object("result",r),r.x=Math.min(e.x,t.x),r.y=Math.min(e.y,t.y),r.z=Math.min(e.z,t.z),r},d.maximumByComponent=function(e,t,r){return h.typeOf.object("first",e),h.typeOf.object("second",t),h.typeOf.object("result",r),r.x=Math.max(e.x,t.x),r.y=Math.max(e.y,t.y),r.z=Math.max(e.z,t.z),r},d.magnitudeSquared=function(e){return h.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y+e.z*e.z},d.magnitude=function(e){return Math.sqrt(d.magnitudeSquared(e))};var r=new d;d.distance=function(e,t){return h.typeOf.object("left",e),h.typeOf.object("right",t),d.subtract(e,t,r),d.magnitude(r)},d.distanceSquared=function(e,t){return h.typeOf.object("left",e),h.typeOf.object("right",t),d.subtract(e,t,r),d.magnitudeSquared(r)},d.normalize=function(e,t){h.typeOf.object("cartesian",e),h.typeOf.object("result",t);var r=d.magnitude(e);if(t.x=e.x/r,t.y=e.y/r,t.z=e.z/r,isNaN(t.x)||isNaN(t.y)||isNaN(t.z))throw new c("normalized result is not a number");return t},d.dot=function(e,t){return h.typeOf.object("left",e),h.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z},d.multiplyComponents=function(e,t,r){return h.typeOf.object("left",e),h.typeOf.object("right",t),h.typeOf.object("result",r),r.x=e.x*t.x,r.y=e.y*t.y,r.z=e.z*t.z,r},d.divideComponents=function(e,t,r){return h.typeOf.object("left",e),h.typeOf.object("right",t),h.typeOf.object("result",r),r.x=e.x/t.x,r.y=e.y/t.y,r.z=e.z/t.z,r},d.add=function(e,t,r){return h.typeOf.object("left",e),h.typeOf.object("right",t),h.typeOf.object("result",r),r.x=e.x+t.x,r.y=e.y+t.y,r.z=e.z+t.z,r},d.subtract=function(e,t,r){return h.typeOf.object("left",e),h.typeOf.object("right",t),h.typeOf.object("result",r),r.x=e.x-t.x,r.y=e.y-t.y,r.z=e.z-t.z,r},d.multiplyByScalar=function(e,t,r){return h.typeOf.object("cartesian",e),h.typeOf.number("scalar",t),h.typeOf.object("result",r),r.x=e.x*t,r.y=e.y*t,r.z=e.z*t,r},d.divideByScalar=function(e,t,r){return h.typeOf.object("cartesian",e),h.typeOf.number("scalar",t),h.typeOf.object("result",r),r.x=e.x/t,r.y=e.y/t,r.z=e.z/t,r},d.negate=function(e,t){return h.typeOf.object("cartesian",e),h.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t},d.abs=function(e,t){return h.typeOf.object("cartesian",e),h.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t};var n=new d;d.lerp=function(e,t,r,i){return h.typeOf.object("start",e),h.typeOf.object("end",t),h.typeOf.number("t",r),h.typeOf.object("result",i),d.multiplyByScalar(t,r,n),i=d.multiplyByScalar(e,1-r,i),d.add(n,i,i)};var a=new d,s=new d;d.angleBetween=function(e,t){h.typeOf.object("left",e),h.typeOf.object("right",t),d.normalize(e,a),d.normalize(t,s);var r=d.dot(a,s),i=d.magnitude(d.cross(a,s,a));return Math.atan2(i,r)};var i=new d;d.mostOrthogonalAxis=function(e,t){h.typeOf.object("cartesian",e),h.typeOf.object("result",t);var r=d.normalize(e,i);return d.abs(r,r),t=r.x<=r.y?r.x<=r.z?d.clone(d.UNIT_X,t):d.clone(d.UNIT_Z,t):r.y<=r.z?d.clone(d.UNIT_Y,t):d.clone(d.UNIT_Z,t)},d.projectVector=function(e,t,r){h.defined("a",e),h.defined("b",t),h.defined("result",r);var i=d.dot(e,t)/d.dot(t,t);return d.multiplyByScalar(t,i,r)},d.equals=function(e,t){return e===t||u(e)&&u(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z},d.equalsArray=function(e,t,r){return e.x===t[r]&&e.y===t[r+1]&&e.z===t[r+2]},d.equalsEpsilon=function(e,t,r,i){return e===t||u(e)&&u(t)&&o.equalsEpsilon(e.x,t.x,r,i)&&o.equalsEpsilon(e.y,t.y,r,i)&&o.equalsEpsilon(e.z,t.z,r,i)},d.cross=function(e,t,r){h.typeOf.object("left",e),h.typeOf.object("right",t),h.typeOf.object("result",r);var i=e.x,n=e.y,o=e.z,a=t.x,s=t.y,l=t.z,u=n*l-o*s,c=o*a-i*l,d=i*s-n*a;return r.x=u,r.y=c,r.z=d,r},d.fromDegrees=function(e,t,r,i,n){return h.typeOf.number("longitude",e),h.typeOf.number("latitude",t),e=o.toRadians(e),t=o.toRadians(t),d.fromRadians(e,t,r,i,n)};var p=new d,f=new d,m=new d(40680631590769,40680631590769,40408299984661.445);return d.fromRadians=function(e,t,r,i,n){h.typeOf.number("longitude",e),h.typeOf.number("latitude",t),r=l(r,0);var o=u(i)?i.radiiSquared:m,a=Math.cos(t);p.x=a*Math.cos(e),p.y=a*Math.sin(e),p.z=Math.sin(t),p=d.normalize(p,p),d.multiplyComponents(o,p,f);var s=Math.sqrt(d.dot(p,f));return f=d.divideByScalar(f,s,f),p=d.multiplyByScalar(p,r,p),u(n)||(n=new d),d.add(f,p,n)},d.fromDegreesArray=function(e,t,r){if(h.defined("coordinates",e),e.length<2||e.length%2!=0)throw new c("the number of coordinates must be a multiple of 2 and at least 2");var i=e.length;u(r)?r.length=i/2:r=new Array(i/2);for(var n=0;n<i;n+=2){var o=e[n],a=e[n+1],s=n/2;r[s]=d.fromDegrees(o,a,0,t,r[s])}return r},d.fromRadiansArray=function(e,t,r){if(h.defined("coordinates",e),e.length<2||e.length%2!=0)throw new c("the number of coordinates must be a multiple of 2 and at least 2");var i=e.length;u(r)?r.length=i/2:r=new Array(i/2);for(var n=0;n<i;n+=2){var o=e[n],a=e[n+1],s=n/2;r[s]=d.fromRadians(o,a,0,t,r[s])}return r},d.fromDegreesArrayHeights=function(e,t,r){if(h.defined("coordinates",e),e.length<3||e.length%3!=0)throw new c("the number of coordinates must be a multiple of 3 and at least 3");var i=e.length;u(r)?r.length=i/3:r=new Array(i/3);for(var n=0;n<i;n+=3){var o=e[n],a=e[n+1],s=e[n+2],l=n/3;r[l]=d.fromDegrees(o,a,s,t,r[l])}return r},d.fromRadiansArrayHeights=function(e,t,r){if(h.defined("coordinates",e),e.length<3||e.length%3!=0)throw new c("the number of coordinates must be a multiple of 3 and at least 3");var i=e.length;u(r)?r.length=i/3:r=new Array(i/3);for(var n=0;n<i;n+=3){var o=e[n],a=e[n+1],s=e[n+2],l=n/3;r[l]=d.fromRadians(o,a,s,t,r[l])}return r},d.ZERO=e(new d(0,0,0)),d.UNIT_X=e(new d(1,0,0)),d.UNIT_Y=e(new d(0,1,0)),d.UNIT_Z=e(new d(0,0,1)),d.prototype.clone=function(e){return d.clone(this,e)},d.prototype.equals=function(e){return d.equals(this,e)},d.prototype.equalsEpsilon=function(e,t,r){return d.equalsEpsilon(this,e,t,r)},d.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},d}),define("Core/AttributeCompression",["./Cartesian2","./Cartesian3","./Check","./defined","./DeveloperError","./Math"],function(e,a,u,l,s,c){"use strict";var d={octEncodeInRange:function(e,t,r){u.defined("vector",e),u.defined("result",r);var i=a.magnitudeSquared(e);if(Math.abs(i-1)>c.EPSILON6)throw new s("vector must be normalized.");if(r.x=e.x/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),r.y=e.y/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),e.z<0){var n=r.x,o=r.y;r.x=(1-Math.abs(o))*c.signNotZero(n),r.y=(1-Math.abs(n))*c.signNotZero(o)}return r.x=c.toSNorm(r.x,t),r.y=c.toSNorm(r.y,t),r},octEncode:function(e,t){return d.octEncodeInRange(e,255,t)},octDecodeInRange:function(e,t,r,i){if(u.defined("result",i),e<0||r<e||t<0||r<t)throw new s("x and y must be a signed normalized integer between 0 and "+r);if(i.x=c.fromSNorm(e,r),i.y=c.fromSNorm(t,r),i.z=1-(Math.abs(i.x)+Math.abs(i.y)),i.z<0){var n=i.x;i.x=(1-Math.abs(i.y))*c.signNotZero(n),i.y=(1-Math.abs(n))*c.signNotZero(i.y)}return a.normalize(i,i)},octDecode:function(e,t,r){return d.octDecodeInRange(e,t,255,r)},octPackFloat:function(e){return u.defined("encoded",e),256*e.x+e.y}},h=new e;function p(e){return e>>1^-(1&e)}return d.octEncodeFloat=function(e){return d.octEncode(e,h),d.octPackFloat(h)},d.octDecodeFloat=function(e,t){u.defined("value",e);var r=e/256,i=Math.floor(r),n=256*(r-i);return d.octDecode(i,n,t)},d.octPack=function(e,t,r,i){u.defined("v1",e),u.defined("v2",t),u.defined("v3",r),u.defined("result",i);var n=d.octEncodeFloat(e),o=d.octEncodeFloat(t),a=d.octEncode(r,h);return i.x=65536*a.x+n,i.y=65536*a.y+o,i},d.octUnpack=function(e,t,r,i){u.defined("packed",e),u.defined("v1",t),u.defined("v2",r),u.defined("v3",i);var n=e.x/65536,o=Math.floor(n),a=65536*(n-o);n=e.y/65536;var s=Math.floor(n),l=65536*(n-s);d.octDecodeFloat(a,t),d.octDecodeFloat(l,r),d.octDecode(o,s,i)},d.compressTextureCoordinates=function(e){return u.defined("textureCoordinates",e),4096*(4095*e.x|0)+(4095*e.y|0)},d.decompressTextureCoordinates=function(e,t){u.defined("compressed",e),u.defined("result",t);var r=e/4096,i=Math.floor(r);return t.x=i/4095,t.y=(e-4096*i)/4095,t},d.zigZagDeltaDecode=function(e,t,r){u.defined("uBuffer",e),u.defined("vBuffer",t),u.typeOf.number.equals("uBuffer.length","vBuffer.length",e.length,t.length),l(r)&&u.typeOf.number.equals("uBuffer.length","heightBuffer.length",e.length,r.length);for(var i=e.length,n=0,o=0,a=0,s=0;s<i;++s)n+=p(e[s]),o+=p(t[s]),e[s]=n,t[s]=o,l(r)&&(a+=p(r[s]),r[s]=a)},d}),define("Core/Intersect",["./freezeObject"],function(e){"use strict";return e({OUTSIDE:-1,INTERSECTING:0,INSIDE:1})}),define("Core/AxisAlignedBoundingBox",["./Cartesian3","./Check","./defaultValue","./defined","./Intersect"],function(_,a,i,v,s){"use strict";function y(e,t,r){this.minimum=_.clone(i(e,_.ZERO)),this.maximum=_.clone(i(t,_.ZERO)),v(r)?r=_.clone(r):(r=_.add(this.minimum,this.maximum,new _),_.multiplyByScalar(r,.5,r)),this.center=r}y.fromPoints=function(e,t){if(v(t)||(t=new y),!v(e)||0===e.length)return t.minimum=_.clone(_.ZERO,t.minimum),t.maximum=_.clone(_.ZERO,t.maximum),t.center=_.clone(_.ZERO,t.center),t;for(var r=e[0].x,i=e[0].y,n=e[0].z,o=e[0].x,a=e[0].y,s=e[0].z,l=e.length,u=1;u<l;u++){var c=e[u],d=c.x,h=c.y,p=c.z;r=Math.min(d,r),o=Math.max(d,o),i=Math.min(h,i),a=Math.max(h,a),n=Math.min(p,n),s=Math.max(p,s)}var f=t.minimum;f.x=r,f.y=i,f.z=n;var m=t.maximum;m.x=o,m.y=a,m.z=s;var g=_.add(f,m,t.center);return _.multiplyByScalar(g,.5,g),t},y.clone=function(e,t){if(v(e))return v(t)?(t.minimum=_.clone(e.minimum,t.minimum),t.maximum=_.clone(e.maximum,t.maximum),t.center=_.clone(e.center,t.center),t):new y(e.minimum,e.maximum)},y.equals=function(e,t){return e===t||v(e)&&v(t)&&_.equals(e.center,t.center)&&_.equals(e.minimum,t.minimum)&&_.equals(e.maximum,t.maximum)};var l=new _;return y.intersectPlane=function(e,t){a.defined("box",e),a.defined("plane",t),l=_.subtract(e.maximum,e.minimum,l);var r=_.multiplyByScalar(l,.5,l),i=t.normal,n=r.x*Math.abs(i.x)+r.y*Math.abs(i.y)+r.z*Math.abs(i.z),o=_.dot(e.center,i)+t.distance;return 0<o-n?s.INSIDE:o+n<0?s.OUTSIDE:s.INTERSECTING},y.prototype.clone=function(e){return y.clone(this,e)},y.prototype.intersectPlane=function(e){return y.intersectPlane(this,e)},y.prototype.equals=function(e){return y.equals(this,e)},y}),define("Core/barycentricCoordinates",["./Cartesian2","./Cartesian3","./Check","./defined"],function(f,m,g,_){"use strict";var v=new m,y=new m,b=new m;return function(e,t,r,i,n){var o,a,s,l,u,c,d,h;g.defined("point",e),g.defined("p0",t),g.defined("p1",r),g.defined("p2",i),_(n)||(n=new m),h=_(t.z)?(o=m.subtract(r,t,v),a=m.subtract(i,t,y),s=m.subtract(e,t,b),l=m.dot(o,o),u=m.dot(o,a),c=m.dot(o,s),d=m.dot(a,a),m.dot(a,s)):(o=f.subtract(r,t,v),a=f.subtract(i,t,y),s=f.subtract(e,t,b),l=f.dot(o,o),u=f.dot(o,a),c=f.dot(o,s),d=f.dot(a,a),f.dot(a,s));var p=1/(l*d-u*u);return n.y=(d*c-u*h)*p,n.z=(l*h-u*c)*p,n.x=1-n.y-n.z,n}}),define("Core/binarySearch",["./Check"],function(s){"use strict";return function(e,t,r){s.defined("array",e),s.defined("itemToFind",t),s.defined("comparator",r);for(var i,n,o=0,a=e.length-1;o<=a;)if((n=r(e[i=~~((o+a)/2)],t))<0)o=i+1;else{if(!(0<n))return i;a=i-1}return~(a+1)}}),define("Core/Credit",["./defaultValue","./defined","./defineProperties","./DeveloperError"],function(c,d,e,h){"use strict";var p=0,f={};function t(e){var t,r=(e=c(e,c.EMPTY_OBJECT)).text,i=e.imageUrl,n=e.link,o=c(e.showOnScreen,!1),a=d(n),s=d(i),l=d(r);if(!l&&!s&&!a)throw new h("options.text, options.imageUrl, or options.link is required.");l||s||(r=n),this._text=r,this._imageUrl=i,this._link=n,this._hasLink=a,this._hasImage=s,this._showOnScreen=o;var u=JSON.stringify([r,i,n]);d(f[u])?t=f[u]:(t=p++,f[u]=t),this._id=t}return e(t.prototype,{text:{get:function(){return this._text}},imageUrl:{get:function(){return this._imageUrl}},link:{get:function(){return this._link}},id:{get:function(){return this._id}},showOnScreen:{get:function(){return this._showOnScreen}}}),t.prototype.hasImage=function(){return this._hasImage},t.prototype.hasLink=function(){return this._hasLink},t.equals=function(e,t){return e===t||d(e)&&d(t)&&e._id===t._id},t.prototype.equals=function(e){return t.equals(this,e)},t}),define("Core/BingMapsApi",["./Credit","./defined"],function(t,r){"use strict";var i,n={defaultKey:void 0},o=!1,a="This application is using Cesium's default Bing Maps key.  Please create a new key for the application as soon as possible and prior to deployment by visiting https://www.bingmapsportal.com/, and provide your key to Cesium by setting the Cesium.BingMapsApi.defaultKey property before constructing the CesiumWidget or any other object that uses the Bing Maps API.";return n.getKey=function(e){return r(e)?e:r(n.defaultKey)?n.defaultKey:(o||(console.log(a),o=!0),"Ar9n20kTp-N8tEg3Dpx-Pgocmx3W0-GUnD_Bgt3h8g6pSeDL8yxByTVGHyMyjI2p")},n.getErrorCredit=function(e){if(!r(e)&&!r(n.defaultKey))return r(i)||(i=new t({text:a,showOnScreen:!0})),i},n}),define("Core/scaleToGeodeticSurface",["./Cartesian3","./defined","./DeveloperError","./Math"],function(O,I,M,R){"use strict";var L=new O,N=new O;return function(e,t,r,i,n){if(!I(e))throw new M("cartesian is required.");if(!I(t))throw new M("oneOverRadii is required.");if(!I(r))throw new M("oneOverRadiiSquared is required.");if(!I(i))throw new M("centerToleranceSquared is required.");var o=e.x,a=e.y,s=e.z,l=t.x,u=t.y,c=t.z,d=o*o*l*l,h=a*a*u*u,p=s*s*c*c,f=d+h+p,m=Math.sqrt(1/f),g=O.multiplyByScalar(e,m,L);if(f<i)return isFinite(m)?O.clone(g,n):void 0;var _=r.x,v=r.y,y=r.z,b=N;b.x=g.x*_*2,b.y=g.y*v*2,b.z=g.z*y*2;var C,w,S,T,E,A,x,P=(1-m)*O.magnitude(e)/(.5*O.magnitude(b)),D=0;for(;D=(C=d*(E=(w=1/(1+(P-=D)*_))*w)+h*(A=(S=1/(1+P*v))*S)+p*(x=(T=1/(1+P*y))*T)-1)/(-2*(d*(E*w)*_+h*(A*S)*v+p*(x*T)*y)),Math.abs(C)>R.EPSILON12;);return I(n)?(n.x=o*w,n.y=a*S,n.z=s*T,n):new O(o*w,a*S,s*T)}}),define("Core/Cartographic",["./Cartesian3","./Check","./defaultValue","./defined","./freezeObject","./Math","./scaleToGeodeticSurface"],function(h,n,o,p,e,f,m){"use strict";function g(e,t,r){this.longitude=o(e,0),this.latitude=o(t,0),this.height=o(r,0)}g.fromRadians=function(e,t,r,i){return n.typeOf.number("longitude",e),n.typeOf.number("latitude",t),r=o(r,0),p(i)?(i.longitude=e,i.latitude=t,i.height=r,i):new g(e,t,r)},g.fromDegrees=function(e,t,r,i){return n.typeOf.number("longitude",e),n.typeOf.number("latitude",t),e=f.toRadians(e),t=f.toRadians(t),g.fromRadians(e,t,r,i)};var _=new h,v=new h,y=new h,b=new h(1/6378137,1/6378137,1/6356752.314245179),C=new h(1/40680631590769,1/40680631590769,1/40408299984661.445),w=f.EPSILON1;return g.fromCartesian=function(e,t,r){var i=p(t)?t.oneOverRadii:b,n=p(t)?t.oneOverRadiiSquared:C,o=p(t)?t._centerToleranceSquared:w,a=m(e,i,n,o,v);if(p(a)){var s=h.multiplyComponents(a,n,_);s=h.normalize(s,s);var l=h.subtract(e,a,y),u=Math.atan2(s.y,s.x),c=Math.asin(s.z),d=f.sign(h.dot(l,e))*h.magnitude(l);return p(r)?(r.longitude=u,r.latitude=c,r.height=d,r):new g(u,c,d)}},g.toCartesian=function(e,t,r){return n.defined("cartographic",e),h.fromRadians(e.longitude,e.latitude,e.height,t,r)},g.clone=function(e,t){if(p(e))return p(t)?(t.longitude=e.longitude,t.latitude=e.latitude,t.height=e.height,t):new g(e.longitude,e.latitude,e.height)},g.equals=function(e,t){return e===t||p(e)&&p(t)&&e.longitude===t.longitude&&e.latitude===t.latitude&&e.height===t.height},g.equalsEpsilon=function(e,t,r){return n.typeOf.number("epsilon",r),e===t||p(e)&&p(t)&&Math.abs(e.longitude-t.longitude)<=r&&Math.abs(e.latitude-t.latitude)<=r&&Math.abs(e.height-t.height)<=r},g.ZERO=e(new g(0,0,0)),g.prototype.clone=function(e){return g.clone(this,e)},g.prototype.equals=function(e){return g.equals(this,e)},g.prototype.equalsEpsilon=function(e,t){return g.equalsEpsilon(this,e,t)},g.prototype.toString=function(){return"("+this.longitude+", "+this.latitude+", "+this.height+")"},g}),define("Core/Ellipsoid",["./Cartesian3","./Cartographic","./Check","./defaultValue","./defined","./defineProperties","./DeveloperError","./freezeObject","./Math","./scaleToGeodeticSurface"],function(l,u,c,n,d,e,o,t,h,r){"use strict";function i(e,t,r,i){t=n(t,0),r=n(r,0),i=n(i,0),c.typeOf.number.greaterThanOrEquals("x",t,0),c.typeOf.number.greaterThanOrEquals("y",r,0),c.typeOf.number.greaterThanOrEquals("z",i,0),e._radii=new l(t,r,i),e._radiiSquared=new l(t*t,r*r,i*i),e._radiiToTheFourth=new l(t*t*t*t,r*r*r*r,i*i*i*i),e._oneOverRadii=new l(0===t?0:1/t,0===r?0:1/r,0===i?0:1/i),e._oneOverRadiiSquared=new l(0===t?0:1/(t*t),0===r?0:1/(r*r),0===i?0:1/(i*i)),e._minimumRadius=Math.min(t,r,i),e._maximumRadius=Math.max(t,r,i),e._centerToleranceSquared=h.EPSILON1,0!==e._radiiSquared.z&&(e._squaredXOverSquaredZ=e._radiiSquared.x/e._radiiSquared.z)}function a(e,t,r){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,this._squaredXOverSquaredZ=void 0,i(this,e,t,r)}e(a.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}}),a.clone=function(e,t){if(d(e)){var r=e._radii;return d(t)?(l.clone(r,t._radii),l.clone(e._radiiSquared,t._radiiSquared),l.clone(e._radiiToTheFourth,t._radiiToTheFourth),l.clone(e._oneOverRadii,t._oneOverRadii),l.clone(e._oneOverRadiiSquared,t._oneOverRadiiSquared),t._minimumRadius=e._minimumRadius,t._maximumRadius=e._maximumRadius,t._centerToleranceSquared=e._centerToleranceSquared,t):new a(r.x,r.y,r.z)}},a.fromCartesian3=function(e,t){return d(t)||(t=new a),d(e)&&i(t,e.x,e.y,e.z),t},a.WGS84=t(new a(6378137,6378137,6356752.314245179)),a.UNIT_SPHERE=t(new a(1,1,1)),a.MOON=t(new a(h.LUNAR_RADIUS,h.LUNAR_RADIUS,h.LUNAR_RADIUS)),a.prototype.clone=function(e){return a.clone(this,e)},a.packedLength=l.packedLength,a.pack=function(e,t,r){return c.typeOf.object("value",e),c.defined("array",t),r=n(r,0),l.pack(e._radii,t,r),t},a.unpack=function(e,t,r){c.defined("array",e),t=n(t,0);var i=l.unpack(e,t);return a.fromCartesian3(i,r)},a.prototype.geocentricSurfaceNormal=l.normalize,a.prototype.geodeticSurfaceNormalCartographic=function(e,t){c.typeOf.object("cartographic",e);var r=e.longitude,i=e.latitude,n=Math.cos(i),o=n*Math.cos(r),a=n*Math.sin(r),s=Math.sin(i);return d(t)||(t=new l),t.x=o,t.y=a,t.z=s,l.normalize(t,t)},a.prototype.geodeticSurfaceNormal=function(e,t){return d(t)||(t=new l),t=l.multiplyComponents(e,this._oneOverRadiiSquared,t),l.normalize(t,t)};var s=new l,p=new l;a.prototype.cartographicToCartesian=function(e,t){var r=s,i=p;this.geodeticSurfaceNormalCartographic(e,r),l.multiplyComponents(this._radiiSquared,r,i);var n=Math.sqrt(l.dot(r,i));return l.divideByScalar(i,n,i),l.multiplyByScalar(r,e.height,r),d(t)||(t=new l),l.add(i,r,t)},a.prototype.cartographicArrayToCartesianArray=function(e,t){c.defined("cartographics",e);var r=e.length;d(t)?t.length=r:t=new Array(r);for(var i=0;i<r;i++)t[i]=this.cartographicToCartesian(e[i],t[i]);return t};var f=new l,m=new l,g=new l;return a.prototype.cartesianToCartographic=function(e,t){var r=this.scaleToGeodeticSurface(e,m);if(d(r)){var i=this.geodeticSurfaceNormal(r,f),n=l.subtract(e,r,g),o=Math.atan2(i.y,i.x),a=Math.asin(i.z),s=h.sign(l.dot(n,e))*l.magnitude(n);return d(t)?(t.longitude=o,t.latitude=a,t.height=s,t):new u(o,a,s)}},a.prototype.cartesianArrayToCartographicArray=function(e,t){c.defined("cartesians",e);var r=e.length;d(t)?t.length=r:t=new Array(r);for(var i=0;i<r;++i)t[i]=this.cartesianToCartographic(e[i],t[i]);return t},a.prototype.scaleToGeodeticSurface=function(e,t){return r(e,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,t)},a.prototype.scaleToGeocentricSurface=function(e,t){c.typeOf.object("cartesian",e),d(t)||(t=new l);var r=e.x,i=e.y,n=e.z,o=this._oneOverRadiiSquared,a=1/Math.sqrt(r*r*o.x+i*i*o.y+n*n*o.z);return l.multiplyByScalar(e,a,t)},a.prototype.transformPositionToScaledSpace=function(e,t){return d(t)||(t=new l),l.multiplyComponents(e,this._oneOverRadii,t)},a.prototype.transformPositionFromScaledSpace=function(e,t){return d(t)||(t=new l),l.multiplyComponents(e,this._radii,t)},a.prototype.equals=function(e){return this===e||d(e)&&l.equals(this._radii,e._radii)},a.prototype.toString=function(){return this._radii.toString()},a.prototype.getSurfaceNormalIntersectionWithZAxis=function(e,t,r){if(c.typeOf.object("position",e),!h.equalsEpsilon(this._radii.x,this._radii.y,h.EPSILON15))throw new o("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");c.typeOf.number.greaterThan("Ellipsoid.radii.z",this._radii.z,0),t=n(t,0);var i=this._squaredXOverSquaredZ;if(d(r)||(r=new l),r.x=0,r.y=0,r.z=e.z*(1-i),!(Math.abs(r.z)>=this._radii.z-t))return r},a}),define("Core/Rectangle",["./Cartographic","./Check","./defaultValue","./defined","./defineProperties","./Ellipsoid","./freezeObject","./Math"],function(a,p,f,m,e,g,t,_){"use strict";function v(e,t,r,i){this.west=f(e,0),this.south=f(t,0),this.east=f(r,0),this.north=f(i,0)}e(v.prototype,{width:{get:function(){return v.computeWidth(this)}},height:{get:function(){return v.computeHeight(this)}}}),v.packedLength=4,v.pack=function(e,t,r){return p.typeOf.object("value",e),p.defined("array",t),r=f(r,0),t[r++]=e.west,t[r++]=e.south,t[r++]=e.east,t[r]=e.north,t},v.unpack=function(e,t,r){return p.defined("array",e),t=f(t,0),m(r)||(r=new v),r.west=e[t++],r.south=e[t++],r.east=e[t++],r.north=e[t],r},v.computeWidth=function(e){p.typeOf.object("rectangle",e);var t=e.east,r=e.west;return t<r&&(t+=_.TWO_PI),t-r},v.computeHeight=function(e){return p.typeOf.object("rectangle",e),e.north-e.south},v.fromDegrees=function(e,t,r,i,n){return e=_.toRadians(f(e,0)),t=_.toRadians(f(t,0)),r=_.toRadians(f(r,0)),i=_.toRadians(f(i,0)),m(n)?(n.west=e,n.south=t,n.east=r,n.north=i,n):new v(e,t,r,i)},v.fromRadians=function(e,t,r,i,n){return m(n)?(n.west=f(e,0),n.south=f(t,0),n.east=f(r,0),n.north=f(i,0),n):new v(e,t,r,i)},v.fromCartographicArray=function(e,t){p.defined("cartographics",e);for(var r=Number.MAX_VALUE,i=-Number.MAX_VALUE,n=Number.MAX_VALUE,o=-Number.MAX_VALUE,a=Number.MAX_VALUE,s=-Number.MAX_VALUE,l=0,u=e.length;l<u;l++){var c=e[l];r=Math.min(r,c.longitude),i=Math.max(i,c.longitude),a=Math.min(a,c.latitude),s=Math.max(s,c.latitude);var d=0<=c.longitude?c.longitude:c.longitude+_.TWO_PI;n=Math.min(n,d),o=Math.max(o,d)}return o-n<i-r&&(r=n,(i=o)>_.PI&&(i-=_.TWO_PI),r>_.PI&&(r-=_.TWO_PI)),m(t)?(t.west=r,t.south=a,t.east=i,t.north=s,t):new v(r,a,i,s)},v.fromCartesianArray=function(e,t,r){p.defined("cartesians",e),t=f(t,g.WGS84);for(var i=Number.MAX_VALUE,n=-Number.MAX_VALUE,o=Number.MAX_VALUE,a=-Number.MAX_VALUE,s=Number.MAX_VALUE,l=-Number.MAX_VALUE,u=0,c=e.length;u<c;u++){var d=t.cartesianToCartographic(e[u]);i=Math.min(i,d.longitude),n=Math.max(n,d.longitude),s=Math.min(s,d.latitude),l=Math.max(l,d.latitude);var h=0<=d.longitude?d.longitude:d.longitude+_.TWO_PI;o=Math.min(o,h),a=Math.max(a,h)}return a-o<n-i&&(i=o,(n=a)>_.PI&&(n-=_.TWO_PI),i>_.PI&&(i-=_.TWO_PI)),m(r)?(r.west=i,r.south=s,r.east=n,r.north=l,r):new v(i,s,n,l)},v.clone=function(e,t){if(m(e))return m(t)?(t.west=e.west,t.south=e.south,t.east=e.east,t.north=e.north,t):new v(e.west,e.south,e.east,e.north)},v.prototype.clone=function(e){return v.clone(this,e)},v.prototype.equals=function(e){return v.equals(this,e)},v.equals=function(e,t){return e===t||m(e)&&m(t)&&e.west===t.west&&e.south===t.south&&e.east===t.east&&e.north===t.north},v.prototype.equalsEpsilon=function(e,t){return p.typeOf.number("epsilon",t),m(e)&&Math.abs(this.west-e.west)<=t&&Math.abs(this.south-e.south)<=t&&Math.abs(this.east-e.east)<=t&&Math.abs(this.north-e.north)<=t},v.validate=function(e){p.typeOf.object("rectangle",e);var t=e.north;p.typeOf.number.greaterThanOrEquals("north",t,-_.PI_OVER_TWO),p.typeOf.number.lessThanOrEquals("north",t,_.PI_OVER_TWO);var r=e.south;p.typeOf.number.greaterThanOrEquals("south",r,-_.PI_OVER_TWO),p.typeOf.number.lessThanOrEquals("south",r,_.PI_OVER_TWO);var i=e.west;p.typeOf.number.greaterThanOrEquals("west",i,-Math.PI),p.typeOf.number.lessThanOrEquals("west",i,Math.PI);var n=e.east;p.typeOf.number.greaterThanOrEquals("east",n,-Math.PI),p.typeOf.number.lessThanOrEquals("east",n,Math.PI)},v.southwest=function(e,t){return p.typeOf.object("rectangle",e),m(t)?(t.longitude=e.west,t.latitude=e.south,t.height=0,t):new a(e.west,e.south)},v.northwest=function(e,t){return p.typeOf.object("rectangle",e),m(t)?(t.longitude=e.west,t.latitude=e.north,t.height=0,t):new a(e.west,e.north)},v.northeast=function(e,t){return p.typeOf.object("rectangle",e),m(t)?(t.longitude=e.east,t.latitude=e.north,t.height=0,t):new a(e.east,e.north)},v.southeast=function(e,t){return p.typeOf.object("rectangle",e),m(t)?(t.longitude=e.east,t.latitude=e.south,t.height=0,t):new a(e.east,e.south)},v.center=function(e,t){p.typeOf.object("rectangle",e);var r=e.east,i=e.west;r<i&&(r+=_.TWO_PI);var n=_.negativePiToPi(.5*(i+r)),o=.5*(e.south+e.north);return m(t)?(t.longitude=n,t.latitude=o,t.height=0,t):new a(n,o)},v.intersection=function(e,t,r){p.typeOf.object("rectangle",e),p.typeOf.object("otherRectangle",t);var i=e.east,n=e.west,o=t.east,a=t.west;i<n&&0<o?i+=_.TWO_PI:o<a&&0<i&&(o+=_.TWO_PI),i<n&&a<0?a+=_.TWO_PI:o<a&&n<0&&(n+=_.TWO_PI);var s=_.negativePiToPi(Math.max(n,a)),l=_.negativePiToPi(Math.min(i,o));if(!((e.west<e.east||t.west<t.east)&&l<=s)){var u=Math.max(e.south,t.south),c=Math.min(e.north,t.north);if(!(c<=u))return m(r)?(r.west=s,r.south=u,r.east=l,r.north=c,r):new v(s,u,l,c)}},v.simpleIntersection=function(e,t,r){p.typeOf.object("rectangle",e),p.typeOf.object("otherRectangle",t);var i=Math.max(e.west,t.west),n=Math.max(e.south,t.south),o=Math.min(e.east,t.east),a=Math.min(e.north,t.north);if(!(a<=n||o<=i))return m(r)?(r.west=i,r.south=n,r.east=o,r.north=a,r):new v(i,n,o,a)},v.union=function(e,t,r){p.typeOf.object("rectangle",e),p.typeOf.object("otherRectangle",t),m(r)||(r=new v);var i=e.east,n=e.west,o=t.east,a=t.west;i<n&&0<o?i+=_.TWO_PI:o<a&&0<i&&(o+=_.TWO_PI),i<n&&a<0?a+=_.TWO_PI:o<a&&n<0&&(n+=_.TWO_PI);var s=_.convertLongitudeRange(Math.min(n,a)),l=_.convertLongitudeRange(Math.max(i,o));return r.west=s,r.south=Math.min(e.south,t.south),r.east=l,r.north=Math.max(e.north,t.north),r},v.expand=function(e,t,r){return p.typeOf.object("rectangle",e),p.typeOf.object("cartographic",t),m(r)||(r=new v),r.west=Math.min(e.west,t.longitude),r.south=Math.min(e.south,t.latitude),r.east=Math.max(e.east,t.longitude),r.north=Math.max(e.north,t.latitude),r},v.contains=function(e,t){p.typeOf.object("rectangle",e),p.typeOf.object("cartographic",t);var r=t.longitude,i=t.latitude,n=e.west,o=e.east;return o<n&&(o+=_.TWO_PI,r<0&&(r+=_.TWO_PI)),(n<r||_.equalsEpsilon(r,n,_.EPSILON14))&&(r<o||_.equalsEpsilon(r,o,_.EPSILON14))&&i>=e.south&&i<=e.north};var d=new a;return v.subsample=function(e,t,r,i){p.typeOf.object("rectangle",e),t=f(t,g.WGS84),r=f(r,0),m(i)||(i=[]);var n=0,o=e.north,a=e.south,s=e.east,l=e.west,u=d;u.height=r,u.longitude=l,u.latitude=o,i[n]=t.cartographicToCartesian(u,i[n]),n++,u.longitude=s,i[n]=t.cartographicToCartesian(u,i[n]),n++,u.latitude=a,i[n]=t.cartographicToCartesian(u,i[n]),n++,u.longitude=l,i[n]=t.cartographicToCartesian(u,i[n]),n++,u.latitude=o<0?o:0<a?a:0;for(var c=1;c<8;++c)u.longitude=-Math.PI+c*_.PI_OVER_TWO,v.contains(e,u)&&(i[n]=t.cartographicToCartesian(u,i[n]),n++);return 0===u.latitude&&(u.longitude=l,i[n]=t.cartographicToCartesian(u,i[n]),n++,u.longitude=s,i[n]=t.cartographicToCartesian(u,i[n]),n++),i.length=n,i},v.MAX_VALUE=t(new v(-Math.PI,-_.PI_OVER_TWO,Math.PI,_.PI_OVER_TWO)),v}),define("Core/clone",["./defaultValue"],function(a){"use strict";return function e(t,r){if(null===t||"object"!=typeof t)return t;r=a(r,!1);var i=new t.constructor;for(var n in t)if(t.hasOwnProperty(n)){var o=t[n];r&&(o=e(o,r)),i[n]=o}return i}}),define("Core/combine",["./defaultValue","./defined"],function(c,d){"use strict";return function e(t,r,i){i=c(i,!1);var n,o,a,s={},l=d(t),u=d(r);if(l)for(n in t)t.hasOwnProperty(n)&&(o=t[n],u&&i&&"object"==typeof o&&r.hasOwnProperty(n)?(a=r[n],s[n]="object"==typeof a?e(o,a,i):o):s[n]=o);if(u)for(n in r)r.hasOwnProperty(n)&&!s.hasOwnProperty(n)&&(a=r[n],s[n]=a);return s}}),define("Core/oneTimeWarning",["./defaultValue","./defined","./DeveloperError"],function(r,i,n){"use strict";var o={};function e(e,t){if(!i(e))throw new n("identifier is required.");i(o[e])||(o[e]=!0,console.warn(r(t,e)))}return e.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.",e}),define("Core/deprecationWarning",["./defined","./DeveloperError","./oneTimeWarning"],function(r,i,n){"use strict";return function(e,t){if(!r(e)||!r(t))throw new i("identifier and message are required.");n(e,t)}}),define("ThirdParty/Uri",[],function(){function r(e){if(e instanceof r)this.scheme=e.scheme,this.authority=e.authority,this.path=e.path,this.query=e.query,this.fragment=e.fragment;else if(e){var t=i.exec(e);this.scheme=t[1],this.authority=t[2],this.path=t[3],this.query=t[4],this.fragment=t[5]}}r.prototype.scheme=null,r.prototype.authority=null,r.prototype.path="",r.prototype.query=null,r.prototype.fragment=null;var i=new RegExp("^(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$");r.prototype.getScheme=function(){return this.scheme},r.prototype.getAuthority=function(){return this.authority},r.prototype.getPath=function(){return this.path},r.prototype.getQuery=function(){return this.query},r.prototype.getFragment=function(){return this.fragment},r.prototype.isAbsolute=function(){return!!this.scheme&&!this.fragment},r.prototype.isSameDocumentAs=function(e){return e.scheme==this.scheme&&e.authority==this.authority&&e.path==this.path&&e.query==this.query},r.prototype.equals=function(e){return this.isSameDocumentAs(e)&&e.fragment==this.fragment},r.prototype.normalize=function(){this.removeDotSegments(),this.scheme&&(this.scheme=this.scheme.toLowerCase()),this.authority&&(this.authority=this.authority.replace(t,a).replace(e,o)),this.path&&(this.path=this.path.replace(e,o)),this.query&&(this.query=this.query.replace(e,o)),this.fragment&&(this.fragment=this.fragment.replace(e,o))};var e=/%[0-9a-z]{2}/gi,n=/[a-zA-Z0-9\-\._~]/,t=/(.*@)?([^@:]*)(:.*)?/;function o(e){var t=unescape(e);return n.test(t)?t:e.toUpperCase()}function a(e,t,r,i){return(t||"")+r.toLowerCase()+(i||"")}return r.prototype.resolve=function(e){var t=new r;return this.scheme?(t.scheme=this.scheme,t.authority=this.authority,t.path=this.path,t.query=this.query):(t.scheme=e.scheme,this.authority?(t.authority=this.authority,t.path=this.path,t.query=this.query):(t.authority=e.authority,""==this.path?(t.path=e.path,t.query=this.query||e.query):("/"==this.path.charAt(0)?t.path=this.path:e.authority&&""==e.path?t.path="/"+this.path:t.path=e.path.substring(0,e.path.lastIndexOf("/")+1)+this.path,t.removeDotSegments(),t.query=this.query))),t.fragment=this.fragment,t},r.prototype.removeDotSegments=function(){var e,t=this.path.split("/"),r=[],i=""==t[0];i&&t.shift();for(""==t[0]&&t.shift();t.length;)".."==(e=t.shift())?r.pop():"."!=e&&r.push(e);"."!=e&&".."!=e||r.push(""),i&&r.unshift(""),this.path=r.join("/")},r.prototype.toString=function(){var e="";return this.scheme&&(e+=this.scheme+":"),this.authority&&(e+="//"+this.authority),e+=this.path,this.query&&(e+="?"+this.query),this.fragment&&(e+="#"+this.fragment),e},r}),define("Core/getAbsoluteUri",["../ThirdParty/Uri","./defaultValue","./defined","./DeveloperError"],function(n,o,a,s){"use strict";function r(e,t){return r._implementation(e,t,document)}return r._implementation=function(e,t,r){if(!a(e))throw new s("relative uri is required.");t=o(t,o(r.baseURI,r.location.href));var i=new n(t);return new n(e).resolve(i).toString()},r}),define("Core/getBaseUri",["../ThirdParty/Uri","./defined","./DeveloperError"],function(n,o,a){"use strict";return function(e,t){if(!o(e))throw new a("uri is required.");var r="",i=e.lastIndexOf("/");return-1!==i&&(r=e.substring(0,i+1)),t&&(e=new n(e),o(e.query)&&(r+="?"+e.query),o(e.fragment)&&(r+="#"+e.fragment)),r}}),define("Core/getExtensionFromUri",["../ThirdParty/Uri","./defined","./DeveloperError"],function(n,o,a){"use strict";return function(e){if(!o(e))throw new a("uri is required.");var t=new n(e);t.normalize();var r=t.path,i=r.lastIndexOf("/");return-1!==i&&(r=r.substr(i+1)),r=-1===(i=r.lastIndexOf("."))?"":r.substr(i+1)}}),define("Core/isBlobUri",["./Check"],function(t){"use strict";var r=/^blob:/i;return function(e){return t.typeOf.string("uri",e),r.test(e)}}),define("Core/isCrossOriginUrl",["./defined"],function(i){"use strict";var n;return function(e){i(n)||(n=document.createElement("a")),n.href=window.location.href;var t=n.host,r=n.protocol;return n.href=e,n.href=n.href,r!==n.protocol||t!==n.host}}),define("Core/isDataUri",["./Check"],function(t){"use strict";var r=/^data:/i;return function(e){return t.typeOf.string("uri",e),r.test(e)}}),define("Core/isArray",["./defined"],function(e){"use strict";var t=Array.isArray;return e(t)||(t=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),t}),define("Core/objectToQuery",["./defined","./DeveloperError","./isArray"],function(s,l,u){"use strict";return function(e){if(!s(e))throw new l("obj is required.");var t="";for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],n=encodeURIComponent(r)+"=";if(u(i))for(var o=0,a=i.length;o<a;++o)t+=n+encodeURIComponent(i[o])+"&";else t+=n+encodeURIComponent(i)+"&"}return t=t.slice(0,-1)}}),define("Core/queryToObject",["./defined","./DeveloperError","./isArray"],function(u,c,d){"use strict";return function(e){if(!u(e))throw new c("queryString is required.");var t={};if(""===e)return t;for(var r=e.replace(/\+/g,"%20").split(/[&;]/),i=0,n=r.length;i<n;++i){var o=r[i].split("="),a=decodeURIComponent(o[0]),s=o[1];s=u(s)?decodeURIComponent(s):"";var l=t[a];"string"==typeof l?t[a]=[l,s]:d(l)?l.push(s):t[a]=s}return t}}),define("Core/RequestState",["../Core/freezeObject"],function(e){"use strict";return e({UNISSUED:0,ISSUED:1,ACTIVE:2,RECEIVED:3,CANCELLED:4,FAILED:5})}),define("Core/RequestType",["../Core/freezeObject"],function(e){"use strict";return e({TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3})}),define("Core/Request",["./defaultValue","./defined","./RequestState","./RequestType"],function(i,t,n,o){"use strict";function r(e){e=i(e,i.EMPTY_OBJECT);var t=i(e.throttleByServer,!1),r=t||i(e.throttle,!1);this.url=e.url,this.requestFunction=e.requestFunction,this.cancelFunction=e.cancelFunction,this.priorityFunction=e.priorityFunction,this.priority=i(e.priority,0),this.throttle=r,this.throttleByServer=t,this.type=i(e.type,o.OTHER),this.serverKey=void 0,this.state=n.UNISSUED,this.deferred=void 0,this.cancelled=!1}return r.prototype.cancel=function(){this.cancelled=!0},r.prototype.clone=function(e){return t(e)?(e.url=this.url,e.requestFunction=this.requestFunction,e.cancelFunction=this.cancelFunction,e.priorityFunction=this.priorityFunction,e.priority=this.priority,e.throttle=this.throttle,e.throttleByServer=this.throttleByServer,e.type=this.type,e.serverKey=this.serverKey,e.state=this.RequestState.UNISSUED,e.deferred=void 0,e.cancelled=!1,e):new r(this)},r}),define("Core/parseResponseHeaders",[],function(){"use strict";return function(e){var t={};if(!e)return t;for(var r=e.split("\r\n"),i=0;i<r.length;++i){var n=r[i],o=n.indexOf(": ");if(0<o){var a=n.substring(0,o),s=n.substring(o+2);t[a]=s}}return t}}),define("Core/RequestErrorEvent",["./defined","./parseResponseHeaders"],function(t,i){"use strict";function e(e,t,r){this.statusCode=e,this.response=t,this.responseHeaders=r,"string"==typeof this.responseHeaders&&(this.responseHeaders=i(this.responseHeaders))}return e.prototype.toString=function(){var e="Request has failed.";return t(this.statusCode)&&(e+=" Status Code: "+this.statusCode),e},e}),function(e){"use strict";e("ThirdParty/when",[],function(){var r,i,c;function _(e,t,r,i){return d(e).then(t,r,i)}function d(e){var t,r;return e instanceof h?e:n(e)?(t=v(),e.then(function(e){t.resolve(e)},function(e){t.reject(e)},function(e){t.progress(e)}),t.promise):(r=e,new h(function(e){try{return d(e?e(r):r)}catch(e){return p(e)}}))}function h(e){this.then=e}function p(r){return new h(function(e,t){try{return t?d(t(r)):p(r)}catch(e){return p(e)}})}function v(){var e,a,s,i,t,r;return e=new h(n),a=[],s=[],i=function(t,r,i){var n,o;return n=v(),o="function"==typeof i?function(e){try{n.progress(i(e))}catch(e){n.progress(e)}}:function(e){n.progress(e)},a.push(function(e){e.then(t,r).then(n.resolve,n.reject,o)}),s.push(o),n.promise},t=function(e){return f(s,e),e},r=function(e){return e=d(e),i=e.then,r=d,t=y,f(a,e),s=a=c,e},{then:n,resolve:o,reject:l,progress:u,promise:e,resolver:{resolve:o,reject:l,progress:u}};function n(e,t,r){return i(e,t,r)}function o(e){return r(e)}function l(e){return r(p(e))}function u(e){return t(e)}}function n(e){return e&&"function"==typeof e.then}function o(e,p,f,m,g){return l(2,arguments),_(e,function(e){var t,r,i,n,o,a,s,l,u,c;if(u=e.length>>>0,t=Math.max(0,Math.min(p,u)),i=[],r=u-t+1,n=[],o=v(),t)for(l=o.progress,s=function(e){n.push(e),--r||(a=s=y,o.reject(n))},a=function(e){i.push(e),--t||(a=s=y,o.resolve(i))},c=0;c<u;++c)c in e&&_(e[c],h,d,l);else o.resolve(i);return o.then(f,m,g);function d(e){s(e)}function h(e){a(e)}})}function a(e,t,r,i){return l(1,arguments),s(e,u).then(t,r,i)}function s(e,s){return _(e,function(e){var r,t,i,n,o,a;if(i=t=e.length>>>0,r=[],a=v(),i)for(n=function(e,t){_(e,s).then(function(e){r[t]=e,--i||a.resolve(r)},a.reject)},o=0;o<t;o++)o in e?n(e[o],o):--i;else a.resolve(r);return a.promise})}function f(e,t){for(var r,i=0;r=e[i++];)r(t)}function l(e,t){for(var r,i=t.length;e<i;)if(null!=(r=t[--i])&&"function"!=typeof r)throw new Error("arg "+i+" must be a function")}function y(){}function u(e){return e}return _.defer=v,_.resolve=d,_.reject=function(e){return _(e,p)},_.join=function(){return s(arguments,u)},_.all=a,_.map=s,_.reduce=function(e,o){var t=i.call(arguments,1);return _(e,function(e){var n;return n=e.length,t[0]=function(e,r,i){return _(e,function(t){return _(r,function(e){return o(t,e,i,n)})})},r.apply(e,t)})},_.any=function(e,t,r,i){return o(e,1,function(e){return t?t(e[0]):e[0]},r,i)},_.some=o,_.chain=function(e,t,r){var i=2<arguments.length;return _(e,function(e){return e=i?r:e,t.resolve(e),e},function(e){return t.reject(e),p(e)},t.progress)},_.isPromise=n,h.prototype={always:function(e,t){return this.then(e,e,t)},otherwise:function(e){return this.then(c,e)},yield:function(e){return this.then(function(){return e})},spread:function(t){return this.then(function(e){return a(e,function(e){return t.apply(c,e)})})}},i=[].slice,r=[].reduce||function(e){var t,r,i,n,o;if(o=0,n=(t=Object(this)).length>>>0,(r=arguments).length<=1)for(;;){if(o in t){i=t[o++];break}if(++o>=n)throw new TypeError}else i=r[1];for(;o<n;++o)o in t&&(i=e(i,t[o],o,t));return i},_})}("function"==typeof define&&define.amd?define:function(e){"object"==typeof exports?module.exports=e():this.when=e()}),define("Core/Event",["./Check","./defined","./defineProperties"],function(a,s,e){"use strict";function t(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}function l(e,t){return t-e}return e(t.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}}),t.prototype.addEventListener=function(e,t){a.typeOf.func("listener",e),this._listeners.push(e),this._scopes.push(t);var r=this;return function(){r.removeEventListener(e,t)}},t.prototype.removeEventListener=function(e,t){a.typeOf.func("listener",e);for(var r=this._listeners,i=this._scopes,n=-1,o=0;o<r.length;o++)if(r[o]===e&&i[o]===t){n=o;break}return-1!==n&&(this._insideRaiseEvent?(this._toRemove.push(n),r[n]=void 0,i[n]=void 0):(r.splice(n,1),i.splice(n,1)),!0)},t.prototype.raiseEvent=function(){var e;this._insideRaiseEvent=!0;var t=this._listeners,r=this._scopes,i=t.length;for(e=0;e<i;e++){var n=t[e];s(n)&&t[e].apply(r[e],arguments)}var o=this._toRemove;if(0<(i=o.length)){for(o.sort(l),e=0;e<i;e++){var a=o[e];t.splice(a,1),r.splice(a,1)}o.length=0}this._insideRaiseEvent=!1},t}),define("Core/Heap",["./Check","./defaultValue","./defined","./defineProperties"],function(s,l,u,e){"use strict";function t(e){s.typeOf.object("options",e),s.defined("options.comparator",e.comparator),this._comparator=e.comparator,this._array=[],this._length=0,this._maximumLength=void 0}function c(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}return e(t.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(e){this._maximumLength=e,this._length>e&&0<e&&(this._length=e,this._array.length=e)}},comparator:{get:function(){return this._comparator}}}),t.prototype.reserve=function(e){e=l(e,this._length),this._array.length=e},t.prototype.heapify=function(e){e=l(e,0);for(var t=this._length,r=this._comparator,i=this._array,n=-1,o=!0;o;){var a=2*(e+1),s=a-1;n=s<t&&r(i[s],i[e])<0?s:e,a<t&&r(i[a],i[n])<0&&(n=a),n!==e?(c(i,n,e),e=n):o=!1}},t.prototype.resort=function(){for(var e=this._length,t=Math.ceil(e/2);0<=t;--t)this.heapify(t)},t.prototype.insert=function(e){s.defined("element",e);var t,r=this._array,i=this._comparator,n=this._maximumLength,o=this._length++;for(o<r.length?r[o]=e:r.push(e);0!==o;){var a=Math.floor((o-1)/2);if(!(i(r[o],r[a])<0))break;c(r,o,a),o=a}return u(n)&&this._length>n&&(t=r[n],this._length=n),t},t.prototype.pop=function(e){if(e=l(e,0),0!==this._length){s.typeOf.number.lessThan("index",e,this._length);var t=this._array,r=t[e];return c(t,e,--this._length),this.heapify(e),r}},t}),define("Core/RequestScheduler",["../ThirdParty/Uri","../ThirdParty/when","./Check","./defined","./defineProperties","./Event","./Heap","./isBlobUri","./isDataUri","./RequestState"],function(n,t,o,a,e,r,i,s,l,u){"use strict";var c={numberOfAttemptedRequests:0,numberOfActiveRequests:0,numberOfCancelledRequests:0,numberOfCancelledActiveRequests:0,numberOfFailedRequests:0,numberOfActiveRequestsEver:0},d=20,h=new i({comparator:function(e,t){return e.priority-t.priority}});h.maximumLength=d,h.reserve(d);var p=[],f={},m="undefined"!=typeof document?new n(document.location.href):new n,g=new r;function _(){}function v(e){a(e.priorityFunction)&&(e.priority=e.priorityFunction())}function y(e){return f[e]<_.maximumRequestsPerServer}function b(e){return e.state===u.UNISSUED&&(e.state=u.ISSUED,e.deferred=t.defer()),e.deferred.promise}function C(e){var t,r,i=b(e);return e.state=u.ACTIVE,p.push(e),++c.numberOfActiveRequests,++c.numberOfActiveRequestsEver,++f[e.serverKey],e.requestFunction().then((r=e,function(e){r.state!==u.CANCELLED&&(--c.numberOfActiveRequests,--f[r.serverKey],g.raiseEvent(),r.state=u.RECEIVED,r.deferred.resolve(e))})).otherwise((t=e,function(e){t.state!==u.CANCELLED&&(++c.numberOfFailedRequests,--c.numberOfActiveRequests,--f[t.serverKey],g.raiseEvent(e),t.state=u.FAILED,t.deferred.reject(e))})),i}function w(e){var t=e.state===u.ACTIVE;e.state=u.CANCELLED,++c.numberOfCancelledRequests,e.deferred.reject(),t&&(--c.numberOfActiveRequests,--f[e.serverKey],++c.numberOfCancelledActiveRequests),a(e.cancelFunction)&&e.cancelFunction()}return _.maximumRequests=50,_.maximumRequestsPerServer=6,_.throttleRequests=!0,_.debugShowStatistics=!1,_.requestCompletedEvent=g,e(_,{statistics:{get:function(){return c}},priorityHeapLength:{get:function(){return d},set:function(e){if(e<d)for(;h.length>e;){w(h.pop())}d=e,h.maximumLength=e,h.reserve(e)}}}),_.update=function(){var e,t,r=0,i=p.length;for(e=0;e<i;++e)(t=p[e]).cancelled&&w(t),t.state===u.ACTIVE?0<r&&(p[e-r]=t):++r;p.length-=r;var n=h.internalArray,o=h.length;for(e=0;e<o;++e)v(n[e]);h.resort();for(var a=Math.max(_.maximumRequests-p.length,0),s=0;s<a&&0<h.length;)(t=h.pop()).cancelled?w(t):!t.throttleByServer||y(t.serverKey)?(C(t),++s):w(t);!function(){if(!_.debugShowStatistics)return;0<c.numberOfAttemptedRequests&&console.log("Number of attempted requests: "+c.numberOfAttemptedRequests);0<c.numberOfActiveRequests&&console.log("Number of active requests: "+c.numberOfActiveRequests);0<c.numberOfCancelledRequests&&console.log("Number of cancelled requests: "+c.numberOfCancelledRequests);0<c.numberOfCancelledActiveRequests&&console.log("Number of cancelled active requests: "+c.numberOfCancelledActiveRequests);0<c.numberOfFailedRequests&&console.log("Number of failed requests: "+c.numberOfFailedRequests);c.numberOfAttemptedRequests=0,c.numberOfCancelledRequests=0,c.numberOfCancelledActiveRequests=0}()},_.getServerKey=function(e){o.typeOf.string("url",e);var t=new n(e).resolve(m);t.normalize();var r=t.authority;/:/.test(r)||(r=r+":"+("https"===t.scheme?"443":"80"));var i=f[r];return a(i)||(f[r]=0),r},_.request=function(e){if(o.typeOf.object("request",e),o.typeOf.string("request.url",e.url),o.typeOf.func("request.requestFunction",e.requestFunction),l(e.url)||s(e.url))return g.raiseEvent(),e.state=u.RECEIVED,e.requestFunction();if(++c.numberOfAttemptedRequests,a(e.serverKey)||(e.serverKey=_.getServerKey(e.url)),!_.throttleRequests||!e.throttle)return C(e);if(!(p.length>=_.maximumRequests)&&(!e.throttleByServer||y(e.serverKey))){v(e);var t=h.insert(e);if(a(t)){if(t===e)return;w(t)}return b(e)}},_.clearForSpecs=function(){for(;0<h.length;){w(h.pop())}for(var e=p.length,t=0;t<e;++t)w(p[t]);p.length=0,f={},c.numberOfAttemptedRequests=0,c.numberOfActiveRequests=0,c.numberOfCancelledRequests=0,c.numberOfCancelledActiveRequests=0,c.numberOfFailedRequests=0,c.numberOfActiveRequestsEver=0},_.numberOfActiveRequestsByServer=function(e){return f[e]},_.requestHeap=h,_}),define("Core/RuntimeError",["./defined"],function(t){"use strict";function e(e){var t;this.name="RuntimeError",this.message=e;try{throw new Error}catch(e){t=e.stack}this.stack=t}return t(Object.create)&&((e.prototype=Object.create(Error.prototype)).constructor=e),e.prototype.toString=function(){var e=this.name+": "+this.message;return t(this.stack)&&(e+="\n"+this.stack.toString()),e},e}),define("Core/TrustedServers",["../ThirdParty/Uri","./defined","./DeveloperError"],function(n,o,i){"use strict";var e={},a={};return e.add=function(e,t){if(!o(e))throw new i("host is required.");if(!o(t)||t<=0)throw new i("port is required to be greater than 0.");var r=e.toLowerCase()+":"+t;o(a[r])||(a[r]=!0)},e.remove=function(e,t){if(!o(e))throw new i("host is required.");if(!o(t)||t<=0)throw new i("port is required to be greater than 0.");var r=e.toLowerCase()+":"+t;o(a[r])&&delete a[r]},e.contains=function(e){if(!o(e))throw new i("url is required.");var t=function(e){var t=new n(e);t.normalize();var r=t.getAuthority();if(o(r)){if(-1!==r.indexOf("@")&&(r=r.split("@")[1]),-1===r.indexOf(":")){var i=t.getScheme();if(o(i)||(i=(i=window.location.protocol).substring(0,i.length-1)),"http"===i)r+=":80";else{if("https"!==i)return;r+=":443"}}return r}}(e);return!(!o(t)||!o(a[t]))},e.clear=function(){a={}},e}),define("Core/Resource",["./appendForwardSlash","./Check","./clone","./combine","./defaultValue","./defined","./defineProperties","./deprecationWarning","./DeveloperError","./freezeObject","./getAbsoluteUri","./getBaseUri","./getExtensionFromUri","./isBlobUri","./isCrossOriginUrl","./isDataUri","./objectToQuery","./queryToObject","./Request","./RequestErrorEvent","./RequestScheduler","./RequestState","./RuntimeError","./TrustedServers","../ThirdParty/Uri","../ThirdParty/when"],function(e,r,i,c,d,h,t,o,p,n,a,s,l,u,f,m,g,_,v,y,b,C,w,S,T,E){"use strict";var A=function(){try{var e=new XMLHttpRequest;return e.open("GET","#",!0),(e.responseType="blob")===e.responseType}catch(e){return!1}}();function x(e,t){var r,i=e.query;if(!h(i)||0===i.length)return{};if(-1===i.indexOf("=")){var n={};n[i]=void 0,r=n}else r=_(i);t._queryParameters=c(t._queryParameters,r),e.query=void 0}function P(e,t){return h(e)?h(e.clone)?e.clone():i(e):t}function D(e){if(e.state===C.ISSUED||e.state===C.ACTIVE)throw new w("The Resource is already being fetched.");e.state=C.UNISSUED,e.deferred=void 0}function O(e){"string"==typeof(e=d(e,d.EMPTY_OBJECT))&&(e={url:e}),r.typeOf.string("options.url",e.url),this._url=void 0,this._templateValues=P(e.templateValues,{}),this._queryParameters=P(e.queryParameters,{}),this.headers=P(e.headers,{}),this.request=d(e.request,new v),this.proxy=e.proxy,this.retryCallback=e.retryCallback,this.retryAttempts=d(e.retryAttempts,0),this._retryCount=0,this.url=e.url}function I(i,n){var r=i.request;r.url=i.url,r.requestFunction=function(){var e=i.url,t=!1;i.isDataUri||i.isBlobUri||(t=i.isCrossOriginUrl);var r=E.defer();return O._Implementations.createImage(e,t&&n,r),r.promise};var e=b.request(r);if(h(e))return e.otherwise(function(t){return r.state!==C.FAILED?E.reject(t):i.retryOnError(t).then(function(e){return e?(r.state=C.UNISSUED,r.deferred=void 0,I(i,n)):E.reject(t)})})}function M(s,l){D(s.request);var u=s.request;u.url=s.url,u.requestFunction=function(){var e=l.responseType,t=c(s.headers,l.headers),r=l.overrideMimeType,i=l.method,n=l.data,o=E.defer(),a=O._Implementations.loadWithXhr(s.url,e,i,n,t,o,r);return h(a)&&h(a.abort)&&(u.cancelFunction=function(){a.abort()}),o.promise};var e=b.request(u);if(h(e))return e.then(function(e){return e}).otherwise(function(t){return u.state!==C.FAILED?E.reject(t):s.retryOnError(t).then(function(e){return e?(u.state=C.UNISSUED,u.deferred=void 0,s.fetch(l)):E.reject(t)})})}O.createIfNeeded=function(e,t){if(e instanceof O)return e.clone();if("string"!=typeof e)return e;var r=P(t,{});return r.url=e,new O(r)},t(O,{isBlobSupported:{get:function(){return A}}}),t(O.prototype,{queryParameters:{get:function(){return this._queryParameters}},templateValues:{get:function(){return this._templateValues}},url:{get:function(){return this.getUrlComponent(!0,!0)},set:function(e){var t=new T(e);x(t,this),t.fragment=void 0,this._url=t.toString()}},extension:{get:function(){return l(this._url)}},isDataUri:{get:function(){return m(this._url)}},isBlobUri:{get:function(){return u(this._url)}},isCrossOriginUrl:{get:function(){return f(this._url)}},hasHeaders:{get:function(){return 0<Object.keys(this.headers).length}}}),O.prototype.getUrlComponent=function(e,t){if(this.isDataUri)return this._url;var r,i,n,o=new T(this._url);e&&(r=o,i=this._queryParameters,1!==(n=Object.keys(i)).length||h(i[n[0]])?r.query=g(i):r.query=n[0]);var a=o.toString().replace(/%7B/g,"{").replace(/%7D/g,"}"),s=this._templateValues,l=Object.keys(s);if(0<l.length)for(var u=0;u<l.length;u++){var c=l[u],d=s[c];a=a.replace(new RegExp("{"+c+"}","g"),encodeURIComponent(d))}return t&&h(this.proxy)&&(a=this.proxy.getURL(a)),a},O.prototype.addQueryParameters=function(e,t){this._queryParameters=t?c(this._queryParameters,e):c(e,this._queryParameters)},O.prototype.addTemplateValues=function(e,t){this._templateValues=t?c(this._templateValues,e):c(e,this._templateValues)},O.prototype.getDerivedResource=function(e){var t=this.clone();if(t._retryCount=0,h(e.url)){var r=new T(e.url);x(r,t),r.fragment=void 0,t._url=r.resolve(new T(a(this._url))).toString()}return h(e.queryParameters)&&(t._queryParameters=c(e.queryParameters,t._queryParameters)),h(e.templateValues)&&(t._templateValues=c(e.templateValues,t.templateValues)),h(e.headers)&&(t.headers=c(e.headers,t.headers)),h(e.proxy)&&(t.proxy=e.proxy),h(e.request)?t.request=e.request:t.request=this.request.clone(),h(e.retryCallback)&&(t.retryCallback=e.retryCallback),h(e.retryAttempts)&&(t.retryAttempts=e.retryAttempts),t},O.prototype.retryOnError=function(e){var t=this.retryCallback;if("function"!=typeof t||this._retryCount>=this.retryAttempts)return E(!1);var r=this;return E(t(this,e)).then(function(e){return++r._retryCount,e})},O.prototype.clone=function(e){return h(e)||(e=new O({url:this._url})),e._url=this._url,e._queryParameters=i(this._queryParameters),e._templateValues=i(this._templateValues),e.headers=i(this.headers),e.proxy=this.proxy,e.retryCallback=this.retryCallback,e.retryAttempts=this.retryAttempts,e._retryCount=0,e.request=this.request,e},O.prototype.getBaseUri=function(e){return s(this.getUrlComponent(e),e)},O.prototype.appendForwardSlash=function(){this._url=e(this._url)},O.prototype.fetchArrayBuffer=function(){return this.fetch({responseType:"arraybuffer"})},O.fetchArrayBuffer=function(e){return new O(e).fetchArrayBuffer()},O.prototype.fetchBlob=function(){return this.fetch({responseType:"blob"})},O.fetchBlob=function(e){return new O(e).fetchBlob()},O.prototype.fetchImage=function(e,t){if(h(t)&&o("Resource.fetchImage.allowCrossOrigin","The allowCrossOrigin parameter has been deprecated and will be removed in Cesium 1.44. It no longer needs to be specified."),e=d(e,!1),t=d(t,!0),D(this.request),!A||this.isDataUri||this.isBlobUri||!this.hasHeaders&&!e)return I(this,t);var r,i,n=this.fetchBlob();return h(n)?n.then(function(e){if(h(e)){i=e;var t=window.URL.createObjectURL(e);return I(r=new O({url:t}))}}).then(function(e){if(h(e))return window.URL.revokeObjectURL(r.url),e.blob=i,e}).otherwise(function(e){return h(r)&&window.URL.revokeObjectURL(r.url),E.reject(e)}):void 0},O.fetchImage=function(e){return new O(e).fetchImage(e.preferBlob,e.allowCrossOrigin)},O.prototype.fetchText=function(){return this.fetch({responseType:"text"})},O.fetchText=function(e){return new O(e).fetchText()},O.prototype.fetchJson=function(){var e=this.fetch({responseType:"text",headers:{Accept:"application/json,*/*;q=0.01"}});if(h(e))return e.then(function(e){if(h(e))return JSON.parse(e)})},O.fetchJson=function(e){return new O(e).fetchJson()},O.prototype.fetchXML=function(){return this.fetch({responseType:"document",overrideMimeType:"text/xml"})},O.fetchXML=function(e){return new O(e).fetchXML()},O.prototype.fetchJsonp=function(e){var t;for(e=d(e,"callback"),D(this.request);t="loadJsonp"+Math.random().toString().substring(2,8),h(window[t]););return function r(i,n,o){var e={};e[n]=o;i.addQueryParameters(e);var a=i.request;a.url=i.url;a.requestFunction=function(){var t=E.defer();return window[o]=function(e){t.resolve(e);try{delete window[o]}catch(e){window[o]=void 0}},O._Implementations.loadAndExecuteScript(i.url,o,t),t.promise};var t=b.request(a);if(!h(t))return;return t.otherwise(function(t){return a.state!==C.FAILED?E.reject(t):i.retryOnError(t).then(function(e){return e?(a.state=C.UNISSUED,a.deferred=void 0,r(i,n,o)):E.reject(t)})})}(this,e,t)},O.fetchJsonp=function(e){return new O(e).fetchJsonp(e.callbackParameterName)},O.prototype.fetch=function(e){return(e=P(e,d.EMPTY_OBJECT)).method="GET",M(this,e)};var R=/^data:(.*?)(;base64)?,(.*)$/;function L(e,t){var r=decodeURIComponent(t);return e?atob(r):r}function N(e,t){for(var r=L(e,t),i=new ArrayBuffer(r.length),n=new Uint8Array(i),o=0;o<r.length;o++)n[o]=r.charCodeAt(o);return i}return O.fetch=function(e){return new O(e).fetch({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},O.prototype.post=function(e,t){return r.defined("data",e),(t=P(t,{})).method="POST",t.data=e,M(this,t)},O.post=function(e){return new O(e).post(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},(O._Implementations={}).createImage=function(e,t,r){var i=new Image;i.onload=function(){r.resolve(i)},i.onerror=function(e){r.reject(e)},t&&(S.contains(e)?i.crossOrigin="use-credentials":i.crossOrigin=""),i.src=e},O._Implementations.loadWithXhr=function(e,r,t,i,n,o,a){var s=R.exec(e);if(null===s){var l=new XMLHttpRequest;if(S.contains(e)&&(l.withCredentials=!0),h(a)&&h(l.overrideMimeType)&&l.overrideMimeType(a),l.open(t,e,!0),h(n))for(var u in n)n.hasOwnProperty(u)&&l.setRequestHeader(u,n[u]);h(r)&&(l.responseType=r);var c=!1;return"string"==typeof e&&(c=0===e.indexOf("file://")),l.onload=function(){if(!(l.status<200||300<=l.status)||c&&0===l.status){var e=l.response,t=l.responseType;if(204===l.status)o.resolve();else if(!h(e)||h(r)&&t!==r)if("json"===r&&"string"==typeof e)try{o.resolve(JSON.parse(e))}catch(e){o.reject(e)}else(""===t||"document"===t)&&h(l.responseXML)&&l.responseXML.hasChildNodes()?o.resolve(l.responseXML):""!==t&&"text"!==t||!h(l.responseText)?o.reject(new w("Invalid XMLHttpRequest response type.")):o.resolve(l.responseText);else o.resolve(e)}else o.reject(new y(l.status,l.response,l.getAllResponseHeaders()))},l.onerror=function(e){o.reject(new y)},l.send(i),l}o.resolve(function(e,t){t=d(t,"");var r=e[1],i=!!e[2],n=e[3];switch(t){case"":case"text":return L(i,n);case"arraybuffer":return N(i,n);case"blob":var o=N(i,n);return new Blob([o],{type:r});case"document":return(new DOMParser).parseFromString(L(i,n),r);case"json":return JSON.parse(L(i,n));default:throw new p("Unhandled responseType: "+t)}}(s,r))},O._Implementations.loadAndExecuteScript=function(e,t,r){var i=document.createElement("script");i.async=!0,i.src=e;var n=document.getElementsByTagName("head")[0];i.onload=function(){i.onload=void 0,n.removeChild(i)},i.onerror=function(e){r.reject(e)},n.appendChild(i)},(O._DefaultImplementations={}).createImage=O._Implementations.createImage,O._DefaultImplementations.loadWithXhr=O._Implementations.loadWithXhr,O._DefaultImplementations.loadAndExecuteScript=O._Implementations.loadAndExecuteScript,O.DEFAULT=n(new O({url:"undefined"==typeof document?"":document.location.href.split("?")[0]})),O}),define("Core/BingMapsGeocoderService",["./BingMapsApi","./Check","./defaultValue","./defined","./defineProperties","./Rectangle","./Resource"],function(i,n,o,a,e,s,l){"use strict";var u="https://dev.virtualearth.net/REST/v1/Locations";function t(e){e=o(e,o.EMPTY_OBJECT),n.typeOf.object("options.scene",e.scene);var t=e.key;if(this._key=i.getKey(t),a(t)){var r=i.getErrorCredit(t);a(r)&&e.scene._frameState.creditDisplay.addDefaultCredit(r)}this._resource=new l({url:u,queryParameters:{key:this._key}})}return e(t.prototype,{url:{get:function(){return u}},key:{get:function(){return this._key}}}),t.prototype.geocode=function(e){return n.typeOf.string("query",e),this._resource.getDerivedResource({queryParameters:{query:e}}).fetchJsonp("jsonp").then(function(e){return 0===e.resourceSets.length?[]:e.resourceSets[0].resources.map(function(e){var t=e.bbox,r=t[0],i=t[1],n=t[2],o=t[3];return{displayName:e.name,destination:s.fromDegrees(i,r,o,n)}})})},t}),define("Core/GeographicProjection",["./Cartesian3","./Cartographic","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid"],function(a,s,t,l,e,u,r){"use strict";function i(e){this._ellipsoid=t(e,r.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}return e(i.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),i.prototype.project=function(e,t){var r=this._semimajorAxis,i=e.longitude*r,n=e.latitude*r,o=e.height;return l(t)?(t.x=i,t.y=n,t.z=o,t):new a(i,n,o)},i.prototype.unproject=function(e,t){if(!l(e))throw new u("cartesian is required");var r=this._oneOverSemimajorAxis,i=e.x*r,n=e.y*r,o=e.z;return l(t)?(t.longitude=i,t.latitude=n,t.height=o,t):new s(i,n,o)},i}),define("Core/BoundingRectangle",["./Cartesian2","./Cartographic","./Check","./defaultValue","./defined","./GeographicProjection","./Intersect","./Rectangle"],function(o,e,s,a,d,t,l,u){"use strict";function h(e,t,r,i){this.x=a(e,0),this.y=a(t,0),this.width=a(r,0),this.height=a(i,0)}h.packedLength=4,h.pack=function(e,t,r){return s.typeOf.object("value",e),s.defined("array",t),r=a(r,0),t[r++]=e.x,t[r++]=e.y,t[r++]=e.width,t[r]=e.height,t},h.unpack=function(e,t,r){return s.defined("array",e),t=a(t,0),d(r)||(r=new h),r.x=e[t++],r.y=e[t++],r.width=e[t++],r.height=e[t],r},h.fromPoints=function(e,t){if(d(t)||(t=new h),!d(e)||0===e.length)return t.x=0,t.y=0,t.width=0,t.height=0,t;for(var r=e.length,i=e[0].x,n=e[0].y,o=e[0].x,a=e[0].y,s=1;s<r;s++){var l=e[s],u=l.x,c=l.y;i=Math.min(u,i),o=Math.max(u,o),n=Math.min(c,n),a=Math.max(c,a)}return t.x=i,t.y=n,t.width=o-i,t.height=a-n,t};var c=new t,p=new e,f=new e;return h.fromRectangle=function(e,t,r){if(d(r)||(r=new h),!d(e))return r.x=0,r.y=0,r.width=0,r.height=0,r;var i=(t=a(t,c)).project(u.southwest(e,p)),n=t.project(u.northeast(e,f));return o.subtract(n,i,n),r.x=i.x,r.y=i.y,r.width=n.x,r.height=n.y,r},h.clone=function(e,t){if(d(e))return d(t)?(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t):new h(e.x,e.y,e.width,e.height)},h.union=function(e,t,r){s.typeOf.object("left",e),s.typeOf.object("right",t),d(r)||(r=new h);var i=Math.min(e.x,t.x),n=Math.min(e.y,t.y),o=Math.max(e.x+e.width,t.x+t.width),a=Math.max(e.y+e.height,t.y+t.height);return r.x=i,r.y=n,r.width=o-i,r.height=a-n,r},h.expand=function(e,t,r){s.typeOf.object("rectangle",e),s.typeOf.object("point",t),r=h.clone(e,r);var i=t.x-r.x,n=t.y-r.y;return i>r.width?r.width=i:i<0&&(r.width-=i,r.x=t.x),n>r.height?r.height=n:n<0&&(r.height-=n,r.y=t.y),r},h.intersect=function(e,t){s.typeOf.object("left",e),s.typeOf.object("right",t);var r=e.x,i=e.y,n=t.x,o=t.y;return r>n+t.width||r+e.width<n||i+e.height<o||i>o+t.height?l.OUTSIDE:l.INTERSECTING},h.equals=function(e,t){return e===t||d(e)&&d(t)&&e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height},h.prototype.clone=function(e){return h.clone(this,e)},h.prototype.intersect=function(e){return h.intersect(this,e)},h.prototype.equals=function(e){return h.equals(this,e)},h}),define("Core/Interval",["./defaultValue"],function(r){"use strict";return function(e,t){this.start=r(e,0),this.stop=r(t,0)}}),define("Core/Matrix3",["./Cartesian3","./Check","./defaultValue","./defined","./defineProperties","./DeveloperError","./freezeObject","./Math"],function(r,C,u,w,e,h,t,p){"use strict";function S(e,t,r,i,n,o,a,s,l){this[0]=u(e,0),this[1]=u(i,0),this[2]=u(a,0),this[3]=u(t,0),this[4]=u(n,0),this[5]=u(s,0),this[6]=u(r,0),this[7]=u(o,0),this[8]=u(l,0)}S.packedLength=9,S.pack=function(e,t,r){return C.typeOf.object("value",e),C.defined("array",t),r=u(r,0),t[r++]=e[0],t[r++]=e[1],t[r++]=e[2],t[r++]=e[3],t[r++]=e[4],t[r++]=e[5],t[r++]=e[6],t[r++]=e[7],t[r++]=e[8],t},S.unpack=function(e,t,r){return C.defined("array",e),t=u(t,0),w(r)||(r=new S),r[0]=e[t++],r[1]=e[t++],r[2]=e[t++],r[3]=e[t++],r[4]=e[t++],r[5]=e[t++],r[6]=e[t++],r[7]=e[t++],r[8]=e[t++],r},S.clone=function(e,t){if(w(e))return w(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):new S(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])},S.fromArray=function(e,t,r){return C.defined("array",e),t=u(t,0),w(r)||(r=new S),r[0]=e[t],r[1]=e[t+1],r[2]=e[t+2],r[3]=e[t+3],r[4]=e[t+4],r[5]=e[t+5],r[6]=e[t+6],r[7]=e[t+7],r[8]=e[t+8],r},S.fromColumnMajorArray=function(e,t){return C.defined("values",e),S.clone(e,t)},S.fromRowMajorArray=function(e,t){return C.defined("values",e),w(t)?(t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t):new S(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},S.fromQuaternion=function(e,t){C.typeOf.object("quaternion",e);var r=e.x*e.x,i=e.x*e.y,n=e.x*e.z,o=e.x*e.w,a=e.y*e.y,s=e.y*e.z,l=e.y*e.w,u=e.z*e.z,c=e.z*e.w,d=e.w*e.w,h=r-a-u+d,p=2*(i-c),f=2*(n+l),m=2*(i+c),g=-r+a-u+d,_=2*(s-o),v=2*(n-l),y=2*(s+o),b=-r-a+u+d;return w(t)?(t[0]=h,t[1]=m,t[2]=v,t[3]=p,t[4]=g,t[5]=y,t[6]=f,t[7]=_,t[8]=b,t):new S(h,p,f,m,g,_,v,y,b)},S.fromHeadingPitchRoll=function(e,t){C.typeOf.object("headingPitchRoll",e);var r=Math.cos(-e.pitch),i=Math.cos(-e.heading),n=Math.cos(e.roll),o=Math.sin(-e.pitch),a=Math.sin(-e.heading),s=Math.sin(e.roll),l=r*i,u=-n*a+s*o*i,c=s*a+n*o*i,d=r*a,h=n*i+s*o*a,p=-s*i+n*o*a,f=-o,m=s*r,g=n*r;return w(t)?(t[0]=l,t[1]=d,t[2]=f,t[3]=u,t[4]=h,t[5]=m,t[6]=c,t[7]=p,t[8]=g,t):new S(l,u,c,d,h,p,f,m,g)},S.fromScale=function(e,t){return C.typeOf.object("scale",e),w(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=e.y,t[5]=0,t[6]=0,t[7]=0,t[8]=e.z,t):new S(e.x,0,0,0,e.y,0,0,0,e.z)},S.fromUniformScale=function(e,t){return C.typeOf.number("scale",e),w(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=e,t):new S(e,0,0,0,e,0,0,0,e)},S.fromCrossProduct=function(e,t){return C.typeOf.object("vector",e),w(t)?(t[0]=0,t[1]=e.z,t[2]=-e.y,t[3]=-e.z,t[4]=0,t[5]=e.x,t[6]=e.y,t[7]=-e.x,t[8]=0,t):new S(0,-e.z,e.y,e.z,0,-e.x,-e.y,e.x,0)},S.fromRotationX=function(e,t){C.typeOf.number("angle",e);var r=Math.cos(e),i=Math.sin(e);return w(t)?(t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=r,t[5]=i,t[6]=0,t[7]=-i,t[8]=r,t):new S(1,0,0,0,r,-i,0,i,r)},S.fromRotationY=function(e,t){C.typeOf.number("angle",e);var r=Math.cos(e),i=Math.sin(e);return w(t)?(t[0]=r,t[1]=0,t[2]=-i,t[3]=0,t[4]=1,t[5]=0,t[6]=i,t[7]=0,t[8]=r,t):new S(r,0,i,0,1,0,-i,0,r)},S.fromRotationZ=function(e,t){C.typeOf.number("angle",e);var r=Math.cos(e),i=Math.sin(e);return w(t)?(t[0]=r,t[1]=i,t[2]=0,t[3]=-i,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new S(r,-i,0,i,r,0,0,0,1)},S.toArray=function(e,t){return C.typeOf.object("matrix",e),w(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},S.getElementIndex=function(e,t){return C.typeOf.number.greaterThanOrEquals("row",t,0),C.typeOf.number.lessThanOrEquals("row",t,2),C.typeOf.number.greaterThanOrEquals("column",e,0),C.typeOf.number.lessThanOrEquals("column",e,2),3*e+t},S.getColumn=function(e,t,r){C.typeOf.object("matrix",e),C.typeOf.number.greaterThanOrEquals("index",t,0),C.typeOf.number.lessThanOrEquals("index",t,2),C.typeOf.object("result",r);var i=3*t,n=e[i],o=e[i+1],a=e[i+2];return r.x=n,r.y=o,r.z=a,r},S.setColumn=function(e,t,r,i){C.typeOf.object("matrix",e),C.typeOf.number.greaterThanOrEquals("index",t,0),C.typeOf.number.lessThanOrEquals("index",t,2),C.typeOf.object("cartesian",r),C.typeOf.object("result",i);var n=3*t;return(i=S.clone(e,i))[n]=r.x,i[n+1]=r.y,i[n+2]=r.z,i},S.getRow=function(e,t,r){C.typeOf.object("matrix",e),C.typeOf.number.greaterThanOrEquals("index",t,0),C.typeOf.number.lessThanOrEquals("index",t,2),C.typeOf.object("result",r);var i=e[t],n=e[t+3],o=e[t+6];return r.x=i,r.y=n,r.z=o,r},S.setRow=function(e,t,r,i){return C.typeOf.object("matrix",e),C.typeOf.number.greaterThanOrEquals("index",t,0),C.typeOf.number.lessThanOrEquals("index",t,2),C.typeOf.object("cartesian",r),C.typeOf.object("result",i),(i=S.clone(e,i))[t]=r.x,i[t+3]=r.y,i[t+6]=r.z,i};var i=new r;S.getScale=function(e,t){return C.typeOf.object("matrix",e),C.typeOf.object("result",t),t.x=r.magnitude(r.fromElements(e[0],e[1],e[2],i)),t.y=r.magnitude(r.fromElements(e[3],e[4],e[5],i)),t.z=r.magnitude(r.fromElements(e[6],e[7],e[8],i)),t};var n=new r;S.getMaximumScale=function(e){return S.getScale(e,n),r.maximumComponent(n)},S.multiply=function(e,t,r){C.typeOf.object("left",e),C.typeOf.object("right",t),C.typeOf.object("result",r);var i=e[0]*t[0]+e[3]*t[1]+e[6]*t[2],n=e[1]*t[0]+e[4]*t[1]+e[7]*t[2],o=e[2]*t[0]+e[5]*t[1]+e[8]*t[2],a=e[0]*t[3]+e[3]*t[4]+e[6]*t[5],s=e[1]*t[3]+e[4]*t[4]+e[7]*t[5],l=e[2]*t[3]+e[5]*t[4]+e[8]*t[5],u=e[0]*t[6]+e[3]*t[7]+e[6]*t[8],c=e[1]*t[6]+e[4]*t[7]+e[7]*t[8],d=e[2]*t[6]+e[5]*t[7]+e[8]*t[8];return r[0]=i,r[1]=n,r[2]=o,r[3]=a,r[4]=s,r[5]=l,r[6]=u,r[7]=c,r[8]=d,r},S.add=function(e,t,r){return C.typeOf.object("left",e),C.typeOf.object("right",t),C.typeOf.object("result",r),r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r[6]=e[6]+t[6],r[7]=e[7]+t[7],r[8]=e[8]+t[8],r},S.subtract=function(e,t,r){return C.typeOf.object("left",e),C.typeOf.object("right",t),C.typeOf.object("result",r),r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r[4]=e[4]-t[4],r[5]=e[5]-t[5],r[6]=e[6]-t[6],r[7]=e[7]-t[7],r[8]=e[8]-t[8],r},S.multiplyByVector=function(e,t,r){C.typeOf.object("matrix",e),C.typeOf.object("cartesian",t),C.typeOf.object("result",r);var i=t.x,n=t.y,o=t.z,a=e[0]*i+e[3]*n+e[6]*o,s=e[1]*i+e[4]*n+e[7]*o,l=e[2]*i+e[5]*n+e[8]*o;return r.x=a,r.y=s,r.z=l,r},S.multiplyByScalar=function(e,t,r){return C.typeOf.object("matrix",e),C.typeOf.number("scalar",t),C.typeOf.object("result",r),r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r[6]=e[6]*t,r[7]=e[7]*t,r[8]=e[8]*t,r},S.multiplyByScale=function(e,t,r){return C.typeOf.object("matrix",e),C.typeOf.object("scale",t),C.typeOf.object("result",r),r[0]=e[0]*t.x,r[1]=e[1]*t.x,r[2]=e[2]*t.x,r[3]=e[3]*t.y,r[4]=e[4]*t.y,r[5]=e[5]*t.y,r[6]=e[6]*t.z,r[7]=e[7]*t.z,r[8]=e[8]*t.z,r},S.negate=function(e,t){return C.typeOf.object("matrix",e),C.typeOf.object("result",t),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t},S.transpose=function(e,t){C.typeOf.object("matrix",e),C.typeOf.object("result",t);var r=e[0],i=e[3],n=e[6],o=e[1],a=e[4],s=e[7],l=e[2],u=e[5],c=e[8];return t[0]=r,t[1]=i,t[2]=n,t[3]=o,t[4]=a,t[5]=s,t[6]=l,t[7]=u,t[8]=c,t};var f=[1,0,0],m=[2,2,1];function l(e){for(var t=0,r=0;r<3;++r){var i=e[S.getElementIndex(m[r],f[r])];t+=2*i*i}return Math.sqrt(t)}function c(e,t){for(var r=p.EPSILON15,i=0,n=1,o=0;o<3;++o){var a=Math.abs(e[S.getElementIndex(m[o],f[o])]);i<a&&(n=o,i=a)}var s=1,l=0,u=f[n],c=m[n];if(Math.abs(e[S.getElementIndex(c,u)])>r){var d,h=(e[S.getElementIndex(c,c)]-e[S.getElementIndex(u,u)])/2/e[S.getElementIndex(c,u)];l=(d=h<0?-1/(-h+Math.sqrt(1+h*h)):1/(h+Math.sqrt(1+h*h)))*(s=1/Math.sqrt(1+d*d))}return(t=S.clone(S.IDENTITY,t))[S.getElementIndex(u,u)]=t[S.getElementIndex(c,c)]=s,t[S.getElementIndex(c,u)]=l,t[S.getElementIndex(u,c)]=-l,t}var d=new S,g=new S;return S.computeEigenDecomposition=function(e,t){C.typeOf.object("matrix",e);var r=p.EPSILON20,i=0,n=0;w(t)||(t={});for(var o=t.unitary=S.clone(S.IDENTITY,t.unitary),a=t.diagonal=S.clone(e,t.diagonal),s=r*function(e){for(var t=0,r=0;r<9;++r){var i=e[r];t+=i*i}return Math.sqrt(t)}(a);n<10&&l(a)>s;)c(a,d),S.transpose(d,g),S.multiply(a,d,a),S.multiply(g,a,a),S.multiply(o,d,o),2<++i&&(++n,i=0);return t},S.abs=function(e,t){return C.typeOf.object("matrix",e),C.typeOf.object("result",t),t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t},S.determinant=function(e){C.typeOf.object("matrix",e);var t=e[0],r=e[3],i=e[6],n=e[1],o=e[4],a=e[7],s=e[2],l=e[5],u=e[8];return t*(o*u-l*a)+n*(l*i-r*u)+s*(r*a-o*i)},S.inverse=function(e,t){C.typeOf.object("matrix",e),C.typeOf.object("result",t);var r=e[0],i=e[1],n=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],d=S.determinant(e);if(Math.abs(d)<=p.EPSILON15)throw new h("matrix is not invertible");return t[0]=a*c-u*s,t[1]=u*n-i*c,t[2]=i*s-a*n,t[3]=l*s-o*c,t[4]=r*c-l*n,t[5]=o*n-r*s,t[6]=o*u-l*a,t[7]=l*i-r*u,t[8]=r*a-o*i,S.multiplyByScalar(t,1/d,t)},S.equals=function(e,t){return e===t||w(e)&&w(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},S.equalsEpsilon=function(e,t,r){return C.typeOf.number("epsilon",r),e===t||w(e)&&w(t)&&Math.abs(e[0]-t[0])<=r&&Math.abs(e[1]-t[1])<=r&&Math.abs(e[2]-t[2])<=r&&Math.abs(e[3]-t[3])<=r&&Math.abs(e[4]-t[4])<=r&&Math.abs(e[5]-t[5])<=r&&Math.abs(e[6]-t[6])<=r&&Math.abs(e[7]-t[7])<=r&&Math.abs(e[8]-t[8])<=r},S.IDENTITY=t(new S(1,0,0,0,1,0,0,0,1)),S.ZERO=t(new S(0,0,0,0,0,0,0,0,0)),S.COLUMN0ROW0=0,S.COLUMN0ROW1=1,S.COLUMN0ROW2=2,S.COLUMN1ROW0=3,S.COLUMN1ROW1=4,S.COLUMN1ROW2=5,S.COLUMN2ROW0=6,S.COLUMN2ROW1=7,S.COLUMN2ROW2=8,e(S.prototype,{length:{get:function(){return S.packedLength}}}),S.prototype.clone=function(e){return S.clone(this,e)},S.prototype.equals=function(e){return S.equals(this,e)},S.equalsArray=function(e,t,r){return e[0]===t[r]&&e[1]===t[r+1]&&e[2]===t[r+2]&&e[3]===t[r+3]&&e[4]===t[r+4]&&e[5]===t[r+5]&&e[6]===t[r+6]&&e[7]===t[r+7]&&e[8]===t[r+8]},S.prototype.equalsEpsilon=function(e,t){return S.equalsEpsilon(this,e,t)},S.prototype.toString=function(){return"("+this[0]+", "+this[3]+", "+this[6]+")\n("+this[1]+", "+this[4]+", "+this[7]+")\n("+this[2]+", "+this[5]+", "+this[8]+")"},S}),define("Core/Cartesian4",["./Check","./defaultValue","./defined","./DeveloperError","./freezeObject","./Math"],function(o,n,a,i,e,s){"use strict";function l(e,t,r,i){this.x=n(e,0),this.y=n(t,0),this.z=n(r,0),this.w=n(i,0)}l.fromElements=function(e,t,r,i,n){return a(n)?(n.x=e,n.y=t,n.z=r,n.w=i,n):new l(e,t,r,i)},l.fromColor=function(e,t){return o.typeOf.object("color",e),a(t)?(t.x=e.red,t.y=e.green,t.z=e.blue,t.w=e.alpha,t):new l(e.red,e.green,e.blue,e.alpha)},l.clone=function(e,t){if(a(e))return a(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new l(e.x,e.y,e.z,e.w)},l.packedLength=4,l.pack=function(e,t,r){return o.typeOf.object("value",e),o.defined("array",t),r=n(r,0),t[r++]=e.x,t[r++]=e.y,t[r++]=e.z,t[r]=e.w,t},l.unpack=function(e,t,r){return o.defined("array",e),t=n(t,0),a(r)||(r=new l),r.x=e[t++],r.y=e[t++],r.z=e[t++],r.w=e[t],r},l.packArray=function(e,t){o.defined("array",e);var r=e.length;a(t)?t.length=4*r:t=new Array(4*r);for(var i=0;i<r;++i)l.pack(e[i],t,4*i);return t},l.unpackArray=function(e,t){o.defined("array",e);var r=e.length;a(t)?t.length=r/4:t=new Array(r/4);for(var i=0;i<r;i+=4){var n=i/4;t[n]=l.unpack(e,i,t[n])}return t},l.fromArray=l.unpack,l.maximumComponent=function(e){return o.typeOf.object("cartesian",e),Math.max(e.x,e.y,e.z,e.w)},l.minimumComponent=function(e){return o.typeOf.object("cartesian",e),Math.min(e.x,e.y,e.z,e.w)},l.minimumByComponent=function(e,t,r){return o.typeOf.object("first",e),o.typeOf.object("second",t),o.typeOf.object("result",r),r.x=Math.min(e.x,t.x),r.y=Math.min(e.y,t.y),r.z=Math.min(e.z,t.z),r.w=Math.min(e.w,t.w),r},l.maximumByComponent=function(e,t,r){return o.typeOf.object("first",e),o.typeOf.object("second",t),o.typeOf.object("result",r),r.x=Math.max(e.x,t.x),r.y=Math.max(e.y,t.y),r.z=Math.max(e.z,t.z),r.w=Math.max(e.w,t.w),r},l.magnitudeSquared=function(e){return o.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},l.magnitude=function(e){return Math.sqrt(l.magnitudeSquared(e))};var r=new l;l.distance=function(e,t){return o.typeOf.object("left",e),o.typeOf.object("right",t),l.subtract(e,t,r),l.magnitude(r)},l.distanceSquared=function(e,t){return o.typeOf.object("left",e),o.typeOf.object("right",t),l.subtract(e,t,r),l.magnitudeSquared(r)},l.normalize=function(e,t){o.typeOf.object("cartesian",e),o.typeOf.object("result",t);var r=l.magnitude(e);if(t.x=e.x/r,t.y=e.y/r,t.z=e.z/r,t.w=e.w/r,isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||isNaN(t.w))throw new i("normalized result is not a number");return t},l.dot=function(e,t){return o.typeOf.object("left",e),o.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},l.multiplyComponents=function(e,t,r){return o.typeOf.object("left",e),o.typeOf.object("right",t),o.typeOf.object("result",r),r.x=e.x*t.x,r.y=e.y*t.y,r.z=e.z*t.z,r.w=e.w*t.w,r},l.divideComponents=function(e,t,r){return o.typeOf.object("left",e),o.typeOf.object("right",t),o.typeOf.object("result",r),r.x=e.x/t.x,r.y=e.y/t.y,r.z=e.z/t.z,r.w=e.w/t.w,r},l.add=function(e,t,r){return o.typeOf.object("left",e),o.typeOf.object("right",t),o.typeOf.object("result",r),r.x=e.x+t.x,r.y=e.y+t.y,r.z=e.z+t.z,r.w=e.w+t.w,r},l.subtract=function(e,t,r){return o.typeOf.object("left",e),o.typeOf.object("right",t),o.typeOf.object("result",r),r.x=e.x-t.x,r.y=e.y-t.y,r.z=e.z-t.z,r.w=e.w-t.w,r},l.multiplyByScalar=function(e,t,r){return o.typeOf.object("cartesian",e),o.typeOf.number("scalar",t),o.typeOf.object("result",r),r.x=e.x*t,r.y=e.y*t,r.z=e.z*t,r.w=e.w*t,r},l.divideByScalar=function(e,t,r){return o.typeOf.object("cartesian",e),o.typeOf.number("scalar",t),o.typeOf.object("result",r),r.x=e.x/t,r.y=e.y/t,r.z=e.z/t,r.w=e.w/t,r},l.negate=function(e,t){return o.typeOf.object("cartesian",e),o.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},l.abs=function(e,t){return o.typeOf.object("cartesian",e),o.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t.w=Math.abs(e.w),t};var u=new l;l.lerp=function(e,t,r,i){return o.typeOf.object("start",e),o.typeOf.object("end",t),o.typeOf.number("t",r),o.typeOf.object("result",i),l.multiplyByScalar(t,r,u),i=l.multiplyByScalar(e,1-r,i),l.add(u,i,i)};var c=new l;return l.mostOrthogonalAxis=function(e,t){o.typeOf.object("cartesian",e),o.typeOf.object("result",t);var r=l.normalize(e,c);return l.abs(r,r),t=r.x<=r.y?r.x<=r.z?r.x<=r.w?l.clone(l.UNIT_X,t):l.clone(l.UNIT_W,t):r.z<=r.w?l.clone(l.UNIT_Z,t):l.clone(l.UNIT_W,t):r.y<=r.z?r.y<=r.w?l.clone(l.UNIT_Y,t):l.clone(l.UNIT_W,t):r.z<=r.w?l.clone(l.UNIT_Z,t):l.clone(l.UNIT_W,t)},l.equals=function(e,t){return e===t||a(e)&&a(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},l.equalsArray=function(e,t,r){return e.x===t[r]&&e.y===t[r+1]&&e.z===t[r+2]&&e.w===t[r+3]},l.equalsEpsilon=function(e,t,r,i){return e===t||a(e)&&a(t)&&s.equalsEpsilon(e.x,t.x,r,i)&&s.equalsEpsilon(e.y,t.y,r,i)&&s.equalsEpsilon(e.z,t.z,r,i)&&s.equalsEpsilon(e.w,t.w,r,i)},l.ZERO=e(new l(0,0,0,0)),l.UNIT_X=e(new l(1,0,0,0)),l.UNIT_Y=e(new l(0,1,0,0)),l.UNIT_Z=e(new l(0,0,1,0)),l.UNIT_W=e(new l(0,0,0,1)),l.prototype.clone=function(e){return l.clone(this,e)},l.prototype.equals=function(e){return l.equals(this,e)},l.prototype.equalsEpsilon=function(e,t,r){return l.equalsEpsilon(this,e,t,r)},l.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},l}),define("Core/Matrix4",["./Cartesian3","./Cartesian4","./Check","./defaultValue","./defined","./defineProperties","./freezeObject","./Math","./Matrix3","./RuntimeError"],function(b,Y,K,_,A,e,t,X,Q,Z){"use strict";function J(e,t,r,i,n,o,a,s,l,u,c,d,h,p,f,m){this[0]=_(e,0),this[1]=_(n,0),this[2]=_(l,0),this[3]=_(h,0),this[4]=_(t,0),this[5]=_(o,0),this[6]=_(u,0),this[7]=_(p,0),this[8]=_(r,0),this[9]=_(a,0),this[10]=_(c,0),this[11]=_(f,0),this[12]=_(i,0),this[13]=_(s,0),this[14]=_(d,0),this[15]=_(m,0)}J.packedLength=16,J.pack=function(e,t,r){return K.typeOf.object("value",e),K.defined("array",t),r=_(r,0),t[r++]=e[0],t[r++]=e[1],t[r++]=e[2],t[r++]=e[3],t[r++]=e[4],t[r++]=e[5],t[r++]=e[6],t[r++]=e[7],t[r++]=e[8],t[r++]=e[9],t[r++]=e[10],t[r++]=e[11],t[r++]=e[12],t[r++]=e[13],t[r++]=e[14],t[r]=e[15],t},J.unpack=function(e,t,r){return K.defined("array",e),t=_(t,0),A(r)||(r=new J),r[0]=e[t++],r[1]=e[t++],r[2]=e[t++],r[3]=e[t++],r[4]=e[t++],r[5]=e[t++],r[6]=e[t++],r[7]=e[t++],r[8]=e[t++],r[9]=e[t++],r[10]=e[t++],r[11]=e[t++],r[12]=e[t++],r[13]=e[t++],r[14]=e[t++],r[15]=e[t],r},J.clone=function(e,t){if(A(e))return A(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):new J(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])},J.fromArray=J.unpack,J.fromColumnMajorArray=function(e,t){return K.defined("values",e),J.clone(e,t)},J.fromRowMajorArray=function(e,t){return K.defined("values",e),A(t)?(t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t):new J(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},J.fromRotationTranslation=function(e,t,r){return K.typeOf.object("rotation",e),t=_(t,b.ZERO),A(r)?(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=0,r[4]=e[3],r[5]=e[4],r[6]=e[5],r[7]=0,r[8]=e[6],r[9]=e[7],r[10]=e[8],r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,r):new J(e[0],e[3],e[6],t.x,e[1],e[4],e[7],t.y,e[2],e[5],e[8],t.z,0,0,0,1)},J.fromTranslationQuaternionRotationScale=function(e,t,r,i){K.typeOf.object("translation",e),K.typeOf.object("rotation",t),K.typeOf.object("scale",r),A(i)||(i=new J);var n=r.x,o=r.y,a=r.z,s=t.x*t.x,l=t.x*t.y,u=t.x*t.z,c=t.x*t.w,d=t.y*t.y,h=t.y*t.z,p=t.y*t.w,f=t.z*t.z,m=t.z*t.w,g=t.w*t.w,_=s-d-f+g,v=2*(l-m),y=2*(u+p),b=2*(l+m),C=-s+d-f+g,w=2*(h-c),S=2*(u-p),T=2*(h+c),E=-s-d+f+g;return i[0]=_*n,i[1]=b*n,i[2]=S*n,i[3]=0,i[4]=v*o,i[5]=C*o,i[6]=T*o,i[7]=0,i[8]=y*a,i[9]=w*a,i[10]=E*a,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,i},J.fromTranslationRotationScale=function(e,t){return K.typeOf.object("translationRotationScale",e),J.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t)},J.fromTranslation=function(e,t){return K.typeOf.object("translation",e),J.fromRotationTranslation(Q.IDENTITY,e,t)},J.fromScale=function(e,t){return K.typeOf.object("scale",e),A(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e.y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e.z,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new J(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1)},J.fromUniformScale=function(e,t){return K.typeOf.number("scale",e),A(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new J(e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1)};var C=new b,w=new b,S=new b;J.fromCamera=function(e,t){K.typeOf.object("camera",e);var r=e.position,i=e.direction,n=e.up;K.typeOf.object("camera.position",r),K.typeOf.object("camera.direction",i),K.typeOf.object("camera.up",n),b.normalize(i,C),b.normalize(b.cross(C,n,w),w),b.normalize(b.cross(w,C,S),S);var o=w.x,a=w.y,s=w.z,l=C.x,u=C.y,c=C.z,d=S.x,h=S.y,p=S.z,f=r.x,m=r.y,g=r.z,_=o*-f+a*-m+s*-g,v=d*-f+h*-m+p*-g,y=l*f+u*m+c*g;return A(t)?(t[0]=o,t[1]=d,t[2]=-l,t[3]=0,t[4]=a,t[5]=h,t[6]=-u,t[7]=0,t[8]=s,t[9]=p,t[10]=-c,t[11]=0,t[12]=_,t[13]=v,t[14]=y,t[15]=1,t):new J(o,a,s,_,d,h,p,v,-l,-u,-c,y,0,0,0,1)},J.computePerspectiveFieldOfView=function(e,t,r,i,n){K.typeOf.number.greaterThan("fovY",e,0),K.typeOf.number.lessThan("fovY",e,Math.PI),K.typeOf.number.greaterThan("near",r,0),K.typeOf.number.greaterThan("far",i,0),K.typeOf.object("result",n);var o=1/Math.tan(.5*e),a=o/t,s=(i+r)/(r-i),l=2*i*r/(r-i);return n[0]=a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=o,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=s,n[11]=-1,n[12]=0,n[13]=0,n[14]=l,n[15]=0,n},J.computeOrthographicOffCenter=function(e,t,r,i,n,o,a){K.typeOf.number("left",e),K.typeOf.number("right",t),K.typeOf.number("bottom",r),K.typeOf.number("top",i),K.typeOf.number("near",n),K.typeOf.number("far",o),K.typeOf.object("result",a);var s=1/(t-e),l=1/(i-r),u=1/(o-n),c=-(t+e)*s,d=-(i+r)*l,h=-(o+n)*u;return s*=2,l*=2,u*=-2,a[0]=s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=l,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=u,a[11]=0,a[12]=c,a[13]=d,a[14]=h,a[15]=1,a},J.computePerspectiveOffCenter=function(e,t,r,i,n,o,a){K.typeOf.number("left",e),K.typeOf.number("right",t),K.typeOf.number("bottom",r),K.typeOf.number("top",i),K.typeOf.number("near",n),K.typeOf.number("far",o),K.typeOf.object("result",a);var s=2*n/(t-e),l=2*n/(i-r),u=(t+e)/(t-e),c=(i+r)/(i-r),d=-(o+n)/(o-n),h=-2*o*n/(o-n);return a[0]=s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=l,a[6]=0,a[7]=0,a[8]=u,a[9]=c,a[10]=d,a[11]=-1,a[12]=0,a[13]=0,a[14]=h,a[15]=0,a},J.computeInfinitePerspectiveOffCenter=function(e,t,r,i,n,o){K.typeOf.number("left",e),K.typeOf.number("right",t),K.typeOf.number("bottom",r),K.typeOf.number("top",i),K.typeOf.number("near",n),K.typeOf.object("result",o);var a=2*n/(t-e),s=2*n/(i-r),l=(t+e)/(t-e),u=(i+r)/(i-r),c=-2*n;return o[0]=a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=s,o[6]=0,o[7]=0,o[8]=l,o[9]=u,o[10]=-1,o[11]=-1,o[12]=0,o[13]=0,o[14]=c,o[15]=0,o},J.computeViewportTransformation=function(e,t,r,i){K.typeOf.object("result",i),e=_(e,_.EMPTY_OBJECT);var n=_(e.x,0),o=_(e.y,0),a=_(e.width,0),s=_(e.height,0);t=_(t,0);var l=.5*a,u=.5*s,c=.5*((r=_(r,1))-t),d=l,h=u,p=c,f=n+l,m=o+u,g=t+c;return i[0]=d,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=h,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=p,i[11]=0,i[12]=f,i[13]=m,i[14]=g,i[15]=1,i},J.computeView=function(e,t,r,i,n){return K.typeOf.object("position",e),K.typeOf.object("direction",t),K.typeOf.object("up",r),K.typeOf.object("right",i),K.typeOf.object("result",n),n[0]=i.x,n[1]=r.x,n[2]=-t.x,n[3]=0,n[4]=i.y,n[5]=r.y,n[6]=-t.y,n[7]=0,n[8]=i.z,n[9]=r.z,n[10]=-t.z,n[11]=0,n[12]=-b.dot(i,e),n[13]=-b.dot(r,e),n[14]=b.dot(t,e),n[15]=1,n},J.toArray=function(e,t){return K.typeOf.object("matrix",e),A(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},J.getElementIndex=function(e,t){return K.typeOf.number.greaterThanOrEquals("row",t,0),K.typeOf.number.lessThanOrEquals("row",t,3),K.typeOf.number.greaterThanOrEquals("column",e,0),K.typeOf.number.lessThanOrEquals("column",e,3),4*e+t},J.getColumn=function(e,t,r){K.typeOf.object("matrix",e),K.typeOf.number.greaterThanOrEquals("index",t,0),K.typeOf.number.lessThanOrEquals("index",t,3),K.typeOf.object("result",r);var i=4*t,n=e[i],o=e[i+1],a=e[i+2],s=e[i+3];return r.x=n,r.y=o,r.z=a,r.w=s,r},J.setColumn=function(e,t,r,i){K.typeOf.object("matrix",e),K.typeOf.number.greaterThanOrEquals("index",t,0),K.typeOf.number.lessThanOrEquals("index",t,3),K.typeOf.object("cartesian",r),K.typeOf.object("result",i);var n=4*t;return(i=J.clone(e,i))[n]=r.x,i[n+1]=r.y,i[n+2]=r.z,i[n+3]=r.w,i},J.setTranslation=function(e,t,r){return K.typeOf.object("matrix",e),K.typeOf.object("translation",t),K.typeOf.object("result",r),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=e[15],r},J.getRow=function(e,t,r){K.typeOf.object("matrix",e),K.typeOf.number.greaterThanOrEquals("index",t,0),K.typeOf.number.lessThanOrEquals("index",t,3),K.typeOf.object("result",r);var i=e[t],n=e[t+4],o=e[t+8],a=e[t+12];return r.x=i,r.y=n,r.z=o,r.w=a,r},J.setRow=function(e,t,r,i){return K.typeOf.object("matrix",e),K.typeOf.number.greaterThanOrEquals("index",t,0),K.typeOf.number.lessThanOrEquals("index",t,3),K.typeOf.object("cartesian",r),K.typeOf.object("result",i),(i=J.clone(e,i))[t]=r.x,i[t+4]=r.y,i[t+8]=r.z,i[t+12]=r.w,i};var r=new b;J.getScale=function(e,t){return K.typeOf.object("matrix",e),K.typeOf.object("result",t),t.x=b.magnitude(b.fromElements(e[0],e[1],e[2],r)),t.y=b.magnitude(b.fromElements(e[4],e[5],e[6],r)),t.z=b.magnitude(b.fromElements(e[8],e[9],e[10],r)),t};var i=new b;J.getMaximumScale=function(e){return J.getScale(e,i),b.maximumComponent(i)},J.multiply=function(e,t,r){K.typeOf.object("left",e),K.typeOf.object("right",t),K.typeOf.object("result",r);var i=e[0],n=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],d=e[8],h=e[9],p=e[10],f=e[11],m=e[12],g=e[13],_=e[14],v=e[15],y=t[0],b=t[1],C=t[2],w=t[3],S=t[4],T=t[5],E=t[6],A=t[7],x=t[8],P=t[9],D=t[10],O=t[11],I=t[12],M=t[13],R=t[14],L=t[15],N=i*y+s*b+d*C+m*w,k=n*y+l*b+h*C+g*w,F=o*y+u*b+p*C+_*w,B=a*y+c*b+f*C+v*w,U=i*S+s*T+d*E+m*A,V=n*S+l*T+h*E+g*A,z=o*S+u*T+p*E+_*A,q=a*S+c*T+f*E+v*A,G=i*x+s*P+d*D+m*O,W=n*x+l*P+h*D+g*O,H=o*x+u*P+p*D+_*O,j=a*x+c*P+f*D+v*O,Y=i*I+s*M+d*R+m*L,X=n*I+l*M+h*R+g*L,Q=o*I+u*M+p*R+_*L,Z=a*I+c*M+f*R+v*L;return r[0]=N,r[1]=k,r[2]=F,r[3]=B,r[4]=U,r[5]=V,r[6]=z,r[7]=q,r[8]=G,r[9]=W,r[10]=H,r[11]=j,r[12]=Y,r[13]=X,r[14]=Q,r[15]=Z,r},J.add=function(e,t,r){return K.typeOf.object("left",e),K.typeOf.object("right",t),K.typeOf.object("result",r),r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r[6]=e[6]+t[6],r[7]=e[7]+t[7],r[8]=e[8]+t[8],r[9]=e[9]+t[9],r[10]=e[10]+t[10],r[11]=e[11]+t[11],r[12]=e[12]+t[12],r[13]=e[13]+t[13],r[14]=e[14]+t[14],r[15]=e[15]+t[15],r},J.subtract=function(e,t,r){return K.typeOf.object("left",e),K.typeOf.object("right",t),K.typeOf.object("result",r),r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r[4]=e[4]-t[4],r[5]=e[5]-t[5],r[6]=e[6]-t[6],r[7]=e[7]-t[7],r[8]=e[8]-t[8],r[9]=e[9]-t[9],r[10]=e[10]-t[10],r[11]=e[11]-t[11],r[12]=e[12]-t[12],r[13]=e[13]-t[13],r[14]=e[14]-t[14],r[15]=e[15]-t[15],r},J.multiplyTransformation=function(e,t,r){K.typeOf.object("left",e),K.typeOf.object("right",t),K.typeOf.object("result",r);var i=e[0],n=e[1],o=e[2],a=e[4],s=e[5],l=e[6],u=e[8],c=e[9],d=e[10],h=e[12],p=e[13],f=e[14],m=t[0],g=t[1],_=t[2],v=t[4],y=t[5],b=t[6],C=t[8],w=t[9],S=t[10],T=t[12],E=t[13],A=t[14],x=i*m+a*g+u*_,P=n*m+s*g+c*_,D=o*m+l*g+d*_,O=i*v+a*y+u*b,I=n*v+s*y+c*b,M=o*v+l*y+d*b,R=i*C+a*w+u*S,L=n*C+s*w+c*S,N=o*C+l*w+d*S,k=i*T+a*E+u*A+h,F=n*T+s*E+c*A+p,B=o*T+l*E+d*A+f;return r[0]=x,r[1]=P,r[2]=D,r[3]=0,r[4]=O,r[5]=I,r[6]=M,r[7]=0,r[8]=R,r[9]=L,r[10]=N,r[11]=0,r[12]=k,r[13]=F,r[14]=B,r[15]=1,r},J.multiplyByMatrix3=function(e,t,r){K.typeOf.object("matrix",e),K.typeOf.object("rotation",t),K.typeOf.object("result",r);var i=e[0],n=e[1],o=e[2],a=e[4],s=e[5],l=e[6],u=e[8],c=e[9],d=e[10],h=t[0],p=t[1],f=t[2],m=t[3],g=t[4],_=t[5],v=t[6],y=t[7],b=t[8],C=i*h+a*p+u*f,w=n*h+s*p+c*f,S=o*h+l*p+d*f,T=i*m+a*g+u*_,E=n*m+s*g+c*_,A=o*m+l*g+d*_,x=i*v+a*y+u*b,P=n*v+s*y+c*b,D=o*v+l*y+d*b;return r[0]=C,r[1]=w,r[2]=S,r[3]=0,r[4]=T,r[5]=E,r[6]=A,r[7]=0,r[8]=x,r[9]=P,r[10]=D,r[11]=0,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},J.multiplyByTranslation=function(e,t,r){K.typeOf.object("matrix",e),K.typeOf.object("translation",t),K.typeOf.object("result",r);var i=t.x,n=t.y,o=t.z,a=i*e[0]+n*e[4]+o*e[8]+e[12],s=i*e[1]+n*e[5]+o*e[9]+e[13],l=i*e[2]+n*e[6]+o*e[10]+e[14];return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=a,r[13]=s,r[14]=l,r[15]=e[15],r};var n=new b;J.multiplyByUniformScale=function(e,t,r){return K.typeOf.object("matrix",e),K.typeOf.number("scale",t),K.typeOf.object("result",r),n.x=t,n.y=t,n.z=t,J.multiplyByScale(e,n,r)},J.multiplyByScale=function(e,t,r){K.typeOf.object("matrix",e),K.typeOf.object("scale",t),K.typeOf.object("result",r);var i=t.x,n=t.y,o=t.z;return 1===i&&1===n&&1===o?J.clone(e,r):(r[0]=i*e[0],r[1]=i*e[1],r[2]=i*e[2],r[3]=0,r[4]=n*e[4],r[5]=n*e[5],r[6]=n*e[6],r[7]=0,r[8]=o*e[8],r[9]=o*e[9],r[10]=o*e[10],r[11]=0,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=1,r)},J.multiplyByVector=function(e,t,r){K.typeOf.object("matrix",e),K.typeOf.object("cartesian",t),K.typeOf.object("result",r);var i=t.x,n=t.y,o=t.z,a=t.w,s=e[0]*i+e[4]*n+e[8]*o+e[12]*a,l=e[1]*i+e[5]*n+e[9]*o+e[13]*a,u=e[2]*i+e[6]*n+e[10]*o+e[14]*a,c=e[3]*i+e[7]*n+e[11]*o+e[15]*a;return r.x=s,r.y=l,r.z=u,r.w=c,r},J.multiplyByPointAsVector=function(e,t,r){K.typeOf.object("matrix",e),K.typeOf.object("cartesian",t),K.typeOf.object("result",r);var i=t.x,n=t.y,o=t.z,a=e[0]*i+e[4]*n+e[8]*o,s=e[1]*i+e[5]*n+e[9]*o,l=e[2]*i+e[6]*n+e[10]*o;return r.x=a,r.y=s,r.z=l,r},J.multiplyByPoint=function(e,t,r){K.typeOf.object("matrix",e),K.typeOf.object("cartesian",t),K.typeOf.object("result",r);var i=t.x,n=t.y,o=t.z,a=e[0]*i+e[4]*n+e[8]*o+e[12],s=e[1]*i+e[5]*n+e[9]*o+e[13],l=e[2]*i+e[6]*n+e[10]*o+e[14];return r.x=a,r.y=s,r.z=l,r},J.multiplyByScalar=function(e,t,r){return K.typeOf.object("matrix",e),K.typeOf.number("scalar",t),K.typeOf.object("result",r),r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r[6]=e[6]*t,r[7]=e[7]*t,r[8]=e[8]*t,r[9]=e[9]*t,r[10]=e[10]*t,r[11]=e[11]*t,r[12]=e[12]*t,r[13]=e[13]*t,r[14]=e[14]*t,r[15]=e[15]*t,r},J.negate=function(e,t){return K.typeOf.object("matrix",e),K.typeOf.object("result",t),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t[9]=-e[9],t[10]=-e[10],t[11]=-e[11],t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=-e[15],t},J.transpose=function(e,t){K.typeOf.object("matrix",e),K.typeOf.object("result",t);var r=e[1],i=e[2],n=e[3],o=e[6],a=e[7],s=e[11];return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[10]=e[10],t[11]=e[14],t[12]=n,t[13]=a,t[14]=s,t[15]=e[15],t},J.abs=function(e,t){return K.typeOf.object("matrix",e),K.typeOf.object("result",t),t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t[9]=Math.abs(e[9]),t[10]=Math.abs(e[10]),t[11]=Math.abs(e[11]),t[12]=Math.abs(e[12]),t[13]=Math.abs(e[13]),t[14]=Math.abs(e[14]),t[15]=Math.abs(e[15]),t},J.equals=function(e,t){return e===t||A(e)&&A(t)&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[3]===t[3]&&e[7]===t[7]&&e[11]===t[11]&&e[15]===t[15]},J.equalsEpsilon=function(e,t,r){return K.typeOf.number("epsilon",r),e===t||A(e)&&A(t)&&Math.abs(e[0]-t[0])<=r&&Math.abs(e[1]-t[1])<=r&&Math.abs(e[2]-t[2])<=r&&Math.abs(e[3]-t[3])<=r&&Math.abs(e[4]-t[4])<=r&&Math.abs(e[5]-t[5])<=r&&Math.abs(e[6]-t[6])<=r&&Math.abs(e[7]-t[7])<=r&&Math.abs(e[8]-t[8])<=r&&Math.abs(e[9]-t[9])<=r&&Math.abs(e[10]-t[10])<=r&&Math.abs(e[11]-t[11])<=r&&Math.abs(e[12]-t[12])<=r&&Math.abs(e[13]-t[13])<=r&&Math.abs(e[14]-t[14])<=r&&Math.abs(e[15]-t[15])<=r},J.getTranslation=function(e,t){return K.typeOf.object("matrix",e),K.typeOf.object("result",t),t.x=e[12],t.y=e[13],t.z=e[14],t},J.getRotation=function(e,t){return K.typeOf.object("matrix",e),K.typeOf.object("result",t),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t};var $=new Q,ee=new Q,te=new Y,re=new Y(0,0,0,1);return J.inverse=function(e,t){if(K.typeOf.object("matrix",e),K.typeOf.object("result",t),Q.equalsEpsilon(J.getRotation(e,$),ee,X.EPSILON7)&&Y.equals(J.getRow(e,3,te),re))return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=0,t[11]=0,t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=1,t;var r=e[0],i=e[4],n=e[8],o=e[12],a=e[1],s=e[5],l=e[9],u=e[13],c=e[2],d=e[6],h=e[10],p=e[14],f=e[3],m=e[7],g=e[11],_=e[15],v=h*_,y=p*g,b=d*_,C=p*m,w=d*g,S=h*m,T=c*_,E=p*f,A=c*g,x=h*f,P=c*m,D=d*f,O=v*s+C*l+w*u-(y*s+b*l+S*u),I=y*a+T*l+x*u-(v*a+E*l+A*u),M=b*a+E*s+P*u-(C*a+T*s+D*u),R=S*a+A*s+D*l-(w*a+x*s+P*l),L=y*i+b*n+S*o-(v*i+C*n+w*o),N=v*r+E*n+A*o-(y*r+T*n+x*o),k=C*r+T*i+D*o-(b*r+E*i+P*o),F=w*r+x*i+P*n-(S*r+A*i+D*n),B=(v=n*u)*m+(C=o*s)*g+(w=i*l)*_-((y=o*l)*m+(b=i*u)*g+(S=n*s)*_),U=y*f+(T=r*u)*g+(x=n*a)*_-(v*f+(E=o*a)*g+(A=r*l)*_),V=b*f+E*m+(P=r*s)*_-(C*f+T*m+(D=i*a)*_),z=S*f+A*m+D*g-(w*f+x*m+P*g),q=b*h+S*p+y*d-(w*p+v*d+C*h),G=A*p+v*c+E*h-(T*h+x*p+y*c),W=T*d+D*p+C*c-(P*p+b*c+E*d),H=P*h+w*c+x*d-(A*d+D*h+S*c),j=r*O+i*I+n*M+o*R;if(Math.abs(j)<X.EPSILON20)throw new Z("matrix is not invertible because its determinate is zero.");return j=1/j,t[0]=O*j,t[1]=I*j,t[2]=M*j,t[3]=R*j,t[4]=L*j,t[5]=N*j,t[6]=k*j,t[7]=F*j,t[8]=B*j,t[9]=U*j,t[10]=V*j,t[11]=z*j,t[12]=q*j,t[13]=G*j,t[14]=W*j,t[15]=H*j,t},J.inverseTransformation=function(e,t){K.typeOf.object("matrix",e),K.typeOf.object("result",t);var r=e[0],i=e[1],n=e[2],o=e[4],a=e[5],s=e[6],l=e[8],u=e[9],c=e[10],d=e[12],h=e[13],p=e[14],f=-r*d-i*h-n*p,m=-o*d-a*h-s*p,g=-l*d-u*h-c*p;return t[0]=r,t[1]=o,t[2]=l,t[3]=0,t[4]=i,t[5]=a,t[6]=u,t[7]=0,t[8]=n,t[9]=s,t[10]=c,t[11]=0,t[12]=f,t[13]=m,t[14]=g,t[15]=1,t},J.IDENTITY=t(new J(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),J.ZERO=t(new J(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)),J.COLUMN0ROW0=0,J.COLUMN0ROW1=1,J.COLUMN0ROW2=2,J.COLUMN0ROW3=3,J.COLUMN1ROW0=4,J.COLUMN1ROW1=5,J.COLUMN1ROW2=6,J.COLUMN1ROW3=7,J.COLUMN2ROW0=8,J.COLUMN2ROW1=9,J.COLUMN2ROW2=10,J.COLUMN2ROW3=11,J.COLUMN3ROW0=12,J.COLUMN3ROW1=13,J.COLUMN3ROW2=14,J.COLUMN3ROW3=15,e(J.prototype,{length:{get:function(){return J.packedLength}}}),J.prototype.clone=function(e){return J.clone(this,e)},J.prototype.equals=function(e){return J.equals(this,e)},J.equalsArray=function(e,t,r){return e[0]===t[r]&&e[1]===t[r+1]&&e[2]===t[r+2]&&e[3]===t[r+3]&&e[4]===t[r+4]&&e[5]===t[r+5]&&e[6]===t[r+6]&&e[7]===t[r+7]&&e[8]===t[r+8]&&e[9]===t[r+9]&&e[10]===t[r+10]&&e[11]===t[r+11]&&e[12]===t[r+12]&&e[13]===t[r+13]&&e[14]===t[r+14]&&e[15]===t[r+15]},J.prototype.equalsEpsilon=function(e,t){return J.equalsEpsilon(this,e,t)},J.prototype.toString=function(){return"("+this[0]+", "+this[4]+", "+this[8]+", "+this[12]+")\n("+this[1]+", "+this[5]+", "+this[9]+", "+this[13]+")\n("+this[2]+", "+this[6]+", "+this[10]+", "+this[14]+")\n("+this[3]+", "+this[7]+", "+this[11]+", "+this[15]+")"},J}),define("Core/BoundingSphere",["./Cartesian3","./Cartographic","./Math","./Check","./defaultValue","./defined","./Ellipsoid","./GeographicProjection","./Intersect","./Interval","./Matrix3","./Matrix4","./Rectangle"],function(R,e,t,L,N,k,o,r,a,s,l,i,d){"use strict";function F(e,t){this.center=R.clone(N(e,R.ZERO)),this.radius=N(t,0)}var B=new R,U=new R,V=new R,z=new R,q=new R,G=new R,W=new R,H=new R,j=new R,Y=new R,X=new R,Q=new R,n=4/3*t.PI;F.fromPoints=function(e,t){if(k(t)||(t=new F),!k(e)||0===e.length)return t.center=R.clone(R.ZERO,t.center),t.radius=0,t;var r,i=R.clone(e[0],W),n=R.clone(i,B),o=R.clone(i,U),a=R.clone(i,V),s=R.clone(i,z),l=R.clone(i,q),u=R.clone(i,G),c=e.length;for(r=1;r<c;r++){R.clone(e[r],i);var d=i.x,h=i.y,p=i.z;d<n.x&&R.clone(i,n),d>s.x&&R.clone(i,s),h<o.y&&R.clone(i,o),h>l.y&&R.clone(i,l),p<a.z&&R.clone(i,a),p>u.z&&R.clone(i,u)}var f=R.magnitudeSquared(R.subtract(s,n,H)),m=R.magnitudeSquared(R.subtract(l,o,H)),g=R.magnitudeSquared(R.subtract(u,a,H)),_=n,v=s,y=f;y<m&&(y=m,_=o,v=l),y<g&&(y=g,_=a,v=u);var b=j;b.x=.5*(_.x+v.x),b.y=.5*(_.y+v.y),b.z=.5*(_.z+v.z);var C=R.magnitudeSquared(R.subtract(v,b,H)),w=Math.sqrt(C),S=Y;S.x=n.x,S.y=o.y,S.z=a.z;var T=X;T.x=s.x,T.y=l.y,T.z=u.z;var E=R.multiplyByScalar(R.add(S,T,H),.5,Q),A=0;for(r=0;r<c;r++){R.clone(e[r],i);var x=R.magnitude(R.subtract(i,E,H));A<x&&(A=x);var P=R.magnitudeSquared(R.subtract(i,b,H));if(C<P){var D=Math.sqrt(P);C=(w=.5*(w+D))*w;var O=D-w;b.x=(w*b.x+O*i.x)/D,b.y=(w*b.y+O*i.y)/D,b.z=(w*b.z+O*i.z)/D}}return t.radius=w<A?(R.clone(b,t.center),w):(R.clone(E,t.center),A),t};var h=new r,p=new R,f=new R,m=new e,g=new e;F.fromRectangle2D=function(e,t,r){return F.fromRectangleWithHeights2D(e,t,0,0,r)},F.fromRectangleWithHeights2D=function(e,t,r,i,n){if(k(n)||(n=new F),!k(e))return n.center=R.clone(R.ZERO,n.center),n.radius=0,n;t=N(t,h),d.southwest(e,m),m.height=r,d.northeast(e,g),g.height=i;var o=t.project(m,p),a=t.project(g,f),s=a.x-o.x,l=a.y-o.y,u=a.z-o.z;n.radius=.5*Math.sqrt(s*s+l*l+u*u);var c=n.center;return c.x=o.x+.5*s,c.y=o.y+.5*l,c.z=o.z+.5*u,n};var u=[];F.fromRectangle3D=function(e,t,r,i){if(t=N(t,o.WGS84),r=N(r,0),k(i)||(i=new F),!k(e))return i.center=R.clone(R.ZERO,i.center),i.radius=0,i;var n=d.subsample(e,t,r,u);return F.fromPoints(n,i)},F.fromVertices=function(e,t,r,i){if(k(i)||(i=new F),!k(e)||0===e.length)return i.center=R.clone(R.ZERO,i.center),i.radius=0,i;t=N(t,R.ZERO),r=N(r,3),L.typeOf.number.greaterThanOrEquals("stride",r,3);var n=W;n.x=e[0]+t.x,n.y=e[1]+t.y,n.z=e[2]+t.z;var o,a=R.clone(n,B),s=R.clone(n,U),l=R.clone(n,V),u=R.clone(n,z),c=R.clone(n,q),d=R.clone(n,G),h=e.length;for(o=0;o<h;o+=r){var p=e[o]+t.x,f=e[o+1]+t.y,m=e[o+2]+t.z;n.x=p,n.y=f,n.z=m,p<a.x&&R.clone(n,a),p>u.x&&R.clone(n,u),f<s.y&&R.clone(n,s),f>c.y&&R.clone(n,c),m<l.z&&R.clone(n,l),m>d.z&&R.clone(n,d)}var g=R.magnitudeSquared(R.subtract(u,a,H)),_=R.magnitudeSquared(R.subtract(c,s,H)),v=R.magnitudeSquared(R.subtract(d,l,H)),y=a,b=u,C=g;C<_&&(C=_,y=s,b=c),C<v&&(C=v,y=l,b=d);var w=j;w.x=.5*(y.x+b.x),w.y=.5*(y.y+b.y),w.z=.5*(y.z+b.z);var S=R.magnitudeSquared(R.subtract(b,w,H)),T=Math.sqrt(S),E=Y;E.x=a.x,E.y=s.y,E.z=l.z;var A=X;A.x=u.x,A.y=c.y,A.z=d.z;var x=R.multiplyByScalar(R.add(E,A,H),.5,Q),P=0;for(o=0;o<h;o+=r){n.x=e[o]+t.x,n.y=e[o+1]+t.y,n.z=e[o+2]+t.z;var D=R.magnitude(R.subtract(n,x,H));P<D&&(P=D);var O=R.magnitudeSquared(R.subtract(n,w,H));if(S<O){var I=Math.sqrt(O);S=(T=.5*(T+I))*T;var M=I-T;w.x=(T*w.x+M*n.x)/I,w.y=(T*w.y+M*n.y)/I,w.z=(T*w.z+M*n.z)/I}}return i.radius=T<P?(R.clone(w,i.center),T):(R.clone(x,i.center),P),i},F.fromEncodedCartesianVertices=function(e,t,r){if(k(r)||(r=new F),!k(e)||!k(t)||e.length!==t.length||0===e.length)return r.center=R.clone(R.ZERO,r.center),r.radius=0,r;var i=W;i.x=e[0]+t[0],i.y=e[1]+t[1],i.z=e[2]+t[2];var n,o=R.clone(i,B),a=R.clone(i,U),s=R.clone(i,V),l=R.clone(i,z),u=R.clone(i,q),c=R.clone(i,G),d=e.length;for(n=0;n<d;n+=3){var h=e[n]+t[n],p=e[n+1]+t[n+1],f=e[n+2]+t[n+2];i.x=h,i.y=p,i.z=f,h<o.x&&R.clone(i,o),h>l.x&&R.clone(i,l),p<a.y&&R.clone(i,a),p>u.y&&R.clone(i,u),f<s.z&&R.clone(i,s),f>c.z&&R.clone(i,c)}var m=R.magnitudeSquared(R.subtract(l,o,H)),g=R.magnitudeSquared(R.subtract(u,a,H)),_=R.magnitudeSquared(R.subtract(c,s,H)),v=o,y=l,b=m;b<g&&(b=g,v=a,y=u),b<_&&(b=_,v=s,y=c);var C=j;C.x=.5*(v.x+y.x),C.y=.5*(v.y+y.y),C.z=.5*(v.z+y.z);var w=R.magnitudeSquared(R.subtract(y,C,H)),S=Math.sqrt(w),T=Y;T.x=o.x,T.y=a.y,T.z=s.z;var E=X;E.x=l.x,E.y=u.y,E.z=c.z;var A=R.multiplyByScalar(R.add(T,E,H),.5,Q),x=0;for(n=0;n<d;n+=3){i.x=e[n]+t[n],i.y=e[n+1]+t[n+1],i.z=e[n+2]+t[n+2];var P=R.magnitude(R.subtract(i,A,H));x<P&&(x=P);var D=R.magnitudeSquared(R.subtract(i,C,H));if(w<D){var O=Math.sqrt(D);w=(S=.5*(S+O))*S;var I=O-S;C.x=(S*C.x+I*i.x)/O,C.y=(S*C.y+I*i.y)/O,C.z=(S*C.z+I*i.z)/O}}return r.radius=S<x?(R.clone(C,r.center),S):(R.clone(A,r.center),x),r},F.fromCornerPoints=function(e,t,r){L.typeOf.object("corner",e),L.typeOf.object("oppositeCorner",t),k(r)||(r=new F);var i=r.center;return R.add(e,t,i),R.multiplyByScalar(i,.5,i),r.radius=R.distance(i,t),r},F.fromEllipsoid=function(e,t){return L.typeOf.object("ellipsoid",e),k(t)||(t=new F),R.clone(R.ZERO,t.center),t.radius=e.maximumRadius,t};var c=new R;F.fromBoundingSpheres=function(e,t){if(k(t)||(t=new F),!k(e)||0===e.length)return t.center=R.clone(R.ZERO,t.center),t.radius=0,t;var r=e.length;if(1===r)return F.clone(e[0],t);if(2===r)return F.union(e[0],e[1],t);var i,n=[];for(i=0;i<r;i++)n.push(e[i].center);var o=(t=F.fromPoints(n,t)).center,a=t.radius;for(i=0;i<r;i++){var s=e[i];a=Math.max(a,R.distance(o,s.center,c)+s.radius)}return t.radius=a,t};var _=new R,v=new R,y=new R;F.fromOrientedBoundingBox=function(e,t){L.defined("orientedBoundingBox",e),k(t)||(t=new F);var r=e.halfAxes,i=l.getColumn(r,0,_),n=l.getColumn(r,1,v),o=l.getColumn(r,2,y);return R.add(i,n,i),R.add(i,o,i),t.center=R.clone(e.center,t.center),t.radius=R.magnitude(i),t},F.clone=function(e,t){if(k(e))return k(t)?(t.center=R.clone(e.center,t.center),t.radius=e.radius,t):new F(e.center,e.radius)},F.packedLength=4,F.pack=function(e,t,r){L.typeOf.object("value",e),L.defined("array",t),r=N(r,0);var i=e.center;return t[r++]=i.x,t[r++]=i.y,t[r++]=i.z,t[r]=e.radius,t},F.unpack=function(e,t,r){L.defined("array",e),t=N(t,0),k(r)||(r=new F);var i=r.center;return i.x=e[t++],i.y=e[t++],i.z=e[t++],r.radius=e[t],r};var b=new R,C=new R;F.union=function(e,t,r){L.typeOf.object("left",e),L.typeOf.object("right",t),k(r)||(r=new F);var i=e.center,n=e.radius,o=t.center,a=t.radius,s=R.subtract(o,i,b),l=R.magnitude(s);if(l+a<=n)return e.clone(r),r;if(l+n<=a)return t.clone(r),r;var u=.5*(n+l+a),c=R.multiplyByScalar(s,(-n+u)/l,C);return R.add(c,i,c),R.clone(c,r.center),r.radius=u,r};var w=new R;F.expand=function(e,t,r){L.typeOf.object("sphere",e),L.typeOf.object("point",t),r=F.clone(e,r);var i=R.magnitude(R.subtract(t,r.center,w));return i>r.radius&&(r.radius=i),r},F.intersectPlane=function(e,t){L.typeOf.object("sphere",e),L.typeOf.object("plane",t);var r=e.center,i=e.radius,n=t.normal,o=R.dot(n,r)+t.distance;return o<-i?a.OUTSIDE:o<i?a.INTERSECTING:a.INSIDE},F.transform=function(e,t,r){return L.typeOf.object("sphere",e),L.typeOf.object("transform",t),k(r)||(r=new F),r.center=i.multiplyByPoint(t,e.center,r.center),r.radius=i.getMaximumScale(t)*e.radius,r};var S=new R;F.distanceSquaredTo=function(e,t){L.typeOf.object("sphere",e),L.typeOf.object("cartesian",t);var r=R.subtract(e.center,t,S);return R.magnitudeSquared(r)-e.radius*e.radius},F.transformWithoutScale=function(e,t,r){return L.typeOf.object("sphere",e),L.typeOf.object("transform",t),k(r)||(r=new F),r.center=i.multiplyByPoint(t,e.center,r.center),r.radius=e.radius,r};var T=new R;F.computePlaneDistances=function(e,t,r,i){L.typeOf.object("sphere",e),L.typeOf.object("position",t),L.typeOf.object("direction",r),k(i)||(i=new s);var n=R.subtract(e.center,t,T),o=R.dot(r,n);return i.start=o-e.radius,i.stop=o+e.radius,i};for(var E=new R,A=new R,x=new R,P=new R,D=new R,O=new e,I=new Array(8),M=0;M<8;++M)I[M]=new R;var Z=new r;return F.projectTo2D=function(e,t,r){L.typeOf.object("sphere",e);var i=(t=N(t,Z)).ellipsoid,n=e.center,o=e.radius,a=i.geodeticSurfaceNormal(n,E),s=R.cross(R.UNIT_Z,a,A);R.normalize(s,s);var l=R.cross(a,s,x);R.normalize(l,l),R.multiplyByScalar(a,o,a),R.multiplyByScalar(l,o,l),R.multiplyByScalar(s,o,s);var u=R.negate(l,D),c=R.negate(s,P),d=I,h=d[0];R.add(a,l,h),R.add(h,s,h),h=d[1],R.add(a,l,h),R.add(h,c,h),h=d[2],R.add(a,u,h),R.add(h,c,h),h=d[3],R.add(a,u,h),R.add(h,s,h),R.negate(a,a),h=d[4],R.add(a,l,h),R.add(h,s,h),h=d[5],R.add(a,l,h),R.add(h,c,h),h=d[6],R.add(a,u,h),R.add(h,c,h),h=d[7],R.add(a,u,h),R.add(h,s,h);for(var p=d.length,f=0;f<p;++f){var m=d[f];R.add(n,m,m);var g=i.cartesianToCartographic(m,O);t.project(g,m)}var _=(n=(r=F.fromPoints(d,r)).center).x,v=n.y,y=n.z;return n.x=y,n.y=_,n.z=v,r},F.isOccluded=function(e,t){return L.typeOf.object("sphere",e),L.typeOf.object("occluder",t),!t.isBoundingSphereVisible(e)},F.equals=function(e,t){return e===t||k(e)&&k(t)&&R.equals(e.center,t.center)&&e.radius===t.radius},F.prototype.intersectPlane=function(e){return F.intersectPlane(this,e)},F.prototype.distanceSquaredTo=function(e){return F.distanceSquaredTo(this,e)},F.prototype.computePlaneDistances=function(e,t,r){return F.computePlaneDistances(this,e,t,r)},F.prototype.isOccluded=function(e){return F.isOccluded(this,e)},F.prototype.equals=function(e){return F.equals(this,e)},F.prototype.clone=function(e){return F.clone(this,e)},F.prototype.volume=function(){var e=this.radius;return n*e*e*e},F}),define("Core/WebGLConstants",["./freezeObject"],function(e){"use strict";return e({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047})}),define("Core/ComponentDatatype",["./defaultValue","./defined","./DeveloperError","./FeatureDetection","./freezeObject","./WebGLConstants"],function(n,o,a,e,t,r){"use strict";if(!e.supportsTypedArrays())return{};var s={BYTE:r.BYTE,UNSIGNED_BYTE:r.UNSIGNED_BYTE,SHORT:r.SHORT,UNSIGNED_SHORT:r.UNSIGNED_SHORT,INT:r.INT,UNSIGNED_INT:r.UNSIGNED_INT,FLOAT:r.FLOAT,DOUBLE:r.DOUBLE,getSizeInBytes:function(e){if(!o(e))throw new a("value is required.");switch(e){case s.BYTE:return Int8Array.BYTES_PER_ELEMENT;case s.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case s.SHORT:return Int16Array.BYTES_PER_ELEMENT;case s.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case s.INT:return Int32Array.BYTES_PER_ELEMENT;case s.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case s.FLOAT:return Float32Array.BYTES_PER_ELEMENT;case s.DOUBLE:return Float64Array.BYTES_PER_ELEMENT;default:throw new a("componentDatatype is not a valid value.")}},fromTypedArray:function(e){return e instanceof Int8Array?s.BYTE:e instanceof Uint8Array?s.UNSIGNED_BYTE:e instanceof Int16Array?s.SHORT:e instanceof Uint16Array?s.UNSIGNED_SHORT:e instanceof Int32Array?s.INT:e instanceof Uint32Array?s.UNSIGNED_INT:e instanceof Float32Array?s.FLOAT:e instanceof Float64Array?s.DOUBLE:void 0},validate:function(e){return o(e)&&(e===s.BYTE||e===s.UNSIGNED_BYTE||e===s.SHORT||e===s.UNSIGNED_SHORT||e===s.INT||e===s.UNSIGNED_INT||e===s.FLOAT||e===s.DOUBLE)},createTypedArray:function(e,t){if(!o(e))throw new a("componentDatatype is required.");if(!o(t))throw new a("valuesOrLength is required.");switch(e){case s.BYTE:return new Int8Array(t);case s.UNSIGNED_BYTE:return new Uint8Array(t);case s.SHORT:return new Int16Array(t);case s.UNSIGNED_SHORT:return new Uint16Array(t);case s.INT:return new Int32Array(t);case s.UNSIGNED_INT:return new Uint32Array(t);case s.FLOAT:return new Float32Array(t);case s.DOUBLE:return new Float64Array(t);default:throw new a("componentDatatype is not a valid value.")}},createArrayBufferView:function(e,t,r,i){if(!o(e))throw new a("componentDatatype is required.");if(!o(t))throw new a("buffer is required.");switch(r=n(r,0),i=n(i,(t.byteLength-r)/s.getSizeInBytes(e)),e){case s.BYTE:return new Int8Array(t,r,i);case s.UNSIGNED_BYTE:return new Uint8Array(t,r,i);case s.SHORT:return new Int16Array(t,r,i);case s.UNSIGNED_SHORT:return new Uint16Array(t,r,i);case s.INT:return new Int32Array(t,r,i);case s.UNSIGNED_INT:return new Uint32Array(t,r,i);case s.FLOAT:return new Float32Array(t,r,i);case s.DOUBLE:return new Float64Array(t,r,i);default:throw new a("componentDatatype is not a valid value.")}},fromName:function(e){switch(e){case"BYTE":return s.BYTE;case"UNSIGNED_BYTE":return s.UNSIGNED_BYTE;case"SHORT":return s.SHORT;case"UNSIGNED_SHORT":return s.UNSIGNED_SHORT;case"INT":return s.INT;case"UNSIGNED_INT":return s.UNSIGNED_INT;case"FLOAT":return s.FLOAT;case"DOUBLE":return s.DOUBLE;default:throw new a("name is not a valid value.")}}};return t(s)}),define("Core/GeometryType",["./freezeObject"],function(e){"use strict";return e({NONE:0,TRIANGLES:1,LINES:2,POLYLINES:3})}),define("Core/PrimitiveType",["./freezeObject","./WebGLConstants"],function(e,t){"use strict";var r={POINTS:t.POINTS,LINES:t.LINES,LINE_LOOP:t.LINE_LOOP,LINE_STRIP:t.LINE_STRIP,TRIANGLES:t.TRIANGLES,TRIANGLE_STRIP:t.TRIANGLE_STRIP,TRIANGLE_FAN:t.TRIANGLE_FAN,validate:function(e){return e===r.POINTS||e===r.LINES||e===r.LINE_LOOP||e===r.LINE_STRIP||e===r.TRIANGLES||e===r.TRIANGLE_STRIP||e===r.TRIANGLE_FAN}};return e(r)}),define("Core/Geometry",["./Check","./defaultValue","./defined","./DeveloperError","./GeometryType","./PrimitiveType"],function(o,t,a,s,r,i){"use strict";function e(e){e=t(e,t.EMPTY_OBJECT),o.typeOf.object("options.attributes",e.attributes),this.attributes=e.attributes,this.indices=e.indices,this.primitiveType=t(e.primitiveType,i.TRIANGLES),this.boundingSphere=e.boundingSphere,this.geometryType=t(e.geometryType,r.NONE),this.boundingSphereCV=e.boundingSphereCV}return e.computeNumberOfVertices=function(e){o.typeOf.object("geometry",e);var t=-1;for(var r in e.attributes)if(e.attributes.hasOwnProperty(r)&&a(e.attributes[r])&&a(e.attributes[r].values)){var i=e.attributes[r],n=i.values.length/i.componentsPerAttribute;if(t!==n&&-1!==t)throw new s("All attribute lists must have the same number of attributes.");t=n}return t},e}),define("Core/GeometryAttribute",["./defaultValue","./defined","./DeveloperError"],function(t,r,i){"use strict";return function(e){if(e=t(e,t.EMPTY_OBJECT),!r(e.componentDatatype))throw new i("options.componentDatatype is required.");if(!r(e.componentsPerAttribute))throw new i("options.componentsPerAttribute is required.");if(e.componentsPerAttribute<1||4<e.componentsPerAttribute)throw new i("options.componentsPerAttribute must be between 1 and 4.");if(!r(e.values))throw new i("options.values is required.");this.componentDatatype=e.componentDatatype,this.componentsPerAttribute=e.componentsPerAttribute,this.normalize=t(e.normalize,!1),this.values=e.values}}),define("Core/GeometryAttributes",["./defaultValue"],function(t){"use strict";return function(e){e=t(e,t.EMPTY_OBJECT),this.position=e.position,this.normal=e.normal,this.st=e.st,this.bitangent=e.bitangent,this.tangent=e.tangent,this.color=e.color}}),define("Core/VertexFormat",["./defaultValue","./defined","./DeveloperError","./freezeObject"],function(i,n,o,e){"use strict";function a(e){e=i(e,i.EMPTY_OBJECT),this.position=i(e.position,!1),this.normal=i(e.normal,!1),this.st=i(e.st,!1),this.bitangent=i(e.bitangent,!1),this.tangent=i(e.tangent,!1),this.color=i(e.color,!1)}return a.POSITION_ONLY=e(new a({position:!0})),a.POSITION_AND_NORMAL=e(new a({position:!0,normal:!0})),a.POSITION_NORMAL_AND_ST=e(new a({position:!0,normal:!0,st:!0})),a.POSITION_AND_ST=e(new a({position:!0,st:!0})),a.POSITION_AND_COLOR=e(new a({position:!0,color:!0})),a.ALL=e(new a({position:!0,normal:!0,st:!0,tangent:!0,bitangent:!0})),a.DEFAULT=a.POSITION_NORMAL_AND_ST,a.packedLength=6,a.pack=function(e,t,r){if(!n(e))throw new o("value is required");if(!n(t))throw new o("array is required");return r=i(r,0),t[r++]=e.position?1:0,t[r++]=e.normal?1:0,t[r++]=e.st?1:0,t[r++]=e.tangent?1:0,t[r++]=e.bitangent?1:0,t[r]=e.color?1:0,t},a.unpack=function(e,t,r){if(!n(e))throw new o("array is required");return t=i(t,0),n(r)||(r=new a),r.position=1===e[t++],r.normal=1===e[t++],r.st=1===e[t++],r.tangent=1===e[t++],r.bitangent=1===e[t++],r.color=1===e[t],r},a.clone=function(e,t){if(n(e))return n(t)||(t=new a),t.position=e.position,t.normal=e.normal,t.st=e.st,t.tangent=e.tangent,t.bitangent=e.bitangent,t.color=e.color,t},a}),define("Core/BoxGeometry",["./BoundingSphere","./Cartesian3","./Check","./ComponentDatatype","./defaultValue","./defined","./Geometry","./GeometryAttribute","./GeometryAttributes","./PrimitiveType","./VertexFormat"],function(p,f,a,m,s,l,g,_,v,y,u){"use strict";var b=new f;function c(e){var t=(e=s(e,s.EMPTY_OBJECT)).minimum,r=e.maximum;a.typeOf.object("min",t),a.typeOf.object("max",r);var i=s(e.vertexFormat,u.DEFAULT);this._minimum=f.clone(t),this._maximum=f.clone(r),this._vertexFormat=i,this._workerName="createBoxGeometry"}c.fromDimensions=function(e){var t=(e=s(e,s.EMPTY_OBJECT)).dimensions;a.typeOf.object("dimensions",t),a.typeOf.number.greaterThanOrEquals("dimensions.x",t.x,0),a.typeOf.number.greaterThanOrEquals("dimensions.y",t.y,0),a.typeOf.number.greaterThanOrEquals("dimensions.z",t.z,0);var r=f.multiplyByScalar(t,.5,new f);return new c({minimum:f.negate(r,new f),maximum:r,vertexFormat:e.vertexFormat})},c.fromAxisAlignedBoundingBox=function(e){return a.typeOf.object("boundingBox",e),new c({minimum:e.minimum,maximum:e.maximum})},c.packedLength=2*f.packedLength+u.packedLength,c.pack=function(e,t,r){return a.typeOf.object("value",e),a.defined("array",t),r=s(r,0),f.pack(e._minimum,t,r),f.pack(e._maximum,t,r+f.packedLength),u.pack(e._vertexFormat,t,r+2*f.packedLength),t};var e,d=new f,h=new f,C=new u,w={minimum:d,maximum:h,vertexFormat:C};return c.unpack=function(e,t,r){a.defined("array",e),t=s(t,0);var i=f.unpack(e,t,d),n=f.unpack(e,t+f.packedLength,h),o=u.unpack(e,t+2*f.packedLength,C);return l(r)?(r._minimum=f.clone(i,r._minimum),r._maximum=f.clone(n,r._maximum),r._vertexFormat=u.clone(o,r._vertexFormat),r):new c(w)},c.createGeometry=function(e){var t=e._minimum,r=e._maximum,i=e._vertexFormat;if(!f.equals(t,r)){var n,o,a=new v;if(i.position&&(i.st||i.normal||i.tangent||i.bitangent)){if(i.position&&((o=new Float64Array(72))[0]=t.x,o[1]=t.y,o[2]=r.z,o[3]=r.x,o[4]=t.y,o[5]=r.z,o[6]=r.x,o[7]=r.y,o[8]=r.z,o[9]=t.x,o[10]=r.y,o[11]=r.z,o[12]=t.x,o[13]=t.y,o[14]=t.z,o[15]=r.x,o[16]=t.y,o[17]=t.z,o[18]=r.x,o[19]=r.y,o[20]=t.z,o[21]=t.x,o[22]=r.y,o[23]=t.z,o[24]=r.x,o[25]=t.y,o[26]=t.z,o[27]=r.x,o[28]=r.y,o[29]=t.z,o[30]=r.x,o[31]=r.y,o[32]=r.z,o[33]=r.x,o[34]=t.y,o[35]=r.z,o[36]=t.x,o[37]=t.y,o[38]=t.z,o[39]=t.x,o[40]=r.y,o[41]=t.z,o[42]=t.x,o[43]=r.y,o[44]=r.z,o[45]=t.x,o[46]=t.y,o[47]=r.z,o[48]=t.x,o[49]=r.y,o[50]=t.z,o[51]=r.x,o[52]=r.y,o[53]=t.z,o[54]=r.x,o[55]=r.y,o[56]=r.z,o[57]=t.x,o[58]=r.y,o[59]=r.z,o[60]=t.x,o[61]=t.y,o[62]=t.z,o[63]=r.x,o[64]=t.y,o[65]=t.z,o[66]=r.x,o[67]=t.y,o[68]=r.z,o[69]=t.x,o[70]=t.y,o[71]=r.z,a.position=new _({componentDatatype:m.DOUBLE,componentsPerAttribute:3,values:o})),i.normal){var s=new Float32Array(72);s[0]=0,s[1]=0,s[2]=1,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=1,s[9]=0,s[10]=0,s[11]=1,s[12]=0,s[13]=0,s[14]=-1,s[15]=0,s[16]=0,s[17]=-1,s[18]=0,s[19]=0,s[20]=-1,s[21]=0,s[22]=0,s[23]=-1,s[24]=1,s[25]=0,s[26]=0,s[27]=1,s[28]=0,s[29]=0,s[30]=1,s[31]=0,s[32]=0,s[33]=1,s[34]=0,s[35]=0,s[36]=-1,s[37]=0,s[38]=0,s[39]=-1,s[40]=0,s[41]=0,s[42]=-1,s[43]=0,s[44]=0,s[45]=-1,s[46]=0,s[47]=0,s[48]=0,s[49]=1,s[50]=0,s[51]=0,s[52]=1,s[53]=0,s[54]=0,s[55]=1,s[56]=0,s[57]=0,s[58]=1,s[59]=0,s[60]=0,s[61]=-1,s[62]=0,s[63]=0,s[64]=-1,s[65]=0,s[66]=0,s[67]=-1,s[68]=0,s[69]=0,s[70]=-1,s[71]=0,a.normal=new _({componentDatatype:m.FLOAT,componentsPerAttribute:3,values:s})}if(i.st){var l=new Float32Array(48);l[0]=0,l[1]=0,l[2]=1,l[3]=0,l[4]=1,l[5]=1,l[6]=0,l[7]=1,l[8]=1,l[9]=0,l[10]=0,l[11]=0,l[12]=0,l[13]=1,l[14]=1,l[15]=1,l[16]=0,l[17]=0,l[18]=1,l[19]=0,l[20]=1,l[21]=1,l[22]=0,l[23]=1,l[24]=1,l[25]=0,l[26]=0,l[27]=0,l[28]=0,l[29]=1,l[30]=1,l[31]=1,l[32]=1,l[33]=0,l[34]=0,l[35]=0,l[36]=0,l[37]=1,l[38]=1,l[39]=1,l[40]=0,l[41]=0,l[42]=1,l[43]=0,l[44]=1,l[45]=1,l[46]=0,l[47]=1,a.st=new _({componentDatatype:m.FLOAT,componentsPerAttribute:2,values:l})}if(i.tangent){var u=new Float32Array(72);u[0]=1,u[1]=0,u[2]=0,u[3]=1,u[4]=0,u[5]=0,u[6]=1,u[7]=0,u[8]=0,u[9]=1,u[10]=0,u[11]=0,u[12]=-1,u[13]=0,u[14]=0,u[15]=-1,u[16]=0,u[17]=0,u[18]=-1,u[19]=0,u[20]=0,u[21]=-1,u[22]=0,u[23]=0,u[24]=0,u[25]=1,u[26]=0,u[27]=0,u[28]=1,u[29]=0,u[30]=0,u[31]=1,u[32]=0,u[33]=0,u[34]=1,u[35]=0,u[36]=0,u[37]=-1,u[38]=0,u[39]=0,u[40]=-1,u[41]=0,u[42]=0,u[43]=-1,u[44]=0,u[45]=0,u[46]=-1,u[47]=0,u[48]=-1,u[49]=0,u[50]=0,u[51]=-1,u[52]=0,u[53]=0,u[54]=-1,u[55]=0,u[56]=0,u[57]=-1,u[58]=0,u[59]=0,u[60]=1,u[61]=0,u[62]=0,u[63]=1,u[64]=0,u[65]=0,u[66]=1,u[67]=0,u[68]=0,u[69]=1,u[70]=0,u[71]=0,a.tangent=new _({componentDatatype:m.FLOAT,componentsPerAttribute:3,values:u})}if(i.bitangent){var c=new Float32Array(72);c[0]=0,c[1]=1,c[2]=0,c[3]=0,c[4]=1,c[5]=0,c[6]=0,c[7]=1,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=1,c[14]=0,c[15]=0,c[16]=1,c[17]=0,c[18]=0,c[19]=1,c[20]=0,c[21]=0,c[22]=1,c[23]=0,c[24]=0,c[25]=0,c[26]=1,c[27]=0,c[28]=0,c[29]=1,c[30]=0,c[31]=0,c[32]=1,c[33]=0,c[34]=0,c[35]=1,c[36]=0,c[37]=0,c[38]=1,c[39]=0,c[40]=0,c[41]=1,c[42]=0,c[43]=0,c[44]=1,c[45]=0,c[46]=0,c[47]=1,c[48]=0,c[49]=0,c[50]=1,c[51]=0,c[52]=0,c[53]=1,c[54]=0,c[55]=0,c[56]=1,c[57]=0,c[58]=0,c[59]=1,c[60]=0,c[61]=0,c[62]=1,c[63]=0,c[64]=0,c[65]=1,c[66]=0,c[67]=0,c[68]=1,c[69]=0,c[70]=0,c[71]=1,a.bitangent=new _({componentDatatype:m.FLOAT,componentsPerAttribute:3,values:c})}(n=new Uint16Array(36))[0]=0,n[1]=1,n[2]=2,n[3]=0,n[4]=2,n[5]=3,n[6]=6,n[7]=5,n[8]=4,n[9]=7,n[10]=6,n[11]=4,n[12]=8,n[13]=9,n[14]=10,n[15]=8,n[16]=10,n[17]=11,n[18]=14,n[19]=13,n[20]=12,n[21]=15,n[22]=14,n[23]=12,n[24]=18,n[25]=17,n[26]=16,n[27]=19,n[28]=18,n[29]=16,n[30]=20,n[31]=21,n[32]=22,n[33]=20,n[34]=22,n[35]=23}else(o=new Float64Array(24))[0]=t.x,o[1]=t.y,o[2]=t.z,o[3]=r.x,o[4]=t.y,o[5]=t.z,o[6]=r.x,o[7]=r.y,o[8]=t.z,o[9]=t.x,o[10]=r.y,o[11]=t.z,o[12]=t.x,o[13]=t.y,o[14]=r.z,o[15]=r.x,o[16]=t.y,o[17]=r.z,o[18]=r.x,o[19]=r.y,o[20]=r.z,o[21]=t.x,o[22]=r.y,o[23]=r.z,a.position=new _({componentDatatype:m.DOUBLE,componentsPerAttribute:3,values:o}),(n=new Uint16Array(36))[0]=4,n[1]=5,n[2]=6,n[3]=4,n[4]=6,n[5]=7,n[6]=1,n[7]=0,n[8]=3,n[9]=1,n[10]=3,n[11]=2,n[12]=1,n[13]=6,n[14]=5,n[15]=1,n[16]=2,n[17]=6,n[18]=2,n[19]=3,n[20]=7,n[21]=2,n[22]=7,n[23]=6,n[24]=3,n[25]=0,n[26]=4,n[27]=3,n[28]=4,n[29]=7,n[30]=0,n[31]=1,n[32]=5,n[33]=0,n[34]=5,n[35]=4;var d=f.subtract(r,t,b),h=.5*f.magnitude(d);return new g({attributes:a,indices:n,primitiveType:y.TRIANGLES,boundingSphere:new p(f.ZERO,h)})}},c.getUnitBox=function(){return l(e)||(e=c.createGeometry(c.fromDimensions({dimensions:new f(1,1,1),vertexFormat:u.POSITION_ONLY}))),e},c}),define("Core/BoxOutlineGeometry",["./BoundingSphere","./Cartesian3","./Check","./ComponentDatatype","./defaultValue","./defined","./Geometry","./GeometryAttribute","./GeometryAttributes","./PrimitiveType"],function(l,u,o,c,a,s,d,h,p,f){"use strict";var m=new u;function g(e){var t=(e=a(e,a.EMPTY_OBJECT)).minimum,r=e.maximum;o.typeOf.object("min",t),o.typeOf.object("max",r),this._min=u.clone(t),this._max=u.clone(r),this._workerName="createBoxOutlineGeometry"}g.fromDimensions=function(e){var t=(e=a(e,a.EMPTY_OBJECT)).dimensions;o.typeOf.object("dimensions",t),o.typeOf.number.greaterThanOrEquals("dimensions.x",t.x,0),o.typeOf.number.greaterThanOrEquals("dimensions.y",t.y,0),o.typeOf.number.greaterThanOrEquals("dimensions.z",t.z,0);var r=u.multiplyByScalar(t,.5,new u);return new g({minimum:u.negate(r,new u),maximum:r})},g.fromAxisAlignedBoundingBox=function(e){return o.typeOf.object("boundindBox",e),new g({minimum:e.minimum,maximum:e.maximum})},g.packedLength=2*u.packedLength,g.pack=function(e,t,r){return o.typeOf.object("value",e),o.defined("array",t),r=a(r,0),u.pack(e._min,t,r),u.pack(e._max,t,r+u.packedLength),t};var _=new u,v=new u,y={minimum:_,maximum:v};return g.unpack=function(e,t,r){o.defined("array",e),t=a(t,0);var i=u.unpack(e,t,_),n=u.unpack(e,t+u.packedLength,v);return s(r)?(r._min=u.clone(i,r._min),r._max=u.clone(n,r._max),r):new g(y)},g.createGeometry=function(e){var t=e._min,r=e._max;if(!u.equals(t,r)){var i=new p,n=new Uint16Array(24),o=new Float64Array(24);o[0]=t.x,o[1]=t.y,o[2]=t.z,o[3]=r.x,o[4]=t.y,o[5]=t.z,o[6]=r.x,o[7]=r.y,o[8]=t.z,o[9]=t.x,o[10]=r.y,o[11]=t.z,o[12]=t.x,o[13]=t.y,o[14]=r.z,o[15]=r.x,o[16]=t.y,o[17]=r.z,o[18]=r.x,o[19]=r.y,o[20]=r.z,o[21]=t.x,o[22]=r.y,o[23]=r.z,i.position=new h({componentDatatype:c.DOUBLE,componentsPerAttribute:3,values:o}),n[0]=4,n[1]=5,n[2]=5,n[3]=6,n[4]=6,n[5]=7,n[6]=7,n[7]=4,n[8]=0,n[9]=1,n[10]=1,n[11]=2,n[12]=2,n[13]=3,n[14]=3,n[15]=0,n[16]=0,n[17]=4,n[18]=1,n[19]=5,n[20]=2,n[21]=6,n[22]=3,n[23]=7;var a=u.subtract(r,t,m),s=.5*u.magnitude(a);return new d({attributes:i,indices:n,primitiveType:f.LINES,boundingSphere:new l(u.ZERO,s)})}},g}),define("Core/buildModuleUrl",["../ThirdParty/Uri","./defined","./DeveloperError","./Resource","require"],function(e,r,t,i,n){"use strict";var o,a,s,l=/((?:.*\/)|^)cesium[\w-]*\.js(?:\W|$)/i;function u(){if(r(o))return o;var e;if(e="undefined"!=typeof CESIUM_BASE_URL?CESIUM_BASE_URL:function(){for(var e=document.getElementsByTagName("script"),t=0,r=e.length;t<r;++t){var i=e[t].getAttribute("src"),n=l.exec(i);if(null!==n)return n[1]}}(),!r(e))throw new t("Unable to determine Cesium base URL automatically, try defining a global variable called CESIUM_BASE_URL.");return o=new i({url:e})}function c(e){return n.toUrl("../"+e)}function d(e){return u().getDerivedResource({url:e}).url}function h(e){r(a)||(a=r(define.amd)&&!define.amd.toUrlUndefined&&r(n.toUrl)?c:d),r(s)||(s=document.createElement("a"));var t=a(e);return s.href=t,s.href=s.href,s.href}return h._cesiumScriptRegex=l,h.setBaseUrl=function(e){o=i.DEFAULT.getDerivedResource({url:e})},h}),define("Core/cancelAnimationFrame",["./defined"],function(i){"use strict";if("undefined"!=typeof window){var n=window.cancelAnimationFrame;return function(){if(!i(n))for(var e=["webkit","moz","ms","o"],t=0,r=e.length;t<r&&!i(n);)n=window[e[t]+"CancelAnimationFrame"],i(n)||(n=window[e[t]+"CancelRequestAnimationFrame"]),++t;i(n)||(n=clearTimeout)}(),function(e){n(e)}}}),define("Core/CartographicGeocoderService",["../ThirdParty/when","./Cartesian3","./Check"],function(u,c,d){"use strict";function e(){}return e.prototype.geocode=function(e){d.typeOf.string("query",e);var t=e.match(/[^\s,\n]+/g);if(2===t.length||3===t.length){var r=+t[0],i=+t[1],n=3===t.length?+t[2]:300;if(isNaN(r)&&isNaN(i))for(var o=/^(\d+.?\d*)([nsew])/i,a=0;a<t.length;++a){var s=t[a].match(o);o.test(t[a])&&3===s.length&&(/^[ns]/i.test(s[2])?i=/^[n]/i.test(s[2])?+s[1]:-s[1]:/^[ew]/i.test(s[2])&&(r=/^[e]/i.test(s[2])?+s[1]:-s[1]))}if(!isNaN(r)&&!isNaN(i)&&!isNaN(n)){var l={displayName:e,destination:c.fromDegrees(r,i,n)};return u.resolve([l])}}return u.resolve([])},e}),define("Core/Spline",["./Check","./defaultValue","./defined","./DeveloperError","./Math"],function(o,a,s,l,r){"use strict";function e(){this.times=void 0,this.points=void 0,l.throwInstantiationError()}return e.prototype.evaluate=l.throwInstantiationError,e.prototype.findTimeInterval=function(e,t){var r,i=this.times,n=i.length;if(!s(e))throw new l("time is required.");if(e<i[0]||e>i[n-1])throw new l("time is out of range.");if(e>=i[t=a(t,0)]){if(t+1<n&&e<i[t+1])return t;if(t+2<n&&e<i[t+2])return t+1}else if(0<=t-1&&e>=i[t-1])return t-1;if(e>i[t])for(r=t;r<n-1&&!(e>=i[r]&&e<i[r+1]);++r);else for(r=t-1;0<=r&&!(e>=i[r]&&e<i[r+1]);--r);return r===n-1&&(r=n-2),r},e.prototype.wrapTime=function(e){o.typeOf.number("time",e);var t=this.times,r=t[t.length-1],i=t[0],n=r-i;return e<i&&(e+=(Math.floor((i-e)/n)+1)*n),r<e&&(e-=(Math.floor((e-r)/n)+1)*n),e},e.prototype.clampTime=function(e){o.typeOf.number("time",e);var t=this.times;return r.clamp(e,t[0],t[t.length-1])},e}),define("Core/LinearSpline",["./Cartesian3","./defaultValue","./defined","./defineProperties","./DeveloperError","./Spline"],function(a,i,s,e,n,t){"use strict";function r(e){var t=(e=i(e,i.EMPTY_OBJECT)).points,r=e.times;if(!s(t)||!s(r))throw new n("points and times are required.");if(t.length<2)throw new n("points.length must be greater than or equal to 2.");if(r.length!==t.length)throw new n("times.length must be equal to points.length.");this._times=r,this._points=t,this._lastTimeIndex=0}return e(r.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}}),r.prototype.findTimeInterval=t.prototype.findTimeInterval,r.prototype.wrapTime=t.prototype.wrapTime,r.prototype.clampTime=t.prototype.clampTime,r.prototype.evaluate=function(e,t){var r=this.points,i=this.times,n=this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex),o=(e-i[n])/(i[n+1]-i[n]);return s(t)||(t=new a),a.lerp(r[n],r[n+1],o,t)},r}),define("Core/TridiagonalSystemSolver",["./Cartesian3","./defined","./DeveloperError"],function(u,c,d){"use strict";var e={solve:function(e,t,r,i){if(!(c(e)&&e instanceof Array))throw new d("The array lower is required.");if(!(c(t)&&t instanceof Array))throw new d("The array diagonal is required.");if(!(c(r)&&r instanceof Array))throw new d("The array upper is required.");if(!(c(i)&&i instanceof Array))throw new d("The array right is required.");if(t.length!==i.length)throw new d("diagonal and right must have the same lengths.");if(e.length!==r.length)throw new d("lower and upper must have the same lengths.");if(e.length!==t.length-1)throw new d("lower and upper must be one less than the length of diagonal.");var n,o,a=new Array(r.length),s=new Array(i.length),l=new Array(i.length);for(n=0;n<s.length;n++)s[n]=new u,l[n]=new u;for(a[0]=r[0]/t[0],s[0]=u.multiplyByScalar(i[0],1/t[0],s[0]),n=1;n<a.length;++n)o=1/(t[n]-a[n-1]*e[n-1]),a[n]=r[n]*o,s[n]=u.subtract(i[n],u.multiplyByScalar(s[n-1],e[n-1],s[n]),s[n]),s[n]=u.multiplyByScalar(s[n],o,s[n]);for(o=1/(t[n]-a[n-1]*e[n-1]),s[n]=u.subtract(i[n],u.multiplyByScalar(s[n-1],e[n-1],s[n]),s[n]),s[n]=u.multiplyByScalar(s[n],o,s[n]),l[l.length-1]=s[s.length-1],n=l.length-2;0<=n;--n)l[n]=u.subtract(s[n],u.multiplyByScalar(l[n+1],a[n],l[n]),l[n]);return l}};return e}),define("Core/HermiteSpline",["./Cartesian3","./Cartesian4","./defaultValue","./defined","./defineProperties","./DeveloperError","./LinearSpline","./Matrix4","./Spline","./TridiagonalSystemSolver"],function(c,e,s,d,t,l,u,h,r,p){"use strict";var f=[],m=[],g=[],_=[];function v(e){var t=(e=s(e,s.EMPTY_OBJECT)).points,r=e.times,i=e.inTangents,n=e.outTangents;if(!(d(t)&&d(r)&&d(i)&&d(n)))throw new l("times, points, inTangents, and outTangents are required.");if(t.length<2)throw new l("points.length must be greater than or equal to 2.");if(r.length!==t.length)throw new l("times.length must be equal to points.length.");if(i.length!==n.length||i.length!==t.length-1)throw new l("inTangents and outTangents must have a length equal to points.length - 1.");this._times=r,this._points=t,this._inTangents=i,this._outTangents=n,this._lastTimeIndex=0}t(v.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},inTangents:{get:function(){return this._inTangents}},outTangents:{get:function(){return this._outTangents}}}),v.createC1=function(e){var t=(e=s(e,s.EMPTY_OBJECT)).times,r=e.points,i=e.tangents;if(!d(r)||!d(t)||!d(i))throw new l("points, times and tangents are required.");if(r.length<2)throw new l("points.length must be greater than or equal to 2.");if(t.length!==r.length||t.length!==i.length)throw new l("times, points and tangents must have the same length.");var n=i.slice(0,i.length-1);return new v({times:t,points:r,inTangents:i.slice(1,i.length),outTangents:n})},v.createNaturalCubic=function(e){var t=(e=s(e,s.EMPTY_OBJECT)).times,r=e.points;if(!d(r)||!d(t))throw new l("points and times are required.");if(r.length<2)throw new l("points.length must be greater than or equal to 2.");if(t.length!==r.length)throw new l("times.length must be equal to points.length.");if(r.length<3)return new u({points:r,times:t});var i=function(e){var t,r=f,i=g,n=m,o=_;r.length=i.length=e.length-1,n.length=o.length=e.length,r[0]=i[0]=1,n[0]=2;var a=o[0];for(d(a)||(a=o[0]=new c),c.subtract(e[1],e[0],a),c.multiplyByScalar(a,3,a),t=1;t<r.length;++t)r[t]=i[t]=1,n[t]=4,a=o[t],d(a)||(a=o[t]=new c),c.subtract(e[t+1],e[t-1],a),c.multiplyByScalar(a,3,a);return n[t]=2,a=o[t],d(a)||(a=o[t]=new c),c.subtract(e[t],e[t-1],a),c.multiplyByScalar(a,3,a),p.solve(r,n,i,o)}(r),n=i.slice(0,i.length-1);return new v({times:t,points:r,inTangents:i.slice(1,i.length),outTangents:n})},v.createClampedCubic=function(e){var t=(e=s(e,s.EMPTY_OBJECT)).times,r=e.points,i=e.firstTangent,n=e.lastTangent;if(!(d(r)&&d(t)&&d(i)&&d(n)))throw new l("points, times, firstTangent and lastTangent are required.");if(r.length<2)throw new l("points.length must be greater than or equal to 2.");if(t.length!==r.length)throw new l("times.length must be equal to points.length.");if(r.length<3)return new u({points:r,times:t});var o=function(e,t,r){var i,n=f,o=g,a=m,s=_;n.length=o.length=e.length-1,a.length=s.length=e.length,n[0]=a[0]=1;var l=s[o[0]=0];for(d(l)||(l=s[0]=new c),c.clone(t,l),i=1;i<n.length-1;++i)n[i]=o[i]=1,a[i]=4,l=s[i],d(l)||(l=s[i]=new c),c.subtract(e[i+1],e[i-1],l),c.multiplyByScalar(l,3,l);return n[i]=0,o[i]=1,a[i]=4,l=s[i],d(l)||(l=s[i]=new c),c.subtract(e[i+1],e[i-1],l),c.multiplyByScalar(l,3,l),l=s[i+(a[i+1]=1)],d(l)||(l=s[i+1]=new c),c.clone(r,l),p.solve(n,a,o,s)}(r,i,n),a=o.slice(0,o.length-1);return new v({times:t,points:r,inTangents:o.slice(1,o.length),outTangents:a})},v.hermiteCoefficientMatrix=new h(2,-3,0,1,-2,3,0,0,1,-2,1,0,1,-1,0,0),v.prototype.findTimeInterval=r.prototype.findTimeInterval;var y=new e,b=new c;return v.prototype.wrapTime=r.prototype.wrapTime,v.prototype.clampTime=r.prototype.clampTime,v.prototype.evaluate=function(e,t){d(t)||(t=new c);var r=this.points,i=this.times,n=this.inTangents,o=this.outTangents,a=this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex),s=(e-i[a])/(i[a+1]-i[a]),l=y;l.z=s,l.y=s*s,l.x=l.y*s,l.w=1;var u=h.multiplyByVector(v.hermiteCoefficientMatrix,l,l);return t=c.multiplyByScalar(r[a],u.x,t),c.multiplyByScalar(r[a+1],u.y,b),c.add(t,b,t),c.multiplyByScalar(o[a],u.z,b),c.add(t,b,t),c.multiplyByScalar(n[a],u.w,b),c.add(t,b,t)},v}),define("Core/CatmullRomSpline",["./Cartesian3","./Cartesian4","./Check","./defaultValue","./defined","./defineProperties","./HermiteSpline","./Matrix4","./Spline"],function(p,e,a,s,f,t,m,g,r){"use strict";var _=new e,v=new p,y=new p;var l=new p,u=new p;function b(e){var t=(e=s(e,s.EMPTY_OBJECT)).points,r=e.times,i=e.firstTangent,n=e.lastTangent;if(a.defined("points",t),a.defined("times",r),a.typeOf.number.greaterThanOrEquals("points.length",t.length,2),a.typeOf.number.equals("times.length","points.length",r.length,t.length),2<t.length&&(f(i)||(i=l,p.multiplyByScalar(t[1],2,i),p.subtract(i,t[2],i),p.subtract(i,t[0],i),p.multiplyByScalar(i,.5,i)),!f(n))){var o=t.length-1;n=u,p.multiplyByScalar(t[o-1],2,n),p.subtract(t[o],n,n),p.add(n,t[o-2],n),p.multiplyByScalar(n,.5,n)}this._times=r,this._points=t,this._firstTangent=p.clone(i),this._lastTangent=p.clone(n),this._evaluateFunction=function(c){var d=c.points,h=c.times;if(d.length<3){var i=h[0],n=1/(h[1]-i),o=d[0],a=d[1];return function(e,t){f(t)||(t=new p);var r=(e-i)*n;return p.lerp(o,a,r,t)}}return function(e,t){f(t)||(t=new p);var r,i,n,o,a,s=c._lastTimeIndex=c.findTimeInterval(e,c._lastTimeIndex),l=(e-h[s])/(h[s+1]-h[s]),u=_;return u.z=l,u.y=l*l,u.x=u.y*l,u.w=1,a=0===s?(r=d[0],i=d[1],n=c.firstTangent,o=p.subtract(d[2],r,v),p.multiplyByScalar(o,.5,o),g.multiplyByVector(m.hermiteCoefficientMatrix,u,u)):s===d.length-2?(r=d[s],i=d[s+1],o=c.lastTangent,n=p.subtract(i,d[s-1],v),p.multiplyByScalar(n,.5,n),g.multiplyByVector(m.hermiteCoefficientMatrix,u,u)):(r=d[s-1],i=d[s],n=d[s+1],o=d[s+2],g.multiplyByVector(b.catmullRomCoefficientMatrix,u,u)),t=p.multiplyByScalar(r,a.x,t),p.multiplyByScalar(i,a.y,y),p.add(t,y,t),p.multiplyByScalar(n,a.z,y),p.add(t,y,t),p.multiplyByScalar(o,a.w,y),p.add(t,y,t)}}(this),this._lastTimeIndex=0}return t(b.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},firstTangent:{get:function(){return this._firstTangent}},lastTangent:{get:function(){return this._lastTangent}}}),b.catmullRomCoefficientMatrix=new g(-.5,1,-.5,0,1.5,-2.5,0,1,-1.5,2,.5,0,.5,-.5,0,0),b.prototype.findTimeInterval=r.prototype.findTimeInterval,b.prototype.wrapTime=r.prototype.wrapTime,b.prototype.clampTime=r.prototype.clampTime,b.prototype.evaluate=function(e,t){return this._evaluateFunction(e,t)},b}),define("Core/GeographicTilingScheme",["./Cartesian2","./Check","./defaultValue","./defined","./defineProperties","./Ellipsoid","./GeographicProjection","./Math","./Rectangle"],function(d,a,t,p,e,r,i,h,f){"use strict";function n(e){e=t(e,{}),this._ellipsoid=t(e.ellipsoid,r.WGS84),this._rectangle=t(e.rectangle,f.MAX_VALUE),this._projection=new i(this._ellipsoid),this._numberOfLevelZeroTilesX=t(e.numberOfLevelZeroTilesX,2),this._numberOfLevelZeroTilesY=t(e.numberOfLevelZeroTilesY,1)}return e(n.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}}),n.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e},n.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e},n.prototype.rectangleToNativeRectangle=function(e,t){a.defined("rectangle",e);var r=h.toDegrees(e.west),i=h.toDegrees(e.south),n=h.toDegrees(e.east),o=h.toDegrees(e.north);return p(t)?(t.west=r,t.south=i,t.east=n,t.north=o,t):new f(r,i,n,o)},n.prototype.tileXYToNativeRectangle=function(e,t,r,i){var n=this.tileXYToRectangle(e,t,r,i);return n.west=h.toDegrees(n.west),n.south=h.toDegrees(n.south),n.east=h.toDegrees(n.east),n.north=h.toDegrees(n.north),n},n.prototype.tileXYToRectangle=function(e,t,r,i){var n=this._rectangle,o=this.getNumberOfXTilesAtLevel(r),a=this.getNumberOfYTilesAtLevel(r),s=n.width/o,l=e*s+n.west,u=(e+1)*s+n.west,c=n.height/a,d=n.north-t*c,h=n.north-(t+1)*c;return p(i)||(i=new f(l,h,u,d)),i.west=l,i.south=h,i.east=u,i.north=d,i},n.prototype.positionToTileXY=function(e,t,r){var i=this._rectangle;if(f.contains(i,e)){var n=this.getNumberOfXTilesAtLevel(t),o=this.getNumberOfYTilesAtLevel(t),a=i.width/n,s=i.height/o,l=e.longitude;i.east<i.west&&(l+=h.TWO_PI);var u=(l-i.west)/a|0;n<=u&&(u=n-1);var c=(i.north-e.latitude)/s|0;return o<=c&&(c=o-1),p(r)?(r.x=u,r.y=c,r):new d(u,c)}},n}),define("Core/EllipsoidalOccluder",["./BoundingSphere","./Cartesian3","./Check","./defaultValue","./defined","./defineProperties","./Rectangle"],function(o,d,h,p,f,e,a){"use strict";function t(e,t){h.typeOf.object("ellipsoid",e),this._ellipsoid=e,this._cameraPosition=new d,this._cameraPositionInScaledSpace=new d,this._distanceToLimbInScaledSpaceSquared=0,f(t)&&(this.cameraPosition=t)}e(t.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},cameraPosition:{get:function(){return this._cameraPosition},set:function(e){var t=this._ellipsoid.transformPositionToScaledSpace(e,this._cameraPositionInScaledSpace),r=d.magnitudeSquared(t)-1;d.clone(e,this._cameraPosition),this._cameraPositionInScaledSpace=t,this._distanceToLimbInScaledSpaceSquared=r}}});var s=new d;t.prototype.isPointVisible=function(e){var t=this._ellipsoid.transformPositionToScaledSpace(e,s);return this.isScaledSpacePointVisible(t)},t.prototype.isScaledSpacePointVisible=function(e){var t=this._cameraPositionInScaledSpace,r=this._distanceToLimbInScaledSpaceSquared,i=d.subtract(e,t,s),n=-d.dot(i,t);return!(r<0?0<n:r<n&&n*n/d.magnitudeSquared(i)>r)},t.prototype.computeHorizonCullingPoint=function(e,t,r){h.typeOf.object("directionToPoint",e),h.defined("positions",t),f(r)||(r=new d);for(var i=this._ellipsoid,n=v(i,e),o=0,a=0,s=t.length;a<s;++a){var l=g(i,t[a],n);o=Math.max(o,l)}return _(n,o,r)};var m=new d;t.prototype.computeHorizonCullingPointFromVertices=function(e,t,r,i,n){h.typeOf.object("directionToPoint",e),h.defined("vertices",t),h.typeOf.number("stride",r),f(n)||(n=new d),i=p(i,d.ZERO);for(var o=this._ellipsoid,a=v(o,e),s=0,l=0,u=t.length;l<u;l+=r){m.x=t[l]+i.x,m.y=t[l+1]+i.y,m.z=t[l+2]+i.z;var c=g(o,m,a);s=Math.max(s,c)}return _(a,s,n)};var l=[];t.prototype.computeHorizonCullingPointFromRectangle=function(e,t,r){h.typeOf.object("rectangle",e);var i=a.subsample(e,t,0,l),n=o.fromPoints(i);if(!(d.magnitude(n.center)<.1*t.minimumRadius))return this.computeHorizonCullingPoint(n.center,i,r)};var u=new d,c=new d;function g(e,t,r){var i=e.transformPositionToScaledSpace(t,u),n=d.magnitudeSquared(i),o=Math.sqrt(n),a=d.divideByScalar(i,o,c);n=Math.max(1,n);var s=1/(o=Math.max(1,o));return 1/(d.dot(a,r)*s-d.magnitude(d.cross(a,r,a))*(Math.sqrt(n-1)*s))}function _(e,t,r){if(!(t<=0||t===1/0||t!=t))return d.multiplyByScalar(e,t,r)}var r=new d;function v(e,t){return d.equals(t,d.ZERO)?t:(e.transformPositionToScaledSpace(t,r),d.normalize(r,r))}return t}),define("Core/QuadraticRealPolynomial",["./DeveloperError","./Math"],function(u,c){"use strict";var e={};function d(e,t,r){var i=e+t;return c.sign(e)!==c.sign(t)&&Math.abs(i/Math.max(Math.abs(e),Math.abs(t)))<r?0:i}return e.computeDiscriminant=function(e,t,r){if("number"!=typeof e)throw new u("a is a required number.");if("number"!=typeof t)throw new u("b is a required number.");if("number"!=typeof r)throw new u("c is a required number.");return t*t-4*e*r},e.computeRealRoots=function(e,t,r){if("number"!=typeof e)throw new u("a is a required number.");if("number"!=typeof t)throw new u("b is a required number.");if("number"!=typeof r)throw new u("c is a required number.");var i;if(0===e)return 0===t?[]:[-r/t];if(0===t){if(0===r)return[0,0];var n=Math.abs(r),o=Math.abs(e);if(n<o&&n/o<c.EPSILON14)return[0,0];if(o<n&&o/n<c.EPSILON14)return[];if((i=-r/e)<0)return[];var a=Math.sqrt(i);return[-a,a]}if(0===r)return(i=-t/e)<0?[i,0]:[0,i];var s=d(t*t,-(4*e*r),c.EPSILON14);if(s<0)return[];var l=-.5*d(t,c.sign(t)*Math.sqrt(s),c.EPSILON14);return 0<t?[l/e,r/l]:[r/l,l/e]},e}),define("Core/CubicRealPolynomial",["./DeveloperError","./QuadraticRealPolynomial"],function(s,l){"use strict";var e={};function u(e,t,r,i){var n,o,a=e,s=t/3,l=r/3,u=i,c=a*l,d=s*u,h=s*s,p=l*l,f=a*l-h,m=a*u-s*l,g=s*u-p,_=4*f*g-m*m;if(_<0){var v,y,b,C=-((b=c*p<=h*d?-2*s*(y=f)+(v=a)*m:-(v=u)*m+2*l*(y=g))<0?-1:1)*Math.abs(v)*Math.sqrt(-_),w=(o=-b+C)/2,S=w<0?-Math.pow(-w,1/3):Math.pow(w,1/3),T=o===C?-S:-y/S;return n=y<=0?S+T:-b/(S*S+T*T+y),c*p<=h*d?[(n-s)/a]:[-u/(n+l)]}var E=f,A=-2*s*f+a*m,x=g,P=-u*m+2*l*g,D=Math.sqrt(_),O=Math.sqrt(3)/2,I=Math.abs(Math.atan2(a*D,-A)/3);n=2*Math.sqrt(-E);var M=Math.cos(I);o=n*M;var R=n*(-M/2-O*Math.sin(I)),L=2*s<o+R?o-s:R-s,N=a,k=L/N;I=Math.abs(Math.atan2(u*D,-P)/3);var F=-u,B=(o=(n=2*Math.sqrt(-x))*(M=Math.cos(I)))+(R=n*(-M/2-O*Math.sin(I)))<2*l?o+l:R+l,U=F/B,V=-L*B-N*F,z=(l*V-s*(L*F))/(-s*V+l*(N*B));return k<=z?k<=U?z<=U?[k,z,U]:[k,U,z]:[U,k,z]:k<=U?[z,k,U]:z<=U?[z,U,k]:[U,z,k]}return e.computeDiscriminant=function(e,t,r,i){if("number"!=typeof e)throw new s("a is a required number.");if("number"!=typeof t)throw new s("b is a required number.");if("number"!=typeof r)throw new s("c is a required number.");if("number"!=typeof i)throw new s("d is a required number.");var n=t*t,o=r*r;return 18*e*t*r*i+n*o-27*(e*e)*(i*i)-4*(e*o*r+n*t*i)},e.computeRealRoots=function(e,t,r,i){if("number"!=typeof e)throw new s("a is a required number.");if("number"!=typeof t)throw new s("b is a required number.");if("number"!=typeof r)throw new s("c is a required number.");if("number"!=typeof i)throw new s("d is a required number.");var n,o;if(0===e)return l.computeRealRoots(t,r,i);if(0!==t)return 0===r?0===i?(o=-t/e)<0?[o,0,0]:[0,0,o]:u(e,t,0,i):0===i?0===(n=l.computeRealRoots(e,t,r)).length?[0]:n[1]<=0?[n[0],n[1],0]:0<=n[0]?[0,n[0],n[1]]:[n[0],0,n[1]]:u(e,t,r,i);if(0!==r)return 0===i?0===(n=l.computeRealRoots(e,0,r)).Length?[0]:[n[0],0,n[1]]:u(e,0,r,i);if(0===i)return[0,0,0];var a=(o=-i/e)<0?-Math.pow(-o,1/3):Math.pow(o,1/3);return[a,a,a]},e}),define("Core/QuarticRealPolynomial",["./CubicRealPolynomial","./DeveloperError","./Math","./QuadraticRealPolynomial"],function(P,p,D,O){"use strict";var e={};function c(e,t,r,i){var n=e*e,o=t-3*n/8,a=r-t*e/2+n*e/8,s=i-r*e/4+t*n/16-3*n*n/256,l=P.computeRealRoots(1,2*o,o*o-4*s,-a*a);if(0<l.length){var u=-e/4,c=l[l.length-1];if(Math.abs(c)<D.EPSILON14){var d=O.computeRealRoots(1,o,s);if(2===d.length){var h,p=d[0],f=d[1];if(0<=p&&0<=f){var m=Math.sqrt(p),g=Math.sqrt(f);return[u-g,u-m,u+m,u+g]}if(0<=p&&f<0)return[u-(h=Math.sqrt(p)),u+h];if(p<0&&0<=f)return[u-(h=Math.sqrt(f)),u+h]}return[]}if(0<c){var _=Math.sqrt(c),v=(o+c-a/_)/2,y=(o+c+a/_)/2,b=O.computeRealRoots(1,_,v),C=O.computeRealRoots(1,-_,y);return 0!==b.length?(b[0]+=u,b[1]+=u,0!==C.length?(C[0]+=u,C[1]+=u,b[1]<=C[0]?[b[0],b[1],C[0],C[1]]:C[1]<=b[0]?[C[0],C[1],b[0],b[1]]:b[0]>=C[0]&&b[1]<=C[1]?[C[0],b[0],b[1],C[1]]:C[0]>=b[0]&&C[1]<=b[1]?[b[0],C[0],C[1],b[1]]:b[0]>C[0]&&b[0]<C[1]?[C[0],b[0],C[1],b[1]]:[b[0],C[0],b[1],C[1]]):b):0!==C.length?(C[0]+=u,C[1]+=u,C):[]}}return[]}function d(e,t,r,i){var n=e*e,o=-2*t,a=r*e+t*t-4*i,s=n*i-r*t*e+r*r,l=P.computeRealRoots(1,o,a,s);if(0<l.length){var u,c,d,h,p,f,m=l[0],g=t-m,_=g*g,v=e/2,y=g/2,b=_-4*i,C=_+4*Math.abs(i),w=n-4*m,S=n+4*Math.abs(m);if(m<0||b*S<w*C){var T=Math.sqrt(w);u=T/2,c=0===T?0:(e*y-r)/T}else{var E=Math.sqrt(b);u=0===E?0:(e*y-r)/E,c=E/2}0===v&&0===u?h=d=0:D.sign(v)===D.sign(u)?h=m/(d=v+u):d=m/(h=v-u),0===y&&0===c?f=p=0:D.sign(y)===D.sign(c)?f=i/(p=y+c):p=i/(f=y-c);var A=O.computeRealRoots(1,d,p),x=O.computeRealRoots(1,h,f);if(0!==A.length)return 0!==x.length?A[1]<=x[0]?[A[0],A[1],x[0],x[1]]:x[1]<=A[0]?[x[0],x[1],A[0],A[1]]:A[0]>=x[0]&&A[1]<=x[1]?[x[0],A[0],A[1],x[1]]:x[0]>=A[0]&&x[1]<=A[1]?[A[0],x[0],x[1],A[1]]:A[0]>x[0]&&A[0]<x[1]?[x[0],A[0],x[1],A[1]]:[A[0],x[0],A[1],x[1]]:A;if(0!==x.length)return x}return[]}return e.computeDiscriminant=function(e,t,r,i,n){if("number"!=typeof e)throw new p("a is a required number.");if("number"!=typeof t)throw new p("b is a required number.");if("number"!=typeof r)throw new p("c is a required number.");if("number"!=typeof i)throw new p("d is a required number.");if("number"!=typeof n)throw new p("e is a required number.");var o=e*e,a=t*t,s=a*t,l=r*r,u=l*r,c=i*i,d=c*i,h=n*n;return a*l*c-4*s*d-4*e*u*c+18*e*t*r*d-27*o*c*c+256*(o*e)*(h*n)+n*(18*s*r*i-4*a*u+16*e*l*l-80*e*t*l*i-6*e*a*c+144*o*r*c)+h*(144*e*a*r-27*a*a-128*o*l-192*o*t*i)},e.computeRealRoots=function(e,t,r,i,n){if("number"!=typeof e)throw new p("a is a required number.");if("number"!=typeof t)throw new p("b is a required number.");if("number"!=typeof r)throw new p("c is a required number.");if("number"!=typeof i)throw new p("d is a required number.");if("number"!=typeof n)throw new p("e is a required number.");if(Math.abs(e)<D.EPSILON15)return P.computeRealRoots(t,r,i,n);var o=t/e,a=r/e,s=i/e,l=n/e,u=o<0?1:0;switch(u+=a<0?u+1:u,u+=s<0?u+1:u,u+=l<0?u+1:u){case 0:return c(o,a,s,l);case 1:case 2:return d(o,a,s,l);case 3:case 4:return c(o,a,s,l);case 5:return d(o,a,s,l);case 6:case 7:return c(o,a,s,l);case 8:return d(o,a,s,l);case 9:case 10:return c(o,a,s,l);case 11:return d(o,a,s,l);case 12:case 13:case 14:case 15:return c(o,a,s,l);default:return}},e}),define("Core/Ray",["./Cartesian3","./defaultValue","./defined","./DeveloperError"],function(i,r,n,o){"use strict";function e(e,t){t=i.clone(r(t,i.ZERO)),i.equals(t,i.ZERO)||i.normalize(t,t),this.origin=i.clone(r(e,i.ZERO)),this.direction=t}return e.getPoint=function(e,t,r){if(!n(e))throw new o("ray is requred");if("number"!=typeof t)throw new o("t is a required number");return n(r)||(r=new i),r=i.multiplyByScalar(e.direction,t,r),i.add(e.origin,r,r)},e}),define("Core/IntersectionTests",["./Cartesian3","./Cartographic","./defaultValue","./defined","./DeveloperError","./Interval","./Math","./Matrix3","./QuadraticRealPolynomial","./QuarticRealPolynomial","./Ray"],function(R,e,_,D,O,g,L,N,k,F,t){"use strict";var h={rayPlane:function(e,t,r){if(!D(e))throw new O("ray is required.");if(!D(t))throw new O("plane is required.");D(r)||(r=new R);var i=e.origin,n=e.direction,o=t.normal,a=R.dot(o,n);if(!(Math.abs(a)<L.EPSILON15)){var s=(-t.distance-R.dot(o,i))/a;if(!(s<0))return r=R.multiplyByScalar(n,s,r),R.add(i,r,r)}}},v=new R,y=new R,b=new R,C=new R,w=new R;h.rayTriangleParametric=function(e,t,r,i,n){if(!D(e))throw new O("ray is required.");if(!D(t))throw new O("p0 is required.");if(!D(r))throw new O("p1 is required.");if(!D(i))throw new O("p2 is required.");n=_(n,!1);var o,a,s,l,u,c=e.origin,d=e.direction,h=R.subtract(r,t,v),p=R.subtract(i,t,y),f=R.cross(d,p,b),m=R.dot(h,f);if(n){if(m<L.EPSILON6)return;if(o=R.subtract(c,t,C),(s=R.dot(o,f))<0||m<s)return;if(a=R.cross(o,h,w),(l=R.dot(d,a))<0||m<s+l)return;u=R.dot(p,a)/m}else{if(Math.abs(m)<L.EPSILON6)return;var g=1/m;if(o=R.subtract(c,t,C),(s=R.dot(o,f)*g)<0||1<s)return;if(a=R.cross(o,h,w),(l=R.dot(d,a)*g)<0||1<s+l)return;u=R.dot(p,a)*g}return u},h.rayTriangle=function(e,t,r,i,n,o){var a=h.rayTriangleParametric(e,t,r,i,n);if(D(a)&&!(a<0))return D(o)||(o=new R),R.multiplyByScalar(e.direction,a,o),R.add(e.origin,o,o)};var u=new t;h.lineSegmentTriangle=function(e,t,r,i,n,o,a){if(!D(e))throw new O("v0 is required.");if(!D(t))throw new O("v1 is required.");if(!D(r))throw new O("p0 is required.");if(!D(i))throw new O("p1 is required.");if(!D(n))throw new O("p2 is required.");var s=u;R.clone(e,s.origin),R.subtract(t,e,s.direction),R.normalize(s.direction,s.direction);var l=h.rayTriangleParametric(s,r,i,n,o);if(!(!D(l)||l<0||l>R.distance(e,t)))return D(a)||(a=new R),R.multiplyByScalar(s.direction,l,a),R.add(s.origin,a,a)};var c={root0:0,root1:0};function s(e,t,r){D(r)||(r=new g);var i=e.origin,n=e.direction,o=t.center,a=t.radius*t.radius,s=R.subtract(i,o,b),l=function(e,t,r,i){var n=t*t-4*e*r;if(!(n<0)){if(0<n){var o=1/(2*e),a=Math.sqrt(n),s=(-t+a)*o,l=(-t-a)*o;return i.root1=s<l?(i.root0=s,l):(i.root0=l,s),i}var u=-t/(2*e);if(0!==u)return i.root0=i.root1=u,i}}(R.dot(n,n),2*R.dot(n,s),R.magnitudeSquared(s)-a,c);if(D(l))return r.start=l.root0,r.stop=l.root1,r}h.raySphere=function(e,t,r){if(!D(e))throw new O("ray is required.");if(!D(t))throw new O("sphere is required.");if(r=s(e,t,r),D(r)&&!(r.stop<0))return r.start=Math.max(r.start,0),r};var l=new t;h.lineSegmentSphere=function(e,t,r,i){if(!D(e))throw new O("p0 is required.");if(!D(t))throw new O("p1 is required.");if(!D(r))throw new O("sphere is required.");var n=l;R.clone(e,n.origin);var o=R.subtract(t,e,n.direction),a=R.magnitude(o);if(R.normalize(o,o),i=s(n,r,i),!(!D(i)||i.stop<0||i.start>a))return i.start=Math.max(i.start,0),i.stop=Math.min(i.stop,a),i};var S=new R,T=new R;function B(e,t,r){var i=e+t;return L.sign(e)!==L.sign(t)&&Math.abs(i/Math.max(Math.abs(e),Math.abs(t)))<r?0:i}h.rayEllipsoid=function(e,t){if(!D(e))throw new O("ray is required.");if(!D(t))throw new O("ellipsoid is required.");var r,i,n,o,a,s=t.oneOverRadii,l=R.multiplyComponents(s,e.origin,S),u=R.multiplyComponents(s,e.direction,T),c=R.magnitudeSquared(l),d=R.dot(l,u);if(1<c){if(0<=d)return;var h=d*d;if(r=c-1,h<(n=(i=R.magnitudeSquared(u))*r))return;if(n<h){o=d*d-n;var p=(a=-d+Math.sqrt(o))/i,f=r/a;return p<f?new g(p,f):{start:f,stop:p}}var m=Math.sqrt(r/i);return new g(m,m)}return c<1?(r=c-1,o=d*d-(n=(i=R.magnitudeSquared(u))*r),a=-d+Math.sqrt(o),new g(0,a/i)):d<0?(i=R.magnitudeSquared(u),new g(0,-d/i)):void 0};var I=new R,M=new R,U=new R,V=new R,z=new R,q=new N,G=new N,W=new N,H=new N,j=new N,Y=new N,X=new N,Q=new R,Z=new R,K=new e;h.grazingAltitudeLocation=function(e,t){if(!D(e))throw new O("ray is required.");if(!D(t))throw new O("ellipsoid is required.");var r=e.origin,i=e.direction;if(!R.equals(r,R.ZERO)){var n=t.geodeticSurfaceNormal(r,I);if(0<=R.dot(i,n))return r}var o=D(this.rayEllipsoid(e,t)),a=t.transformPositionToScaledSpace(i,I),s=R.normalize(a,a),l=R.mostOrthogonalAxis(a,V),u=R.normalize(R.cross(l,s,M),M),c=R.normalize(R.cross(s,u,U),U),d=q;d[0]=s.x,d[1]=s.y,d[2]=s.z,d[3]=u.x,d[4]=u.y,d[5]=u.z,d[6]=c.x,d[7]=c.y,d[8]=c.z;var h=N.transpose(d,G),p=N.fromScale(t.radii,W),f=N.fromScale(t.oneOverRadii,H),m=j;m[0]=0,m[1]=-i.z,m[2]=i.y,m[3]=i.z,m[4]=0,m[5]=-i.x,m[6]=-i.y,m[7]=i.x,m[8]=0;var g,_,v=N.multiply(N.multiply(h,f,Y),m,Y),y=N.multiply(N.multiply(v,p,X),d,X),b=N.multiplyByVector(v,r,z),C=function(e,t,r,i,n){var o,a=i*i,s=n*n,l=(e[N.COLUMN1ROW1]-e[N.COLUMN2ROW2])*s,u=n*(i*B(e[N.COLUMN1ROW0],e[N.COLUMN0ROW1],L.EPSILON15)+t.y),c=e[N.COLUMN0ROW0]*a+e[N.COLUMN2ROW2]*s+i*t.x+r,d=s*B(e[N.COLUMN2ROW1],e[N.COLUMN1ROW2],L.EPSILON15),h=n*(i*B(e[N.COLUMN2ROW0],e[N.COLUMN0ROW2])+t.z),p=[];if(0===h&&0===d){if(0===(o=k.computeRealRoots(l,u,c)).length)return p;var f=o[0],m=Math.sqrt(Math.max(1-f*f,0));if(p.push(new R(i,n*f,n*-m)),p.push(new R(i,n*f,n*m)),2===o.length){var g=o[1],_=Math.sqrt(Math.max(1-g*g,0));p.push(new R(i,n*g,n*-_)),p.push(new R(i,n*g,n*_))}return p}var v=h*h,y=d*d,b=h*d,C=l*l+y,w=2*(u*l+b),S=2*c*l+u*u-y+v,T=2*(c*u-b),E=c*c-v;if(0===C&&0===w&&0===S&&0===T)return p;var A=(o=F.computeRealRoots(C,w,S,T,E)).length;if(0===A)return p;for(var x=0;x<A;++x){var P=o[x],D=P*P,O=Math.max(1-D,0),I=Math.sqrt(O),M=(L.sign(l)===L.sign(c)?B(l*D+c,u*P,L.EPSILON12):L.sign(c)===L.sign(u*P)?B(l*D,u*P+c,L.EPSILON12):B(l*D+u*P,c,L.EPSILON12))*B(d*P,h,L.EPSILON15);M<0?p.push(new R(i,n*P,n*I)):0<M?p.push(new R(i,n*P,n*-I)):0!==I?(p.push(new R(i,n*P,n*-I)),p.push(new R(i,n*P,n*I)),++x):p.push(new R(i,n*P,n*I))}return p}(y,R.negate(b,I),0,0,1),w=C.length;if(0<w){for(var S=R.clone(R.ZERO,Z),T=Number.NEGATIVE_INFINITY,E=0;E<w;++E){g=N.multiplyByVector(p,N.multiplyByVector(d,C[E],Q),Q);var A=R.normalize(R.subtract(g,r,V),V),x=R.dot(A,i);T<x&&(T=x,S=R.clone(g,S))}var P=t.cartesianToCartographic(S,K);return T=L.clamp(T,0,1),_=R.magnitude(R.subtract(S,r,V))*Math.sqrt(1-T*T),_=o?-_:_,P.height=_,t.cartographicToCartesian(P,new R)}};var d=new R;return h.lineSegmentPlane=function(e,t,r,i){if(!D(e))throw new O("endPoint0 is required.");if(!D(t))throw new O("endPoint1 is required.");if(!D(r))throw new O("plane is required.");D(i)||(i=new R);var n=R.subtract(t,e,d),o=r.normal,a=R.dot(o,n);if(!(Math.abs(a)<L.EPSILON6)){var s=R.dot(o,e),l=-(r.distance+s)/a;if(!(l<0||1<l))return R.multiplyByScalar(n,l,i),R.add(e,i,i),i}},h.trianglePlaneIntersection=function(e,t,r,i){if(!(D(e)&&D(t)&&D(r)&&D(i)))throw new O("p0, p1, p2, and plane are required.");var n,o,a=i.normal,s=i.distance,l=R.dot(a,e)+s<0,u=R.dot(a,t)+s<0,c=R.dot(a,r)+s<0,d=0;if(d+=l?1:0,d+=u?1:0,1!==(d+=c?1:0)&&2!==d||(n=new R,o=new R),1===d){if(l)return h.lineSegmentPlane(e,t,i,n),h.lineSegmentPlane(e,r,i,o),{positions:[e,t,r,n,o],indices:[0,3,4,1,2,4,1,4,3]};if(u)return h.lineSegmentPlane(t,r,i,n),h.lineSegmentPlane(t,e,i,o),{positions:[e,t,r,n,o],indices:[1,3,4,2,0,4,2,4,3]};if(c)return h.lineSegmentPlane(r,e,i,n),h.lineSegmentPlane(r,t,i,o),{positions:[e,t,r,n,o],indices:[2,3,4,0,1,4,0,4,3]}}else if(2===d){if(!l)return h.lineSegmentPlane(t,e,i,n),h.lineSegmentPlane(r,e,i,o),{positions:[e,t,r,n,o],indices:[1,2,4,1,4,3,0,3,4]};if(!u)return h.lineSegmentPlane(r,t,i,n),h.lineSegmentPlane(e,t,i,o),{positions:[e,t,r,n,o],indices:[2,0,4,2,4,3,1,3,4]};if(!c)return h.lineSegmentPlane(e,r,i,n),h.lineSegmentPlane(t,r,i,o),{positions:[e,t,r,n,o],indices:[0,1,4,0,4,3,2,3,4]}}},h}),define("Core/Plane",["./Cartesian3","./Check","./defined","./DeveloperError","./freezeObject","./Math","./Matrix4"],function(o,a,s,n,e,l,i){"use strict";function u(e,t){if(a.typeOf.object("normal",e),!l.equalsEpsilon(o.magnitude(e),1,l.EPSILON6))throw new n("normal must be normalized.");a.typeOf.number("distance",t),this.normal=o.clone(e),this.distance=t}u.fromPointNormal=function(e,t,r){if(a.typeOf.object("point",e),a.typeOf.object("normal",t),!l.equalsEpsilon(o.magnitude(t),1,l.EPSILON6))throw new n("normal must be normalized.");var i=-o.dot(t,e);return s(r)?(o.clone(t,r.normal),r.distance=i,r):new u(t,i)};var c=new o;u.fromCartesian4=function(e,t){a.typeOf.object("coefficients",e);var r=o.fromCartesian4(e,c),i=e.w;if(!l.equalsEpsilon(o.magnitude(r),1,l.EPSILON6))throw new n("normal must be normalized.");return s(t)?(o.clone(r,t.normal),t.distance=i,t):new u(r,i)},u.getPointDistance=function(e,t){return a.typeOf.object("plane",e),a.typeOf.object("point",t),o.dot(e.normal,t)+e.distance};var d=new o;u.projectPointOntoPlane=function(e,t,r){a.typeOf.object("plane",e),a.typeOf.object("point",t),s(r)||(r=new o);var i=u.getPointDistance(e,t),n=o.multiplyByScalar(e.normal,i,d);return o.subtract(t,n,r)};var h=new o;return u.transform=function(e,t,r){return a.typeOf.object("plane",e),a.typeOf.object("transform",t),i.multiplyByPointAsVector(t,e.normal,c),o.normalize(c,c),o.multiplyByScalar(e.normal,-e.distance,h),i.multiplyByPoint(t,h,h),u.fromPointNormal(h,c,r)},u.clone=function(e,t){return a.typeOf.object("plane",e),s(t)?(o.clone(e.normal,t.normal),t.distance=e.distance,t):new u(e.normal,e.distance)},u.equals=function(e,t){return a.typeOf.object("left",e),a.typeOf.object("right",t),e.distance===t.distance&&o.equals(e.normal,t.normal)},u.ORIGIN_XY_PLANE=e(new u(o.UNIT_Z,0)),u.ORIGIN_YZ_PLANE=e(new u(o.UNIT_X,0)),u.ORIGIN_ZX_PLANE=e(new u(o.UNIT_Y,0)),u}),define("Core/EarthOrientationParametersSample",[],function(){"use strict";return function(e,t,r,i,n){this.xPoleWander=e,this.yPoleWander=t,this.xPoleOffset=r,this.yPoleOffset=i,this.ut1MinusUtc=n}}),define("ThirdParty/sprintf",[],function(){return function(){var y=arguments,b=0,e=y[b++],C=function(e,t,r,i){r||(r=" ");var n=e.length>=t?"":Array(1+t-e.length>>>0).join(r);return i?e+n:n+e},w=function(e,t,r,i,n,o){var a=i-e.length;return 0<a&&(e=r||!n?C(e,i,o,r):e.slice(0,t.length)+C("",a,"0",!0)+e.slice(t.length)),e},S=function(e,t,r,i,n,o,a){var s=e>>>0;return e=(r=r&&s&&{2:"0b",8:"0",16:"0x"}[t]||"")+C(s.toString(t),o||0,"0",!1),w(e,r,i,n,a)},T=function(e,t,r,i,n,o){return null!=i&&(e=e.slice(0,i)),w(e,"",t,r,n,o)};return e.replace(/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g,function(e,t,r,i,n,o,a){var s,l,u,c,d;if("%%"==e)return"%";for(var h=!1,p="",f=!1,m=!1,g=" ",_=r.length,v=0;r&&v<_;v++)switch(r.charAt(v)){case" ":p=" ";break;case"+":p="+";break;case"-":h=!0;break;case"'":g=r.charAt(v+1);break;case"0":f=!0;break;case"#":m=!0}if((i=i?"*"==i?+y[b++]:"*"==i.charAt(0)?+y[i.slice(1,-1)]:+i:0)<0&&(i=-i,h=!0),!isFinite(i))throw new Error("sprintf: (minimum-)width must be finite");switch(o=o?"*"==o?+y[b++]:"*"==o.charAt(0)?+y[o.slice(1,-1)]:+o:-1<"fFeE".indexOf(a)?6:"d"==a?0:void 0,d=t?y[t.slice(0,-1)]:y[b++],a){case"s":return T(String(d),h,i,o,f,g);case"c":return T(String.fromCharCode(+d),h,i,o,f);case"b":return S(d,2,m,h,i,o,f);case"o":return S(d,8,m,h,i,o,f);case"x":return S(d,16,m,h,i,o,f);case"X":return S(d,16,m,h,i,o,f).toUpperCase();case"u":return S(d,10,m,h,i,o,f);case"i":case"d":return s=+d||0,d=(l=(s=Math.round(s-s%1))<0?"-":p)+C(String(Math.abs(s)),o,"0",!1),w(d,l,h,i,f);case"e":case"E":case"f":case"F":case"g":case"G":return l=(s=+d)<0?"-":p,u=["toExponential","toFixed","toPrecision"]["efg".indexOf(a.toLowerCase())],c=["toString","toUpperCase"]["eEfFgG".indexOf(a)%2],d=l+Math.abs(s)[u](o),w(d,l,h,i,f)[c]();default:return e}})}}),define("Core/GregorianDate",[],function(){"use strict";return function(e,t,r,i,n,o,a,s){this.year=e,this.month=t,this.day=r,this.hour=i,this.minute=n,this.second=o,this.millisecond=a,this.isLeapSecond=s}}),define("Core/isLeapYear",["./DeveloperError"],function(t){"use strict";return function(e){if(null===e||isNaN(e))throw new t("year is required and must be a number.");return e%4==0&&e%100!=0||e%400==0}}),define("Core/LeapSecond",[],function(){"use strict";return function(e,t){this.julianDate=e,this.offset=t}}),define("Core/TimeConstants",["./freezeObject"],function(e){"use strict";return e({SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:2400000.5})}),define("Core/TimeStandard",["./freezeObject"],function(e){"use strict";return e({UTC:0,TAI:1})}),define("Core/JulianDate",["../ThirdParty/sprintf","./binarySearch","./defaultValue","./defined","./DeveloperError","./GregorianDate","./isLeapYear","./LeapSecond","./TimeConstants","./TimeStandard"],function(n,o,a,T,E,v,A,e,y,x){"use strict";var s=new v,P=[31,28,31,30,31,30,31,31,30,31,30,31];function l(e,t){return z.compare(e.julianDate,t.julianDate)}var u=new e;function D(e){u.julianDate=e;var t=z.leapSeconds,r=o(t,u,l);r<0&&(r=~r),r>=t.length&&(r=t.length-1);var i=t[r].offset;0<r&&(i<z.secondsDifference(t[r].julianDate,e)&&(i=t[--r].offset));z.addSeconds(e,i,e)}function b(e,t){u.julianDate=e;var r=z.leapSeconds,i=o(r,u,l);if(i<0&&(i=~i),0===i)return z.addSeconds(e,-r[0].offset,t);if(i>=r.length)return z.addSeconds(e,-r[i-1].offset,t);var n=z.secondsDifference(r[i].julianDate,e);return 0===n?z.addSeconds(e,-r[i].offset,t):n<=1?void 0:z.addSeconds(e,-r[--i].offset,t)}function O(e,t,r){var i=t/y.SECONDS_PER_DAY|0;return e+=i,(t-=y.SECONDS_PER_DAY*i)<0&&(e--,t+=y.SECONDS_PER_DAY),r.dayNumber=e,r.secondsOfDay=t,r}function I(e,t,r,i,n,o,a){var s=(t-14)/12|0,l=e+4800+s,u=(1461*l/4|0)+(367*(t-2-12*s)/12|0)-(3*((l+100)/100|0)/4|0)+r-32075;(i-=12)<0&&(i+=24);var c=o+(i*y.SECONDS_PER_HOUR+n*y.SECONDS_PER_MINUTE+a*y.SECONDS_PER_MILLISECOND);return 43200<=c&&(u-=1),[u,c]}var M=/^(\d{4})$/,R=/^(\d{4})-(\d{2})$/,L=/^(\d{4})-?(\d{3})$/,N=/^(\d{4})-?W(\d{2})-?(\d{1})?$/,k=/^(\d{4})-?(\d{2})-?(\d{2})$/,t=/([Z+\-])?(\d{2})?:?(\d{2})?$/,F=/^(\d{2})(\.\d+)?/.source+t.source,B=/^(\d{2}):?(\d{2})(\.\d+)?/.source+t.source,U=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+t.source,V="Invalid ISO 8601 date.";function z(e,t,r){this.dayNumber=void 0,this.secondsOfDay=void 0,e=a(e,0),t=a(t,0),r=a(r,x.UTC);var i=0|e;O(i,t+=(e-i)*y.SECONDS_PER_DAY,this),r===x.UTC&&D(this)}z.fromGregorianDate=function(e,t){if(!(e instanceof v))throw new E("date must be a valid GregorianDate.");var r=I(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond);return T(t)?(O(r[0],r[1],t),D(t),t):new z(r[0],r[1],x.UTC)},z.fromDate=function(e,t){if(!(e instanceof Date)||isNaN(e.getTime()))throw new E("date must be a valid JavaScript Date.");var r=I(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return T(t)?(O(r[0],r[1],t),D(t),t):new z(r[0],r[1],x.UTC)},z.fromIso8601=function(e,t){if("string"!=typeof e)throw new E(V);var r,i,n,o,a,s=(e=e.replace(",",".")).split("T"),l=1,u=1,c=0,d=0,h=0,p=0,f=s[0],m=s[1];if(!T(f))throw new E(V);if(null!==(s=f.match(k))){if(0<(o=f.split("-").length-1)&&2!==o)throw new E(V);r=+s[1],l=+s[2],u=+s[3]}else if(null!==(s=f.match(R)))r=+s[1],l=+s[2];else if(null!==(s=f.match(M)))r=+s[1];else{var g;if(null!==(s=f.match(L))){if(r=+s[1],g=+s[2],n=A(r),g<1||n&&366<g||!n&&365<g)throw new E(V)}else{if(null===(s=f.match(N)))throw new E(V);r=+s[1];var _=+s[2],v=+s[3]||0;if(0<(o=f.split("-").length-1)&&(!T(s[3])&&1!==o||T(s[3])&&2!==o))throw new E(V);g=7*_+v-new Date(Date.UTC(r,0,4)).getUTCDay()-3}(i=new Date(Date.UTC(r,0,1))).setUTCDate(g),l=i.getUTCMonth()+1,u=i.getUTCDate()}if(n=A(r),l<1||12<l||u<1||(2!==l||!n)&&P[l-1]<u||n&&2===l&&29<u)throw new E(V);if(T(m)){if(null!==(s=m.match(U))){if(0<(o=m.split(":").length-1)&&2!==o&&3!==o)throw new E(V);c=+s[1],d=+s[2],h=+s[3],p=1e3*+(s[4]||0),a=5}else if(null!==(s=m.match(B))){if(2<(o=m.split(":").length-1))throw new E(V);c=+s[1],d=+s[2],h=60*+(s[3]||0),a=4}else{if(null===(s=m.match(F)))throw new E(V);c=+s[1],d=60*+(s[2]||0),a=3}if(60<=d||61<=h||24<c||24===c&&(0<d||0<h||0<p))throw new E(V);var y=s[a],b=+s[a+1],C=+(s[a+2]||0);switch(y){case"+":c-=b,d-=C;break;case"-":c+=b,d+=C;break;case"Z":break;default:d+=new Date(Date.UTC(r,l-1,u,c,d)).getTimezoneOffset()}}var w=60===h;for(w&&h--;60<=d;)d-=60,c++;for(;24<=c;)c-=24,u++;for(i=n&&2===l?29:P[l-1];i<u;)u-=i,12<++l&&(l-=12,r++),i=n&&2===l?29:P[l-1];for(;d<0;)d+=60,c--;for(;c<0;)c+=24,u--;for(;u<1;)--l<1&&(l+=12,r--),u+=i=n&&2===l?29:P[l-1];var S=I(r,l,u,c,d,h,p);return T(t)?(O(S[0],S[1],t),D(t)):t=new z(S[0],S[1],x.UTC),w&&z.addSeconds(t,1,t),t},z.now=function(e){return z.fromDate(new Date,e)};var C=new z(0,0,x.TAI);return z.toGregorianDate=function(e,t){if(!T(e))throw new E("julianDate is required.");var r=!1,i=b(e,C);T(i)||(z.addSeconds(e,-1,C),i=b(C,C),r=!0);var n=i.dayNumber,o=i.secondsOfDay;43200<=o&&(n+=1);var a=n+68569|0,s=4*a/146097|0,l=4e3*((a=a-((146097*s+3)/4|0)|0)+1)/1461001|0,u=80*(a=a-(1461*l/4|0)+31|0)/2447|0,c=a-(2447*u/80|0)|0,d=u+2-12*(a=u/11|0)|0,h=100*(s-49)+l+a|0,p=o/y.SECONDS_PER_HOUR|0,f=o-p*y.SECONDS_PER_HOUR,m=f/y.SECONDS_PER_MINUTE|0,g=0|(f-=m*y.SECONDS_PER_MINUTE),_=(f-g)/y.SECONDS_PER_MILLISECOND;return 23<(p+=12)&&(p-=24),r&&(g+=1),T(t)?(t.year=h,t.month=d,t.day=c,t.hour=p,t.minute=m,t.second=g,t.millisecond=_,t.isLeapSecond=r,t):new v(h,d,c,p,m,g,_,r)},z.toDate=function(e){if(!T(e))throw new E("julianDate is required.");var t=z.toGregorianDate(e,s),r=t.second;return t.isLeapSecond&&(r-=1),new Date(Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,r,t.millisecond))},z.toIso8601=function(e,t){if(!T(e))throw new E("julianDate is required.");var r,i=z.toGregorianDate(e,s);return T(t)||0===i.millisecond?T(t)&&0!==t?(r=(.01*i.millisecond).toFixed(t).replace(".","").slice(0,t),n("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",i.year,i.month,i.day,i.hour,i.minute,i.second,r)):n("%04d-%02d-%02dT%02d:%02d:%02dZ",i.year,i.month,i.day,i.hour,i.minute,i.second):(r=(.01*i.millisecond).toString().replace(".",""),n("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",i.year,i.month,i.day,i.hour,i.minute,i.second,r))},z.clone=function(e,t){if(T(e))return T(t)?(t.dayNumber=e.dayNumber,t.secondsOfDay=e.secondsOfDay,t):new z(e.dayNumber,e.secondsOfDay,x.TAI)},z.compare=function(e,t){if(!T(e))throw new E("left is required.");if(!T(t))throw new E("right is required.");var r=e.dayNumber-t.dayNumber;return 0!==r?r:e.secondsOfDay-t.secondsOfDay},z.equals=function(e,t){return e===t||T(e)&&T(t)&&e.dayNumber===t.dayNumber&&e.secondsOfDay===t.secondsOfDay},z.equalsEpsilon=function(e,t,r){if(!T(r))throw new E("epsilon is required.");return e===t||T(e)&&T(t)&&Math.abs(z.secondsDifference(e,t))<=r},z.totalDays=function(e){if(!T(e))throw new E("julianDate is required.");return e.dayNumber+e.secondsOfDay/y.SECONDS_PER_DAY},z.secondsDifference=function(e,t){if(!T(e))throw new E("left is required.");if(!T(t))throw new E("right is required.");return(e.dayNumber-t.dayNumber)*y.SECONDS_PER_DAY+(e.secondsOfDay-t.secondsOfDay)},z.daysDifference=function(e,t){if(!T(e))throw new E("left is required.");if(!T(t))throw new E("right is required.");return e.dayNumber-t.dayNumber+(e.secondsOfDay-t.secondsOfDay)/y.SECONDS_PER_DAY},z.computeTaiMinusUtc=function(e){u.julianDate=e;var t=z.leapSeconds,r=o(t,u,l);return r<0&&(r=~r,--r<0&&(r=0)),t[r].offset},z.addSeconds=function(e,t,r){if(!T(e))throw new E("julianDate is required.");if(!T(t))throw new E("seconds is required.");if(!T(r))throw new E("result is required.");return O(e.dayNumber,e.secondsOfDay+t,r)},z.addMinutes=function(e,t,r){if(!T(e))throw new E("julianDate is required.");if(!T(t))throw new E("minutes is required.");if(!T(r))throw new E("result is required.");var i=e.secondsOfDay+t*y.SECONDS_PER_MINUTE;return O(e.dayNumber,i,r)},z.addHours=function(e,t,r){if(!T(e))throw new E("julianDate is required.");if(!T(t))throw new E("hours is required.");if(!T(r))throw new E("result is required.");var i=e.secondsOfDay+t*y.SECONDS_PER_HOUR;return O(e.dayNumber,i,r)},z.addDays=function(e,t,r){if(!T(e))throw new E("julianDate is required.");if(!T(t))throw new E("days is required.");if(!T(r))throw new E("result is required.");return O(e.dayNumber+t,e.secondsOfDay,r)},z.lessThan=function(e,t){return z.compare(e,t)<0},z.lessThanOrEquals=function(e,t){return z.compare(e,t)<=0},z.greaterThan=function(e,t){return 0<z.compare(e,t)},z.greaterThanOrEquals=function(e,t){return 0<=z.compare(e,t)},z.prototype.clone=function(e){return z.clone(this,e)},z.prototype.equals=function(e){return z.equals(this,e)},z.prototype.equalsEpsilon=function(e,t){return z.equalsEpsilon(this,e,t)},z.prototype.toString=function(){return z.toIso8601(this)},z.leapSeconds=[new e(new z(2441317,43210,x.TAI),10),new e(new z(2441499,43211,x.TAI),11),new e(new z(2441683,43212,x.TAI),12),new e(new z(2442048,43213,x.TAI),13),new e(new z(2442413,43214,x.TAI),14),new e(new z(2442778,43215,x.TAI),15),new e(new z(2443144,43216,x.TAI),16),new e(new z(2443509,43217,x.TAI),17),new e(new z(2443874,43218,x.TAI),18),new e(new z(2444239,43219,x.TAI),19),new e(new z(2444786,43220,x.TAI),20),new e(new z(2445151,43221,x.TAI),21),new e(new z(2445516,43222,x.TAI),22),new e(new z(2446247,43223,x.TAI),23),new e(new z(2447161,43224,x.TAI),24),new e(new z(2447892,43225,x.TAI),25),new e(new z(2448257,43226,x.TAI),26),new e(new z(2448804,43227,x.TAI),27),new e(new z(2449169,43228,x.TAI),28),new e(new z(2449534,43229,x.TAI),29),new e(new z(2450083,43230,x.TAI),30),new e(new z(2450630,43231,x.TAI),31),new e(new z(2451179,43232,x.TAI),32),new e(new z(2453736,43233,x.TAI),33),new e(new z(2454832,43234,x.TAI),34),new e(new z(2456109,43235,x.TAI),35),new e(new z(2457204,43236,x.TAI),36),new e(new z(2457754,43237,x.TAI),37)],z}),define("Core/EarthOrientationParameters",["../ThirdParty/when","./binarySearch","./defaultValue","./defined","./EarthOrientationParametersSample","./freezeObject","./JulianDate","./LeapSecond","./Resource","./RuntimeError","./TimeConstants","./TimeStandard"],function(i,w,n,S,h,e,T,E,o,p,A,x){"use strict";function t(e){if(e=n(e,n.EMPTY_OBJECT),this._dates=void 0,this._samples=void 0,this._dateColumn=-1,this._xPoleWanderRadiansColumn=-1,this._yPoleWanderRadiansColumn=-1,this._ut1MinusUtcSecondsColumn=-1,this._xCelestialPoleOffsetRadiansColumn=-1,this._yCelestialPoleOffsetRadiansColumn=-1,this._taiMinusUtcSecondsColumn=-1,this._columnCount=0,this._lastIndex=-1,this._downloadPromise=void 0,this._dataError=void 0,this._addNewLeapSeconds=n(e.addNewLeapSeconds,!0),S(e.data))a(this,e.data);else if(S(e.url)){var t=o.createIfNeeded(e.url),r=this;this._downloadPromise=i(t.fetchJson(),function(e){a(r,e)},function(){r._dataError="An error occurred while retrieving the EOP data from the URL "+t.url+"."})}else a(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}function P(e,t){return T.compare(e.julianDate,t)}function a(e,t){if(S(t.columnNames))if(S(t.samples)){var r=t.columnNames.indexOf("modifiedJulianDateUtc"),i=t.columnNames.indexOf("xPoleWanderRadians"),n=t.columnNames.indexOf("yPoleWanderRadians"),o=t.columnNames.indexOf("ut1MinusUtcSeconds"),a=t.columnNames.indexOf("xCelestialPoleOffsetRadians"),s=t.columnNames.indexOf("yCelestialPoleOffsetRadians"),l=t.columnNames.indexOf("taiMinusUtcSeconds");if(r<0||i<0||n<0||o<0||a<0||s<0||l<0)e._dataError="Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns";else{var u,c=e._samples=t.samples,d=e._dates=[];e._dateColumn=r,e._xPoleWanderRadiansColumn=i,e._yPoleWanderRadiansColumn=n,e._ut1MinusUtcSecondsColumn=o,e._xCelestialPoleOffsetRadiansColumn=a,e._yCelestialPoleOffsetRadiansColumn=s,e._taiMinusUtcSecondsColumn=l,e._columnCount=t.columnNames.length,e._lastIndex=void 0;for(var h=e._addNewLeapSeconds,p=0,f=c.length;p<f;p+=e._columnCount){var m=c[p+r],g=c[p+l],_=m+A.MODIFIED_JULIAN_DATE_DIFFERENCE,v=new T(_,g,x.TAI);if(d.push(v),h){if(g!==u&&S(u)){var y=T.leapSeconds,b=w(y,v,P);if(b<0){var C=new E(v,g);y.splice(~b,0,C)}}u=g}}}}else e._dataError="Error in loaded EOP data: The samples property is required.";else e._dataError="Error in loaded EOP data: The columnNames property is required."}function v(e,t,r,i,n){var o=r*i;n.xPoleWander=t[o+e._xPoleWanderRadiansColumn],n.yPoleWander=t[o+e._yPoleWanderRadiansColumn],n.xPoleOffset=t[o+e._xCelestialPoleOffsetRadiansColumn],n.yPoleOffset=t[o+e._yCelestialPoleOffsetRadiansColumn],n.ut1MinusUtc=t[o+e._ut1MinusUtcSecondsColumn]}function y(e,t,r){return t+e*(r-t)}function f(e,t,r,i,n,o,a){var s=e._columnCount;if(o>t.length-1)return a.xPoleWander=0,a.yPoleWander=0,a.xPoleOffset=0,a.yPoleOffset=0,a.ut1MinusUtc=0,a;var l=t[n],u=t[o];if(l.equals(u)||i.equals(l))return v(e,r,n,s,a),a;if(i.equals(u))return v(e,r,o,s,a),a;var c=T.secondsDifference(i,l)/T.secondsDifference(u,l),d=n*s,h=o*s,p=r[d+e._ut1MinusUtcSecondsColumn],f=r[h+e._ut1MinusUtcSecondsColumn],m=f-p;if(.5<m||m<-.5){var g=r[d+e._taiMinusUtcSecondsColumn],_=r[h+e._taiMinusUtcSecondsColumn];g!==_&&(u.equals(i)?p=f:f-=_-g)}return a.xPoleWander=y(c,r[d+e._xPoleWanderRadiansColumn],r[h+e._xPoleWanderRadiansColumn]),a.yPoleWander=y(c,r[d+e._yPoleWanderRadiansColumn],r[h+e._yPoleWanderRadiansColumn]),a.xPoleOffset=y(c,r[d+e._xCelestialPoleOffsetRadiansColumn],r[h+e._xCelestialPoleOffsetRadiansColumn]),a.yPoleOffset=y(c,r[d+e._yCelestialPoleOffsetRadiansColumn],r[h+e._yCelestialPoleOffsetRadiansColumn]),a.ut1MinusUtc=y(c,p,f),a}return t.NONE=e({getPromiseToLoad:function(){return i()},compute:function(e,t){return S(t)?(t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0):t=new h(0,0,0,0,0),t}}),t.prototype.getPromiseToLoad=function(){return i(this._downloadPromise)},t.prototype.compute=function(e,t){if(S(this._samples)){if(S(t)||(t=new h(0,0,0,0,0)),0===this._samples.length)return t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0,t;var r=this._dates,i=this._lastIndex,n=0,o=0;if(S(i)){var a=r[i],s=r[i+1],l=T.lessThanOrEquals(a,e),u=!S(s),c=u||T.greaterThanOrEquals(s,e);if(l&&c)return n=i,!u&&s.equals(e)&&++n,o=n+1,f(this,r,this._samples,e,n,o,t),t}var d=w(r,e,T.compare,this._dateColumn);return 0<=d?(d<r.length-1&&r[d+1].equals(e)&&++d,o=n=d):(n=(o=~d)-1)<0&&(n=0),this._lastIndex=n,f(this,r,this._samples,e,n,o,t),t}if(S(this._dataError))throw new p(this._dataError)},t}),define("Core/Iau2006XysSample",[],function(){"use strict";return function(e,t,r){this.x=e,this.y=t,this.s=r}}),define("Core/Iau2006XysData",["../ThirdParty/when","./buildModuleUrl","./defaultValue","./defined","./Iau2006XysSample","./JulianDate","./Resource","./TimeStandard"],function(h,r,s,v,y,l,u,c){"use strict";function e(e){e=s(e,s.EMPTY_OBJECT),this._xysFileUrlTemplate=u.createIfNeeded(e.xysFileUrlTemplate),this._interpolationOrder=s(e.interpolationOrder,9),this._sampleZeroJulianEphemerisDate=s(e.sampleZeroJulianEphemerisDate,2442396.5),this._sampleZeroDateTT=new l(this._sampleZeroJulianEphemerisDate,0,c.TAI),this._stepSizeDays=s(e.stepSizeDays,1),this._samplesPerXysFile=s(e.samplesPerXysFile,1e3),this._totalSamples=s(e.totalSamples,27426),this._samples=new Array(3*this._totalSamples),this._chunkDownloadsInProgress=[];for(var t=this._interpolationOrder,r=this._denominators=new Array(t+1),i=this._xTable=new Array(t+1),n=Math.pow(this._stepSizeDays,t),o=0;o<=t;++o){r[o]=n,i[o]=o*this._stepSizeDays;for(var a=0;a<=t;++a)a!==o&&(r[o]*=o-a);r[o]=1/r[o]}this._work=new Array(t+1),this._coef=new Array(t+1)}var n=new l(0,0,c.TAI);function b(e,t,r){var i=n;return i.dayNumber=t,i.secondsOfDay=r,l.daysDifference(i,e._sampleZeroDateTT)}function C(a,s){if(a._chunkDownloadsInProgress[s])return a._chunkDownloadsInProgress[s];var e,l=h.defer();a._chunkDownloadsInProgress[s]=l;var t=a._xysFileUrlTemplate;return e=v(t)?t.getDerivedResource({templateValues:{0:s}}):new u({url:r("Assets/IAU2006_XYS/IAU2006_XYS_"+s+".json")}),h(e.fetchJson(),function(e){a._chunkDownloadsInProgress[s]=!1;for(var t=a._samples,r=e.samples,i=s*a._samplesPerXysFile*3,n=0,o=r.length;n<o;++n)t[i+n]=r[n];l.resolve()}),l.promise}return e.prototype.preload=function(e,t,r,i){var n=b(this,e,t),o=b(this,r,i),a=n/this._stepSizeDays-this._interpolationOrder/2|0;a<0&&(a=0);var s=o/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;s>=this._totalSamples&&(s=this._totalSamples-1);for(var l=a/this._samplesPerXysFile|0,u=s/this._samplesPerXysFile|0,c=[],d=l;d<=u;++d)c.push(C(this,d));return h.all(c)},e.prototype.computeXysRadians=function(e,t,r){var i=b(this,e,t);if(!(i<0)){var n=i/this._stepSizeDays|0;if(!(n>=this._totalSamples)){var o=this._interpolationOrder,a=n-(o/2|0);a<0&&(a=0);var s=a+o;s>=this._totalSamples&&(a=(s=this._totalSamples-1)-o)<0&&(a=0);var l=!1,u=this._samples;if(v(u[3*a])||(C(this,a/this._samplesPerXysFile|0),l=!0),v(u[3*s])||(C(this,s/this._samplesPerXysFile|0),l=!0),!l){v(r)?(r.x=0,r.y=0,r.s=0):r=new y(0,0,0);var c,d,h=i-a*this._stepSizeDays,p=this._work,f=this._denominators,m=this._coef,g=this._xTable;for(c=0;c<=o;++c)p[c]=h-g[c];for(c=0;c<=o;++c){for(m[c]=1,d=0;d<=o;++d)d!==c&&(m[c]*=p[d]);m[c]*=f[c];var _=3*(a+c);r.x+=m[c]*u[_++],r.y+=m[c]*u[_++],r.s+=m[c]*u[_]}return r}}}},e}),define("Core/Quaternion",["./Cartesian3","./Check","./defaultValue","./defined","./FeatureDetection","./freezeObject","./Math","./Matrix3"],function(u,m,n,g,e,t,s,_){"use strict";function v(e,t,r,i){this.x=n(e,0),this.y=n(t,0),this.z=n(r,0),this.w=n(i,0)}var c=new u;v.fromAxisAngle=function(e,t,r){m.typeOf.object("axis",e),m.typeOf.number("angle",t);var i=t/2,n=Math.sin(i),o=(c=u.normalize(e,c)).x*n,a=c.y*n,s=c.z*n,l=Math.cos(i);return g(r)?(r.x=o,r.y=a,r.z=s,r.w=l,r):new v(o,a,s,l)};var y=[1,2,0],b=new Array(3);v.fromRotationMatrix=function(e,t){var r,i,n,o,a;m.typeOf.object("matrix",e);var s=e[_.COLUMN0ROW0],l=e[_.COLUMN1ROW1],u=e[_.COLUMN2ROW2],c=s+l+u;if(0<c)a=.5*(r=Math.sqrt(c+1)),r=.5/r,i=(e[_.COLUMN1ROW2]-e[_.COLUMN2ROW1])*r,n=(e[_.COLUMN2ROW0]-e[_.COLUMN0ROW2])*r,o=(e[_.COLUMN0ROW1]-e[_.COLUMN1ROW0])*r;else{var d=0;s<l&&(d=1),s<u&&l<u&&(d=2);var h=y[d],p=y[h];r=Math.sqrt(e[_.getElementIndex(d,d)]-e[_.getElementIndex(h,h)]-e[_.getElementIndex(p,p)]+1);var f=b;f[d]=.5*r,r=.5/r,a=(e[_.getElementIndex(p,h)]-e[_.getElementIndex(h,p)])*r,f[h]=(e[_.getElementIndex(h,d)]+e[_.getElementIndex(d,h)])*r,f[p]=(e[_.getElementIndex(p,d)]+e[_.getElementIndex(d,p)])*r,i=-f[0],n=-f[1],o=-f[2]}return g(t)?(t.x=i,t.y=n,t.z=o,t.w=a,t):new v(i,n,o,a)};var r=new v,i=new v,o=new v,a=new v;v.fromHeadingPitchRoll=function(e,t){return m.typeOf.object("headingPitchRoll",e),a=v.fromAxisAngle(u.UNIT_X,e.roll,r),o=v.fromAxisAngle(u.UNIT_Y,-e.pitch,t),t=v.multiply(o,a,o),i=v.fromAxisAngle(u.UNIT_Z,-e.heading,r),v.multiply(i,t,t)};var l=new u,d=new u,h=new v,p=new v,f=new v;v.packedLength=4,v.pack=function(e,t,r){return m.typeOf.object("value",e),m.defined("array",t),r=n(r,0),t[r++]=e.x,t[r++]=e.y,t[r++]=e.z,t[r]=e.w,t},v.unpack=function(e,t,r){return m.defined("array",e),t=n(t,0),g(r)||(r=new v),r.x=e[t],r.y=e[t+1],r.z=e[t+2],r.w=e[t+3],r},v.packedInterpolationLength=3,v.convertPackedArrayForInterpolation=function(e,t,r,i){v.unpack(e,4*r,f),v.conjugate(f,f);for(var n=0,o=r-t+1;n<o;n++){var a=3*n;v.unpack(e,4*(t+n),h),v.multiply(h,f,h),h.w<0&&v.negate(h,h),v.computeAxis(h,l);var s=v.computeAngle(h);i[a]=l.x*s,i[a+1]=l.y*s,i[a+2]=l.z*s}},v.unpackInterpolationResult=function(e,t,r,i,n){g(n)||(n=new v),u.fromArray(e,0,d);var o=u.magnitude(d);return v.unpack(t,4*i,p),0===o?v.clone(v.IDENTITY,h):v.fromAxisAngle(d,o,h),v.multiply(h,p,n)},v.clone=function(e,t){if(g(e))return g(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new v(e.x,e.y,e.z,e.w)},v.conjugate=function(e,t){return m.typeOf.object("quaternion",e),m.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=e.w,t},v.magnitudeSquared=function(e){return m.typeOf.object("quaternion",e),e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},v.magnitude=function(e){return Math.sqrt(v.magnitudeSquared(e))},v.normalize=function(e,t){m.typeOf.object("result",t);var r=1/v.magnitude(e),i=e.x*r,n=e.y*r,o=e.z*r,a=e.w*r;return t.x=i,t.y=n,t.z=o,t.w=a,t},v.inverse=function(e,t){m.typeOf.object("result",t);var r=v.magnitudeSquared(e);return t=v.conjugate(e,t),v.multiplyByScalar(t,1/r,t)},v.add=function(e,t,r){return m.typeOf.object("left",e),m.typeOf.object("right",t),m.typeOf.object("result",r),r.x=e.x+t.x,r.y=e.y+t.y,r.z=e.z+t.z,r.w=e.w+t.w,r},v.subtract=function(e,t,r){return m.typeOf.object("left",e),m.typeOf.object("right",t),m.typeOf.object("result",r),r.x=e.x-t.x,r.y=e.y-t.y,r.z=e.z-t.z,r.w=e.w-t.w,r},v.negate=function(e,t){return m.typeOf.object("quaternion",e),m.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},v.dot=function(e,t){return m.typeOf.object("left",e),m.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},v.multiply=function(e,t,r){m.typeOf.object("left",e),m.typeOf.object("right",t),m.typeOf.object("result",r);var i=e.x,n=e.y,o=e.z,a=e.w,s=t.x,l=t.y,u=t.z,c=t.w,d=a*s+i*c+n*u-o*l,h=a*l-i*u+n*c+o*s,p=a*u+i*l-n*s+o*c,f=a*c-i*s-n*l-o*u;return r.x=d,r.y=h,r.z=p,r.w=f,r},v.multiplyByScalar=function(e,t,r){return m.typeOf.object("quaternion",e),m.typeOf.number("scalar",t),m.typeOf.object("result",r),r.x=e.x*t,r.y=e.y*t,r.z=e.z*t,r.w=e.w*t,r},v.divideByScalar=function(e,t,r){return m.typeOf.object("quaternion",e),m.typeOf.number("scalar",t),m.typeOf.object("result",r),r.x=e.x/t,r.y=e.y/t,r.z=e.z/t,r.w=e.w/t,r},v.computeAxis=function(e,t){m.typeOf.object("quaternion",e),m.typeOf.object("result",t);var r=e.w;if(Math.abs(r-1)<s.EPSILON6)return t.x=t.y=t.z=0,t;var i=1/Math.sqrt(1-r*r);return t.x=e.x*i,t.y=e.y*i,t.z=e.z*i,t},v.computeAngle=function(e){return m.typeOf.object("quaternion",e),Math.abs(e.w-1)<s.EPSILON6?0:2*Math.acos(e.w)};var C=new v;v.lerp=function(e,t,r,i){return m.typeOf.object("start",e),m.typeOf.object("end",t),m.typeOf.number("t",r),m.typeOf.object("result",i),C=v.multiplyByScalar(t,r,C),i=v.multiplyByScalar(e,1-r,i),v.add(C,i,i)};var w=new v,S=new v,T=new v;v.slerp=function(e,t,r,i){m.typeOf.object("start",e),m.typeOf.object("end",t),m.typeOf.number("t",r),m.typeOf.object("result",i);var n=v.dot(e,t),o=t;if(n<0&&(n=-n,o=w=v.negate(t,w)),1-n<s.EPSILON6)return v.lerp(e,o,r,i);var a=Math.acos(n);return S=v.multiplyByScalar(e,Math.sin((1-r)*a),S),T=v.multiplyByScalar(o,Math.sin(r*a),T),i=v.add(S,T,i),v.multiplyByScalar(i,1/Math.sin(a),i)},v.log=function(e,t){m.typeOf.object("quaternion",e),m.typeOf.object("result",t);var r=s.acosClamped(e.w),i=0;return 0!==r&&(i=r/Math.sin(r)),u.multiplyByScalar(e,i,t)},v.exp=function(e,t){m.typeOf.object("cartesian",e),m.typeOf.object("result",t);var r=u.magnitude(e),i=0;return 0!==r&&(i=Math.sin(r)/r),t.x=e.x*i,t.y=e.y*i,t.z=e.z*i,t.w=Math.cos(r),t};var E=new u,A=new u,x=new v,P=new v;v.computeInnerQuadrangle=function(e,t,r,i){m.typeOf.object("q0",e),m.typeOf.object("q1",t),m.typeOf.object("q2",r),m.typeOf.object("result",i);var n=v.conjugate(t,x);v.multiply(n,r,P);var o=v.log(P,E);v.multiply(n,e,P);var a=v.log(P,A);return u.add(o,a,o),u.multiplyByScalar(o,.25,o),u.negate(o,o),v.exp(o,x),v.multiply(t,x,i)},v.squad=function(e,t,r,i,n,o){m.typeOf.object("q0",e),m.typeOf.object("q1",t),m.typeOf.object("s0",r),m.typeOf.object("s1",i),m.typeOf.number("t",n),m.typeOf.object("result",o);var a=v.slerp(e,t,n,x),s=v.slerp(r,i,n,P);return v.slerp(a,s,2*n*(1-n),o)};for(var D=new v,O=1.9011074535173003,I=e.supportsTypedArrays()?new Float32Array(8):[],M=e.supportsTypedArrays()?new Float32Array(8):[],R=e.supportsTypedArrays()?new Float32Array(8):[],L=e.supportsTypedArrays()?new Float32Array(8):[],N=0;N<7;++N){var k=N+1,F=2*k+1;I[N]=1/(k*F),M[N]=k/F}return I[7]=O/136,M[7]=8*O/17,v.fastSlerp=function(e,t,r,i){m.typeOf.object("start",e),m.typeOf.object("end",t),m.typeOf.number("t",r),m.typeOf.object("result",i);var n,o=v.dot(e,t);0<=o?n=1:(n=-1,o=-o);for(var a=o-1,s=1-r,l=r*r,u=s*s,c=7;0<=c;--c)R[c]=(I[c]*l-M[c])*a,L[c]=(I[c]*u-M[c])*a;var d=n*r*(1+R[0]*(1+R[1]*(1+R[2]*(1+R[3]*(1+R[4]*(1+R[5]*(1+R[6]*(1+R[7])))))))),h=s*(1+L[0]*(1+L[1]*(1+L[2]*(1+L[3]*(1+L[4]*(1+L[5]*(1+L[6]*(1+L[7])))))))),p=v.multiplyByScalar(e,h,D);return v.multiplyByScalar(t,d,i),v.add(p,i,i)},v.fastSquad=function(e,t,r,i,n,o){m.typeOf.object("q0",e),m.typeOf.object("q1",t),m.typeOf.object("s0",r),m.typeOf.object("s1",i),m.typeOf.number("t",n),m.typeOf.object("result",o);var a=v.fastSlerp(e,t,n,x),s=v.fastSlerp(r,i,n,P);return v.fastSlerp(a,s,2*n*(1-n),o)},v.equals=function(e,t){return e===t||g(e)&&g(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},v.equalsEpsilon=function(e,t,r){return m.typeOf.number("epsilon",r),e===t||g(e)&&g(t)&&Math.abs(e.x-t.x)<=r&&Math.abs(e.y-t.y)<=r&&Math.abs(e.z-t.z)<=r&&Math.abs(e.w-t.w)<=r},v.ZERO=t(new v(0,0,0,0)),v.IDENTITY=t(new v(0,0,0,1)),v.prototype.clone=function(e){return v.clone(this,e)},v.prototype.equals=function(e){return v.equals(this,e)},v.prototype.equalsEpsilon=function(e,t){return v.equalsEpsilon(this,e,t)},v.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},v}),define("Core/Transforms",["../ThirdParty/when","./Cartesian2","./Cartesian3","./Cartesian4","./Cartographic","./Check","./defaultValue","./defined","./DeveloperError","./EarthOrientationParameters","./EarthOrientationParametersSample","./Ellipsoid","./Iau2006XysData","./Iau2006XysSample","./JulianDate","./Math","./Matrix3","./Matrix4","./Quaternion","./TimeConstants"],function(s,o,d,a,e,l,u,A,x,t,r,c,i,n,P,D,O,h,p,I){"use strict";var M={},f={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},m={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},g={},_={east:new d,north:new d,up:new d,west:new d,south:new d,down:new d},v=new d,y=new d,b=new d;M.localFrameToFixedFrameGenerator=function(a,s){if(!f.hasOwnProperty(a)||!f[a].hasOwnProperty(s))throw new x("firstAxis and secondAxis must be east, north, up, west, south or down.");var e,l=f[a][s],t=a+s;return A(g[t])?e=g[t]:(e=function(e,t,r){if(!A(e))throw new x("origin is required.");if(A(r)||(r=new h),D.equalsEpsilon(e.x,0,D.EPSILON14)&&D.equalsEpsilon(e.y,0,D.EPSILON14)){var i=D.sign(e.z);d.unpack(m[a],0,v),"east"!==a&&"west"!==a&&d.multiplyByScalar(v,i,v),d.unpack(m[s],0,y),"east"!==s&&"west"!==s&&d.multiplyByScalar(y,i,y),d.unpack(m[l],0,b),"east"!==l&&"west"!==l&&d.multiplyByScalar(b,i,b)}else{(t=u(t,c.WGS84)).geodeticSurfaceNormal(e,_.up);var n=_.up,o=_.east;o.x=-e.y,o.y=e.x,o.z=0,d.normalize(o,_.east),d.cross(n,o,_.north),d.multiplyByScalar(_.up,-1,_.down),d.multiplyByScalar(_.east,-1,_.west),d.multiplyByScalar(_.north,-1,_.south),v=_[a],y=_[s],b=_[l]}return r[0]=v.x,r[1]=v.y,r[2]=v.z,r[3]=0,r[4]=y.x,r[5]=y.y,r[6]=y.z,r[7]=0,r[8]=b.x,r[9]=b.y,r[10]=b.z,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,r},g[t]=e),e},M.eastNorthUpToFixedFrame=M.localFrameToFixedFrameGenerator("east","north"),M.northEastDownToFixedFrame=M.localFrameToFixedFrameGenerator("north","east"),M.northUpEastToFixedFrame=M.localFrameToFixedFrameGenerator("north","up"),M.northWestUpToFixedFrame=M.localFrameToFixedFrameGenerator("north","west");var C=new p,w=new d(1,1,1),S=new h;M.headingPitchRollToFixedFrame=function(e,t,r,i,n){l.typeOf.object("HeadingPitchRoll",t),i=u(i,M.eastNorthUpToFixedFrame);var o=p.fromHeadingPitchRoll(t,C),a=h.fromTranslationQuaternionRotationScale(d.ZERO,o,w,S);return n=i(e,r,n),h.multiply(n,a,n)};var T=new h,E=new O;M.headingPitchRollQuaternion=function(e,t,r,i,n){l.typeOf.object("HeadingPitchRoll",t);var o=M.headingPitchRollToFixedFrame(e,t,r,i,T),a=h.getRotation(o,E);return p.fromRotationMatrix(a,n)};var R=D.TWO_PI/86400,L=new P;M.computeTemeToPseudoFixedMatrix=function(e,t){if(!A(e))throw new x("date is required.");var r,i=(L=P.addSeconds(e,-P.computeTaiMinusUtc(e),L)).dayNumber,n=L.secondsOfDay,o=i-2451545,a=(24110.54841+(r=43200<=n?(o+.5)/I.DAYS_PER_JULIAN_CENTURY:(o-.5)/I.DAYS_PER_JULIAN_CENTURY)*(8640184.812866+r*(.093104+-62e-7*r)))*R%D.TWO_PI+(72921158553e-15+11772758384668e-32*(i-2451545.5))*((n+.5*I.SECONDS_PER_DAY)%I.SECONDS_PER_DAY),s=Math.cos(a),l=Math.sin(a);return A(t)?(t[0]=s,t[1]=-l,t[2]=0,t[3]=l,t[4]=s,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new O(s,l,0,-l,s,0,0,0,1)},M.iau2006XysData=new i,M.earthOrientationParameters=t.NONE;M.preloadIcrfFixed=function(e){var t=e.start.dayNumber,r=e.start.secondsOfDay+32.184,i=e.stop.dayNumber,n=e.stop.secondsOfDay+32.184,o=M.iau2006XysData.preload(t,r,i,n),a=M.earthOrientationParameters.getPromiseToLoad();return s.all([o,a])},M.computeIcrfToFixedMatrix=function(e,t){if(!A(e))throw new x("date is required.");A(t)||(t=new O);var r=M.computeFixedToIcrfMatrix(e,t);if(A(r))return O.transpose(r,t)};var N=new n(0,0,0),k=new r(0,0,0,0,0,0),F=new O,B=new O;M.computeFixedToIcrfMatrix=function(e,t){if(!A(e))throw new x("date is required.");A(t)||(t=new O);var r=M.earthOrientationParameters.compute(e,k);if(A(r)){var i=e.dayNumber,n=e.secondsOfDay+32.184,o=M.iau2006XysData.computeXysRadians(i,n,N);if(A(o)){var a=o.x+r.xPoleOffset,s=o.y+r.yPoleOffset,l=1/(1+Math.sqrt(1-a*a-s*s)),u=F;u[0]=1-l*a*a,u[3]=-l*a*s,u[6]=a,u[1]=-l*a*s,u[4]=1-l*s*s,u[7]=s,u[2]=-a,u[5]=-s,u[8]=1-l*(a*a+s*s);var c=O.fromRotationZ(-o.s,B),d=O.multiply(u,c,F),h=e.dayNumber-2451545,p=(e.secondsOfDay-P.computeTaiMinusUtc(e)+r.ut1MinusUtc)/I.SECONDS_PER_DAY,f=.779057273264+p+.00273781191135448*(h+p);f=f%1*D.TWO_PI;var m=O.fromRotationZ(f,B),g=O.multiply(d,m,F),_=Math.cos(r.xPoleWander),v=Math.cos(r.yPoleWander),y=Math.sin(r.xPoleWander),b=Math.sin(r.yPoleWander),C=i-2451545+n/I.SECONDS_PER_DAY,w=-47e-6*(C/=36525)*D.RADIANS_PER_DEGREE/3600,S=Math.cos(w),T=Math.sin(w),E=B;return E[0]=_*S,E[1]=_*T,E[2]=y,E[3]=-v*T+b*y*S,E[4]=v*S+b*y*T,E[5]=-b*_,E[6]=-b*T-v*y*S,E[7]=b*S-v*y*T,E[8]=v*_,O.multiply(g,E,t)}}};var U=new a;M.pointToWindowCoordinates=function(e,t,r,i){return(i=M.pointToGLWindowCoordinates(e,t,r,i)).y=2*t[5]-i.y,i},M.pointToGLWindowCoordinates=function(e,t,r,i){if(!A(e))throw new x("modelViewProjectionMatrix is required.");if(!A(t))throw new x("viewportTransformation is required.");if(!A(r))throw new x("point is required.");A(i)||(i=new o);var n=U;return h.multiplyByVector(e,a.fromElements(r.x,r.y,r.z,1,n),n),a.multiplyByScalar(n,1/n.w,n),h.multiplyByVector(t,n,n),o.fromCartesian4(n,i)};var V=new d,z=new d,q=new d;M.rotationMatrixFromPositionVelocity=function(e,t,r,i){if(!A(e))throw new x("position is required.");if(!A(t))throw new x("velocity is required.");var n=u(r,c.WGS84).geodeticSurfaceNormal(e,V),o=d.cross(t,n,z);d.equalsEpsilon(o,d.ZERO,D.EPSILON6)&&(o=d.clone(d.UNIT_X,o));var a=d.cross(o,t,q);return d.cross(t,a,o),d.negate(o,o),A(i)||(i=new O),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=o.x,i[4]=o.y,i[5]=o.z,i[6]=a.x,i[7]=a.y,i[8]=a.z,i};var G=new h(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),W=new e,H=new d,j=new d,Y=new O,X=new h,Q=new h;return M.basisTo2D=function(e,t,r){if(!A(e))throw new x("projection is required.");if(!A(t))throw new x("matrix is required.");if(!A(r))throw new x("result is required.");var i=h.getTranslation(t,j),n=e.ellipsoid,o=n.cartesianToCartographic(i,W),a=e.project(o,H);d.fromElements(a.z,a.x,a.y,a);var s=M.eastNorthUpToFixedFrame(i,n,X),l=h.inverseTransformation(s,Q),u=h.getRotation(t,Y),c=h.multiplyByMatrix3(l,u,r);return h.multiply(G,c,r),h.setTranslation(r,a,r),r},M.wgs84To2DModelMatrix=function(e,t,r){if(!A(e))throw new x("projection is required.");if(!A(t))throw new x("center is required.");if(!A(r))throw new x("result is required.");var i=e.ellipsoid,n=M.eastNorthUpToFixedFrame(t,i,X),o=h.inverseTransformation(n,Q),a=i.cartesianToCartographic(t,W),s=e.project(a,H);d.fromElements(s.z,s.x,s.y,s);var l=h.fromTranslation(s,X);return h.multiply(G,o,r),h.multiply(l,r,r),r},M}),define("Core/EllipsoidTangentPlane",["./AxisAlignedBoundingBox","./Cartesian2","./Cartesian3","./Cartesian4","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./IntersectionTests","./Matrix4","./Plane","./Ray","./Transforms"],function(r,s,d,e,n,h,t,p,o,l,a,u,i,c){"use strict";var f=new e;function m(e,t){if(!h(e))throw new p("origin is required.");if(e=(t=n(t,o.WGS84)).scaleToGeodeticSurface(e),!h(e))throw new p("origin must not be at the center of the ellipsoid.");var r=c.eastNorthUpToFixedFrame(e,t);this._ellipsoid=t,this._origin=e,this._xAxis=d.fromCartesian4(a.getColumn(r,0,f)),this._yAxis=d.fromCartesian4(a.getColumn(r,1,f));var i=d.fromCartesian4(a.getColumn(r,2,f));this._plane=u.fromPointNormal(e,i)}t(m.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},origin:{get:function(){return this._origin}},plane:{get:function(){return this._plane}},xAxis:{get:function(){return this._xAxis}},yAxis:{get:function(){return this._yAxis}},zAxis:{get:function(){return this._plane.normal}}});var g=new r;m.fromPoints=function(e,t){if(!h(e))throw new p("cartesians is required.");return new m(r.fromPoints(e,g).center,t)};var _=new i,v=new d;m.prototype.projectPointOntoPlane=function(e,t){if(!h(e))throw new p("cartesian is required.");var r=_;r.origin=e,d.normalize(e,r.direction);var i=l.rayPlane(r,this._plane,v);if(h(i)||(d.negate(r.direction,r.direction),i=l.rayPlane(r,this._plane,v)),h(i)){var n=d.subtract(i,this._origin,i),o=d.dot(this._xAxis,n),a=d.dot(this._yAxis,n);return h(t)?(t.x=o,t.y=a,t):new s(o,a)}},m.prototype.projectPointsOntoPlane=function(e,t){if(!h(e))throw new p("cartesians is required.");h(t)||(t=[]);for(var r=0,i=e.length,n=0;n<i;n++){var o=this.projectPointOntoPlane(e[n],t[r]);h(o)&&(t[r]=o,r++)}return t.length=r,t},m.prototype.projectPointToNearestOnPlane=function(e,t){if(!h(e))throw new p("cartesian is required.");h(t)||(t=new s);var r=_;r.origin=e,d.clone(this._plane.normal,r.direction);var i=l.rayPlane(r,this._plane,v);h(i)||(d.negate(r.direction,r.direction),i=l.rayPlane(r,this._plane,v));var n=d.subtract(i,this._origin,i),o=d.dot(this._xAxis,n),a=d.dot(this._yAxis,n);return t.x=o,t.y=a,t},m.prototype.projectPointsToNearestOnPlane=function(e,t){if(!h(e))throw new p("cartesians is required.");h(t)||(t=[]);var r=e.length;t.length=r;for(var i=0;i<r;i++)t[i]=this.projectPointToNearestOnPlane(e[i],t[i]);return t};var y=new d;return m.prototype.projectPointsOntoEllipsoid=function(e,t){if(!h(e))throw new p("cartesians is required.");var r=e.length;h(t)?t.length=r:t=new Array(r);for(var i=this._ellipsoid,n=this._origin,o=this._xAxis,a=this._yAxis,s=y,l=0;l<r;++l){var u=e[l];d.multiplyByScalar(o,u.x,s),h(t[l])||(t[l]=new d);var c=d.add(n,s,t[l]);d.multiplyByScalar(a,u.y,s),d.add(c,s,c),i.scaleToGeocentricSurface(c,c)}return t},m}),define("Core/OrientedBoundingBox",["./BoundingSphere","./Cartesian2","./Cartesian3","./Cartographic","./Check","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./EllipsoidTangentPlane","./Intersect","./Interval","./Math","./Matrix3","./Plane","./Rectangle"],function(i,e,x,t,n,S,P,T,E,A,c,f,D,O,I,M){"use strict";function R(e,t){this.center=x.clone(S(e,x.ZERO)),this.halfAxes=O.clone(S(t,O.ZERO))}R.packedLength=x.packedLength+O.packedLength,R.pack=function(e,t,r){return n.typeOf.object("value",e),n.defined("array",t),r=S(r,0),x.pack(e.center,t,r),O.pack(e.halfAxes,t,r+x.packedLength),t},R.unpack=function(e,t,r){return n.defined("array",e),t=S(t,0),P(r)||(r=new R),x.unpack(e,t,r.center),O.unpack(e,t+x.packedLength,r.halfAxes),r};var L=new x,N=new x,k=new x,F=new x,B=new x,U=new x,V=new O,z={unitary:new O,diagonal:new O};R.fromPoints=function(e,t){if(P(t)||(t=new R),!P(e)||0===e.length)return t.halfAxes=O.ZERO,t.center=x.ZERO,t;var r,i=e.length,n=x.clone(e[0],L);for(r=1;r<i;r++)x.add(n,e[r],n);var o=1/i;x.multiplyByScalar(n,o,n);var a,s=0,l=0,u=0,c=0,d=0,h=0;for(r=0;r<i;r++)s+=(a=x.subtract(e[r],n,N)).x*a.x,l+=a.x*a.y,u+=a.x*a.z,c+=a.y*a.y,d+=a.y*a.z,h+=a.z*a.z;s*=o,l*=o,u*=o,c*=o,d*=o,h*=o;var p=V;p[0]=s,p[1]=l,p[2]=u,p[3]=l,p[4]=c,p[5]=d,p[6]=u,p[7]=d,p[8]=h;var f=O.computeEigenDecomposition(p,z),m=O.clone(f.unitary,t.halfAxes),g=O.getColumn(m,0,F),_=O.getColumn(m,1,B),v=O.getColumn(m,2,U),y=-Number.MAX_VALUE,b=-Number.MAX_VALUE,C=-Number.MAX_VALUE,w=Number.MAX_VALUE,S=Number.MAX_VALUE,T=Number.MAX_VALUE;for(r=0;r<i;r++)a=e[r],y=Math.max(x.dot(g,a),y),b=Math.max(x.dot(_,a),b),C=Math.max(x.dot(v,a),C),w=Math.min(x.dot(g,a),w),S=Math.min(x.dot(_,a),S),T=Math.min(x.dot(v,a),T);g=x.multiplyByScalar(g,.5*(w+y),g),_=x.multiplyByScalar(_,.5*(S+b),_),v=x.multiplyByScalar(v,.5*(T+C),v);var E=x.add(g,_,t.center);x.add(E,v,E);var A=k;return A.x=y-w,A.y=b-S,A.z=C-T,x.multiplyByScalar(A,.5,A),O.multiplyByScale(t.halfAxes,A,t.halfAxes),t};var q=new x,G=new x;var W=new t,H=new x,j=[new t,new t,new t,new t,new t,new t,new t,new t],Y=[new x,new x,new x,new x,new x,new x,new x,new x],X=[new e,new e,new e,new e,new e,new e,new e,new e];R.fromRectangle=function(e,t,r,i,n){if(!P(e))throw new T("rectangle is required");if(e.width<0||e.width>D.TWO_PI)throw new T("Rectangle width must be between 0 and 2*pi");if(e.height<0||e.height>D.PI)throw new T("Rectangle height must be between 0 and pi");if(P(i)&&!D.equalsEpsilon(i.radii.x,i.radii.y,D.EPSILON15))throw new T("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");t=S(t,0),r=S(r,0),i=S(i,E.WGS84);var o=M.center(e,W),a=i.cartographicToCartesian(o,H),s=new A(a,i),l=s.plane,u=j[0],c=j[1],d=j[2],h=j[3],p=j[4],f=j[5],m=j[6],g=j[7],_=o.longitude,v=e.south<0&&0<e.north?0:o.latitude;m.latitude=f.latitude=p.latitude=e.south,g.latitude=h.latitude=v,u.latitude=c.latitude=d.latitude=e.north,m.longitude=g.longitude=u.longitude=e.west,f.longitude=c.longitude=_,p.longitude=h.longitude=d.longitude=e.east,d.height=c.height=u.height=g.height=m.height=f.height=p.height=h.height=r,i.cartographicArrayToCartesianArray(j,Y),s.projectPointsToNearestOnPlane(Y,X);var y=Math.min(X[6].x,X[7].x,X[0].x),b=Math.max(X[2].x,X[3].x,X[4].x),C=Math.min(X[4].y,X[5].y,X[6].y),w=Math.max(X[0].y,X[1].y,X[2].y);return d.height=u.height=p.height=m.height=t,i.cartographicArrayToCartesianArray(j,Y),function(e,t,r,i,n,o,a,s){if(!(P(t)&&P(r)&&P(i)&&P(n)&&P(o)&&P(a)))throw new T("all extents (minimum/maximum X/Y/Z) are required.");P(s)||(s=new R);var l=s.halfAxes;O.setColumn(l,0,e.xAxis,l),O.setColumn(l,1,e.yAxis,l),O.setColumn(l,2,e.zAxis,l);var u=q;u.x=(t+r)/2,u.y=(i+n)/2,u.z=(o+a)/2;var c=G;c.x=(r-t)/2,c.y=(n-i)/2,c.z=(a-o)/2;var d=s.center;return u=O.multiplyByVector(l,u,u),x.add(e.origin,u,d),O.multiplyByScale(l,c,l),s}(s,y,b,C,w,Math.min(I.getPointDistance(l,Y[0]),I.getPointDistance(l,Y[2]),I.getPointDistance(l,Y[4]),I.getPointDistance(l,Y[6])),r,n)},R.clone=function(e,t){if(P(e))return P(t)?(x.clone(e.center,t.center),O.clone(e.halfAxes,t.halfAxes),t):new R(e.center,e.halfAxes)},R.intersectPlane=function(e,t){if(!P(e))throw new T("box is required.");if(!P(t))throw new T("plane is required.");var r=e.center,i=t.normal,n=e.halfAxes,o=i.x,a=i.y,s=i.z,l=Math.abs(o*n[O.COLUMN0ROW0]+a*n[O.COLUMN0ROW1]+s*n[O.COLUMN0ROW2])+Math.abs(o*n[O.COLUMN1ROW0]+a*n[O.COLUMN1ROW1]+s*n[O.COLUMN1ROW2])+Math.abs(o*n[O.COLUMN2ROW0]+a*n[O.COLUMN2ROW1]+s*n[O.COLUMN2ROW2]),u=x.dot(i,r)+t.distance;return u<=-l?c.OUTSIDE:l<=u?c.INSIDE:c.INTERSECTING};var m=new x,g=new x,_=new x,p=new x;R.distanceSquaredTo=function(e,t){if(!P(e))throw new T("box is required.");if(!P(t))throw new T("cartesian is required.");var r=x.subtract(t,e.center,q),i=e.halfAxes,n=O.getColumn(i,0,m),o=O.getColumn(i,1,g),a=O.getColumn(i,2,_),s=x.magnitude(n),l=x.magnitude(o),u=x.magnitude(a);x.normalize(n,n),x.normalize(o,o),x.normalize(a,a);var c=p;c.x=x.dot(r,n),c.y=x.dot(r,o),c.z=x.dot(r,a);var d,h=0;return c.x<-s?h+=(d=c.x+s)*d:c.x>s&&(h+=(d=c.x-s)*d),c.y<-l?h+=(d=c.y+l)*d:c.y>l&&(h+=(d=c.y-l)*d),c.z<-u?h+=(d=c.z+u)*d:c.z>u&&(h+=(d=c.z-u)*d),h};var v=new x,y=new x;R.computePlaneDistances=function(e,t,r,i){if(!P(e))throw new T("box is required.");if(!P(t))throw new T("position is required.");if(!P(r))throw new T("direction is required.");P(i)||(i=new f);var n=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,a=e.center,s=e.halfAxes,l=O.getColumn(s,0,m),u=O.getColumn(s,1,g),c=O.getColumn(s,2,_),d=x.add(l,u,v);x.add(d,c,d),x.add(d,a,d);var h=x.subtract(d,t,y),p=x.dot(r,h);return n=Math.min(p,n),o=Math.max(p,o),x.add(a,l,d),x.add(d,u,d),x.subtract(d,c,d),x.subtract(d,t,h),p=x.dot(r,h),n=Math.min(p,n),o=Math.max(p,o),x.add(a,l,d),x.subtract(d,u,d),x.add(d,c,d),x.subtract(d,t,h),p=x.dot(r,h),n=Math.min(p,n),o=Math.max(p,o),x.add(a,l,d),x.subtract(d,u,d),x.subtract(d,c,d),x.subtract(d,t,h),p=x.dot(r,h),n=Math.min(p,n),o=Math.max(p,o),x.subtract(a,l,d),x.add(d,u,d),x.add(d,c,d),x.subtract(d,t,h),p=x.dot(r,h),n=Math.min(p,n),o=Math.max(p,o),x.subtract(a,l,d),x.add(d,u,d),x.subtract(d,c,d),x.subtract(d,t,h),p=x.dot(r,h),n=Math.min(p,n),o=Math.max(p,o),x.subtract(a,l,d),x.subtract(d,u,d),x.add(d,c,d),x.subtract(d,t,h),p=x.dot(r,h),n=Math.min(p,n),o=Math.max(p,o),x.subtract(a,l,d),x.subtract(d,u,d),x.subtract(d,c,d),x.subtract(d,t,h),p=x.dot(r,h),n=Math.min(p,n),o=Math.max(p,o),i.start=n,i.stop=o,i};var o=new i;return R.isOccluded=function(e,t){if(!P(e))throw new T("box is required.");if(!P(t))throw new T("occluder is required.");var r=i.fromOrientedBoundingBox(e,o);return!t.isBoundingSphereVisible(r)},R.prototype.intersectPlane=function(e){return R.intersectPlane(this,e)},R.prototype.distanceSquaredTo=function(e){return R.distanceSquaredTo(this,e)},R.prototype.computePlaneDistances=function(e,t,r){return R.computePlaneDistances(this,e,t,r)},R.prototype.isOccluded=function(e){return R.isOccluded(this,e)},R.equals=function(e,t){return e===t||P(e)&&P(t)&&x.equals(e.center,t.center)&&O.equals(e.halfAxes,t.halfAxes)},R.prototype.clone=function(e){return R.clone(this,e)},R.prototype.equals=function(e){return R.equals(this,e)},R}),define("Core/TerrainQuantization",["./freezeObject"],function(e){"use strict";return e({NONE:0,BITS12:1})}),define("Core/TerrainEncoding",["./AttributeCompression","./Cartesian2","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./Math","./Matrix4","./TerrainQuantization"],function(m,g,y,s,b,C,_,w,S){"use strict";var T=new y,E=new y,v=new g,A=new w,x=new w,P=Math.pow(2,12);function r(e,t,r,i,n,o){var a,s,l,u;if(C(e)&&C(t)&&C(r)&&C(i)){var c=e.minimum,d=e.maximum,h=y.subtract(d,c,E),p=r-t;a=Math.max(y.maximumComponent(h),p)<P-1?S.BITS12:S.NONE,s=e.center,l=w.inverseTransformation(i,new w);var f=y.negate(c,T);w.multiply(w.fromTranslation(f,A),l,l);var m=T;m.x=1/h.x,m.y=1/h.y,m.z=1/h.z,w.multiply(w.fromScale(m,A),l,l),u=w.clone(i),w.setTranslation(u,y.ZERO,u),i=w.clone(i,new w);var g=w.fromTranslation(c,A),_=w.fromScale(h,x),v=w.multiply(g,_,A);w.multiply(i,v,i),w.multiply(u,v,u)}this.quantization=a,this.minimumHeight=t,this.maximumHeight=r,this.center=s,this.toScaledENU=l,this.fromScaledENU=i,this.matrix=u,this.hasVertexNormals=n,this.hasWebMercatorT=b(o,!1)}r.prototype.encode=function(e,t,r,i,n,o,a){var s=i.x,l=i.y;if(this.quantization===S.BITS12){(r=w.multiplyByPoint(this.toScaledENU,r,T)).x=_.clamp(r.x,0,1),r.y=_.clamp(r.y,0,1),r.z=_.clamp(r.z,0,1);var u=this.maximumHeight-this.minimumHeight,c=_.clamp((n-this.minimumHeight)/u,0,1);g.fromElements(r.x,r.y,v);var d=m.compressTextureCoordinates(v);g.fromElements(r.z,c,v);var h=m.compressTextureCoordinates(v);g.fromElements(s,l,v);var p=m.compressTextureCoordinates(v);if(e[t++]=d,e[t++]=h,e[t++]=p,this.hasWebMercatorT){g.fromElements(a,0,v);var f=m.compressTextureCoordinates(v);e[t++]=f}}else y.subtract(r,this.center,T),e[t++]=T.x,e[t++]=T.y,e[t++]=T.z,e[t++]=n,e[t++]=s,e[t++]=l,this.hasWebMercatorT&&(e[t++]=a);return this.hasVertexNormals&&(e[t++]=m.octPackFloat(o)),t},r.prototype.decodePosition=function(e,t,r){if(C(r)||(r=new y),t*=this.getStride(),this.quantization!==S.BITS12)return r.x=e[t],r.y=e[t+1],r.z=e[t+2],y.add(r,this.center,r);var i=m.decompressTextureCoordinates(e[t],v);r.x=i.x,r.y=i.y;var n=m.decompressTextureCoordinates(e[t+1],v);return r.z=n.x,w.multiplyByPoint(this.fromScaledENU,r,r)},r.prototype.decodeTextureCoordinates=function(e,t,r){return C(r)||(r=new g),t*=this.getStride(),this.quantization===S.BITS12?m.decompressTextureCoordinates(e[t+2],r):g.fromElements(e[t+4],e[t+5],r)},r.prototype.decodeHeight=function(e,t){return t*=this.getStride(),this.quantization!==S.BITS12?e[t+3]:m.decompressTextureCoordinates(e[t+1],v).y*(this.maximumHeight-this.minimumHeight)+this.minimumHeight},r.prototype.getOctEncodedNormal=function(e,t,r){var i=e[t=(t+1)*this.getStride()-1]/256,n=Math.floor(i),o=256*(i-n);return g.fromElements(n,o,r)},r.prototype.getStride=function(){var e;switch(this.quantization){case S.BITS12:e=3;break;default:e=6}return this.hasWebMercatorT&&++e,this.hasVertexNormals&&++e,e};var l={position3DAndHeight:0,textureCoordAndEncodedNormals:1},u={compressed0:0,compressed1:1};return r.prototype.getAttributes=function(e){var t,r=s.FLOAT,i=s.getSizeInBytes(r);if(this.quantization===S.NONE){var n=2;return this.hasWebMercatorT&&++n,this.hasVertexNormals&&++n,[{index:l.position3DAndHeight,vertexBuffer:e,componentDatatype:r,componentsPerAttribute:4,offsetInBytes:0,strideInBytes:t=(4+n)*i},{index:l.textureCoordAndEncodedNormals,vertexBuffer:e,componentDatatype:r,componentsPerAttribute:n,offsetInBytes:4*i,strideInBytes:t}]}var o=3,a=0;return(this.hasWebMercatorT||this.hasVertexNormals)&&++o,this.hasWebMercatorT&&this.hasVertexNormals?[{index:u.compressed0,vertexBuffer:e,componentDatatype:r,componentsPerAttribute:o,offsetInBytes:0,strideInBytes:t=(o+ ++a)*i},{index:u.compressed1,vertexBuffer:e,componentDatatype:r,componentsPerAttribute:a,offsetInBytes:o*i,strideInBytes:t}]:[{index:u.compressed0,vertexBuffer:e,componentDatatype:r,componentsPerAttribute:o}]},r.prototype.getAttributeLocations=function(){return this.quantization===S.NONE?l:u},r.clone=function(e,t){return C(t)||(t=new r),t.quantization=e.quantization,t.minimumHeight=e.minimumHeight,t.maximumHeight=e.maximumHeight,t.center=y.clone(e.center),t.toScaledENU=w.clone(e.toScaledENU),t.fromScaledENU=w.clone(e.fromScaledENU),t.matrix=w.clone(e.matrix),t.hasVertexNormals=e.hasVertexNormals,t.hasWebMercatorT=e.hasWebMercatorT,t},r}),define("Core/WebMercatorProjection",["./Cartesian3","./Cartographic","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Math"],function(a,s,t,l,e,u,r,i){"use strict";function c(e){this._ellipsoid=t(e,r.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}return e(c.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),c.mercatorAngleToGeodeticLatitude=function(e){return i.PI_OVER_TWO-2*Math.atan(Math.exp(-e))},c.geodeticLatitudeToMercatorAngle=function(e){c.MaximumLatitude<e?e=c.MaximumLatitude:e<-c.MaximumLatitude&&(e=-c.MaximumLatitude);var t=Math.sin(e);return.5*Math.log((1+t)/(1-t))},c.MaximumLatitude=c.mercatorAngleToGeodeticLatitude(Math.PI),c.prototype.project=function(e,t){var r=this._semimajorAxis,i=e.longitude*r,n=c.geodeticLatitudeToMercatorAngle(e.latitude)*r,o=e.height;return l(t)?(t.x=i,t.y=n,t.z=o,t):new a(i,n,o)},c.prototype.unproject=function(e,t){if(!l(e))throw new u("cartesian is required");var r=this._oneOverSemimajorAxis,i=e.x*r,n=c.mercatorAngleToGeodeticLatitude(e.y*r),o=e.z;return l(t)?(t.longitude=i,t.latitude=n,t.height=o,t):new s(i,n,o)},c}),define("Core/HeightmapTessellator",["./AxisAlignedBoundingBox","./BoundingSphere","./Cartesian2","./Cartesian3","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./EllipsoidalOccluder","./freezeObject","./Math","./Matrix4","./OrientedBoundingBox","./Rectangle","./TerrainEncoding","./Transforms","./WebMercatorProjection"],function(Fe,Be,Ue,Ve,ze,qe,Ge,We,He,e,je,Ye,Xe,Qe,Ze,Ke,Je){"use strict";var $e={};$e.DEFAULT_STRUCTURE=e({heightScale:1,heightOffset:0,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:!1});var et=new Ve,tt=new Ye,rt=new Ve,it=new Ve;return $e.computeVertices=function(e){if(!qe(e)||!qe(e.heightmap))throw new Ge("options.heightmap is required.");if(!qe(e.width)||!qe(e.height))throw new Ge("options.width and options.height are required.");if(!qe(e.nativeRectangle))throw new Ge("options.nativeRectangle is required.");if(!qe(e.skirtHeight))throw new Ge("options.skirtHeight is required.");var t,r,i,n,o=Math.cos,a=Math.sin,s=Math.sqrt,l=Math.atan,u=Math.exp,c=je.PI_OVER_TWO,d=je.toRadians,h=e.heightmap,p=e.width,f=e.height,m=e.skirtHeight,g=ze(e.isGeographic,!0),_=ze(e.ellipsoid,We.WGS84),v=1/_.maximumRadius,y=e.nativeRectangle,b=e.rectangle;n=qe(b)?(t=b.west,r=b.south,i=b.east,b.north):g?(t=d(y.west),r=d(y.south),i=d(y.east),d(y.north)):(t=y.west*v,r=c-2*l(u(-y.south*v)),i=y.east*v,c-2*l(u(-y.north*v)));var C=e.relativeToCenter,w=qe(C);C=w?C:Ve.ZERO;var S=ze(e.exaggeration,1),T=ze(e.includeWebMercatorT,!1),E=ze(e.structure,$e.DEFAULT_STRUCTURE),A=ze(E.heightScale,$e.DEFAULT_STRUCTURE.heightScale),x=ze(E.heightOffset,$e.DEFAULT_STRUCTURE.heightOffset),P=ze(E.elementsPerHeight,$e.DEFAULT_STRUCTURE.elementsPerHeight),D=ze(E.stride,$e.DEFAULT_STRUCTURE.stride),O=ze(E.elementMultiplier,$e.DEFAULT_STRUCTURE.elementMultiplier),I=ze(E.isBigEndian,$e.DEFAULT_STRUCTURE.isBigEndian),M=Qe.computeWidth(y),R=Qe.computeHeight(y),L=M/(p-1),N=R/(f-1);g||(M*=v,R*=v);var k,F,B=_.radiiSquared,U=B.x,V=B.y,z=B.z,q=65536,G=-65536,W=Ke.eastNorthUpToFixedFrame(C,_),H=Ye.inverseTransformation(W,tt);T&&(k=Je.geodeticLatitudeToMercatorAngle(r),F=1/(Je.geodeticLatitudeToMercatorAngle(n)-k));var j=rt;j.x=Number.POSITIVE_INFINITY,j.y=Number.POSITIVE_INFINITY,j.z=Number.POSITIVE_INFINITY;var Y=it;Y.x=Number.NEGATIVE_INFINITY,Y.y=Number.NEGATIVE_INFINITY,Y.z=Number.NEGATIVE_INFINITY;var X=Number.POSITIVE_INFINITY,Q=(p+(0<m?2:0))*(f+(0<m?2:0)),Z=new Array(Q),K=new Array(Q),J=new Array(Q),$=T?new Array(Q):[],ee=0,te=f,re=0,ie=p;0<m&&(--ee,++te,--re,++ie);for(var ne=0,oe=ee;oe<te;++oe){var ae=oe;ae<0&&(ae=0),f<=ae&&(ae=f-1);var se,le=y.north-N*ae,ue=o(le=g?d(le):c-2*l(u(-le*v))),ce=a(le),de=z*ce,he=(le-r)/(n-r);he=je.clamp(he,0,1),T&&(se=(Je.geodeticLatitudeToMercatorAngle(le)-k)*F);for(var pe=re;pe<ie;++pe){var fe=pe;fe<0&&(fe=0),p<=fe&&(fe=p-1);var me=y.west+L*fe;g?me=d(me):me*=v;var ge,_e,ve=ae*(p*D)+fe*D;if(1===P)ge=h[ve];else if(ge=0,I)for(_e=0;_e<P;++_e)ge=ge*O+h[ve+_e];else for(_e=P-1;0<=_e;--_e)ge=ge*O+h[ve+_e];ge=(ge*A+x)*S;var ye=(me-t)/(i-t);if(ye=je.clamp(ye,0,1),J[ne]=new Ue(ye,he),G=Math.max(G,ge),q=Math.min(q,ge),pe!==fe||oe!==ae){pe<0?me-=1e-5*M:me+=1e-5*M,oe<0?le+=1e-5*R:le-=1e-5*R,ue=o(le),de=z*(ce=a(le)),ge-=m}var be=ue*o(me),Ce=ue*a(me),we=U*be,Se=V*Ce,Te=1/s(we*be+Se*Ce+de*ce),Ee=we*Te,Ae=Se*Te,xe=de*Te,Pe=new Ve;Pe.x=Ee+be*ge,Pe.y=Ae+Ce*ge,Pe.z=xe+ce*ge,Z[ne]=Pe,K[ne]=ge,T&&($[ne]=se),ne++,Ye.multiplyByPoint(H,Pe,et),Ve.minimumByComponent(et,j,j),Ve.maximumByComponent(et,Y,Y),X=Math.min(X,ge)}}var De,Oe,Ie=Be.fromPoints(Z);(qe(b)&&b.width<je.PI_OVER_TWO+je.EPSILON5&&(De=Xe.fromRectangle(b,q,G,_)),w)&&(Oe=new He(_).computeHorizonCullingPoint(C,Z));for(var Me=new Fe(j,Y,C),Re=new Ze(Me,X,G,W,!1,T),Le=new Float32Array(Q*Re.getStride()),Ne=0,ke=0;ke<Q;++ke)Ne=Re.encode(Le,Ne,Z[ke],J[ke],K[ke],void 0,$[ke]);return{vertices:Le,maximumHeight:G,minimumHeight:q,encoding:Re,boundingSphere3D:Ie,orientedBoundingBox:De,occludeePointInScaledSpace:Oe}},$e}),define("Core/destroyObject",["./defaultValue","./DeveloperError"],function(n,o){"use strict";function a(){return!0}return function(e,t){function r(){throw new o(t)}for(var i in t=n(t,"This object was destroyed, i.e., destroy() was called."),e)"function"==typeof e[i]&&(e[i]=r);e.isDestroyed=a}}),define("Core/TaskProcessor",["../ThirdParty/when","./buildModuleUrl","./defaultValue","./defined","./destroyObject","./DeveloperError","./Event","./getAbsoluteUri","./isCrossOriginUrl","./RuntimeError","require"],function(a,o,s,l,e,u,t,i,c,d,n){"use strict";var h,p=new t;function f(e){var t=o(e);if(c(t)){var r,i='importScripts("'+t+'");';try{r=new Blob([i],{type:"application/javascript"})}catch(e){var n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);n.append(i),r=n.getBlob("application/javascript")}t=(window.URL||window.webkitURL).createObjectURL(r)}return t}function r(t){var e=new Worker((l(h)||(h=f("Workers/cesiumWorkerBootstrapper.js")),h));e.postMessage=s(e.webkitPostMessage,e.postMessage);var r={loaderConfig:{},workerModule:m._workerModulePrefix+t._workerName};return l(m._loaderConfig)?r.loaderConfig=m._loaderConfig:l(define.amd)&&!define.amd.toUrlUndefined&&l(n.toUrl)?r.loaderConfig.baseUrl=i("..",o("Workers/cesiumWorkerBootstrapper.js")):r.loaderConfig.paths={Workers:o("Workers")},e.postMessage(r),e.onmessage=function(e){!function(e,t){--e._activeTasks;var r=t.id;if(l(r)){var i=e._deferreds,n=i[r];if(l(t.error)){var o=t.error;"RuntimeError"===o.name?(o=new d(t.error.message)).stack=t.error.stack:"DeveloperError"===o.name&&((o=new u(t.error.message)).stack=t.error.stack),p.raiseEvent(o),n.reject(o)}else p.raiseEvent(),n.resolve(t.result);delete i[r]}}(t,e.data)},e}function m(e,t){this._workerName=e,this._maximumActiveTasks=s(t,5),this._activeTasks=0,this._deferreds={},this._nextID=0}var g=[];return m.prototype.scheduleTask=function(i,n){if(l(this._worker)||(this._worker=r(this)),!(this._activeTasks>=this._maximumActiveTasks)){++this._activeTasks;var o=this;return a(function(){if(!l(m._canTransferArrayBuffer)){var i=new Worker(f("Workers/transferTypedArrayTest.js"));i.postMessage=s(i.webkitPostMessage,i.postMessage);var e=new Int8Array([99]);try{i.postMessage({array:e},[e.buffer])}catch(e){return m._canTransferArrayBuffer=!1}var n=a.defer();i.onmessage=function(e){var t=e.data.array,r=l(t)&&99===t[0];n.resolve(r),i.terminate(),m._canTransferArrayBuffer=r},m._canTransferArrayBuffer=n.promise}return m._canTransferArrayBuffer}(),function(e){l(n)?e||(n.length=0):n=g;var t=o._nextID++,r=a.defer();return o._deferreds[t]=r,o._worker.postMessage({id:t,parameters:i,canTransferArrayBuffer:e},n),r.promise})}},m.prototype.isDestroyed=function(){return!1},m.prototype.destroy=function(){return l(this._worker)&&this._worker.terminate(),e(this)},m.taskCompletedEvent=p,m._workerModulePrefix=m._defaultWorkerModulePrefix="Workers/",m._loaderConfig=void 0,m._canTransferArrayBuffer=void 0,m}),define("Core/TerrainMesh",["./defaultValue"],function(d){"use strict";return function(e,t,r,i,n,o,a,s,l,u,c){this.center=e,this.vertices=t,this.stride=d(s,6),this.indices=r,this.minimumHeight=i,this.maximumHeight=n,this.boundingSphere3D=o,this.occludeePointInScaledSpace=a,this.orientedBoundingBox=l,this.encoding=u,this.exaggeration=c}}),define("Core/TerrainProvider",["./defined","./defineProperties","./DeveloperError","./Math"],function(h,e,p,f){"use strict";function i(){p.throwInstantiationError()}e(i.prototype,{errorEvent:{get:p.throwInstantiationError},credit:{get:p.throwInstantiationError},tilingScheme:{get:p.throwInstantiationError},ready:{get:p.throwInstantiationError},readyPromise:{get:p.throwInstantiationError},hasWaterMask:{get:p.throwInstantiationError},hasVertexNormals:{get:p.throwInstantiationError},availability:{get:p.throwInstantiationError}});var m=[];return i.getRegularGridIndices=function(e,t){if(e*t>=f.SIXTY_FOUR_KILOBYTES)throw new p("The total number of vertices (width * height) must be less than 65536.");var r=m[e];h(r)||(m[e]=r=[]);var i=r[t];if(!h(i)){i=r[t]=new Uint16Array((e-1)*(t-1)*6);for(var n=0,o=0,a=0;a<t-1;++a){for(var s=0;s<e-1;++s){var l=n,u=l+e,c=u+1,d=l+1;i[o++]=l,i[o++]=u,i[o++]=d,i[o++]=d,i[o++]=u,i[o++]=c,++n}++n}}return i},i.heightmapTerrainQuality=.25,i.getEstimatedLevelZeroGeometricErrorForAHeightmap=function(e,t,r){return 2*e.maximumRadius*Math.PI*i.heightmapTerrainQuality/(t*r)},i.prototype.requestTileGeometry=p.throwInstantiationError,i.prototype.getLevelMaximumGeometricError=p.throwInstantiationError,i.prototype.getTileDataAvailable=p.throwInstantiationError,i}),define("Core/HeightmapTerrainData",["../ThirdParty/when","./defaultValue","./defined","./defineProperties","./DeveloperError","./GeographicTilingScheme","./HeightmapTessellator","./Math","./Rectangle","./TaskProcessor","./TerrainEncoding","./TerrainMesh","./TerrainProvider"],function(p,f,D,e,O,m,i,I,g,t,_,v,y){"use strict";function M(e){if(!D(e)||!D(e.buffer))throw new O("options.buffer is required.");if(!D(e.width))throw new O("options.width is required.");if(!D(e.height))throw new O("options.height is required.");this._buffer=e.buffer,this._width=e.width,this._height=e.height,this._childTileMask=f(e.childTileMask,15);var t=i.DEFAULT_STRUCTURE,r=e.structure;D(r)?r!==t&&(r.heightScale=f(r.heightScale,t.heightScale),r.heightOffset=f(r.heightOffset,t.heightOffset),r.elementsPerHeight=f(r.elementsPerHeight,t.elementsPerHeight),r.stride=f(r.stride,t.stride),r.elementMultiplier=f(r.elementMultiplier,t.elementMultiplier),r.isBigEndian=f(r.isBigEndian,t.isBigEndian)):r=t,this._structure=r,this._createdByUpsampling=f(e.createdByUpsampling,!1),this._waterMask=e.waterMask,this._skirtHeight=void 0,this._bufferType=this._buffer.constructor,this._mesh=void 0}e(M.prototype,{credits:{get:function(){}},waterMask:{get:function(){return this._waterMask}}});var b=new t("createVerticesFromHeightmap");function R(e,t,r,i,n,o,a,s,l,u,c){var d=(l-o.west)*(a-1)/(o.east-o.west),h=(u-o.south)*(s-1)/(o.north-o.south);0<n&&(d+=1,h+=1,a+=2,s+=2);var p=0|d,f=p+1;(0<n?a-1:a)<=f&&(f=a-1,p=a-2);var m=0|h,g=m+1;(0<n?s-1:s)<=g&&(g=s-1,m=s-2);var _=h-m;return m=s-1-m,g=s-1-g,w(d-p,_,(t.decodeHeight(e,m*a+p)/c-r)/i,(t.decodeHeight(e,m*a+f)/c-r)/i,(t.decodeHeight(e,g*a+p)/c-r)/i,(t.decodeHeight(e,g*a+f)/c-r)/i)}function w(e,t,r,i,n,o){return t<e?r+e*(i-r)+t*(o-i):r+e*(o-n)+t*(n-r)}function S(e,t,r,i,n,o){o*=i;var a,s=0;if(n)for(a=0;a<t;++a)s=s*r+e[o+a];else for(a=t-1;0<=a;--a)s=s*r+e[o+a];return s}function L(e,t,r,i,n,o,a,s){var l;if(a*=n,o)for(l=0;l<t-1;++l)e[a+l]=s/i|0,s-=e[a+l]*i,i/=r;else for(l=t-1;0<l;--l)e[a+l]=s/i|0,s-=e[a+l]*i,i/=r;e[a+l]=s}return M.prototype.createMesh=function(e,t,r,i,n){if(!D(e))throw new O("tilingScheme is required.");if(!D(t))throw new O("x is required.");if(!D(r))throw new O("y is required.");if(!D(i))throw new O("level is required.");var o=e.ellipsoid,a=e.tileXYToNativeRectangle(t,r,i),s=e.tileXYToRectangle(t,r,i);n=f(n,1);var l=o.cartographicToCartesian(g.center(s)),u=this._structure,c=y.getEstimatedLevelZeroGeometricErrorForAHeightmap(o,this._width,e.getNumberOfXTilesAtLevel(0))/(1<<i);this._skirtHeight=Math.min(4*c,1e3);var d=b.scheduleTask({heightmap:this._buffer,structure:u,includeWebMercatorT:!0,width:this._width,height:this._height,nativeRectangle:a,rectangle:s,relativeToCenter:l,ellipsoid:o,skirtHeight:this._skirtHeight,isGeographic:e instanceof m,exaggeration:n});if(D(d)){var h=this;return p(d,function(e){return h._mesh=new v(l,new Float32Array(e.vertices),y.getRegularGridIndices(e.gridWidth,e.gridHeight),e.minimumHeight,e.maximumHeight,e.boundingSphere3D,e.occludeePointInScaledSpace,e.numberOfAttributes,e.orientedBoundingBox,_.clone(e.encoding),n),h._buffer=void 0,h._mesh})}},M.prototype.interpolateHeight=function(e,t,r){var i,n=this._width,o=this._height,a=this._structure,s=a.stride,l=a.elementsPerHeight,u=a.elementMultiplier,c=a.isBigEndian,d=a.heightOffset,h=a.heightScale;D(this._mesh)?i=R(this._mesh.vertices,this._mesh.encoding,d,h,this._skirtHeight,e,n,o,t,r,this._mesh.exaggeration):i=(i=function(e,t,r,i,n,o,a,s,l,u){var c=(l-o.west)*(a-1)/(o.east-o.west),d=(u-o.south)*(s-1)/(o.north-o.south),h=0|c,p=h+1;a<=p&&(p=a-1,h=a-2);var f=0|d,m=f+1;s<=m&&(m=s-1,f=s-2);var g=c-h,_=d-f;m=s-1-m;var v=S(e,t,r,i,n,(f=s-1-f)*a+h),y=S(e,t,r,i,n,f*a+p),b=S(e,t,r,i,n,m*a+h),C=S(e,t,r,i,n,m*a+p);return w(g,_,v,y,b,C)}(this._buffer,l,u,s,c,e,n,o,t,r))*h+d;return i},M.prototype.upsample=function(e,t,r,i,n,o,a){if(!D(e))throw new O("tilingScheme is required.");if(!D(t))throw new O("thisX is required.");if(!D(r))throw new O("thisY is required.");if(!D(i))throw new O("thisLevel is required.");if(!D(n))throw new O("descendantX is required.");if(!D(o))throw new O("descendantY is required.");if(!D(a))throw new O("descendantLevel is required.");if(1<a-i)throw new O("Upsampling through more than one level at a time is not currently supported.");var s=this._width,l=this._height,u=this._structure,c=this._skirtHeight,d=u.stride,h=new this._bufferType(s*l*d),p=this._mesh;if(D(p)){for(var f=p.vertices,m=p.encoding,g=e.tileXYToRectangle(t,r,i),_=e.tileXYToRectangle(n,o,a),v=u.heightOffset,y=u.heightScale,b=p.exaggeration,C=u.elementsPerHeight,w=u.elementMultiplier,S=u.isBigEndian,T=Math.pow(w,C-1),E=0;E<l;++E)for(var A=I.lerp(_.north,_.south,E/(l-1)),x=0;x<s;++x){var P=R(f,m,v,y,c,g,s,l,I.lerp(_.west,_.east,x/(s-1)),A,b);L(h,C,w,T,d,S,E*s+x,P=(P=P<u.lowestEncodedHeight?u.lowestEncodedHeight:P)>u.highestEncodedHeight?u.highestEncodedHeight:P)}return new M({buffer:h,width:s,height:l,childTileMask:0,structure:this._structure,createdByUpsampling:!0})}},M.prototype.isChildAvailable=function(e,t,r,i){if(!D(e))throw new O("thisX is required.");if(!D(t))throw new O("thisY is required.");if(!D(r))throw new O("childX is required.");if(!D(i))throw new O("childY is required.");var n=2;return r!==2*e&&++n,i!==2*t&&(n-=2),0!=(this._childTileMask&1<<n)},M.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling},M}),define("Core/IndexDatatype",["./defined","./DeveloperError","./freezeObject","./Math","./WebGLConstants"],function(n,o,e,a,t){"use strict";var r={UNSIGNED_BYTE:t.UNSIGNED_BYTE,UNSIGNED_SHORT:t.UNSIGNED_SHORT,UNSIGNED_INT:t.UNSIGNED_INT,getSizeInBytes:function(e){switch(e){case r.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case r.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case r.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT}throw new o("indexDatatype is required and must be a valid IndexDatatype constant.")},validate:function(e){return n(e)&&(e===r.UNSIGNED_BYTE||e===r.UNSIGNED_SHORT||e===r.UNSIGNED_INT)},createTypedArray:function(e,t){if(!n(e))throw new o("numberOfVertices is required.");return e>=a.SIXTY_FOUR_KILOBYTES?new Uint32Array(t):new Uint16Array(t)},createTypedArrayFromArrayBuffer:function(e,t,r,i){if(!n(e))throw new o("numberOfVertices is required.");if(!n(t))throw new o("sourceArray is required.");if(!n(r))throw new o("byteOffset is required.");return e>=a.SIXTY_FOUR_KILOBYTES?new Uint32Array(t,r,i):new Uint16Array(t,r,i)}};return e(r)}),define("Core/Intersections2D",["./Cartesian3","./defined","./DeveloperError"],function(y,b,C){"use strict";var e={clipTriangleAtAxisAlignedThreshold:function(e,t,r,i,n,o){if(!b(e))throw new C("threshold is required.");if(!b(t))throw new C("keepAbove is required.");if(!b(r))throw new C("u0 is required.");if(!b(i))throw new C("u1 is required.");if(!b(n))throw new C("u2 is required.");var a,s,l;b(o)?o.length=0:o=[],l=t?(a=r<e,s=i<e,n<e):(a=e<r,s=e<i,e<n);var u,c,d,h,p,f,m=a+s+l;return 1===m?a?(u=(e-r)/(i-r),c=(e-r)/(n-r),o.push(1),o.push(2),1!==c&&(o.push(-1),o.push(0),o.push(2),o.push(c)),1!==u&&(o.push(-1),o.push(0),o.push(1),o.push(u))):s?(d=(e-i)/(n-i),h=(e-i)/(r-i),o.push(2),o.push(0),1!==h&&(o.push(-1),o.push(1),o.push(0),o.push(h)),1!==d&&(o.push(-1),o.push(1),o.push(2),o.push(d))):l&&(p=(e-n)/(r-n),f=(e-n)/(i-n),o.push(0),o.push(1),1!==f&&(o.push(-1),o.push(2),o.push(1),o.push(f)),1!==p&&(o.push(-1),o.push(2),o.push(0),o.push(p))):2===m?a||r===e?s||i===e?l||n===e||(c=(e-r)/(n-r),d=(e-i)/(n-i),o.push(2),o.push(-1),o.push(0),o.push(2),o.push(c),o.push(-1),o.push(1),o.push(2),o.push(d)):(f=(e-n)/(i-n),u=(e-r)/(i-r),o.push(1),o.push(-1),o.push(2),o.push(1),o.push(f),o.push(-1),o.push(0),o.push(1),o.push(u)):(h=(e-i)/(r-i),p=(e-n)/(r-n),o.push(0),o.push(-1),o.push(1),o.push(0),o.push(h),o.push(-1),o.push(2),o.push(0),o.push(p)):3!==m&&(o.push(0),o.push(1),o.push(2)),o},computeBarycentricCoordinates:function(e,t,r,i,n,o,a,s,l){if(!b(e))throw new C("x is required.");if(!b(t))throw new C("y is required.");if(!b(r))throw new C("x1 is required.");if(!b(i))throw new C("y1 is required.");if(!b(n))throw new C("x2 is required.");if(!b(o))throw new C("y2 is required.");if(!b(a))throw new C("x3 is required.");if(!b(s))throw new C("y3 is required.");var u=r-a,c=a-n,d=o-s,h=i-s,p=1/(d*u+c*h),f=t-s,m=e-a,g=(d*m+c*f)*p,_=(-h*m+u*f)*p,v=1-g-_;return b(l)?(l.x=g,l.y=_,l.z=v,l):new y(g,_,v)}};return e}),define("Core/QuantizedMeshTerrainData",["../ThirdParty/when","./BoundingSphere","./Cartesian2","./Cartesian3","./defaultValue","./defined","./defineProperties","./DeveloperError","./IndexDatatype","./Intersections2D","./Math","./OrientedBoundingBox","./TaskProcessor","./TerrainEncoding","./TerrainMesh"],function(v,y,e,b,f,C,t,w,S,T,E,A,r,m,g){"use strict";function x(e){if(!C(e)||!C(e.quantizedVertices))throw new w("options.quantizedVertices is required.");if(!C(e.indices))throw new w("options.indices is required.");if(!C(e.minimumHeight))throw new w("options.minimumHeight is required.");if(!C(e.maximumHeight))throw new w("options.maximumHeight is required.");if(!C(e.maximumHeight))throw new w("options.maximumHeight is required.");if(!C(e.boundingSphere))throw new w("options.boundingSphere is required.");if(!C(e.horizonOcclusionPoint))throw new w("options.horizonOcclusionPoint is required.");if(!C(e.westIndices))throw new w("options.westIndices is required.");if(!C(e.southIndices))throw new w("options.southIndices is required.");if(!C(e.eastIndices))throw new w("options.eastIndices is required.");if(!C(e.northIndices))throw new w("options.northIndices is required.");if(!C(e.westSkirtHeight))throw new w("options.westSkirtHeight is required.");if(!C(e.southSkirtHeight))throw new w("options.southSkirtHeight is required.");if(!C(e.eastSkirtHeight))throw new w("options.eastSkirtHeight is required.");if(!C(e.northSkirtHeight))throw new w("options.northSkirtHeight is required.");this._quantizedVertices=e.quantizedVertices,this._encodedNormals=e.encodedNormals,this._indices=e.indices,this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._boundingSphere=e.boundingSphere,this._orientedBoundingBox=e.orientedBoundingBox,this._horizonOcclusionPoint=e.horizonOcclusionPoint,this._credits=e.credits;var t=this._quantizedVertices.length/3,r=this._uValues=this._quantizedVertices.subarray(0,t),i=this._vValues=this._quantizedVertices.subarray(t,2*t);function n(e,t){return i[e]-i[t]}function o(e,t){return r[e]-r[t]}this._heightValues=this._quantizedVertices.subarray(2*t,3*t),this._westIndices=s(e.westIndices,n,t),this._southIndices=s(e.southIndices,o,t),this._eastIndices=s(e.eastIndices,n,t),this._northIndices=s(e.northIndices,o,t),this._westSkirtHeight=e.westSkirtHeight,this._southSkirtHeight=e.southSkirtHeight,this._eastSkirtHeight=e.eastSkirtHeight,this._northSkirtHeight=e.northSkirtHeight,this._childTileMask=f(e.childTileMask,15),this._createdByUpsampling=f(e.createdByUpsampling,!1),this._waterMask=e.waterMask,this._mesh=void 0}t(x.prototype,{credits:{get:function(){return this._credits}},waterMask:{get:function(){return this._waterMask}}});var a=[];function s(e,t,r){a.length=e.length;for(var i=!1,n=0,o=e.length;n<o;++n)a[n]=e[n],i=i||0<n&&0<t(e[n-1],e[n]);return i?(a.sort(t),S.createTypedArray(r,a)):e}var l=new r("createVerticesFromQuantizedTerrainMesh");x.prototype.createMesh=function(e,t,r,i,h){if(!C(e))throw new w("tilingScheme is required.");if(!C(t))throw new w("x is required.");if(!C(r))throw new w("y is required.");if(!C(i))throw new w("level is required.");var n=e.ellipsoid,o=e.tileXYToRectangle(t,r,i);h=f(h,1);var a=l.scheduleTask({minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,quantizedVertices:this._quantizedVertices,octEncodedNormals:this._encodedNormals,includeWebMercatorT:!0,indices:this._indices,westIndices:this._westIndices,southIndices:this._southIndices,eastIndices:this._eastIndices,northIndices:this._northIndices,westSkirtHeight:this._westSkirtHeight,southSkirtHeight:this._southSkirtHeight,eastSkirtHeight:this._eastSkirtHeight,northSkirtHeight:this._northSkirtHeight,rectangle:o,relativeToCenter:this._boundingSphere.center,ellipsoid:n,exaggeration:h});if(C(a)){var p=this;return v(a,function(e){var t=p._quantizedVertices.length/3;t+=p._westIndices.length+p._southIndices.length+p._eastIndices.length+p._northIndices.length;var r=S.createTypedArray(t,e.indices),i=new Float32Array(e.vertices),n=e.center,o=e.minimumHeight,a=e.maximumHeight,s=f(e.boundingSphere,p._boundingSphere),l=f(e.orientedBoundingBox,p._orientedBoundingBox),u=p._horizonOcclusionPoint,c=e.vertexStride,d=m.clone(e.encoding);return p._skirtIndex=e.skirtIndex,p._vertexCountWithoutSkirts=p._quantizedVertices.length/3,p._mesh=new g(n,i,r,o,a,s,u,c,l,d,h),p._quantizedVertices=void 0,p._encodedNormals=void 0,p._indices=void 0,p._uValues=void 0,p._vValues=void 0,p._heightValues=void 0,p._westIndices=void 0,p._southIndices=void 0,p._eastIndices=void 0,p._northIndices=void 0,p._mesh})}};var P=new r("upsampleQuantizedTerrainMesh");x.prototype.upsample=function(e,t,r,i,n,o,a){if(!C(e))throw new w("tilingScheme is required.");if(!C(t))throw new w("thisX is required.");if(!C(r))throw new w("thisY is required.");if(!C(i))throw new w("thisLevel is required.");if(!C(n))throw new w("descendantX is required.");if(!C(o))throw new w("descendantY is required.");if(!C(a))throw new w("descendantLevel is required.");if(1<a-i)throw new w("Upsampling through more than one level at a time is not currently supported.");var s=this._mesh;if(C(this._mesh)){var l=2*t!==n,u=2*r===o,c=e.ellipsoid,d=e.tileXYToRectangle(n,o,a),h=P.scheduleTask({vertices:s.vertices,vertexCountWithoutSkirts:this._vertexCountWithoutSkirts,indices:s.indices,skirtIndex:this._skirtIndex,encoding:s.encoding,minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,isEastChild:l,isNorthChild:u,childRectangle:d,ellipsoid:c,exaggeration:s.exaggeration});if(C(h)){var p=Math.min(this._westSkirtHeight,this._eastSkirtHeight);p=Math.min(p,this._southSkirtHeight),p=Math.min(p,this._northSkirtHeight);var f=l?.5*p:this._westSkirtHeight,m=u?.5*p:this._southSkirtHeight,g=l?this._eastSkirtHeight:.5*p,_=u?this._northSkirtHeight:.5*p;return v(h,function(e){var t,r=new Uint16Array(e.vertices),i=S.createTypedArray(r.length/3,e.indices);return C(e.encodedNormals)&&(t=new Uint8Array(e.encodedNormals)),new x({quantizedVertices:r,indices:i,encodedNormals:t,minimumHeight:e.minimumHeight,maximumHeight:e.maximumHeight,boundingSphere:y.clone(e.boundingSphere),orientedBoundingBox:A.clone(e.orientedBoundingBox),horizonOcclusionPoint:b.clone(e.horizonOcclusionPoint),westIndices:e.westIndices,southIndices:e.southIndices,eastIndices:e.eastIndices,northIndices:e.northIndices,westSkirtHeight:f,southSkirtHeight:m,eastSkirtHeight:g,northSkirtHeight:_,childTileMask:0,createdByUpsampling:!0})})}}};var D=new b;x.prototype.interpolateHeight=function(e,t,r){var i=E.clamp((t-e.west)/e.width,0,1);i*=32767;var n=E.clamp((r-e.south)/e.height,0,1);return n*=32767,C(this._mesh)?function(e,t,r){for(var i=e._mesh,n=i.vertices,o=i.encoding,a=i.indices,s=0,l=a.length;s<l;s+=3){var u=a[s],c=a[s+1],d=a[s+2],h=o.decodeTextureCoordinates(n,u,O),p=o.decodeTextureCoordinates(n,c,I),f=o.decodeTextureCoordinates(n,d,M),m=T.computeBarycentricCoordinates(t,r,h.x,h.y,p.x,p.y,f.x,f.y,D);if(-1e-15<=m.x&&-1e-15<=m.y&&-1e-15<=m.z){var g=o.decodeHeight(n,u),_=o.decodeHeight(n,c),v=o.decodeHeight(n,d);return m.x*g+m.y*_+m.z*v}}return}(this,i,n):function(e,t,r){for(var i=e._uValues,n=e._vValues,o=e._heightValues,a=e._indices,s=0,l=a.length;s<l;s+=3){var u=a[s],c=a[s+1],d=a[s+2],h=i[u],p=i[c],f=i[d],m=n[u],g=n[c],_=n[d],v=T.computeBarycentricCoordinates(t,r,h,m,p,g,f,_,D);if(-1e-15<=v.x&&-1e-15<=v.y&&-1e-15<=v.z){var y=v.x*o[u]+v.y*o[c]+v.z*o[d];return E.lerp(e._minimumHeight,e._maximumHeight,y/32767)}}return}(this,i,n)};var O=new e,I=new e,M=new e;return x.prototype.isChildAvailable=function(e,t,r,i){if(!C(e))throw new w("thisX is required.");if(!C(t))throw new w("thisY is required.");if(!C(r))throw new w("childX is required.");if(!C(i))throw new w("childY is required.");var n=2;return r!==2*e&&++n,i!==2*t&&(n-=2),0!=(this._childTileMask&1<<n)},x.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling},x}),define("Core/TileAvailability",["./binarySearch","./Cartographic","./defined","./defineProperties","./DeveloperError","./Rectangle"],function(n,e,o,t,a,s){"use strict";function r(e,t){this._tilingScheme=e,this._maximumLevel=t,this._rootNodes=[];for(var r=0;r<e.getNumberOfYTilesAtLevel();++r)for(var i=0;i<e.getNumberOfXTilesAtLevel();++i)this._rootNodes.push(new f(e,void 0,0,i,r))}var h=new s;r.prototype.addAvailableTileRange=function(e,t,r,i,n){var o=this._tilingScheme;o.tileXYToRectangle(t,r,e,h);var a=h.west,s=h.north;o.tileXYToRectangle(i,n,e,h);for(var l=h.east,u=new m(e,a,h.south,l,s),c=0;c<this._rootNodes.length;++c){var d=this._rootNodes[c];g(d.extent,u)&&_(this._maximumLevel,d,u)}},r.prototype.computeMaximumLevelAtPosition=function(e){for(var t,r=0;r<this._rootNodes.length;++r){var i=this._rootNodes[r];if(b(i.extent,e)){t=i;break}}if(!o(t))throw new a("The specified position does not exist in any root node of the tiling scheme.");return function e(t,r,i){var n=0;var o=!1;for(;!o;){var a=r._nw&&b(r._nw.extent,i),s=r._ne&&b(r._ne.extent,i),l=r._sw&&b(r._sw.extent,i),u=r._se&&b(r._se.extent,i);if(1<a+s+l+u){a&&(n=Math.max(n,e(r,r._nw,i))),s&&(n=Math.max(n,e(r,r._ne,i))),l&&(n=Math.max(n,e(r,r._sw,i))),u&&(n=Math.max(n,e(r,r._se,i)));break}a?r=r._nw:s?r=r._ne:l?r=r._sw:u?r=r._se:o=!0}for(;r!==t;){for(var c=r.rectangles,d=c.length-1;0<=d&&c[d].level>n;--d){var h=c[d];b(h,i)&&(n=h.level)}r=r.parent}return n}(void 0,t,e)};var l=[],u=[],c=new s,d=new s;r.prototype.computeBestAvailableLevelOverRectangle=function(e){var t=l;t.length=0,e.east<e.west?(t.push(s.fromRadians(-Math.PI,e.south,e.east,e.north,c)),t.push(s.fromRadians(e.west,e.south,Math.PI,e.north,d))):t.push(e);var r,i=u;for(r=i.length=0;r<this._rootNodes.length;++r)C(i,this._rootNodes[r],t);for(r=i.length-1;0<=r;--r)if(o(i[r])&&0===i[r].length)return r;return 0};var p=new e;function f(e,t,r,i,n){this.tilingScheme=e,this.parent=t,this.level=r,this.x=i,this.y=n,this.extent=e.tileXYToRectangle(i,n,r),this.rectangles=[],this._sw=void 0,this._se=void 0,this._nw=void 0,this._ne=void 0}function m(e,t,r,i,n){this.level=e,this.west=t,this.south=r,this.east=i,this.north=n}function g(e,t){var r=Math.max(e.west,t.west),i=Math.max(e.south,t.south),n=Math.min(e.east,t.east);return i<Math.min(e.north,t.north)&&r<n}function _(e,t,r){for(;t.level<e;)if(y(t.nw.extent,r))t=t.nw;else if(y(t.ne.extent,r))t=t.ne;else if(y(t.sw.extent,r))t=t.sw;else{if(!y(t.se.extent,r))break;t=t.se}if(0===t.rectangles.length||t.rectangles[t.rectangles.length-1].level<=r.level)t.rectangles.push(r);else{var i=n(t.rectangles,r.level,v);i<=0&&(i=~i),t.rectangles.splice(i,0,r)}}function v(e,t){return e.level-t}function y(e,t){return t.west>=e.west&&t.east<=e.east&&t.south>=e.south&&t.north<=e.north}function b(e,t){return t.longitude>=e.west&&t.longitude<=e.east&&t.latitude>=e.south&&t.latitude<=e.north}function C(e,t,r){if(t){var i,n=!1;for(i=0;i<r.length;++i)n=n||g(t.extent,r[i]);if(n){var o=t.rectangles;for(i=0;i<o.length;++i){var a=o[i];e[a.level]||(e[a.level]=r),e[a.level]=w(e[a.level],a)}C(e,t._nw,r),C(e,t._ne,r),C(e,t._sw,r),C(e,t._se,r)}}}function w(e,t){for(var r=[],i=0;i<e.length;++i){var n=e[i];g(n,t)?(n.west<t.west&&r.push(new s(n.west,n.south,t.west,n.north)),n.east>t.east&&r.push(new s(t.east,n.south,n.east,n.north)),n.south<t.south&&r.push(new s(Math.max(t.west,n.west),n.south,Math.min(t.east,n.east),t.south)),n.north>t.north&&r.push(new s(Math.max(t.west,n.west),t.north,Math.min(t.east,n.east),n.north))):r.push(n)}return r}return r.prototype.isTileAvailable=function(e,t,r){var i=this._tilingScheme.tileXYToRectangle(t,r,e,h);return s.center(i,p),this.computeMaximumLevelAtPosition(p)>=e},r.prototype.computeChildMaskForTile=function(e,t,r){var i=e+1;if(i>=this._maximumLevel)return 0;var n=0;return n|=this.isTileAvailable(i,2*t,2*r+1)?1:0,n|=this.isTileAvailable(i,2*t+1,2*r+1)?2:0,n|=this.isTileAvailable(i,2*t,2*r)?4:0,n|=this.isTileAvailable(i,2*t+1,2*r)?8:0},t(f.prototype,{nw:{get:function(){return this._nw||(this._nw=new f(this.tilingScheme,this,this.level+1,2*this.x,2*this.y)),this._nw}},ne:{get:function(){return this._ne||(this._ne=new f(this.tilingScheme,this,this.level+1,2*this.x+1,2*this.y)),this._ne}},sw:{get:function(){return this._sw||(this._sw=new f(this.tilingScheme,this,this.level+1,2*this.x,2*this.y+1)),this._sw}},se:{get:function(){return this._se||(this._se=new f(this.tilingScheme,this,this.level+1,2*this.x+1,2*this.y+1)),this._se}}}),r}),define("Core/formatError",["./defined"],function(o){"use strict";return function(e){var t,r=e.name,i=e.message;t=o(r)&&o(i)?r+": "+i:e.toString();var n=e.stack;return o(n)&&(t+="\n"+n),t}}),define("Core/TileProviderError",["./defaultValue","./defined","./formatError"],function(s,c,d){"use strict";function h(e,t,r,i,n,o,a){this.provider=e,this.message=t,this.x=r,this.y=i,this.level=n,this.timesRetried=s(o,0),this.retry=!1,this.error=a}return h.handleError=function(e,t,r,i,n,o,a,s,l){var u=e;return c(e)?(u.provider=t,u.message=i,u.x=n,u.y=o,u.level=a,u.retry=!1,u.error=l,++u.timesRetried):u=new h(t,i,n,o,a,0,l),0<r.numberOfListeners?r.raiseEvent(u):console.log('An error occurred in "'+t.constructor.name+'": '+d(i)),u.retry&&c(s)&&s(),u},h.handleSuccess=function(e){c(e)&&(e.timesRetried=-1)},h}),define("Core/CesiumTerrainProvider",["../ThirdParty/Uri","../ThirdParty/when","./AttributeCompression","./BoundingSphere","./Cartesian3","./Credit","./defaultValue","./defined","./defineProperties","./deprecationWarning","./DeveloperError","./Event","./GeographicTilingScheme","./HeightmapTerrainData","./IndexDatatype","./Math","./OrientedBoundingBox","./QuantizedMeshTerrainData","./Resource","./RuntimeError","./TerrainProvider","./TileAvailability","./TileProviderError"],function(e,P,H,j,Y,a,o,D,t,s,m,l,u,g,X,Q,Z,K,c,_,d,O,I){"use strict";function M(e){this.resource=e.resource,this.version=e.version,this.isHeightmap=e.isHeightmap,this.tileUrlTemplates=e.tileUrlTemplates,this.availability=e.availability,this.hasVertexNormals=e.hasVertexNormals,this.hasWaterMask=e.hasWaterMask,this.littleEndianExtensionSize=e.littleEndianExtensionSize}function r(e){if(!D(e)||!D(e.url))throw new m("options.url is required.");D(e.proxy)&&s("CesiumTerrainProvider.proxy","The options.proxy parameter has been deprecated. Specify options.url as a Resource instance and set the proxy property there.");var t=c.createIfNeeded(e.url,{proxy:e.proxy});t.appendForwardSlash(),this._tilingScheme=new u({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:1,ellipsoid:e.ellipsoid}),this._heightmapWidth=65,this._levelZeroMaximumGeometricError=d.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,this._heightmapWidth,this._tilingScheme.getNumberOfXTilesAtLevel(0)),this._heightmapStructure=void 0,this._hasWaterMask=!1,this._hasVertexNormals=!1,this._requestVertexNormals=o(e.requestVertexNormals,!1),this._requestWaterMask=o(e.requestWaterMask,!1),this._errorEvent=new l;var r=e.credit;"string"==typeof r&&(r=new a({text:r})),this._credit=r,this._availability=void 0,this._ready=!1,this._readyPromise=P.defer();var v,y=t,b=y.getDerivedResource({url:"layer.json"}),C=this,w=this._layers=[],S="",T=[];function E(e){var t;if(!e.format)return t="The tile format is not specified in the layer.json file.",void(v=I.handleError(v,C,C._errorEvent,t,void 0,void 0,void 0,x));if(!e.tiles||0===e.tiles.length)return t="The layer.json file does not specify any tile URL templates.",void(v=I.handleError(v,C,C._errorEvent,t,void 0,void 0,void 0,x));var r=!1,i=!1,n=!0,o=!1;if("heightmap-1.0"===e.format)o=!0,D(C._heightmapStructure)||(C._heightmapStructure={heightScale:.2,heightOffset:-1e3,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:!1,lowestEncodedHeight:0,highestEncodedHeight:65535}),i=!0,C._requestWaterMask=!0;else if(0!==e.format.indexOf("quantized-mesh-1."))return t='The tile format "'+e.format+'" is invalid or not supported.',void(v=I.handleError(v,C,C._errorEvent,t,void 0,void 0,void 0,x));var a,s=e.tiles,l=e.available;if(D(l)){a=new O(C._tilingScheme,l.length);for(var u=0;u<l.length;++u){var c=l[u],d=C._tilingScheme.getNumberOfYTilesAtLevel(u);D(T[u])||(T[u]=[]);for(var h=0;h<c.length;++h){var p=c[h],f=d-p.endY-1,m=d-p.startY-1;T[u].push([p.startX,f,p.endX,m]),a.addAvailableTileRange(u,p.startX,f,p.endX,m)}}}D(e.extensions)&&-1!==e.extensions.indexOf("octvertexnormals")?r=!0:D(e.extensions)&&-1!==e.extensions.indexOf("vertexnormals")&&(n=!(r=!0)),D(e.extensions)&&-1!==e.extensions.indexOf("watermask")&&(i=!0),C._hasWaterMask=C._hasWaterMask||i,C._hasVertexNormals=C._hasVertexNormals||r,D(e.attribution)&&(0<S.length&&(S+=" "),S+=e.attribution),w.push(new M({resource:y,version:e.version,isHeightmap:o,tileUrlTemplates:s,availability:a,hasVertexNormals:r,hasWaterMask:i,littleEndianExtensionSize:n}));var g=e.parentUrl;if(D(g)){if(!D(a))return console.log("A layer.json can't have a parentUrl if it does't have an available array."),P.resolve();(y=y.getDerivedResource({url:g})).appendForwardSlash();var _=(b=y.getDerivedResource({url:"layer.json"})).fetchJson();return P(_,E,A)}return P.resolve()}function A(e){var t="An error occurred while accessing "+b.url+".";v=I.handleError(v,C,C._errorEvent,t,void 0,void 0,void 0,x)}function i(e){E(e).then(function(){if(!D(v)){var e=T.length;if(0<e)for(var t=C._availability=new O(C._tilingScheme,e),r=0;r<e;++r)for(var i=T[r],n=0;n<i.length;++n){var o=i[n];t.addAvailableTileRange(r,o[0],o[1],o[2],o[3])}!D(C._credit)&&0<S.length&&(C._credit=new a({text:S})),C._ready=!0,C._readyPromise.resolve(!0)}})}function n(e){D(e)&&404===e.statusCode?i({tilejson:"2.1.0",format:"heightmap-1.0",version:"1.0.0",scheme:"tms",tiles:["{z}/{x}/{y}.terrain?v={version}"]}):A()}function x(){var e=b.fetchJson();P(e,i,n)}x()}var J=1,$=2;return r.prototype.requestTileGeometry=function(n,o,a,e){if(!this._ready)throw new m("requestTileGeometry must not be called before the terrain provider is ready.");var s,t=this._layers,r=t.length;if(1===r)s=t[0];else for(var i=0;i<r;++i){var l=t[i];if(!D(l.availability)||l.availability.isTileAvailable(a,n,o)){s=l;break}}if(!D(s))return P.reject(new _("Terrain tile doesn't exist"));var u=s.tileUrlTemplates;if(0!==u.length){var c=this._tilingScheme.getNumberOfYTilesAtLevel(a)-o-1,d=[];this._requestVertexNormals&&s.hasVertexNormals&&d.push(s.littleEndianExtensionSize?"octvertexnormals":"vertexnormals"),this._requestWaterMask&&s.hasWaterMask&&d.push("watermask");var h,p=s.resource.getDerivedResource({url:u[(n+c+a)%u.length],templateValues:{version:s.version,z:a,x:n,y:c},headers:(h=d,D(h)&&0!==h.length?{Accept:"application/vnd.quantized-mesh;extensions="+h.join("-")+",application/octet-stream;q=0.9,*/*;q=0.01"}:{Accept:"application/vnd.quantized-mesh,application/octet-stream;q=0.9,*/*;q=0.01"}),request:e}).fetchArrayBuffer();if(D(p)){var f=this;return P(p,function(e){return D(f._heightmapStructure)?(t=f,r=e,i=new Uint16Array(r,0,t._heightmapWidth*t._heightmapWidth),new g({buffer:i,childTileMask:new Uint8Array(r,i.byteLength,1)[0],waterMask:new Uint8Array(r,i.byteLength+1,r.byteLength-i.byteLength-1),width:t._heightmapWidth,height:t._heightmapWidth,structure:t._heightmapStructure})):function(e,t,r,i,n,o,a){var s=0,l=3*Float64Array.BYTES_PER_ELEMENT,u=4*Float64Array.BYTES_PER_ELEMENT,c=3*Uint16Array.BYTES_PER_ELEMENT,d=Uint16Array.BYTES_PER_ELEMENT,h=3*d,p=new DataView(t),f=new Y(p.getFloat64(s,!0),p.getFloat64(s+8,!0),p.getFloat64(s+16,!0));s+=l;var m=p.getFloat32(s,!0);s+=Float32Array.BYTES_PER_ELEMENT;var g=p.getFloat32(s,!0);s+=Float32Array.BYTES_PER_ELEMENT;var _=new j(new Y(p.getFloat64(s,!0),p.getFloat64(s+8,!0),p.getFloat64(s+16,!0)),p.getFloat64(s+l,!0));s+=u;var v=new Y(p.getFloat64(s,!0),p.getFloat64(s+8,!0),p.getFloat64(s+16,!0));s+=l;var y=p.getUint32(s,!0);s+=Uint32Array.BYTES_PER_ELEMENT;var b=new Uint16Array(t,s,3*y);s+=y*c,65536<y&&(h=3*(d=Uint32Array.BYTES_PER_ELEMENT));var C=b.subarray(0,y),w=b.subarray(y,2*y),S=b.subarray(2*y,3*y);H.zigZagDeltaDecode(C,w,S),s%d!=0&&(s+=d-s%d);var T=p.getUint32(s,!0);s+=Uint32Array.BYTES_PER_ELEMENT;var E=X.createTypedArrayFromArrayBuffer(y,t,s,3*T);s+=T*h;for(var A=0,x=E.length,P=0;P<x;++P){var D=E[P];E[P]=A-D,0===D&&++A}var O=p.getUint32(s,!0);s+=Uint32Array.BYTES_PER_ELEMENT;var I=X.createTypedArrayFromArrayBuffer(y,t,s,O);s+=O*d;var M=p.getUint32(s,!0);s+=Uint32Array.BYTES_PER_ELEMENT;var R=X.createTypedArrayFromArrayBuffer(y,t,s,M);s+=M*d;var L=p.getUint32(s,!0);s+=Uint32Array.BYTES_PER_ELEMENT;var N=X.createTypedArrayFromArrayBuffer(y,t,s,L);s+=L*d;var k=p.getUint32(s,!0);s+=Uint32Array.BYTES_PER_ELEMENT;var F,B,U=X.createTypedArrayFromArrayBuffer(y,t,s,k);for(s+=k*d;s<p.byteLength;){var V=p.getUint8(s,!0);s+=Uint8Array.BYTES_PER_ELEMENT;var z=p.getUint32(s,a);s+=Uint32Array.BYTES_PER_ELEMENT,V===J&&e._requestVertexNormals?F=new Uint8Array(t,s,2*y):V===$&&e._requestWaterMask&&(B=new Uint8Array(t,s,z)),s+=z}var q,G=5*e.getLevelMaximumGeometricError(r),W=e._tilingScheme.tileXYToRectangle(i,n,r);return W.width<Q.PI_OVER_TWO+Q.EPSILON5&&(q=Z.fromRectangle(W,m,g,e._tilingScheme.ellipsoid)),new K({center:f,minimumHeight:m,maximumHeight:g,boundingSphere:_,orientedBoundingBox:q,horizonOcclusionPoint:v,quantizedVertices:b,encodedNormals:F,indices:E,westIndices:I,southIndices:R,eastIndices:N,northIndices:U,westSkirtHeight:G,southSkirtHeight:G,eastSkirtHeight:G,northSkirtHeight:G,childTileMask:e.availability.computeChildMaskForTile(r,i,n),waterMask:B})}(f,e,a,n,o,0,s.littleEndianExtensionSize);var t,r,i})}}},t(r.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){if(!this._ready)throw new m("credit must not be called before the terrain provider is ready.");return this._credit}},tilingScheme:{get:function(){if(!this._ready)throw new m("tilingScheme must not be called before the terrain provider is ready.");return this._tilingScheme}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},hasWaterMask:{get:function(){if(!this._ready)throw new m("hasWaterMask must not be called before the terrain provider is ready.");return this._hasWaterMask&&this._requestWaterMask}},hasVertexNormals:{get:function(){if(!this._ready)throw new m("hasVertexNormals must not be called before the terrain provider is ready.");return this._hasVertexNormals&&this._requestVertexNormals}},requestVertexNormals:{get:function(){return this._requestVertexNormals}},requestWaterMask:{get:function(){return this._requestWaterMask}},availability:{get:function(){if(!this._ready)throw new m("availability must not be called before the terrain provider is ready.");return this._availability}}}),r.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)},r.prototype.getTileDataAvailable=function(e,t,r){if(D(this._availability))return this._availability.isTileAvailable(r,e,t)},r}),define("Core/EllipseGeometryLibrary",["./Cartesian3","./Math","./Matrix3","./Quaternion"],function(M,R,f,m){"use strict";var e={},g=new M,_=new M,v=new m,y=new f;function L(e,t,r,i,n,o,a,s,l,u){var c=e+t;M.multiplyByScalar(i,Math.cos(c),g),M.multiplyByScalar(r,Math.sin(c),_),M.add(g,_,g);var d=Math.cos(e);d*=d;var h=Math.sin(e);h*=h;var p=o/Math.sqrt(a*d+n*h)/s;return m.fromAxisAngle(g,p,v),f.fromQuaternion(v,y),f.multiplyByVector(y,l,u),M.normalize(u,u),M.multiplyByScalar(u,s,u),u}var N=new M,k=new M,F=new M,b=new M;e.raisePositionsToHeight=function(e,t,r){for(var i=t.ellipsoid,n=t.height,o=t.extrudedHeight,a=r?e.length/3*2:e.length/3,s=new Float64Array(3*a),l=e.length,u=r?l:0,c=0;c<l;c+=3){var d=c+1,h=c+2,p=M.fromArray(e,c,N);i.scaleToGeodeticSurface(p,p);var f=M.clone(p,k),m=i.geodeticSurfaceNormal(p,b),g=M.multiplyByScalar(m,n,F);M.add(p,g,p),r&&(M.multiplyByScalar(m,o,g),M.add(f,g,f),s[c+u]=f.x,s[d+u]=f.y,s[h+u]=f.z),s[c]=p.x,s[d]=p.y,s[h]=p.z}return s};var B=new M,U=new M,V=new M;return e.computeEllipsePositions=function(e,t,r){var i=e.semiMinorAxis,n=e.semiMajorAxis,o=e.rotation,a=e.center,s=8*e.granularity,l=i*i,u=n*n,c=n*i,d=M.magnitude(a),h=M.normalize(a,B),p=M.cross(M.UNIT_Z,a,U);p=M.normalize(p,p);var f=M.cross(h,p,V),m=1+Math.ceil(R.PI_OVER_TWO/s),g=R.PI_OVER_TWO/(m-1),_=R.PI_OVER_TWO-m*g;_<0&&(m-=Math.ceil(Math.abs(_)/g));var v,y,b,C,w,S=t?new Array(3*(m*(m+2)*2)):void 0,T=0,E=N,A=k,x=4*m*3,P=x-1,D=0,O=r?new Array(x):void 0;for(E=L(_=R.PI_OVER_TWO,o,f,p,l,c,u,d,h,E),t&&(S[T++]=E.x,S[T++]=E.y,S[T++]=E.z),r&&(O[P--]=E.z,O[P--]=E.y,O[P--]=E.x),_=R.PI_OVER_TWO-g,v=1;v<m+1;++v){if(E=L(_,o,f,p,l,c,u,d,h,E),A=L(Math.PI-_,o,f,p,l,c,u,d,h,A),t){for(S[T++]=E.x,S[T++]=E.y,S[T++]=E.z,b=2*v+2,y=1;y<b-1;++y)C=y/(b-1),w=M.lerp(E,A,C,F),S[T++]=w.x,S[T++]=w.y,S[T++]=w.z;S[T++]=A.x,S[T++]=A.y,S[T++]=A.z}r&&(O[P--]=E.z,O[P--]=E.y,O[P--]=E.x,O[D++]=A.x,O[D++]=A.y,O[D++]=A.z),_=R.PI_OVER_TWO-(v+1)*g}for(v=m;1<v;--v){if(E=L(-(_=R.PI_OVER_TWO-(v-1)*g),o,f,p,l,c,u,d,h,E),A=L(_+Math.PI,o,f,p,l,c,u,d,h,A),t){for(S[T++]=E.x,S[T++]=E.y,S[T++]=E.z,b=2*(v-1)+2,y=1;y<b-1;++y)C=y/(b-1),w=M.lerp(E,A,C,F),S[T++]=w.x,S[T++]=w.y,S[T++]=w.z;S[T++]=A.x,S[T++]=A.y,S[T++]=A.z}r&&(O[P--]=E.z,O[P--]=E.y,O[P--]=E.x,O[D++]=A.x,O[D++]=A.y,O[D++]=A.z)}E=L(-(_=R.PI_OVER_TWO),o,f,p,l,c,u,d,h,E);var I={};return t&&(S[T++]=E.x,S[T++]=E.y,S[T++]=E.z,I.positions=S,I.numPts=m),r&&(O[P--]=E.z,O[P--]=E.y,O[P--]=E.x,I.outerPositions=O),I},e}),define("Core/GeometryInstance",["./defaultValue","./defined","./DeveloperError","./Matrix4"],function(t,r,i,n){"use strict";return function(e){if(e=t(e,t.EMPTY_OBJECT),!r(e.geometry))throw new i("options.geometry is required.");this.geometry=e.geometry,this.modelMatrix=n.clone(t(e.modelMatrix,n.IDENTITY)),this.id=e.id,this.pickPrimitive=e.pickPrimitive,this.attributes=t(e.attributes,{}),this.westHemisphereGeometry=void 0,this.eastHemisphereGeometry=void 0}}),define("Core/EncodedCartesian3",["./Cartesian3","./Check","./defined"],function(e,o,n){"use strict";function a(){this.high=e.clone(e.ZERO),this.low=e.clone(e.ZERO)}a.encode=function(e,t){var r;return o.typeOf.number("value",e),n(t)||(t={high:0,low:0}),t.low=0<=e?(r=65536*Math.floor(e/65536),e-(t.high=r)):(r=65536*Math.floor(-e/65536),t.high=-r,e+r),t};var s={high:0,low:0};a.fromCartesian=function(e,t){o.typeOf.object("cartesian",e),n(t)||(t=new a);var r=t.high,i=t.low;return a.encode(e.x,s),r.x=s.high,i.x=s.low,a.encode(e.y,s),r.y=s.high,i.y=s.low,a.encode(e.z,s),r.z=s.high,i.z=s.low,t};var l=new a;return a.writeElements=function(e,t,r){o.defined("cartesianArray",t),o.typeOf.number("index",r),o.typeOf.number.greaterThanOrEquals("index",r,0),a.fromCartesian(e,l);var i=l.high,n=l.low;t[r]=i.x,t[r+1]=i.y,t[r+2]=i.z,t[r+3]=n.x,t[r+4]=n.y,t[r+5]=n.z},a}),define("Core/Tipsify",["./defaultValue","./defined","./DeveloperError"],function(P,D,O){"use strict";var e={calculateACMR:function(e){var t=(e=P(e,P.EMPTY_OBJECT)).indices,r=e.maximumIndex,i=P(e.cacheSize,24);if(!D(t))throw new O("indices is required.");var n=t.length;if(n<3||n%3!=0)throw new O("indices length must be a multiple of three.");if(r<=0)throw new O("maximumIndex must be greater than zero.");if(i<3)throw new O("cacheSize must be greater than two.");if(!D(r))for(var o=r=0,a=t[o];o<n;)r<a&&(r=a),a=t[++o];for(var s=[],l=0;l<r+1;l++)s[l]=0;for(var u=i+1,c=0;c<n;++c)u-s[t[c]]>i&&(s[t[c]]=u,++u);return(u-i+1)/(n/3)}};return e.tipsify=function(e){var h,t=(e=P(e,P.EMPTY_OBJECT)).indices,r=e.maximumIndex,i=P(e.cacheSize,24);function n(e,t,r,i,n,o,a){for(var s,l=-1,u=-1,c=0;c<r.length;){var d=r[c];i[d].numLiveTriangles&&(s=0,n-i[d].timeStamp+2*i[d].numLiveTriangles<=t&&(s=n-i[d].timeStamp),(u<s||-1===u)&&(u=s,l=d)),++c}return-1===l?function(e,t,r,i){for(;1<=t.length;){var n=t[t.length-1];if(t.splice(t.length-1,1),0<e[n].numLiveTriangles)return n}for(;h<i;){if(0<e[h].numLiveTriangles)return++h-1;++h}return-1}(i,o,0,a):l}if(!D(t))throw new O("indices is required.");var o=t.length;if(o<3||o%3!=0)throw new O("indices length must be a multiple of three.");if(r<=0)throw new O("maximumIndex must be greater than zero.");if(i<3)throw new O("cacheSize must be greater than two.");var a=0,s=0,l=t[s],u=o;if(D(r))a=r+1;else{for(;s<u;)a<l&&(a=l),l=t[++s];if(-1===a)return 0;++a}var c,d=[];for(c=0;c<a;c++)d[c]={numLiveTriangles:0,timeStamp:0,vertexTriangles:[]};for(var p=s=0;s<u;)d[t[s]].vertexTriangles.push(p),++d[t[s]].numLiveTriangles,d[t[s+1]].vertexTriangles.push(p),++d[t[s+1]].numLiveTriangles,d[t[s+2]].vertexTriangles.push(p),++d[t[s+2]].numLiveTriangles,++p,s+=3;var f=0,m=i+1;h=1;var g,_,v,y,b=[],C=[],w=0,S=[],T=o/3,E=[];for(c=0;c<T;c++)E[c]=!1;for(;-1!==f;){b=[],y=(_=d[f]).vertexTriangles.length;for(var A=0;A<y;++A)if(!E[p=_.vertexTriangles[A]]){E[p]=!0,s=p+p+p;for(var x=0;x<3;++x)v=t[s],b.push(v),C.push(v),S[w]=v,++w,--(g=d[v]).numLiveTriangles,m-g.timeStamp>i&&(g.timeStamp=m,++m),++s}f=n(0,i,b,d,m,C,a)}return S},e}),define("Core/GeometryPipeline",["./AttributeCompression","./barycentricCoordinates","./BoundingSphere","./Cartesian2","./Cartesian3","./Cartesian4","./Cartographic","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./EncodedCartesian3","./GeographicProjection","./Geometry","./GeometryAttribute","./GeometryType","./IndexDatatype","./Intersect","./IntersectionTests","./Math","./Matrix3","./Matrix4","./Plane","./PrimitiveType","./Tipsify"],function(T,k,A,z,q,G,e,N,d,W,F,h,f,x,B,i,P,n,H,j,o,D,a,U,s){"use strict";var t={};function l(e,t,r,i,n){e[t++]=r,e[t++]=i,e[t++]=i,e[t++]=n,e[t++]=n,e[t]=r}function m(e){var t={};for(var r in e)if(e.hasOwnProperty(r)&&W(e[r])&&W(e[r].values)){var i=e[r];t[r]=new B({componentDatatype:i.componentDatatype,componentsPerAttribute:i.componentsPerAttribute,normalize:i.normalize,values:[]})}return t}function g(e,t,r){for(var i in t)if(t.hasOwnProperty(i)&&W(t[i])&&W(t[i].values))for(var n=t[i],o=0;o<n.componentsPerAttribute;++o)e[i].values.push(n.values[r*n.componentsPerAttribute+o])}t.toWireframe=function(e){if(!W(e))throw new F("geometry is required.");var t=e.indices;if(W(t)){switch(e.primitiveType){case U.TRIANGLES:e.indices=function(e){for(var t=e.length,r=t/3*6,i=P.createTypedArray(t,r),n=0,o=0;o<t;o+=3,n+=6)l(i,n,e[o],e[o+1],e[o+2]);return i}(t);break;case U.TRIANGLE_STRIP:e.indices=function(e){var t=e.length;if(3<=t){var r=6*(t-2),i=P.createTypedArray(t,r);l(i,0,e[0],e[1],e[2]);for(var n=6,o=3;o<t;++o,n+=6)l(i,n,e[o-1],e[o],e[o-2]);return i}return new Uint16Array}(t);break;case U.TRIANGLE_FAN:e.indices=function(e){if(0<e.length){for(var t=e.length-1,r=6*(t-1),i=P.createTypedArray(t,r),n=e[0],o=0,a=1;a<t;++a,o+=6)l(i,o,n,e[a],e[a+1]);return i}return new Uint16Array}(t);break;default:throw new F("geometry.primitiveType must be TRIANGLES, TRIANGLE_STRIP, or TRIANGLE_FAN.")}e.primitiveType=U.LINES}return e},t.createLineSegmentsForVectors=function(e,t,r){if(t=d(t,"normal"),!W(e))throw new F("geometry is required.");if(!W(e.attributes.position))throw new F("geometry.attributes.position is required.");if(!W(e.attributes[t]))throw new F("geometry.attributes must have an attribute with the same name as the attributeName parameter, "+t+".");r=d(r,1e4);for(var i,n=e.attributes.position.values,o=e.attributes[t].values,a=n.length,s=new Float64Array(2*a),l=0,u=0;u<a;u+=3)s[l++]=n[u],s[l++]=n[u+1],s[l++]=n[u+2],s[l++]=n[u]+o[u]*r,s[l++]=n[u+1]+o[u+1]*r,s[l++]=n[u+2]+o[u+2]*r;var c=e.boundingSphere;return W(c)&&(i=new A(c.center,c.radius+r)),new x({attributes:{position:new B({componentDatatype:N.DOUBLE,componentsPerAttribute:3,values:s})},primitiveType:U.LINES,boundingSphere:i})},t.createAttributeLocations=function(e){if(!W(e))throw new F("geometry is required.");var t,r=["position","positionHigh","positionLow","position3DHigh","position3DLow","position2DHigh","position2DLow","pickColor","normal","st","tangent","bitangent","extrudeDirection","compressedAttributes"],i=e.attributes,n={},o=0,a=r.length;for(t=0;t<a;++t){var s=r[t];W(i[s])&&(n[s]=o++)}for(var l in i)i.hasOwnProperty(l)&&!W(n[l])&&(n[l]=o++);return n},t.reorderForPreVertexCache=function(e){if(!W(e))throw new F("geometry is required.");var t=x.computeNumberOfVertices(e),r=e.indices;if(W(r)){for(var i=new Int32Array(t),n=0;n<t;n++)i[n]=-1;for(var o,a=r,s=a.length,l=P.createTypedArray(t,s),u=0,c=0,d=0;u<s;)-1!==(o=i[a[u]])?l[c]=o:(i[o=a[u]]=d,l[c]=d,++d),++u,++c;e.indices=l;var h=e.attributes;for(var p in h)if(h.hasOwnProperty(p)&&W(h[p])&&W(h[p].values)){for(var f=h[p],m=f.values,g=0,_=f.componentsPerAttribute,v=N.createTypedArray(f.componentDatatype,d*_);g<t;){var y=i[g];if(-1!==y)for(var b=0;b<_;b++)v[_*y+b]=m[_*g+b];++g}f.values=v}}return e},t.reorderForPostVertexCache=function(e,t){if(!W(e))throw new F("geometry is required.");var r=e.indices;if(e.primitiveType===U.TRIANGLES&&W(r)){for(var i=r.length,n=0,o=0;o<i;o++)r[o]>n&&(n=r[o]);e.indices=s.tipsify({indices:r,maximumIndex:n,cacheSize:t})}return e},t.fitToUnsignedShortIndices=function(e){if(!W(e))throw new F("geometry is required.");if(W(e.indices)&&e.primitiveType!==U.TRIANGLES&&e.primitiveType!==U.LINES&&e.primitiveType!==U.POINTS)throw new F("geometry.primitiveType must equal to PrimitiveType.TRIANGLES, PrimitiveType.LINES, or PrimitiveType.POINTS.");var t=[],r=x.computeNumberOfVertices(e);if(W(e.indices)&&r>=j.SIXTY_FOUR_KILOBYTES){var i,n=[],o=[],a=0,s=m(e.attributes),l=e.indices,u=l.length;e.primitiveType===U.TRIANGLES?i=3:e.primitiveType===U.LINES?i=2:e.primitiveType===U.POINTS&&(i=1);for(var c=0;c<u;c+=i){for(var d=0;d<i;++d){var h=l[c+d],p=n[h];W(p)||(p=a++,n[h]=p,g(s,e.attributes,h)),o.push(p)}a+i>=j.SIXTY_FOUR_KILOBYTES&&(t.push(new x({attributes:s,indices:o,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV})),n=[],o=[],a=0,s=m(e.attributes))}0!==o.length&&t.push(new x({attributes:s,indices:o,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV}))}else t.push(e);return t};var _=new q,v=new e;t.projectTo2D=function(e,t,r,i,n){if(!W(e))throw new F("geometry is required.");if(!W(t))throw new F("attributeName is required.");if(!W(r))throw new F("attributeName3D is required.");if(!W(i))throw new F("attributeName2D is required.");if(!W(e.attributes[t]))throw new F("geometry must have attribute matching the attributeName argument: "+t+".");if(e.attributes[t].componentDatatype!==N.DOUBLE)throw new F("The attribute componentDatatype must be ComponentDatatype.DOUBLE.");for(var o=e.attributes[t],a=(n=W(n)?n:new f).ellipsoid,s=o.values,l=new Float64Array(s.length),u=0,c=0;c<s.length;c+=3){var d=q.fromArray(s,c,_),h=a.cartesianToCartographic(d,v);if(!W(h))throw new F("Could not project point ("+d.x+", "+d.y+", "+d.z+") to 2D.");var p=n.project(h,_);l[u++]=p.x,l[u++]=p.y,l[u++]=p.z}return e.attributes[r]=o,e.attributes[i]=new B({componentDatatype:N.DOUBLE,componentsPerAttribute:3,values:l}),delete e.attributes[t],e};var p={high:0,low:0};t.encodeAttribute=function(e,t,r,i){if(!W(e))throw new F("geometry is required.");if(!W(t))throw new F("attributeName is required.");if(!W(r))throw new F("attributeHighName is required.");if(!W(i))throw new F("attributeLowName is required.");if(!W(e.attributes[t]))throw new F("geometry must have attribute matching the attributeName argument: "+t+".");if(e.attributes[t].componentDatatype!==N.DOUBLE)throw new F("The attribute componentDatatype must be ComponentDatatype.DOUBLE.");for(var n=e.attributes[t],o=n.values,a=o.length,s=new Float32Array(a),l=new Float32Array(a),u=0;u<a;++u)h.encode(o[u],p),s[u]=p.high,l[u]=p.low;var c=n.componentsPerAttribute;return e.attributes[r]=new B({componentDatatype:N.FLOAT,componentsPerAttribute:c,values:s}),e.attributes[i]=new B({componentDatatype:N.FLOAT,componentsPerAttribute:c,values:l}),delete e.attributes[t],e};var u=new q;function c(e,t){if(W(t))for(var r=t.values,i=r.length,n=0;n<i;n+=3)q.unpack(r,n,u),D.multiplyByPoint(e,u,u),q.pack(u,r,n)}function y(e,t){if(W(t))for(var r=t.values,i=r.length,n=0;n<i;n+=3)q.unpack(r,n,u),o.multiplyByVector(e,u,u),u=q.normalize(u,u),q.pack(u,r,n)}var b=new D,C=new o;t.transformToWorldCoordinates=function(e){if(!W(e))throw new F("instance is required.");var t=e.modelMatrix;if(D.equals(t,D.IDENTITY))return e;var r=e.geometry.attributes;c(t,r.position),c(t,r.prevPosition),c(t,r.nextPosition),(W(r.normal)||W(r.tangent)||W(r.bitangent))&&(D.inverse(t,b),D.transpose(b,b),D.getRotation(b,C),y(C,r.normal),y(C,r.tangent),y(C,r.bitangent));var i=e.geometry.boundingSphere;return W(i)&&(e.geometry.boundingSphere=A.transform(i,t,i)),e.modelMatrix=D.clone(D.IDENTITY),e};var O=new q;function w(e,t){var r,i,n,o,a=e.length,s=e[0].modelMatrix,l=W(e[0][t].indices),u=e[0][t].primitiveType;for(i=1;i<a;++i){if(!D.equals(e[i].modelMatrix,s))throw new F("All instances must have the same modelMatrix.");if(W(e[i][t].indices)!==l)throw new F("All instance geometries must have an indices or not have one.");if(e[i][t].primitiveType!==u)throw new F("All instance geometries must have the same primitiveType.")}var c,d,h,p,f=function(e,t){var r,i=e.length,n={},o=e[0][t].attributes;for(r in o)if(o.hasOwnProperty(r)&&W(o[r])&&W(o[r].values)){for(var a=o[r],s=a.values.length,l=!0,u=1;u<i;++u){var c=e[u][t].attributes[r];if(!W(c)||a.componentDatatype!==c.componentDatatype||a.componentsPerAttribute!==c.componentsPerAttribute||a.normalize!==c.normalize){l=!1;break}s+=c.values.length}l&&(n[r]=new B({componentDatatype:a.componentDatatype,componentsPerAttribute:a.componentsPerAttribute,normalize:a.normalize,values:N.createTypedArray(a.componentDatatype,s)}))}return n}(e,t);for(r in f)if(f.hasOwnProperty(r))for(c=f[r].values,i=o=0;i<a;++i)for(h=(d=e[i][t].attributes[r].values).length,n=0;n<h;++n)c[o++]=d[n];if(l){var m=0;for(i=0;i<a;++i)m+=e[i][t].indices.length;var g=x.computeNumberOfVertices(new x({attributes:f,primitiveType:U.POINTS})),_=P.createTypedArray(g,m),v=0,y=0;for(i=0;i<a;++i){var b=e[i][t].indices,C=b.length;for(o=0;o<C;++o)_[v++]=y+b[o];y+=x.computeNumberOfVertices(e[i][t])}p=_}var w,S=new q,T=0;for(i=0;i<a;++i){if(w=e[i][t].boundingSphere,!W(w)){S=void 0;break}q.add(w.center,S,S)}if(W(S))for(q.divideByScalar(S,a,S),i=0;i<a;++i){w=e[i][t].boundingSphere;var E=q.magnitude(q.subtract(w.center,S,O))+w.radius;T<E&&(T=E)}return new x({attributes:f,indices:p,primitiveType:u,boundingSphere:W(S)?new A(S,T):void 0})}t.combineInstances=function(e){if(!W(e)||e.length<1)throw new F("instances is required and must have length greater than zero.");for(var t=[],r=[],i=e.length,n=0;n<i;++n){var o=e[n];W(o.geometry)?t.push(o):W(o.westHemisphereGeometry)&&W(o.eastHemisphereGeometry)&&r.push(o)}var a=[];return 0<t.length&&a.push(w(t,"geometry")),0<r.length&&(a.push(w(r,"westHemisphereGeometry")),a.push(w(r,"eastHemisphereGeometry"))),a};var S=new q,E=new q,I=new q,M=new q;t.computeNormal=function(e){if(!W(e))throw new F("geometry is required.");if(!W(e.attributes.position)||!W(e.attributes.position.values))throw new F("geometry.attributes.position.values is required.");if(!W(e.indices))throw new F("geometry.indices is required.");if(e.indices.length<2||e.indices.length%3!=0)throw new F("geometry.indices length must be greater than 0 and be a multiple of 3.");if(e.primitiveType!==U.TRIANGLES)throw new F("geometry.primitiveType must be PrimitiveType.TRIANGLES.");var t,r=e.indices,i=e.attributes,n=i.position.values,o=i.position.values.length/3,a=r.length,s=new Array(o),l=new Array(a/3),u=new Array(a);for(t=0;t<o;t++)s[t]={indexOffset:0,count:0,currentCount:0};var c=0;for(t=0;t<a;t+=3){var d=r[t],h=r[t+1],p=r[t+2],f=3*d,m=3*h,g=3*p;E.x=n[f],E.y=n[f+1],E.z=n[f+2],I.x=n[m],I.y=n[m+1],I.z=n[m+2],M.x=n[g],M.y=n[g+1],M.z=n[g+2],s[d].count++,s[h].count++,s[p].count++,q.subtract(I,E,I),q.subtract(M,E,M),l[c]=q.cross(I,M,new q),c++}var _,v=0;for(t=0;t<o;t++)s[t].indexOffset+=v,v+=s[t].count;for(t=c=0;t<a;t+=3){var y=(_=s[r[t]]).indexOffset+_.currentCount;u[y]=c,_.currentCount++,u[y=(_=s[r[t+1]]).indexOffset+_.currentCount]=c,_.currentCount++,u[y=(_=s[r[t+2]]).indexOffset+_.currentCount]=c,_.currentCount++,c++}var b=new Float32Array(3*o);for(t=0;t<o;t++){var C=3*t;if(_=s[t],q.clone(q.ZERO,S),0<_.count){for(c=0;c<_.count;c++)q.add(S,l[u[_.indexOffset+c]],S);q.equalsEpsilon(q.ZERO,S,j.EPSILON10)&&q.clone(l[u[_.indexOffset]],S)}q.equalsEpsilon(q.ZERO,S,j.EPSILON10)&&(S.z=1),q.normalize(S,S),b[C]=S.x,b[C+1]=S.y,b[C+2]=S.z}return e.attributes.normal=new B({componentDatatype:N.FLOAT,componentsPerAttribute:3,values:b}),e};var V=new q,Y=new q,X=new q;t.computeTangentAndBitangent=function(e){if(!W(e))throw new F("geometry is required.");var t=e.attributes,r=e.indices;if(!W(t.position)||!W(t.position.values))throw new F("geometry.attributes.position.values is required.");if(!W(t.normal)||!W(t.normal.values))throw new F("geometry.attributes.normal.values is required.");if(!W(t.st)||!W(t.st.values))throw new F("geometry.attributes.st.values is required.");if(!W(r))throw new F("geometry.indices is required.");if(r.length<2||r.length%3!=0)throw new F("geometry.indices length must be greater than 0 and be a multiple of 3.");if(e.primitiveType!==U.TRIANGLES)throw new F("geometry.primitiveType must be PrimitiveType.TRIANGLES.");var i,n,o,a,s=e.attributes.position.values,l=e.attributes.normal.values,u=e.attributes.st.values,c=e.attributes.position.values.length/3,d=r.length,h=new Array(3*c);for(i=0;i<h.length;i++)h[i]=0;for(i=0;i<d;i+=3){var p=r[i],f=r[i+1],m=r[i+2];o=3*f,a=3*m;var g=2*p,_=2*f,v=2*m,y=s[n=3*p],b=s[n+1],C=s[n+2],w=u[g],S=u[g+1],T=u[_+1]-S,E=u[v+1]-S,A=1/((u[_]-w)*E-(u[v]-w)*T),x=(E*(s[o]-y)-T*(s[a]-y))*A,P=(E*(s[o+1]-b)-T*(s[a+1]-b))*A,D=(E*(s[o+2]-C)-T*(s[a+2]-C))*A;h[n]+=x,h[n+1]+=P,h[n+2]+=D,h[o]+=x,h[o+1]+=P,h[o+2]+=D,h[a]+=x,h[a+1]+=P,h[a+2]+=D}var O=new Float32Array(3*c),I=new Float32Array(3*c);for(i=0;i<c;i++){o=(n=3*i)+1,a=n+2;var M=q.fromArray(l,n,V),R=q.fromArray(h,n,X),L=q.dot(M,R);q.multiplyByScalar(M,L,Y),q.normalize(q.subtract(R,Y,R),R),O[n]=R.x,O[o]=R.y,O[a]=R.z,q.normalize(q.cross(M,R,R),R),I[n]=R.x,I[o]=R.y,I[a]=R.z}return e.attributes.tangent=new B({componentDatatype:N.FLOAT,componentsPerAttribute:3,values:O}),e.attributes.bitangent=new B({componentDatatype:N.FLOAT,componentsPerAttribute:3,values:I}),e};var R=new z,L=new q,Q=new q,Z=new q,K=new z;function J(e){switch(e.primitiveType){case U.TRIANGLE_FAN:return function(e){var t=x.computeNumberOfVertices(e);if(t<3)throw new F("The number of vertices must be at least three.");var r=P.createTypedArray(t,3*(t-2));r[0]=1,r[1]=0,r[2]=2;for(var i=3,n=3;n<t;++n)r[i++]=n-1,r[i++]=0,r[i++]=n;return e.indices=r,e.primitiveType=U.TRIANGLES,e}(e);case U.TRIANGLE_STRIP:return function(e){var t=x.computeNumberOfVertices(e);if(t<3)throw new F("The number of vertices must be at least 3.");var r=P.createTypedArray(t,3*(t-2));r[0]=0,r[1]=1,r[2]=2,3<t&&(r[3]=0,r[4]=2,r[5]=3);for(var i=6,n=3;n<t-1;n+=2)r[i++]=n,r[i++]=n-1,r[i++]=n+1,n+2<t&&(r[i++]=n,r[i++]=n+1,r[i++]=n+2);return e.indices=r,e.primitiveType=U.TRIANGLES,e}(e);case U.TRIANGLES:return function(e){if(W(e.indices))return e;var t=x.computeNumberOfVertices(e);if(t<3)throw new F("The number of vertices must be at least three.");if(t%3!=0)throw new F("The number of vertices must be a multiple of three.");for(var r=P.createTypedArray(t,t),i=0;i<t;++i)r[i]=i;return e.indices=r,e}(e);case U.LINE_STRIP:return function(e){var t=x.computeNumberOfVertices(e);if(t<2)throw new F("The number of vertices must be at least two.");var r=P.createTypedArray(t,2*(t-1));r[0]=0,r[1]=1;for(var i=2,n=2;n<t;++n)r[i++]=n-1,r[i++]=n;return e.indices=r,e.primitiveType=U.LINES,e}(e);case U.LINE_LOOP:return function(e){var t=x.computeNumberOfVertices(e);if(t<2)throw new F("The number of vertices must be at least two.");var r=P.createTypedArray(t,2*t);r[0]=0,r[1]=1;for(var i=2,n=2;n<t;++n)r[i++]=n-1,r[i++]=n;return r[i++]=t-1,r[i]=0,e.indices=r,e.primitiveType=U.LINES,e}(e);case U.LINES:return function(e){if(W(e.indices))return e;var t=x.computeNumberOfVertices(e);if(t<2)throw new F("The number of vertices must be at least two.");if(t%2!=0)throw new F("The number of vertices must be a multiple of 2.");for(var r=P.createTypedArray(t,t),i=0;i<t;++i)r[i]=i;return e.indices=r,e}(e)}return e}function $(e,t){Math.abs(e.y)<j.EPSILON6&&(e.y=t?-j.EPSILON6:j.EPSILON6)}t.compressVertices=function(e){if(!W(e))throw new F("geometry is required.");var t,r,i=e.attributes.extrudeDirection;if(W(i)){var n=i.values;r=n.length/3;var o=new Float32Array(2*r),a=0;for(t=0;t<r;++t)q.fromArray(n,3*t,L),q.equals(L,q.ZERO)?a+=2:(K=T.octEncodeInRange(L,65535,K),o[a++]=K.x,o[a++]=K.y);return e.attributes.compressedAttributes=new B({componentDatatype:N.FLOAT,componentsPerAttribute:2,values:o}),delete e.attributes.extrudeDirection,e}var s=e.attributes.normal,l=e.attributes.st,u=W(s),c=W(l);if(!u&&!c)return e;var d,h,p,f,m=e.attributes.tangent,g=e.attributes.bitangent,_=W(m),v=W(g);u&&(d=s.values),c&&(h=l.values),_&&(p=m.values),v&&(f=g.values);var y=r=(u?d.length:h.length)/(u?3:2),b=c&&u?2:1;b+=_||v?1:0;var C=new Float32Array(y*=b),w=0;for(t=0;t<r;++t){c&&(z.fromArray(h,2*t,R),C[w++]=T.compressTextureCoordinates(R));var S=3*t;u&&W(p)&&W(f)?(q.fromArray(d,S,L),q.fromArray(p,S,Q),q.fromArray(f,S,Z),T.octPack(L,Q,Z,R),C[w++]=R.x,C[w++]=R.y):(u&&(q.fromArray(d,S,L),C[w++]=T.octEncodeFloat(L)),_&&(q.fromArray(p,S,L),C[w++]=T.octEncodeFloat(L)),v&&(q.fromArray(f,S,L),C[w++]=T.octEncodeFloat(L)))}return e.attributes.compressedAttributes=new B({componentDatatype:N.FLOAT,componentsPerAttribute:b,values:C}),u&&delete e.attributes.normal,c&&delete e.attributes.st,v&&delete e.attributes.bitangent,_&&delete e.attributes.tangent,e};var ee=new q;function te(e,t,r,i){q.add(e,q.multiplyByScalar(q.subtract(t,e,ee),e.y/(e.y-t.y),ee),r),q.clone(r,i),$(r,!0),$(i,!1)}var re=new q,ie=new q,ne=new q,oe=new q,ae={positions:new Array(7),indices:new Array(9)};function se(e,t,r){if(!(0<=e.x||0<=t.x||0<=r.x)){!function(e,t,r){if(0!==e.y&&0!==t.y&&0!==r.y)return $(e,e.y<0),$(t,t.y<0),$(r,r.y<0);var i=Math.abs(e.y),n=Math.abs(t.y),o=Math.abs(r.y),a=(n<i?o<i?j.sign(e.y):j.sign(r.y):o<n?j.sign(t.y):j.sign(r.y))<0;$(e,a),$(t,a),$(r,a)}(e,t,r);var i=e.y<0,n=t.y<0,o=r.y<0,a=0;a+=i?1:0,a+=n?1:0,a+=o?1:0;var s=ae.indices;1===a?(s[1]=3,s[2]=4,s[5]=6,s[7]=6,s[8]=5,i?(te(e,t,re,ne),te(e,r,ie,oe),s[0]=0,s[3]=1,s[4]=2,s[6]=1):n?(te(t,r,re,ne),te(t,e,ie,oe),s[0]=1,s[3]=2,s[4]=0,s[6]=2):o&&(te(r,e,re,ne),te(r,t,ie,oe),s[0]=2,s[3]=0,s[4]=1,s[6]=0)):2===a&&(s[2]=4,s[4]=4,s[5]=3,s[7]=5,s[8]=6,i?n?o||(te(r,e,re,ne),te(r,t,ie,oe),s[0]=0,s[1]=1,s[3]=0,s[6]=2):(te(t,r,re,ne),te(t,e,ie,oe),s[0]=2,s[1]=0,s[3]=2,s[6]=1):(te(e,t,re,ne),te(e,r,ie,oe),s[0]=1,s[1]=2,s[3]=1,s[6]=0));var l=ae.positions;return l[0]=e,l[1]=t,l[2]=r,l.length=3,1!==a&&2!==a||(l[3]=re,l[4]=ie,l[5]=ne,l[6]=oe,l.length=7),ae}}function le(e,t){var r=e.attributes;if(0!==r.position.values.length){for(var i in r)if(r.hasOwnProperty(i)&&W(r[i])&&W(r[i].values)){var n=r[i];n.values=N.createTypedArray(n.componentDatatype,n.values)}var o=x.computeNumberOfVertices(e);return e.indices=P.createTypedArray(o,e.indices),t&&(e.boundingSphere=A.fromVertices(r.position.values)),e}}function ue(e){var t=e.attributes,r={};for(var i in t)if(t.hasOwnProperty(i)&&W(t[i])&&W(t[i].values)){var n=t[i];r[i]=new B({componentDatatype:n.componentDatatype,componentsPerAttribute:n.componentsPerAttribute,normalize:n.normalize,values:[]})}return new x({attributes:r,indices:[],primitiveType:e.primitiveType})}function ce(e,t,r){var i=W(e.geometry.boundingSphere);t=le(t,i),r=le(r,i),W(r)&&!W(t)?e.geometry=r:!W(r)&&W(t)?e.geometry=t:(e.westHemisphereGeometry=t,e.eastHemisphereGeometry=r,e.geometry=void 0)}var de=new q,he=new q,pe=new q,fe=new q,me=new z,ge=new z,_e=new z;function ve(e,t,r,i,n,o,a,s,l,u,c,d){if(W(o)||W(a)||W(s)||W(l)||W(u)){var h=q.fromArray(n,3*e,de),p=q.fromArray(n,3*t,he),f=q.fromArray(n,3*r,pe),m=k(i,h,p,f,fe);if(W(o)){var g=q.fromArray(o,3*e,de),_=q.fromArray(o,3*t,he),v=q.fromArray(o,3*r,pe);q.multiplyByScalar(g,m.x,g),q.multiplyByScalar(_,m.y,_),q.multiplyByScalar(v,m.z,v);var y=q.add(g,_,g);q.add(y,v,y),q.normalize(y,y),q.pack(y,c.normal.values,3*d)}if(W(u)){var b,C=q.fromArray(u,3*e,de),w=q.fromArray(u,3*t,he),S=q.fromArray(u,3*r,pe);q.multiplyByScalar(C,m.x,C),q.multiplyByScalar(w,m.y,w),q.multiplyByScalar(S,m.z,S),q.equals(C,q.ZERO)&&q.equals(w,q.ZERO)&&q.equals(S,q.ZERO)?((b=de).x=0,b.y=0,b.z=0):(b=q.add(C,w,C),q.add(b,S,b),q.normalize(b,b)),q.pack(b,c.extrudeDirection.values,3*d)}if(W(a)){var T=q.fromArray(a,3*e,de),E=q.fromArray(a,3*t,he),A=q.fromArray(a,3*r,pe);q.multiplyByScalar(T,m.x,T),q.multiplyByScalar(E,m.y,E),q.multiplyByScalar(A,m.z,A);var x=q.add(T,E,T);q.add(x,A,x),q.normalize(x,x),q.pack(x,c.tangent.values,3*d)}if(W(s)){var P=q.fromArray(s,3*e,de),D=q.fromArray(s,3*t,he),O=q.fromArray(s,3*r,pe);q.multiplyByScalar(P,m.x,P),q.multiplyByScalar(D,m.y,D),q.multiplyByScalar(O,m.z,O);var I=q.add(P,D,P);q.add(I,O,I),q.normalize(I,I),q.pack(I,c.bitangent.values,3*d)}if(W(l)){var M=z.fromArray(l,2*e,me),R=z.fromArray(l,2*t,ge),L=z.fromArray(l,2*r,_e);z.multiplyByScalar(M,m.x,M),z.multiplyByScalar(R,m.y,R),z.multiplyByScalar(L,m.z,L);var N=z.add(M,R,M);z.add(N,L,N),z.pack(N,c.st.values,2*d)}}}function ye(e,t,r,i,n,o){var a=e.position.values.length/3;if(-1===n)return e.position.values.push(o.x,o.y,o.z),t.push(a),a;var s=i[n],l=r[s];return-1===l?(r[s]=a,e.position.values.push(o.x,o.y,o.z),t.push(a),a):(t.push(l),l)}function be(e){var t,r,i,n,o=e.geometry,a=o.attributes,s=a.position.values,l=W(a.normal)?a.normal.values:void 0,u=W(a.bitangent)?a.bitangent.values:void 0,c=W(a.tangent)?a.tangent.values:void 0,d=W(a.st)?a.st.values:void 0,h=W(a.extrudeDirection)?a.extrudeDirection.values:void 0,p=o.indices,f=ue(o),m=ue(o),g=[];g.length=s.length/3;var _=[];for(_.length=s.length/3,n=0;n<g.length;++n)g[n]=-1,_[n]=-1;var v=p.length;for(n=0;n<v;n+=3){var y=p[n],b=p[n+1],C=p[n+2],w=q.fromArray(s,3*y),S=q.fromArray(s,3*b),T=q.fromArray(s,3*C),E=se(w,S,T);if(W(E)&&3<E.positions.length)for(var A=E.positions,x=E.indices,P=x.length,D=0;D<P;++D){var O=x[D],I=A[O];ve(y,b,C,I,s,l,c,u,d,h,t,ye(t,r,i=I.y<0?(t=m.attributes,r=m.indices,g):(t=f.attributes,r=f.indices,_),p,O<3?n+O:-1,I))}else W(E)&&(w=E.positions[0],S=E.positions[1],T=E.positions[2]),ve(y,b,C,w,s,l,c,u,d,h,t,ye(t,r,i=w.y<0?(t=m.attributes,r=m.indices,g):(t=f.attributes,r=f.indices,_),p,n,w)),ve(y,b,C,S,s,l,c,u,d,h,t,ye(t,r,i,p,n+1,S)),ve(y,b,C,T,s,l,c,u,d,h,t,ye(t,r,i,p,n+2,T))}ce(e,m,f)}var Ce=a.fromPointNormal(q.ZERO,q.UNIT_Y),we=new q,Se=new q;function Te(e){var t,r=e.geometry,i=r.attributes.position.values,n=r.indices,o=ue(r),a=ue(r),s=n.length,l=[];l.length=i.length/3;var u=[];for(u.length=i.length/3,t=0;t<l.length;++t)l[t]=-1,u[t]=-1;for(t=0;t<s;t+=2){var c=n[t],d=n[t+1],h=q.fromArray(i,3*c,de),p=q.fromArray(i,3*d,he);Math.abs(h.y)<j.EPSILON6&&(h.y<0?h.y=-j.EPSILON6:h.y=j.EPSILON6),Math.abs(p.y)<j.EPSILON6&&(p.y<0?p.y=-j.EPSILON6:p.y=j.EPSILON6);var f=o.attributes,m=o.indices,g=u,_=a.attributes,v=a.indices,y=l,b=H.lineSegmentPlane(h,p,Ce,pe);if(W(b)){var C=q.multiplyByScalar(q.UNIT_Y,5*j.EPSILON9,we);h.y<0&&(q.negate(C,C),f=a.attributes,m=a.indices,g=l,_=o.attributes,v=o.indices,y=u);var w=q.add(b,C,Se);ye(f,m,g,n,t,h),ye(f,m,g,n,-1,w),q.negate(C,C),q.add(b,C,w),ye(_,v,y,n,-1,w),ye(_,v,y,n,t+1,p)}else{var S,T,E;ye(S,T,E=h.y<0?(S=a.attributes,T=a.indices,l):(S=o.attributes,T=o.indices,u),n,t,h),ye(S,T,E,n,t+1,p)}}ce(e,a,o)}var Ee=new z,Ae=new z,xe=new q,Pe=new q,De=new q,Oe=new q,Ie=new q,Me=new q,Re=new G;function Le(e){for(var t=e.attributes,r=t.position.values,i=t.prevPosition.values,n=t.nextPosition.values,o=r.length,a=0;a<o;a+=3){var s=q.unpack(r,a,xe);if(!(0<s.x)){var l=q.unpack(i,a,Pe);(s.y<0&&0<l.y||0<s.y&&l.y<0)&&(0<a-3?(i[a]=r[a-3],i[a+1]=r[a-2],i[a+2]=r[a-1]):q.pack(s,i,a));var u=q.unpack(n,a,De);(s.y<0&&0<u.y||0<s.y&&u.y<0)&&(a+3<o?(n[a]=r[a+3],n[a+1]=r[a+4],n[a+2]=r[a+5]):q.pack(s,n,a))}}}var Ne=5*j.EPSILON9,ke=j.EPSILON6;return t.splitLongitude=function(e){if(!W(e))throw new F("instance is required.");var t=e.geometry,r=t.boundingSphere;if(W(r)&&(0<r.center.x-r.radius||A.intersectPlane(r,a.ORIGIN_ZX_PLANE)!==n.INTERSECTING))return e;if(t.geometryType!==i.NONE)switch(t.geometryType){case i.POLYLINES:!function(e){var t,r,i,n=e.geometry,o=n.attributes,a=o.position.values,s=o.prevPosition.values,l=o.nextPosition.values,u=o.expandAndWidth.values,c=W(o.st)?o.st.values:void 0,d=W(o.color)?o.color.values:void 0,h=ue(n),p=ue(n),f=!1,m=a.length/3;for(t=0;t<m;t+=4){var g=t,_=t+2,v=q.fromArray(a,3*g,xe),y=q.fromArray(a,3*_,Pe);if(Math.abs(v.y)<ke)for(v.y=ke*(y.y<0?-1:1),a[3*t+1]=v.y,a[3*(t+1)+1]=v.y,r=3*g;r<3*g+12;r+=3)s[r]=a[3*t],s[r+1]=a[3*t+1],s[r+2]=a[3*t+2];if(Math.abs(y.y)<ke)for(y.y=ke*(v.y<0?-1:1),a[3*(t+2)+1]=y.y,a[3*(t+3)+1]=y.y,r=3*g;r<3*g+12;r+=3)l[r]=a[3*(t+2)],l[r+1]=a[3*(t+2)+1],l[r+2]=a[3*(t+2)+2];var b=h.attributes,C=h.indices,w=p.attributes,S=p.indices,T=H.lineSegmentPlane(v,y,Ce,Oe);if(W(T)){f=!0;var E=q.multiplyByScalar(q.UNIT_Y,Ne,Ie);v.y<0&&(q.negate(E,E),b=p.attributes,C=p.indices,w=h.attributes,S=h.indices);var A=q.add(T,E,Me);b.position.values.push(v.x,v.y,v.z,v.x,v.y,v.z),b.position.values.push(A.x,A.y,A.z),b.position.values.push(A.x,A.y,A.z),b.prevPosition.values.push(s[3*g],s[3*g+1],s[3*g+2]),b.prevPosition.values.push(s[3*g+3],s[3*g+4],s[3*g+5]),b.prevPosition.values.push(v.x,v.y,v.z,v.x,v.y,v.z),b.nextPosition.values.push(A.x,A.y,A.z),b.nextPosition.values.push(A.x,A.y,A.z),b.nextPosition.values.push(A.x,A.y,A.z),b.nextPosition.values.push(A.x,A.y,A.z),q.negate(E,E),q.add(T,E,A),w.position.values.push(A.x,A.y,A.z),w.position.values.push(A.x,A.y,A.z),w.position.values.push(y.x,y.y,y.z,y.x,y.y,y.z),w.prevPosition.values.push(A.x,A.y,A.z),w.prevPosition.values.push(A.x,A.y,A.z),w.prevPosition.values.push(A.x,A.y,A.z),w.prevPosition.values.push(A.x,A.y,A.z),w.nextPosition.values.push(y.x,y.y,y.z,y.x,y.y,y.z),w.nextPosition.values.push(l[3*_],l[3*_+1],l[3*_+2]),w.nextPosition.values.push(l[3*_+3],l[3*_+4],l[3*_+5]);var x=z.fromArray(u,2*g,Ee),P=Math.abs(x.y);b.expandAndWidth.values.push(-1,P,1,P),b.expandAndWidth.values.push(-1,-P,1,-P),w.expandAndWidth.values.push(-1,P,1,P),w.expandAndWidth.values.push(-1,-P,1,-P);var D=q.magnitudeSquared(q.subtract(T,v,De));if(D/=q.magnitudeSquared(q.subtract(y,v,De)),W(d)){var O=G.fromArray(d,4*g,Re),I=G.fromArray(d,4*_,Re),M=j.lerp(O.x,I.x,D),R=j.lerp(O.y,I.y,D),L=j.lerp(O.z,I.z,D),N=j.lerp(O.w,I.w,D);for(r=4*g;r<4*g+8;++r)b.color.values.push(d[r]);for(b.color.values.push(M,R,L,N),b.color.values.push(M,R,L,N),w.color.values.push(M,R,L,N),w.color.values.push(M,R,L,N),r=4*_;r<4*_+8;++r)w.color.values.push(d[r])}if(W(c)){var k=z.fromArray(c,2*g,Ee),F=z.fromArray(c,2*(t+3),Ae),B=j.lerp(k.x,F.x,D);for(r=2*g;r<2*g+4;++r)b.st.values.push(c[r]);for(b.st.values.push(B,k.y),b.st.values.push(B,F.y),w.st.values.push(B,k.y),w.st.values.push(B,F.y),r=2*_;r<2*_+4;++r)w.st.values.push(c[r])}i=b.position.values.length/3-4,C.push(i,i+2,i+1),C.push(i+1,i+2,i+3),i=w.position.values.length/3-4,S.push(i,i+2,i+1),S.push(i+1,i+2,i+3)}else{var U,V;for(V=v.y<0?(U=p.attributes,p.indices):(U=h.attributes,h.indices),U.position.values.push(v.x,v.y,v.z),U.position.values.push(v.x,v.y,v.z),U.position.values.push(y.x,y.y,y.z),U.position.values.push(y.x,y.y,y.z),r=3*t;r<3*t+12;++r)U.prevPosition.values.push(s[r]),U.nextPosition.values.push(l[r]);for(r=2*t;r<2*t+8;++r)U.expandAndWidth.values.push(u[r]),W(c)&&U.st.values.push(c[r]);if(W(d))for(r=4*t;r<4*t+16;++r)U.color.values.push(d[r]);i=U.position.values.length/3-4,V.push(i,i+2,i+1),V.push(i+1,i+2,i+3)}}f&&(Le(p),Le(h)),ce(e,p,h)}(e);break;case i.TRIANGLES:be(e);break;case i.LINES:Te(e)}else J(t),t.primitiveType===U.TRIANGLES?be(e):t.primitiveType===U.LINES&&Te(e);return e},t}),define("Core/EllipseGeometry",["./BoundingSphere","./Cartesian2","./Cartesian3","./Cartographic","./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError","./EllipseGeometryLibrary","./Ellipsoid","./GeographicProjection","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryInstance","./GeometryPipeline","./IndexDatatype","./Math","./Matrix3","./Matrix4","./PrimitiveType","./Quaternion","./Rectangle","./Transforms","./VertexFormat"],function(C,G,W,e,H,g,_,t,v,U,y,j,w,Y,X,S,T,E,c,Q,d,A,Z,b,h,x){"use strict";var K=new W,J=new W,$=new W,ee=new W,te=new G,re=new Q,ie=new Z,ne=new W,oe=new W,ae=new W,se=new e,le=new W,ue=new G,ce=new G;function P(e,t,r){var i=t.vertexFormat,n=t.center,o=t.semiMajorAxis,a=t.semiMinorAxis,s=t.ellipsoid,l=t.stRotation,u=r?e.length/3*2:e.length/3,c=t.shadowVolume,d=i.st?new Float32Array(2*u):void 0,h=i.normal?new Float32Array(3*u):void 0,p=i.tangent?new Float32Array(3*u):void 0,f=i.bitangent?new Float32Array(3*u):void 0,m=c?new Float32Array(3*u):void 0,g=0,_=ne,v=oe,y=ae,b=new j(s),C=b.project(s.cartesianToCartographic(n,se),le),w=s.scaleToGeodeticSurface(n,K);s.geodeticSurfaceNormal(w,w);for(var S=Z.fromAxisAngle(w,l,ie),T=Q.fromQuaternion(S,re),E=G.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,ue),A=G.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,ce),x=e.length,P=r?x:0,D=P/3*2,O=0;O<x;O+=3){var I=O+1,M=O+2,R=W.fromArray(e,O,K);if(i.st){var L=Q.multiplyByVector(T,R,J),N=b.project(s.cartesianToCartographic(L,se),$);W.subtract(N,C,N),te.x=(N.x+o)/(2*o),te.y=(N.y+a)/(2*a),E.x=Math.min(te.x,E.x),E.y=Math.min(te.y,E.y),A.x=Math.max(te.x,A.x),A.y=Math.max(te.y,A.y),r&&(d[g+D]=te.x,d[g+1+D]=te.y),d[g++]=te.x,d[g++]=te.y}(i.normal||i.tangent||i.bitangent||c)&&(_=s.geodeticSurfaceNormal(R,_),c&&(m[O+P]=-_.x,m[I+P]=-_.y,m[M+P]=-_.z),(i.normal||i.tangent||i.bitangent)&&((i.tangent||i.bitangent)&&(v=W.normalize(W.cross(W.UNIT_Z,_,v),v),Q.multiplyByVector(T,v,v)),i.normal&&(h[O]=_.x,h[I]=_.y,h[M]=_.z,r&&(h[O+P]=-_.x,h[I+P]=-_.y,h[M+P]=-_.z)),i.tangent&&(p[O]=v.x,p[I]=v.y,p[M]=v.z,r&&(p[O+P]=-v.x,p[I+P]=-v.y,p[M+P]=-v.z)),i.bitangent&&(y=W.normalize(W.cross(_,v,y),y),f[O]=y.x,f[I]=y.y,f[M]=y.z,r&&(f[O+P]=y.x,f[I+P]=y.y,f[M+P]=y.z))))}if(i.st){x=d.length;for(var k=0;k<x;k+=2)d[k]=(d[k]-E.x)/(A.x-E.x),d[k+1]=(d[k+1]-E.y)/(A.y-E.y)}var F=new X;if(i.position){var B=U.raisePositionsToHeight(e,t,r);F.position=new Y({componentDatatype:H.DOUBLE,componentsPerAttribute:3,values:B})}return i.st&&(F.st=new Y({componentDatatype:H.FLOAT,componentsPerAttribute:2,values:d})),i.normal&&(F.normal=new Y({componentDatatype:H.FLOAT,componentsPerAttribute:3,values:h})),i.tangent&&(F.tangent=new Y({componentDatatype:H.FLOAT,componentsPerAttribute:3,values:p})),i.bitangent&&(F.bitangent=new Y({componentDatatype:H.FLOAT,componentsPerAttribute:3,values:f})),c&&(F.extrudeDirection=new Y({componentDatatype:H.FLOAT,componentsPerAttribute:3,values:m})),F}function D(e){var t,r,i,n,o,a=new Array(e*(e+1)*12-6),s=0;for(i=1,n=t=0;n<3;n++)a[s++]=i++,a[s++]=t,a[s++]=i;for(n=2;n<e+1;++n){for(i=n*(n+1)-1,t=(n-1)*n-1,a[s++]=i++,a[s++]=t,a[s++]=i,r=2*n,o=0;o<r-1;++o)a[s++]=i,a[s++]=t++,a[s++]=t,a[s++]=i++,a[s++]=t,a[s++]=i;a[s++]=i++,a[s++]=t,a[s++]=i}for(r=2*e,++i,++t,n=0;n<r-1;++n)a[s++]=i,a[s++]=t++,a[s++]=t,a[s++]=i++,a[s++]=t,a[s++]=i;for(a[s++]=i,a[s++]=t++,a[s++]=t,a[s++]=i++,a[s++]=t++,a[s++]=t,++t,n=e-1;1<n;--n){for(a[s++]=t++,a[s++]=t,a[s++]=i,r=2*n,o=0;o<r-1;++o)a[s++]=i,a[s++]=t++,a[s++]=t,a[s++]=i++,a[s++]=t,a[s++]=i;a[s++]=t++,a[s++]=t++,a[s++]=i++}for(n=0;n<3;n++)a[s++]=t++,a[s++]=t,a[s++]=i;return a}var l=new W;var O=new C,I=new C;function i(e){var t=e.center,r=e.ellipsoid,i=e.semiMajorAxis,n=W.multiplyByScalar(r.geodeticSurfaceNormal(t,K),e.height,K);O.center=W.add(t,n,O.center),O.radius=i,n=W.multiplyByScalar(r.geodeticSurfaceNormal(t,n),e.extrudedHeight,n),I.center=W.add(t,n,I.center),I.radius=i;var o=U.computeEllipsePositions(e,!0,!0),a=o.positions,s=o.numPts,l=o.outerPositions,u=C.union(O,I),c=P(a,e,!0),d=D(s),h=d.length;d.length=2*h;for(var p=a.length/3,f=0;f<h;f+=3)d[f+h]=d[f+2]+p,d[f+1+h]=d[f+1]+p,d[f+2+h]=d[f]+p;var m=E.createTypedArray(2*p/3,d),g=new w({attributes:c,indices:m,primitiveType:A.TRIANGLES}),_=function(e,t){var r=t.vertexFormat,i=t.center,n=t.semiMajorAxis,o=t.semiMinorAxis,a=t.ellipsoid,s=t.height,l=t.extrudedHeight,u=t.stRotation,c=e.length/3*2,d=new Float64Array(3*c),h=r.st?new Float32Array(2*c):void 0,p=r.normal?new Float32Array(3*c):void 0,f=r.tangent?new Float32Array(3*c):void 0,m=r.bitangent?new Float32Array(3*c):void 0,g=t.shadowVolume,_=g?new Float32Array(3*c):void 0,v=0,y=ne,b=oe,C=ae,w=new j(a),S=w.project(a.cartesianToCartographic(i,se),le),T=a.scaleToGeodeticSurface(i,K);a.geodeticSurfaceNormal(T,T);for(var E=Z.fromAxisAngle(T,u,ie),A=Q.fromQuaternion(E,re),x=G.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,ue),P=G.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,ce),D=e.length,O=D/3*2,I=0;I<D;I+=3){var M,R=I+1,L=I+2,N=W.fromArray(e,I,K);if(r.st){var k=Q.multiplyByVector(A,N,J),F=w.project(a.cartesianToCartographic(k,se),$);W.subtract(F,S,F),te.x=(F.x+n)/(2*n),te.y=(F.y+o)/(2*o),x.x=Math.min(te.x,x.x),x.y=Math.min(te.y,x.y),P.x=Math.max(te.x,P.x),P.y=Math.max(te.y,P.y),h[v+O]=te.x,h[v+1+O]=te.y,h[v++]=te.x,h[v++]=te.y}N=a.scaleToGeodeticSurface(N,N),M=W.clone(N,J),y=a.geodeticSurfaceNormal(N,y),g&&(_[I+D]=-y.x,_[R+D]=-y.y,_[L+D]=-y.z);var B=W.multiplyByScalar(y,s,ee);if(N=W.add(N,B,N),B=W.multiplyByScalar(y,l,B),M=W.add(M,B,M),r.position&&(d[I+D]=M.x,d[R+D]=M.y,d[L+D]=M.z,d[I]=N.x,d[R]=N.y,d[L]=N.z),r.normal||r.tangent||r.bitangent){C=W.clone(y,C);var U=W.fromArray(e,(I+3)%D,ee);W.subtract(U,N,U);var V=W.subtract(M,N,$);y=W.normalize(W.cross(V,U,y),y),r.normal&&(p[I]=y.x,p[R]=y.y,p[L]=y.z,p[I+D]=y.x,p[R+D]=y.y,p[L+D]=y.z),r.tangent&&(b=W.normalize(W.cross(C,y,b),b),f[I]=b.x,f[R]=b.y,f[L]=b.z,f[I+D]=b.x,f[I+1+D]=b.y,f[I+2+D]=b.z),r.bitangent&&(m[I]=C.x,m[R]=C.y,m[L]=C.z,m[I+D]=C.x,m[R+D]=C.y,m[L+D]=C.z)}}if(r.st){D=h.length;for(var z=0;z<D;z+=2)h[z]=(h[z]-x.x)/(P.x-x.x),h[z+1]=(h[z+1]-x.y)/(P.y-x.y)}var q=new X;return r.position&&(q.position=new Y({componentDatatype:H.DOUBLE,componentsPerAttribute:3,values:d})),r.st&&(q.st=new Y({componentDatatype:H.FLOAT,componentsPerAttribute:2,values:h})),r.normal&&(q.normal=new Y({componentDatatype:H.FLOAT,componentsPerAttribute:3,values:p})),r.tangent&&(q.tangent=new Y({componentDatatype:H.FLOAT,componentsPerAttribute:3,values:f})),r.bitangent&&(q.bitangent=new Y({componentDatatype:H.FLOAT,componentsPerAttribute:3,values:m})),g&&(q.extrudeDirection=new Y({componentDatatype:H.FLOAT,componentsPerAttribute:3,values:_})),q}(l,e);d=function(e){for(var t=e.length/3,r=E.createTypedArray(t,6*t),i=0,n=0;n<t;n++){var o=n,a=n+t,s=(o+1)%t,l=s+t;r[i++]=o,r[i++]=a,r[i++]=s,r[i++]=s,r[i++]=a,r[i++]=l}return r}(l);var v=E.createTypedArray(2*l.length/3,d),y=new w({attributes:_,indices:v,primitiveType:A.TRIANGLES}),b=T.combineInstances([new S({geometry:g}),new S({geometry:y})]);return{boundingSphere:u,attributes:b[0].attributes,indices:b[0].indices}}var p=new d,f=new d,m=new Q,M=[new W,new W,new W,new W],R=[new e,new e,new e,new e];function L(e){var t=(e=g(e,g.EMPTY_OBJECT)).center,r=g(e.ellipsoid,y.WGS84),i=e.semiMajorAxis,n=e.semiMinorAxis,o=g(e.granularity,c.RADIANS_PER_DEGREE),a=g(e.height,0),s=e.extrudedHeight,l=_(s)&&1<Math.abs(a-s),u=g(e.vertexFormat,x.DEFAULT);if(!_(t))throw new v("center is required.");if(!_(i))throw new v("semiMajorAxis is required.");if(!_(n))throw new v("semiMinorAxis is required.");if(i<n)throw new v("semiMajorAxis must be greater than or equal to the semiMinorAxis.");if(o<=0)throw new v("granularity must be greater than zero.");this._center=W.clone(t),this._semiMajorAxis=i,this._semiMinorAxis=n,this._ellipsoid=y.clone(r),this._rotation=g(e.rotation,0),this._stRotation=g(e.stRotation,0),this._height=a,this._granularity=o,this._vertexFormat=x.clone(u),this._extrudedHeight=g(s,a),this._extrude=l,this._shadowVolume=g(e.shadowVolume,!1),this._workerName="createEllipseGeometry",this._rectangle=function(e,t,r,i,n){var o;for(h.eastNorthUpToFixedFrame(e,t,p),d.inverseTransformation(p,f),o=0;o<4;++o)W.clone(W.ZERO,M[o]);for(M[0].x+=r,M[1].x-=r,M[2].y+=i,M[3].y-=i,Q.fromRotationZ(n,m),o=0;o<4;++o)Q.multiplyByVector(m,M[o],M[o]),d.multiplyByPoint(p,M[o],M[o]),t.cartesianToCartographic(M[o],R[o]);return b.fromCartographicArray(R)}(this._center,this._ellipsoid,i,n,this._rotation)}L.packedLength=W.packedLength+y.packedLength+x.packedLength+b.packedLength+9,L.pack=function(e,t,r){if(!_(e))throw new v("value is required");if(!_(t))throw new v("array is required");return r=g(r,0),W.pack(e._center,t,r),r+=W.packedLength,y.pack(e._ellipsoid,t,r),r+=y.packedLength,x.pack(e._vertexFormat,t,r),r+=x.packedLength,b.pack(e._rectangle,t,r),r+=b.packedLength,t[r++]=e._semiMajorAxis,t[r++]=e._semiMinorAxis,t[r++]=e._rotation,t[r++]=e._stRotation,t[r++]=e._height,t[r++]=e._granularity,t[r++]=e._extrudedHeight,t[r++]=e._extrude?1:0,t[r]=e._shadowVolume?1:0,t};var N=new W,k=new y,F=new x,B=new b,V={center:N,ellipsoid:k,vertexFormat:F,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,stRotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,shadowVolume:void 0};return L.unpack=function(e,t,r){if(!_(e))throw new v("array is required");t=g(t,0);var i=W.unpack(e,t,N);t+=W.packedLength;var n=y.unpack(e,t,k);t+=y.packedLength;var o=x.unpack(e,t,F);t+=x.packedLength;var a=b.unpack(e,t,B);t+=b.packedLength;var s=e[t++],l=e[t++],u=e[t++],c=e[t++],d=e[t++],h=e[t++],p=e[t++],f=1===e[t++],m=1===e[t];return _(r)?(r._center=W.clone(i,r._center),r._ellipsoid=y.clone(n,r._ellipsoid),r._vertexFormat=x.clone(o,r._vertexFormat),r._semiMajorAxis=s,r._semiMinorAxis=l,r._rotation=u,r._stRotation=c,r._height=d,r._granularity=h,r._extrudedHeight=p,r._extrude=f,r._shadowVolume=m,r._rectangle=b.clone(a),r):(V.height=d,V.extrudedHeight=p,V.granularity=h,V.stRotation=c,V.rotation=u,V.semiMajorAxis=s,V.semiMinorAxis=l,V.shadowVolume=m,new L(V))},L.createGeometry=function(e){if(!(e._semiMajorAxis<=0||e._semiMinorAxis<=0)){e._center=e._ellipsoid.scaleToGeodeticSurface(e._center,e._center);var t,r={center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:e._ellipsoid,rotation:e._rotation,height:e._height,extrudedHeight:e._extrudedHeight,granularity:e._granularity,vertexFormat:e._vertexFormat,stRotation:e._stRotation};return t=e._extrude?(r.extrudedHeight=Math.min(e._extrudedHeight,e._height),r.height=Math.max(e._extrudedHeight,e._height),r.shadowVolume=e._shadowVolume,i(r)):function(e){var t=e.center;l=W.multiplyByScalar(e.ellipsoid.geodeticSurfaceNormal(t,l),e.height,l),l=W.add(t,l,l);var r=new C(l,e.semiMajorAxis),i=U.computeEllipsePositions(e,!0,!1),n=i.positions,o=i.numPts,a=P(n,e,!1),s=D(o);return{boundingSphere:r,attributes:a,indices:s=E.createTypedArray(n.length/3,s)}}(r),new w({attributes:t.attributes,indices:t.indices,primitiveType:A.TRIANGLES,boundingSphere:t.boundingSphere})}},L.createShadowVolume=function(e,t,r){var i=e._granularity,n=e._ellipsoid,o=t(i,n),a=r(i,n);return new L({center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:n,rotation:e._rotation,stRotation:e._stRotation,granularity:i,extrudedHeight:o,height:a,vertexFormat:x.POSITION_ONLY,shadowVolume:!0})},t(L.prototype,{rectangle:{get:function(){return this._rectangle}}}),L}),define("Core/CircleGeometry",["./Cartesian3","./Check","./defaultValue","./defined","./defineProperties","./EllipseGeometry","./Ellipsoid","./VertexFormat"],function(n,i,o,a,e,s,l,u){"use strict";function c(e){var t=(e=o(e,o.EMPTY_OBJECT)).radius;i.typeOf.number("radius",t);var r={center:e.center,semiMajorAxis:t,semiMinorAxis:t,ellipsoid:e.ellipsoid,height:e.height,extrudedHeight:e.extrudedHeight,granularity:e.granularity,vertexFormat:e.vertexFormat,stRotation:e.stRotation,shadowVolume:e.shadowVolume};this._ellipseGeometry=new s(r),this._workerName="createCircleGeometry"}c.packedLength=s.packedLength,c.pack=function(e,t,r){return i.typeOf.object("value",e),s.pack(e._ellipseGeometry,t,r)};var d=new s({center:new n,semiMajorAxis:1,semiMinorAxis:1}),h={center:new n,radius:void 0,ellipsoid:l.clone(l.UNIT_SPHERE),height:void 0,extrudedHeight:void 0,granularity:void 0,vertexFormat:new u,stRotation:void 0,semiMajorAxis:void 0,semiMinorAxis:void 0,shadowVolume:void 0};return c.unpack=function(e,t,r){var i=s.unpack(e,t,d);return h.center=n.clone(i._center,h.center),h.ellipsoid=l.clone(i._ellipsoid,h.ellipsoid),h.height=i._height,h.extrudedHeight=i._extrudedHeight,h.granularity=i._granularity,h.vertexFormat=u.clone(i._vertexFormat,h.vertexFormat),h.stRotation=i._stRotation,h.shadowVolume=i._shadowVolume,a(r)?(h.semiMajorAxis=i._semiMajorAxis,h.semiMinorAxis=i._semiMinorAxis,r._ellipseGeometry=new s(h),r):(h.radius=i._semiMajorAxis,new c(h))},c.createGeometry=function(e){return s.createGeometry(e._ellipseGeometry)},c.createShadowVolume=function(e,t,r){var i=e._ellipseGeometry._granularity,n=e._ellipseGeometry._ellipsoid,o=t(i,n),a=r(i,n);return new c({center:e._ellipseGeometry._center,radius:e._ellipseGeometry._semiMajorAxis,ellipsoid:n,stRotation:e._ellipseGeometry._stRotation,granularity:i,extrudedHeight:o,height:a,vertexFormat:u.POSITION_ONLY,shadowVolume:!0})},e(c.prototype,{rectangle:{get:function(){return this._ellipseGeometry.rectangle}}}),c}),define("Core/EllipseOutlineGeometry",["./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./EllipseGeometryLibrary","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType"],function(g,_,v,y,f,m,b,C,i,w,S,T,E,n){"use strict";var A=new _,u=new _;var x=new g,P=new g;function D(e){var t=(e=y(e,y.EMPTY_OBJECT)).center,r=y(e.ellipsoid,C.WGS84),i=e.semiMajorAxis,n=e.semiMinorAxis,o=y(e.granularity,E.RADIANS_PER_DEGREE),a=y(e.height,0),s=e.extrudedHeight,l=f(s)&&1<Math.abs(a-s);if(!f(t))throw new m("center is required.");if(!f(i))throw new m("semiMajorAxis is required.");if(!f(n))throw new m("semiMinorAxis is required.");if(i<n)throw new m("semiMajorAxis must be greater than or equal to the semiMinorAxis.");if(o<=0)throw new m("granularity must be greater than zero.");this._center=_.clone(t),this._semiMajorAxis=i,this._semiMinorAxis=n,this._ellipsoid=C.clone(r),this._rotation=y(e.rotation,0),this._height=a,this._granularity=o,this._extrudedHeight=s,this._extrude=l,this._numberOfVerticalLines=Math.max(y(e.numberOfVerticalLines,16),0),this._workerName="createEllipseOutlineGeometry"}D.packedLength=_.packedLength+C.packedLength+9,D.pack=function(e,t,r){if(!f(e))throw new m("value is required");if(!f(t))throw new m("array is required");return r=y(r,0),_.pack(e._center,t,r),r+=_.packedLength,C.pack(e._ellipsoid,t,r),r+=C.packedLength,t[r++]=e._semiMajorAxis,t[r++]=e._semiMinorAxis,t[r++]=e._rotation,t[r++]=e._height,t[r++]=e._granularity,t[r++]=f(e._extrudedHeight)?1:0,t[r++]=y(e._extrudedHeight,0),t[r++]=e._extrude?1:0,t[r]=e._numberOfVerticalLines,t};var O=new _,I=new C,M={center:O,ellipsoid:I,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,numberOfVerticalLines:void 0};return D.unpack=function(e,t,r){if(!f(e))throw new m("array is required");t=y(t,0);var i=_.unpack(e,t,O);t+=_.packedLength;var n=C.unpack(e,t,I);t+=C.packedLength;var o=e[t++],a=e[t++],s=e[t++],l=e[t++],u=e[t++],c=e[t++],d=e[t++],h=1===e[t++],p=e[t];return f(r)?(r._center=_.clone(i,r._center),r._ellipsoid=C.clone(n,r._ellipsoid),r._semiMajorAxis=o,r._semiMinorAxis=a,r._rotation=s,r._height=l,r._granularity=u,r._extrudedHeight=c?d:void 0,r._extrude=h,r._numberOfVerticalLines=p,r):(M.height=l,M.extrudedHeight=c?d:void 0,M.granularity=u,M.rotation=s,M.semiMajorAxis=o,M.semiMinorAxis=a,M.numberOfVerticalLines=p,new D(M))},D.createGeometry=function(e){if(!(e._semiMajorAxis<=0||e._semiMinorAxis<=0)){e._center=e._ellipsoid.scaleToGeodeticSurface(e._center,e._center);var t,r={center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:e._ellipsoid,rotation:e._rotation,height:e._height,extrudedHeight:e._extrudedHeight,granularity:e._granularity,numberOfVerticalLines:e._numberOfVerticalLines};return t=e._extrude?(r.extrudedHeight=Math.min(e._extrudedHeight,e._height),r.height=Math.max(e._extrudedHeight,e._height),function(e){var t=e.center,r=e.ellipsoid,i=e.semiMajorAxis,n=_.multiplyByScalar(r.geodeticSurfaceNormal(t,A),e.height,A);x.center=_.add(t,n,x.center),x.radius=i,n=_.multiplyByScalar(r.geodeticSurfaceNormal(t,n),e.extrudedHeight,n),P.center=_.add(t,n,P.center),P.radius=i;var o=b.computeEllipsePositions(e,!1,!0).outerPositions,a=new S({position:new w({componentDatatype:v.DOUBLE,componentsPerAttribute:3,values:b.raisePositionsToHeight(o,e,!0)})});o=a.position.values;var s=g.union(x,P),l=o.length/3,u=y(e.numberOfVerticalLines,16);u=E.clamp(u,0,l/2);var c=T.createTypedArray(l,2*l+2*u);l/=2;var d,h,p=0;for(d=0;d<l;++d)c[p++]=d,c[p++]=(d+1)%l,c[p++]=d+l,c[p++]=(d+1)%l+l;if(0<u){var f=Math.min(u,l);h=Math.round(l/f);var m=Math.min(h*u,l);for(d=0;d<m;d+=h)c[p++]=d,c[p++]=d+l}return{boundingSphere:s,attributes:a,indices:c}}(r)):function(e){var t=e.center;u=_.multiplyByScalar(e.ellipsoid.geodeticSurfaceNormal(t,u),e.height,u),u=_.add(t,u,u);for(var r=new g(u,e.semiMajorAxis),i=b.computeEllipsePositions(e,!1,!0).outerPositions,n=new S({position:new w({componentDatatype:v.DOUBLE,componentsPerAttribute:3,values:b.raisePositionsToHeight(i,e,!1)})}),o=i.length/3,a=T.createTypedArray(o,2*o),s=0,l=0;l<o;++l)a[s++]=l,a[s++]=(l+1)%o;return{boundingSphere:r,attributes:n,indices:a}}(r),new i({attributes:t.attributes,indices:t.indices,primitiveType:n.LINES,boundingSphere:t.boundingSphere})}},D}),define("Core/CircleOutlineGeometry",["./Cartesian3","./Check","./defaultValue","./defined","./EllipseOutlineGeometry","./Ellipsoid"],function(n,i,o,a,s,l){"use strict";function u(e){var t=(e=o(e,o.EMPTY_OBJECT)).radius;i.typeOf.number("radius",t);var r={center:e.center,semiMajorAxis:t,semiMinorAxis:t,ellipsoid:e.ellipsoid,height:e.height,extrudedHeight:e.extrudedHeight,granularity:e.granularity,numberOfVerticalLines:e.numberOfVerticalLines};this._ellipseGeometry=new s(r),this._workerName="createCircleOutlineGeometry"}u.packedLength=s.packedLength,u.pack=function(e,t,r){return i.typeOf.object("value",e),s.pack(e._ellipseGeometry,t,r)};var c=new s({center:new n,semiMajorAxis:1,semiMinorAxis:1}),d={center:new n,radius:void 0,ellipsoid:l.clone(l.UNIT_SPHERE),height:void 0,extrudedHeight:void 0,granularity:void 0,numberOfVerticalLines:void 0,semiMajorAxis:void 0,semiMinorAxis:void 0};return u.unpack=function(e,t,r){var i=s.unpack(e,t,c);return d.center=n.clone(i._center,d.center),d.ellipsoid=l.clone(i._ellipsoid,d.ellipsoid),d.height=i._height,d.extrudedHeight=i._extrudedHeight,d.granularity=i._granularity,d.numberOfVerticalLines=i._numberOfVerticalLines,a(r)?(d.semiMajorAxis=i._semiMajorAxis,d.semiMinorAxis=i._semiMinorAxis,r._ellipseGeometry=new s(d),r):(d.radius=i._semiMajorAxis,new u(d))},u.createGeometry=function(e){return s.createGeometry(e._ellipseGeometry)},u}),define("Core/Color",["./Check","./defaultValue","./defined","./FeatureDetection","./freezeObject","./Math"],function(f,m,g,e,t,_){"use strict";function c(e,t,r){return r<0&&(r+=1),1<r&&(r-=1),6*r<1?e+6*(t-e)*r:2*r<1?t:3*r<2?e+(t-e)*(2/3-r)*6:e}function v(e,t,r,i){this.red=m(e,1),this.green=m(t,1),this.blue=m(r,1),this.alpha=m(i,1)}var r,i,n;v.fromCartesian4=function(e,t){return f.typeOf.object("cartesian",e),g(t)?(t.red=e.x,t.green=e.y,t.blue=e.z,t.alpha=e.w,t):new v(e.x,e.y,e.z,e.w)},v.fromBytes=function(e,t,r,i,n){return e=v.byteToFloat(m(e,255)),t=v.byteToFloat(m(t,255)),r=v.byteToFloat(m(r,255)),i=v.byteToFloat(m(i,255)),g(n)?(n.red=e,n.green=t,n.blue=r,n.alpha=i,n):new v(e,t,r,i)},v.fromAlpha=function(e,t,r){return f.typeOf.object("color",e),f.typeOf.number("alpha",t),g(r)?(r.red=e.red,r.green=e.green,r.blue=e.blue,r.alpha=t,r):new v(e.red,e.green,e.blue,t)},e.supportsTypedArrays()&&(r=new ArrayBuffer(4),i=new Uint32Array(r),n=new Uint8Array(r)),v.fromRgba=function(e,t){return i[0]=e,v.fromBytes(n[0],n[1],n[2],n[3],t)},v.fromHsl=function(e,t,r,i,n){e=m(e,0)%1,t=m(t,0),r=m(r,0),i=m(i,1);var o=r,a=r,s=r;if(0!==t){var l,u=2*r-(l=r<.5?r*(1+t):r+t-r*t);o=c(u,l,e+1/3),a=c(u,l,e),s=c(u,l,e-1/3)}return g(n)?(n.red=o,n.green=a,n.blue=s,n.alpha=i,n):new v(o,a,s,i)},v.fromRandom=function(e,t){var r=(e=m(e,m.EMPTY_OBJECT)).red;if(!g(r)){var i=m(e.minimumRed,0),n=m(e.maximumRed,1);f.typeOf.number.lessThanOrEquals("minimumRed",i,n),r=i+_.nextRandomNumber()*(n-i)}var o=e.green;if(!g(o)){var a=m(e.minimumGreen,0),s=m(e.maximumGreen,1);f.typeOf.number.lessThanOrEquals("minimumGreen",a,s),o=a+_.nextRandomNumber()*(s-a)}var l=e.blue;if(!g(l)){var u=m(e.minimumBlue,0),c=m(e.maximumBlue,1);f.typeOf.number.lessThanOrEquals("minimumBlue",u,c),l=u+_.nextRandomNumber()*(c-u)}var d=e.alpha;if(!g(d)){var h=m(e.minimumAlpha,0),p=m(e.maximumAlpha,1);f.typeOf.number.lessThanOrEquals("minumumAlpha",h,p),d=h+_.nextRandomNumber()*(p-h)}return g(t)?(t.red=r,t.green=o,t.blue=l,t.alpha=d,t):new v(r,o,l,d)};var o=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i,a=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i,s=/^rgba?\(\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)(?:\s*,\s*([0-9.]+))?\s*\)$/i,l=/^hsla?\(\s*([0-9.]+)\s*,\s*([0-9.]+%)\s*,\s*([0-9.]+%)(?:\s*,\s*([0-9.]+))?\s*\)$/i;return v.fromCssColorString=function(e,t){f.typeOf.string("color",e),g(t)||(t=new v);var r=v[e.toUpperCase()];if(g(r))return v.clone(r,t),t;var i=o.exec(e);return null!==i?(t.red=parseInt(i[1],16)/15,t.green=parseInt(i[2],16)/15,t.blue=parseInt(i[3],16)/15,t.alpha=1,t):null!==(i=a.exec(e))?(t.red=parseInt(i[1],16)/255,t.green=parseInt(i[2],16)/255,t.blue=parseInt(i[3],16)/255,t.alpha=1,t):null!==(i=s.exec(e))?(t.red=parseFloat(i[1])/("%"===i[1].substr(-1)?100:255),t.green=parseFloat(i[2])/("%"===i[2].substr(-1)?100:255),t.blue=parseFloat(i[3])/("%"===i[3].substr(-1)?100:255),t.alpha=parseFloat(m(i[4],"1.0")),t):null!==(i=l.exec(e))?v.fromHsl(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,parseFloat(m(i[4],"1.0")),t):t=void 0},v.packedLength=4,v.pack=function(e,t,r){return f.typeOf.object("value",e),f.defined("array",t),r=m(r,0),t[r++]=e.red,t[r++]=e.green,t[r++]=e.blue,t[r]=e.alpha,t},v.unpack=function(e,t,r){return f.defined("array",e),t=m(t,0),g(r)||(r=new v),r.red=e[t++],r.green=e[t++],r.blue=e[t++],r.alpha=e[t],r},v.byteToFloat=function(e){return e/255},v.floatToByte=function(e){return 1===e?255:256*e|0},v.clone=function(e,t){if(g(e))return g(t)?(t.red=e.red,t.green=e.green,t.blue=e.blue,t.alpha=e.alpha,t):new v(e.red,e.green,e.blue,e.alpha)},v.equals=function(e,t){return e===t||g(e)&&g(t)&&e.red===t.red&&e.green===t.green&&e.blue===t.blue&&e.alpha===t.alpha},v.equalsArray=function(e,t,r){return e.red===t[r]&&e.green===t[r+1]&&e.blue===t[r+2]&&e.alpha===t[r+3]},v.prototype.clone=function(e){return v.clone(this,e)},v.prototype.equals=function(e){return v.equals(this,e)},v.prototype.equalsEpsilon=function(e,t){return this===e||g(e)&&Math.abs(this.red-e.red)<=t&&Math.abs(this.green-e.green)<=t&&Math.abs(this.blue-e.blue)<=t&&Math.abs(this.alpha-e.alpha)<=t},v.prototype.toString=function(){return"("+this.red+", "+this.green+", "+this.blue+", "+this.alpha+")"},v.prototype.toCssColorString=function(){var e=v.floatToByte(this.red),t=v.floatToByte(this.green),r=v.floatToByte(this.blue);return 1===this.alpha?"rgb("+e+","+t+","+r+")":"rgba("+e+","+t+","+r+","+this.alpha+")"},v.prototype.toBytes=function(e){var t=v.floatToByte(this.red),r=v.floatToByte(this.green),i=v.floatToByte(this.blue),n=v.floatToByte(this.alpha);return g(e)?(e[0]=t,e[1]=r,e[2]=i,e[3]=n,e):[t,r,i,n]},v.prototype.toRgba=function(){return n[0]=v.floatToByte(this.red),n[1]=v.floatToByte(this.green),n[2]=v.floatToByte(this.blue),n[3]=v.floatToByte(this.alpha),i[0]},v.prototype.brighten=function(e,t){return f.typeOf.number("magnitude",e),f.typeOf.number.greaterThanOrEquals("magnitude",e,0),f.typeOf.object("result",t),e=1-e,t.red=1-(1-this.red)*e,t.green=1-(1-this.green)*e,t.blue=1-(1-this.blue)*e,t.alpha=this.alpha,t},v.prototype.darken=function(e,t){return f.typeOf.number("magnitude",e),f.typeOf.number.greaterThanOrEquals("magnitude",e,0),f.typeOf.object("result",t),e=1-e,t.red=this.red*e,t.green=this.green*e,t.blue=this.blue*e,t.alpha=this.alpha,t},v.prototype.withAlpha=function(e,t){return v.fromAlpha(this,e,t)},v.add=function(e,t,r){return f.typeOf.object("left",e),f.typeOf.object("right",t),f.typeOf.object("result",r),r.red=e.red+t.red,r.green=e.green+t.green,r.blue=e.blue+t.blue,r.alpha=e.alpha+t.alpha,r},v.subtract=function(e,t,r){return f.typeOf.object("left",e),f.typeOf.object("right",t),f.typeOf.object("result",r),r.red=e.red-t.red,r.green=e.green-t.green,r.blue=e.blue-t.blue,r.alpha=e.alpha-t.alpha,r},v.multiply=function(e,t,r){return f.typeOf.object("left",e),f.typeOf.object("right",t),f.typeOf.object("result",r),r.red=e.red*t.red,r.green=e.green*t.green,r.blue=e.blue*t.blue,r.alpha=e.alpha*t.alpha,r},v.divide=function(e,t,r){return f.typeOf.object("left",e),f.typeOf.object("right",t),f.typeOf.object("result",r),r.red=e.red/t.red,r.green=e.green/t.green,r.blue=e.blue/t.blue,r.alpha=e.alpha/t.alpha,r},v.mod=function(e,t,r){return f.typeOf.object("left",e),f.typeOf.object("right",t),f.typeOf.object("result",r),r.red=e.red%t.red,r.green=e.green%t.green,r.blue=e.blue%t.blue,r.alpha=e.alpha%t.alpha,r},v.multiplyByScalar=function(e,t,r){return f.typeOf.object("color",e),f.typeOf.number("scalar",t),f.typeOf.object("result",r),r.red=e.red*t,r.green=e.green*t,r.blue=e.blue*t,r.alpha=e.alpha*t,r},v.divideByScalar=function(e,t,r){return f.typeOf.object("color",e),f.typeOf.number("scalar",t),f.typeOf.object("result",r),r.red=e.red/t,r.green=e.green/t,r.blue=e.blue/t,r.alpha=e.alpha/t,r},v.ALICEBLUE=t(v.fromCssColorString("#F0F8FF")),v.ANTIQUEWHITE=t(v.fromCssColorString("#FAEBD7")),v.AQUA=t(v.fromCssColorString("#00FFFF")),v.AQUAMARINE=t(v.fromCssColorString("#7FFFD4")),v.AZURE=t(v.fromCssColorString("#F0FFFF")),v.BEIGE=t(v.fromCssColorString("#F5F5DC")),v.BISQUE=t(v.fromCssColorString("#FFE4C4")),v.BLACK=t(v.fromCssColorString("#000000")),v.BLANCHEDALMOND=t(v.fromCssColorString("#FFEBCD")),v.BLUE=t(v.fromCssColorString("#0000FF")),v.BLUEVIOLET=t(v.fromCssColorString("#8A2BE2")),v.BROWN=t(v.fromCssColorString("#A52A2A")),v.BURLYWOOD=t(v.fromCssColorString("#DEB887")),v.CADETBLUE=t(v.fromCssColorString("#5F9EA0")),v.CHARTREUSE=t(v.fromCssColorString("#7FFF00")),v.CHOCOLATE=t(v.fromCssColorString("#D2691E")),v.CORAL=t(v.fromCssColorString("#FF7F50")),v.CORNFLOWERBLUE=t(v.fromCssColorString("#6495ED")),v.CORNSILK=t(v.fromCssColorString("#FFF8DC")),v.CRIMSON=t(v.fromCssColorString("#DC143C")),v.CYAN=t(v.fromCssColorString("#00FFFF")),v.DARKBLUE=t(v.fromCssColorString("#00008B")),v.DARKCYAN=t(v.fromCssColorString("#008B8B")),v.DARKGOLDENROD=t(v.fromCssColorString("#B8860B")),v.DARKGRAY=t(v.fromCssColorString("#A9A9A9")),v.DARKGREEN=t(v.fromCssColorString("#006400")),v.DARKGREY=v.DARKGRAY,v.DARKKHAKI=t(v.fromCssColorString("#BDB76B")),v.DARKMAGENTA=t(v.fromCssColorString("#8B008B")),v.DARKOLIVEGREEN=t(v.fromCssColorString("#556B2F")),v.DARKORANGE=t(v.fromCssColorString("#FF8C00")),v.DARKORCHID=t(v.fromCssColorString("#9932CC")),v.DARKRED=t(v.fromCssColorString("#8B0000")),v.DARKSALMON=t(v.fromCssColorString("#E9967A")),v.DARKSEAGREEN=t(v.fromCssColorString("#8FBC8F")),v.DARKSLATEBLUE=t(v.fromCssColorString("#483D8B")),v.DARKSLATEGRAY=t(v.fromCssColorString("#2F4F4F")),v.DARKSLATEGREY=v.DARKSLATEGRAY,v.DARKTURQUOISE=t(v.fromCssColorString("#00CED1")),v.DARKVIOLET=t(v.fromCssColorString("#9400D3")),v.DEEPPINK=t(v.fromCssColorString("#FF1493")),v.DEEPSKYBLUE=t(v.fromCssColorString("#00BFFF")),v.DIMGRAY=t(v.fromCssColorString("#696969")),v.DIMGREY=v.DIMGRAY,v.DODGERBLUE=t(v.fromCssColorString("#1E90FF")),v.FIREBRICK=t(v.fromCssColorString("#B22222")),v.FLORALWHITE=t(v.fromCssColorString("#FFFAF0")),v.FORESTGREEN=t(v.fromCssColorString("#228B22")),v.FUCHSIA=t(v.fromCssColorString("#FF00FF")),v.GAINSBORO=t(v.fromCssColorString("#DCDCDC")),v.GHOSTWHITE=t(v.fromCssColorString("#F8F8FF")),v.GOLD=t(v.fromCssColorString("#FFD700")),v.GOLDENROD=t(v.fromCssColorString("#DAA520")),v.GRAY=t(v.fromCssColorString("#808080")),v.GREEN=t(v.fromCssColorString("#008000")),v.GREENYELLOW=t(v.fromCssColorString("#ADFF2F")),v.GREY=v.GRAY,v.HONEYDEW=t(v.fromCssColorString("#F0FFF0")),v.HOTPINK=t(v.fromCssColorString("#FF69B4")),v.INDIANRED=t(v.fromCssColorString("#CD5C5C")),v.INDIGO=t(v.fromCssColorString("#4B0082")),v.IVORY=t(v.fromCssColorString("#FFFFF0")),v.KHAKI=t(v.fromCssColorString("#F0E68C")),v.LAVENDER=t(v.fromCssColorString("#E6E6FA")),v.LAVENDAR_BLUSH=t(v.fromCssColorString("#FFF0F5")),v.LAWNGREEN=t(v.fromCssColorString("#7CFC00")),v.LEMONCHIFFON=t(v.fromCssColorString("#FFFACD")),v.LIGHTBLUE=t(v.fromCssColorString("#ADD8E6")),v.LIGHTCORAL=t(v.fromCssColorString("#F08080")),v.LIGHTCYAN=t(v.fromCssColorString("#E0FFFF")),v.LIGHTGOLDENRODYELLOW=t(v.fromCssColorString("#FAFAD2")),v.LIGHTGRAY=t(v.fromCssColorString("#D3D3D3")),v.LIGHTGREEN=t(v.fromCssColorString("#90EE90")),v.LIGHTGREY=v.LIGHTGRAY,v.LIGHTPINK=t(v.fromCssColorString("#FFB6C1")),v.LIGHTSEAGREEN=t(v.fromCssColorString("#20B2AA")),v.LIGHTSKYBLUE=t(v.fromCssColorString("#87CEFA")),v.LIGHTSLATEGRAY=t(v.fromCssColorString("#778899")),v.LIGHTSLATEGREY=v.LIGHTSLATEGRAY,v.LIGHTSTEELBLUE=t(v.fromCssColorString("#B0C4DE")),v.LIGHTYELLOW=t(v.fromCssColorString("#FFFFE0")),v.LIME=t(v.fromCssColorString("#00FF00")),v.LIMEGREEN=t(v.fromCssColorString("#32CD32")),v.LINEN=t(v.fromCssColorString("#FAF0E6")),v.MAGENTA=t(v.fromCssColorString("#FF00FF")),v.MAROON=t(v.fromCssColorString("#800000")),v.MEDIUMAQUAMARINE=t(v.fromCssColorString("#66CDAA")),v.MEDIUMBLUE=t(v.fromCssColorString("#0000CD")),v.MEDIUMORCHID=t(v.fromCssColorString("#BA55D3")),v.MEDIUMPURPLE=t(v.fromCssColorString("#9370DB")),v.MEDIUMSEAGREEN=t(v.fromCssColorString("#3CB371")),v.MEDIUMSLATEBLUE=t(v.fromCssColorString("#7B68EE")),v.MEDIUMSPRINGGREEN=t(v.fromCssColorString("#00FA9A")),v.MEDIUMTURQUOISE=t(v.fromCssColorString("#48D1CC")),v.MEDIUMVIOLETRED=t(v.fromCssColorString("#C71585")),v.MIDNIGHTBLUE=t(v.fromCssColorString("#191970")),v.MINTCREAM=t(v.fromCssColorString("#F5FFFA")),v.MISTYROSE=t(v.fromCssColorString("#FFE4E1")),v.MOCCASIN=t(v.fromCssColorString("#FFE4B5")),v.NAVAJOWHITE=t(v.fromCssColorString("#FFDEAD")),v.NAVY=t(v.fromCssColorString("#000080")),v.OLDLACE=t(v.fromCssColorString("#FDF5E6")),v.OLIVE=t(v.fromCssColorString("#808000")),v.OLIVEDRAB=t(v.fromCssColorString("#6B8E23")),v.ORANGE=t(v.fromCssColorString("#FFA500")),v.ORANGERED=t(v.fromCssColorString("#FF4500")),v.ORCHID=t(v.fromCssColorString("#DA70D6")),v.PALEGOLDENROD=t(v.fromCssColorString("#EEE8AA")),v.PALEGREEN=t(v.fromCssColorString("#98FB98")),v.PALETURQUOISE=t(v.fromCssColorString("#AFEEEE")),v.PALEVIOLETRED=t(v.fromCssColorString("#DB7093")),v.PAPAYAWHIP=t(v.fromCssColorString("#FFEFD5")),v.PEACHPUFF=t(v.fromCssColorString("#FFDAB9")),v.PERU=t(v.fromCssColorString("#CD853F")),v.PINK=t(v.fromCssColorString("#FFC0CB")),v.PLUM=t(v.fromCssColorString("#DDA0DD")),v.POWDERBLUE=t(v.fromCssColorString("#B0E0E6")),v.PURPLE=t(v.fromCssColorString("#800080")),v.RED=t(v.fromCssColorString("#FF0000")),v.ROSYBROWN=t(v.fromCssColorString("#BC8F8F")),v.ROYALBLUE=t(v.fromCssColorString("#4169E1")),v.SADDLEBROWN=t(v.fromCssColorString("#8B4513")),v.SALMON=t(v.fromCssColorString("#FA8072")),v.SANDYBROWN=t(v.fromCssColorString("#F4A460")),v.SEAGREEN=t(v.fromCssColorString("#2E8B57")),v.SEASHELL=t(v.fromCssColorString("#FFF5EE")),v.SIENNA=t(v.fromCssColorString("#A0522D")),v.SILVER=t(v.fromCssColorString("#C0C0C0")),v.SKYBLUE=t(v.fromCssColorString("#87CEEB")),v.SLATEBLUE=t(v.fromCssColorString("#6A5ACD")),v.SLATEGRAY=t(v.fromCssColorString("#708090")),v.SLATEGREY=v.SLATEGRAY,v.SNOW=t(v.fromCssColorString("#FFFAFA")),v.SPRINGGREEN=t(v.fromCssColorString("#00FF7F")),v.STEELBLUE=t(v.fromCssColorString("#4682B4")),v.TAN=t(v.fromCssColorString("#D2B48C")),v.TEAL=t(v.fromCssColorString("#008080")),v.THISTLE=t(v.fromCssColorString("#D8BFD8")),v.TOMATO=t(v.fromCssColorString("#FF6347")),v.TURQUOISE=t(v.fromCssColorString("#40E0D0")),v.VIOLET=t(v.fromCssColorString("#EE82EE")),v.WHEAT=t(v.fromCssColorString("#F5DEB3")),v.WHITE=t(v.fromCssColorString("#FFFFFF")),v.WHITESMOKE=t(v.fromCssColorString("#F5F5F5")),v.YELLOW=t(v.fromCssColorString("#FFFF00")),v.YELLOWGREEN=t(v.fromCssColorString("#9ACD32")),v.TRANSPARENT=t(new v(0,0,0,0)),v}),define("Core/ClippingPlaneCollection",["./Cartesian3","./Cartesian4","./Check","./Color","./defaultValue","./defined","./defineProperties","./DeveloperError","./FeatureDetection","./Intersect","./Matrix4","./Plane"],function(u,c,d,o,r,h,e,t,i,p,f,m){"use strict";function a(e){var t=(e=r(e,r.EMPTY_OBJECT)).planes;h(t)?this._planes=t.slice(0):this._planes=[],this.enabled=r(e.enabled,!0),this.modelMatrix=f.clone(r(e.modelMatrix,f.IDENTITY)),this.edgeColor=o.clone(r(e.edgeColor,o.WHITE)),this.edgeWidth=r(e.edgeWidth,0),this._testIntersection=void 0,this._unionClippingRegions=void 0,this.unionClippingRegions=r(e.unionClippingRegions,!1)}function n(e){return e===p.OUTSIDE}function s(e){return e===p.INSIDE}function l(e,t){for(var r=e.length,i=0;i<r;++i)if(m.equals(e[i],t))return i;return-1}e(a.prototype,{length:{get:function(){return this._planes.length}},unionClippingRegions:{get:function(){return this._unionClippingRegions},set:function(e){this._unionClippingRegions!==e&&(this._unionClippingRegions=e,this._testIntersection=e?n:s)}}}),a.prototype.add=function(e){if(this.length>=a.MAX_CLIPPING_PLANES)throw new t("The maximum number of clipping planes supported is "+a.MAX_CLIPPING_PLANES);this._planes.push(e)},a.prototype.get=function(e){return d.typeOf.number("index",e),this._planes[e]},a.prototype.contains=function(e){return-1!==l(this._planes,e)},a.prototype.remove=function(e){var t=this._planes,r=l(t,e);if(-1===r)return!1;for(var i=t.length-1,n=r;n<i;++n)t[n]=t[n+1];return t.length=i,!0},a.prototype.removeAll=function(){this._planes=[]};var g=new m(u.UNIT_X,0),_=new f;return a.prototype.transformAndPackPlanes=function(e,t){d.typeOf.object("viewMatrix",e);var r,i=this._planes,n=i.length,o=0;for(h(t)?(o=t.length,t.length=n):t=new Array(n),r=o;r<n;++r)t[r]=new c;var a=f.multiply(e,this.modelMatrix,_);for(r=0;r<n;++r){var s=i[r],l=t[r];m.transform(s,a,g),u.clone(g.normal,l),l.w=g.distance}return t},a.prototype.clone=function(e){h(e)||(e=new a);var t,r=this.length;if(e.length!==r){var i=e._planes,n=i.length;for(i.length=r,t=n;t<r;++t)e._planes[t]=new m(u.UNIT_X,0)}for(t=0;t<r;++t)m.clone(this._planes[t],e._planes[t]);return e.enabled=this.enabled,f.clone(this.modelMatrix,e.modelMatrix),e.unionClippingRegions=this.unionClippingRegions,o.clone(this.edgeColor,e.edgeColor),e.edgeWidth=this.edgeWidth,e},a.prototype.computeIntersectionWithBoundingVolume=function(e,t){var r=this._planes,i=r.length,n=this.modelMatrix;h(t)&&(n=f.multiply(n,t,_));var o=p.INSIDE;!this.unionClippingRegions&&0<i&&(o=p.OUTSIDE);for(var a=0;a<i;++a){var s=r[a];m.transform(s,n,g);var l=e.intersectPlane(g);if(l===p.INTERSECTING)o=l;else if(this._testIntersection(l))return l}return o},a.isSupported=function(){return!i.isInternetExplorer()},a.MAX_CLIPPING_PLANES=6,a}),define("Core/ClockRange",["./freezeObject"],function(e){"use strict";return e({UNBOUNDED:0,CLAMPED:1,LOOP_STOP:2})}),define("Core/ClockStep",["./freezeObject"],function(e){"use strict";return e({TICK_DEPENDENT:0,SYSTEM_CLOCK_MULTIPLIER:1,SYSTEM_CLOCK:2})}),define("Core/getTimestamp",["./defined"],function(e){"use strict";return"undefined"!=typeof performance&&"function"==typeof performance.now&&isFinite(performance.now())?function(){return performance.now()}:function(){return Date.now()}}),define("Core/Clock",["./ClockRange","./ClockStep","./defaultValue","./defined","./defineProperties","./DeveloperError","./Event","./getTimestamp","./JulianDate"],function(l,u,n,o,e,a,s,c,d){"use strict";function t(e){var t=(e=n(e,n.EMPTY_OBJECT)).currentTime,r=e.startTime,i=e.stopTime;if(t=o(t)?d.clone(t):o(r)?d.clone(r):o(i)?d.addDays(i,-1,new d):d.now(),r=o(r)?d.clone(r):d.clone(t),i=o(i)?d.clone(i):d.addDays(r,1,new d),d.greaterThan(r,i))throw new a("startTime must come before stopTime.");this.startTime=r,this.stopTime=i,this.clockRange=n(e.clockRange,l.UNBOUNDED),this.canAnimate=n(e.canAnimate,!0),this.onTick=new s,this._currentTime=void 0,this._multiplier=void 0,this._clockStep=void 0,this._shouldAnimate=void 0,this._lastSystemTime=c(),this.currentTime=t,this.multiplier=n(e.multiplier,1),this.shouldAnimate=n(e.shouldAnimate,!1),this.clockStep=n(e.clockStep,u.SYSTEM_CLOCK_MULTIPLIER)}return e(t.prototype,{currentTime:{get:function(){return this._currentTime},set:function(e){d.equals(this._currentTime,e)||(this._clockStep===u.SYSTEM_CLOCK&&(this._clockStep=u.SYSTEM_CLOCK_MULTIPLIER),this._currentTime=e)}},multiplier:{get:function(){return this._multiplier},set:function(e){this._multiplier!==e&&(this._clockStep===u.SYSTEM_CLOCK&&(this._clockStep=u.SYSTEM_CLOCK_MULTIPLIER),this._multiplier=e)}},clockStep:{get:function(){return this._clockStep},set:function(e){e===u.SYSTEM_CLOCK&&(this._multiplier=1,this._shouldAnimate=!0,this._currentTime=d.now()),this._clockStep=e}},shouldAnimate:{get:function(){return this._shouldAnimate},set:function(e){this._shouldAnimate!==e&&(this._clockStep===u.SYSTEM_CLOCK&&(this._clockStep=u.SYSTEM_CLOCK_MULTIPLIER),this._shouldAnimate=e)}}}),t.prototype.tick=function(){var e=c(),t=d.clone(this._currentTime);if(this.canAnimate&&this._shouldAnimate){var r=this._clockStep;if(r===u.SYSTEM_CLOCK)t=d.now(t);else{var i=this._multiplier;if(r===u.TICK_DEPENDENT)t=d.addSeconds(t,i,t);else{var n=e-this._lastSystemTime;t=d.addSeconds(t,i*(n/1e3),t)}var o=this.clockRange,a=this.startTime,s=this.stopTime;if(o===l.CLAMPED)d.lessThan(t,a)?t=d.clone(a,t):d.greaterThan(t,s)&&(t=d.clone(s,t));else if(o===l.LOOP_STOP)for(d.lessThan(t,a)&&(t=d.clone(a,t));d.greaterThan(t,s);)t=d.addSeconds(a,d.secondsDifference(t,s),t)}}return this._currentTime=t,this._lastSystemTime=e,this.onTick.raiseEvent(this),t},t}),define("Core/ColorGeometryInstanceAttribute",["./Color","./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError"],function(n,e,o,r,t,i){"use strict";function a(e,t,r,i){e=o(e,1),t=o(t,1),r=o(r,1),i=o(i,1),this.value=new Uint8Array([n.floatToByte(e),n.floatToByte(t),n.floatToByte(r),n.floatToByte(i)])}return t(a.prototype,{componentDatatype:{get:function(){return e.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 4}},normalize:{get:function(){return!0}}}),a.fromColor=function(e){if(!r(e))throw new i("color is required.");return new a(e.red,e.green,e.blue,e.alpha)},a.toValue=function(e,t){if(!r(e))throw new i("color is required.");return r(t)?e.toBytes(t):new Uint8Array(e.toBytes())},a.equals=function(e,t){return e===t||r(e)&&r(t)&&e.value[0]===t.value[0]&&e.value[1]===t.value[1]&&e.value[2]===t.value[2]&&e.value[3]===t.value[3]},a}),define("Core/CompressedTextureBuffer",["./defined","./defineProperties"],function(t,e){"use strict";function r(e,t,r,i){this._format=e,this._width=t,this._height=r,this._buffer=i}return e(r.prototype,{internalFormat:{get:function(){return this._format}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},bufferView:{get:function(){return this._buffer}}}),r.clone=function(e){if(t(e))return new r(e._format,e._width,e._height,e._buffer)},r.prototype.clone=function(){return r.clone(this)},r}),define("Core/CornerType",["./freezeObject"],function(e){"use strict";return e({ROUNDED:0,MITERED:1,BEVELED:2})}),define("Core/EllipsoidGeodesic",["./Cartesian3","./Cartographic","./Check","./defaultValue","./defined","./defineProperties","./Ellipsoid","./Math"],function(I,M,R,n,A,e,o,k){"use strict";function F(e,t,r,i,n,o,a){var s,l,u=(s=e)*(l=r)*(4+s*(4-3*l))/16;return(1-u)*e*t*(i+u*n*(a+u*o*(2*a*a-1)))}var L=new I,N=new I;function a(e,t,r,i){var n,o,a,s,l,u,c,d,h,p,f,m,g,_,v,y,b,C,w,S,T,E,A,x,P,D=I.normalize(i.cartographicToCartesian(t,N),L),O=I.normalize(i.cartographicToCartesian(r,N),N);R.typeOf.number.greaterThanOrEquals("value",Math.abs(Math.abs(I.angleBetween(D,O))-Math.PI),.0125),function(e,t,r,i,n,o,a){var s,l,u,c,d,h=(t-r)/t,p=o-i,f=Math.atan((1-h)*Math.tan(n)),m=Math.atan((1-h)*Math.tan(a)),g=Math.cos(f),_=Math.sin(f),v=Math.cos(m),y=Math.sin(m),b=g*v,C=g*y,w=_*y,S=_*v,T=p,E=k.TWO_PI,A=Math.cos(T),x=Math.sin(T);do{A=Math.cos(T),x=Math.sin(T);var P,D=C-S*A;u=Math.sqrt(v*v*x*x+D*D),l=w+b*A,s=Math.atan2(u,l),E=T,d=l-2*w/(c=0===u?(P=0,1):1-(P=b*x/u)*P),isNaN(d)&&(d=0),T=p+F(h,P,c,s,u,l,d)}while(Math.abs(T-E)>k.EPSILON12);var O=c*(t*t-r*r)/(r*r),I=O*(256+O*(O*(74-47*O)-128))/1024,M=d*d,R=r*(1+O*(4096+O*(O*(320-175*O)-768))/16384)*(s-I*u*(d+I*(l*(2*M-1)-I*d*(4*u*u-3)*(4*M-3)/6)/4)),L=Math.atan2(v*x,C-S*A),N=Math.atan2(g*x,C*A-S);e._distance=R,e._startHeading=L,e._endHeading=N,e._uSquared=O}(e,i.maximumRadius,i.minimumRadius,t.longitude,t.latitude,r.longitude,r.latitude),e._start=M.clone(t,e._start),e._end=M.clone(r,e._end),e._start.height=0,e._end.height=0,o=(n=e)._uSquared,a=n._ellipsoid.maximumRadius,s=n._ellipsoid.minimumRadius,l=(a-s)/a,u=Math.cos(n._startHeading),c=Math.sin(n._startHeading),d=(1-l)*Math.tan(n._start.latitude),h=1/Math.sqrt(1+d*d),p=h*d,f=Math.atan2(d,u),_=1-(g=(m=h*c)*m),v=Math.sqrt(_),E=1-3*(y=o/4)+35*(b=y*y)/4,A=1-5*y,x=(S=1+y-3*b/4+5*(C=b*y)/4-175*(w=b*b)/64)*f-(T=1-y+15*b/8-35*C/8)*Math.sin(2*f)*y/2-E*Math.sin(4*f)*b/16-A*Math.sin(6*f)*C/48-5*Math.sin(8*f)*w/512,(P=n._constants).a=a,P.b=s,P.f=l,P.cosineHeading=u,P.sineHeading=c,P.tanU=d,P.cosineU=h,P.sineU=p,P.sigma=f,P.sineAlpha=m,P.sineSquaredAlpha=g,P.cosineSquaredAlpha=_,P.cosineAlpha=v,P.u2Over4=y,P.u4Over16=b,P.u6Over64=C,P.u8Over256=w,P.a0=S,P.a1=T,P.a2=E,P.a3=A,P.distanceRatio=x}function t(e,t,r){var i=n(r,o.WGS84);this._ellipsoid=i,this._start=new M,this._end=new M,this._constants={},this._startHeading=void 0,this._endHeading=void 0,this._distance=void 0,this._uSquared=void 0,A(e)&&A(t)&&a(this,e,t,i)}return e(t.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){return R.defined("distance",this._distance),this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},startHeading:{get:function(){return R.defined("distance",this._distance),this._startHeading}},endHeading:{get:function(){return R.defined("distance",this._distance),this._endHeading}}}),t.prototype.setEndPoints=function(e,t){R.defined("start",e),R.defined("end",t),a(this,e,t,this._ellipsoid)},t.prototype.interpolateUsingFraction=function(e,t){return this.interpolateUsingSurfaceDistance(this._distance*e,t)},t.prototype.interpolateUsingSurfaceDistance=function(e,t){R.defined("distance",this._distance);var r=this._constants,i=r.distanceRatio+e/r.b,n=Math.cos(2*i),o=Math.cos(4*i),a=Math.cos(6*i),s=Math.sin(2*i),l=Math.sin(4*i),u=Math.sin(6*i),c=Math.sin(8*i),d=i*i,h=i*d,p=r.u8Over256,f=r.u2Over4,m=r.u6Over64,g=r.u4Over16,_=2*h*p*n/3+i*(1-f+7*g/4-15*m/4+579*p/64-(g-15*m/4+187*p/16)*n-(5*m/4-115*p/16)*o-29*p*a/16)+(f/2-g+71*m/32-85*p/16)*s+(5*g/16-5*m/4+383*p/96)*l-d*((m-11*p/2)*s+5*p*l/2)+(29*m/96-29*p/16)*u+539*p*c/1536,v=Math.asin(Math.sin(_)*r.cosineAlpha),y=Math.atan(r.a/r.b*Math.tan(v));_-=r.sigma;var b=Math.cos(2*r.sigma+_),C=Math.sin(_),w=Math.cos(_),S=r.cosineU*w,T=r.sineU*C,E=Math.atan2(C*r.sineHeading,S-T*r.cosineHeading)-F(r.f,r.sineAlpha,r.cosineSquaredAlpha,_,C,w,b);return A(t)?(t.longitude=this._start.longitude+E,t.latitude=y,t.height=0,t):new M(this._start.longitude+E,y,0)},t}),define("Core/PolylinePipeline",["./Cartesian3","./Cartographic","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./EllipsoidGeodesic","./IntersectionTests","./isArray","./Math","./Matrix4","./Plane"],function(y,e,v,b,C,w,t,_,S,T,E,A){"use strict";var x={numberOfPoints:function(e,t,r){var i=y.distance(e,t);return Math.ceil(i/r)}},a=new e;x.extractHeights=function(e,t){for(var r=e.length,i=new Array(r),n=0;n<r;n++){var o=e[n];i[n]=t.cartesianToCartographic(o,a).height}return i};var P=new E,D=new y,O=new y,I=new A(y.UNIT_X,0),M=new y,R=new A(y.UNIT_X,0),L=new y,N=new y,k=[];var F=new e,B=new e,U=new y,V=new y,z=new y,q=new t;function G(e,t,r,i,n,o,a,s){var l=i.scaleToGeodeticSurface(e,V),u=i.scaleToGeodeticSurface(t,z),c=x.numberOfPoints(e,t,r),d=i.cartesianToCartographic(l,F),h=i.cartesianToCartographic(u,B),p=function(e,t,r){var i,n=k;if(n.length=e,t===r){for(i=0;i<e;i++)n[i]=t;return n}var o=(r-t)/e;for(i=0;i<e;i++){var a=t+i*o;n[i]=a}return n}(c,n,o);q.setEndPoints(d,h);var f=q.surfaceDistance/c,m=s;d.height=n;var g=i.cartographicToCartesian(d,U);y.pack(g,a,m),m+=3;for(var _=1;_<c;_++){var v=q.interpolateUsingSurfaceDistance(_*f,B);v.height=p[_],g=i.cartographicToCartesian(v,U),y.pack(g,a,m),m+=3}return m}return x.wrapLongitude=function(e,t){var r=[],i=[];if(b(e)&&0<e.length){t=v(t,E.IDENTITY);var n=E.inverseTransformation(t,P),o=E.multiplyByPoint(n,y.ZERO,D),a=y.normalize(E.multiplyByPointAsVector(n,y.UNIT_Y,O),O),s=A.fromPointNormal(o,a,I),l=y.normalize(E.multiplyByPointAsVector(n,y.UNIT_X,M),M),u=A.fromPointNormal(o,l,R),c=1;r.push(y.clone(e[0]));for(var d=r[0],h=e.length,p=1;p<h;++p){var f=e[p];if(A.getPointDistance(u,d)<0||A.getPointDistance(u,f)<0){var m=_.lineSegmentPlane(d,f,s,L);if(b(m)){var g=y.multiplyByScalar(a,5e-9,N);A.getPointDistance(s,d)<0&&y.negate(g,g),r.push(y.add(m,g,new y)),i.push(c+1),y.negate(g,g),r.push(y.add(m,g,new y)),c=1}}r.push(y.clone(e[p])),c++,d=f}i.push(c)}return{positions:r,lengths:i}},x.generateArc=function(e){b(e)||(e={});var t=e.positions;if(!b(t))throw new C("options.positions is required.");var r=t.length,i=v(e.ellipsoid,w.WGS84),n=v(e.height,0),o=S(n);if(r<1)return[];if(1===r){var a=i.scaleToGeodeticSurface(t[0],V);if(0!==(n=o?n[0]:n)){var s=i.geodeticSurfaceNormal(a,U);y.multiplyByScalar(s,n,s),y.add(a,s,a)}return[a.x,a.y,a.z]}var l=e.minDistance;if(!b(l)){var u=v(e.granularity,T.RADIANS_PER_DEGREE);l=T.chordLength(u,i.maximumRadius)}var c,d=0;for(c=0;c<r-1;c++)d+=x.numberOfPoints(t[c],t[c+1],l);var h=3*(d+1),p=new Array(h),f=0;for(c=0;c<r-1;c++){f=G(t[c],t[c+1],l,i,o?n[c]:n,o?n[c+1]:n,p,f)}k.length=0;var m=t[r-1],g=i.cartesianToCartographic(m,F);g.height=o?n[r-1]:n;var _=i.cartographicToCartesian(g,U);return y.pack(_,p,h-3),p},x.generateCartesianArc=function(e){for(var t=x.generateArc(e),r=t.length/3,i=new Array(r),n=0;n<r;n++)i[n]=y.unpack(t,3*n);return i},x}),define("Core/PolylineVolumeGeometryLibrary",["./Cartesian2","./Cartesian3","./Cartesian4","./Cartographic","./CornerType","./EllipsoidTangentPlane","./Math","./Matrix3","./Matrix4","./PolylinePipeline","./Quaternion","./Transforms"],function(C,B,e,t,U,w,V,S,T,z,g,E){"use strict";var q=[new B,new B],G=new B,W=new B,H=new B,j=new B,Y=new B,X=new B,Q=new B,Z=new B,K=new B,J=new B,_=new B,$={},ee=new t;function te(e,t,r,i){var n,o=e[0],a=e[1],s=B.angleBetween(o,a),l=Math.ceil(s/i),u=new Array(l);if(t===r){for(n=0;n<l;n++)u[n]=t;return u.push(r),u}var c=(r-t)/l;for(n=1;n<l;n++){var d=t+n*c;u[n]=d}return u[0]=t,u.push(r),u}var A=new B,x=new B;var P=new B(-1,0,0),D=new T,O=new T,I=new S,M=S.IDENTITY.clone(),R=new B,L=new e,N=new B;function re(e,t,r,i,n,o,a,s){var l=R,u=L;D=E.eastNorthUpToFixedFrame(e,n,D),l=T.multiplyByPointAsVector(D,P,l),l=B.normalize(l,l);var c,d,h,p,f,m,g,_=(c=l,d=t,p=new w(h=e,n),f=p.projectPointOntoPlane(B.add(h,c,A),A),m=p.projectPointOntoPlane(B.add(h,d,x),x),g=C.angleBetween(f,m),0<=m.x*f.y-m.y*f.x?-g:g);I=S.fromRotationZ(_,I),N.z=o,D=T.multiplyTransformation(D,T.fromRotationTranslation(I,N,O),D);var v=M;v[0]=a;for(var y=0;y<s;y++)for(var b=0;b<r.length;b+=3)u=B.fromArray(r,b,u),u=S.multiplyByVector(v,u,u),u=T.multiplyByPoint(D,u,u),i.push(u.x,u.y,u.z);return i}var l=new B;function ie(e,t,r,i,n,o,a){for(var s=0;s<e.length;s+=3){i=re(B.fromArray(e,s,l),t,r,i,n,o[s/3],a,1)}return i}function ne(e,t){for(var r=e.length,i=new Array(3*r),n=0,o=t.x+t.width/2,a=t.y+t.height/2,s=0;s<r;s++)i[n++]=e[s].x-o,i[n++]=0,i[n++]=e[s].y-a;return i}var v=new g,y=new B,b=new S;function oe(e,t,r,i,n,o,a,s,l,u){var c,d,h=B.angleBetween(B.subtract(t,e,J),B.subtract(r,e,_)),p=i===U.BEVELED?0:Math.ceil(h/V.toRadians(5));if(c=n?S.fromQuaternion(g.fromAxisAngle(B.negate(e,J),h/(p+1),v),b):S.fromQuaternion(g.fromAxisAngle(e,h/(p+1),v),b),t=B.clone(t,y),0<p)for(var f=u?2:1,m=0;m<p;m++)t=S.multiplyByVector(c,t,t),d=B.subtract(t,e,J),d=B.normalize(d,d),n||(d=B.negate(d,d)),a=re(o.scaleToGeodeticSurface(t,_),d,s,a,o,l,1,f);else d=B.subtract(t,e,J),d=B.normalize(d,d),n||(d=B.negate(d,d)),a=re(o.scaleToGeodeticSurface(t,_),d,s,a,o,l,1,1),r=B.clone(r,y),d=B.subtract(r,e,J),d=B.normalize(d,d),n||(d=B.negate(d,d)),a=re(o.scaleToGeodeticSurface(r,_),d,s,a,o,l,1,1);return a}$.removeDuplicatesFromShape=function(e){for(var t=e.length,r=[],i=t-1,n=0;n<t;i=n++){var o=e[i],a=e[n];C.equals(o,a)||r.push(a)}return r},$.angleIsGreaterThanPi=function(e,t,r,i){var n=new w(r,i),o=n.projectPointOntoPlane(B.add(r,e,A),A),a=n.projectPointOntoPlane(B.add(r,t,x),x);return 0<=a.x*o.y-a.y*o.x};var ae=new B,se=new B;return $.computePositions=function(e,t,r,i,n){var o=i._ellipsoid,a=function(e,t){for(var r=new Array(e.length),i=0;i<e.length;i++){var n=e[i];ee=t.cartesianToCartographic(n,ee),r[i]=ee.height,e[i]=t.scaleToGeodeticSurface(n,n)}return r}(e,o),s=i._granularity,l=i._cornerType,u=n?function(e,t){var r=e.length,i=new Array(6*r),n=0,o=t.x+t.width/2,a=t.y+t.height/2,s=e[0];i[n++]=s.x-o,i[n++]=0,i[n++]=s.y-a;for(var l=1;l<r;l++){var u=(s=e[l]).x-o,c=s.y-a;i[n++]=u,i[n++]=0,i[n++]=c,i[n++]=u,i[n++]=0,i[n++]=c}return s=e[0],i[n++]=s.x-o,i[n++]=0,i[n++]=s.y-a,i}(t,r):ne(t,r),c=n?ne(t,r):void 0,d=r.height/2,h=r.width/2,p=e.length,f=[],m=n?[]:void 0,g=G,_=W,v=H,y=j,b=Y,C=X,w=Q,S=Z,T=K,E=e[0],A=e[1];y=o.geodeticSurfaceNormal(E,y),g=B.subtract(A,E,g),g=B.normalize(g,g),S=B.cross(y,g,S),S=B.normalize(S,S);var x,P=a[0],D=a[1];n&&(m=re(E,S,c,m,o,P+d,1,1)),T=B.clone(E,T),E=A,_=B.negate(g,_);for(var O=1;O<p-1;O++){var I=n?2:1;A=e[O+1],g=B.subtract(A,E,g),g=B.normalize(g,g),v=B.add(g,_,v),v=B.normalize(v,v),y=o.geodeticSurfaceNormal(E,y);var M=B.multiplyByScalar(y,B.dot(g,y),ae);B.subtract(g,M,M),B.normalize(M,M);var R=B.multiplyByScalar(y,B.dot(_,y),se);if(B.subtract(_,R,R),B.normalize(R,R),!V.equalsEpsilon(Math.abs(B.dot(M,R)),1,V.EPSILON7)){v=B.cross(v,y,v),v=B.cross(y,v,v),v=B.normalize(v,v);var L=1/Math.max(.25,B.magnitude(B.cross(v,_,J))),N=$.angleIsGreaterThanPi(g,_,E,o);T=(N?(b=B.add(E,B.multiplyByScalar(v,L*h,v),b),C=B.add(b,B.multiplyByScalar(S,h,C),C),q[0]=B.clone(T,q[0]),q[1]=B.clone(C,q[1]),x=te(q,P+d,D+d,s),f=ie(z.generateArc({positions:q,granularity:s,ellipsoid:o}),S,u,f,o,x,1),S=B.cross(y,g,S),S=B.normalize(S,S),w=B.add(b,B.multiplyByScalar(S,h,w),w),l===U.ROUNDED||l===U.BEVELED?oe(b,C,w,l,N,o,f,u,D+d,n):f=re(E,v=B.negate(v,v),u,f,o,D+d,L,I)):(b=B.add(E,B.multiplyByScalar(v,L*h,v),b),C=B.add(b,B.multiplyByScalar(S,-h,C),C),q[0]=B.clone(T,q[0]),q[1]=B.clone(C,q[1]),x=te(q,P+d,D+d,s),f=ie(z.generateArc({positions:q,granularity:s,ellipsoid:o}),S,u,f,o,x,1),S=B.cross(y,g,S),S=B.normalize(S,S),w=B.add(b,B.multiplyByScalar(S,-h,w),w),l===U.ROUNDED||l===U.BEVELED?oe(b,C,w,l,N,o,f,u,D+d,n):f=re(E,v,u,f,o,D+d,L,I)),B.clone(w,T)),_=B.negate(g,_)}else f=re(T,S,u,f,o,P+d,1,1),T=E;P=D,D=a[O+1],E=A}q[0]=B.clone(T,q[0]),q[1]=B.clone(E,q[1]),x=te(q,P+d,D+d,s),f=ie(z.generateArc({positions:q,granularity:s,ellipsoid:o}),S,u,f,o,x,1),n&&(m=re(E,S,c,m,o,D+d,1,1)),p=f.length;var k=n?p+m.length:p,F=new Float64Array(k);return F.set(f),n&&F.set(m,p),F},$}),define("Core/CorridorGeometryLibrary",["./Cartesian3","./CornerType","./defined","./Math","./Matrix3","./PolylinePipeline","./PolylineVolumeGeometryLibrary","./Quaternion"],function(O,I,s,M,h,R,L,p){"use strict";var e={},N=new O,f=new O,m=new O,g=new O,k=[new O,new O],F=new O,B=new O,U=new O,V=new O,z=new O,q=new O,G=new O,W=new O,H=new O,j=new O,_=new p,v=new h;function Y(e,t,r,i,n){var o,a=O.angleBetween(O.subtract(t,e,N),O.subtract(r,e,f)),s=i===I.BEVELED?1:Math.ceil(a/M.toRadians(5))+1,l=3*s,u=new Array(l);u[l-3]=r.x,u[l-2]=r.y,u[l-1]=r.z,o=n?h.fromQuaternion(p.fromAxisAngle(O.negate(e,N),a/s,_),v):h.fromQuaternion(p.fromAxisAngle(e,a/s,_),v);var c=0;t=O.clone(t,N);for(var d=0;d<s;d++)t=h.multiplyByVector(o,t,t),u[c++]=t.x,u[c++]=t.y,u[c++]=t.z;return u}function X(e,t,r,i){var n=N;return[(n=(i||(t=O.negate(t,t)),O.add(e,t,n))).x,n.y,n.z,r.x,r.y,r.z]}function Q(e,t,r,i){for(var n=new Array(e.length),o=new Array(e.length),a=O.multiplyByScalar(t,r,N),s=O.negate(a,f),l=0,u=e.length-1,c=0;c<e.length;c+=3){var d=O.fromArray(e,c,m),h=O.add(d,s,g);n[l++]=h.x,n[l++]=h.y,n[l++]=h.z;var p=O.add(d,a,g);o[u--]=p.z,o[u--]=p.y,o[u--]=p.x}return i.push(n,o),i}e.addAttribute=function(e,t,r,i){var n=t.x,o=t.y,a=t.z;s(r)&&(e[r]=n,e[r+1]=o,e[r+2]=a),s(i)&&(e[i]=a,e[i-1]=o,e[i-2]=n)};var Z=new O,K=new O;return e.computePositions=function(e){var t=e.granularity,r=e.positions,i=e.ellipsoid,n=e.width/2,o=e.cornerType,a=e.saveAttributes,s=F,l=B,u=U,c=V,d=z,h=q,p=G,f=W,m=H,g=j,_=[],v=a?[]:void 0,y=a?[]:void 0,b=r[0],C=r[1];l=O.normalize(O.subtract(C,b,l),l),s=i.geodeticSurfaceNormal(b,s),c=O.normalize(O.cross(s,l,c),c),a&&(v.push(c.x,c.y,c.z),y.push(s.x,s.y,s.z)),p=O.clone(b,p),b=C,u=O.negate(l,u);var w,S,T=[],E=r.length;for(w=1;w<E-1;w++){s=i.geodeticSurfaceNormal(b,s),C=r[w+1],l=O.normalize(O.subtract(C,b,l),l),d=O.normalize(O.add(l,u,d),d);var A=O.multiplyByScalar(s,O.dot(l,s),Z);O.subtract(l,A,A),O.normalize(A,A);var x=O.multiplyByScalar(s,O.dot(u,s),K);if(O.subtract(u,x,x),O.normalize(x,x),!M.equalsEpsilon(Math.abs(O.dot(A,x)),1,M.EPSILON7)){d=O.cross(d,s,d),d=O.cross(s,d,d),d=O.normalize(d,d);var P=n/Math.max(.25,O.magnitude(O.cross(d,u,N))),D=L.angleIsGreaterThanPi(l,u,b,i);d=O.multiplyByScalar(d,P,d),D?(f=O.add(b,d,f),g=O.add(f,O.multiplyByScalar(c,n,g),g),m=O.add(f,O.multiplyByScalar(c,2*n,m),m),k[0]=O.clone(p,k[0]),k[1]=O.clone(g,k[1]),_=Q(R.generateArc({positions:k,granularity:t,ellipsoid:i}),c,n,_),a&&(v.push(c.x,c.y,c.z),y.push(s.x,s.y,s.z)),h=O.clone(m,h),c=O.normalize(O.cross(s,l,c),c),m=O.add(f,O.multiplyByScalar(c,2*n,m),m),p=O.add(f,O.multiplyByScalar(c,n,p),p),o===I.ROUNDED||o===I.BEVELED?T.push({leftPositions:Y(f,h,m,o,D)}):T.push({leftPositions:X(b,O.negate(d,d),m,D)})):(m=O.add(b,d,m),g=O.add(m,O.negate(O.multiplyByScalar(c,n,g),g),g),f=O.add(m,O.negate(O.multiplyByScalar(c,2*n,f),f),f),k[0]=O.clone(p,k[0]),k[1]=O.clone(g,k[1]),_=Q(R.generateArc({positions:k,granularity:t,ellipsoid:i}),c,n,_),a&&(v.push(c.x,c.y,c.z),y.push(s.x,s.y,s.z)),h=O.clone(f,h),c=O.normalize(O.cross(s,l,c),c),f=O.add(m,O.negate(O.multiplyByScalar(c,2*n,f),f),f),p=O.add(m,O.negate(O.multiplyByScalar(c,n,p),p),p),o===I.ROUNDED||o===I.BEVELED?T.push({rightPositions:Y(m,h,f,o,D)}):T.push({rightPositions:X(b,d,f,D)})),u=O.negate(l,u)}b=C}return s=i.geodeticSurfaceNormal(b,s),k[0]=O.clone(p,k[0]),k[1]=O.clone(b,k[1]),_=Q(R.generateArc({positions:k,granularity:t,ellipsoid:i}),c,n,_),a&&(v.push(c.x,c.y,c.z),y.push(s.x,s.y,s.z)),o===I.ROUNDED&&(S=function(e){var t=F,r=B,i=U,n=e[1];r=O.fromArray(e[1],n.length-3,r),i=O.fromArray(e[0],0,i);var o=Y(t=O.multiplyByScalar(O.add(r,i,t),.5,t),r,i,I.ROUNDED,!1),a=e.length-1,s=e[a-1];return n=e[a],r=O.fromArray(s,s.length-3,r),i=O.fromArray(n,0,i),[o,Y(t=O.multiplyByScalar(O.add(r,i,t),.5,t),r,i,I.ROUNDED,!1)]}(_)),{positions:_,corners:T,lefts:v,normals:y,endPositions:S}},e}),define("ThirdParty/earcut-2.1.1",[],function(){"use strict";function e(e,t,r){r=r||2;var i,n,o,a,s,l,u,c=t&&t.length,d=c?t[0]*r:e.length,h=m(e,0,d,r,!0),p=[];if(!h)return p;if(c&&(h=function(e,t,r,i){var n,o,a,s,l,u=[];for(n=0,o=t.length;n<o;n++)a=t[n]*i,s=n<o-1?t[n+1]*i:e.length,(l=m(e,a,s,i,!1))===l.next&&(l.steiner=!0),u.push(b(l));for(u.sort(v),n=0;n<u.length;n++)y(u[n],r),r=g(r,r.next);return r}(e,t,h,r)),e.length>80*r){i=o=e[0],n=a=e[1];for(var f=r;f<d;f+=r)(s=e[f])<i&&(i=s),(l=e[f+1])<n&&(n=l),o<s&&(o=s),a<l&&(a=l);u=Math.max(o-i,a-n)}return _(h,p,r,i,n,u),p}function m(e,t,r,i,n){var o,a;if(n===0<x(e,t,r,i))for(o=t;o<r;o+=i)a=l(o,e[o],e[o+1],a);else for(o=r-i;t<=o;o-=i)a=l(o,e[o],e[o+1],a);return a&&s(a,a.next)&&(A(a),a=a.next),a}function g(e,t){if(!e)return e;t||(t=e);var r,i=e;do{if(r=!1,i.steiner||!s(i,i.next)&&0!==w(i.prev,i,i.next))i=i.next;else{if(A(i),(i=t=i.prev)===i.next)return null;r=!0}}while(r||i!==t);return t}function _(e,t,r,i,n,o,a){if(e){!a&&o&&function(e,t,r,i){var n=e;for(;null===n.z&&(n.z=f(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next,n!==e;);n.prevZ.nextZ=null,n.prevZ=null,function(e){var t,r,i,n,o,a,s,l,u=1;do{for(r=e,o=e=null,a=0;r;){for(a++,i=r,t=s=0;t<u&&(s++,i=i.nextZ);t++);for(l=u;0<s||0<l&&i;)0===s?(i=(n=i).nextZ,l--):0!==l&&i?r.z<=i.z?(r=(n=r).nextZ,s--):(i=(n=i).nextZ,l--):(r=(n=r).nextZ,s--),o?o.nextZ=n:e=n,n.prevZ=o,o=n;r=i}o.nextZ=null,u*=2}while(1<a)}(n)}(e,i,n,o);for(var s,l,u=e;e.prev!==e.next;)if(s=e.prev,l=e.next,o?d(e,i,n,o):c(e))t.push(s.i/r),t.push(e.i/r),t.push(l.i/r),A(e),e=l.next,u=l.next;else if((e=l)===u){a?1===a?_(e=h(e,t,r),t,r,i,n,o,2):2===a&&p(e,t,r,i,n,o):_(g(e),t,r,i,n,o,1);break}}}function c(e){var t=e.prev,r=e,i=e.next;if(0<=w(t,r,i))return!1;for(var n=e.next.next;n!==e.prev;){if(C(t.x,t.y,r.x,r.y,i.x,i.y,n.x,n.y)&&0<=w(n.prev,n,n.next))return!1;n=n.next}return!0}function d(e,t,r,i){var n=e.prev,o=e,a=e.next;if(0<=w(n,o,a))return!1;for(var s=n.x<o.x?n.x<a.x?n.x:a.x:o.x<a.x?o.x:a.x,l=n.y<o.y?n.y<a.y?n.y:a.y:o.y<a.y?o.y:a.y,u=n.x>o.x?n.x>a.x?n.x:a.x:o.x>a.x?o.x:a.x,c=n.y>o.y?n.y>a.y?n.y:a.y:o.y>a.y?o.y:a.y,d=f(s,l,t,r,i),h=f(u,c,t,r,i),p=e.nextZ;p&&p.z<=h;){if(p!==e.prev&&p!==e.next&&C(n.x,n.y,o.x,o.y,a.x,a.y,p.x,p.y)&&0<=w(p.prev,p,p.next))return!1;p=p.nextZ}for(p=e.prevZ;p&&p.z>=d;){if(p!==e.prev&&p!==e.next&&C(n.x,n.y,o.x,o.y,a.x,a.y,p.x,p.y)&&0<=w(p.prev,p,p.next))return!1;p=p.prevZ}return!0}function h(e,t,r){var i=e;do{var n=i.prev,o=i.next.next;!s(n,o)&&S(n,i,i.next,o)&&T(n,o)&&T(o,n)&&(t.push(n.i/r),t.push(i.i/r),t.push(o.i/r),A(i),A(i.next),i=e=o),i=i.next}while(i!==e);return i}function p(e,t,r,i,n,o){var a,s,l=e;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&(s=u,(a=l).next.i!==s.i&&a.prev.i!==s.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&S(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(a,s)&&T(a,s)&&T(s,a)&&function(e,t){var r=e,i=!1,n=(e.x+t.x)/2,o=(e.y+t.y)/2;for(;r.y>o!=r.next.y>o&&n<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next,r!==e;);return i}(a,s))){var c=E(l,u);return l=g(l,l.next),c=g(c,c.next),_(l,t,r,i,n,o),void _(c,t,r,i,n,o)}u=u.next}l=l.next}while(l!==e)}function v(e,t){return e.x-t.x}function y(e,t){if(t=function(e,t){var r,i=t,n=e.x,o=e.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=n&&a<s){if((a=s)===n){if(o===i.y)return i;if(o===i.next.y)return i.next}r=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!r)return null;if(n===a)return r.prev;var l,u=r,c=r.x,d=r.y,h=1/0;i=r.next;for(;i!==u;)n>=i.x&&i.x>=c&&C(o<d?n:a,o,c,d,o<d?a:n,o,i.x,i.y)&&((l=Math.abs(o-i.y)/(n-i.x))<h||l===h&&i.x>r.x)&&T(i,e)&&(r=i,h=l),i=i.next;return r}(e,t)){var r=E(t,e);g(r,r.next)}}function f(e,t,r,i,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)/n)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)/n)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function b(e){for(var t=e,r=e;t.x<r.x&&(r=t),(t=t.next)!==e;);return r}function C(e,t,r,i,n,o,a,s){return 0<=(n-a)*(t-s)-(e-a)*(o-s)&&0<=(e-a)*(i-s)-(r-a)*(t-s)&&0<=(r-a)*(o-s)-(n-a)*(i-s)}function w(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function s(e,t){return e.x===t.x&&e.y===t.y}function S(e,t,r,i){return!!(s(e,t)&&s(r,i)||s(e,i)&&s(r,t))||0<w(e,t,r)!=0<w(e,t,i)&&0<w(r,i,e)!=0<w(r,i,t)}function T(e,t){return w(e.prev,e,e.next)<0?0<=w(e,t,e.next)&&0<=w(e,e.prev,t):w(e,t,e.prev)<0||w(e,e.next,t)<0}function E(e,t){var r=new a(e.i,e.x,e.y),i=new a(t.i,t.x,t.y),n=e.next,o=t.prev;return(e.next=t).prev=e,(r.next=n).prev=r,(i.next=r).prev=i,(o.next=i).prev=o,i}function l(e,t,r,i){var n=new a(e,t,r);return i?(n.next=i.next,(n.prev=i).next.prev=n,i.next=n):(n.prev=n).next=n,n}function A(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function a(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function x(e,t,r,i){for(var n=0,o=t,a=r-i;o<r;o+=i)n+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return n}return e.deviation=function(e,t,r,i){var n=t&&t.length,o=n?t[0]*r:e.length,a=Math.abs(x(e,0,o,r));if(n)for(var s=0,l=t.length;s<l;s++){var u=t[s]*r,c=s<l-1?t[s+1]*r:e.length;a-=Math.abs(x(e,u,c,r))}var d=0;for(s=0;s<i.length;s+=3){var h=i[s]*r,p=i[s+1]*r,f=i[s+2]*r;d+=Math.abs((e[h]-e[f])*(e[p+1]-e[h+1])-(e[h]-e[p])*(e[f+1]-e[h+1]))}return 0===a&&0===d?0:Math.abs((d-a)/a)},e.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0,n=0;n<e.length;n++){for(var o=0;o<e[n].length;o++)for(var a=0;a<t;a++)r.vertices.push(e[n][o][a]);0<n&&(i+=e[n-1].length,r.holes.push(i))}return r},e}),define("Core/WindingOrder",["./freezeObject","./WebGLConstants"],function(e,t){"use strict";var r={CLOCKWISE:t.CW,COUNTER_CLOCKWISE:t.CCW,validate:function(e){return e===r.CLOCKWISE||e===r.COUNTER_CLOCKWISE}};return e(r)}),define("Core/PolygonPipeline",["../ThirdParty/earcut-2.1.1","./Cartesian2","./Cartesian3","./Check","./ComponentDatatype","./defaultValue","./defined","./Ellipsoid","./Geometry","./GeometryAttribute","./Math","./PrimitiveType","./WindingOrder"],function(i,n,O,I,M,R,L,l,N,k,F,B,t){"use strict";var u=new O,c=new O,r={computeArea2D:function(e){I.defined("positions",e),I.typeOf.number.greaterThanOrEquals("positions.length",e.length,3);for(var t=e.length,r=0,i=t-1,n=0;n<t;i=n++){var o=e[i],a=e[n];r+=o.x*a.y-a.x*o.y}return.5*r},computeWindingOrder2D:function(e){return 0<r.computeArea2D(e)?t.COUNTER_CLOCKWISE:t.CLOCKWISE},triangulate:function(e,t){I.defined("positions",e);var r=n.packArray(e);return i(r,t,2)}},U=new O,V=new O,z=new O,q=new O,G=new O,W=new O,H=new O;return r.computeSubdivision=function(e,t,r,i){i=R(i,F.RADIANS_PER_DEGREE),I.typeOf.object("ellipsoid",e),I.defined("positions",t),I.defined("indices",r),I.typeOf.number.greaterThanOrEquals("indices.length",r.length,3),I.typeOf.number.equals("indices.length % 3","0",r.length%3,0),I.typeOf.number.greaterThan("granularity",i,0);var n,o=r.slice(0),a=t.length,s=new Array(3*a),l=0;for(n=0;n<a;n++){var u=t[n];s[l++]=u.x,s[l++]=u.y,s[l++]=u.z}for(var c=[],d={},h=e.maximumRadius,p=F.chordLength(i,h),f=p*p;0<o.length;){var m,g,_=o.pop(),v=o.pop(),y=o.pop(),b=O.fromArray(s,3*y,U),C=O.fromArray(s,3*v,V),w=O.fromArray(s,3*_,z),S=O.multiplyByScalar(O.normalize(b,q),h,q),T=O.multiplyByScalar(O.normalize(C,G),h,G),E=O.multiplyByScalar(O.normalize(w,W),h,W),A=O.magnitudeSquared(O.subtract(S,T,H)),x=O.magnitudeSquared(O.subtract(T,E,H)),P=O.magnitudeSquared(O.subtract(E,S,H)),D=Math.max(A,x,P);f<D?A===D?(n=d[m=Math.min(y,v)+" "+Math.max(y,v)],L(n)||(g=O.add(b,C,H),O.multiplyByScalar(g,.5,g),s.push(g.x,g.y,g.z),n=s.length/3-1,d[m]=n),o.push(y,n,_),o.push(n,v,_)):x===D?(n=d[m=Math.min(v,_)+" "+Math.max(v,_)],L(n)||(g=O.add(C,w,H),O.multiplyByScalar(g,.5,g),s.push(g.x,g.y,g.z),n=s.length/3-1,d[m]=n),o.push(v,n,y),o.push(n,_,y)):P===D&&(n=d[m=Math.min(_,y)+" "+Math.max(_,y)],L(n)||(g=O.add(w,b,H),O.multiplyByScalar(g,.5,g),s.push(g.x,g.y,g.z),n=s.length/3-1,d[m]=n),o.push(_,n,v),o.push(n,y,v)):(c.push(y),c.push(v),c.push(_))}return new N({attributes:{position:new k({componentDatatype:M.DOUBLE,componentsPerAttribute:3,values:s})},indices:c,primitiveType:B.TRIANGLES})},r.scaleToGeodeticHeight=function(e,t,r,i){r=R(r,l.WGS84);var n=u,o=c;if(t=R(t,0),i=R(i,!0),L(e))for(var a=e.length,s=0;s<a;s+=3)O.fromArray(e,s,o),i&&(o=r.scaleToGeodeticSurface(o,o)),0!==t&&(n=r.geodeticSurfaceNormal(o,n),O.multiplyByScalar(n,t,n),O.add(o,n,o)),e[s]=o.x,e[s+1]=o.y,e[s+2]=o.z;return e},r}),define("Core/CorridorGeometry",["./arrayRemoveDuplicates","./BoundingSphere","./Cartesian3","./Cartographic","./ComponentDatatype","./CornerType","./CorridorGeometryLibrary","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PolygonPipeline","./PrimitiveType","./Rectangle","./VertexFormat"],function(f,m,ie,e,ne,p,oe,g,ae,t,_,v,y,se,le,ue,ce,D,b,C,O){"use strict";var de=new ie,he=new ie,pe=new ie,fe=new ie,I=new ie,me=new ie,ge=new ie,_e=new ie;function w(e,t){for(var r=0;r<e.length;r++)e[r]=t.scaleToGeodeticSurface(e[r],e[r]);return e}function ve(e,t,r,i,n,o){var a=e.normals,s=e.tangents,l=e.bitangents,u=ie.normalize(ie.cross(r,t,ge),ge);o.normal&&oe.addAttribute(a,t,i,n),o.tangent&&oe.addAttribute(s,u,i,n),o.bitangent&&oe.addAttribute(l,r,i,n)}function M(e,t,r){var i,n,o,a=e.positions,s=e.corners,l=e.endPositions,u=e.lefts,c=e.normals,d=new le,h=0,p=0,f=0;for(n=0;n<a.length;n+=2)h+=o=a[n].length-3,f+=2*o,p+=a[n+1].length-3;for(h+=3,p+=3,n=0;n<s.length;n++){i=s[n];var m=s[n].leftPositions;ae(m)?h+=o=m.length:p+=o=s[n].rightPositions.length,f+=o}var g,_=ae(l);_&&(h+=g=l[0].length-3,p+=g,f+=6*(g/=3));var v,y,b,C,w,S,T=h+p,E=new Float64Array(T),A={normals:t.normal?new Float32Array(T):void 0,tangents:t.tangent?new Float32Array(T):void 0,bitangents:t.bitangent?new Float32Array(T):void 0},x=0,P=T-1,D=de,O=he,I=g/2,M=ue.createTypedArray(T/3,f),R=0;if(_){S=pe,w=fe;var L=l[0];for(D=ie.fromArray(c,0,D),O=ie.fromArray(u,0,O),n=0;n<I;n++)S=ie.fromArray(L,3*(I-1-n),S),w=ie.fromArray(L,3*(I+n),w),oe.addAttribute(E,w,x),oe.addAttribute(E,S,void 0,P),ve(A,D,O,x,P,t),C=(y=x/3)+1,b=(v=(P-2)/3)-1,M[R++]=v,M[R++]=y,M[R++]=b,M[R++]=b,M[R++]=y,M[R++]=C,x+=3,P-=3}var N,k,F=0,B=0,U=a[F++],V=a[F++];for(E.set(U,x),E.set(V,P-V.length+1),O=ie.fromArray(u,B,O),o=V.length-3,n=0;n<o;n+=3)N=r.geodeticSurfaceNormal(ie.fromArray(U,n,ge),ge),k=r.geodeticSurfaceNormal(ie.fromArray(V,o-n,_e),_e),ve(A,D=ie.normalize(ie.add(N,k,D),D),O,x,P,t),C=(y=x/3)+1,b=(v=(P-2)/3)-1,M[R++]=v,M[R++]=y,M[R++]=b,M[R++]=b,M[R++]=y,M[R++]=C,x+=3,P-=3;for(N=r.geodeticSurfaceNormal(ie.fromArray(U,o,ge),ge),k=r.geodeticSurfaceNormal(ie.fromArray(V,o,_e),_e),D=ie.normalize(ie.add(N,k,D),D),B+=3,n=0;n<s.length;n++){var z,q,G,W=(i=s[n]).leftPositions,H=i.rightPositions,j=me,Y=pe,X=fe;if(D=ie.fromArray(c,B,D),ae(W)){for(ve(A,D,O,void 0,P,t),P-=3,q=C,G=b,z=0;z<W.length/3;z++)j=ie.fromArray(W,3*z,j),M[R++]=q,M[R++]=G-z-1,M[R++]=G-z,oe.addAttribute(E,j,void 0,P),Y=ie.fromArray(E,3*(G-z-1),Y),X=ie.fromArray(E,3*q,X),ve(A,D,O=ie.normalize(ie.subtract(Y,X,O),O),void 0,P,t),P-=3;j=ie.fromArray(E,3*q,j),Y=ie.subtract(ie.fromArray(E,3*G,Y),j,Y),X=ie.subtract(ie.fromArray(E,3*(G-z),X),j,X),ve(A,D,O=ie.normalize(ie.add(Y,X,O),O),x,void 0,t),x+=3}else{for(ve(A,D,O,x,void 0,t),x+=3,q=b,G=C,z=0;z<H.length/3;z++)j=ie.fromArray(H,3*z,j),M[R++]=q,M[R++]=G+z,M[R++]=G+z+1,oe.addAttribute(E,j,x),Y=ie.fromArray(E,3*q,Y),X=ie.fromArray(E,3*(G+z),X),ve(A,D,O=ie.normalize(ie.subtract(Y,X,O),O),x,void 0,t),x+=3;j=ie.fromArray(E,3*q,j),Y=ie.subtract(ie.fromArray(E,3*(G+z),Y),j,Y),X=ie.subtract(ie.fromArray(E,3*G,X),j,X),ve(A,D,O=ie.normalize(ie.negate(ie.add(X,Y,O),O),O),void 0,P,t),P-=3}for(U=a[F++],V=a[F++],U.splice(0,3),V.splice(V.length-3,3),E.set(U,x),E.set(V,P-V.length+1),o=V.length-3,B+=3,O=ie.fromArray(u,B,O),z=0;z<V.length;z+=3)N=r.geodeticSurfaceNormal(ie.fromArray(U,z,ge),ge),k=r.geodeticSurfaceNormal(ie.fromArray(V,o-z,_e),_e),ve(A,D=ie.normalize(ie.add(N,k,D),D),O,x,P,t),y=(C=x/3)-1,v=(b=(P-2)/3)+1,M[R++]=v,M[R++]=y,M[R++]=b,M[R++]=b,M[R++]=y,M[R++]=C,x+=3,P-=3;x-=3,P+=3}if(ve(A,D=ie.fromArray(c,c.length-3,D),O,x,P,t),_){x+=3,P-=3,S=pe,w=fe;var Q=l[1];for(n=0;n<I;n++)S=ie.fromArray(Q,3*(g-n-1),S),w=ie.fromArray(Q,3*n,w),oe.addAttribute(E,S,void 0,P),oe.addAttribute(E,w,x),ve(A,D,O,x,P,t),y=(C=x/3)-1,v=(b=(P-2)/3)+1,M[R++]=v,M[R++]=y,M[R++]=b,M[R++]=b,M[R++]=y,M[R++]=C,x+=3,P-=3}if(d.position=new se({componentDatatype:ne.DOUBLE,componentsPerAttribute:3,values:E}),t.st){var Z,K,J=new Float32Array(T/3*2),$=0;if(_){h/=3,p/=3;var ee,te=Math.PI/(g+1);K=1/(h-g+1),Z=1/(p-g+1);var re=g/2;for(n=re+1;n<g+1;n++)ee=ce.PI_OVER_TWO+te*n,J[$++]=Z*(1+Math.cos(ee)),J[$++]=.5*(1+Math.sin(ee));for(n=1;n<p-g+1;n++)J[$++]=n*Z,J[$++]=0;for(n=g;re<n;n--)ee=ce.PI_OVER_TWO-n*te,J[$++]=1-Z*(1+Math.cos(ee)),J[$++]=.5*(1+Math.sin(ee));for(n=re;0<n;n--)ee=ce.PI_OVER_TWO-te*n,J[$++]=1-K*(1+Math.cos(ee)),J[$++]=.5*(1+Math.sin(ee));for(n=h-g;0<n;n--)J[$++]=n*K,J[$++]=1;for(n=1;n<re+1;n++)ee=ce.PI_OVER_TWO+te*n,J[$++]=K*(1+Math.cos(ee)),J[$++]=.5*(1+Math.sin(ee))}else{for(K=1/((h/=3)-1),Z=1/((p/=3)-1),n=0;n<p;n++)J[$++]=n*Z,J[$++]=0;for(n=h;0<n;n--)J[$++]=(n-1)*K,J[$++]=1}d.st=new se({componentDatatype:ne.FLOAT,componentsPerAttribute:2,values:J})}return t.normal&&(d.normal=new se({componentDatatype:ne.FLOAT,componentsPerAttribute:3,values:A.normals})),t.tangent&&(d.tangent=new se({componentDatatype:ne.FLOAT,componentsPerAttribute:3,values:A.tangents})),t.bitangent&&(d.bitangent=new se({componentDatatype:ne.FLOAT,componentsPerAttribute:3,values:A.bitangents})),{attributes:d,indices:M}}function R(e,t,r){r[t++]=e[0],r[t++]=e[1],r[t++]=e[2];for(var i=3;i<e.length;i+=3){var n=e[i],o=e[i+1],a=e[i+2];r[t++]=n,r[t++]=o,r[t++]=a,r[t++]=n,r[t++]=o,r[t++]=a}return r[t++]=e[0],r[t++]=e[1],r[t++]=e[2],r}function S(e,t){var r=new O({position:t.position,normal:t.normal||t.bitangent||e.shadowVolume,tangent:t.tangent,bitangent:t.normal||t.bitangent,st:t.st}),i=e.ellipsoid,n=M(oe.computePositions(e),r,i),o=e.height,a=e.extrudedHeight,s=n.attributes,l=n.indices,u=s.position.values,c=u.length,d=new Float64Array(6*c),h=new Float64Array(c);h.set(u);var p,f=new Float64Array(4*c);f=R(u=D.scaleToGeodeticHeight(u,o,i),0,f),f=R(h=D.scaleToGeodeticHeight(h,a,i),2*c,f),d.set(u),d.set(h,c),d.set(f,2*c),s.position.values=d,s=function(e,t){if(!(t.normal||t.tangent||t.bitangent||t.st))return e;var r,i,n=e.position.values;(t.normal||t.bitangent)&&(r=e.normal.values,i=e.bitangent.values);var o,a=e.position.values.length/18,s=3*a,l=2*a,u=2*s;if(t.normal||t.bitangent||t.tangent){var c=t.normal?new Float32Array(6*s):void 0,d=t.tangent?new Float32Array(6*s):void 0,h=t.bitangent?new Float32Array(6*s):void 0,p=de,f=he,m=pe,g=fe,_=I,v=me,y=u;for(o=0;o<s;o+=3){var b=y+u;p=ie.fromArray(n,o,p),f=ie.fromArray(n,o+s,f),m=ie.fromArray(n,(o+3)%s,m),f=ie.subtract(f,p,f),m=ie.subtract(m,p,m),g=ie.normalize(ie.cross(f,m,g),g),t.normal&&(oe.addAttribute(c,g,b),oe.addAttribute(c,g,b+3),oe.addAttribute(c,g,y),oe.addAttribute(c,g,y+3)),(t.tangent||t.bitangent)&&(v=ie.fromArray(r,o,v),t.bitangent&&(oe.addAttribute(h,v,b),oe.addAttribute(h,v,b+3),oe.addAttribute(h,v,y),oe.addAttribute(h,v,y+3)),t.tangent&&(_=ie.normalize(ie.cross(v,g,_),_),oe.addAttribute(d,_,b),oe.addAttribute(d,_,b+3),oe.addAttribute(d,_,y),oe.addAttribute(d,_,y+3))),y+=6}if(t.normal){for(c.set(r),o=0;o<s;o+=3)c[o+s]=-r[o],c[o+s+1]=-r[o+1],c[o+s+2]=-r[o+2];e.normal.values=c}else e.normal=void 0;if(t.bitangent?(h.set(i),h.set(i,s),e.bitangent.values=h):e.bitangent=void 0,t.tangent){var C=e.tangent.values;d.set(C),d.set(C,s),e.tangent.values=d}}if(t.st){var w=e.st.values,S=new Float32Array(6*l);S.set(w),S.set(w,l);for(var T=2*l,E=0;E<2;E++){for(S[T++]=w[0],S[T++]=w[1],o=2;o<l;o+=2){var A=w[o],x=w[o+1];S[T++]=A,S[T++]=x,S[T++]=A,S[T++]=x}S[T++]=w[0],S[T++]=w[1]}e.st.values=S}return e}(s,t);var m=c/3;if(e.shadowVolume){var g=s.normal.values;c=g.length;var _=new Float32Array(6*c);for(p=0;p<c;p++)g[p]=-g[p];_.set(g,c),_=R(g,4*c,_),s.extrudeDirection=new se({componentDatatype:ne.FLOAT,componentsPerAttribute:3,values:_}),t.normal||(s.normal=void 0)}var v=l.length,y=m+m,b=ue.createTypedArray(d.length/3,2*v+3*y);b.set(l);var C,w,S,T,E=v;for(p=0;p<v;p+=3){var A=l[p],x=l[p+1],P=l[p+2];b[E++]=P+m,b[E++]=x+m,b[E++]=A+m}for(p=0;p<y;p+=2)S=(C=p+y)+1,T=(w=C+y)+1,b[E++]=C,b[E++]=w,b[E++]=S,b[E++]=S,b[E++]=w,b[E++]=T;return{attributes:s,indices:b}}var T=new ie,E=new ie,A=new e;function x(e,t,r,i,n,o){var a=ie.subtract(t,e,T);ie.normalize(a,a);var s=r.geodeticSurfaceNormal(e,E),l=ie.cross(a,s,T);ie.multiplyByScalar(l,i,l);var u=n.latitude,c=n.longitude,d=o.latitude,h=o.longitude;ie.add(e,l,E),r.cartesianToCartographic(E,A);var p=A.latitude,f=A.longitude;u=Math.min(u,p),c=Math.min(c,f),d=Math.max(d,p),h=Math.max(h,f),ie.subtract(e,l,E),r.cartesianToCartographic(E,A),p=A.latitude,f=A.longitude,u=Math.min(u,p),c=Math.min(c,f),d=Math.max(d,p),h=Math.max(h,f),n.latitude=u,n.longitude=c,o.latitude=d,o.longitude=h}var P=new ie,L=new ie,N=new e,k=new e;function F(e){var t=(e=g(e,g.EMPTY_OBJECT)).positions,r=e.width;if(!ae(t))throw new _("options.positions is required.");if(!ae(r))throw new _("options.width is required.");this._positions=t,this._ellipsoid=v.clone(g(e.ellipsoid,v.WGS84)),this._vertexFormat=O.clone(g(e.vertexFormat,O.DEFAULT)),this._width=r,this._height=g(e.height,0),this._extrudedHeight=g(e.extrudedHeight,this._height),this._cornerType=g(e.cornerType,p.ROUNDED),this._granularity=g(e.granularity,ce.RADIANS_PER_DEGREE),this._shadowVolume=g(e.shadowVolume,!1),this._workerName="createCorridorGeometry",this._rectangle=function(e,t,r,i){e=w(e,t);var n=f(e,ie.equalsEpsilon),o=n.length;if(o<2||r<=0)return new C;var a,s,l=.5*r;if(N.latitude=Number.POSITIVE_INFINITY,N.longitude=Number.POSITIVE_INFINITY,k.latitude=Number.NEGATIVE_INFINITY,k.longitude=Number.NEGATIVE_INFINITY,i===p.ROUNDED){var u=n[0];ie.subtract(u,n[1],P),ie.normalize(P,P),ie.multiplyByScalar(P,l,P),ie.add(u,P,L),t.cartesianToCartographic(L,A),a=A.latitude,s=A.longitude,N.latitude=Math.min(N.latitude,a),N.longitude=Math.min(N.longitude,s),k.latitude=Math.max(k.latitude,a),k.longitude=Math.max(k.longitude,s)}for(var c=0;c<o-1;++c)x(n[c],n[c+1],t,l,N,k);var d=n[o-1];ie.subtract(d,n[o-2],P),ie.normalize(P,P),ie.multiplyByScalar(P,l,P),ie.add(d,P,L),x(d,L,t,l,N,k),i===p.ROUNDED&&(t.cartesianToCartographic(L,A),a=A.latitude,s=A.longitude,N.latitude=Math.min(N.latitude,a),N.longitude=Math.min(N.longitude,s),k.latitude=Math.max(k.latitude,a),k.longitude=Math.max(k.longitude,s));var h=new C;return h.north=k.latitude,h.south=N.latitude,h.east=k.longitude,h.west=N.longitude,h}(t,this._ellipsoid,r,this._cornerType),this.packedLength=1+t.length*ie.packedLength+v.packedLength+O.packedLength+C.packedLength+6}F.pack=function(e,t,r){if(!ae(e))throw new _("value is required");if(!ae(t))throw new _("array is required");r=g(r,0);var i=e._positions,n=i.length;t[r++]=n;for(var o=0;o<n;++o,r+=ie.packedLength)ie.pack(i[o],t,r);return v.pack(e._ellipsoid,t,r),r+=v.packedLength,O.pack(e._vertexFormat,t,r),r+=O.packedLength,C.pack(e._rectangle,t,r),r+=C.packedLength,t[r++]=e._width,t[r++]=e._height,t[r++]=e._extrudedHeight,t[r++]=e._cornerType,t[r++]=e._granularity,t[r]=e._shadowVolume?1:0,t};var B=v.clone(v.UNIT_SPHERE),U=new O,V=new C,z={positions:void 0,ellipsoid:B,vertexFormat:U,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,shadowVolume:void 0};return F.unpack=function(e,t,r){if(!ae(e))throw new _("array is required");t=g(t,0);for(var i=e[t++],n=new Array(i),o=0;o<i;++o,t+=ie.packedLength)n[o]=ie.unpack(e,t);var a=v.unpack(e,t,B);t+=v.packedLength;var s=O.unpack(e,t,U);t+=O.packedLength;var l=C.unpack(e,t,V);t+=C.packedLength;var u=e[t++],c=e[t++],d=e[t++],h=e[t++],p=e[t++],f=1===e[t];return ae(r)?(r._positions=n,r._ellipsoid=v.clone(a,r._ellipsoid),r._vertexFormat=O.clone(s,r._vertexFormat),r._width=u,r._height=c,r._extrudedHeight=d,r._cornerType=h,r._granularity=p,r._rectangle=C.clone(l),r._shadowVolume=f,r):(z.positions=n,z.width=u,z.height=c,z.extrudedHeight=d,z.cornerType=h,z.granularity=p,z.shadowVolume=f,new F(z))},F.createGeometry=function(e){var t=e._positions,r=e._height,i=e._width,n=e._extrudedHeight,o=r!==n,a=e._ellipsoid;t=w(t,a);var s=f(t,ie.equalsEpsilon);if(!(s.length<2||i<=0)){var l,u=e._vertexFormat,c={ellipsoid:a,positions:s,width:i,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!0};if(o){var d=Math.max(r,n);n=Math.min(r,n),r=d,c.height=r,c.extrudedHeight=n,c.shadowVolume=e._shadowVolume,l=S(c,u)}else{(l=M(oe.computePositions(c),u,a)).attributes.position.values=D.scaleToGeodeticHeight(l.attributes.position.values,r,a)}var h=l.attributes,p=m.fromVertices(h.position.values,void 0,3);return u.position||(l.attributes.position.values=void 0),new y({attributes:h,indices:l.indices,primitiveType:b.TRIANGLES,boundingSphere:p})}},F.createShadowVolume=function(e,t,r){var i=e._granularity,n=e._ellipsoid,o=t(i,n),a=r(i,n);return new F({positions:e._positions,width:e._width,cornerType:e._cornerType,ellipsoid:n,granularity:i,extrudedHeight:o,height:a,vertexFormat:O.POSITION_ONLY,shadowVolume:!0})},t(F.prototype,{rectangle:{get:function(){return this._rectangle}}}),F}),define("Core/CorridorOutlineGeometry",["./arrayRemoveDuplicates","./BoundingSphere","./Cartesian3","./Check","./ComponentDatatype","./CornerType","./CorridorGeometryLibrary","./defaultValue","./defined","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PolygonPipeline","./PrimitiveType"],function(p,f,U,h,V,z,q,m,G,g,_,W,H,j,i,b,v){"use strict";var Y=new U,X=new U,Q=new U;function C(e,t){var r,i,n,o=[],a=e.positions,s=e.corners,l=e.endPositions,u=new H,c=0,d=0,h=0;for(i=0;i<a.length;i+=2)c+=n=a[i].length-3,h+=n/3*4,d+=a[i+1].length-3;for(c+=3,d+=3,i=0;i<s.length;i++){r=s[i];var p=s[i].leftPositions;G(p)?c+=n=p.length:d+=n=s[i].rightPositions.length,h+=n/3*2}var f,m=G(l);m&&(c+=f=l[0].length-3,d+=f,h+=4*(f/=3));var g,_,v,y,b,C,w=c+d,S=new Float64Array(w),T=0,E=w-1,A=f/2,x=j.createTypedArray(w/3,h+4),P=0;if(x[P++]=T/3,x[P++]=(E-2)/3,m){o.push(T/3),C=Y,b=X;var D=l[0];for(i=0;i<A;i++)C=U.fromArray(D,3*(A-1-i),C),b=U.fromArray(D,3*(A+i),b),q.addAttribute(S,b,T),q.addAttribute(S,C,void 0,E),y=(_=T/3)+1,v=(g=(E-2)/3)-1,x[P++]=g,x[P++]=v,x[P++]=_,x[P++]=y,T+=3,E-=3}var O=0,I=a[O++],M=a[O++];for(S.set(I,T),S.set(M,E-M.length+1),n=M.length-3,o.push(T/3,(E-2)/3),i=0;i<n;i+=3)y=(_=T/3)+1,v=(g=(E-2)/3)-1,x[P++]=g,x[P++]=v,x[P++]=_,x[P++]=y,T+=3,E-=3;for(i=0;i<s.length;i++){var R,L,N=(r=s[i]).leftPositions,k=r.rightPositions,F=Q;if(G(N)){for(E-=3,L=v,o.push(y),R=0;R<N.length/3;R++)F=U.fromArray(N,3*R,F),x[P++]=L-R-1,x[P++]=L-R,q.addAttribute(S,F,void 0,E),E-=3;o.push(L-Math.floor(N.length/6)),t===z.BEVELED&&o.push((E-2)/3+1),T+=3}else{for(T+=3,L=y,o.push(v),R=0;R<k.length/3;R++)F=U.fromArray(k,3*R,F),x[P++]=L+R,x[P++]=L+R+1,q.addAttribute(S,F,T),T+=3;o.push(L+Math.floor(k.length/6)),t===z.BEVELED&&o.push(T/3-1),E-=3}for(I=a[O++],M=a[O++],I.splice(0,3),M.splice(M.length-3,3),S.set(I,T),S.set(M,E-M.length+1),n=M.length-3,R=0;R<M.length;R+=3)_=(y=T/3)-1,g=(v=(E-2)/3)+1,x[P++]=g,x[P++]=v,x[P++]=_,x[P++]=y,T+=3,E-=3;T-=3,E+=3,o.push(T/3,(E-2)/3)}if(m){T+=3,E-=3,C=Y,b=X;var B=l[1];for(i=0;i<A;i++)C=U.fromArray(B,3*(f-i-1),C),b=U.fromArray(B,3*i,b),q.addAttribute(S,C,void 0,E),q.addAttribute(S,b,T),_=(y=T/3)-1,g=(v=(E-2)/3)+1,x[P++]=g,x[P++]=v,x[P++]=_,x[P++]=y,T+=3,E-=3;o.push(T/3)}else o.push(T/3,(E-2)/3);return x[P++]=T/3,x[P++]=(E-2)/3,u.position=new W({componentDatatype:V.DOUBLE,componentsPerAttribute:3,values:S}),{attributes:u,indices:x,wallIndices:o}}function y(e){var t=(e=m(e,m.EMPTY_OBJECT)).positions,r=e.width;h.typeOf.object("options.positions",t),h.typeOf.number("options.width",r),this._positions=t,this._ellipsoid=g.clone(m(e.ellipsoid,g.WGS84)),this._width=r,this._height=m(e.height,0),this._extrudedHeight=m(e.extrudedHeight,this._height),this._cornerType=m(e.cornerType,z.ROUNDED),this._granularity=m(e.granularity,i.RADIANS_PER_DEGREE),this._workerName="createCorridorOutlineGeometry",this.packedLength=1+t.length*U.packedLength+g.packedLength+5}y.pack=function(e,t,r){h.typeOf.object("value",e),h.typeOf.object("array",t),r=m(r,0);var i=e._positions,n=i.length;t[r++]=n;for(var o=0;o<n;++o,r+=U.packedLength)U.pack(i[o],t,r);return g.pack(e._ellipsoid,t,r),r+=g.packedLength,t[r++]=e._width,t[r++]=e._height,t[r++]=e._extrudedHeight,t[r++]=e._cornerType,t[r]=e._granularity,t};var w=g.clone(g.UNIT_SPHERE),S={positions:void 0,ellipsoid:w,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0};return y.unpack=function(e,t,r){h.typeOf.object("array",e),t=m(t,0);for(var i=e[t++],n=new Array(i),o=0;o<i;++o,t+=U.packedLength)n[o]=U.unpack(e,t);var a=g.unpack(e,t,w);t+=g.packedLength;var s=e[t++],l=e[t++],u=e[t++],c=e[t++],d=e[t];return G(r)?(r._positions=n,r._ellipsoid=g.clone(a,r._ellipsoid),r._width=s,r._height=l,r._extrudedHeight=u,r._cornerType=c,r._granularity=d,r):(S.positions=n,S.width=s,S.height=l,S.extrudedHeight=u,S.cornerType=c,S.granularity=d,new y(S))},y.createGeometry=function(e){var t=e._positions,r=e._height,i=e._width,n=e._extrudedHeight,o=r!==n,a=e._ellipsoid;t=function(e,t){for(var r=0;r<e.length;r++)e[r]=t.scaleToGeodeticSurface(e[r],e[r]);return e}(t,a);var s=p(t,U.equalsEpsilon);if(!(s.length<2||i<=0)){var l,u={ellipsoid:a,positions:s,width:i,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!1};if(o){var c=Math.max(r,n);n=Math.min(r,n),r=c,u.height=r,u.extrudedHeight=n,l=function(e){var t=e.ellipsoid,r=C(q.computePositions(e),e.cornerType),i=r.wallIndices,n=e.height,o=e.extrudedHeight,a=r.attributes,s=r.indices,l=a.position.values,u=l.length,c=new Float64Array(u);c.set(l);var d,h=new Float64Array(2*u);l=b.scaleToGeodeticHeight(l,n,t),c=b.scaleToGeodeticHeight(c,o,t),h.set(l),h.set(c,u),a.position.values=h,u/=3;var p=s.length,f=j.createTypedArray(h.length/3,2*(p+i.length));f.set(s);var m,g,_=p;for(d=0;d<p;d+=2){var v=s[d],y=s[d+1];f[_++]=v+u,f[_++]=y+u}for(d=0;d<i.length;d++)g=(m=i[d])+u,f[_++]=m,f[_++]=g;return{attributes:a,indices:f}}(u)}else{(l=C(q.computePositions(u),u.cornerType)).attributes.position.values=b.scaleToGeodeticHeight(l.attributes.position.values,r,a)}var d=l.attributes,h=f.fromVertices(d.position.values,void 0,3);return new _({attributes:d,indices:l.indices,primitiveType:v.LINES,boundingSphere:h})}},y}),define("Core/createGuid",[],function(){"use strict";return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}}),define("Core/CullingVolume",["./Cartesian3","./Cartesian4","./defaultValue","./defined","./DeveloperError","./Intersect","./Plane"],function(d,h,t,p,f,l,u){"use strict";function m(e){this.planes=t(e,[])}var g=[new d,new d,new d];d.clone(d.UNIT_X,g[0]),d.clone(d.UNIT_Y,g[1]),d.clone(d.UNIT_Z,g[2]);var _=new d,v=new d,c=new u(new d(1,0,0),0);return m.fromBoundingSphere=function(e,t){if(!p(e))throw new f("boundingSphere is required.");p(t)||(t=new m);var r=g.length,i=t.planes;i.length=2*r;for(var n=e.center,o=e.radius,a=0,s=0;s<r;++s){var l=g[s],u=i[a],c=i[a+1];p(u)||(u=i[a]=new h),p(c)||(c=i[a+1]=new h),d.multiplyByScalar(l,-o,_),d.add(n,_,_),u.x=l.x,u.y=l.y,u.z=l.z,u.w=-d.dot(l,_),d.multiplyByScalar(l,o,_),d.add(n,_,_),c.x=-l.x,c.y=-l.y,c.z=-l.z,c.w=-d.dot(d.negate(l,v),_),a+=2}return t},m.prototype.computeVisibility=function(e){if(!p(e))throw new f("boundingVolume is required.");for(var t=this.planes,r=!1,i=0,n=t.length;i<n;++i){var o=e.intersectPlane(u.fromCartesian4(t[i],c));if(o===l.OUTSIDE)return l.OUTSIDE;o===l.INTERSECTING&&(r=!0)}return r?l.INTERSECTING:l.INSIDE},m.prototype.computeVisibilityWithPlaneMask=function(e,t){if(!p(e))throw new f("boundingVolume is required.");if(!p(t))throw new f("parentPlaneMask is required.");if(t===m.MASK_OUTSIDE||t===m.MASK_INSIDE)return t;for(var r=m.MASK_INSIDE,i=this.planes,n=0,o=i.length;n<o;++n){var a=n<31?1<<n:0;if(!(n<31&&0==(t&a))){var s=e.intersectPlane(u.fromCartesian4(i[n],c));if(s===l.OUTSIDE)return m.MASK_OUTSIDE;s===l.INTERSECTING&&(r|=a)}}return r},m.MASK_OUTSIDE=4294967295,m.MASK_INSIDE=0,m.MASK_INDETERMINATE=2147483647,m}),define("Core/CylinderGeometryLibrary",["./Math"],function(C){"use strict";var e={computePositions:function(e,t,r,i,n){var o,a=.5*e,s=-a,l=i+i,u=new Float64Array(3*(n?2*l:l)),c=0,d=0,h=n?3*l:0,p=n?3*(l+i):3*i;for(o=0;o<i;o++){var f=o/i*C.TWO_PI,m=Math.cos(f),g=Math.sin(f),_=m*r,v=g*r,y=m*t,b=g*t;u[d+h]=_,u[d+h+1]=v,u[d+h+2]=s,u[d+p]=y,u[d+p+1]=b,u[d+p+2]=a,d+=3,n&&(u[c++]=_,u[c++]=v,u[c++]=s,u[c++]=y,u[c++]=b,u[c++]=a)}return u}};return e}),define("Core/CylinderGeometry",["./BoundingSphere","./Cartesian2","./Cartesian3","./ComponentDatatype","./CylinderGeometryLibrary","./defaultValue","./defined","./DeveloperError","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType","./VertexFormat"],function(N,k,F,B,U,l,u,c,V,z,q,G,W,H,d){"use strict";var j=new k,Y=new F,X=new F,Q=new F,Z=new F;function h(e){var t=(e=l(e,l.EMPTY_OBJECT)).length,r=e.topRadius,i=e.bottomRadius,n=l(e.vertexFormat,d.DEFAULT),o=l(e.slices,128);if(!u(t))throw new c("options.length must be defined.");if(!u(r))throw new c("options.topRadius must be defined.");if(!u(i))throw new c("options.bottomRadius must be defined.");if(o<3)throw new c("options.slices must be greater than or equal to 3.");this._length=t,this._topRadius=r,this._bottomRadius=i,this._vertexFormat=d.clone(n),this._slices=o,this._workerName="createCylinderGeometry"}h.packedLength=d.packedLength+4,h.pack=function(e,t,r){if(!u(e))throw new c("value is required");if(!u(t))throw new c("array is required");return r=l(r,0),d.pack(e._vertexFormat,t,r),r+=d.packedLength,t[r++]=e._length,t[r++]=e._topRadius,t[r++]=e._bottomRadius,t[r]=e._slices,t};var e,p=new d,f={vertexFormat:p,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0};return h.unpack=function(e,t,r){if(!u(e))throw new c("array is required");t=l(t,0);var i=d.unpack(e,t,p);t+=d.packedLength;var n=e[t++],o=e[t++],a=e[t++],s=e[t];return u(r)?(r._vertexFormat=d.clone(i,r._vertexFormat),r._length=n,r._topRadius=o,r._bottomRadius=a,r._slices=s,r):(f.length=n,f.topRadius=o,f.bottomRadius=a,f.slices=s,new h(f))},h.createGeometry=function(e){var t=e._length,r=e._topRadius,i=e._bottomRadius,n=e._vertexFormat,o=e._slices;if(!(t<=0||r<0||i<0||0===r&&0===i)){var a,s=o+o,l=o+s,u=s+s,c=U.computePositions(t,r,i,o,!0),d=n.st?new Float32Array(2*u):void 0,h=n.normal?new Float32Array(3*u):void 0,p=n.tangent?new Float32Array(3*u):void 0,f=n.bitangent?new Float32Array(3*u):void 0,m=n.normal||n.tangent||n.bitangent;if(m){var g=n.tangent||n.bitangent,_=0,v=0,y=0,b=Y;b.z=0;var C=Q,w=X;for(a=0;a<o;a++){var S=a/o*W.TWO_PI,T=Math.cos(S),E=Math.sin(S);m&&(b.x=T,b.y=E,g&&(C=F.normalize(F.cross(F.UNIT_Z,b,C),C)),n.normal&&(h[_++]=T,h[_++]=E,h[_++]=0,h[_++]=T,h[_++]=E,h[_++]=0),n.tangent&&(p[v++]=C.x,p[v++]=C.y,p[v++]=C.z,p[v++]=C.x,p[v++]=C.y,p[v++]=C.z),n.bitangent&&(w=F.normalize(F.cross(b,C,w),w),f[y++]=w.x,f[y++]=w.y,f[y++]=w.z,f[y++]=w.x,f[y++]=w.y,f[y++]=w.z))}for(a=0;a<o;a++)n.normal&&(h[_++]=0,h[_++]=0,h[_++]=-1),n.tangent&&(p[v++]=1,p[v++]=0,p[v++]=0),n.bitangent&&(f[y++]=0,f[y++]=-1,f[y++]=0);for(a=0;a<o;a++)n.normal&&(h[_++]=0,h[_++]=0,h[_++]=1),n.tangent&&(p[v++]=1,p[v++]=0,p[v++]=0),n.bitangent&&(f[y++]=0,f[y++]=1,f[y++]=0)}var A=12*o-12,x=G.createTypedArray(u,A),P=0,D=0;for(a=0;a<o-1;a++)x[P++]=D,x[P++]=D+2,x[P++]=D+3,x[P++]=D,x[P++]=D+3,x[P++]=D+1,D+=2;for(x[P++]=s-2,x[P++]=0,x[P++]=1,x[P++]=s-2,x[P++]=1,x[P++]=s-1,a=1;a<o-1;a++)x[P++]=s+a+1,x[P++]=s+a,x[P++]=s;for(a=1;a<o-1;a++)x[P++]=l,x[P++]=l+a,x[P++]=l+a+1;var O=0;if(n.st){var I=Math.max(r,i);for(a=0;a<u;a++){var M=F.fromArray(c,3*a,Z);d[O++]=(M.x+I)/(2*I),d[O++]=(M.y+I)/(2*I)}}var R=new q;n.position&&(R.position=new z({componentDatatype:B.DOUBLE,componentsPerAttribute:3,values:c})),n.normal&&(R.normal=new z({componentDatatype:B.FLOAT,componentsPerAttribute:3,values:h})),n.tangent&&(R.tangent=new z({componentDatatype:B.FLOAT,componentsPerAttribute:3,values:p})),n.bitangent&&(R.bitangent=new z({componentDatatype:B.FLOAT,componentsPerAttribute:3,values:f})),n.st&&(R.st=new z({componentDatatype:B.FLOAT,componentsPerAttribute:2,values:d})),j.x=.5*t,j.y=Math.max(i,r);var L=new N(F.ZERO,k.magnitude(j));return new V({attributes:R,indices:x,primitiveType:H.TRIANGLES,boundingSphere:L})}},h.getUnitCylinder=function(){return u(e)||(e=h.createGeometry(new h({topRadius:1,bottomRadius:1,length:1,vertexFormat:d.POSITION_ONLY}))),e},h}),define("Core/CylinderOutlineGeometry",["./BoundingSphere","./Cartesian2","./Cartesian3","./Check","./ComponentDatatype","./CylinderGeometryLibrary","./defaultValue","./defined","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./PrimitiveType"],function(g,_,v,l,y,b,u,c,C,w,S,T,E){"use strict";var A=new _;function d(e){var t=(e=u(e,u.EMPTY_OBJECT)).length,r=e.topRadius,i=e.bottomRadius,n=u(e.slices,128),o=Math.max(u(e.numberOfVerticalLines,16),0);l.typeOf.number("options.positions",t),l.typeOf.number("options.topRadius",r),l.typeOf.number("options.bottomRadius",i),l.typeOf.number.greaterThanOrEquals("options.slices",n,3),this._length=t,this._topRadius=r,this._bottomRadius=i,this._slices=n,this._numberOfVerticalLines=o,this._workerName="createCylinderOutlineGeometry"}d.packedLength=5,d.pack=function(e,t,r){return l.typeOf.object("value",e),l.defined("array",t),r=u(r,0),t[r++]=e._length,t[r++]=e._topRadius,t[r++]=e._bottomRadius,t[r++]=e._slices,t[r]=e._numberOfVerticalLines,t};var h={length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,numberOfVerticalLines:void 0};return d.unpack=function(e,t,r){l.defined("array",e),t=u(t,0);var i=e[t++],n=e[t++],o=e[t++],a=e[t++],s=e[t];return c(r)?(r._length=i,r._topRadius=n,r._bottomRadius=o,r._slices=a,r._numberOfVerticalLines=s,r):(h.length=i,h.topRadius=n,h.bottomRadius=o,h.slices=a,h.numberOfVerticalLines=s,new d(h))},d.createGeometry=function(e){var t=e._length,r=e._topRadius,i=e._bottomRadius,n=e._slices,o=e._numberOfVerticalLines;if(!(t<=0||r<0||i<0||0===r&&0===i)){var a,s=2*n,l=b.computePositions(t,r,i,n,!1),u=2*n;if(0<o){var c=Math.min(o,n);a=Math.round(n/c),u+=c}var d,h=T.createTypedArray(s,2*u),p=0;for(d=0;d<n-1;d++)h[p++]=d,h[p++]=d+1,h[p++]=d+n,h[p++]=d+1+n;if(h[p++]=n-1,h[p++]=0,h[p++]=n+n-1,h[p++]=n,0<o)for(d=0;d<n;d+=a)h[p++]=d,h[p++]=d+n;var f=new S;f.position=new w({componentDatatype:y.DOUBLE,componentsPerAttribute:3,values:l}),A.x=.5*t,A.y=Math.max(i,r);var m=new g(v.ZERO,_.magnitude(A));return new C({attributes:f,indices:h,primitiveType:E.LINES,boundingSphere:m})}},d}),define("Core/decodeGoogleEarthEnterpriseData",["./Check","./RuntimeError"],function(h,p){"use strict";var f=1953029805,m=2917034100;function g(e,t){if(g.passThroughDataForTesting)return t;h.typeOf.object("key",e),h.typeOf.object("data",t);var r=e.byteLength;if(0===r||r%4!=0)throw new p("The length of key must be greater than 0 and a multiple of 4.");var i=new DataView(t),n=i.getUint32(0,!0);if(n===f||n===m)return t;for(var o,a=new DataView(e),s=0,l=t.byteLength,u=l-l%8,c=r,d=8;s<u;)for(o=d=(d+8)%24;s<u&&o<c;)i.setUint32(s,i.getUint32(s,!0)^a.getUint32(o,!0),!0),i.setUint32(s+4,i.getUint32(s+4,!0)^a.getUint32(o+4,!0),!0),s+=8,o+=24;if(s<l)for(c<=o&&(o=d=(d+8)%24);s<l;)i.setUint8(s,i.getUint8(s)^a.getUint8(o)),s++,o++}return g.passThroughDataForTesting=!1,g}),define("Core/DefaultProxy",[],function(){"use strict";function e(e){this.proxy=e}return e.prototype.getURL=function(e){var t=-1===this.proxy.indexOf("?")?"?":"";return this.proxy+t+encodeURIComponent(e)},e}),define("Core/DistanceDisplayCondition",["./defaultValue","./defined","./defineProperties","./DeveloperError"],function(i,n,e,o){"use strict";function a(e,t){e=i(e,0),this._near=e,t=i(t,Number.MAX_VALUE),this._far=t}return e(a.prototype,{near:{get:function(){return this._near},set:function(e){this._near=e}},far:{get:function(){return this._far},set:function(e){this._far=e}}}),a.packedLength=2,a.pack=function(e,t,r){if(!n(e))throw new o("value is required");if(!n(t))throw new o("array is required");return r=i(r,0),t[r++]=e.near,t[r]=e.far,t},a.unpack=function(e,t,r){if(!n(e))throw new o("array is required");return t=i(t,0),n(r)||(r=new a),r.near=e[t++],r.far=e[t],r},a.equals=function(e,t){return e===t||n(e)&&n(t)&&e.near===t.near&&e.far===t.far},a.clone=function(e,t){if(n(e))return n(t)||(t=new a),t.near=e.near,t.far=e.far,t},a.prototype.clone=function(e){return a.clone(this,e)},a.prototype.equals=function(e){return a.equals(this,e)},a}),define("Core/DistanceDisplayConditionGeometryInstanceAttribute",["./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError"],function(e,r,i,t,n){"use strict";function o(e,t){if(e=r(e,0),(t=r(t,Number.MAX_VALUE))<=e)throw new n("far distance must be greater than near distance.");this.value=new Float32Array([e,t])}return t(o.prototype,{componentDatatype:{get:function(){return e.FLOAT}},componentsPerAttribute:{get:function(){return 2}},normalize:{get:function(){return!1}}}),o.fromDistanceDisplayCondition=function(e){if(!i(e))throw new n("distanceDisplayCondition is required.");if(e.far<=e.near)throw new n("distanceDisplayCondition.far distance must be greater than distanceDisplayCondition.near distance.");return new o(e.near,e.far)},o.toValue=function(e,t){if(!i(e))throw new n("distanceDisplayCondition is required.");return i(t)?(t[0]=e.near,t[1]=e.far,t):new Float32Array([e.near,e.far])},o}),define("Core/DoublyLinkedList",["../Core/defined","../Core/defineProperties"],function(r,e){"use strict";function t(){this.head=void 0,this.tail=void 0,this._length=0}function i(e,t,r){this.item=e,this.previous=t,this.next=r}function n(e,t){r(t.previous)&&r(t.next)?(t.previous.next=t.next,t.next.previous=t.previous):r(t.previous)?(t.previous.next=void 0,e.tail=t.previous):r(t.next)?(t.next.previous=void 0,e.head=t.next):(e.head=void 0,e.tail=void 0),t.next=void 0,t.previous=void 0}return e(t.prototype,{length:{get:function(){return this._length}}}),t.prototype.add=function(e){var t=new i(e,this.tail,void 0);return r(this.tail)?this.tail.next=t:this.head=t,this.tail=t,++this._length,t},t.prototype.remove=function(e){r(e)&&(n(this,e),--this._length)},t.prototype.splice=function(e,t){if(e!==t){n(this,t);var r=e.next;e.next=t,this.tail===e?this.tail=t:r.previous=t,t.next=r,t.previous=e}},t}),define("ThirdParty/Tween",[],function(){void 0===Date.now&&(Date.now=function(){return(new Date).valueOf()});var r,i,s=s||(r=[],{REVISION:"13",getAll:function(){return r},removeAll:function(){r=[]},add:function(e){r.push(e)},remove:function(e){var t=r.indexOf(e);-1!==t&&r.splice(t,1)},update:function(e){if(0===r.length)return!1;var t=0;for(e=void 0!==e?e:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();t<r.length;)r[t].update(e)?t++:r.splice(t,1);return!0}});return s.Tween=function(e){var u=e,c={},d={},h={},p=1e3,f=0,m=!1,r=!1,g=!1,_=0,v=null,y=s.Easing.Linear.None,b=s.Interpolation.Linear,C=[],w=null,S=!1,T=null,E=null,t=null;for(var i in e)c[i]=parseFloat(e[i],10);this.to=function(e,t){return void 0!==t&&(p=t),d=e,this},this.start=function(e){for(var t in s.add(this),S=!(r=!0),v=void 0!==e?e:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),v+=_,d){if(d[t]instanceof Array){if(0===d[t].length)continue;d[t]=[u[t]].concat(d[t])}c[t]=u[t],c[t]instanceof Array==!1&&(c[t]*=1),h[t]=c[t]||0}return this},this.stop=function(){return r&&(s.remove(this),r=!1,null!==t&&t.call(u),this.stopChainedTweens()),this},this.stopChainedTweens=function(){for(var e=0,t=C.length;e<t;e++)C[e].stop()},this.delay=function(e){return _=e,this},this.repeat=function(e){return f=e,this},this.yoyo=function(e){return m=e,this},this.easing=function(e){return y=e,this},this.interpolation=function(e){return b=e,this},this.chain=function(){return C=arguments,this},this.onStart=function(e){return w=e,this},this.onUpdate=function(e){return T=e,this},this.onComplete=function(e){return E=e,this},this.onStop=function(e){return t=e,this},this.update=function(e){var t;if(e<v)return!0;!1===S&&(null!==w&&w.call(u),S=!0);var r=(e-v)/p,i=y(r=1<r?1:r);for(t in d){var n=c[t]||0,o=d[t];o instanceof Array?u[t]=b(o,i):("string"==typeof o&&(o=n+parseFloat(o,10)),"number"==typeof o&&(u[t]=n+(o-n)*i))}if(null!==T&&T.call(u,i),1!=r)return!0;if(0<f){for(t in isFinite(f)&&f--,h){if("string"==typeof d[t]&&(h[t]=h[t]+parseFloat(d[t],10)),m){var a=h[t];h[t]=d[t],d[t]=a}c[t]=h[t]}return m&&(g=!g),v=e+_,!0}null!==E&&E.call(u);for(var s=0,l=C.length;s<l;s++)C[s].start(e);return!1}},s.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t,r=.1;return 0===e?0:1===e?1:(t=!r||r<1?(r=1,.1):.4*Math.asin(1/r)/(2*Math.PI),-r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4))},Out:function(e){var t,r=.1;return 0===e?0:1===e?1:(t=!r||r<1?(r=1,.1):.4*Math.asin(1/r)/(2*Math.PI),r*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/.4)+1)},InOut:function(e){var t,r=.1;return 0===e?0:1===e?1:(t=!r||r<1?(r=1,.1):.4*Math.asin(1/r)/(2*Math.PI),(e*=2)<1?r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*-.5:r*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*.5+1)}},Back:{In:function(e){return e*e*(2.70158*e-1.70158)},Out:function(e){return--e*e*(2.70158*e+1.70158)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-s.Easing.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*s.Easing.Bounce.In(2*e):.5*s.Easing.Bounce.Out(2*e-1)+.5}}},s.Interpolation={Linear:function(e,t){var r=e.length-1,i=r*t,n=Math.floor(i),o=s.Interpolation.Utils.Linear;return t<0?o(e[0],e[1],i):1<t?o(e[r],e[r-1],r-i):o(e[n],e[r<n+1?r:n+1],i-n)},Bezier:function(e,t){var r,i=0,n=e.length-1,o=Math.pow,a=s.Interpolation.Utils.Bernstein;for(r=0;r<=n;r++)i+=o(1-t,n-r)*o(t,r)*e[r]*a(n,r);return i},CatmullRom:function(e,t){var r=e.length-1,i=r*t,n=Math.floor(i),o=s.Interpolation.Utils.CatmullRom;return e[0]===e[r]?(t<0&&(n=Math.floor(i=r*(1+t))),o(e[(n-1+r)%r],e[n],e[(n+1)%r],e[(n+2)%r],i-n)):t<0?e[0]-(o(e[0],e[0],e[1],e[1],-i)-e[0]):1<t?e[r]-(o(e[r],e[r],e[r-1],e[r-1],i-r)-e[r]):o(e[n?n-1:0],e[n],e[r<n+1?r:n+1],e[r<n+2?r:n+2],i-n)},Utils:{Linear:function(e,t,r){return(t-e)*r+e},Bernstein:function(e,t){var r=s.Interpolation.Utils.Factorial;return r(e)/r(t)/r(e-t)},Factorial:(i=[1],function(e){var t,r=1;if(i[e])return i[e];for(t=e;1<t;t--)r*=t;return i[e]=r}),CatmullRom:function(e,t,r,i,n){var o=.5*(r-e),a=.5*(i-t),s=n*n;return(2*t-2*r+o+a)*(n*s)+(-3*t+3*r-2*o-a)*s+o*n+t}}},s}),define("Core/EasingFunction",["../ThirdParty/Tween","./freezeObject"],function(e,t){"use strict";return t({LINEAR_NONE:e.Easing.Linear.None,QUADRACTIC_IN:e.Easing.Quadratic.In,QUADRACTIC_OUT:e.Easing.Quadratic.Out,QUADRACTIC_IN_OUT:e.Easing.Quadratic.InOut,CUBIC_IN:e.Easing.Cubic.In,CUBIC_OUT:e.Easing.Cubic.Out,CUBIC_IN_OUT:e.Easing.Cubic.InOut,QUARTIC_IN:e.Easing.Quartic.In,QUARTIC_OUT:e.Easing.Quartic.Out,QUARTIC_IN_OUT:e.Easing.Quartic.InOut,QUINTIC_IN:e.Easing.Quintic.In,QUINTIC_OUT:e.Easing.Quintic.Out,QUINTIC_IN_OUT:e.Easing.Quintic.InOut,SINUSOIDAL_IN:e.Easing.Sinusoidal.In,SINUSOIDAL_OUT:e.Easing.Sinusoidal.Out,SINUSOIDAL_IN_OUT:e.Easing.Sinusoidal.InOut,EXPONENTIAL_IN:e.Easing.Exponential.In,EXPONENTIAL_OUT:e.Easing.Exponential.Out,EXPONENTIAL_IN_OUT:e.Easing.Exponential.InOut,CIRCULAR_IN:e.Easing.Circular.In,CIRCULAR_OUT:e.Easing.Circular.Out,CIRCULAR_IN_OUT:e.Easing.Circular.InOut,ELASTIC_IN:e.Easing.Elastic.In,ELASTIC_OUT:e.Easing.Elastic.Out,ELASTIC_IN_OUT:e.Easing.Elastic.InOut,BACK_IN:e.Easing.Back.In,BACK_OUT:e.Easing.Back.Out,BACK_IN_OUT:e.Easing.Back.InOut,BOUNCE_IN:e.Easing.Bounce.In,BOUNCE_OUT:e.Easing.Bounce.Out,BOUNCE_IN_OUT:e.Easing.Bounce.InOut})}),define("Core/EllipsoidGeometry",["./BoundingSphere","./Cartesian2","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType","./VertexFormat"],function(F,B,U,V,s,l,u,z,q,G,W,H,j,Y,c){"use strict";var X=new U,Q=new U,Z=new U,K=new U,J=new U,o=new U(1,1,1),$=Math.cos,ee=Math.sin;function d(e){e=s(e,s.EMPTY_OBJECT);var t=s(e.radii,o),r=Math.round(s(e.stackPartitions,64)),i=Math.round(s(e.slicePartitions,64)),n=s(e.vertexFormat,c.DEFAULT);if(i<3)throw new u("options.slicePartitions cannot be less than three.");if(r<3)throw new u("options.stackPartitions cannot be less than three.");this._radii=U.clone(t),this._stackPartitions=r,this._slicePartitions=i,this._vertexFormat=c.clone(n),this._workerName="createEllipsoidGeometry"}d.packedLength=U.packedLength+c.packedLength+2,d.pack=function(e,t,r){if(!l(e))throw new u("value is required");if(!l(t))throw new u("array is required");return r=s(r,0),U.pack(e._radii,t,r),r+=U.packedLength,c.pack(e._vertexFormat,t,r),r+=c.packedLength,t[r++]=e._stackPartitions,t[r]=e._slicePartitions,t};var e,h=new U,p=new c,f={radii:h,vertexFormat:p,stackPartitions:void 0,slicePartitions:void 0};return d.unpack=function(e,t,r){if(!l(e))throw new u("array is required");t=s(t,0);var i=U.unpack(e,t,h);t+=U.packedLength;var n=c.unpack(e,t,p);t+=c.packedLength;var o=e[t++],a=e[t];return l(r)?(r._radii=U.clone(i,r._radii),r._vertexFormat=c.clone(n,r._vertexFormat),r._stackPartitions=o,r._slicePartitions=a,r):(f.stackPartitions=o,f.slicePartitions=a,new d(f))},d.createGeometry=function(e){var t=e._radii;if(!(t.x<=0||t.y<=0||t.z<=0)){var r,i,n=z.fromCartesian3(t),o=e._vertexFormat,a=e._slicePartitions+1,s=e._stackPartitions+1,l=s*a,u=new Float64Array(3*l),c=6*(a-1)*(s-2),d=H.createTypedArray(l,c),h=o.normal?new Float32Array(3*l):void 0,p=o.tangent?new Float32Array(3*l):void 0,f=o.bitangent?new Float32Array(3*l):void 0,m=o.st?new Float32Array(2*l):void 0,g=new Array(a),_=new Array(a),v=0;for(r=0;r<a;r++){var y=j.TWO_PI*r/(a-1);g[r]=$(y),_[r]=ee(y),u[v++]=0,u[v++]=0,u[v++]=t.z}for(r=1;r<s-1;r++){var b=Math.PI*r/(s-1),C=ee(b),w=t.x*C,S=t.y*C,T=t.z*$(b);for(i=0;i<a;i++)u[v++]=g[i]*w,u[v++]=_[i]*S,u[v++]=T}for(r=0;r<a;r++)u[v++]=0,u[v++]=0,u[v++]=-t.z;var E=new W;o.position&&(E.position=new G({componentDatatype:V.DOUBLE,componentsPerAttribute:3,values:u}));var A,x,P=0,D=0,O=0,I=0;if(o.st||o.normal||o.tangent||o.bitangent){for(r=0;r<l;r++){var M=U.fromArray(u,3*r,X),R=n.geodeticSurfaceNormal(M,Q);if(o.st){var L=B.negate(R,J);B.magnitude(L)<j.EPSILON6&&((v=3*(r+a*Math.floor(.5*s)))>u.length&&(v=3*(r-a*Math.floor(.5*s))),U.fromArray(u,v,L),n.geodeticSurfaceNormal(L,L),B.negate(L,L)),m[P++]=Math.atan2(L.y,L.x)/j.TWO_PI+.5,m[P++]=Math.asin(R.z)/Math.PI+.5}if(o.normal&&(h[D++]=R.x,h[D++]=R.y,h[D++]=R.z),o.tangent||o.bitangent){var N=Z;if(r<a||l-a-1<r?U.cross(U.UNIT_X,R,N):U.cross(U.UNIT_Z,R,N),U.normalize(N,N),o.tangent&&(p[O++]=N.x,p[O++]=N.y,p[O++]=N.z),o.bitangent){var k=U.cross(R,N,K);U.normalize(k,k),f[I++]=k.x,f[I++]=k.y,f[I++]=k.z}}}o.st&&(E.st=new G({componentDatatype:V.FLOAT,componentsPerAttribute:2,values:m})),o.normal&&(E.normal=new G({componentDatatype:V.FLOAT,componentsPerAttribute:3,values:h})),o.tangent&&(E.tangent=new G({componentDatatype:V.FLOAT,componentsPerAttribute:3,values:p})),o.bitangent&&(E.bitangent=new G({componentDatatype:V.FLOAT,componentsPerAttribute:3,values:f}))}for(i=v=0;i<a-1;i++)d[v++]=a+i,d[v++]=a+i+1,d[v++]=i+1;for(r=1;r<s-2;r++)for(A=r*a,x=(r+1)*a,i=0;i<a-1;i++)d[v++]=x+i,d[v++]=x+i+1,d[v++]=A+i+1,d[v++]=x+i,d[v++]=A+i+1,d[v++]=A+i;for(A=(r=s-2)*a,x=(r+1)*a,i=0;i<a-1;i++)d[v++]=x+i,d[v++]=A+i+1,d[v++]=A+i;return new q({attributes:E,indices:d,primitiveType:Y.TRIANGLES,boundingSphere:F.fromEllipsoid(n)})}},d.getUnitEllipsoid=function(){return l(e)||(e=d.createGeometry(new d({radii:new U(1,1,1),vertexFormat:c.POSITION_ONLY}))),e},d}),define("Core/EllipsoidOutlineGeometry",["./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType"],function(E,s,A,l,u,c,x,P,D,O,I,M,R){"use strict";var o=new s(1,1,1),L=Math.cos,N=Math.sin;function d(e){e=l(e,l.EMPTY_OBJECT);var t=l(e.radii,o),r=Math.round(l(e.stackPartitions,10)),i=Math.round(l(e.slicePartitions,8)),n=Math.round(l(e.subdivisions,128));if(r<1)throw new c("options.stackPartitions cannot be less than 1");if(i<0)throw new c("options.slicePartitions cannot be less than 0");if(n<0)throw new c("options.subdivisions must be greater than or equal to zero.");this._radii=s.clone(t),this._stackPartitions=r,this._slicePartitions=i,this._subdivisions=n,this._workerName="createEllipsoidOutlineGeometry"}d.packedLength=s.packedLength+3,d.pack=function(e,t,r){if(!u(e))throw new c("value is required");if(!u(t))throw new c("array is required");return r=l(r,0),s.pack(e._radii,t,r),r+=s.packedLength,t[r++]=e._stackPartitions,t[r++]=e._slicePartitions,t[r]=e._subdivisions,t};var h=new s,p={radii:h,stackPartitions:void 0,slicePartitions:void 0,subdivisions:void 0};return d.unpack=function(e,t,r){if(!u(e))throw new c("array is required");t=l(t,0);var i=s.unpack(e,t,h);t+=s.packedLength;var n=e[t++],o=e[t++],a=e[t++];return u(r)?(r._radii=s.clone(i,r._radii),r._stackPartitions=n,r._slicePartitions=o,r._subdivisions=a,r):(p.stackPartitions=n,p.slicePartitions=o,p.subdivisions=a,new d(p))},d.createGeometry=function(e){var t=e._radii;if(!(t.x<=0||t.y<=0||t.z<=0)){var r,i,n,o,a,s,l=x.fromCartesian3(t),u=e._stackPartitions,c=e._slicePartitions,d=e._subdivisions,h=d*(u+c-1),p=h-c+2,f=new Float64Array(3*p),m=I.createTypedArray(p,2*h),g=0,_=new Array(d),v=new Array(d);for(r=0;r<d;r++)n=M.TWO_PI*r/d,_[r]=L(n),v[r]=N(n);for(r=1;r<u;r++)for(o=Math.PI*r/u,a=L(o),s=N(o),i=0;i<d;i++)f[g++]=t.x*_[i]*s,f[g++]=t.y*v[i]*s,f[g++]=t.z*a;for(_.length=c,v.length=c,r=0;r<c;r++)n=M.TWO_PI*r/c,_[r]=L(n),v[r]=N(n);for(f[g++]=0,f[g++]=0,f[g++]=t.z,r=1;r<d;r++)for(o=Math.PI*r/d,a=L(o),s=N(o),i=0;i<c;i++)f[g++]=t.x*_[i]*s,f[g++]=t.y*v[i]*s,f[g++]=t.z*a;for(f[g++]=0,f[g++]=0,f[g++]=-t.z,r=g=0;r<u-1;++r){var y=r*d;for(i=0;i<d-1;++i)m[g++]=y+i,m[g++]=y+i+1;m[g++]=y+d-1,m[g++]=y}var b=d*(u-1);for(i=1;i<c+1;++i)m[g++]=b,m[g++]=b+i;for(r=0;r<d-2;++r){var C=r*c+1+b,w=(r+1)*c+1+b;for(i=0;i<c-1;++i)m[g++]=w+i,m[g++]=C+i;m[g++]=w+c-1,m[g++]=C+c-1}var S=f.length/3-1;for(i=S-1;S-c-1<i;--i)m[g++]=S,m[g++]=i;var T=new O({position:new D({componentDatatype:A.DOUBLE,componentsPerAttribute:3,values:f})});return new P({attributes:T,indices:m,primitiveType:R.LINES,boundingSphere:E.fromEllipsoid(l)})}},d}),define("Core/EllipsoidTerrainProvider",["../ThirdParty/when","./defaultValue","./defined","./defineProperties","./Ellipsoid","./Event","./GeographicTilingScheme","./HeightmapTerrainData","./TerrainProvider"],function(t,r,i,e,n,o,a,s,l){"use strict";function u(e){e=r(e,{}),this._tilingScheme=e.tilingScheme,i(this._tilingScheme)||(this._tilingScheme=new a({ellipsoid:r(e.ellipsoid,n.WGS84)})),this._levelZeroMaximumGeometricError=l.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,64,this._tilingScheme.getNumberOfXTilesAtLevel(0)),this._errorEvent=new o,this._readyPromise=t.resolve(!0)}return e(u.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},ready:{get:function(){return!0}},readyPromise:{get:function(){return this._readyPromise}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}}}),u.prototype.requestTileGeometry=function(e,t,r,i){return new s({buffer:new Uint8Array(256),width:16,height:16})},u.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)},u.prototype.getTileDataAvailable=function(e,t,r){},u}),define("Core/EventHelper",["./defined","./DeveloperError"],function(o,a){"use strict";function e(){this._removalFunctions=[]}return e.prototype.add=function(e,t,r){if(!o(e))throw new a("event is required");var i=e.addEventListener(t,r);this._removalFunctions.push(i);var n=this;return function(){i();var e=n._removalFunctions;e.splice(e.indexOf(i),1)}},e.prototype.removeAll=function(){for(var e=this._removalFunctions,t=0,r=e.length;t<r;++t)e[t]();e.length=0},e}),define("Core/ExtrapolationType",["./freezeObject"],function(e){"use strict";return e({NONE:0,HOLD:1,EXTRAPOLATE:2})}),define("Core/OrthographicOffCenterFrustum",["./Cartesian3","./Cartesian4","./CullingVolume","./defaultValue","./defined","./defineProperties","./DeveloperError","./Matrix4"],function(f,m,t,r,g,e,_,i){"use strict";function n(e){e=r(e,r.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=r(e.near,1),this._near=this.near,this.far=r(e.far,5e8),this._far=this.far,this._cullingVolume=new t,this._orthographicMatrix=new i}function a(e){if(!(g(e.right)&&g(e.left)&&g(e.top)&&g(e.bottom)&&g(e.near)&&g(e.far)))throw new _("right, left, top, bottom, near, or far parameters are not set.");if(e.top!==e._top||e.bottom!==e._bottom||e.left!==e._left||e.right!==e._right||e.near!==e._near||e.far!==e._far){if(e.left>e.right)throw new _("right must be greater than left.");if(e.bottom>e.top)throw new _("top must be greater than bottom.");if(e.near<=0||e.near>e.far)throw new _("near must be greater than zero and less than far.");e._left=e.left,e._right=e.right,e._top=e.top,e._bottom=e.bottom,e._near=e.near,e._far=e.far,e._orthographicMatrix=i.computeOrthographicOffCenter(e.left,e.right,e.bottom,e.top,e.near,e.far,e._orthographicMatrix)}}e(n.prototype,{projectionMatrix:{get:function(){return a(this),this._orthographicMatrix}}});var v=new f,y=new f,b=new f,C=new f;return n.prototype.computeCullingVolume=function(e,t,r){if(!g(e))throw new _("position is required.");if(!g(t))throw new _("direction is required.");if(!g(r))throw new _("up is required.");var i=this._cullingVolume.planes,n=this.top,o=this.bottom,a=this.right,s=this.left,l=this.near,u=this.far,c=f.cross(t,r,v);f.normalize(c,c);var d=y;f.multiplyByScalar(t,l,d),f.add(e,d,d);var h=b;f.multiplyByScalar(c,s,h),f.add(d,h,h);var p=i[0];return g(p)||(p=i[0]=new m),p.x=c.x,p.y=c.y,p.z=c.z,p.w=-f.dot(c,h),f.multiplyByScalar(c,a,h),f.add(d,h,h),p=i[1],g(p)||(p=i[1]=new m),p.x=-c.x,p.y=-c.y,p.z=-c.z,p.w=-f.dot(f.negate(c,C),h),f.multiplyByScalar(r,o,h),f.add(d,h,h),p=i[2],g(p)||(p=i[2]=new m),p.x=r.x,p.y=r.y,p.z=r.z,p.w=-f.dot(r,h),f.multiplyByScalar(r,n,h),f.add(d,h,h),p=i[3],g(p)||(p=i[3]=new m),p.x=-r.x,p.y=-r.y,p.z=-r.z,p.w=-f.dot(f.negate(r,C),h),p=i[4],g(p)||(p=i[4]=new m),p.x=t.x,p.y=t.y,p.z=t.z,p.w=-f.dot(t,d),f.multiplyByScalar(t,u,h),f.add(e,h,h),p=i[5],g(p)||(p=i[5]=new m),p.x=-t.x,p.y=-t.y,p.z=-t.z,p.w=-f.dot(f.negate(t,C),h),this._cullingVolume},n.prototype.getPixelDimensions=function(e,t,r,i){if(a(this),!g(e)||!g(t))throw new _("Both drawingBufferWidth and drawingBufferHeight are required.");if(e<=0)throw new _("drawingBufferWidth must be greater than zero.");if(t<=0)throw new _("drawingBufferHeight must be greater than zero.");if(!g(r))throw new _("distance is required.");if(!g(i))throw new _("A result object is required.");var n=(this.right-this.left)/e,o=(this.top-this.bottom)/t;return i.x=n,i.y=o,i},n.prototype.clone=function(e){return g(e)||(e=new n),e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e},n.prototype.equals=function(e){return g(e)&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far},n}),define("Core/OrthographicFrustum",["./Check","./defaultValue","./defined","./defineProperties","./DeveloperError","./OrthographicOffCenterFrustum"],function(i,n,o,e,a,t){"use strict";function s(e){e=n(e,n.EMPTY_OBJECT),this._offCenterFrustum=new t,this.width=e.width,this._width=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=n(e.near,1),this._near=this.near,this.far=n(e.far,5e8),this._far=this.far}function l(e){if(!(o(e.width)&&o(e.aspectRatio)&&o(e.near)&&o(e.far)))throw new a("width, aspectRatio, near, or far parameters are not set.");var t=e._offCenterFrustum;if(e.width!==e._width||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far){if(e.aspectRatio<0)throw new a("aspectRatio must be positive.");if(e.near<0||e.near>e.far)throw new a("near must be greater than zero and less than far.");e._aspectRatio=e.aspectRatio,e._width=e.width,e._near=e.near,e._far=e.far;var r=1/e.aspectRatio;t.right=.5*e.width,t.left=-t.right,t.top=r*t.right,t.bottom=-t.top,t.near=e.near,t.far=e.far}}return s.packedLength=4,s.pack=function(e,t,r){return i.typeOf.object("value",e),i.defined("array",t),r=n(r,0),t[r++]=e.width,t[r++]=e.aspectRatio,t[r++]=e.near,t[r]=e.far,t},s.unpack=function(e,t,r){return i.defined("array",e),t=n(t,0),o(r)||(r=new s),r.width=e[t++],r.aspectRatio=e[t++],r.near=e[t++],r.far=e[t],r},e(s.prototype,{projectionMatrix:{get:function(){return l(this),this._offCenterFrustum.projectionMatrix}}}),s.prototype.computeCullingVolume=function(e,t,r){return l(this),this._offCenterFrustum.computeCullingVolume(e,t,r)},s.prototype.getPixelDimensions=function(e,t,r,i){return l(this),this._offCenterFrustum.getPixelDimensions(e,t,r,i)},s.prototype.clone=function(e){return o(e)||(e=new s),e.aspectRatio=this.aspectRatio,e.width=this.width,e.near=this.near,e.far=this.far,e._aspectRatio=void 0,e._width=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e},s.prototype.equals=function(e){return!!o(e)&&(l(this),l(e),this.width===e.width&&this.aspectRatio===e.aspectRatio&&this.near===e.near&&this.far===e.far&&this._offCenterFrustum.equals(e._offCenterFrustum))},s}),define("Core/PerspectiveOffCenterFrustum",["./Cartesian3","./Cartesian4","./CullingVolume","./defaultValue","./defined","./defineProperties","./DeveloperError","./Matrix4"],function(m,g,t,r,_,e,v,s){"use strict";function i(e){e=r(e,r.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=r(e.near,1),this._near=this.near,this.far=r(e.far,5e8),this._far=this.far,this._cullingVolume=new t,this._perspectiveMatrix=new s,this._infinitePerspective=new s}function l(e){if(!(_(e.right)&&_(e.left)&&_(e.top)&&_(e.bottom)&&_(e.near)&&_(e.far)))throw new v("right, left, top, bottom, near, or far parameters are not set.");var t=e.top,r=e.bottom,i=e.right,n=e.left,o=e.near,a=e.far;if(t!==e._top||r!==e._bottom||n!==e._left||i!==e._right||o!==e._near||a!==e._far){if(e.near<=0||e.near>e.far)throw new v("near must be greater than zero and less than far.");e._left=n,e._right=i,e._top=t,e._bottom=r,e._near=o,e._far=a,e._perspectiveMatrix=s.computePerspectiveOffCenter(n,i,r,t,o,a,e._perspectiveMatrix),e._infinitePerspective=s.computeInfinitePerspectiveOffCenter(n,i,r,t,o,e._infinitePerspective)}}e(i.prototype,{projectionMatrix:{get:function(){return l(this),this._perspectiveMatrix}},infiniteProjectionMatrix:{get:function(){return l(this),this._infinitePerspective}}});var y=new m,b=new m,C=new m,w=new m;return i.prototype.computeCullingVolume=function(e,t,r){if(!_(e))throw new v("position is required.");if(!_(t))throw new v("direction is required.");if(!_(r))throw new v("up is required.");var i=this._cullingVolume.planes,n=this.top,o=this.bottom,a=this.right,s=this.left,l=this.near,u=this.far,c=m.cross(t,r,y),d=b;m.multiplyByScalar(t,l,d),m.add(e,d,d);var h=C;m.multiplyByScalar(t,u,h),m.add(e,h,h);var p=w;m.multiplyByScalar(c,s,p),m.add(d,p,p),m.subtract(p,e,p),m.normalize(p,p),m.cross(p,r,p),m.normalize(p,p);var f=i[0];return _(f)||(f=i[0]=new g),f.x=p.x,f.y=p.y,f.z=p.z,f.w=-m.dot(p,e),m.multiplyByScalar(c,a,p),m.add(d,p,p),m.subtract(p,e,p),m.cross(r,p,p),m.normalize(p,p),f=i[1],_(f)||(f=i[1]=new g),f.x=p.x,f.y=p.y,f.z=p.z,f.w=-m.dot(p,e),m.multiplyByScalar(r,o,p),m.add(d,p,p),m.subtract(p,e,p),m.cross(c,p,p),m.normalize(p,p),f=i[2],_(f)||(f=i[2]=new g),f.x=p.x,f.y=p.y,f.z=p.z,f.w=-m.dot(p,e),m.multiplyByScalar(r,n,p),m.add(d,p,p),m.subtract(p,e,p),m.cross(p,c,p),m.normalize(p,p),f=i[3],_(f)||(f=i[3]=new g),f.x=p.x,f.y=p.y,f.z=p.z,f.w=-m.dot(p,e),f=i[4],_(f)||(f=i[4]=new g),f.x=t.x,f.y=t.y,f.z=t.z,f.w=-m.dot(t,d),m.negate(t,p),f=i[5],_(f)||(f=i[5]=new g),f.x=p.x,f.y=p.y,f.z=p.z,f.w=-m.dot(p,h),this._cullingVolume},i.prototype.getPixelDimensions=function(e,t,r,i){if(l(this),!_(e)||!_(t))throw new v("Both drawingBufferWidth and drawingBufferHeight are required.");if(e<=0)throw new v("drawingBufferWidth must be greater than zero.");if(t<=0)throw new v("drawingBufferHeight must be greater than zero.");if(!_(r))throw new v("distance is required.");if(!_(i))throw new v("A result object is required.");var n=1/this.near,o=this.top*n,a=2*r*o/t,s=2*r*(o=this.right*n)/e;return i.x=s,i.y=a,i},i.prototype.clone=function(e){return _(e)||(e=new i),e.right=this.right,e.left=this.left,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e},i.prototype.equals=function(e){return _(e)&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far},i}),define("Core/PerspectiveFrustum",["./Check","./defaultValue","./defined","./defineProperties","./DeveloperError","./PerspectiveOffCenterFrustum"],function(i,n,o,e,r,t){"use strict";function a(e){e=n(e,n.EMPTY_OBJECT),this._offCenterFrustum=new t,this.fov=e.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=n(e.near,1),this._near=this.near,this.far=n(e.far,5e8),this._far=this.far,this.xOffset=n(e.xOffset,0),this._xOffset=this.xOffset,this.yOffset=n(e.yOffset,0),this._yOffset=this.yOffset}function s(e){if(!(o(e.fov)&&o(e.aspectRatio)&&o(e.near)&&o(e.far)))throw new r("fov, aspectRatio, near, or far parameters are not set.");var t=e._offCenterFrustum;if(e.fov!==e._fov||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far||e.xOffset!==e._xOffset||e.yOffset!==e._yOffset){if(e.fov<0||e.fov>=Math.PI)throw new r("fov must be in the range [0, PI).");if(e.aspectRatio<0)throw new r("aspectRatio must be positive.");if(e.near<0||e.near>e.far)throw new r("near must be greater than zero and less than far.");e._aspectRatio=e.aspectRatio,e._fov=e.fov,e._fovy=e.aspectRatio<=1?e.fov:2*Math.atan(Math.tan(.5*e.fov)/e.aspectRatio),e._near=e.near,e._far=e.far,e._sseDenominator=2*Math.tan(.5*e._fovy),e._xOffset=e.xOffset,e._yOffset=e.yOffset,t.top=e.near*Math.tan(.5*e._fovy),t.bottom=-t.top,t.right=e.aspectRatio*t.top,t.left=-t.right,t.near=e.near,t.far=e.far,t.right+=e.xOffset,t.left+=e.xOffset,t.top+=e.yOffset,t.bottom+=e.yOffset}}return a.packedLength=6,a.pack=function(e,t,r){return i.typeOf.object("value",e),i.defined("array",t),r=n(r,0),t[r++]=e.fov,t[r++]=e.aspectRatio,t[r++]=e.near,t[r++]=e.far,t[r++]=e.xOffset,t[r]=e.yOffset,t},a.unpack=function(e,t,r){return i.defined("array",e),t=n(t,0),o(r)||(r=new a),r.fov=e[t++],r.aspectRatio=e[t++],r.near=e[t++],r.far=e[t++],r.xOffset=e[t++],r.yOffset=e[t],r},e(a.prototype,{projectionMatrix:{get:function(){return s(this),this._offCenterFrustum.projectionMatrix}},infiniteProjectionMatrix:{get:function(){return s(this),this._offCenterFrustum.infiniteProjectionMatrix}},fovy:{get:function(){return s(this),this._fovy}},sseDenominator:{get:function(){return s(this),this._sseDenominator}}}),a.prototype.computeCullingVolume=function(e,t,r){return s(this),this._offCenterFrustum.computeCullingVolume(e,t,r)},a.prototype.getPixelDimensions=function(e,t,r,i){return s(this),this._offCenterFrustum.getPixelDimensions(e,t,r,i)},a.prototype.clone=function(e){return o(e)||(e=new a),e.aspectRatio=this.aspectRatio,e.fov=this.fov,e.near=this.near,e.far=this.far,e._aspectRatio=void 0,e._fov=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e},a.prototype.equals=function(e){return!!o(e)&&(s(this),s(e),this.fov===e.fov&&this.aspectRatio===e.aspectRatio&&this.near===e.near&&this.far===e.far&&this._offCenterFrustum.equals(e._offCenterFrustum))},a}),define("Core/FrustumGeometry",["./BoundingSphere","./Cartesian3","./Cartesian4","./Check","./ComponentDatatype","./defaultValue","./defined","./Geometry","./GeometryAttribute","./GeometryAttributes","./Matrix3","./Matrix4","./OrthographicFrustum","./PerspectiveFrustum","./PrimitiveType","./Quaternion","./VertexFormat"],function(E,A,T,c,x,P,D,O,I,M,R,L,d,h,N,p,f){"use strict";function k(e){c.typeOf.object("options",e),c.typeOf.object("options.frustum",e.frustum),c.typeOf.object("options.origin",e.origin),c.typeOf.object("options.orientation",e.orientation);var t,r,i=e.frustum,n=e.orientation,o=e.origin,a=P(e.vertexFormat,f.DEFAULT),s=P(e._drawNearPlane,!0);i instanceof h?(t=0,r=h.packedLength):i instanceof d&&(t=1,r=d.packedLength),this._frustumType=t,this._frustum=i.clone(),this._origin=A.clone(o),this._orientation=p.clone(n),this._drawNearPlane=s,this._vertexFormat=a,this._workerName="createFrustumGeometry",this.packedLength=2+r+A.packedLength+p.packedLength+f.packedLength}k.pack=function(e,t,r){c.typeOf.object("value",e),c.defined("array",t),r=P(r,0);var i=e._frustumType,n=e._frustum;return 0===(t[r++]=i)?(h.pack(n,t,r),r+=h.packedLength):(d.pack(n,t,r),r+=d.packedLength),A.pack(e._origin,t,r),r+=A.packedLength,p.pack(e._orientation,t,r),r+=p.packedLength,f.pack(e._vertexFormat,t,r),t[r+=f.packedLength]=e._drawNearPlane?1:0,t};var m=new h,g=new d,_=new p,v=new A,y=new f;function F(e,t,r,i,n,o,a,s){for(var l=e/3*2,u=0;u<4;++u)D(t)&&(t[e]=o.x,t[e+1]=o.y,t[e+2]=o.z),D(r)&&(r[e]=a.x,r[e+1]=a.y,r[e+2]=a.z),D(i)&&(i[e]=s.x,i[e+1]=s.y,i[e+2]=s.z),e+=3;n[l]=0,n[l+1]=0,n[l+2]=1,n[l+3]=0,n[l+4]=1,n[l+5]=1,n[l+6]=0,n[l+7]=1}k.unpack=function(e,t,r){c.defined("array",e),t=P(t,0);var i,n=e[t++];0===n?(i=h.unpack(e,t,m),t+=h.packedLength):(i=d.unpack(e,t,g),t+=d.packedLength);var o=A.unpack(e,t,v);t+=A.packedLength;var a=p.unpack(e,t,_);t+=p.packedLength;var s=f.unpack(e,t,y),l=1===e[t+=f.packedLength];if(!D(r))return new k({frustum:i,origin:o,orientation:a,vertexFormat:s,_drawNearPlane:l});var u=n===r._frustumType?r._frustum:void 0;return r._frustum=i.clone(u),r._frustumType=n,r._origin=A.clone(o,r._origin),r._orientation=p.clone(a,r._orientation),r._vertexFormat=f.clone(s,r._vertexFormat),r._drawNearPlane=l,r};var B=new R,U=new L,V=new L,z=new A,q=new A,G=new A,W=new A,H=new A,j=new A,Y=new Array(3),X=new Array(4);X[0]=new T(-1,-1,1,1),X[1]=new T(1,-1,1,1),X[2]=new T(1,1,1,1),X[3]=new T(-1,1,1,1);for(var Q=new Array(4),e=0;e<4;++e)Q[e]=new T;return k._computeNearFarPlanes=function(e,t,r,i,n,o,a,s){var l=R.fromQuaternion(t,B),u=P(o,z),c=P(a,q),d=P(s,G);u=R.getColumn(l,0,u),c=R.getColumn(l,1,c),d=R.getColumn(l,2,d),A.normalize(u,u),A.normalize(c,c),A.normalize(d,d),A.negate(u,u);var h,p,f=L.computeView(e,d,c,u,U);if(0===r){var m=i.projectionMatrix,g=L.multiply(m,f,V);p=L.inverse(g,V)}else h=L.inverseTransformation(f,V);D(p)?(Y[0]=i.near,Y[1]=i.far):(Y[0]=0,Y[1]=i.near,Y[2]=i.far);for(var _=0;_<2;++_)for(var v=0;v<4;++v){var y=T.clone(X[v],Q[v]);if(D(p)){var b=1/(y=L.multiplyByVector(p,y,y)).w;A.multiplyByScalar(y,b,y),A.subtract(y,e,y),A.normalize(y,y);var C=A.dot(d,y);A.multiplyByScalar(y,Y[_]/C,y),A.add(y,e,y)}else{D(i._offCenterFrustum)&&(i=i._offCenterFrustum);var w=Y[_],S=Y[_+1];y.x=.5*(y.x*(i.right-i.left)+i.left+i.right),y.y=.5*(y.y*(i.top-i.bottom)+i.bottom+i.top),y.z=.5*(y.z*(w-S)-w-S),y.w=1,L.multiplyByVector(h,y,y)}n[12*_+3*v]=y.x,n[12*_+3*v+1]=y.y,n[12*_+3*v+2]=y.z}},k.createGeometry=function(e){var t=e._frustumType,r=e._frustum,i=e._origin,n=e._orientation,o=e._drawNearPlane,a=e._vertexFormat,s=o?6:5,l=new Float64Array(72);k._computeNearFarPlanes(i,n,t,r,l);var u=24;l[u]=l[12],l[u+1]=l[13],l[u+2]=l[14],l[u+3]=l[0],l[u+4]=l[1],l[u+5]=l[2],l[u+6]=l[9],l[u+7]=l[10],l[u+8]=l[11],l[u+9]=l[21],l[u+10]=l[22],l[u+11]=l[23],l[u+=12]=l[15],l[u+1]=l[16],l[u+2]=l[17],l[u+3]=l[3],l[u+4]=l[4],l[u+5]=l[5],l[u+6]=l[0],l[u+7]=l[1],l[u+8]=l[2],l[u+9]=l[12],l[u+10]=l[13],l[u+11]=l[14],l[u+=12]=l[3],l[u+1]=l[4],l[u+2]=l[5],l[u+3]=l[15],l[u+4]=l[16],l[u+5]=l[17],l[u+6]=l[18],l[u+7]=l[19],l[u+8]=l[20],l[u+9]=l[6],l[u+10]=l[7],l[u+11]=l[8],l[u+=12]=l[6],l[u+1]=l[7],l[u+2]=l[8],l[u+3]=l[18],l[u+4]=l[19],l[u+5]=l[20],l[u+6]=l[21],l[u+7]=l[22],l[u+8]=l[23],l[u+9]=l[9],l[u+10]=l[10],l[u+11]=l[11],o||(l=l.subarray(12));var c=new M({position:new I({componentDatatype:x.DOUBLE,componentsPerAttribute:3,values:l})});if(D(a.normal)||D(a.tangent)||D(a.bitangent)||D(a.st)){var d=D(a.normal)?new Float32Array(12*s):void 0,h=D(a.tangent)?new Float32Array(12*s):void 0,p=D(a.bitangent)?new Float32Array(12*s):void 0,f=D(a.st)?new Float32Array(8*s):void 0,m=z,g=q,_=G,v=A.negate(m,W),y=A.negate(g,H),b=A.negate(_,j);u=0,o&&(F(u,d,h,p,f,b,m,g),u+=12),F(u,d,h,p,f,_,v,g),F(u+=12,d,h,p,f,v,b,g),F(u+=12,d,h,p,f,y,b,v),F(u+=12,d,h,p,f,m,_,g),F(u+=12,d,h,p,f,g,_,v),D(d)&&(c.normal=new I({componentDatatype:x.FLOAT,componentsPerAttribute:3,values:d})),D(h)&&(c.tangent=new I({componentDatatype:x.FLOAT,componentsPerAttribute:3,values:h})),D(p)&&(c.bitangent=new I({componentDatatype:x.FLOAT,componentsPerAttribute:3,values:p})),D(f)&&(c.st=new I({componentDatatype:x.FLOAT,componentsPerAttribute:2,values:f}))}for(var C=new Uint16Array(6*s),w=0;w<s;++w){var S=6*w,T=4*w;C[S]=T,C[S+1]=T+1,C[S+2]=T+2,C[S+3]=T,C[S+4]=T+2,C[S+5]=T+3}return new O({attributes:c,indices:C,primitiveType:N.TRIANGLES,boundingSphere:E.fromVertices(l)})},k}),define("Core/FrustumOutlineGeometry",["./BoundingSphere","./Cartesian3","./Check","./ComponentDatatype","./defaultValue","./defined","./FrustumGeometry","./Geometry","./GeometryAttribute","./GeometryAttributes","./OrthographicFrustum","./PerspectiveFrustum","./PrimitiveType","./Quaternion"],function(p,u,c,f,d,h,m,g,_,v,y,b,C,w){"use strict";function S(e){c.typeOf.object("options",e),c.typeOf.object("options.frustum",e.frustum),c.typeOf.object("options.origin",e.origin),c.typeOf.object("options.orientation",e.orientation);var t,r,i=e.frustum,n=e.orientation,o=e.origin,a=d(e._drawNearPlane,!0);i instanceof b?(t=0,r=b.packedLength):i instanceof y&&(t=1,r=y.packedLength),this._frustumType=t,this._frustum=i.clone(),this._origin=u.clone(o),this._orientation=w.clone(n),this._drawNearPlane=a,this._workerName="createFrustumOutlineGeometry",this.packedLength=2+r+u.packedLength+w.packedLength}S.pack=function(e,t,r){c.typeOf.object("value",e),c.defined("array",t),r=d(r,0);var i=e._frustumType,n=e._frustum;return 0===(t[r++]=i)?(b.pack(n,t,r),r+=b.packedLength):(y.pack(n,t,r),r+=y.packedLength),u.pack(e._origin,t,r),r+=u.packedLength,w.pack(e._orientation,t,r),t[r+=w.packedLength]=e._drawNearPlane?1:0,t};var T=new b,E=new y,A=new w,x=new u;return S.unpack=function(e,t,r){c.defined("array",e),t=d(t,0);var i,n=e[t++];0===n?(i=b.unpack(e,t,T),t+=b.packedLength):(i=y.unpack(e,t,E),t+=y.packedLength);var o=u.unpack(e,t,x);t+=u.packedLength;var a=w.unpack(e,t,A),s=1===e[t+=w.packedLength];if(!h(r))return new S({frustum:i,origin:o,orientation:a,_drawNearPlane:s});var l=n===r._frustumType?r._frustum:void 0;return r._frustum=i.clone(l),r._frustumType=n,r._origin=u.clone(o,r._origin),r._orientation=w.clone(a,r._orientation),r._drawNearPlane=s,r},S.createGeometry=function(e){var t=e._frustumType,r=e._frustum,i=e._origin,n=e._orientation,o=e._drawNearPlane,a=new Float64Array(24);m._computeNearFarPlanes(i,n,t,r,a);for(var s,l,u=new v({position:new _({componentDatatype:f.DOUBLE,componentsPerAttribute:3,values:a})}),c=o?2:1,d=new Uint16Array(8*(c+1)),h=o?0:1;h<2;++h)l=4*h,d[s=o?8*h:0]=l,d[s+1]=l+1,d[s+2]=l+1,d[s+3]=l+2,d[s+4]=l+2,d[s+5]=l+3,d[s+6]=l+3,d[s+7]=l;for(h=0;h<2;++h)l=4*h,d[s=8*(c+h)]=l,d[s+1]=l+4,d[s+2]=l+1,d[s+3]=l+5,d[s+4]=l+2,d[s+5]=l+6,d[s+6]=l+3,d[s+7]=l+7;return new g({attributes:u,indices:d,primitiveType:C.LINES,boundingSphere:p.fromVertices(a)})},S}),define("Core/GeocoderService",["./DeveloperError"],function(e){"use strict";function t(){}return t.prototype.geocode=e.throwInstantiationError,t}),define("Core/GeometryInstanceAttribute",["./defaultValue","./defined","./DeveloperError"],function(t,r,i){"use strict";return function(e){if(e=t(e,t.EMPTY_OBJECT),!r(e.componentDatatype))throw new i("options.componentDatatype is required.");if(!r(e.componentsPerAttribute))throw new i("options.componentsPerAttribute is required.");if(e.componentsPerAttribute<1||4<e.componentsPerAttribute)throw new i("options.componentsPerAttribute must be between 1 and 4.");if(!r(e.value))throw new i("options.value is required.");this.componentDatatype=e.componentDatatype,this.componentsPerAttribute=e.componentsPerAttribute,this.normalize=t(e.normalize,!1),this.value=e.value}}),define("Core/getFilenameFromUri",["../ThirdParty/Uri","./defined","./DeveloperError"],function(n,o,a){"use strict";return function(e){if(!o(e))throw new a("uri is required.");var t=new n(e);t.normalize();var r=t.path,i=r.lastIndexOf("/");return-1!==i&&(r=r.substr(i+1)),r}}),define("Core/getImagePixels",["./defined"],function(a){"use strict";var s={};return function(e,t,r){a(t)||(t=e.width),a(r)||(r=e.height);var i=s[t];a(i)||(i={},s[t]=i);var n=i[r];if(!a(n)){var o=document.createElement("canvas");o.width=t,o.height=r,(n=o.getContext("2d")).globalCompositeOperation="copy",i[r]=n}return n.drawImage(e,0,0,t,r),n.getImageData(0,0,t,r).data}}),define("Core/getStringFromTypedArray",["./defaultValue","./defined","./DeveloperError","./RuntimeError"],function(i,n,o,c){"use strict";function a(e,t,r){if(!n(e))throw new o("uint8Array is required.");if(t<0)throw new o("byteOffset cannot be negative.");if(r<0)throw new o("byteLength cannot be negative.");if(t+r>e.byteLength)throw new o("sub-region exceeds array bounds.");return t=i(t,0),r=i(r,e.byteLength-t),e=e.subarray(t,t+r),a.decode(e)}function d(e,t,r){return t<=e&&e<=r}return a.decodeWithTextDecoder=function(e){return new TextDecoder("utf-8").decode(e)},a.decodeWithFromCharCode=function(e){for(var t="",r=function(e){for(var t=0,r=0,i=0,n=128,o=191,a=[],s=e.length,l=0;l<s;++l){var u=e[l];if(0===i){if(d(u,0,127)){a.push(u);continue}if(d(u,194,223)){i=1,t=31&u;continue}if(d(u,224,239)){224===u&&(n=160),237===u&&(o=159),i=2,t=15&u;continue}if(d(u,240,244)){240===u&&(n=144),244===u&&(o=143),i=3,t=7&u;continue}throw new c("String decoding failed.")}d(u,n,o)?(n=128,o=191,t=t<<6|63&u,++r===i&&(a.push(t),t=i=r=0)):(t=i=r=0,n=128,o=191,--l)}return a}(e),i=r.length,n=0;n<i;++n){var o=r[n];o<=65535?t+=String.fromCharCode(o):(o-=65536,t+=String.fromCharCode(55296+(o>>10),56320+(1023&o)))}return t},a.decode="undefined"!=typeof TextDecoder?a.decodeWithTextDecoder:a.decodeWithFromCharCode,a}),define("Core/getMagic",["./defaultValue","./getStringFromTypedArray"],function(r,i){"use strict";return function(e,t){return t=r(t,0),i(e,t,Math.min(4,e.length))}}),function(global,undefined){"use strict";var eSb,fSb,gSb,iSb;eSb={1:[function(e,t,r){t.exports=function(e,t){for(var r=[],i=2;i<arguments.length;)r.push(arguments[i++]);var o=!0;return new Promise(function(i,n){r.push(function(e){if(o)if(o=!1,e)n(e);else{for(var t=[],r=1;r<arguments.length;)t.push(arguments[r++]);i.apply(null,t)}});try{e.apply(t||this,r)}catch(e){o&&(o=!1,n(e))}})}},{}],2:[function(e,t,r){var i=r;i.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;1<--t%4&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var l=new Array(64),u=new Array(123),n=0;n<64;)u[l[n]=n<26?n+65:n<52?n+71:n<62?n-4:n-59|43]=n++;i.encode=function(e,t,r){for(var i,n=[],o=0,a=0;t<r;){var s=e[t++];switch(a){case 0:n[o++]=l[s>>2],i=(3&s)<<4,a=1;break;case 1:n[o++]=l[i|s>>4],i=(15&s)<<2,a=2;break;case 2:n[o++]=l[i|s>>6],n[o++]=l[63&s],a=0}}return a&&(n[o++]=l[i],n[o]=61,1===a&&(n[o+1]=61)),String.fromCharCode.apply(String,n)};var c="invalid encoding";i.decode=function(e,t,r){for(var i,n=r,o=0,a=0;a<e.length;){var s=e.charCodeAt(a++);if(61===s&&1<o)break;if((s=u[s])===undefined)throw Error(c);switch(o){case 0:i=s,o=1;break;case 1:t[r++]=i<<2|(48&s)>>4,i=s,o=2;break;case 2:t[r++]=(15&i)<<4|(60&s)>>2,i=s,o=3;break;case 3:t[r++]=(3&i)<<6|s,o=0}}if(1===o)throw Error(c);return r-n},i.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},{}],3:[function(e,t,r){function i(){this._listeners={}}(t.exports=i).prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},i.prototype.off=function(e,t){if(e===undefined)this._listeners={};else if(t===undefined)this._listeners[e]=[];else for(var r=this._listeners[e],i=0;i<r.length;)r[i].fn===t?r.splice(i,1):++i;return this},i.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],i=1;i<arguments.length;)r.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,r)}return this}},{}],4:[function(require,module,exports){function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},{}],5:[function(e,t,r){t.exports=function(r,i,e){var n=e||8192,o=n>>>1,a=null,s=n;return function(e){if(e<1||o<e)return r(e);n<s+e&&(a=r(n),s=0);var t=i.call(a,s,s+=e);return 7&s&&(s=1+(7|s)),t}}},{}],6:[function(e,t,r){var i=r;i.length=function(e){for(var t=0,r=0,i=0;i<e.length;++i)(r=e.charCodeAt(i))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(i+1))?(++i,t+=4):t+=3;return t},i.read=function(e,t,r){if(r-t<1)return"";for(var i,n=null,o=[],a=0;t<r;)i=e[t++],o[a++]=i<128?i:191<i&&i<224?(31&i)<<6|63&e[t++]:239<i&&i<365?(i=((7&i)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(i>>10),56320+(1023&i)):(15&i)<<12|(63&e[t++])<<6|63&e[t++],8191<a&&((n||(n=[])).push(String.fromCharCode.apply(String,o)),a=0);return n?(a&&n.push(String.fromCharCode.apply(String,o.slice(0,a))),n.join("")):String.fromCharCode.apply(String,o.slice(0,a))},i.write=function(e,t,r){for(var i,n,o=r,a=0;a<e.length;++a)i=e.charCodeAt(a),t[r++]=i<128?i:(t[r++]=i<2048?i>>6|192:(55296==(64512&i)&&56320==(64512&(n=e.charCodeAt(a+1)))?(i=65536+((1023&i)<<10)+(1023&n),++a,t[r++]=i>>18|240,t[r++]=i>>12&63|128):t[r++]=i>>12|224,i>>6&63|128),63&i|128);return r-o}},{}],7:[function(e,t,r){var i=r;function n(){i.Reader._configure(i.BufferReader),i.util._configure()}i.build="minimal",i.roots={},i.Writer=e(14),i.BufferWriter=e(15),i.Reader=e(8),i.BufferReader=e(9),i.util=e(13),i.rpc=e(10),i.configure=n,i.Writer._configure(i.BufferWriter),n()},{10:10,13:13,14:14,15:15,8:8,9:9}],8:[function(e,t,r){t.exports=l;var i,n=e(13),o=n.LongBits,a=n.utf8;function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function l(e){this.buf=e,this.pos=0,this.len=e.length}var u,c="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new l(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new l(e);throw Error("illegal buffer")};function d(){var e=new o(0,0),t=0;if(!(4<this.len-this.pos)){for(;t<3;++t){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,4<this.len-this.pos){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function h(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw s(this,8);return new o(h(this.buf,this.pos+=4),h(this.buf,this.pos+=4))}l.create=n.Buffer?function(e){return(l.create=function(e){return n.Buffer.isBuffer(e)?new i(e):c(e)})(e)}:c,l.prototype._slice=n.Array.prototype.subarray||n.Array.prototype.slice,l.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return u;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return u}),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return h(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|h(this.buf,this.pos+=4)};var f,m,g="undefined"!=typeof Float32Array?(f=new Float32Array(1),m=new Uint8Array(f.buffer),f[0]=-0,m[3]?function(e,t){return m[0]=e[t],m[1]=e[t+1],m[2]=e[t+2],m[3]=e[t+3],f[0]}:function(e,t){return m[0]=e[t+3],m[1]=e[t+2],m[2]=e[t+1],m[3]=e[t],f[0]}):function(e,t){var r=h(e,t+4),i=2*(r>>31)+1,n=r>>>23&255,o=8388607&r;return 255===n?o?NaN:i*(1/0):0===n?1401298464324817e-60*i*o:i*Math.pow(2,n-150)*(o+8388608)};l.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=g(this.buf,this.pos);return this.pos+=4,e};var _,v,y="undefined"!=typeof Float64Array?(_=new Float64Array(1),v=new Uint8Array(_.buffer),_[0]=-0,v[7]?function(e,t){return v[0]=e[t],v[1]=e[t+1],v[2]=e[t+2],v[3]=e[t+3],v[4]=e[t+4],v[5]=e[t+5],v[6]=e[t+6],v[7]=e[t+7],_[0]}:function(e,t){return v[0]=e[t+7],v[1]=e[t+6],v[2]=e[t+5],v[3]=e[t+4],v[4]=e[t+3],v[5]=e[t+2],v[6]=e[t+1],v[7]=e[t],_[0]}):function(e,t){var r=h(e,t+4),i=h(e,t+8),n=2*(i>>31)+1,o=i>>>20&2047,a=4294967296*(1048575&i)+r;return 2047===o?a?NaN:n*(1/0):0===o?5e-324*n*a:n*Math.pow(2,o-1075)*(a+4503599627370496)};l.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=y(this.buf,this.pos);return this.pos+=8,e},l.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw s(this,e);return this.pos+=e,t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},l.prototype.string=function(){var e=this.bytes();return a.read(e,0,e.length)},l.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;;){if(4==(e=7&this.uint32()))break;this.skipType(e)}break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},l._configure=function(e){i=e;var t=n.Long?"toLong":"toNumber";n.merge(l.prototype,{int64:function(){return d.call(this)[t](!1)},uint64:function(){return d.call(this)[t](!0)},sint64:function(){return d.call(this).zzDecode()[t](!1)},fixed64:function(){return p.call(this)[t](!0)},sfixed64:function(){return p.call(this)[t](!1)}})}},{13:13}],9:[function(e,t,r){t.exports=o;var i=e(8);(o.prototype=Object.create(i.prototype)).constructor=o;var n=e(13);function o(e){i.call(this,e)}n.Buffer&&(o.prototype._slice=n.Buffer.prototype.slice),o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len))}},{13:13,8:8}],10:[function(e,t,r){r.Service=e(11)},{11:11}],11:[function(e,t,r){t.exports=i;var s=e(13);function i(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");s.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}((i.prototype=Object.create(s.EventEmitter.prototype)).constructor=i).prototype.rpcCall=function e(r,t,i,n,o){if(!n)throw TypeError("request must be specified");var a=this;if(!o)return s.asPromise(e,a,r,t,i,n);if(!a.rpcImpl)return setTimeout(function(){o(Error("already ended"))},0),undefined;try{return a.rpcImpl(r,t[a.requestDelimited?"encodeDelimited":"encode"](n).finish(),function(e,t){if(e)return a.emit("error",e,r),o(e);if(null===t)return a.end(!0),undefined;if(!(t instanceof i))try{t=i[a.responseDelimited?"decodeDelimited":"decode"](t)}catch(e){return a.emit("error",e,r),o(e)}return a.emit("data",t,r),o(null,t)})}catch(e){return a.emit("error",e,r),setTimeout(function(){o(e)},0),undefined}},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},{13:13}],12:[function(e,t,r){t.exports=n;var i=e(13);function n(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=n.zero=new n(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var a=n.zeroHash="\0\0\0\0\0\0\0\0";n.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var r=e>>>0,i=(e-r)/4294967296>>>0;return t&&(i=~i>>>0,r=~r>>>0,4294967295<++r&&(r=0,4294967295<++i&&(i=0))),new n(r,i)},n.from=function(e){if("number"==typeof e)return n.fromNumber(e);if(i.isString(e)){if(!i.Long)return n.fromNumber(parseInt(e,10));e=i.Long.fromString(e)}return e.low||e.high?new n(e.low>>>0,e.high>>>0):o},n.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},n.prototype.toLong=function(e){return i.Long?new i.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var s=String.prototype.charCodeAt;n.fromHash=function(e){return e===a?o:new n((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},n.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},n.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},n.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},n.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},{13:13}],13:[function(e,t,r){var i=r;function n(e,t,r){for(var i=Object.keys(t),n=0;n<i.length;++n)e[i[n]]!==undefined&&r||(e[i[n]]=t[i[n]]);return e}function o(e){function r(e,t){if(!(this instanceof r))return new r(e,t);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,r):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),t&&n(this,t)}return(r.prototype=Object.create(Error.prototype)).constructor=r,Object.defineProperty(r.prototype,"name",{get:function(){return e}}),r.prototype.toString=function(){return this.name+": "+this.message},r}i.asPromise=e(1),i.base64=e(2),i.EventEmitter=e(3),i.inquire=e(4),i.utf8=e(6),i.pool=e(5),i.LongBits=e(12),i.emptyArray=Object.freeze?Object.freeze([]):[],i.emptyObject=Object.freeze?Object.freeze({}):{},i.isNode=Boolean(global.process&&global.process.versions&&global.process.versions.node),i.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},i.isString=function(e){return"string"==typeof e||e instanceof String},i.isObject=function(e){return e&&"object"==typeof e},i.Buffer=function(){try{var e=i.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),i._Buffer_from=null,i._Buffer_allocUnsafe=null,i.newBuffer=function(e){return"number"==typeof e?i.Buffer?i._Buffer_allocUnsafe(e):new i.Array(e):i.Buffer?i._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},i.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,i.Long=global.dcodeIO&&global.dcodeIO.Long||i.inquire("long"),i.key2Re=/^true|false|0|1$/,i.key32Re=/^-?(?:0|[1-9][0-9]*)$/,i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,i.longToHash=function(e){return e?i.LongBits.from(e).toHash():i.LongBits.zeroHash},i.longFromHash=function(e,t){var r=i.LongBits.fromHash(e);return i.Long?i.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},i.merge=n,i.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},i.newError=o,i.ProtocolError=o("ProtocolError"),i.oneOfGetter=function(e){for(var r={},t=0;t<e.length;++t)r[e[t]]=1;return function(){for(var e=Object.keys(this),t=e.length-1;-1<t;--t)if(1===r[e[t]]&&this[e[t]]!==undefined&&null!==this[e[t]])return e[t]}},i.oneOfSetter=function(r){return function(e){for(var t=0;t<r.length;++t)r[t]!==e&&delete this[r[t]]}},i.lazyResolve=function(e,t){for(var r=0;r<t.length;++r)for(var i=Object.keys(t[r]),n=0;n<i.length;++n){for(var o=t[r][i[n]].split("."),a=e;o.length;)a=a[o.shift()];t[r][i[n]]=a}},i.toJSONOptions={longs:String,enums:String,bytes:String},i._configure=function(){var r=i.Buffer;r?(i._Buffer_from=r.from!==Uint8Array.from&&r.from||function(e,t){return new r(e,t)},i._Buffer_allocUnsafe=r.allocUnsafe||function(e){return new r(e)}):i._Buffer_from=i._Buffer_allocUnsafe=null}},{1:1,12:12,2:2,3:3,4:4,5:5,6:6}],14:[function(e,t,r){t.exports=d;var i,n=e(13),o=n.LongBits,a=n.base64,s=n.utf8;function l(e,t,r){this.fn=e,this.len=t,this.next=undefined,this.val=r}function u(){}function c(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function d(){this.len=0,this.head=new l(u,0,0),this.tail=this.head,this.states=null}function h(e,t,r){t[r]=255&e}function p(e,t){this.len=e,this.next=undefined,this.val=t}function f(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;127<e.lo;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function m(e,t,r){t[r++]=255&e,t[r++]=e>>>8&255,t[r++]=e>>>16&255,t[r]=e>>>24}d.create=n.Buffer?function(){return(d.create=function(){return new i})()}:function(){return new d},d.alloc=function(e){return new n.Array(e)},n.Array!==Array&&(d.alloc=n.pool(d.alloc,n.Array.prototype.subarray)),d.prototype.push=function(e,t,r){return this.tail=this.tail.next=new l(e,t,r),this.len+=t,this},(p.prototype=Object.create(l.prototype)).fn=function(e,t,r){for(;127<e;)t[r++]=127&e|128,e>>>=7;t[r]=e},d.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new p((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},d.prototype.int32=function(e){return e<0?this.push(f,10,o.fromNumber(e)):this.uint32(e)},d.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},d.prototype.int64=d.prototype.uint64=function(e){var t=o.from(e);return this.push(f,t.length(),t)},d.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this.push(f,t.length(),t)},d.prototype.bool=function(e){return this.push(h,1,e?1:0)},d.prototype.sfixed32=d.prototype.fixed32=function(e){return this.push(m,4,e>>>0)},d.prototype.sfixed64=d.prototype.fixed64=function(e){var t=o.from(e);return this.push(m,4,t.lo).push(m,4,t.hi)};var g,_,v="undefined"!=typeof Float32Array?(g=new Float32Array(1),_=new Uint8Array(g.buffer),g[0]=-0,_[3]?function(e,t,r){g[0]=e,t[r++]=_[0],t[r++]=_[1],t[r++]=_[2],t[r]=_[3]}:function(e,t,r){g[0]=e,t[r++]=_[3],t[r++]=_[2],t[r++]=_[1],t[r]=_[0]}):function(e,t,r){var i=e<0?1:0;if(i&&(e=-e),0===e)m(0<1/e?0:2147483648,t,r);else if(isNaN(e))m(2147483647,t,r);else if(34028234663852886e22<e)m((i<<31|2139095040)>>>0,t,r);else if(e<11754943508222875e-54)m((i<<31|Math.round(e/1401298464324817e-60))>>>0,t,r);else{var n=Math.floor(Math.log(e)/Math.LN2);m((i<<31|n+127<<23|8388607&Math.round(e*Math.pow(2,-n)*8388608))>>>0,t,r)}};d.prototype.float=function(e){return this.push(v,4,e)};var y,b,C="undefined"!=typeof Float64Array?(y=new Float64Array(1),b=new Uint8Array(y.buffer),y[0]=-0,b[7]?function(e,t,r){y[0]=e,t[r++]=b[0],t[r++]=b[1],t[r++]=b[2],t[r++]=b[3],t[r++]=b[4],t[r++]=b[5],t[r++]=b[6],t[r]=b[7]}:function(e,t,r){y[0]=e,t[r++]=b[7],t[r++]=b[6],t[r++]=b[5],t[r++]=b[4],t[r++]=b[3],t[r++]=b[2],t[r++]=b[1],t[r]=b[0]}):function(e,t,r){var i=e<0?1:0;if(i&&(e=-e),0===e)m(0,t,r),m(0<1/e?0:2147483648,t,r+4);else if(isNaN(e))m(4294967295,t,r),m(2147483647,t,r+4);else if(17976931348623157e292<e)m(0,t,r),m((i<<31|2146435072)>>>0,t,r+4);else{var n;if(e<22250738585072014e-324)m((n=e/5e-324)>>>0,t,r),m((i<<31|n/4294967296)>>>0,t,r+4);else{var o=Math.floor(Math.log(e)/Math.LN2);1024===o&&(o=1023),m(4503599627370496*(n=e*Math.pow(2,-o))>>>0,t,r),m((i<<31|o+1023<<20|1048576*n&1048575)>>>0,t,r+4)}}};d.prototype.double=function(e){return this.push(C,8,e)};var w=n.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var i=0;i<e.length;++i)t[r+i]=e[i]};d.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this.push(h,1,0);if(n.isString(e)){var r=d.alloc(t=a.length(e));a.decode(e,r,0),e=r}return this.uint32(t).push(w,t,e)},d.prototype.string=function(e){var t=s.length(e);return t?this.uint32(t).push(s.write,t,e):this.push(h,1,0)},d.prototype.fork=function(){return this.states=new c(this),this.head=this.tail=new l(u,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(u,0,0),this.len=0),this},d.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},d.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},d._configure=function(e){i=e}},{13:13}],15:[function(e,t,r){t.exports=a;var i=e(14);(a.prototype=Object.create(i.prototype)).constructor=a;var n=e(13),o=n.Buffer;function a(){i.call(this)}a.alloc=function(e){return(a.alloc=n._Buffer_allocUnsafe)(e)};var s=o&&o.prototype instanceof Uint8Array&&"set"===o.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var i=0;i<e.length;)t[r++]=e[i++]};function l(e,t,r){e.length<40?n.utf8.write(e,t,r):t.utf8Write(e,r)}a.prototype.bytes=function(e){n.isString(e)&&(e=n._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this.push(s,t,e),this},a.prototype.string=function(e){var t=o.byteLength(e);return this.uint32(t),t&&this.push(l,t,e),this}},{13:13,14:14}]},fSb={},gSb=[7],iSb=global.protobuf=function e(t){var r=fSb[t];return r||eSb[t][0].call(r=fSb[t]={exports:{}},e,r,r.exports),r.exports}(gSb[0]),"function"==typeof define&&define.amd&&define("ThirdParty/protobuf-minimal",[],function(){return iSb.configure(),iSb}),"object"==typeof module&&module&&module.exports&&(module.exports=iSb)}("object"==typeof window&&window||"object"==typeof self&&self||this),define("ThirdParty/google-earth-dbroot-parser",["./protobuf-minimal"],function(r){"use strict";var e,t,a=r.Reader,s=(r.Writer,r.util),l=[],u=r.roots.default||(r.roots.default={});return u.keyhole=((t={}).dbroot=((e={}).StringEntryProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}return e.prototype.stringId=0,e.prototype.stringValue="",e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.StringEntryProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.stringId=e.fixed32();break;case 2:i.stringValue=e.string();break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":s.isInteger(e.stringId)?s.isString(e.stringValue)?null:"stringValue: string expected":"stringId: integer expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.StringEntryProto)return e;var t=new u.keyhole.dbroot.StringEntryProto;return void 0!==e.stringId&&null!==e.stringId&&(t.stringId=e.stringId>>>0),void 0!==e.stringValue&&null!==e.stringValue&&(t.stringValue=String(e.stringValue)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.stringId=0,r.stringValue=""),void 0!==e.stringId&&null!==e.stringId&&e.hasOwnProperty("stringId")&&(r.stringId=e.stringId),void 0!==e.stringValue&&null!==e.stringValue&&e.hasOwnProperty("stringValue")&&(r.stringValue=e.stringValue),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.StringIdOrValueProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}return e.prototype.stringId=0,e.prototype.value="",e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.StringIdOrValueProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.stringId=e.fixed32();break;case 2:i.value=e.string();break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":void 0===e.stringId||s.isInteger(e.stringId)?void 0===e.value||s.isString(e.value)?null:"value: string expected":"stringId: integer expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.StringIdOrValueProto)return e;var t=new u.keyhole.dbroot.StringIdOrValueProto;return void 0!==e.stringId&&null!==e.stringId&&(t.stringId=e.stringId>>>0),void 0!==e.value&&null!==e.value&&(t.value=String(e.value)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.stringId=0,r.value=""),void 0!==e.stringId&&null!==e.stringId&&e.hasOwnProperty("stringId")&&(r.stringId=e.stringId),void 0!==e.value&&null!==e.value&&e.hasOwnProperty("value")&&(r.value=e.value),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.PlanetModelProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}return e.prototype.radius=6378.137,e.prototype.flattening=.00335281066474748,e.prototype.elevationBias=0,e.prototype.negativeAltitudeExponentBias=0,e.prototype.compressedNegativeAltitudeThreshold=0,e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.PlanetModelProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.radius=e.double();break;case 2:i.flattening=e.double();break;case 4:i.elevationBias=e.double();break;case 5:i.negativeAltitudeExponentBias=e.int32();break;case 6:i.compressedNegativeAltitudeThreshold=e.double();break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":void 0!==e.radius&&"number"!=typeof e.radius?"radius: number expected":void 0!==e.flattening&&"number"!=typeof e.flattening?"flattening: number expected":void 0!==e.elevationBias&&"number"!=typeof e.elevationBias?"elevationBias: number expected":void 0===e.negativeAltitudeExponentBias||s.isInteger(e.negativeAltitudeExponentBias)?void 0!==e.compressedNegativeAltitudeThreshold&&"number"!=typeof e.compressedNegativeAltitudeThreshold?"compressedNegativeAltitudeThreshold: number expected":null:"negativeAltitudeExponentBias: integer expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.PlanetModelProto)return e;var t=new u.keyhole.dbroot.PlanetModelProto;return void 0!==e.radius&&null!==e.radius&&(t.radius=Number(e.radius)),void 0!==e.flattening&&null!==e.flattening&&(t.flattening=Number(e.flattening)),void 0!==e.elevationBias&&null!==e.elevationBias&&(t.elevationBias=Number(e.elevationBias)),void 0!==e.negativeAltitudeExponentBias&&null!==e.negativeAltitudeExponentBias&&(t.negativeAltitudeExponentBias=0|e.negativeAltitudeExponentBias),void 0!==e.compressedNegativeAltitudeThreshold&&null!==e.compressedNegativeAltitudeThreshold&&(t.compressedNegativeAltitudeThreshold=Number(e.compressedNegativeAltitudeThreshold)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.radius=6378.137,r.flattening=.00335281066474748,r.elevationBias=0,r.negativeAltitudeExponentBias=0,r.compressedNegativeAltitudeThreshold=0),void 0!==e.radius&&null!==e.radius&&e.hasOwnProperty("radius")&&(r.radius=e.radius),void 0!==e.flattening&&null!==e.flattening&&e.hasOwnProperty("flattening")&&(r.flattening=e.flattening),void 0!==e.elevationBias&&null!==e.elevationBias&&e.hasOwnProperty("elevationBias")&&(r.elevationBias=e.elevationBias),void 0!==e.negativeAltitudeExponentBias&&null!==e.negativeAltitudeExponentBias&&e.hasOwnProperty("negativeAltitudeExponentBias")&&(r.negativeAltitudeExponentBias=e.negativeAltitudeExponentBias),void 0!==e.compressedNegativeAltitudeThreshold&&null!==e.compressedNegativeAltitudeThreshold&&e.hasOwnProperty("compressedNegativeAltitudeThreshold")&&(r.compressedNegativeAltitudeThreshold=e.compressedNegativeAltitudeThreshold),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.ProviderInfoProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.providerId=0,e.prototype.copyrightString=null,e.prototype.verticalPixelOffset=-1;var o={1:"keyhole.dbroot.StringIdOrValueProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.ProviderInfoProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.providerId=e.int32();break;case 2:i.copyrightString=o[1].decode(e,e.uint32());break;case 3:i.verticalPixelOffset=e.int32();break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(!s.isInteger(e.providerId))return"providerId: integer expected";if(void 0!==e.copyrightString&&null!==e.copyrightString){var t=o[1].verify(e.copyrightString);if(t)return"copyrightString."+t}return void 0===e.verticalPixelOffset||s.isInteger(e.verticalPixelOffset)?null:"verticalPixelOffset: integer expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.ProviderInfoProto)return e;var t=new u.keyhole.dbroot.ProviderInfoProto;if(void 0!==e.providerId&&null!==e.providerId&&(t.providerId=0|e.providerId),void 0!==e.copyrightString&&null!==e.copyrightString){if("object"!=typeof e.copyrightString)throw TypeError(".keyhole.dbroot.ProviderInfoProto.copyrightString: object expected");t.copyrightString=o[1].fromObject(e.copyrightString)}return void 0!==e.verticalPixelOffset&&null!==e.verticalPixelOffset&&(t.verticalPixelOffset=0|e.verticalPixelOffset),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.providerId=0,r.copyrightString=null,r.verticalPixelOffset=-1),void 0!==e.providerId&&null!==e.providerId&&e.hasOwnProperty("providerId")&&(r.providerId=e.providerId),void 0!==e.copyrightString&&null!==e.copyrightString&&e.hasOwnProperty("copyrightString")&&(r.copyrightString=o[1].toObject(e.copyrightString,t)),void 0!==e.verticalPixelOffset&&null!==e.verticalPixelOffset&&e.hasOwnProperty("verticalPixelOffset")&&(r.verticalPixelOffset=e.verticalPixelOffset),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.PopUpProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.isBalloonStyle=!1,e.prototype.text=null,e.prototype.backgroundColorAbgr=4294967295,e.prototype.textColorAbgr=4278190080;var o={1:"keyhole.dbroot.StringIdOrValueProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.PopUpProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.isBalloonStyle=e.bool();break;case 2:i.text=o[1].decode(e,e.uint32());break;case 3:i.backgroundColorAbgr=e.fixed32();break;case 4:i.textColorAbgr=e.fixed32();break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(void 0!==e.isBalloonStyle&&"boolean"!=typeof e.isBalloonStyle)return"isBalloonStyle: boolean expected";if(void 0!==e.text&&null!==e.text){var t=o[1].verify(e.text);if(t)return"text."+t}return void 0===e.backgroundColorAbgr||s.isInteger(e.backgroundColorAbgr)?void 0===e.textColorAbgr||s.isInteger(e.textColorAbgr)?null:"textColorAbgr: integer expected":"backgroundColorAbgr: integer expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.PopUpProto)return e;var t=new u.keyhole.dbroot.PopUpProto;if(void 0!==e.isBalloonStyle&&null!==e.isBalloonStyle&&(t.isBalloonStyle=Boolean(e.isBalloonStyle)),void 0!==e.text&&null!==e.text){if("object"!=typeof e.text)throw TypeError(".keyhole.dbroot.PopUpProto.text: object expected");t.text=o[1].fromObject(e.text)}return void 0!==e.backgroundColorAbgr&&null!==e.backgroundColorAbgr&&(t.backgroundColorAbgr=e.backgroundColorAbgr>>>0),void 0!==e.textColorAbgr&&null!==e.textColorAbgr&&(t.textColorAbgr=e.textColorAbgr>>>0),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.isBalloonStyle=!1,r.text=null,r.backgroundColorAbgr=4294967295,r.textColorAbgr=4278190080),void 0!==e.isBalloonStyle&&null!==e.isBalloonStyle&&e.hasOwnProperty("isBalloonStyle")&&(r.isBalloonStyle=e.isBalloonStyle),void 0!==e.text&&null!==e.text&&e.hasOwnProperty("text")&&(r.text=o[1].toObject(e.text,t)),void 0!==e.backgroundColorAbgr&&null!==e.backgroundColorAbgr&&e.hasOwnProperty("backgroundColorAbgr")&&(r.backgroundColorAbgr=e.backgroundColorAbgr),void 0!==e.textColorAbgr&&null!==e.textColorAbgr&&e.hasOwnProperty("textColorAbgr")&&(r.textColorAbgr=e.textColorAbgr),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.StyleAttributeProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.styleId="",e.prototype.providerId=0,e.prototype.polyColorAbgr=4294967295,e.prototype.lineColorAbgr=4294967295,e.prototype.lineWidth=1,e.prototype.labelColorAbgr=4294967295,e.prototype.labelScale=1,e.prototype.placemarkIconColorAbgr=4294967295,e.prototype.placemarkIconScale=1,e.prototype.placemarkIconPath=null,e.prototype.placemarkIconX=0,e.prototype.placemarkIconY=0,e.prototype.placemarkIconWidth=32,e.prototype.placemarkIconHeight=32,e.prototype.popUp=null,e.prototype.drawFlag=s.emptyArray;var o={9:"keyhole.dbroot.StringIdOrValueProto",14:"keyhole.dbroot.PopUpProto",15:"keyhole.dbroot.DrawFlagProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.StyleAttributeProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.styleId=e.string();break;case 3:i.providerId=e.int32();break;case 4:i.polyColorAbgr=e.fixed32();break;case 5:i.lineColorAbgr=e.fixed32();break;case 6:i.lineWidth=e.float();break;case 7:i.labelColorAbgr=e.fixed32();break;case 8:i.labelScale=e.float();break;case 9:i.placemarkIconColorAbgr=e.fixed32();break;case 10:i.placemarkIconScale=e.float();break;case 11:i.placemarkIconPath=o[9].decode(e,e.uint32());break;case 12:i.placemarkIconX=e.int32();break;case 13:i.placemarkIconY=e.int32();break;case 14:i.placemarkIconWidth=e.int32();break;case 15:i.placemarkIconHeight=e.int32();break;case 16:i.popUp=o[14].decode(e,e.uint32());break;case 17:i.drawFlag&&i.drawFlag.length||(i.drawFlag=[]),i.drawFlag.push(o[15].decode(e,e.uint32()));break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(!s.isString(e.styleId))return"styleId: string expected";if(void 0!==e.providerId&&!s.isInteger(e.providerId))return"providerId: integer expected";if(void 0!==e.polyColorAbgr&&!s.isInteger(e.polyColorAbgr))return"polyColorAbgr: integer expected";if(void 0!==e.lineColorAbgr&&!s.isInteger(e.lineColorAbgr))return"lineColorAbgr: integer expected";if(void 0!==e.lineWidth&&"number"!=typeof e.lineWidth)return"lineWidth: number expected";if(void 0!==e.labelColorAbgr&&!s.isInteger(e.labelColorAbgr))return"labelColorAbgr: integer expected";if(void 0!==e.labelScale&&"number"!=typeof e.labelScale)return"labelScale: number expected";if(void 0!==e.placemarkIconColorAbgr&&!s.isInteger(e.placemarkIconColorAbgr))return"placemarkIconColorAbgr: integer expected";if(void 0!==e.placemarkIconScale&&"number"!=typeof e.placemarkIconScale)return"placemarkIconScale: number expected";if(void 0!==e.placemarkIconPath&&null!==e.placemarkIconPath&&(r=o[9].verify(e.placemarkIconPath)))return"placemarkIconPath."+r;if(void 0!==e.placemarkIconX&&!s.isInteger(e.placemarkIconX))return"placemarkIconX: integer expected";if(void 0!==e.placemarkIconY&&!s.isInteger(e.placemarkIconY))return"placemarkIconY: integer expected";if(void 0!==e.placemarkIconWidth&&!s.isInteger(e.placemarkIconWidth))return"placemarkIconWidth: integer expected";if(void 0!==e.placemarkIconHeight&&!s.isInteger(e.placemarkIconHeight))return"placemarkIconHeight: integer expected";if(void 0!==e.popUp&&null!==e.popUp&&(r=o[14].verify(e.popUp)))return"popUp."+r;if(void 0!==e.drawFlag){if(!Array.isArray(e.drawFlag))return"drawFlag: array expected";for(var t=0;t<e.drawFlag.length;++t){var r;if(r=o[15].verify(e.drawFlag[t]))return"drawFlag."+r}}return null},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.StyleAttributeProto)return e;var t=new u.keyhole.dbroot.StyleAttributeProto;if(void 0!==e.styleId&&null!==e.styleId&&(t.styleId=String(e.styleId)),void 0!==e.providerId&&null!==e.providerId&&(t.providerId=0|e.providerId),void 0!==e.polyColorAbgr&&null!==e.polyColorAbgr&&(t.polyColorAbgr=e.polyColorAbgr>>>0),void 0!==e.lineColorAbgr&&null!==e.lineColorAbgr&&(t.lineColorAbgr=e.lineColorAbgr>>>0),void 0!==e.lineWidth&&null!==e.lineWidth&&(t.lineWidth=Number(e.lineWidth)),void 0!==e.labelColorAbgr&&null!==e.labelColorAbgr&&(t.labelColorAbgr=e.labelColorAbgr>>>0),void 0!==e.labelScale&&null!==e.labelScale&&(t.labelScale=Number(e.labelScale)),void 0!==e.placemarkIconColorAbgr&&null!==e.placemarkIconColorAbgr&&(t.placemarkIconColorAbgr=e.placemarkIconColorAbgr>>>0),void 0!==e.placemarkIconScale&&null!==e.placemarkIconScale&&(t.placemarkIconScale=Number(e.placemarkIconScale)),void 0!==e.placemarkIconPath&&null!==e.placemarkIconPath){if("object"!=typeof e.placemarkIconPath)throw TypeError(".keyhole.dbroot.StyleAttributeProto.placemarkIconPath: object expected");t.placemarkIconPath=o[9].fromObject(e.placemarkIconPath)}if(void 0!==e.placemarkIconX&&null!==e.placemarkIconX&&(t.placemarkIconX=0|e.placemarkIconX),void 0!==e.placemarkIconY&&null!==e.placemarkIconY&&(t.placemarkIconY=0|e.placemarkIconY),void 0!==e.placemarkIconWidth&&null!==e.placemarkIconWidth&&(t.placemarkIconWidth=0|e.placemarkIconWidth),void 0!==e.placemarkIconHeight&&null!==e.placemarkIconHeight&&(t.placemarkIconHeight=0|e.placemarkIconHeight),void 0!==e.popUp&&null!==e.popUp){if("object"!=typeof e.popUp)throw TypeError(".keyhole.dbroot.StyleAttributeProto.popUp: object expected");t.popUp=o[14].fromObject(e.popUp)}if(e.drawFlag){if(!Array.isArray(e.drawFlag))throw TypeError(".keyhole.dbroot.StyleAttributeProto.drawFlag: array expected");t.drawFlag=[];for(var r=0;r<e.drawFlag.length;++r){if("object"!=typeof e.drawFlag[r])throw TypeError(".keyhole.dbroot.StyleAttributeProto.drawFlag: object expected");t.drawFlag[r]=o[15].fromObject(e.drawFlag[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.drawFlag=[]),t.defaults&&(r.styleId="",r.providerId=0,r.polyColorAbgr=4294967295,r.lineColorAbgr=4294967295,r.lineWidth=1,r.labelColorAbgr=4294967295,r.labelScale=1,r.placemarkIconColorAbgr=4294967295,r.placemarkIconScale=1,r.placemarkIconPath=null,r.placemarkIconX=0,r.placemarkIconY=0,r.placemarkIconWidth=32,r.placemarkIconHeight=32,r.popUp=null),void 0!==e.styleId&&null!==e.styleId&&e.hasOwnProperty("styleId")&&(r.styleId=e.styleId),void 0!==e.providerId&&null!==e.providerId&&e.hasOwnProperty("providerId")&&(r.providerId=e.providerId),void 0!==e.polyColorAbgr&&null!==e.polyColorAbgr&&e.hasOwnProperty("polyColorAbgr")&&(r.polyColorAbgr=e.polyColorAbgr),void 0!==e.lineColorAbgr&&null!==e.lineColorAbgr&&e.hasOwnProperty("lineColorAbgr")&&(r.lineColorAbgr=e.lineColorAbgr),void 0!==e.lineWidth&&null!==e.lineWidth&&e.hasOwnProperty("lineWidth")&&(r.lineWidth=e.lineWidth),void 0!==e.labelColorAbgr&&null!==e.labelColorAbgr&&e.hasOwnProperty("labelColorAbgr")&&(r.labelColorAbgr=e.labelColorAbgr),void 0!==e.labelScale&&null!==e.labelScale&&e.hasOwnProperty("labelScale")&&(r.labelScale=e.labelScale),void 0!==e.placemarkIconColorAbgr&&null!==e.placemarkIconColorAbgr&&e.hasOwnProperty("placemarkIconColorAbgr")&&(r.placemarkIconColorAbgr=e.placemarkIconColorAbgr),void 0!==e.placemarkIconScale&&null!==e.placemarkIconScale&&e.hasOwnProperty("placemarkIconScale")&&(r.placemarkIconScale=e.placemarkIconScale),void 0!==e.placemarkIconPath&&null!==e.placemarkIconPath&&e.hasOwnProperty("placemarkIconPath")&&(r.placemarkIconPath=o[9].toObject(e.placemarkIconPath,t)),void 0!==e.placemarkIconX&&null!==e.placemarkIconX&&e.hasOwnProperty("placemarkIconX")&&(r.placemarkIconX=e.placemarkIconX),void 0!==e.placemarkIconY&&null!==e.placemarkIconY&&e.hasOwnProperty("placemarkIconY")&&(r.placemarkIconY=e.placemarkIconY),void 0!==e.placemarkIconWidth&&null!==e.placemarkIconWidth&&e.hasOwnProperty("placemarkIconWidth")&&(r.placemarkIconWidth=e.placemarkIconWidth),void 0!==e.placemarkIconHeight&&null!==e.placemarkIconHeight&&e.hasOwnProperty("placemarkIconHeight")&&(r.placemarkIconHeight=e.placemarkIconHeight),void 0!==e.popUp&&null!==e.popUp&&e.hasOwnProperty("popUp")&&(r.popUp=o[14].toObject(e.popUp,t)),void 0!==e.drawFlag&&null!==e.drawFlag&&e.hasOwnProperty("drawFlag")){r.drawFlag=[];for(var i=0;i<e.drawFlag.length;++i)r.drawFlag[i]=o[15].toObject(e.drawFlag[i],t)}return r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.StyleMapProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}return e.prototype.styleMapId=0,e.prototype.channelId=s.emptyArray,e.prototype.normalStyleAttribute=0,e.prototype.highlightStyleAttribute=0,e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.StyleMapProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.styleMapId=e.int32();break;case 2:if(i.channelId&&i.channelId.length||(i.channelId=[]),2==(7&n))for(var o=e.uint32()+e.pos;e.pos<o;)i.channelId.push(e.int32());else i.channelId.push(e.int32());break;case 3:i.normalStyleAttribute=e.int32();break;case 4:i.highlightStyleAttribute=e.int32();break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(!s.isInteger(e.styleMapId))return"styleMapId: integer expected";if(void 0!==e.channelId){if(!Array.isArray(e.channelId))return"channelId: array expected";for(var t=0;t<e.channelId.length;++t)if(!s.isInteger(e.channelId[t]))return"channelId: integer[] expected"}return void 0===e.normalStyleAttribute||s.isInteger(e.normalStyleAttribute)?void 0===e.highlightStyleAttribute||s.isInteger(e.highlightStyleAttribute)?null:"highlightStyleAttribute: integer expected":"normalStyleAttribute: integer expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.StyleMapProto)return e;var t=new u.keyhole.dbroot.StyleMapProto;if(void 0!==e.styleMapId&&null!==e.styleMapId&&(t.styleMapId=0|e.styleMapId),e.channelId){if(!Array.isArray(e.channelId))throw TypeError(".keyhole.dbroot.StyleMapProto.channelId: array expected");t.channelId=[];for(var r=0;r<e.channelId.length;++r)t.channelId[r]=0|e.channelId[r]}return void 0!==e.normalStyleAttribute&&null!==e.normalStyleAttribute&&(t.normalStyleAttribute=0|e.normalStyleAttribute),void 0!==e.highlightStyleAttribute&&null!==e.highlightStyleAttribute&&(t.highlightStyleAttribute=0|e.highlightStyleAttribute),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.channelId=[]),t.defaults&&(r.styleMapId=0,r.normalStyleAttribute=0,r.highlightStyleAttribute=0),void 0!==e.styleMapId&&null!==e.styleMapId&&e.hasOwnProperty("styleMapId")&&(r.styleMapId=e.styleMapId),void 0!==e.channelId&&null!==e.channelId&&e.hasOwnProperty("channelId")){r.channelId=[];for(var i=0;i<e.channelId.length;++i)r.channelId[i]=e.channelId[i]}return void 0!==e.normalStyleAttribute&&null!==e.normalStyleAttribute&&e.hasOwnProperty("normalStyleAttribute")&&(r.normalStyleAttribute=e.normalStyleAttribute),void 0!==e.highlightStyleAttribute&&null!==e.highlightStyleAttribute&&e.hasOwnProperty("highlightStyleAttribute")&&(r.highlightStyleAttribute=e.highlightStyleAttribute),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.ZoomRangeProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}return e.prototype.minZoom=0,e.prototype.maxZoom=0,e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.ZoomRangeProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.minZoom=e.int32();break;case 2:i.maxZoom=e.int32();break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":s.isInteger(e.minZoom)?s.isInteger(e.maxZoom)?null:"maxZoom: integer expected":"minZoom: integer expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.ZoomRangeProto)return e;var t=new u.keyhole.dbroot.ZoomRangeProto;return void 0!==e.minZoom&&null!==e.minZoom&&(t.minZoom=0|e.minZoom),void 0!==e.maxZoom&&null!==e.maxZoom&&(t.maxZoom=0|e.maxZoom),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.minZoom=0,r.maxZoom=0),void 0!==e.minZoom&&null!==e.minZoom&&e.hasOwnProperty("minZoom")&&(r.minZoom=e.minZoom),void 0!==e.maxZoom&&null!==e.maxZoom&&e.hasOwnProperty("maxZoom")&&(r.maxZoom=e.maxZoom),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.DrawFlagProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.drawFlagType=1;var t,i={0:"keyhole.dbroot.DrawFlagProto.DrawFlagType"};return l.push(i),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.DrawFlagProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.drawFlagType=e.uint32();break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";switch(e.drawFlagType){default:return"drawFlagType: enum value expected";case 1:case 2:case 3:case 4:case 5:}return null},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.DrawFlagProto)return e;var t=new u.keyhole.dbroot.DrawFlagProto;switch(e.drawFlagType){case"TYPE_FILL_ONLY":case 1:t.drawFlagType=1;break;case"TYPE_OUTLINE_ONLY":case 2:t.drawFlagType=2;break;case"TYPE_FILL_AND_OUTLINE":case 3:t.drawFlagType=3;break;case"TYPE_ANTIALIASING":case 4:t.drawFlagType=4;break;case"TYPE_CENTER_LABEL":case 5:t.drawFlagType=5}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.drawFlagType=t.enums===String?"TYPE_FILL_ONLY":1),void 0!==e.drawFlagType&&null!==e.drawFlagType&&e.hasOwnProperty("drawFlagType")&&(r.drawFlagType=t.enums===String?i[0][e.drawFlagType]:e.drawFlagType),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.DrawFlagType=((t=Object.create({})).TYPE_FILL_ONLY=1,t.TYPE_OUTLINE_ONLY=2,t.TYPE_FILL_AND_OUTLINE=3,t.TYPE_ANTIALIASING=4,t.TYPE_CENTER_LABEL=5,t),e}(),e.LayerProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.zoomRange=s.emptyArray,e.prototype.preserveTextLevel=30,e.prototype.lodBeginTransition=!1,e.prototype.lodEndTransition=!1;var o={0:"keyhole.dbroot.ZoomRangeProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.LayerProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.zoomRange&&i.zoomRange.length||(i.zoomRange=[]),i.zoomRange.push(o[0].decode(e,e.uint32()));break;case 2:i.preserveTextLevel=e.int32();break;case 4:i.lodBeginTransition=e.bool();break;case 5:i.lodEndTransition=e.bool();break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(void 0!==e.zoomRange){if(!Array.isArray(e.zoomRange))return"zoomRange: array expected";for(var t=0;t<e.zoomRange.length;++t){var r=o[0].verify(e.zoomRange[t]);if(r)return"zoomRange."+r}}return void 0===e.preserveTextLevel||s.isInteger(e.preserveTextLevel)?void 0!==e.lodBeginTransition&&"boolean"!=typeof e.lodBeginTransition?"lodBeginTransition: boolean expected":void 0!==e.lodEndTransition&&"boolean"!=typeof e.lodEndTransition?"lodEndTransition: boolean expected":null:"preserveTextLevel: integer expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.LayerProto)return e;var t=new u.keyhole.dbroot.LayerProto;if(e.zoomRange){if(!Array.isArray(e.zoomRange))throw TypeError(".keyhole.dbroot.LayerProto.zoomRange: array expected");t.zoomRange=[];for(var r=0;r<e.zoomRange.length;++r){if("object"!=typeof e.zoomRange[r])throw TypeError(".keyhole.dbroot.LayerProto.zoomRange: object expected");t.zoomRange[r]=o[0].fromObject(e.zoomRange[r])}}return void 0!==e.preserveTextLevel&&null!==e.preserveTextLevel&&(t.preserveTextLevel=0|e.preserveTextLevel),void 0!==e.lodBeginTransition&&null!==e.lodBeginTransition&&(t.lodBeginTransition=Boolean(e.lodBeginTransition)),void 0!==e.lodEndTransition&&null!==e.lodEndTransition&&(t.lodEndTransition=Boolean(e.lodEndTransition)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.zoomRange=[]),t.defaults&&(r.preserveTextLevel=30,r.lodBeginTransition=!1,r.lodEndTransition=!1),void 0!==e.zoomRange&&null!==e.zoomRange&&e.hasOwnProperty("zoomRange")){r.zoomRange=[];for(var i=0;i<e.zoomRange.length;++i)r.zoomRange[i]=o[0].toObject(e.zoomRange[i],t)}return void 0!==e.preserveTextLevel&&null!==e.preserveTextLevel&&e.hasOwnProperty("preserveTextLevel")&&(r.preserveTextLevel=e.preserveTextLevel),void 0!==e.lodBeginTransition&&null!==e.lodBeginTransition&&e.hasOwnProperty("lodBeginTransition")&&(r.lodBeginTransition=e.lodBeginTransition),void 0!==e.lodEndTransition&&null!==e.lodEndTransition&&e.hasOwnProperty("lodEndTransition")&&(r.lodEndTransition=e.lodEndTransition),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.FolderProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}return e.prototype.isExpandable=!0,e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.FolderProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.isExpandable=e.bool();break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":void 0!==e.isExpandable&&"boolean"!=typeof e.isExpandable?"isExpandable: boolean expected":null},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.FolderProto)return e;var t=new u.keyhole.dbroot.FolderProto;return void 0!==e.isExpandable&&null!==e.isExpandable&&(t.isExpandable=Boolean(e.isExpandable)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.isExpandable=!0),void 0!==e.isExpandable&&null!==e.isExpandable&&e.hasOwnProperty("isExpandable")&&(r.isExpandable=e.isExpandable),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.RequirementProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}return e.prototype.requiredVram="",e.prototype.requiredClientVer="",e.prototype.probability="",e.prototype.requiredUserAgent="",e.prototype.requiredClientCapabilities="",e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.RequirementProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 3:i.requiredVram=e.string();break;case 4:i.requiredClientVer=e.string();break;case 5:i.probability=e.string();break;case 6:i.requiredUserAgent=e.string();break;case 7:i.requiredClientCapabilities=e.string();break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":void 0===e.requiredVram||s.isString(e.requiredVram)?void 0===e.requiredClientVer||s.isString(e.requiredClientVer)?void 0===e.probability||s.isString(e.probability)?void 0===e.requiredUserAgent||s.isString(e.requiredUserAgent)?void 0===e.requiredClientCapabilities||s.isString(e.requiredClientCapabilities)?null:"requiredClientCapabilities: string expected":"requiredUserAgent: string expected":"probability: string expected":"requiredClientVer: string expected":"requiredVram: string expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.RequirementProto)return e;var t=new u.keyhole.dbroot.RequirementProto;return void 0!==e.requiredVram&&null!==e.requiredVram&&(t.requiredVram=String(e.requiredVram)),void 0!==e.requiredClientVer&&null!==e.requiredClientVer&&(t.requiredClientVer=String(e.requiredClientVer)),void 0!==e.probability&&null!==e.probability&&(t.probability=String(e.probability)),void 0!==e.requiredUserAgent&&null!==e.requiredUserAgent&&(t.requiredUserAgent=String(e.requiredUserAgent)),void 0!==e.requiredClientCapabilities&&null!==e.requiredClientCapabilities&&(t.requiredClientCapabilities=String(e.requiredClientCapabilities)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.requiredVram="",r.requiredClientVer="",r.probability="",r.requiredUserAgent="",r.requiredClientCapabilities=""),void 0!==e.requiredVram&&null!==e.requiredVram&&e.hasOwnProperty("requiredVram")&&(r.requiredVram=e.requiredVram),void 0!==e.requiredClientVer&&null!==e.requiredClientVer&&e.hasOwnProperty("requiredClientVer")&&(r.requiredClientVer=e.requiredClientVer),void 0!==e.probability&&null!==e.probability&&e.hasOwnProperty("probability")&&(r.probability=e.probability),void 0!==e.requiredUserAgent&&null!==e.requiredUserAgent&&e.hasOwnProperty("requiredUserAgent")&&(r.requiredUserAgent=e.requiredUserAgent),void 0!==e.requiredClientCapabilities&&null!==e.requiredClientCapabilities&&e.hasOwnProperty("requiredClientCapabilities")&&(r.requiredClientCapabilities=e.requiredClientCapabilities),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.LookAtProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}return e.prototype.longitude=0,e.prototype.latitude=0,e.prototype.range=0,e.prototype.tilt=0,e.prototype.heading=0,e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.LookAtProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.longitude=e.float();break;case 2:i.latitude=e.float();break;case 3:i.range=e.float();break;case 4:i.tilt=e.float();break;case 5:i.heading=e.float();break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":"number"!=typeof e.longitude?"longitude: number expected":"number"!=typeof e.latitude?"latitude: number expected":void 0!==e.range&&"number"!=typeof e.range?"range: number expected":void 0!==e.tilt&&"number"!=typeof e.tilt?"tilt: number expected":void 0!==e.heading&&"number"!=typeof e.heading?"heading: number expected":null},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.LookAtProto)return e;var t=new u.keyhole.dbroot.LookAtProto;return void 0!==e.longitude&&null!==e.longitude&&(t.longitude=Number(e.longitude)),void 0!==e.latitude&&null!==e.latitude&&(t.latitude=Number(e.latitude)),void 0!==e.range&&null!==e.range&&(t.range=Number(e.range)),void 0!==e.tilt&&null!==e.tilt&&(t.tilt=Number(e.tilt)),void 0!==e.heading&&null!==e.heading&&(t.heading=Number(e.heading)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.longitude=0,r.latitude=0,r.range=0,r.tilt=0,r.heading=0),void 0!==e.longitude&&null!==e.longitude&&e.hasOwnProperty("longitude")&&(r.longitude=e.longitude),void 0!==e.latitude&&null!==e.latitude&&e.hasOwnProperty("latitude")&&(r.latitude=e.latitude),void 0!==e.range&&null!==e.range&&e.hasOwnProperty("range")&&(r.range=e.range),void 0!==e.tilt&&null!==e.tilt&&e.hasOwnProperty("tilt")&&(r.tilt=e.tilt),void 0!==e.heading&&null!==e.heading&&e.hasOwnProperty("heading")&&(r.heading=e.heading),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.NestedFeatureProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.featureType=1,e.prototype.kmlUrl=null,e.prototype.databaseUrl="",e.prototype.layer=null,e.prototype.folder=null,e.prototype.requirement=null,e.prototype.channelId=0,e.prototype.displayName=null,e.prototype.isVisible=!0,e.prototype.isEnabled=!0,e.prototype.isChecked=!1,e.prototype.layerMenuIconPath="icons/773_l.png",e.prototype.description=null,e.prototype.lookAt=null,e.prototype.assetUuid="",e.prototype.isSaveLocked=!0,e.prototype.children=s.emptyArray,e.prototype.clientConfigScriptName="",e.prototype.dioramaDataChannelBase=-1,e.prototype.replicaDataChannelBase=-1;var t,o={0:"keyhole.dbroot.NestedFeatureProto.FeatureType",1:"keyhole.dbroot.StringIdOrValueProto",3:"keyhole.dbroot.LayerProto",4:"keyhole.dbroot.FolderProto",5:"keyhole.dbroot.RequirementProto",7:"keyhole.dbroot.StringIdOrValueProto",12:"keyhole.dbroot.StringIdOrValueProto",13:"keyhole.dbroot.LookAtProto",16:"keyhole.dbroot.NestedFeatureProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.NestedFeatureProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.featureType=e.uint32();break;case 2:i.kmlUrl=o[1].decode(e,e.uint32());break;case 21:i.databaseUrl=e.string();break;case 3:i.layer=o[3].decode(e,e.uint32());break;case 4:i.folder=o[4].decode(e,e.uint32());break;case 5:i.requirement=o[5].decode(e,e.uint32());break;case 6:i.channelId=e.int32();break;case 7:i.displayName=o[7].decode(e,e.uint32());break;case 8:i.isVisible=e.bool();break;case 9:i.isEnabled=e.bool();break;case 10:i.isChecked=e.bool();break;case 11:i.layerMenuIconPath=e.string();break;case 12:i.description=o[12].decode(e,e.uint32());break;case 13:i.lookAt=o[13].decode(e,e.uint32());break;case 15:i.assetUuid=e.string();break;case 16:i.isSaveLocked=e.bool();break;case 17:i.children&&i.children.length||(i.children=[]),i.children.push(o[16].decode(e,e.uint32()));break;case 18:i.clientConfigScriptName=e.string();break;case 19:i.dioramaDataChannelBase=e.int32();break;case 20:i.replicaDataChannelBase=e.int32();break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(void 0!==e.featureType)switch(e.featureType){default:return"featureType: enum value expected";case 1:case 2:case 3:case 4:}if(void 0!==e.kmlUrl&&null!==e.kmlUrl&&(r=o[1].verify(e.kmlUrl)))return"kmlUrl."+r;if(void 0!==e.databaseUrl&&!s.isString(e.databaseUrl))return"databaseUrl: string expected";if(void 0!==e.layer&&null!==e.layer&&(r=o[3].verify(e.layer)))return"layer."+r;if(void 0!==e.folder&&null!==e.folder&&(r=o[4].verify(e.folder)))return"folder."+r;if(void 0!==e.requirement&&null!==e.requirement&&(r=o[5].verify(e.requirement)))return"requirement."+r;if(!s.isInteger(e.channelId))return"channelId: integer expected";if(void 0!==e.displayName&&null!==e.displayName&&(r=o[7].verify(e.displayName)))return"displayName."+r;if(void 0!==e.isVisible&&"boolean"!=typeof e.isVisible)return"isVisible: boolean expected";if(void 0!==e.isEnabled&&"boolean"!=typeof e.isEnabled)return"isEnabled: boolean expected";if(void 0!==e.isChecked&&"boolean"!=typeof e.isChecked)return"isChecked: boolean expected";if(void 0!==e.layerMenuIconPath&&!s.isString(e.layerMenuIconPath))return"layerMenuIconPath: string expected";if(void 0!==e.description&&null!==e.description&&(r=o[12].verify(e.description)))return"description."+r;if(void 0!==e.lookAt&&null!==e.lookAt&&(r=o[13].verify(e.lookAt)))return"lookAt."+r;if(void 0!==e.assetUuid&&!s.isString(e.assetUuid))return"assetUuid: string expected";if(void 0!==e.isSaveLocked&&"boolean"!=typeof e.isSaveLocked)return"isSaveLocked: boolean expected";if(void 0!==e.children){if(!Array.isArray(e.children))return"children: array expected";for(var t=0;t<e.children.length;++t){var r;if(r=o[16].verify(e.children[t]))return"children."+r}}return void 0===e.clientConfigScriptName||s.isString(e.clientConfigScriptName)?void 0===e.dioramaDataChannelBase||s.isInteger(e.dioramaDataChannelBase)?void 0===e.replicaDataChannelBase||s.isInteger(e.replicaDataChannelBase)?null:"replicaDataChannelBase: integer expected":"dioramaDataChannelBase: integer expected":"clientConfigScriptName: string expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.NestedFeatureProto)return e;var t=new u.keyhole.dbroot.NestedFeatureProto;switch(e.featureType){case"TYPE_POINT_Z":case 1:t.featureType=1;break;case"TYPE_POLYGON_Z":case 2:t.featureType=2;break;case"TYPE_LINE_Z":case 3:t.featureType=3;break;case"TYPE_TERRAIN":case 4:t.featureType=4}if(void 0!==e.kmlUrl&&null!==e.kmlUrl){if("object"!=typeof e.kmlUrl)throw TypeError(".keyhole.dbroot.NestedFeatureProto.kmlUrl: object expected");t.kmlUrl=o[1].fromObject(e.kmlUrl)}if(void 0!==e.databaseUrl&&null!==e.databaseUrl&&(t.databaseUrl=String(e.databaseUrl)),void 0!==e.layer&&null!==e.layer){if("object"!=typeof e.layer)throw TypeError(".keyhole.dbroot.NestedFeatureProto.layer: object expected");t.layer=o[3].fromObject(e.layer)}if(void 0!==e.folder&&null!==e.folder){if("object"!=typeof e.folder)throw TypeError(".keyhole.dbroot.NestedFeatureProto.folder: object expected");t.folder=o[4].fromObject(e.folder)}if(void 0!==e.requirement&&null!==e.requirement){if("object"!=typeof e.requirement)throw TypeError(".keyhole.dbroot.NestedFeatureProto.requirement: object expected");t.requirement=o[5].fromObject(e.requirement)}if(void 0!==e.channelId&&null!==e.channelId&&(t.channelId=0|e.channelId),void 0!==e.displayName&&null!==e.displayName){if("object"!=typeof e.displayName)throw TypeError(".keyhole.dbroot.NestedFeatureProto.displayName: object expected");t.displayName=o[7].fromObject(e.displayName)}if(void 0!==e.isVisible&&null!==e.isVisible&&(t.isVisible=Boolean(e.isVisible)),void 0!==e.isEnabled&&null!==e.isEnabled&&(t.isEnabled=Boolean(e.isEnabled)),void 0!==e.isChecked&&null!==e.isChecked&&(t.isChecked=Boolean(e.isChecked)),void 0!==e.layerMenuIconPath&&null!==e.layerMenuIconPath&&(t.layerMenuIconPath=String(e.layerMenuIconPath)),void 0!==e.description&&null!==e.description){if("object"!=typeof e.description)throw TypeError(".keyhole.dbroot.NestedFeatureProto.description: object expected");t.description=o[12].fromObject(e.description)}if(void 0!==e.lookAt&&null!==e.lookAt){if("object"!=typeof e.lookAt)throw TypeError(".keyhole.dbroot.NestedFeatureProto.lookAt: object expected");t.lookAt=o[13].fromObject(e.lookAt)}if(void 0!==e.assetUuid&&null!==e.assetUuid&&(t.assetUuid=String(e.assetUuid)),void 0!==e.isSaveLocked&&null!==e.isSaveLocked&&(t.isSaveLocked=Boolean(e.isSaveLocked)),e.children){if(!Array.isArray(e.children))throw TypeError(".keyhole.dbroot.NestedFeatureProto.children: array expected");t.children=[];for(var r=0;r<e.children.length;++r){if("object"!=typeof e.children[r])throw TypeError(".keyhole.dbroot.NestedFeatureProto.children: object expected");t.children[r]=o[16].fromObject(e.children[r])}}return void 0!==e.clientConfigScriptName&&null!==e.clientConfigScriptName&&(t.clientConfigScriptName=String(e.clientConfigScriptName)),void 0!==e.dioramaDataChannelBase&&null!==e.dioramaDataChannelBase&&(t.dioramaDataChannelBase=0|e.dioramaDataChannelBase),void 0!==e.replicaDataChannelBase&&null!==e.replicaDataChannelBase&&(t.replicaDataChannelBase=0|e.replicaDataChannelBase),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.children=[]),t.defaults&&(r.featureType=t.enums===String?"TYPE_POINT_Z":1,r.kmlUrl=null,r.databaseUrl="",r.layer=null,r.folder=null,r.requirement=null,r.channelId=0,r.displayName=null,r.isVisible=!0,r.isEnabled=!0,r.isChecked=!1,r.layerMenuIconPath="icons/773_l.png",r.description=null,r.lookAt=null,r.assetUuid="",r.isSaveLocked=!0,r.clientConfigScriptName="",r.dioramaDataChannelBase=-1,r.replicaDataChannelBase=-1),void 0!==e.featureType&&null!==e.featureType&&e.hasOwnProperty("featureType")&&(r.featureType=t.enums===String?o[0][e.featureType]:e.featureType),void 0!==e.kmlUrl&&null!==e.kmlUrl&&e.hasOwnProperty("kmlUrl")&&(r.kmlUrl=o[1].toObject(e.kmlUrl,t)),void 0!==e.databaseUrl&&null!==e.databaseUrl&&e.hasOwnProperty("databaseUrl")&&(r.databaseUrl=e.databaseUrl),void 0!==e.layer&&null!==e.layer&&e.hasOwnProperty("layer")&&(r.layer=o[3].toObject(e.layer,t)),void 0!==e.folder&&null!==e.folder&&e.hasOwnProperty("folder")&&(r.folder=o[4].toObject(e.folder,t)),void 0!==e.requirement&&null!==e.requirement&&e.hasOwnProperty("requirement")&&(r.requirement=o[5].toObject(e.requirement,t)),void 0!==e.channelId&&null!==e.channelId&&e.hasOwnProperty("channelId")&&(r.channelId=e.channelId),void 0!==e.displayName&&null!==e.displayName&&e.hasOwnProperty("displayName")&&(r.displayName=o[7].toObject(e.displayName,t)),void 0!==e.isVisible&&null!==e.isVisible&&e.hasOwnProperty("isVisible")&&(r.isVisible=e.isVisible),void 0!==e.isEnabled&&null!==e.isEnabled&&e.hasOwnProperty("isEnabled")&&(r.isEnabled=e.isEnabled),void 0!==e.isChecked&&null!==e.isChecked&&e.hasOwnProperty("isChecked")&&(r.isChecked=e.isChecked),void 0!==e.layerMenuIconPath&&null!==e.layerMenuIconPath&&e.hasOwnProperty("layerMenuIconPath")&&(r.layerMenuIconPath=e.layerMenuIconPath),void 0!==e.description&&null!==e.description&&e.hasOwnProperty("description")&&(r.description=o[12].toObject(e.description,t)),void 0!==e.lookAt&&null!==e.lookAt&&e.hasOwnProperty("lookAt")&&(r.lookAt=o[13].toObject(e.lookAt,t)),void 0!==e.assetUuid&&null!==e.assetUuid&&e.hasOwnProperty("assetUuid")&&(r.assetUuid=e.assetUuid),void 0!==e.isSaveLocked&&null!==e.isSaveLocked&&e.hasOwnProperty("isSaveLocked")&&(r.isSaveLocked=e.isSaveLocked),void 0!==e.children&&null!==e.children&&e.hasOwnProperty("children")){r.children=[];for(var i=0;i<e.children.length;++i)r.children[i]=o[16].toObject(e.children[i],t)}return void 0!==e.clientConfigScriptName&&null!==e.clientConfigScriptName&&e.hasOwnProperty("clientConfigScriptName")&&(r.clientConfigScriptName=e.clientConfigScriptName),void 0!==e.dioramaDataChannelBase&&null!==e.dioramaDataChannelBase&&e.hasOwnProperty("dioramaDataChannelBase")&&(r.dioramaDataChannelBase=e.dioramaDataChannelBase),void 0!==e.replicaDataChannelBase&&null!==e.replicaDataChannelBase&&e.hasOwnProperty("replicaDataChannelBase")&&(r.replicaDataChannelBase=e.replicaDataChannelBase),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.FeatureType=((t=Object.create({})).TYPE_POINT_Z=1,t.TYPE_POLYGON_Z=2,t.TYPE_LINE_Z=3,t.TYPE_TERRAIN=4,t),e}(),e.MfeDomainFeaturesProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.countryCode="",e.prototype.domainName="",e.prototype.supportedFeatures=s.emptyArray;var t,n={2:"keyhole.dbroot.MfeDomainFeaturesProto.SupportedFeature"};return l.push(n),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.MfeDomainFeaturesProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.countryCode=e.string();break;case 2:i.domainName=e.string();break;case 3:if(i.supportedFeatures&&i.supportedFeatures.length||(i.supportedFeatures=[]),2==(7&n))for(var o=e.uint32()+e.pos;e.pos<o;)i.supportedFeatures.push(e.uint32());else i.supportedFeatures.push(e.uint32());break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(!s.isString(e.countryCode))return"countryCode: string expected";if(!s.isString(e.domainName))return"domainName: string expected";if(void 0!==e.supportedFeatures){if(!Array.isArray(e.supportedFeatures))return"supportedFeatures: array expected";for(var t=0;t<e.supportedFeatures.length;++t)switch(e.supportedFeatures[t]){default:return"supportedFeatures: enum value[] expected";case 0:case 1:case 2:}}return null},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.MfeDomainFeaturesProto)return e;var t=new u.keyhole.dbroot.MfeDomainFeaturesProto;if(void 0!==e.countryCode&&null!==e.countryCode&&(t.countryCode=String(e.countryCode)),void 0!==e.domainName&&null!==e.domainName&&(t.domainName=String(e.domainName)),e.supportedFeatures){if(!Array.isArray(e.supportedFeatures))throw TypeError(".keyhole.dbroot.MfeDomainFeaturesProto.supportedFeatures: array expected");t.supportedFeatures=[];for(var r=0;r<e.supportedFeatures.length;++r)switch(e.supportedFeatures[r]){default:case"GEOCODING":case 0:t.supportedFeatures[r]=0;break;case"LOCAL_SEARCH":case 1:t.supportedFeatures[r]=1;break;case"DRIVING_DIRECTIONS":case 2:t.supportedFeatures[r]=2}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.supportedFeatures=[]),t.defaults&&(r.countryCode="",r.domainName=""),void 0!==e.countryCode&&null!==e.countryCode&&e.hasOwnProperty("countryCode")&&(r.countryCode=e.countryCode),void 0!==e.domainName&&null!==e.domainName&&e.hasOwnProperty("domainName")&&(r.domainName=e.domainName),void 0!==e.supportedFeatures&&null!==e.supportedFeatures&&e.hasOwnProperty("supportedFeatures")){r.supportedFeatures=[];for(var i=0;i<e.supportedFeatures.length;++i)r.supportedFeatures[i]=t.enums===String?n[2][e.supportedFeatures[i]]:e.supportedFeatures[i]}return r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.SupportedFeature=((t=Object.create({})).GEOCODING=0,t.LOCAL_SEARCH=1,t.DRIVING_DIRECTIONS=2,t),e}(),e.ClientOptionsProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.disableDiskCache=!1,e.prototype.disableEmbeddedBrowserVista=!1,e.prototype.drawAtmosphere=!0,e.prototype.drawStars=!0,e.prototype.shaderFilePrefix="",e.prototype.useProtobufQuadtreePackets=!1,e.prototype.useExtendedCopyrightIds=!0,e.prototype.precipitationsOptions=null,e.prototype.captureOptions=null,e.prototype.show_2dMapsIcon=!0,e.prototype.disableInternalBrowser=!1,e.prototype.internalBrowserBlacklist="",e.prototype.internalBrowserOriginWhitelist="*",e.prototype.polarTileMergingLevel=0,e.prototype.jsBridgeRequestWhitelist="http://*.google.com/*",e.prototype.mapsOptions=null;var o={7:"keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions",8:"keyhole.dbroot.ClientOptionsProto.CaptureOptions",15:"keyhole.dbroot.ClientOptionsProto.MapsOptions"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.ClientOptionsProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.disableDiskCache=e.bool();break;case 2:i.disableEmbeddedBrowserVista=e.bool();break;case 3:i.drawAtmosphere=e.bool();break;case 4:i.drawStars=e.bool();break;case 5:i.shaderFilePrefix=e.string();break;case 6:i.useProtobufQuadtreePackets=e.bool();break;case 7:i.useExtendedCopyrightIds=e.bool();break;case 8:i.precipitationsOptions=o[7].decode(e,e.uint32());break;case 9:i.captureOptions=o[8].decode(e,e.uint32());break;case 10:i.show_2dMapsIcon=e.bool();break;case 11:i.disableInternalBrowser=e.bool();break;case 12:i.internalBrowserBlacklist=e.string();break;case 13:i.internalBrowserOriginWhitelist=e.string();break;case 14:i.polarTileMergingLevel=e.int32();break;case 15:i.jsBridgeRequestWhitelist=e.string();break;case 16:i.mapsOptions=o[15].decode(e,e.uint32());break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":void 0!==e.disableDiskCache&&"boolean"!=typeof e.disableDiskCache?"disableDiskCache: boolean expected":void 0!==e.disableEmbeddedBrowserVista&&"boolean"!=typeof e.disableEmbeddedBrowserVista?"disableEmbeddedBrowserVista: boolean expected":void 0!==e.drawAtmosphere&&"boolean"!=typeof e.drawAtmosphere?"drawAtmosphere: boolean expected":void 0!==e.drawStars&&"boolean"!=typeof e.drawStars?"drawStars: boolean expected":void 0===e.shaderFilePrefix||s.isString(e.shaderFilePrefix)?void 0!==e.useProtobufQuadtreePackets&&"boolean"!=typeof e.useProtobufQuadtreePackets?"useProtobufQuadtreePackets: boolean expected":void 0!==e.useExtendedCopyrightIds&&"boolean"!=typeof e.useExtendedCopyrightIds?"useExtendedCopyrightIds: boolean expected":void 0!==e.precipitationsOptions&&null!==e.precipitationsOptions&&(t=o[7].verify(e.precipitationsOptions))?"precipitationsOptions."+t:void 0!==e.captureOptions&&null!==e.captureOptions&&(t=o[8].verify(e.captureOptions))?"captureOptions."+t:void 0!==e.show_2dMapsIcon&&"boolean"!=typeof e.show_2dMapsIcon?"show_2dMapsIcon: boolean expected":void 0!==e.disableInternalBrowser&&"boolean"!=typeof e.disableInternalBrowser?"disableInternalBrowser: boolean expected":void 0===e.internalBrowserBlacklist||s.isString(e.internalBrowserBlacklist)?void 0===e.internalBrowserOriginWhitelist||s.isString(e.internalBrowserOriginWhitelist)?void 0===e.polarTileMergingLevel||s.isInteger(e.polarTileMergingLevel)?void 0===e.jsBridgeRequestWhitelist||s.isString(e.jsBridgeRequestWhitelist)?void 0!==e.mapsOptions&&null!==e.mapsOptions&&(t=o[15].verify(e.mapsOptions))?"mapsOptions."+t:null:"jsBridgeRequestWhitelist: string expected":"polarTileMergingLevel: integer expected":"internalBrowserOriginWhitelist: string expected":"internalBrowserBlacklist: string expected":"shaderFilePrefix: string expected";var t},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.ClientOptionsProto)return e;var t=new u.keyhole.dbroot.ClientOptionsProto;if(void 0!==e.disableDiskCache&&null!==e.disableDiskCache&&(t.disableDiskCache=Boolean(e.disableDiskCache)),void 0!==e.disableEmbeddedBrowserVista&&null!==e.disableEmbeddedBrowserVista&&(t.disableEmbeddedBrowserVista=Boolean(e.disableEmbeddedBrowserVista)),void 0!==e.drawAtmosphere&&null!==e.drawAtmosphere&&(t.drawAtmosphere=Boolean(e.drawAtmosphere)),void 0!==e.drawStars&&null!==e.drawStars&&(t.drawStars=Boolean(e.drawStars)),void 0!==e.shaderFilePrefix&&null!==e.shaderFilePrefix&&(t.shaderFilePrefix=String(e.shaderFilePrefix)),void 0!==e.useProtobufQuadtreePackets&&null!==e.useProtobufQuadtreePackets&&(t.useProtobufQuadtreePackets=Boolean(e.useProtobufQuadtreePackets)),void 0!==e.useExtendedCopyrightIds&&null!==e.useExtendedCopyrightIds&&(t.useExtendedCopyrightIds=Boolean(e.useExtendedCopyrightIds)),void 0!==e.precipitationsOptions&&null!==e.precipitationsOptions){if("object"!=typeof e.precipitationsOptions)throw TypeError(".keyhole.dbroot.ClientOptionsProto.precipitationsOptions: object expected");t.precipitationsOptions=o[7].fromObject(e.precipitationsOptions)}if(void 0!==e.captureOptions&&null!==e.captureOptions){if("object"!=typeof e.captureOptions)throw TypeError(".keyhole.dbroot.ClientOptionsProto.captureOptions: object expected");t.captureOptions=o[8].fromObject(e.captureOptions)}if(void 0!==e.show_2dMapsIcon&&null!==e.show_2dMapsIcon&&(t.show_2dMapsIcon=Boolean(e.show_2dMapsIcon)),void 0!==e.disableInternalBrowser&&null!==e.disableInternalBrowser&&(t.disableInternalBrowser=Boolean(e.disableInternalBrowser)),void 0!==e.internalBrowserBlacklist&&null!==e.internalBrowserBlacklist&&(t.internalBrowserBlacklist=String(e.internalBrowserBlacklist)),void 0!==e.internalBrowserOriginWhitelist&&null!==e.internalBrowserOriginWhitelist&&(t.internalBrowserOriginWhitelist=String(e.internalBrowserOriginWhitelist)),void 0!==e.polarTileMergingLevel&&null!==e.polarTileMergingLevel&&(t.polarTileMergingLevel=0|e.polarTileMergingLevel),void 0!==e.jsBridgeRequestWhitelist&&null!==e.jsBridgeRequestWhitelist&&(t.jsBridgeRequestWhitelist=String(e.jsBridgeRequestWhitelist)),void 0!==e.mapsOptions&&null!==e.mapsOptions){if("object"!=typeof e.mapsOptions)throw TypeError(".keyhole.dbroot.ClientOptionsProto.mapsOptions: object expected");t.mapsOptions=o[15].fromObject(e.mapsOptions)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.disableDiskCache=!1,r.disableEmbeddedBrowserVista=!1,r.drawAtmosphere=!0,r.drawStars=!0,r.shaderFilePrefix="",r.useProtobufQuadtreePackets=!1,r.useExtendedCopyrightIds=!0,r.precipitationsOptions=null,r.captureOptions=null,r.show_2dMapsIcon=!0,r.disableInternalBrowser=!1,r.internalBrowserBlacklist="",r.internalBrowserOriginWhitelist="*",r.polarTileMergingLevel=0,r.jsBridgeRequestWhitelist="http://*.google.com/*",r.mapsOptions=null),void 0!==e.disableDiskCache&&null!==e.disableDiskCache&&e.hasOwnProperty("disableDiskCache")&&(r.disableDiskCache=e.disableDiskCache),void 0!==e.disableEmbeddedBrowserVista&&null!==e.disableEmbeddedBrowserVista&&e.hasOwnProperty("disableEmbeddedBrowserVista")&&(r.disableEmbeddedBrowserVista=e.disableEmbeddedBrowserVista),void 0!==e.drawAtmosphere&&null!==e.drawAtmosphere&&e.hasOwnProperty("drawAtmosphere")&&(r.drawAtmosphere=e.drawAtmosphere),void 0!==e.drawStars&&null!==e.drawStars&&e.hasOwnProperty("drawStars")&&(r.drawStars=e.drawStars),void 0!==e.shaderFilePrefix&&null!==e.shaderFilePrefix&&e.hasOwnProperty("shaderFilePrefix")&&(r.shaderFilePrefix=e.shaderFilePrefix),void 0!==e.useProtobufQuadtreePackets&&null!==e.useProtobufQuadtreePackets&&e.hasOwnProperty("useProtobufQuadtreePackets")&&(r.useProtobufQuadtreePackets=e.useProtobufQuadtreePackets),void 0!==e.useExtendedCopyrightIds&&null!==e.useExtendedCopyrightIds&&e.hasOwnProperty("useExtendedCopyrightIds")&&(r.useExtendedCopyrightIds=e.useExtendedCopyrightIds),void 0!==e.precipitationsOptions&&null!==e.precipitationsOptions&&e.hasOwnProperty("precipitationsOptions")&&(r.precipitationsOptions=o[7].toObject(e.precipitationsOptions,t)),void 0!==e.captureOptions&&null!==e.captureOptions&&e.hasOwnProperty("captureOptions")&&(r.captureOptions=o[8].toObject(e.captureOptions,t)),void 0!==e.show_2dMapsIcon&&null!==e.show_2dMapsIcon&&e.hasOwnProperty("show_2dMapsIcon")&&(r.show_2dMapsIcon=e.show_2dMapsIcon),void 0!==e.disableInternalBrowser&&null!==e.disableInternalBrowser&&e.hasOwnProperty("disableInternalBrowser")&&(r.disableInternalBrowser=e.disableInternalBrowser),void 0!==e.internalBrowserBlacklist&&null!==e.internalBrowserBlacklist&&e.hasOwnProperty("internalBrowserBlacklist")&&(r.internalBrowserBlacklist=e.internalBrowserBlacklist),void 0!==e.internalBrowserOriginWhitelist&&null!==e.internalBrowserOriginWhitelist&&e.hasOwnProperty("internalBrowserOriginWhitelist")&&(r.internalBrowserOriginWhitelist=e.internalBrowserOriginWhitelist),void 0!==e.polarTileMergingLevel&&null!==e.polarTileMergingLevel&&e.hasOwnProperty("polarTileMergingLevel")&&(r.polarTileMergingLevel=e.polarTileMergingLevel),void 0!==e.jsBridgeRequestWhitelist&&null!==e.jsBridgeRequestWhitelist&&e.hasOwnProperty("jsBridgeRequestWhitelist")&&(r.jsBridgeRequestWhitelist=e.jsBridgeRequestWhitelist),void 0!==e.mapsOptions&&null!==e.mapsOptions&&e.hasOwnProperty("mapsOptions")&&(r.mapsOptions=o[15].toObject(e.mapsOptions,t)),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.PrecipitationsOptions=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.imageUrl="",e.prototype.imageExpireTime=900,e.prototype.maxColorDistance=20,e.prototype.imageLevel=5,e.prototype.weatherMapping=s.emptyArray,e.prototype.cloudsLayerUrl="",e.prototype.animationDecelerationDelay=20;var o={4:"keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions.WeatherMapping"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.imageUrl=e.string();break;case 2:i.imageExpireTime=e.int32();break;case 3:i.maxColorDistance=e.int32();break;case 4:i.imageLevel=e.int32();break;case 5:i.weatherMapping&&i.weatherMapping.length||(i.weatherMapping=[]),i.weatherMapping.push(o[4].decode(e,e.uint32()));break;case 6:i.cloudsLayerUrl=e.string();break;case 7:i.animationDecelerationDelay=e.float();break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(void 0!==e.imageUrl&&!s.isString(e.imageUrl))return"imageUrl: string expected";if(void 0!==e.imageExpireTime&&!s.isInteger(e.imageExpireTime))return"imageExpireTime: integer expected";if(void 0!==e.maxColorDistance&&!s.isInteger(e.maxColorDistance))return"maxColorDistance: integer expected";if(void 0!==e.imageLevel&&!s.isInteger(e.imageLevel))return"imageLevel: integer expected";if(void 0!==e.weatherMapping){if(!Array.isArray(e.weatherMapping))return"weatherMapping: array expected";for(var t=0;t<e.weatherMapping.length;++t){var r=o[4].verify(e.weatherMapping[t]);if(r)return"weatherMapping."+r}}return void 0===e.cloudsLayerUrl||s.isString(e.cloudsLayerUrl)?void 0!==e.animationDecelerationDelay&&"number"!=typeof e.animationDecelerationDelay?"animationDecelerationDelay: number expected":null:"cloudsLayerUrl: string expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions)return e;var t=new u.keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions;if(void 0!==e.imageUrl&&null!==e.imageUrl&&(t.imageUrl=String(e.imageUrl)),void 0!==e.imageExpireTime&&null!==e.imageExpireTime&&(t.imageExpireTime=0|e.imageExpireTime),void 0!==e.maxColorDistance&&null!==e.maxColorDistance&&(t.maxColorDistance=0|e.maxColorDistance),void 0!==e.imageLevel&&null!==e.imageLevel&&(t.imageLevel=0|e.imageLevel),e.weatherMapping){if(!Array.isArray(e.weatherMapping))throw TypeError(".keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions.weatherMapping: array expected");t.weatherMapping=[];for(var r=0;r<e.weatherMapping.length;++r){if("object"!=typeof e.weatherMapping[r])throw TypeError(".keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions.weatherMapping: object expected");t.weatherMapping[r]=o[4].fromObject(e.weatherMapping[r])}}return void 0!==e.cloudsLayerUrl&&null!==e.cloudsLayerUrl&&(t.cloudsLayerUrl=String(e.cloudsLayerUrl)),void 0!==e.animationDecelerationDelay&&null!==e.animationDecelerationDelay&&(t.animationDecelerationDelay=Number(e.animationDecelerationDelay)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.weatherMapping=[]),t.defaults&&(r.imageUrl="",r.imageExpireTime=900,r.maxColorDistance=20,r.imageLevel=5,r.cloudsLayerUrl="",r.animationDecelerationDelay=20),void 0!==e.imageUrl&&null!==e.imageUrl&&e.hasOwnProperty("imageUrl")&&(r.imageUrl=e.imageUrl),void 0!==e.imageExpireTime&&null!==e.imageExpireTime&&e.hasOwnProperty("imageExpireTime")&&(r.imageExpireTime=e.imageExpireTime),void 0!==e.maxColorDistance&&null!==e.maxColorDistance&&e.hasOwnProperty("maxColorDistance")&&(r.maxColorDistance=e.maxColorDistance),void 0!==e.imageLevel&&null!==e.imageLevel&&e.hasOwnProperty("imageLevel")&&(r.imageLevel=e.imageLevel),void 0!==e.weatherMapping&&null!==e.weatherMapping&&e.hasOwnProperty("weatherMapping")){r.weatherMapping=[];for(var i=0;i<e.weatherMapping.length;++i)r.weatherMapping[i]=o[4].toObject(e.weatherMapping[i],t)}return void 0!==e.cloudsLayerUrl&&null!==e.cloudsLayerUrl&&e.hasOwnProperty("cloudsLayerUrl")&&(r.cloudsLayerUrl=e.cloudsLayerUrl),void 0!==e.animationDecelerationDelay&&null!==e.animationDecelerationDelay&&e.hasOwnProperty("animationDecelerationDelay")&&(r.animationDecelerationDelay=e.animationDecelerationDelay),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.WeatherMapping=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.colorAbgr=0,e.prototype.weatherType=0,e.prototype.elongation=1,e.prototype.opacity=0,e.prototype.fogDensity=0,e.prototype.speed0=0,e.prototype.speed1=0,e.prototype.speed2=0,e.prototype.speed3=0;var t,i={1:"keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions.WeatherMapping.WeatherType"};return l.push(i),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions.WeatherMapping;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.colorAbgr=e.uint32();break;case 2:i.weatherType=e.uint32();break;case 3:i.elongation=e.float();break;case 4:i.opacity=e.float();break;case 5:i.fogDensity=e.float();break;case 6:i.speed0=e.float();break;case 7:i.speed1=e.float();break;case 8:i.speed2=e.float();break;case 9:i.speed3=e.float();break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(!s.isInteger(e.colorAbgr))return"colorAbgr: integer expected";switch(e.weatherType){default:return"weatherType: enum value expected";case 0:case 1:case 2:}return void 0!==e.elongation&&"number"!=typeof e.elongation?"elongation: number expected":void 0!==e.opacity&&"number"!=typeof e.opacity?"opacity: number expected":void 0!==e.fogDensity&&"number"!=typeof e.fogDensity?"fogDensity: number expected":void 0!==e.speed0&&"number"!=typeof e.speed0?"speed0: number expected":void 0!==e.speed1&&"number"!=typeof e.speed1?"speed1: number expected":void 0!==e.speed2&&"number"!=typeof e.speed2?"speed2: number expected":void 0!==e.speed3&&"number"!=typeof e.speed3?"speed3: number expected":null},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions.WeatherMapping)return e;var t=new u.keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions.WeatherMapping;switch(void 0!==e.colorAbgr&&null!==e.colorAbgr&&(t.colorAbgr=e.colorAbgr>>>0),e.weatherType){case"NO_PRECIPITATION":case 0:t.weatherType=0;break;case"RAIN":case 1:t.weatherType=1;break;case"SNOW":case 2:t.weatherType=2}return void 0!==e.elongation&&null!==e.elongation&&(t.elongation=Number(e.elongation)),void 0!==e.opacity&&null!==e.opacity&&(t.opacity=Number(e.opacity)),void 0!==e.fogDensity&&null!==e.fogDensity&&(t.fogDensity=Number(e.fogDensity)),void 0!==e.speed0&&null!==e.speed0&&(t.speed0=Number(e.speed0)),void 0!==e.speed1&&null!==e.speed1&&(t.speed1=Number(e.speed1)),void 0!==e.speed2&&null!==e.speed2&&(t.speed2=Number(e.speed2)),void 0!==e.speed3&&null!==e.speed3&&(t.speed3=Number(e.speed3)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.colorAbgr=0,r.weatherType=t.enums===String?"NO_PRECIPITATION":0,r.elongation=1,r.opacity=0,r.fogDensity=0,r.speed0=0,r.speed1=0,r.speed2=0,r.speed3=0),void 0!==e.colorAbgr&&null!==e.colorAbgr&&e.hasOwnProperty("colorAbgr")&&(r.colorAbgr=e.colorAbgr),void 0!==e.weatherType&&null!==e.weatherType&&e.hasOwnProperty("weatherType")&&(r.weatherType=t.enums===String?i[1][e.weatherType]:e.weatherType),void 0!==e.elongation&&null!==e.elongation&&e.hasOwnProperty("elongation")&&(r.elongation=e.elongation),void 0!==e.opacity&&null!==e.opacity&&e.hasOwnProperty("opacity")&&(r.opacity=e.opacity),void 0!==e.fogDensity&&null!==e.fogDensity&&e.hasOwnProperty("fogDensity")&&(r.fogDensity=e.fogDensity),void 0!==e.speed0&&null!==e.speed0&&e.hasOwnProperty("speed0")&&(r.speed0=e.speed0),void 0!==e.speed1&&null!==e.speed1&&e.hasOwnProperty("speed1")&&(r.speed1=e.speed1),void 0!==e.speed2&&null!==e.speed2&&e.hasOwnProperty("speed2")&&(r.speed2=e.speed2),void 0!==e.speed3&&null!==e.speed3&&e.hasOwnProperty("speed3")&&(r.speed3=e.speed3),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.WeatherType=((t=Object.create({})).NO_PRECIPITATION=0,t.RAIN=1,t.SNOW=2,t),e}(),e}(),e.CaptureOptions=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}return e.prototype.allowSaveAsImage=!0,e.prototype.maxFreeCaptureRes=2400,e.prototype.maxPremiumCaptureRes=4800,e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.ClientOptionsProto.CaptureOptions;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.allowSaveAsImage=e.bool();break;case 2:i.maxFreeCaptureRes=e.int32();break;case 3:i.maxPremiumCaptureRes=e.int32();break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":void 0!==e.allowSaveAsImage&&"boolean"!=typeof e.allowSaveAsImage?"allowSaveAsImage: boolean expected":void 0===e.maxFreeCaptureRes||s.isInteger(e.maxFreeCaptureRes)?void 0===e.maxPremiumCaptureRes||s.isInteger(e.maxPremiumCaptureRes)?null:"maxPremiumCaptureRes: integer expected":"maxFreeCaptureRes: integer expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.ClientOptionsProto.CaptureOptions)return e;var t=new u.keyhole.dbroot.ClientOptionsProto.CaptureOptions;return void 0!==e.allowSaveAsImage&&null!==e.allowSaveAsImage&&(t.allowSaveAsImage=Boolean(e.allowSaveAsImage)),void 0!==e.maxFreeCaptureRes&&null!==e.maxFreeCaptureRes&&(t.maxFreeCaptureRes=0|e.maxFreeCaptureRes),void 0!==e.maxPremiumCaptureRes&&null!==e.maxPremiumCaptureRes&&(t.maxPremiumCaptureRes=0|e.maxPremiumCaptureRes),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.allowSaveAsImage=!0,r.maxFreeCaptureRes=2400,r.maxPremiumCaptureRes=4800),void 0!==e.allowSaveAsImage&&null!==e.allowSaveAsImage&&e.hasOwnProperty("allowSaveAsImage")&&(r.allowSaveAsImage=e.allowSaveAsImage),void 0!==e.maxFreeCaptureRes&&null!==e.maxFreeCaptureRes&&e.hasOwnProperty("maxFreeCaptureRes")&&(r.maxFreeCaptureRes=e.maxFreeCaptureRes),void 0!==e.maxPremiumCaptureRes&&null!==e.maxPremiumCaptureRes&&e.hasOwnProperty("maxPremiumCaptureRes")&&(r.maxPremiumCaptureRes=e.maxPremiumCaptureRes),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.MapsOptions=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}return e.prototype.enableMaps=!1,e.prototype.docsAutoDownloadEnabled=!1,e.prototype.docsAutoDownloadInterval=0,e.prototype.docsAutoUploadEnabled=!1,e.prototype.docsAutoUploadDelay=0,e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.ClientOptionsProto.MapsOptions;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.enableMaps=e.bool();break;case 2:i.docsAutoDownloadEnabled=e.bool();break;case 3:i.docsAutoDownloadInterval=e.int32();break;case 4:i.docsAutoUploadEnabled=e.bool();break;case 5:i.docsAutoUploadDelay=e.int32();break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":void 0!==e.enableMaps&&"boolean"!=typeof e.enableMaps?"enableMaps: boolean expected":void 0!==e.docsAutoDownloadEnabled&&"boolean"!=typeof e.docsAutoDownloadEnabled?"docsAutoDownloadEnabled: boolean expected":void 0===e.docsAutoDownloadInterval||s.isInteger(e.docsAutoDownloadInterval)?void 0!==e.docsAutoUploadEnabled&&"boolean"!=typeof e.docsAutoUploadEnabled?"docsAutoUploadEnabled: boolean expected":void 0===e.docsAutoUploadDelay||s.isInteger(e.docsAutoUploadDelay)?null:"docsAutoUploadDelay: integer expected":"docsAutoDownloadInterval: integer expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.ClientOptionsProto.MapsOptions)return e;var t=new u.keyhole.dbroot.ClientOptionsProto.MapsOptions;return void 0!==e.enableMaps&&null!==e.enableMaps&&(t.enableMaps=Boolean(e.enableMaps)),void 0!==e.docsAutoDownloadEnabled&&null!==e.docsAutoDownloadEnabled&&(t.docsAutoDownloadEnabled=Boolean(e.docsAutoDownloadEnabled)),void 0!==e.docsAutoDownloadInterval&&null!==e.docsAutoDownloadInterval&&(t.docsAutoDownloadInterval=0|e.docsAutoDownloadInterval),void 0!==e.docsAutoUploadEnabled&&null!==e.docsAutoUploadEnabled&&(t.docsAutoUploadEnabled=Boolean(e.docsAutoUploadEnabled)),void 0!==e.docsAutoUploadDelay&&null!==e.docsAutoUploadDelay&&(t.docsAutoUploadDelay=0|e.docsAutoUploadDelay),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.enableMaps=!1,r.docsAutoDownloadEnabled=!1,r.docsAutoDownloadInterval=0,r.docsAutoUploadEnabled=!1,r.docsAutoUploadDelay=0),void 0!==e.enableMaps&&null!==e.enableMaps&&e.hasOwnProperty("enableMaps")&&(r.enableMaps=e.enableMaps),void 0!==e.docsAutoDownloadEnabled&&null!==e.docsAutoDownloadEnabled&&e.hasOwnProperty("docsAutoDownloadEnabled")&&(r.docsAutoDownloadEnabled=e.docsAutoDownloadEnabled),void 0!==e.docsAutoDownloadInterval&&null!==e.docsAutoDownloadInterval&&e.hasOwnProperty("docsAutoDownloadInterval")&&(r.docsAutoDownloadInterval=e.docsAutoDownloadInterval),void 0!==e.docsAutoUploadEnabled&&null!==e.docsAutoUploadEnabled&&e.hasOwnProperty("docsAutoUploadEnabled")&&(r.docsAutoUploadEnabled=e.docsAutoUploadEnabled),void 0!==e.docsAutoUploadDelay&&null!==e.docsAutoUploadDelay&&e.hasOwnProperty("docsAutoUploadDelay")&&(r.docsAutoUploadDelay=e.docsAutoUploadDelay),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e}(),e.FetchingOptionsProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}return e.prototype.maxRequestsPerQuery=1,e.prototype.forceMaxRequestsPerQuery=!1,e.prototype.sortBatches=!1,e.prototype.maxDrawable=2,e.prototype.maxImagery=2,e.prototype.maxTerrain=5,e.prototype.maxQuadtree=5,e.prototype.maxDioramaMetadata=1,e.prototype.maxDioramaData=0,e.prototype.maxConsumerFetchRatio=1,e.prototype.maxProEcFetchRatio=0,e.prototype.safeOverallQps=0,e.prototype.safeImageryQps=0,e.prototype.domainsForHttps="google.com gstatic.com",e.prototype.hostsForHttp="",e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.FetchingOptionsProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.maxRequestsPerQuery=e.int32();break;case 12:i.forceMaxRequestsPerQuery=e.bool();break;case 13:i.sortBatches=e.bool();break;case 2:i.maxDrawable=e.int32();break;case 3:i.maxImagery=e.int32();break;case 4:i.maxTerrain=e.int32();break;case 5:i.maxQuadtree=e.int32();break;case 6:i.maxDioramaMetadata=e.int32();break;case 7:i.maxDioramaData=e.int32();break;case 8:i.maxConsumerFetchRatio=e.float();break;case 9:i.maxProEcFetchRatio=e.float();break;case 10:i.safeOverallQps=e.float();break;case 11:i.safeImageryQps=e.float();break;case 14:i.domainsForHttps=e.string();break;case 15:i.hostsForHttp=e.string();break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":void 0===e.maxRequestsPerQuery||s.isInteger(e.maxRequestsPerQuery)?void 0!==e.forceMaxRequestsPerQuery&&"boolean"!=typeof e.forceMaxRequestsPerQuery?"forceMaxRequestsPerQuery: boolean expected":void 0!==e.sortBatches&&"boolean"!=typeof e.sortBatches?"sortBatches: boolean expected":void 0===e.maxDrawable||s.isInteger(e.maxDrawable)?void 0===e.maxImagery||s.isInteger(e.maxImagery)?void 0===e.maxTerrain||s.isInteger(e.maxTerrain)?void 0===e.maxQuadtree||s.isInteger(e.maxQuadtree)?void 0===e.maxDioramaMetadata||s.isInteger(e.maxDioramaMetadata)?void 0===e.maxDioramaData||s.isInteger(e.maxDioramaData)?void 0!==e.maxConsumerFetchRatio&&"number"!=typeof e.maxConsumerFetchRatio?"maxConsumerFetchRatio: number expected":void 0!==e.maxProEcFetchRatio&&"number"!=typeof e.maxProEcFetchRatio?"maxProEcFetchRatio: number expected":void 0!==e.safeOverallQps&&"number"!=typeof e.safeOverallQps?"safeOverallQps: number expected":void 0!==e.safeImageryQps&&"number"!=typeof e.safeImageryQps?"safeImageryQps: number expected":void 0===e.domainsForHttps||s.isString(e.domainsForHttps)?void 0===e.hostsForHttp||s.isString(e.hostsForHttp)?null:"hostsForHttp: string expected":"domainsForHttps: string expected":"maxDioramaData: integer expected":"maxDioramaMetadata: integer expected":"maxQuadtree: integer expected":"maxTerrain: integer expected":"maxImagery: integer expected":"maxDrawable: integer expected":"maxRequestsPerQuery: integer expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.FetchingOptionsProto)return e;var t=new u.keyhole.dbroot.FetchingOptionsProto;return void 0!==e.maxRequestsPerQuery&&null!==e.maxRequestsPerQuery&&(t.maxRequestsPerQuery=0|e.maxRequestsPerQuery),void 0!==e.forceMaxRequestsPerQuery&&null!==e.forceMaxRequestsPerQuery&&(t.forceMaxRequestsPerQuery=Boolean(e.forceMaxRequestsPerQuery)),void 0!==e.sortBatches&&null!==e.sortBatches&&(t.sortBatches=Boolean(e.sortBatches)),void 0!==e.maxDrawable&&null!==e.maxDrawable&&(t.maxDrawable=0|e.maxDrawable),void 0!==e.maxImagery&&null!==e.maxImagery&&(t.maxImagery=0|e.maxImagery),void 0!==e.maxTerrain&&null!==e.maxTerrain&&(t.maxTerrain=0|e.maxTerrain),void 0!==e.maxQuadtree&&null!==e.maxQuadtree&&(t.maxQuadtree=0|e.maxQuadtree),void 0!==e.maxDioramaMetadata&&null!==e.maxDioramaMetadata&&(t.maxDioramaMetadata=0|e.maxDioramaMetadata),void 0!==e.maxDioramaData&&null!==e.maxDioramaData&&(t.maxDioramaData=0|e.maxDioramaData),void 0!==e.maxConsumerFetchRatio&&null!==e.maxConsumerFetchRatio&&(t.maxConsumerFetchRatio=Number(e.maxConsumerFetchRatio)),void 0!==e.maxProEcFetchRatio&&null!==e.maxProEcFetchRatio&&(t.maxProEcFetchRatio=Number(e.maxProEcFetchRatio)),void 0!==e.safeOverallQps&&null!==e.safeOverallQps&&(t.safeOverallQps=Number(e.safeOverallQps)),void 0!==e.safeImageryQps&&null!==e.safeImageryQps&&(t.safeImageryQps=Number(e.safeImageryQps)),void 0!==e.domainsForHttps&&null!==e.domainsForHttps&&(t.domainsForHttps=String(e.domainsForHttps)),void 0!==e.hostsForHttp&&null!==e.hostsForHttp&&(t.hostsForHttp=String(e.hostsForHttp)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.maxRequestsPerQuery=1,r.forceMaxRequestsPerQuery=!1,r.sortBatches=!1,r.maxDrawable=2,r.maxImagery=2,r.maxTerrain=5,r.maxQuadtree=5,r.maxDioramaMetadata=1,r.maxDioramaData=0,r.maxConsumerFetchRatio=1,r.maxProEcFetchRatio=0,r.safeOverallQps=0,r.safeImageryQps=0,r.domainsForHttps="google.com gstatic.com",r.hostsForHttp=""),void 0!==e.maxRequestsPerQuery&&null!==e.maxRequestsPerQuery&&e.hasOwnProperty("maxRequestsPerQuery")&&(r.maxRequestsPerQuery=e.maxRequestsPerQuery),void 0!==e.forceMaxRequestsPerQuery&&null!==e.forceMaxRequestsPerQuery&&e.hasOwnProperty("forceMaxRequestsPerQuery")&&(r.forceMaxRequestsPerQuery=e.forceMaxRequestsPerQuery),void 0!==e.sortBatches&&null!==e.sortBatches&&e.hasOwnProperty("sortBatches")&&(r.sortBatches=e.sortBatches),void 0!==e.maxDrawable&&null!==e.maxDrawable&&e.hasOwnProperty("maxDrawable")&&(r.maxDrawable=e.maxDrawable),void 0!==e.maxImagery&&null!==e.maxImagery&&e.hasOwnProperty("maxImagery")&&(r.maxImagery=e.maxImagery),void 0!==e.maxTerrain&&null!==e.maxTerrain&&e.hasOwnProperty("maxTerrain")&&(r.maxTerrain=e.maxTerrain),void 0!==e.maxQuadtree&&null!==e.maxQuadtree&&e.hasOwnProperty("maxQuadtree")&&(r.maxQuadtree=e.maxQuadtree),void 0!==e.maxDioramaMetadata&&null!==e.maxDioramaMetadata&&e.hasOwnProperty("maxDioramaMetadata")&&(r.maxDioramaMetadata=e.maxDioramaMetadata),void 0!==e.maxDioramaData&&null!==e.maxDioramaData&&e.hasOwnProperty("maxDioramaData")&&(r.maxDioramaData=e.maxDioramaData),void 0!==e.maxConsumerFetchRatio&&null!==e.maxConsumerFetchRatio&&e.hasOwnProperty("maxConsumerFetchRatio")&&(r.maxConsumerFetchRatio=e.maxConsumerFetchRatio),void 0!==e.maxProEcFetchRatio&&null!==e.maxProEcFetchRatio&&e.hasOwnProperty("maxProEcFetchRatio")&&(r.maxProEcFetchRatio=e.maxProEcFetchRatio),void 0!==e.safeOverallQps&&null!==e.safeOverallQps&&e.hasOwnProperty("safeOverallQps")&&(r.safeOverallQps=e.safeOverallQps),void 0!==e.safeImageryQps&&null!==e.safeImageryQps&&e.hasOwnProperty("safeImageryQps")&&(r.safeImageryQps=e.safeImageryQps),void 0!==e.domainsForHttps&&null!==e.domainsForHttps&&e.hasOwnProperty("domainsForHttps")&&(r.domainsForHttps=e.domainsForHttps),void 0!==e.hostsForHttp&&null!==e.hostsForHttp&&e.hasOwnProperty("hostsForHttp")&&(r.hostsForHttp=e.hostsForHttp),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.TimeMachineOptionsProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}return e.prototype.serverUrl="",e.prototype.isTimemachine=!1,e.prototype.dwellTimeMs=500,e.prototype.discoverabilityAltitudeMeters=15e3,e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.TimeMachineOptionsProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.serverUrl=e.string();break;case 2:i.isTimemachine=e.bool();break;case 3:i.dwellTimeMs=e.int32();break;case 4:i.discoverabilityAltitudeMeters=e.int32();break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":void 0===e.serverUrl||s.isString(e.serverUrl)?void 0!==e.isTimemachine&&"boolean"!=typeof e.isTimemachine?"isTimemachine: boolean expected":void 0===e.dwellTimeMs||s.isInteger(e.dwellTimeMs)?void 0===e.discoverabilityAltitudeMeters||s.isInteger(e.discoverabilityAltitudeMeters)?null:"discoverabilityAltitudeMeters: integer expected":"dwellTimeMs: integer expected":"serverUrl: string expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.TimeMachineOptionsProto)return e;var t=new u.keyhole.dbroot.TimeMachineOptionsProto;return void 0!==e.serverUrl&&null!==e.serverUrl&&(t.serverUrl=String(e.serverUrl)),void 0!==e.isTimemachine&&null!==e.isTimemachine&&(t.isTimemachine=Boolean(e.isTimemachine)),void 0!==e.dwellTimeMs&&null!==e.dwellTimeMs&&(t.dwellTimeMs=0|e.dwellTimeMs),void 0!==e.discoverabilityAltitudeMeters&&null!==e.discoverabilityAltitudeMeters&&(t.discoverabilityAltitudeMeters=0|e.discoverabilityAltitudeMeters),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.serverUrl="",r.isTimemachine=!1,r.dwellTimeMs=500,r.discoverabilityAltitudeMeters=15e3),void 0!==e.serverUrl&&null!==e.serverUrl&&e.hasOwnProperty("serverUrl")&&(r.serverUrl=e.serverUrl),void 0!==e.isTimemachine&&null!==e.isTimemachine&&e.hasOwnProperty("isTimemachine")&&(r.isTimemachine=e.isTimemachine),void 0!==e.dwellTimeMs&&null!==e.dwellTimeMs&&e.hasOwnProperty("dwellTimeMs")&&(r.dwellTimeMs=e.dwellTimeMs),void 0!==e.discoverabilityAltitudeMeters&&null!==e.discoverabilityAltitudeMeters&&e.hasOwnProperty("discoverabilityAltitudeMeters")&&(r.discoverabilityAltitudeMeters=e.discoverabilityAltitudeMeters),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.AutopiaOptionsProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}return e.prototype.metadataServerUrl="http://cbk0.google.com/cbk",e.prototype.depthmapServerUrl="http://cbk0.google.com/cbk",e.prototype.coverageOverlayUrl="",e.prototype.maxImageryQps=0,e.prototype.maxMetadataDepthmapQps=0,e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.AutopiaOptionsProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.metadataServerUrl=e.string();break;case 2:i.depthmapServerUrl=e.string();break;case 3:i.coverageOverlayUrl=e.string();break;case 4:i.maxImageryQps=e.float();break;case 5:i.maxMetadataDepthmapQps=e.float();break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":void 0===e.metadataServerUrl||s.isString(e.metadataServerUrl)?void 0===e.depthmapServerUrl||s.isString(e.depthmapServerUrl)?void 0===e.coverageOverlayUrl||s.isString(e.coverageOverlayUrl)?void 0!==e.maxImageryQps&&"number"!=typeof e.maxImageryQps?"maxImageryQps: number expected":void 0!==e.maxMetadataDepthmapQps&&"number"!=typeof e.maxMetadataDepthmapQps?"maxMetadataDepthmapQps: number expected":null:"coverageOverlayUrl: string expected":"depthmapServerUrl: string expected":"metadataServerUrl: string expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.AutopiaOptionsProto)return e;var t=new u.keyhole.dbroot.AutopiaOptionsProto;return void 0!==e.metadataServerUrl&&null!==e.metadataServerUrl&&(t.metadataServerUrl=String(e.metadataServerUrl)),void 0!==e.depthmapServerUrl&&null!==e.depthmapServerUrl&&(t.depthmapServerUrl=String(e.depthmapServerUrl)),void 0!==e.coverageOverlayUrl&&null!==e.coverageOverlayUrl&&(t.coverageOverlayUrl=String(e.coverageOverlayUrl)),void 0!==e.maxImageryQps&&null!==e.maxImageryQps&&(t.maxImageryQps=Number(e.maxImageryQps)),void 0!==e.maxMetadataDepthmapQps&&null!==e.maxMetadataDepthmapQps&&(t.maxMetadataDepthmapQps=Number(e.maxMetadataDepthmapQps)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.metadataServerUrl="http://cbk0.google.com/cbk",r.depthmapServerUrl="http://cbk0.google.com/cbk",r.coverageOverlayUrl="",r.maxImageryQps=0,r.maxMetadataDepthmapQps=0),void 0!==e.metadataServerUrl&&null!==e.metadataServerUrl&&e.hasOwnProperty("metadataServerUrl")&&(r.metadataServerUrl=e.metadataServerUrl),void 0!==e.depthmapServerUrl&&null!==e.depthmapServerUrl&&e.hasOwnProperty("depthmapServerUrl")&&(r.depthmapServerUrl=e.depthmapServerUrl),void 0!==e.coverageOverlayUrl&&null!==e.coverageOverlayUrl&&e.hasOwnProperty("coverageOverlayUrl")&&(r.coverageOverlayUrl=e.coverageOverlayUrl),void 0!==e.maxImageryQps&&null!==e.maxImageryQps&&e.hasOwnProperty("maxImageryQps")&&(r.maxImageryQps=e.maxImageryQps),void 0!==e.maxMetadataDepthmapQps&&null!==e.maxMetadataDepthmapQps&&e.hasOwnProperty("maxMetadataDepthmapQps")&&(r.maxMetadataDepthmapQps=e.maxMetadataDepthmapQps),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.CSIOptionsProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}return e.prototype.samplingPercentage=0,e.prototype.experimentId="",e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.CSIOptionsProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.samplingPercentage=e.int32();break;case 2:i.experimentId=e.string();break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":void 0===e.samplingPercentage||s.isInteger(e.samplingPercentage)?void 0===e.experimentId||s.isString(e.experimentId)?null:"experimentId: string expected":"samplingPercentage: integer expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.CSIOptionsProto)return e;var t=new u.keyhole.dbroot.CSIOptionsProto;return void 0!==e.samplingPercentage&&null!==e.samplingPercentage&&(t.samplingPercentage=0|e.samplingPercentage),void 0!==e.experimentId&&null!==e.experimentId&&(t.experimentId=String(e.experimentId)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.samplingPercentage=0,r.experimentId=""),void 0!==e.samplingPercentage&&null!==e.samplingPercentage&&e.hasOwnProperty("samplingPercentage")&&(r.samplingPercentage=e.samplingPercentage),void 0!==e.experimentId&&null!==e.experimentId&&e.hasOwnProperty("experimentId")&&(r.experimentId=e.experimentId),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.SearchTabProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.isVisible=!1,e.prototype.tabLabel=null,e.prototype.baseUrl="",e.prototype.viewportPrefix="",e.prototype.inputBox=s.emptyArray,e.prototype.requirement=null;var o={1:"keyhole.dbroot.StringIdOrValueProto",4:"keyhole.dbroot.SearchTabProto.InputBoxInfo",5:"keyhole.dbroot.RequirementProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.SearchTabProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.isVisible=e.bool();break;case 2:i.tabLabel=o[1].decode(e,e.uint32());break;case 3:i.baseUrl=e.string();break;case 4:i.viewportPrefix=e.string();break;case 5:i.inputBox&&i.inputBox.length||(i.inputBox=[]),i.inputBox.push(o[4].decode(e,e.uint32()));break;case 6:i.requirement=o[5].decode(e,e.uint32());break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if("boolean"!=typeof e.isVisible)return"isVisible: boolean expected";if(void 0!==e.tabLabel&&null!==e.tabLabel&&(r=o[1].verify(e.tabLabel)))return"tabLabel."+r;if(void 0!==e.baseUrl&&!s.isString(e.baseUrl))return"baseUrl: string expected";if(void 0!==e.viewportPrefix&&!s.isString(e.viewportPrefix))return"viewportPrefix: string expected";if(void 0!==e.inputBox){if(!Array.isArray(e.inputBox))return"inputBox: array expected";for(var t=0;t<e.inputBox.length;++t){var r;if(r=o[4].verify(e.inputBox[t]))return"inputBox."+r}}return void 0!==e.requirement&&null!==e.requirement&&(r=o[5].verify(e.requirement))?"requirement."+r:null},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.SearchTabProto)return e;var t=new u.keyhole.dbroot.SearchTabProto;if(void 0!==e.isVisible&&null!==e.isVisible&&(t.isVisible=Boolean(e.isVisible)),void 0!==e.tabLabel&&null!==e.tabLabel){if("object"!=typeof e.tabLabel)throw TypeError(".keyhole.dbroot.SearchTabProto.tabLabel: object expected");t.tabLabel=o[1].fromObject(e.tabLabel)}if(void 0!==e.baseUrl&&null!==e.baseUrl&&(t.baseUrl=String(e.baseUrl)),void 0!==e.viewportPrefix&&null!==e.viewportPrefix&&(t.viewportPrefix=String(e.viewportPrefix)),e.inputBox){if(!Array.isArray(e.inputBox))throw TypeError(".keyhole.dbroot.SearchTabProto.inputBox: array expected");t.inputBox=[];for(var r=0;r<e.inputBox.length;++r){if("object"!=typeof e.inputBox[r])throw TypeError(".keyhole.dbroot.SearchTabProto.inputBox: object expected");t.inputBox[r]=o[4].fromObject(e.inputBox[r])}}if(void 0!==e.requirement&&null!==e.requirement){if("object"!=typeof e.requirement)throw TypeError(".keyhole.dbroot.SearchTabProto.requirement: object expected");t.requirement=o[5].fromObject(e.requirement)}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.inputBox=[]),t.defaults&&(r.isVisible=!1,r.tabLabel=null,r.baseUrl="",r.viewportPrefix="",r.requirement=null),void 0!==e.isVisible&&null!==e.isVisible&&e.hasOwnProperty("isVisible")&&(r.isVisible=e.isVisible),void 0!==e.tabLabel&&null!==e.tabLabel&&e.hasOwnProperty("tabLabel")&&(r.tabLabel=o[1].toObject(e.tabLabel,t)),void 0!==e.baseUrl&&null!==e.baseUrl&&e.hasOwnProperty("baseUrl")&&(r.baseUrl=e.baseUrl),void 0!==e.viewportPrefix&&null!==e.viewportPrefix&&e.hasOwnProperty("viewportPrefix")&&(r.viewportPrefix=e.viewportPrefix),void 0!==e.inputBox&&null!==e.inputBox&&e.hasOwnProperty("inputBox")){r.inputBox=[];for(var i=0;i<e.inputBox.length;++i)r.inputBox[i]=o[4].toObject(e.inputBox[i],t)}return void 0!==e.requirement&&null!==e.requirement&&e.hasOwnProperty("requirement")&&(r.requirement=o[5].toObject(e.requirement,t)),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.InputBoxInfo=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.label=null,e.prototype.queryVerb="",e.prototype.queryPrepend="";var o={0:"keyhole.dbroot.StringIdOrValueProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.SearchTabProto.InputBoxInfo;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.label=o[0].decode(e,e.uint32());break;case 2:i.queryVerb=e.string();break;case 3:i.queryPrepend=e.string();break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";var t=o[0].verify(e.label);return t?"label."+t:s.isString(e.queryVerb)?void 0===e.queryPrepend||s.isString(e.queryPrepend)?null:"queryPrepend: string expected":"queryVerb: string expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.SearchTabProto.InputBoxInfo)return e;var t=new u.keyhole.dbroot.SearchTabProto.InputBoxInfo;if(void 0!==e.label&&null!==e.label){if("object"!=typeof e.label)throw TypeError(".keyhole.dbroot.SearchTabProto.InputBoxInfo.label: object expected");t.label=o[0].fromObject(e.label)}return void 0!==e.queryVerb&&null!==e.queryVerb&&(t.queryVerb=String(e.queryVerb)),void 0!==e.queryPrepend&&null!==e.queryPrepend&&(t.queryPrepend=String(e.queryPrepend)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.label=null,r.queryVerb="",r.queryPrepend=""),void 0!==e.label&&null!==e.label&&e.hasOwnProperty("label")&&(r.label=o[0].toObject(e.label,t)),void 0!==e.queryVerb&&null!==e.queryVerb&&e.hasOwnProperty("queryVerb")&&(r.queryVerb=e.queryVerb),void 0!==e.queryPrepend&&null!==e.queryPrepend&&e.hasOwnProperty("queryPrepend")&&(r.queryPrepend=e.queryPrepend),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e}(),e.CobrandProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.logoUrl="",e.prototype.xCoord=null,e.prototype.yCoord=null,e.prototype.tiePoint=6,e.prototype.screenSize=0;var t,o={1:"keyhole.dbroot.CobrandProto.Coord",2:"keyhole.dbroot.CobrandProto.Coord",3:"keyhole.dbroot.CobrandProto.TiePoint"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.CobrandProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.logoUrl=e.string();break;case 2:i.xCoord=o[1].decode(e,e.uint32());break;case 3:i.yCoord=o[2].decode(e,e.uint32());break;case 4:i.tiePoint=e.uint32();break;case 5:i.screenSize=e.double();break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(!s.isString(e.logoUrl))return"logoUrl: string expected";var t;if(void 0!==e.xCoord&&null!==e.xCoord&&(t=o[1].verify(e.xCoord)))return"xCoord."+t;if(void 0!==e.yCoord&&null!==e.yCoord&&(t=o[2].verify(e.yCoord)))return"yCoord."+t;if(void 0!==e.tiePoint)switch(e.tiePoint){default:return"tiePoint: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:}return void 0!==e.screenSize&&"number"!=typeof e.screenSize?"screenSize: number expected":null},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.CobrandProto)return e;var t=new u.keyhole.dbroot.CobrandProto;if(void 0!==e.logoUrl&&null!==e.logoUrl&&(t.logoUrl=String(e.logoUrl)),void 0!==e.xCoord&&null!==e.xCoord){if("object"!=typeof e.xCoord)throw TypeError(".keyhole.dbroot.CobrandProto.xCoord: object expected");t.xCoord=o[1].fromObject(e.xCoord)}if(void 0!==e.yCoord&&null!==e.yCoord){if("object"!=typeof e.yCoord)throw TypeError(".keyhole.dbroot.CobrandProto.yCoord: object expected");t.yCoord=o[2].fromObject(e.yCoord)}switch(e.tiePoint){case"TOP_LEFT":case 0:t.tiePoint=0;break;case"TOP_CENTER":case 1:t.tiePoint=1;break;case"TOP_RIGHT":case 2:t.tiePoint=2;break;case"MID_LEFT":case 3:t.tiePoint=3;break;case"MID_CENTER":case 4:t.tiePoint=4;break;case"MID_RIGHT":case 5:t.tiePoint=5;break;case"BOTTOM_LEFT":case 6:t.tiePoint=6;break;case"BOTTOM_CENTER":case 7:t.tiePoint=7;break;case"BOTTOM_RIGHT":case 8:t.tiePoint=8}return void 0!==e.screenSize&&null!==e.screenSize&&(t.screenSize=Number(e.screenSize)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.logoUrl="",r.xCoord=null,r.yCoord=null,r.tiePoint=t.enums===String?"BOTTOM_LEFT":6,r.screenSize=0),void 0!==e.logoUrl&&null!==e.logoUrl&&e.hasOwnProperty("logoUrl")&&(r.logoUrl=e.logoUrl),void 0!==e.xCoord&&null!==e.xCoord&&e.hasOwnProperty("xCoord")&&(r.xCoord=o[1].toObject(e.xCoord,t)),void 0!==e.yCoord&&null!==e.yCoord&&e.hasOwnProperty("yCoord")&&(r.yCoord=o[2].toObject(e.yCoord,t)),void 0!==e.tiePoint&&null!==e.tiePoint&&e.hasOwnProperty("tiePoint")&&(r.tiePoint=t.enums===String?o[3][e.tiePoint]:e.tiePoint),void 0!==e.screenSize&&null!==e.screenSize&&e.hasOwnProperty("screenSize")&&(r.screenSize=e.screenSize),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.Coord=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}return e.prototype.value=0,e.prototype.isRelative=!1,e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.CobrandProto.Coord;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.value=e.double();break;case 2:i.isRelative=e.bool();break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":"number"!=typeof e.value?"value: number expected":void 0!==e.isRelative&&"boolean"!=typeof e.isRelative?"isRelative: boolean expected":null},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.CobrandProto.Coord)return e;var t=new u.keyhole.dbroot.CobrandProto.Coord;return void 0!==e.value&&null!==e.value&&(t.value=Number(e.value)),void 0!==e.isRelative&&null!==e.isRelative&&(t.isRelative=Boolean(e.isRelative)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.value=0,r.isRelative=!1),void 0!==e.value&&null!==e.value&&e.hasOwnProperty("value")&&(r.value=e.value),void 0!==e.isRelative&&null!==e.isRelative&&e.hasOwnProperty("isRelative")&&(r.isRelative=e.isRelative),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.TiePoint=((t=Object.create({})).TOP_LEFT=0,t.TOP_CENTER=1,t.TOP_RIGHT=2,t.MID_LEFT=3,t.MID_CENTER=4,t.MID_RIGHT=5,t.BOTTOM_LEFT=6,t.BOTTOM_CENTER=7,t.BOTTOM_RIGHT=8,t),e}(),e.DatabaseDescriptionProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.databaseName=null,e.prototype.databaseUrl="";var o={0:"keyhole.dbroot.StringIdOrValueProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.DatabaseDescriptionProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.databaseName=o[0].decode(e,e.uint32());break;case 2:i.databaseUrl=e.string();break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(void 0!==e.databaseName&&null!==e.databaseName){var t=o[0].verify(e.databaseName);if(t)return"databaseName."+t}return s.isString(e.databaseUrl)?null:"databaseUrl: string expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.DatabaseDescriptionProto)return e;var t=new u.keyhole.dbroot.DatabaseDescriptionProto;if(void 0!==e.databaseName&&null!==e.databaseName){if("object"!=typeof e.databaseName)throw TypeError(".keyhole.dbroot.DatabaseDescriptionProto.databaseName: object expected");t.databaseName=o[0].fromObject(e.databaseName)}return void 0!==e.databaseUrl&&null!==e.databaseUrl&&(t.databaseUrl=String(e.databaseUrl)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.databaseName=null,r.databaseUrl=""),void 0!==e.databaseName&&null!==e.databaseName&&e.hasOwnProperty("databaseName")&&(r.databaseName=o[0].toObject(e.databaseName,t)),void 0!==e.databaseUrl&&null!==e.databaseUrl&&e.hasOwnProperty("databaseUrl")&&(r.databaseUrl=e.databaseUrl),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.ConfigScriptProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}return e.prototype.scriptName="",e.prototype.scriptData="",e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.ConfigScriptProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.scriptName=e.string();break;case 2:i.scriptData=e.string();break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":s.isString(e.scriptName)?s.isString(e.scriptData)?null:"scriptData: string expected":"scriptName: string expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.ConfigScriptProto)return e;var t=new u.keyhole.dbroot.ConfigScriptProto;return void 0!==e.scriptName&&null!==e.scriptName&&(t.scriptName=String(e.scriptName)),void 0!==e.scriptData&&null!==e.scriptData&&(t.scriptData=String(e.scriptData)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.scriptName="",r.scriptData=""),void 0!==e.scriptName&&null!==e.scriptName&&e.hasOwnProperty("scriptName")&&(r.scriptName=e.scriptName),void 0!==e.scriptData&&null!==e.scriptData&&e.hasOwnProperty("scriptData")&&(r.scriptData=e.scriptData),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.SwoopParamsProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}return e.prototype.startDistInMeters=0,e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.SwoopParamsProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.startDistInMeters=e.double();break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":void 0!==e.startDistInMeters&&"number"!=typeof e.startDistInMeters?"startDistInMeters: number expected":null},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.SwoopParamsProto)return e;var t=new u.keyhole.dbroot.SwoopParamsProto;return void 0!==e.startDistInMeters&&null!==e.startDistInMeters&&(t.startDistInMeters=Number(e.startDistInMeters)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.startDistInMeters=0),void 0!==e.startDistInMeters&&null!==e.startDistInMeters&&e.hasOwnProperty("startDistInMeters")&&(r.startDistInMeters=e.startDistInMeters),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.PostingServerProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.name=null,e.prototype.baseUrl=null,e.prototype.postWizardPath=null,e.prototype.fileSubmitPath=null;var o={0:"keyhole.dbroot.StringIdOrValueProto",1:"keyhole.dbroot.StringIdOrValueProto",2:"keyhole.dbroot.StringIdOrValueProto",3:"keyhole.dbroot.StringIdOrValueProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.PostingServerProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.name=o[0].decode(e,e.uint32());break;case 2:i.baseUrl=o[1].decode(e,e.uint32());break;case 3:i.postWizardPath=o[2].decode(e,e.uint32());break;case 4:i.fileSubmitPath=o[3].decode(e,e.uint32());break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":void 0!==e.name&&null!==e.name&&(t=o[0].verify(e.name))?"name."+t:void 0!==e.baseUrl&&null!==e.baseUrl&&(t=o[1].verify(e.baseUrl))?"baseUrl."+t:void 0!==e.postWizardPath&&null!==e.postWizardPath&&(t=o[2].verify(e.postWizardPath))?"postWizardPath."+t:void 0!==e.fileSubmitPath&&null!==e.fileSubmitPath&&(t=o[3].verify(e.fileSubmitPath))?"fileSubmitPath."+t:null;var t},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.PostingServerProto)return e;var t=new u.keyhole.dbroot.PostingServerProto;if(void 0!==e.name&&null!==e.name){if("object"!=typeof e.name)throw TypeError(".keyhole.dbroot.PostingServerProto.name: object expected");t.name=o[0].fromObject(e.name)}if(void 0!==e.baseUrl&&null!==e.baseUrl){if("object"!=typeof e.baseUrl)throw TypeError(".keyhole.dbroot.PostingServerProto.baseUrl: object expected");t.baseUrl=o[1].fromObject(e.baseUrl)}if(void 0!==e.postWizardPath&&null!==e.postWizardPath){if("object"!=typeof e.postWizardPath)throw TypeError(".keyhole.dbroot.PostingServerProto.postWizardPath: object expected");t.postWizardPath=o[2].fromObject(e.postWizardPath)}if(void 0!==e.fileSubmitPath&&null!==e.fileSubmitPath){if("object"!=typeof e.fileSubmitPath)throw TypeError(".keyhole.dbroot.PostingServerProto.fileSubmitPath: object expected");t.fileSubmitPath=o[3].fromObject(e.fileSubmitPath)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.name=null,r.baseUrl=null,r.postWizardPath=null,r.fileSubmitPath=null),void 0!==e.name&&null!==e.name&&e.hasOwnProperty("name")&&(r.name=o[0].toObject(e.name,t)),void 0!==e.baseUrl&&null!==e.baseUrl&&e.hasOwnProperty("baseUrl")&&(r.baseUrl=o[1].toObject(e.baseUrl,t)),void 0!==e.postWizardPath&&null!==e.postWizardPath&&e.hasOwnProperty("postWizardPath")&&(r.postWizardPath=o[2].toObject(e.postWizardPath,t)),void 0!==e.fileSubmitPath&&null!==e.fileSubmitPath&&e.hasOwnProperty("fileSubmitPath")&&(r.fileSubmitPath=o[3].toObject(e.fileSubmitPath,t)),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.PlanetaryDatabaseProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.url=null,e.prototype.name=null;var o={0:"keyhole.dbroot.StringIdOrValueProto",1:"keyhole.dbroot.StringIdOrValueProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.PlanetaryDatabaseProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.url=o[0].decode(e,e.uint32());break;case 2:i.name=o[1].decode(e,e.uint32());break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":(t=o[0].verify(e.url))?"url."+t:(t=o[1].verify(e.name))?"name."+t:null;var t},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.PlanetaryDatabaseProto)return e;var t=new u.keyhole.dbroot.PlanetaryDatabaseProto;if(void 0!==e.url&&null!==e.url){if("object"!=typeof e.url)throw TypeError(".keyhole.dbroot.PlanetaryDatabaseProto.url: object expected");t.url=o[0].fromObject(e.url)}if(void 0!==e.name&&null!==e.name){if("object"!=typeof e.name)throw TypeError(".keyhole.dbroot.PlanetaryDatabaseProto.name: object expected");t.name=o[1].fromObject(e.name)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.url=null,r.name=null),void 0!==e.url&&null!==e.url&&e.hasOwnProperty("url")&&(r.url=o[0].toObject(e.url,t)),void 0!==e.name&&null!==e.name&&e.hasOwnProperty("name")&&(r.name=o[1].toObject(e.name,t)),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.LogServerProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.url=null,e.prototype.enable=!1,e.prototype.throttlingFactor=1;var o={0:"keyhole.dbroot.StringIdOrValueProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.LogServerProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.url=o[0].decode(e,e.uint32());break;case 2:i.enable=e.bool();break;case 3:i.throttlingFactor=e.int32();break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(void 0!==e.url&&null!==e.url){var t=o[0].verify(e.url);if(t)return"url."+t}return void 0!==e.enable&&"boolean"!=typeof e.enable?"enable: boolean expected":void 0===e.throttlingFactor||s.isInteger(e.throttlingFactor)?null:"throttlingFactor: integer expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.LogServerProto)return e;var t=new u.keyhole.dbroot.LogServerProto;if(void 0!==e.url&&null!==e.url){if("object"!=typeof e.url)throw TypeError(".keyhole.dbroot.LogServerProto.url: object expected");t.url=o[0].fromObject(e.url)}return void 0!==e.enable&&null!==e.enable&&(t.enable=Boolean(e.enable)),void 0!==e.throttlingFactor&&null!==e.throttlingFactor&&(t.throttlingFactor=0|e.throttlingFactor),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.url=null,r.enable=!1,r.throttlingFactor=1),void 0!==e.url&&null!==e.url&&e.hasOwnProperty("url")&&(r.url=o[0].toObject(e.url,t)),void 0!==e.enable&&null!==e.enable&&e.hasOwnProperty("enable")&&(r.enable=e.enable),void 0!==e.throttlingFactor&&null!==e.throttlingFactor&&e.hasOwnProperty("throttlingFactor")&&(r.throttlingFactor=e.throttlingFactor),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.EndSnippetProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.model=null,e.prototype.authServerUrl=null,e.prototype.disableAuthentication=!1,e.prototype.mfeDomains=s.emptyArray,e.prototype.mfeLangParam="hl=$5Bhl5D",e.prototype.adsUrlPatterns="",e.prototype.reverseGeocoderUrl=null,e.prototype.reverseGeocoderProtocolVersion=3,e.prototype.skyDatabaseIsAvailable=!0,e.prototype.skyDatabaseUrl=null,e.prototype.defaultWebPageIntlUrl=null,e.prototype.numStartUpTips=17,e.prototype.startUpTipsUrl=null,e.prototype.numProStartUpTips=0,e.prototype.proStartUpTipsUrl=null,e.prototype.startupTipsIntlUrl=null,e.prototype.userGuideIntlUrl=null,e.prototype.supportCenterIntlUrl=null,e.prototype.businessListingIntlUrl=null,e.prototype.supportAnswerIntlUrl=null,e.prototype.supportTopicIntlUrl=null,e.prototype.supportRequestIntlUrl=null,e.prototype.earthIntlUrl=null,e.prototype.addContentUrl=null,e.prototype.sketchupNotInstalledUrl=null,e.prototype.sketchupErrorUrl=null,e.prototype.freeLicenseUrl=null,e.prototype.proLicenseUrl=null,e.prototype.tutorialUrl=null,e.prototype.keyboardShortcutsUrl=null,e.prototype.releaseNotesUrl=null,e.prototype.hideUserData=!1,e.prototype.useGeLogo=!0,e.prototype.dioramaDescriptionUrlBase=null,e.prototype.dioramaDefaultColor=4291281607,e.prototype.dioramaBlacklistUrl=null,e.prototype.clientOptions=null,e.prototype.fetchingOptions=null,e.prototype.timeMachineOptions=null,e.prototype.csiOptions=null,e.prototype.searchTab=s.emptyArray,e.prototype.cobrandInfo=s.emptyArray,e.prototype.validDatabase=s.emptyArray,e.prototype.configScript=s.emptyArray,e.prototype.deauthServerUrl=null,e.prototype.swoopParameters=null,e.prototype.bbsServerInfo=null,e.prototype.dataErrorServerInfo=null,e.prototype.planetaryDatabase=s.emptyArray,e.prototype.logServer=null,e.prototype.autopiaOptions=null,e.prototype.searchConfig=null,e.prototype.searchInfo=null,e.prototype.elevationServiceBaseUrl="http://maps.google.com/maps/api/elevation/",e.prototype.elevationProfileQueryDelay=500,e.prototype.proUpgradeUrl=null,e.prototype.earthCommunityUrl=null,e.prototype.googleMapsUrl=null,e.prototype.sharingUrl=null,e.prototype.privacyPolicyUrl=null,e.prototype.doGplusUserCheck=!1,e.prototype.rocktreeDataProto=null,e.prototype.filmstripConfig=s.emptyArray,e.prototype.showSigninButton=!1,e.prototype.proMeasureUpsellUrl=null,e.prototype.proPrintUpsellUrl=null,e.prototype.starDataProto=null,e.prototype.feedbackUrl=null,e.prototype.oauth2LoginUrl=null;var o={0:"keyhole.dbroot.PlanetModelProto",1:"keyhole.dbroot.StringIdOrValueProto",3:"keyhole.dbroot.MfeDomainFeaturesProto",6:"keyhole.dbroot.StringIdOrValueProto",9:"keyhole.dbroot.StringIdOrValueProto",10:"keyhole.dbroot.StringIdOrValueProto",12:"keyhole.dbroot.StringIdOrValueProto",14:"keyhole.dbroot.StringIdOrValueProto",15:"keyhole.dbroot.StringIdOrValueProto",16:"keyhole.dbroot.StringIdOrValueProto",17:"keyhole.dbroot.StringIdOrValueProto",18:"keyhole.dbroot.StringIdOrValueProto",19:"keyhole.dbroot.StringIdOrValueProto",20:"keyhole.dbroot.StringIdOrValueProto",21:"keyhole.dbroot.StringIdOrValueProto",22:"keyhole.dbroot.StringIdOrValueProto",23:"keyhole.dbroot.StringIdOrValueProto",24:"keyhole.dbroot.StringIdOrValueProto",25:"keyhole.dbroot.StringIdOrValueProto",26:"keyhole.dbroot.StringIdOrValueProto",27:"keyhole.dbroot.StringIdOrValueProto",28:"keyhole.dbroot.StringIdOrValueProto",29:"keyhole.dbroot.StringIdOrValueProto",30:"keyhole.dbroot.StringIdOrValueProto",33:"keyhole.dbroot.StringIdOrValueProto",35:"keyhole.dbroot.StringIdOrValueProto",36:"keyhole.dbroot.ClientOptionsProto",37:"keyhole.dbroot.FetchingOptionsProto",38:"keyhole.dbroot.TimeMachineOptionsProto",39:"keyhole.dbroot.CSIOptionsProto",40:"keyhole.dbroot.SearchTabProto",41:"keyhole.dbroot.CobrandProto",42:"keyhole.dbroot.DatabaseDescriptionProto",43:"keyhole.dbroot.ConfigScriptProto",44:"keyhole.dbroot.StringIdOrValueProto",45:"keyhole.dbroot.SwoopParamsProto",46:"keyhole.dbroot.PostingServerProto",47:"keyhole.dbroot.PostingServerProto",48:"keyhole.dbroot.PlanetaryDatabaseProto",49:"keyhole.dbroot.LogServerProto",50:"keyhole.dbroot.AutopiaOptionsProto",51:"keyhole.dbroot.EndSnippetProto.SearchConfigProto",52:"keyhole.dbroot.EndSnippetProto.SearchInfoProto",55:"keyhole.dbroot.StringIdOrValueProto",56:"keyhole.dbroot.StringIdOrValueProto",57:"keyhole.dbroot.StringIdOrValueProto",58:"keyhole.dbroot.StringIdOrValueProto",59:"keyhole.dbroot.StringIdOrValueProto",61:"keyhole.dbroot.EndSnippetProto.RockTreeDataProto",62:"keyhole.dbroot.EndSnippetProto.FilmstripConfigProto",64:"keyhole.dbroot.StringIdOrValueProto",65:"keyhole.dbroot.StringIdOrValueProto",66:"keyhole.dbroot.EndSnippetProto.StarDataProto",67:"keyhole.dbroot.StringIdOrValueProto",68:"keyhole.dbroot.StringIdOrValueProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.EndSnippetProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.model=o[0].decode(e,e.uint32());break;case 2:i.authServerUrl=o[1].decode(e,e.uint32());break;case 3:i.disableAuthentication=e.bool();break;case 4:i.mfeDomains&&i.mfeDomains.length||(i.mfeDomains=[]),i.mfeDomains.push(o[3].decode(e,e.uint32()));break;case 5:i.mfeLangParam=e.string();break;case 6:i.adsUrlPatterns=e.string();break;case 7:i.reverseGeocoderUrl=o[6].decode(e,e.uint32());break;case 8:i.reverseGeocoderProtocolVersion=e.int32();break;case 9:i.skyDatabaseIsAvailable=e.bool();break;case 10:i.skyDatabaseUrl=o[9].decode(e,e.uint32());break;case 11:i.defaultWebPageIntlUrl=o[10].decode(e,e.uint32());break;case 12:i.numStartUpTips=e.int32();break;case 13:i.startUpTipsUrl=o[12].decode(e,e.uint32());break;case 51:i.numProStartUpTips=e.int32();break;case 52:i.proStartUpTipsUrl=o[14].decode(e,e.uint32());break;case 64:i.startupTipsIntlUrl=o[15].decode(e,e.uint32());break;case 14:i.userGuideIntlUrl=o[16].decode(e,e.uint32());break;case 15:i.supportCenterIntlUrl=o[17].decode(e,e.uint32());break;case 16:i.businessListingIntlUrl=o[18].decode(e,e.uint32());break;case 17:i.supportAnswerIntlUrl=o[19].decode(e,e.uint32());break;case 18:i.supportTopicIntlUrl=o[20].decode(e,e.uint32());break;case 19:i.supportRequestIntlUrl=o[21].decode(e,e.uint32());break;case 20:i.earthIntlUrl=o[22].decode(e,e.uint32());break;case 21:i.addContentUrl=o[23].decode(e,e.uint32());break;case 22:i.sketchupNotInstalledUrl=o[24].decode(e,e.uint32());break;case 23:i.sketchupErrorUrl=o[25].decode(e,e.uint32());break;case 24:i.freeLicenseUrl=o[26].decode(e,e.uint32());break;case 25:i.proLicenseUrl=o[27].decode(e,e.uint32());break;case 48:i.tutorialUrl=o[28].decode(e,e.uint32());break;case 49:i.keyboardShortcutsUrl=o[29].decode(e,e.uint32());break;case 50:i.releaseNotesUrl=o[30].decode(e,e.uint32());break;case 26:i.hideUserData=e.bool();break;case 27:i.useGeLogo=e.bool();break;case 28:i.dioramaDescriptionUrlBase=o[33].decode(e,e.uint32());break;case 29:i.dioramaDefaultColor=e.uint32();break;case 53:i.dioramaBlacklistUrl=o[35].decode(e,e.uint32());break;case 30:i.clientOptions=o[36].decode(e,e.uint32());break;case 31:i.fetchingOptions=o[37].decode(e,e.uint32());break;case 32:i.timeMachineOptions=o[38].decode(e,e.uint32());break;case 33:i.csiOptions=o[39].decode(e,e.uint32());break;case 34:i.searchTab&&i.searchTab.length||(i.searchTab=[]),i.searchTab.push(o[40].decode(e,e.uint32()));break;case 35:i.cobrandInfo&&i.cobrandInfo.length||(i.cobrandInfo=[]),i.cobrandInfo.push(o[41].decode(e,e.uint32()));break;case 36:i.validDatabase&&i.validDatabase.length||(i.validDatabase=[]),i.validDatabase.push(o[42].decode(e,e.uint32()));break;case 37:i.configScript&&i.configScript.length||(i.configScript=[]),i.configScript.push(o[43].decode(e,e.uint32()));break;case 38:i.deauthServerUrl=o[44].decode(e,e.uint32());break;case 39:i.swoopParameters=o[45].decode(e,e.uint32());break;case 40:i.bbsServerInfo=o[46].decode(e,e.uint32());break;case 41:i.dataErrorServerInfo=o[47].decode(e,e.uint32());break;case 42:i.planetaryDatabase&&i.planetaryDatabase.length||(i.planetaryDatabase=[]),i.planetaryDatabase.push(o[48].decode(e,e.uint32()));break;case 43:i.logServer=o[49].decode(e,e.uint32());break;case 44:i.autopiaOptions=o[50].decode(e,e.uint32());break;case 54:i.searchConfig=o[51].decode(e,e.uint32());break;case 45:i.searchInfo=o[52].decode(e,e.uint32());break;case 46:i.elevationServiceBaseUrl=e.string();break;case 47:i.elevationProfileQueryDelay=e.int32();break;case 55:i.proUpgradeUrl=o[55].decode(e,e.uint32());break;case 56:i.earthCommunityUrl=o[56].decode(e,e.uint32());break;case 57:i.googleMapsUrl=o[57].decode(e,e.uint32());break;case 58:i.sharingUrl=o[58].decode(e,e.uint32());break;case 59:i.privacyPolicyUrl=o[59].decode(e,e.uint32());break;case 60:i.doGplusUserCheck=e.bool();break;case 61:i.rocktreeDataProto=o[61].decode(e,e.uint32());break;case 62:i.filmstripConfig&&i.filmstripConfig.length||(i.filmstripConfig=[]),i.filmstripConfig.push(o[62].decode(e,e.uint32()));break;case 63:i.showSigninButton=e.bool();break;case 65:i.proMeasureUpsellUrl=o[64].decode(e,e.uint32());break;case 66:i.proPrintUpsellUrl=o[65].decode(e,e.uint32());break;case 67:i.starDataProto=o[66].decode(e,e.uint32());break;case 68:i.feedbackUrl=o[67].decode(e,e.uint32());break;case 69:i.oauth2LoginUrl=o[68].decode(e,e.uint32());break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(void 0!==e.model&&null!==e.model&&(r=o[0].verify(e.model)))return"model."+r;if(void 0!==e.authServerUrl&&null!==e.authServerUrl&&(r=o[1].verify(e.authServerUrl)))return"authServerUrl."+r;if(void 0!==e.disableAuthentication&&"boolean"!=typeof e.disableAuthentication)return"disableAuthentication: boolean expected";if(void 0!==e.mfeDomains){if(!Array.isArray(e.mfeDomains))return"mfeDomains: array expected";for(var t=0;t<e.mfeDomains.length;++t)if(r=o[3].verify(e.mfeDomains[t]))return"mfeDomains."+r}if(void 0!==e.mfeLangParam&&!s.isString(e.mfeLangParam))return"mfeLangParam: string expected";if(void 0!==e.adsUrlPatterns&&!s.isString(e.adsUrlPatterns))return"adsUrlPatterns: string expected";if(void 0!==e.reverseGeocoderUrl&&null!==e.reverseGeocoderUrl&&(r=o[6].verify(e.reverseGeocoderUrl)))return"reverseGeocoderUrl."+r;if(void 0!==e.reverseGeocoderProtocolVersion&&!s.isInteger(e.reverseGeocoderProtocolVersion))return"reverseGeocoderProtocolVersion: integer expected";if(void 0!==e.skyDatabaseIsAvailable&&"boolean"!=typeof e.skyDatabaseIsAvailable)return"skyDatabaseIsAvailable: boolean expected";if(void 0!==e.skyDatabaseUrl&&null!==e.skyDatabaseUrl&&(r=o[9].verify(e.skyDatabaseUrl)))return"skyDatabaseUrl."+r;if(void 0!==e.defaultWebPageIntlUrl&&null!==e.defaultWebPageIntlUrl&&(r=o[10].verify(e.defaultWebPageIntlUrl)))return"defaultWebPageIntlUrl."+r;if(void 0!==e.numStartUpTips&&!s.isInteger(e.numStartUpTips))return"numStartUpTips: integer expected";if(void 0!==e.startUpTipsUrl&&null!==e.startUpTipsUrl&&(r=o[12].verify(e.startUpTipsUrl)))return"startUpTipsUrl."+r;if(void 0!==e.numProStartUpTips&&!s.isInteger(e.numProStartUpTips))return"numProStartUpTips: integer expected";if(void 0!==e.proStartUpTipsUrl&&null!==e.proStartUpTipsUrl&&(r=o[14].verify(e.proStartUpTipsUrl)))return"proStartUpTipsUrl."+r;if(void 0!==e.startupTipsIntlUrl&&null!==e.startupTipsIntlUrl&&(r=o[15].verify(e.startupTipsIntlUrl)))return"startupTipsIntlUrl."+r;if(void 0!==e.userGuideIntlUrl&&null!==e.userGuideIntlUrl&&(r=o[16].verify(e.userGuideIntlUrl)))return"userGuideIntlUrl."+r;if(void 0!==e.supportCenterIntlUrl&&null!==e.supportCenterIntlUrl&&(r=o[17].verify(e.supportCenterIntlUrl)))return"supportCenterIntlUrl."+r;if(void 0!==e.businessListingIntlUrl&&null!==e.businessListingIntlUrl&&(r=o[18].verify(e.businessListingIntlUrl)))return"businessListingIntlUrl."+r;if(void 0!==e.supportAnswerIntlUrl&&null!==e.supportAnswerIntlUrl&&(r=o[19].verify(e.supportAnswerIntlUrl)))return"supportAnswerIntlUrl."+r;if(void 0!==e.supportTopicIntlUrl&&null!==e.supportTopicIntlUrl&&(r=o[20].verify(e.supportTopicIntlUrl)))return"supportTopicIntlUrl."+r;if(void 0!==e.supportRequestIntlUrl&&null!==e.supportRequestIntlUrl&&(r=o[21].verify(e.supportRequestIntlUrl)))return"supportRequestIntlUrl."+r;if(void 0!==e.earthIntlUrl&&null!==e.earthIntlUrl&&(r=o[22].verify(e.earthIntlUrl)))return"earthIntlUrl."+r;if(void 0!==e.addContentUrl&&null!==e.addContentUrl&&(r=o[23].verify(e.addContentUrl)))return"addContentUrl."+r;if(void 0!==e.sketchupNotInstalledUrl&&null!==e.sketchupNotInstalledUrl&&(r=o[24].verify(e.sketchupNotInstalledUrl)))return"sketchupNotInstalledUrl."+r;if(void 0!==e.sketchupErrorUrl&&null!==e.sketchupErrorUrl&&(r=o[25].verify(e.sketchupErrorUrl)))return"sketchupErrorUrl."+r;if(void 0!==e.freeLicenseUrl&&null!==e.freeLicenseUrl&&(r=o[26].verify(e.freeLicenseUrl)))return"freeLicenseUrl."+r;if(void 0!==e.proLicenseUrl&&null!==e.proLicenseUrl&&(r=o[27].verify(e.proLicenseUrl)))return"proLicenseUrl."+r;if(void 0!==e.tutorialUrl&&null!==e.tutorialUrl&&(r=o[28].verify(e.tutorialUrl)))return"tutorialUrl."+r;if(void 0!==e.keyboardShortcutsUrl&&null!==e.keyboardShortcutsUrl&&(r=o[29].verify(e.keyboardShortcutsUrl)))return"keyboardShortcutsUrl."+r;if(void 0!==e.releaseNotesUrl&&null!==e.releaseNotesUrl&&(r=o[30].verify(e.releaseNotesUrl)))return"releaseNotesUrl."+r;if(void 0!==e.hideUserData&&"boolean"!=typeof e.hideUserData)return"hideUserData: boolean expected";if(void 0!==e.useGeLogo&&"boolean"!=typeof e.useGeLogo)return"useGeLogo: boolean expected";if(void 0!==e.dioramaDescriptionUrlBase&&null!==e.dioramaDescriptionUrlBase&&(r=o[33].verify(e.dioramaDescriptionUrlBase)))return"dioramaDescriptionUrlBase."+r;if(void 0!==e.dioramaDefaultColor&&!s.isInteger(e.dioramaDefaultColor))return"dioramaDefaultColor: integer expected";if(void 0!==e.dioramaBlacklistUrl&&null!==e.dioramaBlacklistUrl&&(r=o[35].verify(e.dioramaBlacklistUrl)))return"dioramaBlacklistUrl."+r;if(void 0!==e.clientOptions&&null!==e.clientOptions&&(r=o[36].verify(e.clientOptions)))return"clientOptions."+r;if(void 0!==e.fetchingOptions&&null!==e.fetchingOptions&&(r=o[37].verify(e.fetchingOptions)))return"fetchingOptions."+r;if(void 0!==e.timeMachineOptions&&null!==e.timeMachineOptions&&(r=o[38].verify(e.timeMachineOptions)))return"timeMachineOptions."+r;if(void 0!==e.csiOptions&&null!==e.csiOptions&&(r=o[39].verify(e.csiOptions)))return"csiOptions."+r;if(void 0!==e.searchTab){if(!Array.isArray(e.searchTab))return"searchTab: array expected";for(t=0;t<e.searchTab.length;++t)if(r=o[40].verify(e.searchTab[t]))return"searchTab."+r}if(void 0!==e.cobrandInfo){if(!Array.isArray(e.cobrandInfo))return"cobrandInfo: array expected";for(t=0;t<e.cobrandInfo.length;++t)if(r=o[41].verify(e.cobrandInfo[t]))return"cobrandInfo."+r}if(void 0!==e.validDatabase){if(!Array.isArray(e.validDatabase))return"validDatabase: array expected";for(t=0;t<e.validDatabase.length;++t)if(r=o[42].verify(e.validDatabase[t]))return"validDatabase."+r}if(void 0!==e.configScript){if(!Array.isArray(e.configScript))return"configScript: array expected";for(t=0;t<e.configScript.length;++t)if(r=o[43].verify(e.configScript[t]))return"configScript."+r}if(void 0!==e.deauthServerUrl&&null!==e.deauthServerUrl&&(r=o[44].verify(e.deauthServerUrl)))return"deauthServerUrl."+r;if(void 0!==e.swoopParameters&&null!==e.swoopParameters&&(r=o[45].verify(e.swoopParameters)))return"swoopParameters."+r;if(void 0!==e.bbsServerInfo&&null!==e.bbsServerInfo&&(r=o[46].verify(e.bbsServerInfo)))return"bbsServerInfo."+r;if(void 0!==e.dataErrorServerInfo&&null!==e.dataErrorServerInfo&&(r=o[47].verify(e.dataErrorServerInfo)))return"dataErrorServerInfo."+r;if(void 0!==e.planetaryDatabase){if(!Array.isArray(e.planetaryDatabase))return"planetaryDatabase: array expected";for(t=0;t<e.planetaryDatabase.length;++t)if(r=o[48].verify(e.planetaryDatabase[t]))return"planetaryDatabase."+r}if(void 0!==e.logServer&&null!==e.logServer&&(r=o[49].verify(e.logServer)))return"logServer."+r;if(void 0!==e.autopiaOptions&&null!==e.autopiaOptions&&(r=o[50].verify(e.autopiaOptions)))return"autopiaOptions."+r;if(void 0!==e.searchConfig&&null!==e.searchConfig&&(r=o[51].verify(e.searchConfig)))return"searchConfig."+r;if(void 0!==e.searchInfo&&null!==e.searchInfo&&(r=o[52].verify(e.searchInfo)))return"searchInfo."+r;if(void 0!==e.elevationServiceBaseUrl&&!s.isString(e.elevationServiceBaseUrl))return"elevationServiceBaseUrl: string expected";if(void 0!==e.elevationProfileQueryDelay&&!s.isInteger(e.elevationProfileQueryDelay))return"elevationProfileQueryDelay: integer expected";if(void 0!==e.proUpgradeUrl&&null!==e.proUpgradeUrl&&(r=o[55].verify(e.proUpgradeUrl)))return"proUpgradeUrl."+r;if(void 0!==e.earthCommunityUrl&&null!==e.earthCommunityUrl&&(r=o[56].verify(e.earthCommunityUrl)))return"earthCommunityUrl."+r;if(void 0!==e.googleMapsUrl&&null!==e.googleMapsUrl&&(r=o[57].verify(e.googleMapsUrl)))return"googleMapsUrl."+r;if(void 0!==e.sharingUrl&&null!==e.sharingUrl&&(r=o[58].verify(e.sharingUrl)))return"sharingUrl."+r;if(void 0!==e.privacyPolicyUrl&&null!==e.privacyPolicyUrl&&(r=o[59].verify(e.privacyPolicyUrl)))return"privacyPolicyUrl."+r;if(void 0!==e.doGplusUserCheck&&"boolean"!=typeof e.doGplusUserCheck)return"doGplusUserCheck: boolean expected";if(void 0!==e.rocktreeDataProto&&null!==e.rocktreeDataProto&&(r=o[61].verify(e.rocktreeDataProto)))return"rocktreeDataProto."+r;if(void 0!==e.filmstripConfig){if(!Array.isArray(e.filmstripConfig))return"filmstripConfig: array expected";for(t=0;t<e.filmstripConfig.length;++t){var r;if(r=o[62].verify(e.filmstripConfig[t]))return"filmstripConfig."+r}}return void 0!==e.showSigninButton&&"boolean"!=typeof e.showSigninButton?"showSigninButton: boolean expected":void 0!==e.proMeasureUpsellUrl&&null!==e.proMeasureUpsellUrl&&(r=o[64].verify(e.proMeasureUpsellUrl))?"proMeasureUpsellUrl."+r:void 0!==e.proPrintUpsellUrl&&null!==e.proPrintUpsellUrl&&(r=o[65].verify(e.proPrintUpsellUrl))?"proPrintUpsellUrl."+r:void 0!==e.starDataProto&&null!==e.starDataProto&&(r=o[66].verify(e.starDataProto))?"starDataProto."+r:void 0!==e.feedbackUrl&&null!==e.feedbackUrl&&(r=o[67].verify(e.feedbackUrl))?"feedbackUrl."+r:void 0!==e.oauth2LoginUrl&&null!==e.oauth2LoginUrl&&(r=o[68].verify(e.oauth2LoginUrl))?"oauth2LoginUrl."+r:null},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.EndSnippetProto)return e;var t=new u.keyhole.dbroot.EndSnippetProto;if(void 0!==e.model&&null!==e.model){if("object"!=typeof e.model)throw TypeError(".keyhole.dbroot.EndSnippetProto.model: object expected");t.model=o[0].fromObject(e.model)}if(void 0!==e.authServerUrl&&null!==e.authServerUrl){if("object"!=typeof e.authServerUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.authServerUrl: object expected");t.authServerUrl=o[1].fromObject(e.authServerUrl)}if(void 0!==e.disableAuthentication&&null!==e.disableAuthentication&&(t.disableAuthentication=Boolean(e.disableAuthentication)),e.mfeDomains){if(!Array.isArray(e.mfeDomains))throw TypeError(".keyhole.dbroot.EndSnippetProto.mfeDomains: array expected");t.mfeDomains=[];for(var r=0;r<e.mfeDomains.length;++r){if("object"!=typeof e.mfeDomains[r])throw TypeError(".keyhole.dbroot.EndSnippetProto.mfeDomains: object expected");t.mfeDomains[r]=o[3].fromObject(e.mfeDomains[r])}}if(void 0!==e.mfeLangParam&&null!==e.mfeLangParam&&(t.mfeLangParam=String(e.mfeLangParam)),void 0!==e.adsUrlPatterns&&null!==e.adsUrlPatterns&&(t.adsUrlPatterns=String(e.adsUrlPatterns)),void 0!==e.reverseGeocoderUrl&&null!==e.reverseGeocoderUrl){if("object"!=typeof e.reverseGeocoderUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.reverseGeocoderUrl: object expected");t.reverseGeocoderUrl=o[6].fromObject(e.reverseGeocoderUrl)}if(void 0!==e.reverseGeocoderProtocolVersion&&null!==e.reverseGeocoderProtocolVersion&&(t.reverseGeocoderProtocolVersion=0|e.reverseGeocoderProtocolVersion),void 0!==e.skyDatabaseIsAvailable&&null!==e.skyDatabaseIsAvailable&&(t.skyDatabaseIsAvailable=Boolean(e.skyDatabaseIsAvailable)),void 0!==e.skyDatabaseUrl&&null!==e.skyDatabaseUrl){if("object"!=typeof e.skyDatabaseUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.skyDatabaseUrl: object expected");t.skyDatabaseUrl=o[9].fromObject(e.skyDatabaseUrl)}if(void 0!==e.defaultWebPageIntlUrl&&null!==e.defaultWebPageIntlUrl){if("object"!=typeof e.defaultWebPageIntlUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.defaultWebPageIntlUrl: object expected");t.defaultWebPageIntlUrl=o[10].fromObject(e.defaultWebPageIntlUrl)}if(void 0!==e.numStartUpTips&&null!==e.numStartUpTips&&(t.numStartUpTips=0|e.numStartUpTips),void 0!==e.startUpTipsUrl&&null!==e.startUpTipsUrl){if("object"!=typeof e.startUpTipsUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.startUpTipsUrl: object expected");t.startUpTipsUrl=o[12].fromObject(e.startUpTipsUrl)}if(void 0!==e.numProStartUpTips&&null!==e.numProStartUpTips&&(t.numProStartUpTips=0|e.numProStartUpTips),void 0!==e.proStartUpTipsUrl&&null!==e.proStartUpTipsUrl){if("object"!=typeof e.proStartUpTipsUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.proStartUpTipsUrl: object expected");t.proStartUpTipsUrl=o[14].fromObject(e.proStartUpTipsUrl)}if(void 0!==e.startupTipsIntlUrl&&null!==e.startupTipsIntlUrl){if("object"!=typeof e.startupTipsIntlUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.startupTipsIntlUrl: object expected");t.startupTipsIntlUrl=o[15].fromObject(e.startupTipsIntlUrl)}if(void 0!==e.userGuideIntlUrl&&null!==e.userGuideIntlUrl){if("object"!=typeof e.userGuideIntlUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.userGuideIntlUrl: object expected");t.userGuideIntlUrl=o[16].fromObject(e.userGuideIntlUrl)}if(void 0!==e.supportCenterIntlUrl&&null!==e.supportCenterIntlUrl){if("object"!=typeof e.supportCenterIntlUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.supportCenterIntlUrl: object expected");t.supportCenterIntlUrl=o[17].fromObject(e.supportCenterIntlUrl)}if(void 0!==e.businessListingIntlUrl&&null!==e.businessListingIntlUrl){if("object"!=typeof e.businessListingIntlUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.businessListingIntlUrl: object expected");t.businessListingIntlUrl=o[18].fromObject(e.businessListingIntlUrl)}if(void 0!==e.supportAnswerIntlUrl&&null!==e.supportAnswerIntlUrl){if("object"!=typeof e.supportAnswerIntlUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.supportAnswerIntlUrl: object expected");t.supportAnswerIntlUrl=o[19].fromObject(e.supportAnswerIntlUrl)}if(void 0!==e.supportTopicIntlUrl&&null!==e.supportTopicIntlUrl){if("object"!=typeof e.supportTopicIntlUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.supportTopicIntlUrl: object expected");t.supportTopicIntlUrl=o[20].fromObject(e.supportTopicIntlUrl)}if(void 0!==e.supportRequestIntlUrl&&null!==e.supportRequestIntlUrl){if("object"!=typeof e.supportRequestIntlUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.supportRequestIntlUrl: object expected");t.supportRequestIntlUrl=o[21].fromObject(e.supportRequestIntlUrl)}if(void 0!==e.earthIntlUrl&&null!==e.earthIntlUrl){if("object"!=typeof e.earthIntlUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.earthIntlUrl: object expected");t.earthIntlUrl=o[22].fromObject(e.earthIntlUrl)}if(void 0!==e.addContentUrl&&null!==e.addContentUrl){if("object"!=typeof e.addContentUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.addContentUrl: object expected");t.addContentUrl=o[23].fromObject(e.addContentUrl)}if(void 0!==e.sketchupNotInstalledUrl&&null!==e.sketchupNotInstalledUrl){if("object"!=typeof e.sketchupNotInstalledUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.sketchupNotInstalledUrl: object expected");t.sketchupNotInstalledUrl=o[24].fromObject(e.sketchupNotInstalledUrl)}if(void 0!==e.sketchupErrorUrl&&null!==e.sketchupErrorUrl){if("object"!=typeof e.sketchupErrorUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.sketchupErrorUrl: object expected");t.sketchupErrorUrl=o[25].fromObject(e.sketchupErrorUrl)}if(void 0!==e.freeLicenseUrl&&null!==e.freeLicenseUrl){if("object"!=typeof e.freeLicenseUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.freeLicenseUrl: object expected");t.freeLicenseUrl=o[26].fromObject(e.freeLicenseUrl)}if(void 0!==e.proLicenseUrl&&null!==e.proLicenseUrl){if("object"!=typeof e.proLicenseUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.proLicenseUrl: object expected");t.proLicenseUrl=o[27].fromObject(e.proLicenseUrl)}if(void 0!==e.tutorialUrl&&null!==e.tutorialUrl){if("object"!=typeof e.tutorialUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.tutorialUrl: object expected");t.tutorialUrl=o[28].fromObject(e.tutorialUrl)}if(void 0!==e.keyboardShortcutsUrl&&null!==e.keyboardShortcutsUrl){if("object"!=typeof e.keyboardShortcutsUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.keyboardShortcutsUrl: object expected");t.keyboardShortcutsUrl=o[29].fromObject(e.keyboardShortcutsUrl)}if(void 0!==e.releaseNotesUrl&&null!==e.releaseNotesUrl){if("object"!=typeof e.releaseNotesUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.releaseNotesUrl: object expected");t.releaseNotesUrl=o[30].fromObject(e.releaseNotesUrl)}if(void 0!==e.hideUserData&&null!==e.hideUserData&&(t.hideUserData=Boolean(e.hideUserData)),void 0!==e.useGeLogo&&null!==e.useGeLogo&&(t.useGeLogo=Boolean(e.useGeLogo)),void 0!==e.dioramaDescriptionUrlBase&&null!==e.dioramaDescriptionUrlBase){if("object"!=typeof e.dioramaDescriptionUrlBase)throw TypeError(".keyhole.dbroot.EndSnippetProto.dioramaDescriptionUrlBase: object expected");t.dioramaDescriptionUrlBase=o[33].fromObject(e.dioramaDescriptionUrlBase)}if(void 0!==e.dioramaDefaultColor&&null!==e.dioramaDefaultColor&&(t.dioramaDefaultColor=e.dioramaDefaultColor>>>0),void 0!==e.dioramaBlacklistUrl&&null!==e.dioramaBlacklistUrl){if("object"!=typeof e.dioramaBlacklistUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.dioramaBlacklistUrl: object expected");t.dioramaBlacklistUrl=o[35].fromObject(e.dioramaBlacklistUrl)}if(void 0!==e.clientOptions&&null!==e.clientOptions){if("object"!=typeof e.clientOptions)throw TypeError(".keyhole.dbroot.EndSnippetProto.clientOptions: object expected");t.clientOptions=o[36].fromObject(e.clientOptions)}if(void 0!==e.fetchingOptions&&null!==e.fetchingOptions){if("object"!=typeof e.fetchingOptions)throw TypeError(".keyhole.dbroot.EndSnippetProto.fetchingOptions: object expected");t.fetchingOptions=o[37].fromObject(e.fetchingOptions)}if(void 0!==e.timeMachineOptions&&null!==e.timeMachineOptions){if("object"!=typeof e.timeMachineOptions)throw TypeError(".keyhole.dbroot.EndSnippetProto.timeMachineOptions: object expected");t.timeMachineOptions=o[38].fromObject(e.timeMachineOptions)}if(void 0!==e.csiOptions&&null!==e.csiOptions){if("object"!=typeof e.csiOptions)throw TypeError(".keyhole.dbroot.EndSnippetProto.csiOptions: object expected");t.csiOptions=o[39].fromObject(e.csiOptions)}if(e.searchTab){if(!Array.isArray(e.searchTab))throw TypeError(".keyhole.dbroot.EndSnippetProto.searchTab: array expected");for(t.searchTab=[],r=0;r<e.searchTab.length;++r){if("object"!=typeof e.searchTab[r])throw TypeError(".keyhole.dbroot.EndSnippetProto.searchTab: object expected");t.searchTab[r]=o[40].fromObject(e.searchTab[r])}}if(e.cobrandInfo){if(!Array.isArray(e.cobrandInfo))throw TypeError(".keyhole.dbroot.EndSnippetProto.cobrandInfo: array expected");for(t.cobrandInfo=[],r=0;r<e.cobrandInfo.length;++r){if("object"!=typeof e.cobrandInfo[r])throw TypeError(".keyhole.dbroot.EndSnippetProto.cobrandInfo: object expected");t.cobrandInfo[r]=o[41].fromObject(e.cobrandInfo[r])}}if(e.validDatabase){if(!Array.isArray(e.validDatabase))throw TypeError(".keyhole.dbroot.EndSnippetProto.validDatabase: array expected");for(t.validDatabase=[],r=0;r<e.validDatabase.length;++r){if("object"!=typeof e.validDatabase[r])throw TypeError(".keyhole.dbroot.EndSnippetProto.validDatabase: object expected");t.validDatabase[r]=o[42].fromObject(e.validDatabase[r])}}if(e.configScript){if(!Array.isArray(e.configScript))throw TypeError(".keyhole.dbroot.EndSnippetProto.configScript: array expected");for(t.configScript=[],r=0;r<e.configScript.length;++r){if("object"!=typeof e.configScript[r])throw TypeError(".keyhole.dbroot.EndSnippetProto.configScript: object expected");t.configScript[r]=o[43].fromObject(e.configScript[r])}}if(void 0!==e.deauthServerUrl&&null!==e.deauthServerUrl){if("object"!=typeof e.deauthServerUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.deauthServerUrl: object expected");t.deauthServerUrl=o[44].fromObject(e.deauthServerUrl)}if(void 0!==e.swoopParameters&&null!==e.swoopParameters){if("object"!=typeof e.swoopParameters)throw TypeError(".keyhole.dbroot.EndSnippetProto.swoopParameters: object expected");t.swoopParameters=o[45].fromObject(e.swoopParameters)}if(void 0!==e.bbsServerInfo&&null!==e.bbsServerInfo){if("object"!=typeof e.bbsServerInfo)throw TypeError(".keyhole.dbroot.EndSnippetProto.bbsServerInfo: object expected");t.bbsServerInfo=o[46].fromObject(e.bbsServerInfo)}if(void 0!==e.dataErrorServerInfo&&null!==e.dataErrorServerInfo){if("object"!=typeof e.dataErrorServerInfo)throw TypeError(".keyhole.dbroot.EndSnippetProto.dataErrorServerInfo: object expected");t.dataErrorServerInfo=o[47].fromObject(e.dataErrorServerInfo)}if(e.planetaryDatabase){if(!Array.isArray(e.planetaryDatabase))throw TypeError(".keyhole.dbroot.EndSnippetProto.planetaryDatabase: array expected");for(t.planetaryDatabase=[],r=0;r<e.planetaryDatabase.length;++r){if("object"!=typeof e.planetaryDatabase[r])throw TypeError(".keyhole.dbroot.EndSnippetProto.planetaryDatabase: object expected");t.planetaryDatabase[r]=o[48].fromObject(e.planetaryDatabase[r])}}if(void 0!==e.logServer&&null!==e.logServer){if("object"!=typeof e.logServer)throw TypeError(".keyhole.dbroot.EndSnippetProto.logServer: object expected");t.logServer=o[49].fromObject(e.logServer)}if(void 0!==e.autopiaOptions&&null!==e.autopiaOptions){if("object"!=typeof e.autopiaOptions)throw TypeError(".keyhole.dbroot.EndSnippetProto.autopiaOptions: object expected");t.autopiaOptions=o[50].fromObject(e.autopiaOptions)}if(void 0!==e.searchConfig&&null!==e.searchConfig){if("object"!=typeof e.searchConfig)throw TypeError(".keyhole.dbroot.EndSnippetProto.searchConfig: object expected");t.searchConfig=o[51].fromObject(e.searchConfig)}if(void 0!==e.searchInfo&&null!==e.searchInfo){if("object"!=typeof e.searchInfo)throw TypeError(".keyhole.dbroot.EndSnippetProto.searchInfo: object expected");t.searchInfo=o[52].fromObject(e.searchInfo)}if(void 0!==e.elevationServiceBaseUrl&&null!==e.elevationServiceBaseUrl&&(t.elevationServiceBaseUrl=String(e.elevationServiceBaseUrl)),void 0!==e.elevationProfileQueryDelay&&null!==e.elevationProfileQueryDelay&&(t.elevationProfileQueryDelay=0|e.elevationProfileQueryDelay),void 0!==e.proUpgradeUrl&&null!==e.proUpgradeUrl){if("object"!=typeof e.proUpgradeUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.proUpgradeUrl: object expected");t.proUpgradeUrl=o[55].fromObject(e.proUpgradeUrl)}if(void 0!==e.earthCommunityUrl&&null!==e.earthCommunityUrl){if("object"!=typeof e.earthCommunityUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.earthCommunityUrl: object expected");t.earthCommunityUrl=o[56].fromObject(e.earthCommunityUrl)}if(void 0!==e.googleMapsUrl&&null!==e.googleMapsUrl){if("object"!=typeof e.googleMapsUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.googleMapsUrl: object expected");t.googleMapsUrl=o[57].fromObject(e.googleMapsUrl)}if(void 0!==e.sharingUrl&&null!==e.sharingUrl){if("object"!=typeof e.sharingUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.sharingUrl: object expected");t.sharingUrl=o[58].fromObject(e.sharingUrl)}if(void 0!==e.privacyPolicyUrl&&null!==e.privacyPolicyUrl){if("object"!=typeof e.privacyPolicyUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.privacyPolicyUrl: object expected");t.privacyPolicyUrl=o[59].fromObject(e.privacyPolicyUrl)}if(void 0!==e.doGplusUserCheck&&null!==e.doGplusUserCheck&&(t.doGplusUserCheck=Boolean(e.doGplusUserCheck)),void 0!==e.rocktreeDataProto&&null!==e.rocktreeDataProto){if("object"!=typeof e.rocktreeDataProto)throw TypeError(".keyhole.dbroot.EndSnippetProto.rocktreeDataProto: object expected");t.rocktreeDataProto=o[61].fromObject(e.rocktreeDataProto)}if(e.filmstripConfig){if(!Array.isArray(e.filmstripConfig))throw TypeError(".keyhole.dbroot.EndSnippetProto.filmstripConfig: array expected");for(t.filmstripConfig=[],r=0;r<e.filmstripConfig.length;++r){if("object"!=typeof e.filmstripConfig[r])throw TypeError(".keyhole.dbroot.EndSnippetProto.filmstripConfig: object expected");t.filmstripConfig[r]=o[62].fromObject(e.filmstripConfig[r])}}if(void 0!==e.showSigninButton&&null!==e.showSigninButton&&(t.showSigninButton=Boolean(e.showSigninButton)),void 0!==e.proMeasureUpsellUrl&&null!==e.proMeasureUpsellUrl){if("object"!=typeof e.proMeasureUpsellUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.proMeasureUpsellUrl: object expected");t.proMeasureUpsellUrl=o[64].fromObject(e.proMeasureUpsellUrl)}if(void 0!==e.proPrintUpsellUrl&&null!==e.proPrintUpsellUrl){if("object"!=typeof e.proPrintUpsellUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.proPrintUpsellUrl: object expected");t.proPrintUpsellUrl=o[65].fromObject(e.proPrintUpsellUrl)}if(void 0!==e.starDataProto&&null!==e.starDataProto){if("object"!=typeof e.starDataProto)throw TypeError(".keyhole.dbroot.EndSnippetProto.starDataProto: object expected");t.starDataProto=o[66].fromObject(e.starDataProto)}if(void 0!==e.feedbackUrl&&null!==e.feedbackUrl){if("object"!=typeof e.feedbackUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.feedbackUrl: object expected");t.feedbackUrl=o[67].fromObject(e.feedbackUrl)}if(void 0!==e.oauth2LoginUrl&&null!==e.oauth2LoginUrl){if("object"!=typeof e.oauth2LoginUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.oauth2LoginUrl: object expected");t.oauth2LoginUrl=o[68].fromObject(e.oauth2LoginUrl)}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.mfeDomains=[],r.searchTab=[],r.cobrandInfo=[],r.validDatabase=[],r.configScript=[],r.planetaryDatabase=[],r.filmstripConfig=[]),t.defaults&&(r.model=null,r.authServerUrl=null,r.disableAuthentication=!1,r.mfeLangParam="hl=$5Bhl5D",r.adsUrlPatterns="",r.reverseGeocoderUrl=null,r.reverseGeocoderProtocolVersion=3,r.skyDatabaseIsAvailable=!0,r.skyDatabaseUrl=null,r.defaultWebPageIntlUrl=null,r.numStartUpTips=17,r.startUpTipsUrl=null,r.numProStartUpTips=0,r.proStartUpTipsUrl=null,r.startupTipsIntlUrl=null,r.userGuideIntlUrl=null,r.supportCenterIntlUrl=null,r.businessListingIntlUrl=null,r.supportAnswerIntlUrl=null,r.supportTopicIntlUrl=null,r.supportRequestIntlUrl=null,r.earthIntlUrl=null,r.addContentUrl=null,r.sketchupNotInstalledUrl=null,r.sketchupErrorUrl=null,r.freeLicenseUrl=null,r.proLicenseUrl=null,r.tutorialUrl=null,r.keyboardShortcutsUrl=null,r.releaseNotesUrl=null,r.hideUserData=!1,r.useGeLogo=!0,r.dioramaDescriptionUrlBase=null,r.dioramaDefaultColor=4291281607,r.dioramaBlacklistUrl=null,r.clientOptions=null,r.fetchingOptions=null,r.timeMachineOptions=null,r.csiOptions=null,r.deauthServerUrl=null,r.swoopParameters=null,r.bbsServerInfo=null,r.dataErrorServerInfo=null,r.logServer=null,r.autopiaOptions=null,r.searchConfig=null,r.searchInfo=null,r.elevationServiceBaseUrl="http://maps.google.com/maps/api/elevation/",r.elevationProfileQueryDelay=500,r.proUpgradeUrl=null,r.earthCommunityUrl=null,r.googleMapsUrl=null,r.sharingUrl=null,r.privacyPolicyUrl=null,r.doGplusUserCheck=!1,r.rocktreeDataProto=null,r.showSigninButton=!1,r.proMeasureUpsellUrl=null,r.proPrintUpsellUrl=null,r.starDataProto=null,r.feedbackUrl=null,r.oauth2LoginUrl=null),void 0!==e.model&&null!==e.model&&e.hasOwnProperty("model")&&(r.model=o[0].toObject(e.model,t)),void 0!==e.authServerUrl&&null!==e.authServerUrl&&e.hasOwnProperty("authServerUrl")&&(r.authServerUrl=o[1].toObject(e.authServerUrl,t)),void 0!==e.disableAuthentication&&null!==e.disableAuthentication&&e.hasOwnProperty("disableAuthentication")&&(r.disableAuthentication=e.disableAuthentication),void 0!==e.mfeDomains&&null!==e.mfeDomains&&e.hasOwnProperty("mfeDomains")){r.mfeDomains=[];for(var i=0;i<e.mfeDomains.length;++i)r.mfeDomains[i]=o[3].toObject(e.mfeDomains[i],t)}if(void 0!==e.mfeLangParam&&null!==e.mfeLangParam&&e.hasOwnProperty("mfeLangParam")&&(r.mfeLangParam=e.mfeLangParam),void 0!==e.adsUrlPatterns&&null!==e.adsUrlPatterns&&e.hasOwnProperty("adsUrlPatterns")&&(r.adsUrlPatterns=e.adsUrlPatterns),void 0!==e.reverseGeocoderUrl&&null!==e.reverseGeocoderUrl&&e.hasOwnProperty("reverseGeocoderUrl")&&(r.reverseGeocoderUrl=o[6].toObject(e.reverseGeocoderUrl,t)),void 0!==e.reverseGeocoderProtocolVersion&&null!==e.reverseGeocoderProtocolVersion&&e.hasOwnProperty("reverseGeocoderProtocolVersion")&&(r.reverseGeocoderProtocolVersion=e.reverseGeocoderProtocolVersion),void 0!==e.skyDatabaseIsAvailable&&null!==e.skyDatabaseIsAvailable&&e.hasOwnProperty("skyDatabaseIsAvailable")&&(r.skyDatabaseIsAvailable=e.skyDatabaseIsAvailable),void 0!==e.skyDatabaseUrl&&null!==e.skyDatabaseUrl&&e.hasOwnProperty("skyDatabaseUrl")&&(r.skyDatabaseUrl=o[9].toObject(e.skyDatabaseUrl,t)),void 0!==e.defaultWebPageIntlUrl&&null!==e.defaultWebPageIntlUrl&&e.hasOwnProperty("defaultWebPageIntlUrl")&&(r.defaultWebPageIntlUrl=o[10].toObject(e.defaultWebPageIntlUrl,t)),void 0!==e.numStartUpTips&&null!==e.numStartUpTips&&e.hasOwnProperty("numStartUpTips")&&(r.numStartUpTips=e.numStartUpTips),void 0!==e.startUpTipsUrl&&null!==e.startUpTipsUrl&&e.hasOwnProperty("startUpTipsUrl")&&(r.startUpTipsUrl=o[12].toObject(e.startUpTipsUrl,t)),void 0!==e.numProStartUpTips&&null!==e.numProStartUpTips&&e.hasOwnProperty("numProStartUpTips")&&(r.numProStartUpTips=e.numProStartUpTips),void 0!==e.proStartUpTipsUrl&&null!==e.proStartUpTipsUrl&&e.hasOwnProperty("proStartUpTipsUrl")&&(r.proStartUpTipsUrl=o[14].toObject(e.proStartUpTipsUrl,t)),void 0!==e.startupTipsIntlUrl&&null!==e.startupTipsIntlUrl&&e.hasOwnProperty("startupTipsIntlUrl")&&(r.startupTipsIntlUrl=o[15].toObject(e.startupTipsIntlUrl,t)),void 0!==e.userGuideIntlUrl&&null!==e.userGuideIntlUrl&&e.hasOwnProperty("userGuideIntlUrl")&&(r.userGuideIntlUrl=o[16].toObject(e.userGuideIntlUrl,t)),void 0!==e.supportCenterIntlUrl&&null!==e.supportCenterIntlUrl&&e.hasOwnProperty("supportCenterIntlUrl")&&(r.supportCenterIntlUrl=o[17].toObject(e.supportCenterIntlUrl,t)),void 0!==e.businessListingIntlUrl&&null!==e.businessListingIntlUrl&&e.hasOwnProperty("businessListingIntlUrl")&&(r.businessListingIntlUrl=o[18].toObject(e.businessListingIntlUrl,t)),void 0!==e.supportAnswerIntlUrl&&null!==e.supportAnswerIntlUrl&&e.hasOwnProperty("supportAnswerIntlUrl")&&(r.supportAnswerIntlUrl=o[19].toObject(e.supportAnswerIntlUrl,t)),void 0!==e.supportTopicIntlUrl&&null!==e.supportTopicIntlUrl&&e.hasOwnProperty("supportTopicIntlUrl")&&(r.supportTopicIntlUrl=o[20].toObject(e.supportTopicIntlUrl,t)),void 0!==e.supportRequestIntlUrl&&null!==e.supportRequestIntlUrl&&e.hasOwnProperty("supportRequestIntlUrl")&&(r.supportRequestIntlUrl=o[21].toObject(e.supportRequestIntlUrl,t)),void 0!==e.earthIntlUrl&&null!==e.earthIntlUrl&&e.hasOwnProperty("earthIntlUrl")&&(r.earthIntlUrl=o[22].toObject(e.earthIntlUrl,t)),void 0!==e.addContentUrl&&null!==e.addContentUrl&&e.hasOwnProperty("addContentUrl")&&(r.addContentUrl=o[23].toObject(e.addContentUrl,t)),void 0!==e.sketchupNotInstalledUrl&&null!==e.sketchupNotInstalledUrl&&e.hasOwnProperty("sketchupNotInstalledUrl")&&(r.sketchupNotInstalledUrl=o[24].toObject(e.sketchupNotInstalledUrl,t)),void 0!==e.sketchupErrorUrl&&null!==e.sketchupErrorUrl&&e.hasOwnProperty("sketchupErrorUrl")&&(r.sketchupErrorUrl=o[25].toObject(e.sketchupErrorUrl,t)),void 0!==e.freeLicenseUrl&&null!==e.freeLicenseUrl&&e.hasOwnProperty("freeLicenseUrl")&&(r.freeLicenseUrl=o[26].toObject(e.freeLicenseUrl,t)),void 0!==e.proLicenseUrl&&null!==e.proLicenseUrl&&e.hasOwnProperty("proLicenseUrl")&&(r.proLicenseUrl=o[27].toObject(e.proLicenseUrl,t)),void 0!==e.tutorialUrl&&null!==e.tutorialUrl&&e.hasOwnProperty("tutorialUrl")&&(r.tutorialUrl=o[28].toObject(e.tutorialUrl,t)),void 0!==e.keyboardShortcutsUrl&&null!==e.keyboardShortcutsUrl&&e.hasOwnProperty("keyboardShortcutsUrl")&&(r.keyboardShortcutsUrl=o[29].toObject(e.keyboardShortcutsUrl,t)),void 0!==e.releaseNotesUrl&&null!==e.releaseNotesUrl&&e.hasOwnProperty("releaseNotesUrl")&&(r.releaseNotesUrl=o[30].toObject(e.releaseNotesUrl,t)),void 0!==e.hideUserData&&null!==e.hideUserData&&e.hasOwnProperty("hideUserData")&&(r.hideUserData=e.hideUserData),void 0!==e.useGeLogo&&null!==e.useGeLogo&&e.hasOwnProperty("useGeLogo")&&(r.useGeLogo=e.useGeLogo),void 0!==e.dioramaDescriptionUrlBase&&null!==e.dioramaDescriptionUrlBase&&e.hasOwnProperty("dioramaDescriptionUrlBase")&&(r.dioramaDescriptionUrlBase=o[33].toObject(e.dioramaDescriptionUrlBase,t)),void 0!==e.dioramaDefaultColor&&null!==e.dioramaDefaultColor&&e.hasOwnProperty("dioramaDefaultColor")&&(r.dioramaDefaultColor=e.dioramaDefaultColor),void 0!==e.dioramaBlacklistUrl&&null!==e.dioramaBlacklistUrl&&e.hasOwnProperty("dioramaBlacklistUrl")&&(r.dioramaBlacklistUrl=o[35].toObject(e.dioramaBlacklistUrl,t)),void 0!==e.clientOptions&&null!==e.clientOptions&&e.hasOwnProperty("clientOptions")&&(r.clientOptions=o[36].toObject(e.clientOptions,t)),void 0!==e.fetchingOptions&&null!==e.fetchingOptions&&e.hasOwnProperty("fetchingOptions")&&(r.fetchingOptions=o[37].toObject(e.fetchingOptions,t)),void 0!==e.timeMachineOptions&&null!==e.timeMachineOptions&&e.hasOwnProperty("timeMachineOptions")&&(r.timeMachineOptions=o[38].toObject(e.timeMachineOptions,t)),void 0!==e.csiOptions&&null!==e.csiOptions&&e.hasOwnProperty("csiOptions")&&(r.csiOptions=o[39].toObject(e.csiOptions,t)),void 0!==e.searchTab&&null!==e.searchTab&&e.hasOwnProperty("searchTab"))for(r.searchTab=[],i=0;i<e.searchTab.length;++i)r.searchTab[i]=o[40].toObject(e.searchTab[i],t);if(void 0!==e.cobrandInfo&&null!==e.cobrandInfo&&e.hasOwnProperty("cobrandInfo"))for(r.cobrandInfo=[],i=0;i<e.cobrandInfo.length;++i)r.cobrandInfo[i]=o[41].toObject(e.cobrandInfo[i],t);if(void 0!==e.validDatabase&&null!==e.validDatabase&&e.hasOwnProperty("validDatabase"))for(r.validDatabase=[],i=0;i<e.validDatabase.length;++i)r.validDatabase[i]=o[42].toObject(e.validDatabase[i],t);if(void 0!==e.configScript&&null!==e.configScript&&e.hasOwnProperty("configScript"))for(r.configScript=[],i=0;i<e.configScript.length;++i)r.configScript[i]=o[43].toObject(e.configScript[i],t);if(void 0!==e.deauthServerUrl&&null!==e.deauthServerUrl&&e.hasOwnProperty("deauthServerUrl")&&(r.deauthServerUrl=o[44].toObject(e.deauthServerUrl,t)),void 0!==e.swoopParameters&&null!==e.swoopParameters&&e.hasOwnProperty("swoopParameters")&&(r.swoopParameters=o[45].toObject(e.swoopParameters,t)),void 0!==e.bbsServerInfo&&null!==e.bbsServerInfo&&e.hasOwnProperty("bbsServerInfo")&&(r.bbsServerInfo=o[46].toObject(e.bbsServerInfo,t)),void 0!==e.dataErrorServerInfo&&null!==e.dataErrorServerInfo&&e.hasOwnProperty("dataErrorServerInfo")&&(r.dataErrorServerInfo=o[47].toObject(e.dataErrorServerInfo,t)),void 0!==e.planetaryDatabase&&null!==e.planetaryDatabase&&e.hasOwnProperty("planetaryDatabase"))for(r.planetaryDatabase=[],i=0;i<e.planetaryDatabase.length;++i)r.planetaryDatabase[i]=o[48].toObject(e.planetaryDatabase[i],t);if(void 0!==e.logServer&&null!==e.logServer&&e.hasOwnProperty("logServer")&&(r.logServer=o[49].toObject(e.logServer,t)),void 0!==e.autopiaOptions&&null!==e.autopiaOptions&&e.hasOwnProperty("autopiaOptions")&&(r.autopiaOptions=o[50].toObject(e.autopiaOptions,t)),void 0!==e.searchConfig&&null!==e.searchConfig&&e.hasOwnProperty("searchConfig")&&(r.searchConfig=o[51].toObject(e.searchConfig,t)),void 0!==e.searchInfo&&null!==e.searchInfo&&e.hasOwnProperty("searchInfo")&&(r.searchInfo=o[52].toObject(e.searchInfo,t)),void 0!==e.elevationServiceBaseUrl&&null!==e.elevationServiceBaseUrl&&e.hasOwnProperty("elevationServiceBaseUrl")&&(r.elevationServiceBaseUrl=e.elevationServiceBaseUrl),void 0!==e.elevationProfileQueryDelay&&null!==e.elevationProfileQueryDelay&&e.hasOwnProperty("elevationProfileQueryDelay")&&(r.elevationProfileQueryDelay=e.elevationProfileQueryDelay),void 0!==e.proUpgradeUrl&&null!==e.proUpgradeUrl&&e.hasOwnProperty("proUpgradeUrl")&&(r.proUpgradeUrl=o[55].toObject(e.proUpgradeUrl,t)),void 0!==e.earthCommunityUrl&&null!==e.earthCommunityUrl&&e.hasOwnProperty("earthCommunityUrl")&&(r.earthCommunityUrl=o[56].toObject(e.earthCommunityUrl,t)),void 0!==e.googleMapsUrl&&null!==e.googleMapsUrl&&e.hasOwnProperty("googleMapsUrl")&&(r.googleMapsUrl=o[57].toObject(e.googleMapsUrl,t)),void 0!==e.sharingUrl&&null!==e.sharingUrl&&e.hasOwnProperty("sharingUrl")&&(r.sharingUrl=o[58].toObject(e.sharingUrl,t)),void 0!==e.privacyPolicyUrl&&null!==e.privacyPolicyUrl&&e.hasOwnProperty("privacyPolicyUrl")&&(r.privacyPolicyUrl=o[59].toObject(e.privacyPolicyUrl,t)),void 0!==e.doGplusUserCheck&&null!==e.doGplusUserCheck&&e.hasOwnProperty("doGplusUserCheck")&&(r.doGplusUserCheck=e.doGplusUserCheck),void 0!==e.rocktreeDataProto&&null!==e.rocktreeDataProto&&e.hasOwnProperty("rocktreeDataProto")&&(r.rocktreeDataProto=o[61].toObject(e.rocktreeDataProto,t)),void 0!==e.filmstripConfig&&null!==e.filmstripConfig&&e.hasOwnProperty("filmstripConfig"))for(r.filmstripConfig=[],i=0;i<e.filmstripConfig.length;++i)r.filmstripConfig[i]=o[62].toObject(e.filmstripConfig[i],t);return void 0!==e.showSigninButton&&null!==e.showSigninButton&&e.hasOwnProperty("showSigninButton")&&(r.showSigninButton=e.showSigninButton),void 0!==e.proMeasureUpsellUrl&&null!==e.proMeasureUpsellUrl&&e.hasOwnProperty("proMeasureUpsellUrl")&&(r.proMeasureUpsellUrl=o[64].toObject(e.proMeasureUpsellUrl,t)),void 0!==e.proPrintUpsellUrl&&null!==e.proPrintUpsellUrl&&e.hasOwnProperty("proPrintUpsellUrl")&&(r.proPrintUpsellUrl=o[65].toObject(e.proPrintUpsellUrl,t)),void 0!==e.starDataProto&&null!==e.starDataProto&&e.hasOwnProperty("starDataProto")&&(r.starDataProto=o[66].toObject(e.starDataProto,t)),void 0!==e.feedbackUrl&&null!==e.feedbackUrl&&e.hasOwnProperty("feedbackUrl")&&(r.feedbackUrl=o[67].toObject(e.feedbackUrl,t)),void 0!==e.oauth2LoginUrl&&null!==e.oauth2LoginUrl&&e.hasOwnProperty("oauth2LoginUrl")&&(r.oauth2LoginUrl=o[68].toObject(e.oauth2LoginUrl,t)),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.SearchConfigProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.searchServer=s.emptyArray,e.prototype.oneboxService=s.emptyArray,e.prototype.kmlSearchUrl=null,e.prototype.kmlRenderUrl=null,e.prototype.searchHistoryUrl=null,e.prototype.errorPageUrl=null;var o={0:"keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer",1:"keyhole.dbroot.EndSnippetProto.SearchConfigProto.OneboxServiceProto",2:"keyhole.dbroot.StringIdOrValueProto",3:"keyhole.dbroot.StringIdOrValueProto",4:"keyhole.dbroot.StringIdOrValueProto",5:"keyhole.dbroot.StringIdOrValueProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.EndSnippetProto.SearchConfigProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.searchServer&&i.searchServer.length||(i.searchServer=[]),i.searchServer.push(o[0].decode(e,e.uint32()));break;case 2:i.oneboxService&&i.oneboxService.length||(i.oneboxService=[]),i.oneboxService.push(o[1].decode(e,e.uint32()));break;case 3:i.kmlSearchUrl=o[2].decode(e,e.uint32());break;case 4:i.kmlRenderUrl=o[3].decode(e,e.uint32());break;case 6:i.searchHistoryUrl=o[4].decode(e,e.uint32());break;case 5:i.errorPageUrl=o[5].decode(e,e.uint32());break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(void 0!==e.searchServer){if(!Array.isArray(e.searchServer))return"searchServer: array expected";for(var t=0;t<e.searchServer.length;++t)if(r=o[0].verify(e.searchServer[t]))return"searchServer."+r}if(void 0!==e.oneboxService){if(!Array.isArray(e.oneboxService))return"oneboxService: array expected";for(t=0;t<e.oneboxService.length;++t)if(r=o[1].verify(e.oneboxService[t]))return"oneboxService."+r}var r;return void 0!==e.kmlSearchUrl&&null!==e.kmlSearchUrl&&(r=o[2].verify(e.kmlSearchUrl))?"kmlSearchUrl."+r:void 0!==e.kmlRenderUrl&&null!==e.kmlRenderUrl&&(r=o[3].verify(e.kmlRenderUrl))?"kmlRenderUrl."+r:void 0!==e.searchHistoryUrl&&null!==e.searchHistoryUrl&&(r=o[4].verify(e.searchHistoryUrl))?"searchHistoryUrl."+r:void 0!==e.errorPageUrl&&null!==e.errorPageUrl&&(r=o[5].verify(e.errorPageUrl))?"errorPageUrl."+r:null},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.EndSnippetProto.SearchConfigProto)return e;var t=new u.keyhole.dbroot.EndSnippetProto.SearchConfigProto;if(e.searchServer){if(!Array.isArray(e.searchServer))throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.searchServer: array expected");t.searchServer=[];for(var r=0;r<e.searchServer.length;++r){if("object"!=typeof e.searchServer[r])throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.searchServer: object expected");t.searchServer[r]=o[0].fromObject(e.searchServer[r])}}if(e.oneboxService){if(!Array.isArray(e.oneboxService))throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.oneboxService: array expected");for(t.oneboxService=[],r=0;r<e.oneboxService.length;++r){if("object"!=typeof e.oneboxService[r])throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.oneboxService: object expected");t.oneboxService[r]=o[1].fromObject(e.oneboxService[r])}}if(void 0!==e.kmlSearchUrl&&null!==e.kmlSearchUrl){if("object"!=typeof e.kmlSearchUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.kmlSearchUrl: object expected");t.kmlSearchUrl=o[2].fromObject(e.kmlSearchUrl)}if(void 0!==e.kmlRenderUrl&&null!==e.kmlRenderUrl){if("object"!=typeof e.kmlRenderUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.kmlRenderUrl: object expected");t.kmlRenderUrl=o[3].fromObject(e.kmlRenderUrl)}if(void 0!==e.searchHistoryUrl&&null!==e.searchHistoryUrl){if("object"!=typeof e.searchHistoryUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.searchHistoryUrl: object expected");t.searchHistoryUrl=o[4].fromObject(e.searchHistoryUrl)}if(void 0!==e.errorPageUrl&&null!==e.errorPageUrl){if("object"!=typeof e.errorPageUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.errorPageUrl: object expected");t.errorPageUrl=o[5].fromObject(e.errorPageUrl)}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.searchServer=[],r.oneboxService=[]),t.defaults&&(r.kmlSearchUrl=null,r.kmlRenderUrl=null,r.searchHistoryUrl=null,r.errorPageUrl=null),void 0!==e.searchServer&&null!==e.searchServer&&e.hasOwnProperty("searchServer")){r.searchServer=[];for(var i=0;i<e.searchServer.length;++i)r.searchServer[i]=o[0].toObject(e.searchServer[i],t)}if(void 0!==e.oneboxService&&null!==e.oneboxService&&e.hasOwnProperty("oneboxService"))for(r.oneboxService=[],i=0;i<e.oneboxService.length;++i)r.oneboxService[i]=o[1].toObject(e.oneboxService[i],t);return void 0!==e.kmlSearchUrl&&null!==e.kmlSearchUrl&&e.hasOwnProperty("kmlSearchUrl")&&(r.kmlSearchUrl=o[2].toObject(e.kmlSearchUrl,t)),void 0!==e.kmlRenderUrl&&null!==e.kmlRenderUrl&&e.hasOwnProperty("kmlRenderUrl")&&(r.kmlRenderUrl=o[3].toObject(e.kmlRenderUrl,t)),void 0!==e.searchHistoryUrl&&null!==e.searchHistoryUrl&&e.hasOwnProperty("searchHistoryUrl")&&(r.searchHistoryUrl=o[4].toObject(e.searchHistoryUrl,t)),void 0!==e.errorPageUrl&&null!==e.errorPageUrl&&e.hasOwnProperty("errorPageUrl")&&(r.errorPageUrl=o[5].toObject(e.errorPageUrl,t)),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.SearchServer=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.name=null,e.prototype.url=null,e.prototype.type=0,e.prototype.htmlTransformUrl=null,e.prototype.kmlTransformUrl=null,e.prototype.supplementalUi=null,e.prototype.suggestion=s.emptyArray,e.prototype.searchlet=s.emptyArray,e.prototype.requirements=null,e.prototype.suggestServer=null;var t,o={0:"keyhole.dbroot.StringIdOrValueProto",1:"keyhole.dbroot.StringIdOrValueProto",2:"keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.ResultType",3:"keyhole.dbroot.StringIdOrValueProto",4:"keyhole.dbroot.StringIdOrValueProto",5:"keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SupplementalUi",6:"keyhole.dbroot.StringIdOrValueProto",7:"keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SearchletProto",8:"keyhole.dbroot.RequirementProto",9:"keyhole.dbroot.StringIdOrValueProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.name=o[0].decode(e,e.uint32());break;case 2:i.url=o[1].decode(e,e.uint32());break;case 3:i.type=e.uint32();break;case 4:i.htmlTransformUrl=o[3].decode(e,e.uint32());break;case 5:i.kmlTransformUrl=o[4].decode(e,e.uint32());break;case 6:i.supplementalUi=o[5].decode(e,e.uint32());break;case 9:i.suggestion&&i.suggestion.length||(i.suggestion=[]),i.suggestion.push(o[6].decode(e,e.uint32()));break;case 7:i.searchlet&&i.searchlet.length||(i.searchlet=[]),i.searchlet.push(o[7].decode(e,e.uint32()));break;case 8:i.requirements=o[8].decode(e,e.uint32());break;case 10:i.suggestServer=o[9].decode(e,e.uint32());break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(void 0!==e.name&&null!==e.name&&(r=o[0].verify(e.name)))return"name."+r;if(void 0!==e.url&&null!==e.url&&(r=o[1].verify(e.url)))return"url."+r;if(void 0!==e.type)switch(e.type){default:return"type: enum value expected";case 0:case 1:}if(void 0!==e.htmlTransformUrl&&null!==e.htmlTransformUrl&&(r=o[3].verify(e.htmlTransformUrl)))return"htmlTransformUrl."+r;if(void 0!==e.kmlTransformUrl&&null!==e.kmlTransformUrl&&(r=o[4].verify(e.kmlTransformUrl)))return"kmlTransformUrl."+r;if(void 0!==e.supplementalUi&&null!==e.supplementalUi&&(r=o[5].verify(e.supplementalUi)))return"supplementalUi."+r;if(void 0!==e.suggestion){if(!Array.isArray(e.suggestion))return"suggestion: array expected";for(var t=0;t<e.suggestion.length;++t)if(r=o[6].verify(e.suggestion[t]))return"suggestion."+r}if(void 0!==e.searchlet){if(!Array.isArray(e.searchlet))return"searchlet: array expected";for(t=0;t<e.searchlet.length;++t){var r;if(r=o[7].verify(e.searchlet[t]))return"searchlet."+r}}return void 0!==e.requirements&&null!==e.requirements&&(r=o[8].verify(e.requirements))?"requirements."+r:void 0!==e.suggestServer&&null!==e.suggestServer&&(r=o[9].verify(e.suggestServer))?"suggestServer."+r:null},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer)return e;var t=new u.keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer;if(void 0!==e.name&&null!==e.name){if("object"!=typeof e.name)throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.name: object expected");t.name=o[0].fromObject(e.name)}if(void 0!==e.url&&null!==e.url){if("object"!=typeof e.url)throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.url: object expected");t.url=o[1].fromObject(e.url)}switch(e.type){case"RESULT_TYPE_KML":case 0:t.type=0;break;case"RESULT_TYPE_XML":case 1:t.type=1}if(void 0!==e.htmlTransformUrl&&null!==e.htmlTransformUrl){if("object"!=typeof e.htmlTransformUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.htmlTransformUrl: object expected");t.htmlTransformUrl=o[3].fromObject(e.htmlTransformUrl)}if(void 0!==e.kmlTransformUrl&&null!==e.kmlTransformUrl){if("object"!=typeof e.kmlTransformUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.kmlTransformUrl: object expected");t.kmlTransformUrl=o[4].fromObject(e.kmlTransformUrl)}if(void 0!==e.supplementalUi&&null!==e.supplementalUi){if("object"!=typeof e.supplementalUi)throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.supplementalUi: object expected");t.supplementalUi=o[5].fromObject(e.supplementalUi)}if(e.suggestion){if(!Array.isArray(e.suggestion))throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.suggestion: array expected");t.suggestion=[];for(var r=0;r<e.suggestion.length;++r){if("object"!=typeof e.suggestion[r])throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.suggestion: object expected");t.suggestion[r]=o[6].fromObject(e.suggestion[r])}}if(e.searchlet){if(!Array.isArray(e.searchlet))throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.searchlet: array expected");for(t.searchlet=[],r=0;r<e.searchlet.length;++r){if("object"!=typeof e.searchlet[r])throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.searchlet: object expected");t.searchlet[r]=o[7].fromObject(e.searchlet[r])}}if(void 0!==e.requirements&&null!==e.requirements){if("object"!=typeof e.requirements)throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.requirements: object expected");t.requirements=o[8].fromObject(e.requirements)}if(void 0!==e.suggestServer&&null!==e.suggestServer){if("object"!=typeof e.suggestServer)throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.suggestServer: object expected");t.suggestServer=o[9].fromObject(e.suggestServer)}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.suggestion=[],r.searchlet=[]),t.defaults&&(r.name=null,r.url=null,r.type=t.enums===String?"RESULT_TYPE_KML":0,r.htmlTransformUrl=null,r.kmlTransformUrl=null,r.supplementalUi=null,r.requirements=null,r.suggestServer=null),void 0!==e.name&&null!==e.name&&e.hasOwnProperty("name")&&(r.name=o[0].toObject(e.name,t)),void 0!==e.url&&null!==e.url&&e.hasOwnProperty("url")&&(r.url=o[1].toObject(e.url,t)),void 0!==e.type&&null!==e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?o[2][e.type]:e.type),void 0!==e.htmlTransformUrl&&null!==e.htmlTransformUrl&&e.hasOwnProperty("htmlTransformUrl")&&(r.htmlTransformUrl=o[3].toObject(e.htmlTransformUrl,t)),void 0!==e.kmlTransformUrl&&null!==e.kmlTransformUrl&&e.hasOwnProperty("kmlTransformUrl")&&(r.kmlTransformUrl=o[4].toObject(e.kmlTransformUrl,t)),void 0!==e.supplementalUi&&null!==e.supplementalUi&&e.hasOwnProperty("supplementalUi")&&(r.supplementalUi=o[5].toObject(e.supplementalUi,t)),void 0!==e.suggestion&&null!==e.suggestion&&e.hasOwnProperty("suggestion")){r.suggestion=[];for(var i=0;i<e.suggestion.length;++i)r.suggestion[i]=o[6].toObject(e.suggestion[i],t)}if(void 0!==e.searchlet&&null!==e.searchlet&&e.hasOwnProperty("searchlet"))for(r.searchlet=[],i=0;i<e.searchlet.length;++i)r.searchlet[i]=o[7].toObject(e.searchlet[i],t);return void 0!==e.requirements&&null!==e.requirements&&e.hasOwnProperty("requirements")&&(r.requirements=o[8].toObject(e.requirements,t)),void 0!==e.suggestServer&&null!==e.suggestServer&&e.hasOwnProperty("suggestServer")&&(r.suggestServer=o[9].toObject(e.suggestServer,t)),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.ResultType=((t=Object.create({})).RESULT_TYPE_KML=0,t.RESULT_TYPE_XML=1,t),e.SupplementalUi=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.url=null,e.prototype.label=null,e.prototype.height=160;var o={0:"keyhole.dbroot.StringIdOrValueProto",1:"keyhole.dbroot.StringIdOrValueProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SupplementalUi;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.url=o[0].decode(e,e.uint32());break;case 2:i.label=o[1].decode(e,e.uint32());break;case 3:i.height=e.int32();break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":void 0!==e.url&&null!==e.url&&(t=o[0].verify(e.url))?"url."+t:void 0!==e.label&&null!==e.label&&(t=o[1].verify(e.label))?"label."+t:void 0===e.height||s.isInteger(e.height)?null:"height: integer expected";var t},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SupplementalUi)return e;var t=new u.keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SupplementalUi;if(void 0!==e.url&&null!==e.url){if("object"!=typeof e.url)throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SupplementalUi.url: object expected");t.url=o[0].fromObject(e.url)}if(void 0!==e.label&&null!==e.label){if("object"!=typeof e.label)throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SupplementalUi.label: object expected");t.label=o[1].fromObject(e.label)}return void 0!==e.height&&null!==e.height&&(t.height=0|e.height),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.url=null,r.label=null,r.height=160),void 0!==e.url&&null!==e.url&&e.hasOwnProperty("url")&&(r.url=o[0].toObject(e.url,t)),void 0!==e.label&&null!==e.label&&e.hasOwnProperty("label")&&(r.label=o[1].toObject(e.label,t)),void 0!==e.height&&null!==e.height&&e.hasOwnProperty("height")&&(r.height=e.height),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.SearchletProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.url=null,e.prototype.name=null,e.prototype.requirements=null;var o={0:"keyhole.dbroot.StringIdOrValueProto",1:"keyhole.dbroot.StringIdOrValueProto",2:"keyhole.dbroot.RequirementProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SearchletProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.url=o[0].decode(e,e.uint32());break;case 2:i.name=o[1].decode(e,e.uint32());break;case 3:i.requirements=o[2].decode(e,e.uint32());break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":void 0!==e.url&&null!==e.url&&(t=o[0].verify(e.url))?"url."+t:void 0!==e.name&&null!==e.name&&(t=o[1].verify(e.name))?"name."+t:void 0!==e.requirements&&null!==e.requirements&&(t=o[2].verify(e.requirements))?"requirements."+t:null;var t},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SearchletProto)return e;var t=new u.keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SearchletProto;if(void 0!==e.url&&null!==e.url){if("object"!=typeof e.url)throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SearchletProto.url: object expected");t.url=o[0].fromObject(e.url)}if(void 0!==e.name&&null!==e.name){if("object"!=typeof e.name)throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SearchletProto.name: object expected");t.name=o[1].fromObject(e.name)}if(void 0!==e.requirements&&null!==e.requirements){if("object"!=typeof e.requirements)throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SearchletProto.requirements: object expected");t.requirements=o[2].fromObject(e.requirements)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.url=null,r.name=null,r.requirements=null),void 0!==e.url&&null!==e.url&&e.hasOwnProperty("url")&&(r.url=o[0].toObject(e.url,t)),void 0!==e.name&&null!==e.name&&e.hasOwnProperty("name")&&(r.name=o[1].toObject(e.name,t)),void 0!==e.requirements&&null!==e.requirements&&e.hasOwnProperty("requirements")&&(r.requirements=o[2].toObject(e.requirements,t)),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e}(),e.OneboxServiceProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.serviceUrl=null,e.prototype.requirements=null;var o={0:"keyhole.dbroot.StringIdOrValueProto",1:"keyhole.dbroot.RequirementProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.EndSnippetProto.SearchConfigProto.OneboxServiceProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.serviceUrl=o[0].decode(e,e.uint32());break;case 2:i.requirements=o[1].decode(e,e.uint32());break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":void 0!==e.serviceUrl&&null!==e.serviceUrl&&(t=o[0].verify(e.serviceUrl))?"serviceUrl."+t:void 0!==e.requirements&&null!==e.requirements&&(t=o[1].verify(e.requirements))?"requirements."+t:null;var t},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.EndSnippetProto.SearchConfigProto.OneboxServiceProto)return e;var t=new u.keyhole.dbroot.EndSnippetProto.SearchConfigProto.OneboxServiceProto;if(void 0!==e.serviceUrl&&null!==e.serviceUrl){if("object"!=typeof e.serviceUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.OneboxServiceProto.serviceUrl: object expected");t.serviceUrl=o[0].fromObject(e.serviceUrl)}if(void 0!==e.requirements&&null!==e.requirements){if("object"!=typeof e.requirements)throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.OneboxServiceProto.requirements: object expected");t.requirements=o[1].fromObject(e.requirements)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.serviceUrl=null,r.requirements=null),void 0!==e.serviceUrl&&null!==e.serviceUrl&&e.hasOwnProperty("serviceUrl")&&(r.serviceUrl=o[0].toObject(e.serviceUrl,t)),void 0!==e.requirements&&null!==e.requirements&&e.hasOwnProperty("requirements")&&(r.requirements=o[1].toObject(e.requirements,t)),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e}(),e.SearchInfoProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}return e.prototype.defaultUrl="http://maps.google.com/maps",e.prototype.geocodeParam="q",e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.EndSnippetProto.SearchInfoProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.defaultUrl=e.string();break;case 2:i.geocodeParam=e.string();break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":void 0===e.defaultUrl||s.isString(e.defaultUrl)?void 0===e.geocodeParam||s.isString(e.geocodeParam)?null:"geocodeParam: string expected":"defaultUrl: string expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.EndSnippetProto.SearchInfoProto)return e;var t=new u.keyhole.dbroot.EndSnippetProto.SearchInfoProto;return void 0!==e.defaultUrl&&null!==e.defaultUrl&&(t.defaultUrl=String(e.defaultUrl)),void 0!==e.geocodeParam&&null!==e.geocodeParam&&(t.geocodeParam=String(e.geocodeParam)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.defaultUrl="http://maps.google.com/maps",r.geocodeParam="q"),void 0!==e.defaultUrl&&null!==e.defaultUrl&&e.hasOwnProperty("defaultUrl")&&(r.defaultUrl=e.defaultUrl),void 0!==e.geocodeParam&&null!==e.geocodeParam&&e.hasOwnProperty("geocodeParam")&&(r.geocodeParam=e.geocodeParam),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.RockTreeDataProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.url=null;var o={0:"keyhole.dbroot.StringIdOrValueProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.EndSnippetProto.RockTreeDataProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.url=o[0].decode(e,e.uint32());break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(void 0!==e.url&&null!==e.url){var t=o[0].verify(e.url);if(t)return"url."+t}return null},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.EndSnippetProto.RockTreeDataProto)return e;var t=new u.keyhole.dbroot.EndSnippetProto.RockTreeDataProto;if(void 0!==e.url&&null!==e.url){if("object"!=typeof e.url)throw TypeError(".keyhole.dbroot.EndSnippetProto.RockTreeDataProto.url: object expected");t.url=o[0].fromObject(e.url)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.url=null),void 0!==e.url&&null!==e.url&&e.hasOwnProperty("url")&&(r.url=o[0].toObject(e.url,t)),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.FilmstripConfigProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.requirements=null,e.prototype.alleycatUrlTemplate=null,e.prototype.fallbackAlleycatUrlTemplate=null,e.prototype.metadataUrlTemplate=null,e.prototype.thumbnailUrlTemplate=null,e.prototype.kmlUrlTemplate=null,e.prototype.featuredToursUrl=null,e.prototype.enableViewportFallback=!1,e.prototype.viewportFallbackDistance=0,e.prototype.imageryType=s.emptyArray;var o={0:"keyhole.dbroot.RequirementProto",1:"keyhole.dbroot.StringIdOrValueProto",2:"keyhole.dbroot.StringIdOrValueProto",3:"keyhole.dbroot.StringIdOrValueProto",4:"keyhole.dbroot.StringIdOrValueProto",5:"keyhole.dbroot.StringIdOrValueProto",6:"keyhole.dbroot.StringIdOrValueProto",9:"keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.AlleycatImageryTypeProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.EndSnippetProto.FilmstripConfigProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.requirements=o[0].decode(e,e.uint32());break;case 2:i.alleycatUrlTemplate=o[1].decode(e,e.uint32());break;case 9:i.fallbackAlleycatUrlTemplate=o[2].decode(e,e.uint32());break;case 3:i.metadataUrlTemplate=o[3].decode(e,e.uint32());break;case 4:i.thumbnailUrlTemplate=o[4].decode(e,e.uint32());break;case 5:i.kmlUrlTemplate=o[5].decode(e,e.uint32());break;case 6:i.featuredToursUrl=o[6].decode(e,e.uint32());break;case 7:i.enableViewportFallback=e.bool();break;case 8:i.viewportFallbackDistance=e.uint32();break;case 10:i.imageryType&&i.imageryType.length||(i.imageryType=[]),i.imageryType.push(o[9].decode(e,e.uint32()));break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(void 0!==e.requirements&&null!==e.requirements&&(r=o[0].verify(e.requirements)))return"requirements."+r;if(void 0!==e.alleycatUrlTemplate&&null!==e.alleycatUrlTemplate&&(r=o[1].verify(e.alleycatUrlTemplate)))return"alleycatUrlTemplate."+r;if(void 0!==e.fallbackAlleycatUrlTemplate&&null!==e.fallbackAlleycatUrlTemplate&&(r=o[2].verify(e.fallbackAlleycatUrlTemplate)))return"fallbackAlleycatUrlTemplate."+r;if(void 0!==e.metadataUrlTemplate&&null!==e.metadataUrlTemplate&&(r=o[3].verify(e.metadataUrlTemplate)))return"metadataUrlTemplate."+r;if(void 0!==e.thumbnailUrlTemplate&&null!==e.thumbnailUrlTemplate&&(r=o[4].verify(e.thumbnailUrlTemplate)))return"thumbnailUrlTemplate."+r;if(void 0!==e.kmlUrlTemplate&&null!==e.kmlUrlTemplate&&(r=o[5].verify(e.kmlUrlTemplate)))return"kmlUrlTemplate."+r;if(void 0!==e.featuredToursUrl&&null!==e.featuredToursUrl&&(r=o[6].verify(e.featuredToursUrl)))return"featuredToursUrl."+r;if(void 0!==e.enableViewportFallback&&"boolean"!=typeof e.enableViewportFallback)return"enableViewportFallback: boolean expected";if(void 0!==e.viewportFallbackDistance&&!s.isInteger(e.viewportFallbackDistance))return"viewportFallbackDistance: integer expected";if(void 0!==e.imageryType){if(!Array.isArray(e.imageryType))return"imageryType: array expected";for(var t=0;t<e.imageryType.length;++t){var r;if(r=o[9].verify(e.imageryType[t]))return"imageryType."+r}}return null},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.EndSnippetProto.FilmstripConfigProto)return e;var t=new u.keyhole.dbroot.EndSnippetProto.FilmstripConfigProto;if(void 0!==e.requirements&&null!==e.requirements){if("object"!=typeof e.requirements)throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.requirements: object expected");t.requirements=o[0].fromObject(e.requirements)}if(void 0!==e.alleycatUrlTemplate&&null!==e.alleycatUrlTemplate){if("object"!=typeof e.alleycatUrlTemplate)throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.alleycatUrlTemplate: object expected");t.alleycatUrlTemplate=o[1].fromObject(e.alleycatUrlTemplate)}if(void 0!==e.fallbackAlleycatUrlTemplate&&null!==e.fallbackAlleycatUrlTemplate){if("object"!=typeof e.fallbackAlleycatUrlTemplate)throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.fallbackAlleycatUrlTemplate: object expected");t.fallbackAlleycatUrlTemplate=o[2].fromObject(e.fallbackAlleycatUrlTemplate)}if(void 0!==e.metadataUrlTemplate&&null!==e.metadataUrlTemplate){if("object"!=typeof e.metadataUrlTemplate)throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.metadataUrlTemplate: object expected");t.metadataUrlTemplate=o[3].fromObject(e.metadataUrlTemplate)}if(void 0!==e.thumbnailUrlTemplate&&null!==e.thumbnailUrlTemplate){if("object"!=typeof e.thumbnailUrlTemplate)throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.thumbnailUrlTemplate: object expected");t.thumbnailUrlTemplate=o[4].fromObject(e.thumbnailUrlTemplate)}if(void 0!==e.kmlUrlTemplate&&null!==e.kmlUrlTemplate){if("object"!=typeof e.kmlUrlTemplate)throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.kmlUrlTemplate: object expected");t.kmlUrlTemplate=o[5].fromObject(e.kmlUrlTemplate)}if(void 0!==e.featuredToursUrl&&null!==e.featuredToursUrl){if("object"!=typeof e.featuredToursUrl)throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.featuredToursUrl: object expected");t.featuredToursUrl=o[6].fromObject(e.featuredToursUrl)}if(void 0!==e.enableViewportFallback&&null!==e.enableViewportFallback&&(t.enableViewportFallback=Boolean(e.enableViewportFallback)),void 0!==e.viewportFallbackDistance&&null!==e.viewportFallbackDistance&&(t.viewportFallbackDistance=e.viewportFallbackDistance>>>0),e.imageryType){if(!Array.isArray(e.imageryType))throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.imageryType: array expected");t.imageryType=[];for(var r=0;r<e.imageryType.length;++r){if("object"!=typeof e.imageryType[r])throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.imageryType: object expected");t.imageryType[r]=o[9].fromObject(e.imageryType[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.imageryType=[]),t.defaults&&(r.requirements=null,r.alleycatUrlTemplate=null,r.fallbackAlleycatUrlTemplate=null,r.metadataUrlTemplate=null,r.thumbnailUrlTemplate=null,r.kmlUrlTemplate=null,r.featuredToursUrl=null,r.enableViewportFallback=!1,r.viewportFallbackDistance=0),void 0!==e.requirements&&null!==e.requirements&&e.hasOwnProperty("requirements")&&(r.requirements=o[0].toObject(e.requirements,t)),void 0!==e.alleycatUrlTemplate&&null!==e.alleycatUrlTemplate&&e.hasOwnProperty("alleycatUrlTemplate")&&(r.alleycatUrlTemplate=o[1].toObject(e.alleycatUrlTemplate,t)),void 0!==e.fallbackAlleycatUrlTemplate&&null!==e.fallbackAlleycatUrlTemplate&&e.hasOwnProperty("fallbackAlleycatUrlTemplate")&&(r.fallbackAlleycatUrlTemplate=o[2].toObject(e.fallbackAlleycatUrlTemplate,t)),void 0!==e.metadataUrlTemplate&&null!==e.metadataUrlTemplate&&e.hasOwnProperty("metadataUrlTemplate")&&(r.metadataUrlTemplate=o[3].toObject(e.metadataUrlTemplate,t)),void 0!==e.thumbnailUrlTemplate&&null!==e.thumbnailUrlTemplate&&e.hasOwnProperty("thumbnailUrlTemplate")&&(r.thumbnailUrlTemplate=o[4].toObject(e.thumbnailUrlTemplate,t)),void 0!==e.kmlUrlTemplate&&null!==e.kmlUrlTemplate&&e.hasOwnProperty("kmlUrlTemplate")&&(r.kmlUrlTemplate=o[5].toObject(e.kmlUrlTemplate,t)),void 0!==e.featuredToursUrl&&null!==e.featuredToursUrl&&e.hasOwnProperty("featuredToursUrl")&&(r.featuredToursUrl=o[6].toObject(e.featuredToursUrl,t)),void 0!==e.enableViewportFallback&&null!==e.enableViewportFallback&&e.hasOwnProperty("enableViewportFallback")&&(r.enableViewportFallback=e.enableViewportFallback),void 0!==e.viewportFallbackDistance&&null!==e.viewportFallbackDistance&&e.hasOwnProperty("viewportFallbackDistance")&&(r.viewportFallbackDistance=e.viewportFallbackDistance),void 0!==e.imageryType&&null!==e.imageryType&&e.hasOwnProperty("imageryType")){r.imageryType=[];for(var i=0;i<e.imageryType.length;++i)r.imageryType[i]=o[9].toObject(e.imageryType[i],t)}return r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.AlleycatImageryTypeProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.imageryTypeId=0,e.prototype.imageryTypeLabel="",e.prototype.metadataUrlTemplate=null,e.prototype.thumbnailUrlTemplate=null,e.prototype.kmlUrlTemplate=null;var o={2:"keyhole.dbroot.StringIdOrValueProto",3:"keyhole.dbroot.StringIdOrValueProto",4:"keyhole.dbroot.StringIdOrValueProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.AlleycatImageryTypeProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.imageryTypeId=e.int32();break;case 2:i.imageryTypeLabel=e.string();break;case 3:i.metadataUrlTemplate=o[2].decode(e,e.uint32());break;case 4:i.thumbnailUrlTemplate=o[3].decode(e,e.uint32());break;case 5:i.kmlUrlTemplate=o[4].decode(e,e.uint32());break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":void 0===e.imageryTypeId||s.isInteger(e.imageryTypeId)?void 0===e.imageryTypeLabel||s.isString(e.imageryTypeLabel)?void 0!==e.metadataUrlTemplate&&null!==e.metadataUrlTemplate&&(t=o[2].verify(e.metadataUrlTemplate))?"metadataUrlTemplate."+t:void 0!==e.thumbnailUrlTemplate&&null!==e.thumbnailUrlTemplate&&(t=o[3].verify(e.thumbnailUrlTemplate))?"thumbnailUrlTemplate."+t:void 0!==e.kmlUrlTemplate&&null!==e.kmlUrlTemplate&&(t=o[4].verify(e.kmlUrlTemplate))?"kmlUrlTemplate."+t:null:"imageryTypeLabel: string expected":"imageryTypeId: integer expected";var t},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.AlleycatImageryTypeProto)return e;var t=new u.keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.AlleycatImageryTypeProto;if(void 0!==e.imageryTypeId&&null!==e.imageryTypeId&&(t.imageryTypeId=0|e.imageryTypeId),void 0!==e.imageryTypeLabel&&null!==e.imageryTypeLabel&&(t.imageryTypeLabel=String(e.imageryTypeLabel)),void 0!==e.metadataUrlTemplate&&null!==e.metadataUrlTemplate){if("object"!=typeof e.metadataUrlTemplate)throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.AlleycatImageryTypeProto.metadataUrlTemplate: object expected");t.metadataUrlTemplate=o[2].fromObject(e.metadataUrlTemplate)}if(void 0!==e.thumbnailUrlTemplate&&null!==e.thumbnailUrlTemplate){if("object"!=typeof e.thumbnailUrlTemplate)throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.AlleycatImageryTypeProto.thumbnailUrlTemplate: object expected");t.thumbnailUrlTemplate=o[3].fromObject(e.thumbnailUrlTemplate)}if(void 0!==e.kmlUrlTemplate&&null!==e.kmlUrlTemplate){if("object"!=typeof e.kmlUrlTemplate)throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.AlleycatImageryTypeProto.kmlUrlTemplate: object expected");t.kmlUrlTemplate=o[4].fromObject(e.kmlUrlTemplate)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.imageryTypeId=0,r.imageryTypeLabel="",r.metadataUrlTemplate=null,r.thumbnailUrlTemplate=null,r.kmlUrlTemplate=null),void 0!==e.imageryTypeId&&null!==e.imageryTypeId&&e.hasOwnProperty("imageryTypeId")&&(r.imageryTypeId=e.imageryTypeId),void 0!==e.imageryTypeLabel&&null!==e.imageryTypeLabel&&e.hasOwnProperty("imageryTypeLabel")&&(r.imageryTypeLabel=e.imageryTypeLabel),void 0!==e.metadataUrlTemplate&&null!==e.metadataUrlTemplate&&e.hasOwnProperty("metadataUrlTemplate")&&(r.metadataUrlTemplate=o[2].toObject(e.metadataUrlTemplate,t)),void 0!==e.thumbnailUrlTemplate&&null!==e.thumbnailUrlTemplate&&e.hasOwnProperty("thumbnailUrlTemplate")&&(r.thumbnailUrlTemplate=o[3].toObject(e.thumbnailUrlTemplate,t)),void 0!==e.kmlUrlTemplate&&null!==e.kmlUrlTemplate&&e.hasOwnProperty("kmlUrlTemplate")&&(r.kmlUrlTemplate=o[4].toObject(e.kmlUrlTemplate,t)),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e}(),e.StarDataProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.url=null;var o={0:"keyhole.dbroot.StringIdOrValueProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.EndSnippetProto.StarDataProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.url=o[0].decode(e,e.uint32());break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(void 0!==e.url&&null!==e.url){var t=o[0].verify(e.url);if(t)return"url."+t}return null},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.EndSnippetProto.StarDataProto)return e;var t=new u.keyhole.dbroot.EndSnippetProto.StarDataProto;if(void 0!==e.url&&null!==e.url){if("object"!=typeof e.url)throw TypeError(".keyhole.dbroot.EndSnippetProto.StarDataProto.url: object expected");t.url=o[0].fromObject(e.url)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.url=null),void 0!==e.url&&null!==e.url&&e.hasOwnProperty("url")&&(r.url=o[0].toObject(e.url,t)),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e}(),e.DbRootRefProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.url="",e.prototype.isCritical=!1,e.prototype.requirements=null;var o={2:"keyhole.dbroot.RequirementProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.DbRootRefProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 2:i.url=e.string();break;case 1:i.isCritical=e.bool();break;case 3:i.requirements=o[2].decode(e,e.uint32());break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(!s.isString(e.url))return"url: string expected";if(void 0!==e.isCritical&&"boolean"!=typeof e.isCritical)return"isCritical: boolean expected";if(void 0!==e.requirements&&null!==e.requirements){var t=o[2].verify(e.requirements);if(t)return"requirements."+t}return null},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.DbRootRefProto)return e;var t=new u.keyhole.dbroot.DbRootRefProto;if(void 0!==e.url&&null!==e.url&&(t.url=String(e.url)),void 0!==e.isCritical&&null!==e.isCritical&&(t.isCritical=Boolean(e.isCritical)),void 0!==e.requirements&&null!==e.requirements){if("object"!=typeof e.requirements)throw TypeError(".keyhole.dbroot.DbRootRefProto.requirements: object expected");t.requirements=o[2].fromObject(e.requirements)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.url="",r.isCritical=!1,r.requirements=null),void 0!==e.url&&null!==e.url&&e.hasOwnProperty("url")&&(r.url=e.url),void 0!==e.isCritical&&null!==e.isCritical&&e.hasOwnProperty("isCritical")&&(r.isCritical=e.isCritical),void 0!==e.requirements&&null!==e.requirements&&e.hasOwnProperty("requirements")&&(r.requirements=o[2].toObject(e.requirements,t)),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.DatabaseVersionProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}return e.prototype.quadtreeVersion=0,e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.DatabaseVersionProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.quadtreeVersion=e.uint32();break;default:e.skipType(7&n)}}return i},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":s.isInteger(e.quadtreeVersion)?null:"quadtreeVersion: integer expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.DatabaseVersionProto)return e;var t=new u.keyhole.dbroot.DatabaseVersionProto;return void 0!==e.quadtreeVersion&&null!==e.quadtreeVersion&&(t.quadtreeVersion=e.quadtreeVersion>>>0),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.quadtreeVersion=0),void 0!==e.quadtreeVersion&&null!==e.quadtreeVersion&&e.hasOwnProperty("quadtreeVersion")&&(r.quadtreeVersion=e.quadtreeVersion),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.DbRootProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.databaseName=null,e.prototype.imageryPresent=!0,e.prototype.protoImagery=!1,e.prototype.terrainPresent=!1,e.prototype.providerInfo=s.emptyArray,e.prototype.nestedFeature=s.emptyArray,e.prototype.styleAttribute=s.emptyArray,e.prototype.styleMap=s.emptyArray,e.prototype.endSnippet=null,e.prototype.translationEntry=s.emptyArray,e.prototype.language="en",e.prototype.version=5,e.prototype.dbrootReference=s.emptyArray,e.prototype.databaseVersion=null,e.prototype.refreshTimeout=0;var o={0:"keyhole.dbroot.StringIdOrValueProto",4:"keyhole.dbroot.ProviderInfoProto",5:"keyhole.dbroot.NestedFeatureProto",6:"keyhole.dbroot.StyleAttributeProto",7:"keyhole.dbroot.StyleMapProto",8:"keyhole.dbroot.EndSnippetProto",9:"keyhole.dbroot.StringEntryProto",12:"keyhole.dbroot.DbRootRefProto",13:"keyhole.dbroot.DatabaseVersionProto"};return l.push(o),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.DbRootProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 15:i.databaseName=o[0].decode(e,e.uint32());break;case 1:i.imageryPresent=e.bool();break;case 14:i.protoImagery=e.bool();break;case 2:i.terrainPresent=e.bool();break;case 3:i.providerInfo&&i.providerInfo.length||(i.providerInfo=[]),i.providerInfo.push(o[4].decode(e,e.uint32()));break;case 4:i.nestedFeature&&i.nestedFeature.length||(i.nestedFeature=[]),i.nestedFeature.push(o[5].decode(e,e.uint32()));break;case 5:i.styleAttribute&&i.styleAttribute.length||(i.styleAttribute=[]),i.styleAttribute.push(o[6].decode(e,e.uint32()));break;case 6:i.styleMap&&i.styleMap.length||(i.styleMap=[]),i.styleMap.push(o[7].decode(e,e.uint32()));break;case 7:i.endSnippet=o[8].decode(e,e.uint32());break;case 8:i.translationEntry&&i.translationEntry.length||(i.translationEntry=[]),i.translationEntry.push(o[9].decode(e,e.uint32()));break;case 9:i.language=e.string();break;case 10:i.version=e.int32();break;case 11:i.dbrootReference&&i.dbrootReference.length||(i.dbrootReference=[]),i.dbrootReference.push(o[12].decode(e,e.uint32()));break;case 13:i.databaseVersion=o[13].decode(e,e.uint32());break;case 16:i.refreshTimeout=e.int32();break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(void 0!==e.databaseName&&null!==e.databaseName&&(r=o[0].verify(e.databaseName)))return"databaseName."+r;if(void 0!==e.imageryPresent&&"boolean"!=typeof e.imageryPresent)return"imageryPresent: boolean expected";if(void 0!==e.protoImagery&&"boolean"!=typeof e.protoImagery)return"protoImagery: boolean expected";if(void 0!==e.terrainPresent&&"boolean"!=typeof e.terrainPresent)return"terrainPresent: boolean expected";if(void 0!==e.providerInfo){if(!Array.isArray(e.providerInfo))return"providerInfo: array expected";for(var t=0;t<e.providerInfo.length;++t)if(r=o[4].verify(e.providerInfo[t]))return"providerInfo."+r}if(void 0!==e.nestedFeature){if(!Array.isArray(e.nestedFeature))return"nestedFeature: array expected";for(t=0;t<e.nestedFeature.length;++t)if(r=o[5].verify(e.nestedFeature[t]))return"nestedFeature."+r}if(void 0!==e.styleAttribute){if(!Array.isArray(e.styleAttribute))return"styleAttribute: array expected";for(t=0;t<e.styleAttribute.length;++t)if(r=o[6].verify(e.styleAttribute[t]))return"styleAttribute."+r}if(void 0!==e.styleMap){if(!Array.isArray(e.styleMap))return"styleMap: array expected";for(t=0;t<e.styleMap.length;++t)if(r=o[7].verify(e.styleMap[t]))return"styleMap."+r}if(void 0!==e.endSnippet&&null!==e.endSnippet&&(r=o[8].verify(e.endSnippet)))return"endSnippet."+r;if(void 0!==e.translationEntry){if(!Array.isArray(e.translationEntry))return"translationEntry: array expected";for(t=0;t<e.translationEntry.length;++t)if(r=o[9].verify(e.translationEntry[t]))return"translationEntry."+r}if(void 0!==e.language&&!s.isString(e.language))return"language: string expected";if(void 0!==e.version&&!s.isInteger(e.version))return"version: integer expected";if(void 0!==e.dbrootReference){if(!Array.isArray(e.dbrootReference))return"dbrootReference: array expected";for(t=0;t<e.dbrootReference.length;++t){var r;if(r=o[12].verify(e.dbrootReference[t]))return"dbrootReference."+r}}return void 0!==e.databaseVersion&&null!==e.databaseVersion&&(r=o[13].verify(e.databaseVersion))?"databaseVersion."+r:void 0===e.refreshTimeout||s.isInteger(e.refreshTimeout)?null:"refreshTimeout: integer expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.DbRootProto)return e;var t=new u.keyhole.dbroot.DbRootProto;if(void 0!==e.databaseName&&null!==e.databaseName){if("object"!=typeof e.databaseName)throw TypeError(".keyhole.dbroot.DbRootProto.databaseName: object expected");t.databaseName=o[0].fromObject(e.databaseName)}if(void 0!==e.imageryPresent&&null!==e.imageryPresent&&(t.imageryPresent=Boolean(e.imageryPresent)),void 0!==e.protoImagery&&null!==e.protoImagery&&(t.protoImagery=Boolean(e.protoImagery)),void 0!==e.terrainPresent&&null!==e.terrainPresent&&(t.terrainPresent=Boolean(e.terrainPresent)),e.providerInfo){if(!Array.isArray(e.providerInfo))throw TypeError(".keyhole.dbroot.DbRootProto.providerInfo: array expected");t.providerInfo=[];for(var r=0;r<e.providerInfo.length;++r){if("object"!=typeof e.providerInfo[r])throw TypeError(".keyhole.dbroot.DbRootProto.providerInfo: object expected");t.providerInfo[r]=o[4].fromObject(e.providerInfo[r])}}if(e.nestedFeature){if(!Array.isArray(e.nestedFeature))throw TypeError(".keyhole.dbroot.DbRootProto.nestedFeature: array expected");for(t.nestedFeature=[],r=0;r<e.nestedFeature.length;++r){if("object"!=typeof e.nestedFeature[r])throw TypeError(".keyhole.dbroot.DbRootProto.nestedFeature: object expected");t.nestedFeature[r]=o[5].fromObject(e.nestedFeature[r])}}if(e.styleAttribute){if(!Array.isArray(e.styleAttribute))throw TypeError(".keyhole.dbroot.DbRootProto.styleAttribute: array expected");for(t.styleAttribute=[],r=0;r<e.styleAttribute.length;++r){if("object"!=typeof e.styleAttribute[r])throw TypeError(".keyhole.dbroot.DbRootProto.styleAttribute: object expected");t.styleAttribute[r]=o[6].fromObject(e.styleAttribute[r])}}if(e.styleMap){if(!Array.isArray(e.styleMap))throw TypeError(".keyhole.dbroot.DbRootProto.styleMap: array expected");for(t.styleMap=[],r=0;r<e.styleMap.length;++r){if("object"!=typeof e.styleMap[r])throw TypeError(".keyhole.dbroot.DbRootProto.styleMap: object expected");t.styleMap[r]=o[7].fromObject(e.styleMap[r])}}if(void 0!==e.endSnippet&&null!==e.endSnippet){if("object"!=typeof e.endSnippet)throw TypeError(".keyhole.dbroot.DbRootProto.endSnippet: object expected");t.endSnippet=o[8].fromObject(e.endSnippet)}if(e.translationEntry){if(!Array.isArray(e.translationEntry))throw TypeError(".keyhole.dbroot.DbRootProto.translationEntry: array expected");for(t.translationEntry=[],r=0;r<e.translationEntry.length;++r){if("object"!=typeof e.translationEntry[r])throw TypeError(".keyhole.dbroot.DbRootProto.translationEntry: object expected");t.translationEntry[r]=o[9].fromObject(e.translationEntry[r])}}if(void 0!==e.language&&null!==e.language&&(t.language=String(e.language)),void 0!==e.version&&null!==e.version&&(t.version=0|e.version),e.dbrootReference){if(!Array.isArray(e.dbrootReference))throw TypeError(".keyhole.dbroot.DbRootProto.dbrootReference: array expected");for(t.dbrootReference=[],r=0;r<e.dbrootReference.length;++r){if("object"!=typeof e.dbrootReference[r])throw TypeError(".keyhole.dbroot.DbRootProto.dbrootReference: object expected");t.dbrootReference[r]=o[12].fromObject(e.dbrootReference[r])}}if(void 0!==e.databaseVersion&&null!==e.databaseVersion){if("object"!=typeof e.databaseVersion)throw TypeError(".keyhole.dbroot.DbRootProto.databaseVersion: object expected");t.databaseVersion=o[13].fromObject(e.databaseVersion)}return void 0!==e.refreshTimeout&&null!==e.refreshTimeout&&(t.refreshTimeout=0|e.refreshTimeout),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.providerInfo=[],r.nestedFeature=[],r.styleAttribute=[],r.styleMap=[],r.translationEntry=[],r.dbrootReference=[]),t.defaults&&(r.databaseName=null,r.imageryPresent=!0,r.protoImagery=!1,r.terrainPresent=!1,r.endSnippet=null,r.language="en",r.version=5,r.databaseVersion=null,r.refreshTimeout=0),void 0!==e.databaseName&&null!==e.databaseName&&e.hasOwnProperty("databaseName")&&(r.databaseName=o[0].toObject(e.databaseName,t)),void 0!==e.imageryPresent&&null!==e.imageryPresent&&e.hasOwnProperty("imageryPresent")&&(r.imageryPresent=e.imageryPresent),void 0!==e.protoImagery&&null!==e.protoImagery&&e.hasOwnProperty("protoImagery")&&(r.protoImagery=e.protoImagery),void 0!==e.terrainPresent&&null!==e.terrainPresent&&e.hasOwnProperty("terrainPresent")&&(r.terrainPresent=e.terrainPresent),void 0!==e.providerInfo&&null!==e.providerInfo&&e.hasOwnProperty("providerInfo")){r.providerInfo=[];for(var i=0;i<e.providerInfo.length;++i)r.providerInfo[i]=o[4].toObject(e.providerInfo[i],t)}if(void 0!==e.nestedFeature&&null!==e.nestedFeature&&e.hasOwnProperty("nestedFeature"))for(r.nestedFeature=[],i=0;i<e.nestedFeature.length;++i)r.nestedFeature[i]=o[5].toObject(e.nestedFeature[i],t);if(void 0!==e.styleAttribute&&null!==e.styleAttribute&&e.hasOwnProperty("styleAttribute"))for(r.styleAttribute=[],i=0;i<e.styleAttribute.length;++i)r.styleAttribute[i]=o[6].toObject(e.styleAttribute[i],t);if(void 0!==e.styleMap&&null!==e.styleMap&&e.hasOwnProperty("styleMap"))for(r.styleMap=[],i=0;i<e.styleMap.length;++i)r.styleMap[i]=o[7].toObject(e.styleMap[i],t);if(void 0!==e.endSnippet&&null!==e.endSnippet&&e.hasOwnProperty("endSnippet")&&(r.endSnippet=o[8].toObject(e.endSnippet,t)),void 0!==e.translationEntry&&null!==e.translationEntry&&e.hasOwnProperty("translationEntry"))for(r.translationEntry=[],i=0;i<e.translationEntry.length;++i)r.translationEntry[i]=o[9].toObject(e.translationEntry[i],t);if(void 0!==e.language&&null!==e.language&&e.hasOwnProperty("language")&&(r.language=e.language),void 0!==e.version&&null!==e.version&&e.hasOwnProperty("version")&&(r.version=e.version),void 0!==e.dbrootReference&&null!==e.dbrootReference&&e.hasOwnProperty("dbrootReference"))for(r.dbrootReference=[],i=0;i<e.dbrootReference.length;++i)r.dbrootReference[i]=o[12].toObject(e.dbrootReference[i],t);return void 0!==e.databaseVersion&&null!==e.databaseVersion&&e.hasOwnProperty("databaseVersion")&&(r.databaseVersion=o[13].toObject(e.databaseVersion,t)),void 0!==e.refreshTimeout&&null!==e.refreshTimeout&&e.hasOwnProperty("refreshTimeout")&&(r.refreshTimeout=e.refreshTimeout),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.EncryptedDbRootProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}e.prototype.encryptionType=0,e.prototype.encryptionData=s.newBuffer([]),e.prototype.dbrootData=s.newBuffer([]);var t,i={0:"keyhole.dbroot.EncryptedDbRootProto.EncryptionType"};return l.push(i),e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.keyhole.dbroot.EncryptedDbRootProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.encryptionType=e.uint32();break;case 2:i.encryptionData=e.bytes();break;case 3:i.dbrootData=e.bytes();break;default:e.skipType(7&n)}}return i},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(void 0!==e.encryptionType)switch(e.encryptionType){default:return"encryptionType: enum value expected";case 0:}return void 0===e.encryptionData||e.encryptionData&&"number"==typeof e.encryptionData.length||s.isString(e.encryptionData)?void 0===e.dbrootData||e.dbrootData&&"number"==typeof e.dbrootData.length||s.isString(e.dbrootData)?null:"dbrootData: buffer expected":"encryptionData: buffer expected"},e.from=e.fromObject=function(e){if(e instanceof u.keyhole.dbroot.EncryptedDbRootProto)return e;var t=new u.keyhole.dbroot.EncryptedDbRootProto;switch(e.encryptionType){case"ENCRYPTION_XOR":case 0:t.encryptionType=0}return void 0!==e.encryptionData&&null!==e.encryptionData&&("string"==typeof e.encryptionData?s.base64.decode(e.encryptionData,t.encryptionData=s.newBuffer(s.base64.length(e.encryptionData)),0):e.encryptionData.length&&(t.encryptionData=e.encryptionData)),void 0!==e.dbrootData&&null!==e.dbrootData&&("string"==typeof e.dbrootData?s.base64.decode(e.dbrootData,t.dbrootData=s.newBuffer(s.base64.length(e.dbrootData)),0):e.dbrootData.length&&(t.dbrootData=e.dbrootData)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.encryptionType=t.enums===String?"ENCRYPTION_XOR":0,r.encryptionData=t.bytes===String?"":[],r.dbrootData=t.bytes===String?"":[]),void 0!==e.encryptionType&&null!==e.encryptionType&&e.hasOwnProperty("encryptionType")&&(r.encryptionType=t.enums===String?i[0][e.encryptionType]:e.encryptionType),void 0!==e.encryptionData&&null!==e.encryptionData&&e.hasOwnProperty("encryptionData")&&(r.encryptionData=t.bytes===String?s.base64.encode(e.encryptionData,0,e.encryptionData.length):t.bytes===Array?Array.prototype.slice.call(e.encryptionData):e.encryptionData),void 0!==e.dbrootData&&null!==e.dbrootData&&e.hasOwnProperty("dbrootData")&&(r.dbrootData=t.bytes===String?s.base64.encode(e.dbrootData,0,e.dbrootData.length):t.bytes===Array?Array.prototype.slice.call(e.dbrootData):e.dbrootData),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.EncryptionType=((t=Object.create({})).ENCRYPTION_XOR=0,t),e}(),e),t),s.lazyResolve(u,l),u.keyhole.dbroot}),define("Core/isBitSet",[],function(){"use strict";return function(e,t){return 0!=(e&t)}}),define("Core/GoogleEarthEnterpriseTileInformation",["./defined","./isBitSet"],function(r,t){"use strict";var i=[1,2,4,8];function n(e,t,r,i,n,o){this._bits=e,this.cnodeVersion=t,this.imageryVersion=r,this.terrainVersion=i,this.imageryProvider=n,this.terrainProvider=o,this.ancestorHasTerrain=!1,this.terrainState=void 0}return n.clone=function(e,t){return r(t)?(t._bits=e._bits,t.cnodeVersion=e.cnodeVersion,t.imageryVersion=e.imageryVersion,t.terrainVersion=e.terrainVersion,t.imageryProvider=e.imageryProvider,t.terrainProvider=e.terrainProvider):t=new n(e._bits,e.cnodeVersion,e.imageryVersion,e.terrainVersion,e.imageryProvider,e.terrainProvider),t.ancestorHasTerrain=e.ancestorHasTerrain,t.terrainState=e.terrainState,t},n.prototype.setParent=function(e){this.ancestorHasTerrain=e.ancestorHasTerrain||this.hasTerrain()},n.prototype.hasSubtree=function(){return t(this._bits,16)},n.prototype.hasImagery=function(){return t(this._bits,64)},n.prototype.hasTerrain=function(){return t(this._bits,128)},n.prototype.hasChildren=function(){return t(this._bits,15)},n.prototype.hasChild=function(e){return t(this._bits,i[e])},n.prototype.getChildBitmask=function(){return 15&this._bits},n}),define("Core/GoogleEarthEnterpriseMetadata",["../ThirdParty/google-earth-dbroot-parser","../ThirdParty/when","./appendForwardSlash","./Check","./Credit","./defaultValue","./defined","./defineProperties","./deprecationWarning","./GoogleEarthEnterpriseTileInformation","./isBitSet","./Math","./Request","./Resource","./RuntimeError","./TaskProcessor"],function(c,d,e,a,h,p,f,t,s,m,l,g,_,v,y,r){"use strict";var b=function(e){for(var t=e.length,r=new ArrayBuffer(t),i=new Uint8Array(r),n=0;n<t;++n)i[n]=e.charCodeAt(n);return r}('E\vyjE",qIFgQ\0B%a,f)\b4jb%y\nwmikNuA[@V\fr|3SOlq{EVZwUe\v3*l50s3>mF8J.uDt"a"\f3"So9D\v99L\\P_"uxqh;<VqH\'UfYNeuaF}a?A\04MF\'{+Mg0\\P[/Fn5/\'C.\n\f^se4l.jC\'c#U?q{gC}:TUK/(\\-f;/*"Nk.\r}}GC+>M>}Ix\fa1-O~q \r1N\v\0nPh}=\b\rnh$[k#s\r\v@Q]".jI\0wUj{GLFS+S4Y81NXFk-#p\x005"1&/u-6,rt#G&7r\0D3-`i#i*|KQ\rT9w.)PjoP\\>TP[\vEm(w7JfJo pq~\fmI-zrY0]s x B|G`&q3=c+SD\\qD2O<)=RaX}e\r=\bB#\t^PIMGLO{+1;ol\r?_FaZU\0gJi H]~q NV<rv)I]-6;fj=P^RKsWx.YoKW>\'\'`;SD>?mw\n?RU^1I7&-\'Tj *xprh_H~XL?f>ep8iVldI\'xtOV9\0w\v-5O\bQ`\nZGM&30xFG[y`In7gS\n>F94\rSun\fY){IIwyIV.6\v:Ob{M1/8{O!Fpv})"x\n\\QYRe|3H*u`5(1-F|["');function n(e){a.defined("resourceOrUrl",e);var t,r=e;"string"==typeof r||r instanceof v||(a.typeOf.string("resourceOrUrl.url",e.url),f(e.proxy)&&s("GoogleEarthEnterpriseMetadata","The options.url & options.proxy parameters have been deprecated. Specify a URL string or a Resource as the only parameter."),r=e.url,t=e.proxy);var i=v.createIfNeeded(r,{proxy:t});i.appendForwardSlash(),this._resource=i,this.imageryPresent=!0,this.protoImagery=void 0,this.terrainPresent=!0,this.negativeAltitudeExponentBias=32,this.negativeAltitudeThreshold=g.EPSILON12,this.providers={},this.key=void 0,this._quadPacketVersion=1,this._tileInfo={},this._subtreePromises={};var u,n,o=this;this._readyPromise=(u=this,n=u._resource.getDerivedResource({url:"dbRoot.v5",queryParameters:{output:"proto"}}),n.fetchArrayBuffer().then(function(e){var t=c.EncryptedDbRootProto.decode(new Uint8Array(e)),r=t.encryptionData,i=r.byteOffset,n=i+r.byteLength,o=u.key=r.buffer.slice(i,n);r=t.dbrootData,i=r.byteOffset,n=i+r.byteLength;var a=r.buffer.slice(i,n);return C.scheduleTask({buffer:a,type:"DbRoot",key:o},[a])}).then(function(e){var t=c.DbRootProto.decode(new Uint8Array(e.buffer));if(u.imageryPresent=p(t.imageryPresent,u.imageryPresent),u.protoImagery=t.protoImagery,u.terrainPresent=p(t.terrainPresent,u.terrainPresent),f(t.endSnippet)&&f(t.endSnippet.model)){var r=t.endSnippet.model;u.negativeAltitudeExponentBias=p(r.negativeAltitudeExponentBias,u.negativeAltitudeExponentBias),u.negativeAltitudeThreshold=p(r.compressedNegativeAltitudeThreshold,u.negativeAltitudeThreshold)}f(t.databaseVersion)&&(u._quadPacketVersion=p(t.databaseVersion.quadtreeVersion,u._quadPacketVersion));for(var i=u.providers,n=p(t.providerInfo,[]),o=n.length,a=0;a<o;++a){var s=n[a],l=s.copyrightString;f(l)&&(i[s.providerId]=new h({text:l.value}))}}).otherwise(function(){console.log("Failed to retrieve "+n.url+". Using defaults."),u.key=b})).then(function(){return o.getQuadTreePacket("",o._quadPacketVersion)}).then(function(){return!0}).otherwise(function(e){var t="An error occurred while accessing "+w(o,"",1).url+".";return d.reject(new y(t))})}t(n.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},resource:{get:function(){return this._resource}},readyPromise:{get:function(){return this._readyPromise}}}),n.tileXYToQuadKey=function(e,t,r){for(var i="",n=r;0<=n;--n){var o=1<<n,a=0;l(t,o)?l(e,o)&&(a|=1):(a|=2,l(e,o)||(a|=1)),i+=a}return i},n.quadKeyToTileXY=function(e){for(var t=0,r=0,i=e.length-1,n=i;0<=n;--n){var o=1<<n,a=+e[i-n];l(a,2)?l(a,1)||(t|=o):(r|=o,l(a,1)&&(t|=o))}return{x:t,y:r,level:i}},n.prototype.isValid=function(e){var t=this.getTileInformationFromQuadKey(e);if(f(t))return null!==t;for(var r,i=!0,n=e;1<n.length;){if(r=n.substring(n.length-1),n=n.substring(0,n.length-1),t=this.getTileInformationFromQuadKey(n),f(t)){t.hasSubtree()||t.hasChild(parseInt(r))||(i=!1);break}if(null===t){i=!1;break}}return i};var C=new r("decodeGoogleEarthEnterprisePacket",Number.POSITIVE_INFINITY);function w(e,t,r,i){return e._resource.getDerivedResource({url:"flatfile?q2-0"+t+"-q."+r.toString(),request:i})}return n.prototype.getQuadTreePacket=function(d,e,t){e=p(e,1);var r=w(this,d=p(d,""),e,t).fetchArrayBuffer();if(f(r)){var h=this._tileInfo,i=this.key;return r.then(function(e){return C.scheduleTask({buffer:e,quadKey:d,type:"Metadata",key:i},[e]).then(function(e){var t,r=-1;if(""!==d){r=d.length+1;var i=e[d];(t=h[d])._bits|=i._bits,delete e[d]}var n=Object.keys(e);n.sort(function(e,t){return e.length-t.length});for(var o=n.length,a=0;a<o;++a){var s=n[a];if(null!==e[s]){var l=m.clone(e[s]),u=s.length;if(u===r)l.setParent(t);else if(1<u){var c=h[s.substring(0,s.length-1)];l.setParent(c)}h[s]=l}else h[s]=null}})})}},n.prototype.populateSubtree=function(e,t,r,i){return function e(t,r,i){var n=t._tileInfo;var o=r;var a=n[o];if(f(a)&&(!a.hasSubtree()||a.hasChildren()))return a;for(;void 0===a&&1<o.length;)o=o.substring(0,o.length-1),a=n[o];var s;var l=t._subtreePromises;var u=l[o];if(f(u))return u.then(function(){return s=new _({throttle:i.throttle,throttleByServer:i.throttleByServer,type:i.type,priorityFunction:i.priorityFunction}),e(t,r,s)});if(!f(a)||!a.hasSubtree())return d.reject(new y("Couldn't load metadata for tile "+r));u=t.getQuadTreePacket(o,a.cnodeVersion,i);if(!f(u))return;l[o]=u;return u.then(function(){return s=new _({throttle:i.throttle,throttleByServer:i.throttleByServer,type:i.type,priorityFunction:i.priorityFunction}),e(t,r,s)}).always(function(){delete l[o]})}(this,n.tileXYToQuadKey(e,t,r),i)},n.prototype.getTileInformation=function(e,t,r){var i=n.tileXYToQuadKey(e,t,r);return this._tileInfo[i]},n.prototype.getTileInformationFromQuadKey=function(e){return this._tileInfo[e]},n}),define("Core/GoogleEarthEnterpriseTerrainData",["./BoundingSphere","./Cartesian2","./Cartesian3","./Check","./defaultValue","./defined","./defineProperties","./DeveloperError","./IndexDatatype","./Intersections2D","./Math","./OrientedBoundingBox","./QuantizedMeshTerrainData","./Rectangle","./TaskProcessor","./TerrainEncoding","./TerrainMesh"],function(f,e,m,g,c,_,t,v,y,M,R,b,C,d,r,h,p){"use strict";function i(e){e=c(e,c.EMPTY_OBJECT),g.typeOf.object("options.buffer",e.buffer),g.typeOf.number("options.negativeAltitudeExponentBias",e.negativeAltitudeExponentBias),g.typeOf.number("options.negativeElevationThreshold",e.negativeElevationThreshold),this._buffer=e.buffer,this._credits=e.credits,this._negativeAltitudeExponentBias=e.negativeAltitudeExponentBias,this._negativeElevationThreshold=e.negativeElevationThreshold;var t=c(e.childTileMask,15),r=3&t;r|=4&t?8:0,r|=8&t?4:0,this._childTileMask=r,this._createdByUpsampling=c(e.createdByUpsampling,!1),this._skirtHeight=void 0,this._bufferType=this._buffer.constructor,this._mesh=void 0,this._minimumHeight=void 0,this._maximumHeight=void 0,this._vertexCountWithoutSkirts=void 0,this._skirtIndex=void 0}t(i.prototype,{credits:{get:function(){return this._credits}},waterMask:{get:function(){}}});var w=new r("createVerticesFromGoogleEarthEnterpriseBuffer"),S=new d,T=new d;i.prototype.createMesh=function(e,t,r,i,n){g.typeOf.object("tilingScheme",e),g.typeOf.number("x",t),g.typeOf.number("y",r),g.typeOf.number("level",i);var o=e.ellipsoid;e.tileXYToNativeRectangle(t,r,i,S),e.tileXYToRectangle(t,r,i,T),n=c(n,1);var a=o.cartographicToCartesian(d.center(T)),s=40075.16/(1<<i);this._skirtHeight=Math.min(8*s,1e3);var l=w.scheduleTask({buffer:this._buffer,nativeRectangle:S,rectangle:T,relativeToCenter:a,ellipsoid:o,skirtHeight:this._skirtHeight,exaggeration:n,includeWebMercatorT:!0,negativeAltitudeExponentBias:this._negativeAltitudeExponentBias,negativeElevationThreshold:this._negativeElevationThreshold});if(_(l)){var u=this;return l.then(function(e){return u._mesh=new p(a,new Float32Array(e.vertices),new Uint16Array(e.indices),e.minimumHeight,e.maximumHeight,e.boundingSphere3D,e.occludeePointInScaledSpace,e.numberOfAttributes,e.orientedBoundingBox,h.clone(e.encoding),n),u._vertexCountWithoutSkirts=e.vertexCountWithoutSkirts,u._skirtIndex=e.skirtIndex,u._minimumHeight=e.minimumHeight,u._maximumHeight=e.maximumHeight,u._buffer=void 0,u._mesh})}},i.prototype.interpolateHeight=function(e,t,r){var i=R.clamp((t-e.west)/e.width,0,1),n=R.clamp((r-e.south)/e.height,0,1);return _(this._mesh)?function(e,t,r){for(var i=e._mesh,n=i.vertices,o=i.encoding,a=i.indices,s=0,l=a.length;s<l;s+=3){var u=a[s],c=a[s+1],d=a[s+2],h=o.decodeTextureCoordinates(n,u,A),p=o.decodeTextureCoordinates(n,c,x),f=o.decodeTextureCoordinates(n,d,P),m=M.computeBarycentricCoordinates(t,r,h.x,h.y,p.x,p.y,f.x,f.y,L);if(-1e-15<=m.x&&-1e-15<=m.y&&-1e-15<=m.z){var g=o.decodeHeight(n,u),_=o.decodeHeight(n,c),v=o.decodeHeight(n,d);return m.x*g+m.y*_+m.z*v}}return}(this,i,n):function(e,t,r,i){var n=e._buffer,o=0,a=0,s=0;.5<r?(.5<t?(o=2,a=.5):o=3,s=.5):.5<t&&(o=1,a=.5);for(var l=new DataView(n),u=0,c=0;c<o;++c)u+=l.getUint32(u,!0),u+=k;u+=k,u+=2*U;var d=R.toRadians(180*l.getFloat64(u,!0));u+=U;var h=R.toRadians(180*l.getFloat64(u,!0));u+=U;var p=i.width/d/2,f=i.height/h/2,m=l.getInt32(u,!0);u+=F;var g=3*l.getInt32(u,!0);u+=F,u+=F;var _,v=new Array(m),y=new Array(m),b=new Array(m);for(_=0;_<m;++_)v[_]=a+l.getUint8(u++)*p,y[_]=s+l.getUint8(u++)*f,b[_]=6371010*l.getFloat32(u,!0),u+=B;var C=new Array(g);for(_=0;_<g;++_)C[_]=l.getUint16(u,!0),u+=N;for(_=0;_<g;_+=3){var w=C[_],S=C[_+1],T=C[_+2],E=v[w],A=v[S],x=v[T],P=y[w],D=y[S],O=y[T],I=M.computeBarycentricCoordinates(t,r,E,P,A,D,x,O,L);if(-1e-15<=I.x&&-1e-15<=I.y&&-1e-15<=I.z)return I.x*b[w]+I.y*b[S]+I.z*b[T]}return}(this,i,n,e)};var E=new r("upsampleQuantizedTerrainMesh");i.prototype.upsample=function(e,t,r,i,n,o,a){if(g.typeOf.object("tilingScheme",e),g.typeOf.number("thisX",t),g.typeOf.number("thisY",r),g.typeOf.number("thisLevel",i),g.typeOf.number("descendantX",n),g.typeOf.number("descendantY",o),g.typeOf.number("descendantLevel",a),1<a-i)throw new v("Upsampling through more than one level at a time is not currently supported.");var s=this._mesh;if(_(this._mesh)){var l=2*t!==n,u=2*r===o,c=e.ellipsoid,d=e.tileXYToRectangle(n,o,a),h=E.scheduleTask({vertices:s.vertices,vertexCountWithoutSkirts:this._vertexCountWithoutSkirts,indices:s.indices,skirtIndex:this._skirtIndex,encoding:s.encoding,minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,isEastChild:l,isNorthChild:u,childRectangle:d,ellipsoid:c,exaggeration:s.exaggeration});if(_(h)){var p=this;return h.then(function(e){var t=new Uint16Array(e.vertices),r=y.createTypedArray(t.length/3,e.indices),i=p._skirtHeight;return new C({quantizedVertices:t,indices:r,minimumHeight:e.minimumHeight,maximumHeight:e.maximumHeight,boundingSphere:f.clone(e.boundingSphere),orientedBoundingBox:b.clone(e.orientedBoundingBox),horizonOcclusionPoint:m.clone(e.horizonOcclusionPoint),westIndices:e.westIndices,southIndices:e.southIndices,eastIndices:e.eastIndices,northIndices:e.northIndices,westSkirtHeight:i,southSkirtHeight:i,eastSkirtHeight:i,northSkirtHeight:i,childTileMask:0,createdByUpsampling:!0,credits:p._credits})})}}},i.prototype.isChildAvailable=function(e,t,r,i){g.typeOf.number("thisX",e),g.typeOf.number("thisY",t),g.typeOf.number("childX",r),g.typeOf.number("childY",i);var n=2;return r!==2*e&&++n,i!==2*t&&(n-=2),0!=(this._childTileMask&1<<n)},i.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling};var A=new e,x=new e,P=new e,L=new m;var N=Uint16Array.BYTES_PER_ELEMENT,k=Uint32Array.BYTES_PER_ELEMENT,F=Int32Array.BYTES_PER_ELEMENT,B=Float32Array.BYTES_PER_ELEMENT,U=Float64Array.BYTES_PER_ELEMENT;return i}),define("Core/GoogleEarthEnterpriseTerrainProvider",["../ThirdParty/when","./Credit","./defaultValue","./defined","./defineProperties","./deprecationWarning","./DeveloperError","./Event","./GeographicTilingScheme","./GoogleEarthEnterpriseMetadata","./GoogleEarthEnterpriseTerrainData","./HeightmapTerrainData","./JulianDate","./Math","./Rectangle","./Request","./RequestState","./RequestType","./Resource","./RuntimeError","./TaskProcessor","./TileProviderError"],function(S,a,s,T,e,l,E,u,c,A,x,P,d,h,p,f,D,m,g,O,t,_){"use strict";var I=0,M=1,R=2,L=3,v=new d;function y(){this._terrainCache={},this._lastTidy=d.now()}function r(e){if(e=s(e,{}),!T(e.url)&&!T(e.metadata))throw new E("options.url or options.metadata is required.");var r;if(T(e.proxy)&&l("GoogleEarthEnterpriseTerrainProvider.proxy","The options.proxy parameter has been deprecated. Specify options.url as a Resource instance and set the proxy property there."),T(e.metadata))r=e.metadata;else{var t=g.createIfNeeded(e.url,{proxy:e.proxy});r=new A(t)}this._metadata=r,this._tilingScheme=new c({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new p(-h.PI,-h.PI,h.PI,h.PI),ellipsoid:e.ellipsoid});var i=e.credit;"string"==typeof i&&(i=new a({text:i})),this._credit=i,this._levelZeroMaximumGeometricError=40075.16,this._terrainCache=new y,this._terrainPromises={},this._terrainRequests={},this._errorEvent=new u,this._ready=!1;var n,o=this;this._readyPromise=r.readyPromise.then(function(e){if(r.terrainPresent)return _.handleSuccess(n),o._ready=e;var t=new O("The server "+r.url+" doesn't have terrain");return n=_.handleError(n,o,o._errorEvent,t.message,void 0,void 0,void 0,t),S.reject(t)}).otherwise(function(e){return n=_.handleError(n,o,o._errorEvent,e.message,void 0,void 0,void 0,e),S.reject(e)})}y.prototype.add=function(e,t){this._terrainCache[e]={buffer:t,timestamp:d.now()}},y.prototype.get=function(e){var t=this._terrainCache[e];if(T(t))return delete this._terrainCache[e],t.buffer},y.prototype.tidy=function(){if(d.now(v),10<d.secondsDifference(v,this._lastTidy)){for(var e=this._terrainCache,t=Object.keys(e),r=t.length,i=0;i<r;++i){var n=t[i],o=e[n];10<d.secondsDifference(v,o.timestamp)&&delete e[n]}d.clone(v,this._lastTidy)}},e(r.prototype,{url:{get:function(){return this._metadata.url}},proxy:{get:function(){return this._metadata.proxy}},tilingScheme:{get:function(){if(!this._ready)throw new E("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){}}});var N=new t("decodeGoogleEarthEnterprisePacket",Number.POSITIVE_INFINITY);function k(e,t,r){var i=t.getChildBitmask();if(t.terrainState===L)for(var n=i=0;n<4;++n){var o=r.getTileInformationFromQuadKey(e+n.toString());T(o)&&o.hasTerrain()&&(i|=1<<n)}return i}return r.prototype.requestTileGeometry=function(e,t,r,i){if(!this._ready)throw new E("requestTileGeometry must not be called before the terrain provider is ready.");var n=A.tileXYToQuadKey(e,t,r),s=this._terrainCache,l=this._metadata,o=l.getTileInformationFromQuadKey(n);if(!T(o))return S.reject(new O("Terrain tile doesn't exist"));var a=o.terrainState;T(a)||(a=o.terrainState=I);var u,c=s.get(n);if(T(c)){var d=l.providers[o.terrainProvider];return new x({buffer:c,childTileMask:k(n,o,l),credits:T(d)?[d]:void 0,negativeAltitudeExponentBias:l.negativeAltitudeExponentBias,negativeElevationThreshold:l.negativeAltitudeThreshold})}if(s.tidy(),!o.ancestorHasTerrain)return new P({buffer:new Uint8Array(256),width:16,height:16});if(a===M)return S.reject(new O("Terrain tile doesn't exist"));var h=n,p=-1;switch(a){case R:p=o.terrainVersion;break;case L:h=h.substring(0,h.length-1),p=(u=l.getTileInformationFromQuadKey(h)).terrainVersion;break;case I:o.hasTerrain()?p=o.terrainVersion:(h=h.substring(0,h.length-1),u=l.getTileInformationFromQuadKey(h),T(u)&&u.hasTerrain()&&(p=u.terrainVersion))}if(p<0)return S.reject(new O("Terrain tile doesn't exist"));var f,m,g,_,v,y,b=this._terrainPromises,C=this._terrainRequests;if(T(b[h]))f=b[h],m=C[h];else{var w=(g=this,_=h,v=p,y=m=i,v=T(v)&&0<v?v:1,g._metadata.resource.getDerivedResource({url:"flatfile?f1c-0"+_+"-t."+v.toString(),request:y})).fetchArrayBuffer();if(!T(w))return;f=w.then(function(e){return T(e)?N.scheduleTask({buffer:e,type:"Terrain",key:l.key},[e]).then(function(e){var t=l.getTileInformationFromQuadKey(h);t.terrainState=R,s.add(h,e[0]);for(var r=t.terrainProvider,i=e.length-1,n=0;n<i;++n){var o=h+n.toString(),a=l.getTileInformationFromQuadKey(o);T(a)&&(s.add(o,e[n+1]),a.terrainState=L,0===a.terrainProvider&&(a.terrainProvider=r))}}):S.reject(new O("Failed to load terrain."))}),b[h]=f,C[h]=m,f=f.always(function(){delete b[h],delete C[h]})}return f.then(function(){var e=s.get(n);if(T(e)){var t=l.providers[o.terrainProvider];return new x({buffer:e,childTileMask:k(n,o,l),credits:T(t)?[t]:void 0,negativeAltitudeExponentBias:l.negativeAltitudeExponentBias,negativeElevationThreshold:l.negativeAltitudeThreshold})}return S.reject(new O("Failed to load terrain."))}).otherwise(function(e){return m.state===D.CANCELLED?i.state=m.state:o.terrainState=M,S.reject(e)})},r.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)},r.prototype.getTileDataAvailable=function(e,t,r){var i=this._metadata,n=A.tileXYToQuadKey(e,t,r),o=i.getTileInformation(e,t,r);if(null===o)return!1;if(T(o)){if(!o.ancestorHasTerrain)return!0;var a=o.terrainState;if(a===M)return!1;if(!(T(a)&&a!==I||(o.terrainState=I,o.hasTerrain()))){n=n.substring(0,n.length-1);var s=i.getTileInformationFromQuadKey(n);if(!T(s)||!s.hasTerrain())return!1}return!0}if(i.isValid(n)){var l=new f({throttle:!0,throttleByServer:!0,type:m.TERRAIN});i.populateSubtree(e,t,r,l)}return!1},r}),define("Core/HeadingPitchRange",["./defaultValue","./defined"],function(i,r){"use strict";function n(e,t,r){this.heading=i(e,0),this.pitch=i(t,0),this.range=i(r,0)}return n.clone=function(e,t){if(r(e))return r(t)||(t=new n),t.heading=e.heading,t.pitch=e.pitch,t.range=e.range,t},n}),define("Core/HeadingPitchRoll",["./defaultValue","./defined","./DeveloperError","./Math"],function(i,s,l,n){"use strict";function u(e,t,r){this.heading=i(e,0),this.pitch=i(t,0),this.roll=i(r,0)}return u.fromQuaternion=function(e,t){if(!s(e))throw new l("quaternion is required");s(t)||(t=new u);var r=2*(e.w*e.y-e.z*e.x),i=1-2*(e.x*e.x+e.y*e.y),n=2*(e.w*e.x+e.y*e.z),o=1-2*(e.y*e.y+e.z*e.z),a=2*(e.w*e.z+e.x*e.y);return t.heading=-Math.atan2(a,o),t.roll=Math.atan2(n,i),t.pitch=-Math.asin(r),t},u.fromDegrees=function(e,t,r,i){if(!s(e))throw new l("heading is required");if(!s(t))throw new l("pitch is required");if(!s(r))throw new l("roll is required");return s(i)||(i=new u),i.heading=e*n.RADIANS_PER_DEGREE,i.pitch=t*n.RADIANS_PER_DEGREE,i.roll=r*n.RADIANS_PER_DEGREE,i},u.clone=function(e,t){if(s(e))return s(t)?(t.heading=e.heading,t.pitch=e.pitch,t.roll=e.roll,t):new u(e.heading,e.pitch,e.roll)},u.equals=function(e,t){return e===t||s(e)&&s(t)&&e.heading===t.heading&&e.pitch===t.pitch&&e.roll===t.roll},u.equalsEpsilon=function(e,t,r,i){return e===t||s(e)&&s(t)&&n.equalsEpsilon(e.heading,t.heading,r,i)&&n.equalsEpsilon(e.pitch,t.pitch,r,i)&&n.equalsEpsilon(e.roll,t.roll,r,i)},u.prototype.clone=function(e){return u.clone(this,e)},u.prototype.equals=function(e){return u.equals(this,e)},u.prototype.equalsEpsilon=function(e,t,r){return u.equalsEpsilon(this,e,t,r)},u.prototype.toString=function(){return"("+this.heading+", "+this.pitch+", "+this.roll+")"},u}),define("Core/HermitePolynomialApproximation",["./defaultValue","./defined","./DeveloperError","./Math"],function(r,T,i,E){"use strict";var w=E.factorial;function A(e,t,r,i,n,o){var a,s,l,u=0;if(0<i){for(s=0;s<n;s++){for(a=!1,l=0;l<o.length&&!a;l++)s===o[l]&&(a=!0);a||(o.push(s),u+=A(e,t,r,i-1,n,o),o.splice(o.length-1,1))}return u}for(u=1,s=0;s<n;s++){for(a=!1,l=0;l<o.length&&!a;l++)s===o[l]&&(a=!0);a||(u*=e-r[t[s]])}return u}var e={type:"Hermite",getRequiredDataPoints:function(e,t){if(t=r(t,0),!T(e))throw new i("degree is required.");if(e<0)throw new i("degree must be 0 or greater.");if(t<0)throw new i("inputOrder must be 0 or greater.");return Math.max(Math.floor((e+1)/(t+1)),2)},interpolateOrderZero:function(e,t,r,i,n){var o,a,s,l,u;T(n)||(n=new Array(i));var c=t.length,d=new Array(i);for(o=0;o<i;o++){n[o]=0;var h=new Array(c);for(d[o]=h,a=0;a<c;a++)h[a]=[]}var p=c,f=new Array(p);for(o=0;o<p;o++)f[o]=o;var m=c-1;for(l=0;l<i;l++){for(a=0;a<p;a++)u=f[a]*i+l,d[l][0].push(r[u]);for(o=1;o<p;o++){var g=!1;for(a=0;a<p-o;a++){var _,v=t[f[a]],y=t[f[a+o]];y-v<=0?(_=r[u=f[a]*i+i*o+l],d[l][o].push(_/w(o))):(_=d[l][o-1][a+1]-d[l][o-1][a],d[l][o].push(_/(y-v))),g=g||0!==_}g||(m=o-1)}}for(s=0;s<=0;s++)for(o=s;o<=m;o++){var b=A(e,f,t,s,o,[]);for(l=0;l<i;l++){var C=d[l][o][0];n[l+s*i]+=C*b}}return n}},x=[];return e.interpolate=function(e,t,r,i,n,o,a){var s=i*(o+1);T(a)||(a=new Array(s));for(var l=0;l<s;l++)a[l]=0;var u,c=t.length,d=new Array(c*(n+1));for(u=0;u<c;u++)for(var h=0;h<n+1;h++)d[u*(n+1)+h]=u;for(var p=d.length,f=x,m=function(e,t,r,i,n,o){for(var a,s,l=-1,u=t.length,c=u*(u+1)/2,d=0;d<n;d++){var h=Math.floor(d*c);for(a=0;a<u;a++)s=t[a]*n*(o+1)+d,e[h+a]=i[s];for(var p=1;p<u;p++){var f=0,m=Math.floor(p*(1-p)/2)+u*p,g=!1;for(a=0;a<u-p;a++){var _,v,y=r[t[a]],b=r[t[a+p]];if(b-y<=0)s=t[a]*n*(o+1)+n*p+d,_=i[s],v=_/E.factorial(p),e[h+m+f]=v,f++;else{var C=Math.floor((p-1)*(2-p)/2)+u*(p-1);_=e[h+C+a+1]-e[h+C+a],v=_/(b-y),e[h+m+f]=v,f++}g=g||0!==_}g&&(l=Math.max(l,p))}}return l}(f,d,t,r,i,n),g=[],_=p*(p+1)/2,v=Math.min(m,o),y=0;y<=v;y++)for(u=y;u<=m;u++){g.length=0;for(var b=A(e,d,t,y,u,g),C=Math.floor(u*(1-u)/2)+p*u,w=0;w<i;w++){var S=f[Math.floor(w*_)+C];a[w+y*i]+=S*b}}return a},e}),define("Core/IauOrientationParameters",[],function(){"use strict";return function(e,t,r,i){this.rightAscension=e,this.declination=t,this.rotation=r,this.rotationRate=i}}),define("Core/Iau2000Orientation",["./defined","./IauOrientationParameters","./JulianDate","./Math","./TimeConstants"],function(Y,X,Q,Z,K){"use strict";var e={},J=new Q;return e.ComputeMoon=function(e,t){Y(e)||(e=Q.now()),J=Q.addSeconds(e,32.184,J);var r=Q.totalDays(J)-2451545,i=r/K.DAYS_PER_JULIAN_CENTURY,n=(125.045+-.0529921*r)*Z.RADIANS_PER_DEGREE,o=(250.089+-.1059842*r)*Z.RADIANS_PER_DEGREE,a=(260.008+13.0120009*r)*Z.RADIANS_PER_DEGREE,s=(176.625+13.3407154*r)*Z.RADIANS_PER_DEGREE,l=(357.529+.9856003*r)*Z.RADIANS_PER_DEGREE,u=(311.589+26.4057084*r)*Z.RADIANS_PER_DEGREE,c=(134.963+13.064993*r)*Z.RADIANS_PER_DEGREE,d=(276.617+.3287146*r)*Z.RADIANS_PER_DEGREE,h=(34.226+1.7484877*r)*Z.RADIANS_PER_DEGREE,p=(15.134+-.1589763*r)*Z.RADIANS_PER_DEGREE,f=(119.743+.0036096*r)*Z.RADIANS_PER_DEGREE,m=(239.961+.1643573*r)*Z.RADIANS_PER_DEGREE,g=(25.053+12.9590088*r)*Z.RADIANS_PER_DEGREE,_=Math.sin(n),v=Math.sin(o),y=Math.sin(a),b=Math.sin(s),C=Math.sin(l),w=Math.sin(u),S=Math.sin(c),T=Math.sin(d),E=Math.sin(h),A=Math.sin(p),x=Math.sin(f),P=Math.sin(m),D=Math.sin(g),O=Math.cos(n),I=Math.cos(o),M=Math.cos(a),R=Math.cos(s),L=Math.cos(l),N=Math.cos(u),k=Math.cos(c),F=Math.cos(d),B=Math.cos(h),U=Math.cos(p),V=Math.cos(f),z=Math.cos(m),q=Math.cos(g),G=(269.9949+.0031*i-3.8787*_-.1204*v+.07*y-.0172*b+.0072*w-.0052*A+.0043*D)*Z.RADIANS_PER_DEGREE,W=(66.5392+.013*i+1.5419*O+.0239*I-.0278*M+.0068*R-.0029*N+9e-4*k+8e-4*U-9e-4*q)*Z.RADIANS_PER_DEGREE,H=(38.3213+13.17635815*r-14e-13*r*r+3.561*_+.1208*v-.0642*y+.0158*b+.0252*C-.0066*w-.0047*S-.0046*T+.0028*E+.0052*A+.004*x+.0019*P-.0044*D)*Z.RADIANS_PER_DEGREE,j=(13.17635815-2*r*14e-13+3.561*O*-.0529921+.1208*I*-.1059842-.0642*M*13.0120009+.0158*R*13.3407154+.0252*L*.9856003-.0066*N*26.4057084-.0047*k*13.064993-.0046*F*.3287146+.0028*B*1.7484877+.0052*U*-.1589763+.004*V*.0036096+.0019*z*.1643573-.0044*q*12.9590088)/86400*Z.RADIANS_PER_DEGREE;return Y(t)||(t=new X),t.rightAscension=G,t.declination=W,t.rotation=H,t.rotationRate=j,t},e}),define("Core/IauOrientationAxes",["./Cartesian3","./defined","./Iau2000Orientation","./JulianDate","./Math","./Matrix3","./Quaternion"],function(s,l,t,u,c,d,h){"use strict";function e(e){l(e)&&"function"==typeof e||(e=t.ComputeMoon),this._computeFunction=e}var p=new s,f=new s,m=new s;var g=new d,_=new h;return e.prototype.evaluate=function(e,t){l(e)||(e=u.now());var r=this._computeFunction(e),i=function(e,t,r){var i=p;i.x=Math.cos(e+c.PI_OVER_TWO),i.y=Math.sin(e+c.PI_OVER_TWO),i.z=0;var n=Math.cos(t),o=m;o.x=n*Math.cos(e),o.y=n*Math.sin(e),o.z=Math.sin(t);var a=s.cross(o,i,f);return l(r)||(r=new d),r[0]=i.x,r[1]=a.x,r[2]=o.x,r[3]=i.y,r[4]=a.y,r[5]=o.y,r[6]=i.z,r[7]=a.z,r[8]=o.z,r}(r.rightAscension,r.declination,t),n=c.zeroToTwoPi(r.rotation),o=h.fromAxisAngle(s.UNIT_Z,n,_),a=d.fromQuaternion(h.conjugate(o,o),g);return d.multiply(a,i,i)},e}),define("Core/InterpolationAlgorithm",["./DeveloperError"],function(e){"use strict";var t={type:void 0};return t.getRequiredDataPoints=e.throwInstantiationError,t.interpolateOrderZero=e.throwInstantiationError,t.interpolate=e.throwInstantiationError,t}),define("Core/TimeInterval",["./Check","./defaultValue","./defined","./defineProperties","./freezeObject","./JulianDate"],function(m,l,g,e,t,_){"use strict";function v(e){e=l(e,l.EMPTY_OBJECT),this.start=g(e.start)?_.clone(e.start):new _,this.stop=g(e.stop)?_.clone(e.stop):new _,this.data=e.data,this.isStartIncluded=l(e.isStartIncluded,!0),this.isStopIncluded=l(e.isStopIncluded,!0)}e(v.prototype,{isEmpty:{get:function(){var e=_.compare(this.stop,this.start);return e<0||0===e&&(!this.isStartIncluded||!this.isStopIncluded)}}});var u={start:void 0,stop:void 0,isStartIncluded:void 0,isStopIncluded:void 0,data:void 0};return v.fromIso8601=function(e,t){m.typeOf.object("options",e),m.typeOf.string("options.iso8601",e.iso8601);var r=e.iso8601.split("/"),i=_.fromIso8601(r[0]),n=_.fromIso8601(r[1]),o=l(e.isStartIncluded,!0),a=l(e.isStopIncluded,!0),s=e.data;return g(t)?(t.start=i,t.stop=n,t.isStartIncluded=o,t.isStopIncluded=a,t.data=s,t):(u.start=i,u.stop=n,u.isStartIncluded=o,u.isStopIncluded=a,u.data=s,new v(u))},v.toIso8601=function(e,t){return m.typeOf.object("timeInterval",e),_.toIso8601(e.start,t)+"/"+_.toIso8601(e.stop,t)},v.clone=function(e,t){if(g(e))return g(t)?(t.start=e.start,t.stop=e.stop,t.isStartIncluded=e.isStartIncluded,t.isStopIncluded=e.isStopIncluded,t.data=e.data,t):new v(e)},v.equals=function(e,t,r){return e===t||g(e)&&g(t)&&(e.isEmpty&&t.isEmpty||e.isStartIncluded===t.isStartIncluded&&e.isStopIncluded===t.isStopIncluded&&_.equals(e.start,t.start)&&_.equals(e.stop,t.stop)&&(e.data===t.data||g(r)&&r(e.data,t.data)))},v.equalsEpsilon=function(e,t,r,i){return m.typeOf.number("epsilon",r),e===t||g(e)&&g(t)&&(e.isEmpty&&t.isEmpty||e.isStartIncluded===t.isStartIncluded&&e.isStopIncluded===t.isStopIncluded&&_.equalsEpsilon(e.start,t.start,r)&&_.equalsEpsilon(e.stop,t.stop,r)&&(e.data===t.data||g(i)&&i(e.data,t.data)))},v.intersect=function(e,t,r,i){if(m.typeOf.object("left",e),m.typeOf.object("result",r),!g(t))return v.clone(v.EMPTY,r);var n=e.start,o=e.stop,a=t.start,s=t.stop,l=_.greaterThanOrEquals(a,n)&&_.greaterThanOrEquals(o,a),u=!l&&_.lessThanOrEquals(a,n)&&_.lessThanOrEquals(n,s);if(!l&&!u)return v.clone(v.EMPTY,r);var c=e.isStartIncluded,d=e.isStopIncluded,h=t.isStartIncluded,p=t.isStopIncluded,f=_.lessThan(o,s);return r.start=l?a:n,r.isStartIncluded=c&&h||!_.equals(a,n)&&(l&&h||u&&c),r.stop=f?o:s,r.isStopIncluded=f?d:d&&p||!_.equals(s,o)&&p,r.data=g(i)?i(e.data,t.data):e.data,r},v.contains=function(e,t){if(m.typeOf.object("timeInterval",e),m.typeOf.object("julianDate",t),e.isEmpty)return!1;var r=_.compare(e.start,t);if(0===r)return e.isStartIncluded;var i=_.compare(t,e.stop);return 0===i?e.isStopIncluded:r<0&&i<0},v.prototype.clone=function(e){return v.clone(this,e)},v.prototype.equals=function(e,t){return v.equals(this,e,t)},v.prototype.equalsEpsilon=function(e,t,r){return v.equalsEpsilon(this,e,t,r)},v.prototype.toString=function(){return v.toIso8601(this)},v.EMPTY=t(new v({start:new _,stop:new _,isStartIncluded:!1,isStopIncluded:!1})),v}),define("Core/Iso8601",["./freezeObject","./JulianDate","./TimeInterval"],function(e,t,r){"use strict";var i=e(t.fromIso8601("0000-01-01T00:00:00Z")),n=e(t.fromIso8601("9999-12-31T24:00:00Z"));return{MINIMUM_VALUE:i,MAXIMUM_VALUE:n,MAXIMUM_INTERVAL:e(new r({start:i,stop:n}))}}),define("Core/KeyboardEventModifier",["./freezeObject"],function(e){"use strict";return e({SHIFT:0,CTRL:1,ALT:2})}),define("Core/LagrangePolynomialApproximation",["./defined"],function(c){"use strict";var e={type:"Lagrange",getRequiredDataPoints:function(e){return Math.max(e+1,2)},interpolateOrderZero:function(e,t,r,i,n){var o,a;c(n)||(n=new Array(i));var s=t.length;for(o=0;o<i;o++)n[o]=0;for(o=0;o<s;o++){var l=1;for(a=0;a<s;a++)if(a!==o){var u=t[o]-t[a];l*=(e-t[a])/u}for(a=0;a<i;a++)n[a]+=l*r[o*i+a]}return n}};return e}),define("Core/LinearApproximation",["./defined","./DeveloperError"],function(c,d){"use strict";var e={type:"Linear",getRequiredDataPoints:function(e){return 2},interpolateOrderZero:function(e,t,r,i,n){if(2!==t.length)throw new d("The xTable provided to the linear interpolator must have exactly two elements.");if(i<=0)throw new d("There must be at least 1 dependent variable for each independent variable.");var o,a,s;c(n)||(n=new Array(i));var l=t[0],u=t[1];if(l===u)throw new d("Divide by zero error: xTable[0] and xTable[1] are equal");for(o=0;o<i;o++)a=r[o],s=r[o+i],n[o]=((s-a)*e+u*a-l*s)/(u-l);return n}};return e}),define("Core/loadArrayBuffer",["./Check","./defined","./deprecationWarning","./Resource"],function(i,e,n,o){"use strict";return function(e,t,r){return i.defined("urlOrResource",e),n("loadArrayBuffer","loadArrayBuffer is deprecated and will be removed in Cesium 1.44. Please use Resource.fetchArrayBuffer instead."),o.createIfNeeded(e,{headers:t,request:r}).fetchArrayBuffer()}}),define("Core/loadBlob",["./Check","./defined","./deprecationWarning","./Resource"],function(i,e,n,o){"use strict";return function(e,t,r){return i.defined("urlOrResource",e),n("loadBlob","loadBlob is deprecated and will be removed in Cesium 1.44. Please use Resource.fetchBlob instead."),o.createIfNeeded(e,{headers:t,request:r}).fetchBlob()}}),define("Core/loadCRN",["../ThirdParty/when","./CompressedTextureBuffer","./defined","./deprecationWarning","./DeveloperError","./Resource","./TaskProcessor"],function(n,o,a,s,l,u,e){"use strict";var c=new e("transcodeCRNToDXT",Number.POSITIVE_INFINITY);return function(e,t,r){if(!a(e))throw new l("resourceOrUrlOrBuffer is required.");var i;if(a(t)&&s("loadCRN.headers","The headers parameter has been deprecated. Set the headers property on the Resource parameter."),a(r)&&s("loadCRN.request","The request parameter has been deprecated. Set the request property on the Resource parameter."),i=e instanceof ArrayBuffer||ArrayBuffer.isView(e)?n.resolve(e):u.createIfNeeded(e,{headers:t,request:r}).fetchArrayBuffer(),a(i))return i.then(function(e){if(a(e)){var t=[];return e instanceof ArrayBuffer?t.push(e):(0===e.byteOffset&&e.byteLength===e.buffer.byteLength||(e=e.slice(0,e.length)),t.push(e.buffer)),c.scheduleTask(e,t)}}).then(function(e){return o.clone(e)})}}),define("Core/loadImage",["./Check","./defined","./defineProperties","./deprecationWarning","./Resource"],function(i,e,t,n,o){"use strict";function r(e,t,r){return i.defined("urlOrResource",e),n("loadImage","loadImage is deprecated and will be removed in Cesium 1.44. Please use Resource.fetchImage instead."),o.createIfNeeded(e,{request:r}).fetchImage(!1,t)}return t(r,{createImage:{get:function(){return o._Implementations.createImage},set:function(e){o._Implementations.createImage=e}},defaultCreateImage:{get:function(){return o._DefaultImplementations.createImage}}}),r}),define("Core/loadImageFromTypedArray",["../ThirdParty/when","./Check","./Resource"],function(o,a,s){"use strict";return function(e,t,r){a.typeOf.object("uint8Array",e),a.typeOf.string("format",t);var i=new Blob([e],{type:t}),n=window.URL.createObjectURL(i);return new s({url:n,request:r}).fetchImage().then(function(e){return window.URL.revokeObjectURL(n),e},function(e){return window.URL.revokeObjectURL(n),o.reject(e)})}}),define("Core/loadImageViaBlob",["./Check","./defined","./deprecationWarning","./Resource"],function(r,e,i,n){"use strict";return function(e,t){return r.defined("urlOrResource",e),i("loadImageViaBlob","loadImageViaBlob is deprecated and will be removed in Cesium 1.44. Please use Resource.fetchImage instead."),n.createIfNeeded(e,{request:t}).fetchImage(!0)}}),define("Core/loadJson",["./clone","./defined","./deprecationWarning","./DeveloperError","./Resource"],function(e,i,n,o,a){"use strict";return function(e,t,r){if(!i(e))throw new o("urlOrResource is required.");return n("loadJson","loadJson is deprecated and will be removed in Cesium 1.44. Please use Resource.fetchJson instead."),a.createIfNeeded(e,{headers:t,request:r}).fetchJson()}}),define("Core/loadJsonp",["./clone","./defined","./defineProperties","./deprecationWarning","./DeveloperError","./Resource"],function(a,s,e,l,u,c){"use strict";function t(e,t,r){if(!s(e))throw new u("urlOrResource is required.");var i,n;if(l("loadJsonp","loadJsonp is deprecated and will be removed in Cesium 1.44. Please use Resource.fetchJsonp instead."),"object"==typeof t){var o=t;s(o.parameters)&&(n=a(o.parameters)),s(o.proxy)&&(i=o.proxy),t=o.callbackParameterName}return c.createIfNeeded(e,{proxy:i,queryParameters:n,request:r}).fetchJsonp(t)}return e(t,{loadAndExecuteScript:{get:function(){return c._Implementations.loadAndExecuteScript},set:function(e){c._Implementations.loadAndExecuteScript=e}},defaultLoadAndExecuteScript:{get:function(){return c._DefaultImplementations.loadAndExecuteScript}}}),t}),define("Renderer/PixelDatatype",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={UNSIGNED_BYTE:t.UNSIGNED_BYTE,UNSIGNED_SHORT:t.UNSIGNED_SHORT,UNSIGNED_INT:t.UNSIGNED_INT,FLOAT:t.FLOAT,UNSIGNED_INT_24_8:t.UNSIGNED_INT_24_8,UNSIGNED_SHORT_4_4_4_4:t.UNSIGNED_SHORT_4_4_4_4,UNSIGNED_SHORT_5_5_5_1:t.UNSIGNED_SHORT_5_5_5_1,UNSIGNED_SHORT_5_6_5:t.UNSIGNED_SHORT_5_6_5,isPacked:function(e){return e===r.UNSIGNED_INT_24_8||e===r.UNSIGNED_SHORT_4_4_4_4||e===r.UNSIGNED_SHORT_5_5_5_1||e===r.UNSIGNED_SHORT_5_6_5},sizeInBytes:function(e){switch(e){case r.UNSIGNED_BYTE:return 1;case r.UNSIGNED_SHORT:case r.UNSIGNED_SHORT_4_4_4_4:case r.UNSIGNED_SHORT_5_5_5_1:case r.UNSIGNED_SHORT_5_6_5:return 2;case r.UNSIGNED_INT:case r.FLOAT:case r.UNSIGNED_INT_24_8:return 4}},validate:function(e){return e===r.UNSIGNED_BYTE||e===r.UNSIGNED_SHORT||e===r.UNSIGNED_INT||e===r.FLOAT||e===r.UNSIGNED_INT_24_8||e===r.UNSIGNED_SHORT_4_4_4_4||e===r.UNSIGNED_SHORT_5_5_5_1||e===r.UNSIGNED_SHORT_5_6_5}};return e(r)}),define("Core/PixelFormat",["../Renderer/PixelDatatype","./freezeObject","./WebGLConstants"],function(o,e,t){"use strict";var a={DEPTH_COMPONENT:t.DEPTH_COMPONENT,DEPTH_STENCIL:t.DEPTH_STENCIL,ALPHA:t.ALPHA,RGB:t.RGB,RGBA:t.RGBA,LUMINANCE:t.LUMINANCE,LUMINANCE_ALPHA:t.LUMINANCE_ALPHA,RGB_DXT1:t.COMPRESSED_RGB_S3TC_DXT1_EXT,RGBA_DXT1:t.COMPRESSED_RGBA_S3TC_DXT1_EXT,RGBA_DXT3:t.COMPRESSED_RGBA_S3TC_DXT3_EXT,RGBA_DXT5:t.COMPRESSED_RGBA_S3TC_DXT5_EXT,RGB_PVRTC_4BPPV1:t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG,RGB_PVRTC_2BPPV1:t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG,RGBA_PVRTC_4BPPV1:t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG,RGBA_PVRTC_2BPPV1:t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG,RGB_ETC1:t.COMPRESSED_RGB_ETC1_WEBGL,componentsLength:function(e){switch(e){case a.RGB:case a.RGBA:return 4;case a.LUMINANCE_ALPHA:return 2;case a.ALPHA:case a.LUMINANCE:default:return 1}},validate:function(e){return e===a.DEPTH_COMPONENT||e===a.DEPTH_STENCIL||e===a.ALPHA||e===a.RGB||e===a.RGBA||e===a.LUMINANCE||e===a.LUMINANCE_ALPHA||e===a.RGB_DXT1||e===a.RGBA_DXT1||e===a.RGBA_DXT3||e===a.RGBA_DXT5||e===a.RGB_PVRTC_4BPPV1||e===a.RGB_PVRTC_2BPPV1||e===a.RGBA_PVRTC_4BPPV1||e===a.RGBA_PVRTC_2BPPV1||e===a.RGB_ETC1},isColorFormat:function(e){return e===a.ALPHA||e===a.RGB||e===a.RGBA||e===a.LUMINANCE||e===a.LUMINANCE_ALPHA},isDepthFormat:function(e){return e===a.DEPTH_COMPONENT||e===a.DEPTH_STENCIL},isCompressedFormat:function(e){return e===a.RGB_DXT1||e===a.RGBA_DXT1||e===a.RGBA_DXT3||e===a.RGBA_DXT5||e===a.RGB_PVRTC_4BPPV1||e===a.RGB_PVRTC_2BPPV1||e===a.RGBA_PVRTC_4BPPV1||e===a.RGBA_PVRTC_2BPPV1||e===a.RGB_ETC1},isDXTFormat:function(e){return e===a.RGB_DXT1||e===a.RGBA_DXT1||e===a.RGBA_DXT3||e===a.RGBA_DXT5},isPVRTCFormat:function(e){return e===a.RGB_PVRTC_4BPPV1||e===a.RGB_PVRTC_2BPPV1||e===a.RGBA_PVRTC_4BPPV1||e===a.RGBA_PVRTC_2BPPV1},isETC1Format:function(e){return e===a.RGB_ETC1},compressedTextureSizeInBytes:function(e,t,r){switch(e){case a.RGB_DXT1:case a.RGBA_DXT1:case a.RGB_ETC1:return Math.floor((t+3)/4)*Math.floor((r+3)/4)*8;case a.RGBA_DXT3:case a.RGBA_DXT5:return Math.floor((t+3)/4)*Math.floor((r+3)/4)*16;case a.RGB_PVRTC_4BPPV1:case a.RGBA_PVRTC_4BPPV1:return Math.floor((Math.max(t,8)*Math.max(r,8)*4+7)/8);case a.RGB_PVRTC_2BPPV1:case a.RGBA_PVRTC_2BPPV1:return Math.floor((Math.max(t,16)*Math.max(r,8)*2+7)/8);default:return 0}},textureSizeInBytes:function(e,t,r,i){var n=a.componentsLength(e);return o.isPacked(t)&&(n=1),n*o.sizeInBytes(t)*r*i}};return e(a)}),define("Core/loadKTX",["../ThirdParty/when","./Check","./CompressedTextureBuffer","./defined","./deprecationWarning","./PixelFormat","./Resource","./RuntimeError"],function(n,o,w,S,a,T,s,E){"use strict";var A=[171,75,84,88,32,49,49,187,13,10,26,10],x=67305985,P=4;return function(e,t,r){var i;if(o.defined("resourceOrUrlOrBuffer",e),S(t)&&a("loadCRN.headers","The headers parameter has been deprecated. Set the headers property on the Resource parameter."),S(r)&&a("loadCRN.request","The request parameter has been deprecated. Set the request property on the Resource parameter."),i=e instanceof ArrayBuffer||ArrayBuffer.isView(e)?n.resolve(e):s.createIfNeeded(e,{headers:t,request:r}).fetchArrayBuffer(),S(i))return i.then(function(e){if(S(e))return function(e){for(var t,r,i=new Uint8Array(e),n=!0,o=0;o<A.length;++o)if(A[o]!==i[o]){n=!1;break}if(!n)throw new E("Invalid KTX file.");r=S(e.buffer)?(t=new DataView(e.buffer),e.byteOffset):(t=new DataView(e),0),r+=12;var a=t.getUint32(r,!0);if(r+=P,a!==x)throw new E("File is the wrong endianness.");var s=t.getUint32(r,!0);r+=P;var l=t.getUint32(r,!0);r+=P;var u=t.getUint32(r,!0);r+=P;var c=t.getUint32(r,!0);r+=P;var d=t.getUint32(r,!0);r+=P;var h=t.getUint32(r,!0);r+=P;var p=t.getUint32(r,!0);r+=P;var f=t.getUint32(r,!0);r+=P;var m=t.getUint32(r,!0);r+=P;var g=t.getUint32(r,!0);r+=P;var _=t.getUint32(r,!0);r+=P;var v=t.getUint32(r,!0);r+=P,r+=v;var y,b=t.getUint32(r,!0);if(r+=P,y=S(e.buffer)?new Uint8Array(e.buffer,r,b):new Uint8Array(e,r,b),32849===c?c=T.RGB:32856===c&&(c=T.RGBA),!T.validate(c))throw new E("glInternalFormat is not a valid format.");if(T.isCompressedFormat(c)){if(0!==s)throw new E("glType must be zero when the texture is compressed.");if(1!==l)throw new E("The type size for compressed textures must be 1.");if(0!==u)throw new E("glFormat must be zero when the texture is compressed.")}else if(d!==u)throw new E("The base internal format must be the same as the format for uncompressed textures.");if(0!==f)throw new E("3D textures are unsupported.");if(0!==m)throw new E("Texture arrays are unsupported.");if(1!==g)throw new E("Cubemaps are unsupported.");if(1<_){var C=T.isCompressedFormat(c)?T.compressedTextureSizeInBytes(c,h,p):T.textureSizeInBytes(c,h,p);y=new Uint8Array(y.buffer,y.byteOffset,C)}return new w(c,h,p,y)}(e)})}}),define("Core/loadText",["./Check","./defined","./deprecationWarning","./Resource"],function(i,e,n,o){"use strict";return function(e,t,r){return i.defined("urlOrResource",e),n("loadText","loadText is deprecated and will be removed in Cesium 1.44. Please use Resource.fetchText instead."),o.createIfNeeded(e,{headers:t,request:r}).fetchText()}}),define("Core/loadWithXhr",["../ThirdParty/when","./Check","./defineProperties","./deprecationWarning","./Resource"],function(e,t,r,i,n){"use strict";function o(e){return t.defined("options",e),i("loadWithXhr","loadWithXhr is deprecated and will be removed in Cesium 1.44. Please use Resource.fetch instead."),new n(e).fetch({responseType:e.responseType,overrideMimeType:e.overrideMimeType})}return r(o,{load:{get:function(){return n._Implementations.loadWithXhr},set:function(e){n._Implementations.loadWithXhr=e}},defaultLoad:{get:function(){return n._DefaultImplementations.loadWithXhr}}}),o}),define("Core/loadXML",["./Check","./defined","./deprecationWarning","./Resource"],function(i,e,n,o){"use strict";return function(e,t,r){return i.defined("urlOrResource",e),n("loadXML","loadXML is deprecated and will be removed in Cesium 1.44. Please use Resource.fetchXML instead."),o.createIfNeeded(e,{headers:t,request:r}).fetchXML()}}),define("Core/ManagedArray",["./Check","./defaultValue","./defineProperties"],function(r,t,e){"use strict";function i(e){e=t(e,0),this._array=new Array(e),this._length=e}return e(i.prototype,{length:{get:function(){return this._length},set:function(e){(this._length=e)>this._array.length&&(this._array.length=e)}},values:{get:function(){return this._array}}}),i.prototype.get=function(e){return r.typeOf.number.lessThan("index",e,this._array.length),this._array[e]},i.prototype.set=function(e,t){r.typeOf.number("index",e),e>=this.length&&(this.length=e+1),this._array[e]=t},i.prototype.push=function(e){var t=this.length++;this._array[t]=e},i.prototype.pop=function(){return this._array[--this.length]},i.prototype.reserve=function(e){r.typeOf.number.greaterThanOrEquals("length",e,0),e>this._array.length&&(this._array.length=e)},i.prototype.resize=function(e){r.typeOf.number.greaterThanOrEquals("length",e,0),this.length=e},i.prototype.trim=function(e){e=t(e,this.length),this._array.length=e},i}),define("Core/MapboxApi",["./Credit","./defined"],function(t,r){"use strict";var i,n={defaultAccessToken:void 0},o=!1,a="This application is using Cesium's default Mapbox access token.  Please create a new access token for the application as soon as possible and prior to deployment by visiting https://www.mapbox.com/account/apps/, and provide your token to Cesium by setting the Cesium.MapboxApi.defaultAccessToken property before constructing the CesiumWidget or any other object that uses the Mapbox API.";return n.getAccessToken=function(e){return r(e)?e:r(n.defaultAccessToken)?n.defaultAccessToken:(o||(console.log(a),o=!0),"pk.eyJ1IjoiYW5hbHl0aWNhbGdyYXBoaWNzIiwiYSI6ImNpd204Zm4wejAwNzYyeW5uNjYyZmFwdWEifQ.7i-VIZZWX8pd1bTfxIVj9g")},n.getErrorCredit=function(e){if(!r(e)&&!r(n.defaultAccessToken))return r(i)||(i=new t({text:a,showOnScreen:!0})),i},n}),define("Core/MapProjection",["./defineProperties","./DeveloperError"],function(e,t){"use strict";function r(){t.throwInstantiationError()}return e(r.prototype,{ellipsoid:{get:t.throwInstantiationError}}),r.prototype.project=t.throwInstantiationError,r.prototype.unproject=t.throwInstantiationError,r}),define("Core/Matrix2",["./Cartesian2","./Check","./defaultValue","./defined","./defineProperties","./freezeObject"],function(r,s,n,o,e,t){"use strict";function a(e,t,r,i){this[0]=n(e,0),this[1]=n(r,0),this[2]=n(t,0),this[3]=n(i,0)}a.packedLength=4,a.pack=function(e,t,r){return s.typeOf.object("value",e),s.defined("array",t),r=n(r,0),t[r++]=e[0],t[r++]=e[1],t[r++]=e[2],t[r++]=e[3],t},a.unpack=function(e,t,r){return s.defined("array",e),t=n(t,0),o(r)||(r=new a),r[0]=e[t++],r[1]=e[t++],r[2]=e[t++],r[3]=e[t++],r},a.clone=function(e,t){if(o(e))return o(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):new a(e[0],e[2],e[1],e[3])},a.fromArray=function(e,t,r){return s.defined("array",e),t=n(t,0),o(r)||(r=new a),r[0]=e[t],r[1]=e[t+1],r[2]=e[t+2],r[3]=e[t+3],r},a.fromColumnMajorArray=function(e,t){return s.defined("values",e),a.clone(e,t)},a.fromRowMajorArray=function(e,t){return s.defined("values",e),o(t)?(t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t):new a(e[0],e[1],e[2],e[3])},a.fromScale=function(e,t){return s.typeOf.object("scale",e),o(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=e.y,t):new a(e.x,0,0,e.y)},a.fromUniformScale=function(e,t){return s.typeOf.number("scale",e),o(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=e,t):new a(e,0,0,e)},a.fromRotation=function(e,t){s.typeOf.number("angle",e);var r=Math.cos(e),i=Math.sin(e);return o(t)?(t[0]=r,t[1]=i,t[2]=-i,t[3]=r,t):new a(r,-i,i,r)},a.toArray=function(e,t){return s.typeOf.object("matrix",e),o(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):[e[0],e[1],e[2],e[3]]},a.getElementIndex=function(e,t){return s.typeOf.number.greaterThanOrEquals("row",t,0),s.typeOf.number.lessThanOrEquals("row",t,1),s.typeOf.number.greaterThanOrEquals("column",e,0),s.typeOf.number.lessThanOrEquals("column",e,1),2*e+t},a.getColumn=function(e,t,r){s.typeOf.object("matrix",e),s.typeOf.number.greaterThanOrEquals("index",t,0),s.typeOf.number.lessThanOrEquals("index",t,1),s.typeOf.object("result",r);var i=2*t,n=e[i],o=e[i+1];return r.x=n,r.y=o,r},a.setColumn=function(e,t,r,i){s.typeOf.object("matrix",e),s.typeOf.number.greaterThanOrEquals("index",t,0),s.typeOf.number.lessThanOrEquals("index",t,1),s.typeOf.object("cartesian",r),s.typeOf.object("result",i);var n=2*t;return(i=a.clone(e,i))[n]=r.x,i[n+1]=r.y,i},a.getRow=function(e,t,r){s.typeOf.object("matrix",e),s.typeOf.number.greaterThanOrEquals("index",t,0),s.typeOf.number.lessThanOrEquals("index",t,1),s.typeOf.object("result",r);var i=e[t],n=e[t+2];return r.x=i,r.y=n,r},a.setRow=function(e,t,r,i){return s.typeOf.object("matrix",e),s.typeOf.number.greaterThanOrEquals("index",t,0),s.typeOf.number.lessThanOrEquals("index",t,1),s.typeOf.object("cartesian",r),s.typeOf.object("result",i),(i=a.clone(e,i))[t]=r.x,i[t+2]=r.y,i};var i=new r;a.getScale=function(e,t){return s.typeOf.object("matrix",e),s.typeOf.object("result",t),t.x=r.magnitude(r.fromElements(e[0],e[1],i)),t.y=r.magnitude(r.fromElements(e[2],e[3],i)),t};var l=new r;return a.getMaximumScale=function(e){return a.getScale(e,l),r.maximumComponent(l)},a.multiply=function(e,t,r){s.typeOf.object("left",e),s.typeOf.object("right",t),s.typeOf.object("result",r);var i=e[0]*t[0]+e[2]*t[1],n=e[0]*t[2]+e[2]*t[3],o=e[1]*t[0]+e[3]*t[1],a=e[1]*t[2]+e[3]*t[3];return r[0]=i,r[1]=o,r[2]=n,r[3]=a,r},a.add=function(e,t,r){return s.typeOf.object("left",e),s.typeOf.object("right",t),s.typeOf.object("result",r),r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r},a.subtract=function(e,t,r){return s.typeOf.object("left",e),s.typeOf.object("right",t),s.typeOf.object("result",r),r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r},a.multiplyByVector=function(e,t,r){s.typeOf.object("matrix",e),s.typeOf.object("cartesian",t),s.typeOf.object("result",r);var i=e[0]*t.x+e[2]*t.y,n=e[1]*t.x+e[3]*t.y;return r.x=i,r.y=n,r},a.multiplyByScalar=function(e,t,r){return s.typeOf.object("matrix",e),s.typeOf.number("scalar",t),s.typeOf.object("result",r),r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r},a.multiplyByScale=function(e,t,r){return s.typeOf.object("matrix",e),s.typeOf.object("scale",t),s.typeOf.object("result",r),r[0]=e[0]*t.x,r[1]=e[1]*t.x,r[2]=e[2]*t.y,r[3]=e[3]*t.y,r},a.negate=function(e,t){return s.typeOf.object("matrix",e),s.typeOf.object("result",t),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},a.transpose=function(e,t){s.typeOf.object("matrix",e),s.typeOf.object("result",t);var r=e[0],i=e[2],n=e[1],o=e[3];return t[0]=r,t[1]=i,t[2]=n,t[3]=o,t},a.abs=function(e,t){return s.typeOf.object("matrix",e),s.typeOf.object("result",t),t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t},a.equals=function(e,t){return e===t||o(e)&&o(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},a.equalsArray=function(e,t,r){return e[0]===t[r]&&e[1]===t[r+1]&&e[2]===t[r+2]&&e[3]===t[r+3]},a.equalsEpsilon=function(e,t,r){return s.typeOf.number("epsilon",r),e===t||o(e)&&o(t)&&Math.abs(e[0]-t[0])<=r&&Math.abs(e[1]-t[1])<=r&&Math.abs(e[2]-t[2])<=r&&Math.abs(e[3]-t[3])<=r},a.IDENTITY=t(new a(1,0,0,1)),a.ZERO=t(new a(0,0,0,0)),a.COLUMN0ROW0=0,a.COLUMN0ROW1=1,a.COLUMN1ROW0=2,a.COLUMN1ROW1=3,e(a.prototype,{length:{get:function(){return a.packedLength}}}),a.prototype.clone=function(e){return a.clone(this,e)},a.prototype.equals=function(e){return a.equals(this,e)},a.prototype.equalsEpsilon=function(e,t){return a.equalsEpsilon(this,e,t)},a.prototype.toString=function(){return"("+this[0]+", "+this[2]+")\n("+this[1]+", "+this[3]+")"},a}),define("Core/mergeSort",["./defined","./DeveloperError"],function(o,a){"use strict";var m=[],g=[];function s(e,t,r,i,n){if(!(n<=i)){var o=Math.floor(.5*(i+n));s(e,t,r,i,o),s(e,t,r,o+1,n),function(e,t,r,i,n,o){var a,s,l=n-i+1,u=o-n,c=m,d=g;for(a=0;a<l;++a)c[a]=e[i+a];for(s=0;s<u;++s)d[s]=e[n+s+1];s=a=0;for(var h=i;h<=o;++h){var p=c[a],f=d[s];a<l&&(u<=s||t(p,f,r)<=0)?(e[h]=p,++a):s<u&&(e[h]=f,++s)}}(e,t,r,i,o,n)}}return function(e,t,r){if(!o(e))throw new a("array is required.");if(!o(t))throw new a("comparator is required.");var i=e.length,n=Math.ceil(.5*i);m.length=n,g.length=n,s(e,t,r,0,i-1),m.length=0,g.length=0}}),define("Core/NearFarScalar",["./defaultValue","./defined","./DeveloperError"],function(n,i,o){"use strict";function a(e,t,r,i){this.near=n(e,0),this.nearValue=n(t,0),this.far=n(r,1),this.farValue=n(i,0)}return a.clone=function(e,t){if(i(e))return i(t)?(t.near=e.near,t.nearValue=e.nearValue,t.far=e.far,t.farValue=e.farValue,t):new a(e.near,e.nearValue,e.far,e.farValue)},a.packedLength=4,a.pack=function(e,t,r){if(!i(e))throw new o("value is required");if(!i(t))throw new o("array is required");return r=n(r,0),t[r++]=e.near,t[r++]=e.nearValue,t[r++]=e.far,t[r]=e.farValue,t},a.unpack=function(e,t,r){if(!i(e))throw new o("array is required");return t=n(t,0),i(r)||(r=new a),r.near=e[t++],r.nearValue=e[t++],r.far=e[t++],r.farValue=e[t],r},a.equals=function(e,t){return e===t||i(e)&&i(t)&&e.near===t.near&&e.nearValue===t.nearValue&&e.far===t.far&&e.farValue===t.farValue},a.prototype.clone=function(e){return a.clone(this,e)},a.prototype.equals=function(e){return a.equals(this,e)},a}),define("Core/Visibility",["./freezeObject"],function(e){"use strict";return e({NONE:-1,PARTIAL:0,FULL:1})}),define("Core/Occluder",["./BoundingSphere","./Cartesian3","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Math","./Rectangle","./Visibility"],function(o,C,a,f,e,m,s,l,u,c){"use strict";function g(e,t){if(!f(e))throw new m("occluderBoundingSphere is required.");if(!f(t))throw new m("camera position is required.");this._occluderPosition=C.clone(e.center),this._occluderRadius=e.radius,this._horizonDistance=0,this._horizonPlaneNormal=void 0,this._horizonPlanePosition=void 0,this._cameraPosition=void 0,this.cameraPosition=t}var d=new C;e(g.prototype,{position:{get:function(){return this._occluderPosition}},radius:{get:function(){return this._occluderRadius}},cameraPosition:{set:function(e){if(!f(e))throw new m("cameraPosition is required.");e=C.clone(e,this._cameraPosition);var t,r,i,n=C.subtract(this._occluderPosition,e,d),o=C.magnitudeSquared(n),a=this._occluderRadius*this._occluderRadius;if(a<o){t=Math.sqrt(o-a),o=1/Math.sqrt(o),r=C.multiplyByScalar(n,o,d);var s=t*t*o;i=C.add(e,C.multiplyByScalar(r,s,d),d)}else t=Number.MAX_VALUE;this._horizonDistance=t,this._horizonPlaneNormal=r,this._horizonPlanePosition=i,this._cameraPosition=e}}}),g.fromBoundingSphere=function(e,t,r){if(!f(e))throw new m("occluderBoundingSphere is required.");if(!f(t))throw new m("camera position is required.");return f(r)?(C.clone(e.center,r._occluderPosition),r._occluderRadius=e.radius,r.cameraPosition=t,r):new g(e,t)};var h=new C;g.prototype.isPointVisible=function(e){if(this._horizonDistance!==Number.MAX_VALUE){var t=C.subtract(e,this._occluderPosition,h),r=this._occluderRadius;if(0<(r=C.magnitudeSquared(t)-r*r))return r=Math.sqrt(r)+this._horizonDistance,t=C.subtract(e,this._cameraPosition,t),r*r>C.magnitudeSquared(t)}return!1};var p=new C;g.prototype.isBoundingSphereVisible=function(e){var t=C.clone(e.center,p),r=e.radius;if(this._horizonDistance===Number.MAX_VALUE)return!1;var i=C.subtract(t,this._occluderPosition,h),n=this._occluderRadius-r;if(n=C.magnitudeSquared(i)-n*n,r<this._occluderRadius)return 0<n&&(n=Math.sqrt(n)+this._horizonDistance,i=C.subtract(t,this._cameraPosition,i),n*n+r*r>C.magnitudeSquared(i));if(0<n){i=C.subtract(t,this._cameraPosition,i);var o=C.magnitudeSquared(i),a=this._occluderRadius*this._occluderRadius,s=r*r;return(this._horizonDistance*this._horizonDistance+a)*s>o*a||o<(n=Math.sqrt(n)+this._horizonDistance)*n+s}return!0};var _=new C;g.prototype.computeVisibility=function(e){if(!f(e))throw new m("occludeeBS is required.");var t=C.clone(e.center),r=e.radius;if(r>this._occluderRadius)return c.FULL;if(this._horizonDistance!==Number.MAX_VALUE){var i=C.subtract(t,this._occluderPosition,_),n=this._occluderRadius-r,o=C.magnitudeSquared(i);if(0<(n=o-n*n)){n=Math.sqrt(n)+this._horizonDistance,i=C.subtract(t,this._cameraPosition,i);var a=C.magnitudeSquared(i);return n*n+r*r<a?c.NONE:0<(n=o-(n=this._occluderRadius+r)*n)?a<(n=Math.sqrt(n)+this._horizonDistance)*n+r*r?c.FULL:c.PARTIAL:(i=C.subtract(t,this._horizonPlanePosition,i),C.dot(i,this._horizonPlaneNormal)>-r?c.PARTIAL:c.FULL)}}return c.NONE};var v=new C;g.computeOccludeePoint=function(e,t,r){if(!f(e))throw new m("occluderBoundingSphere is required.");if(!f(r))throw new m("positions is required.");if(0===r.length)throw new m("positions must contain at least one element");var i=C.clone(t),n=C.clone(e.center),o=e.radius,a=r.length;if(C.equals(n,t))throw new m("occludeePosition must be different than occluderBoundingSphere.center");var s=C.normalize(C.subtract(i,n,v),v),l=-C.dot(s,n),u=g._anyRotationVector(n,s,l),c=g._horizonToPlaneNormalDotProduct(e,s,l,u,r[0]);if(c){for(var d,h=1;h<a;++h){if(!(d=g._horizonToPlaneNormalDotProduct(e,s,l,u,r[h])))return;d<c&&(c=d)}if(!(c<.0017453283658983088)){var p=o/c;return C.add(n,C.multiplyByScalar(s,p,v),v)}}};var y=[];g.computeOccludeePointFromRectangle=function(e,t){if(!f(e))throw new m("rectangle is required.");t=a(t,s.WGS84);var r=u.subsample(e,t,0,y),i=o.fromPoints(r),n=C.ZERO;if(!C.equals(n,i.center))return g.computeOccludeePoint(new o(n,t.minimumRadius),i.center,r)};var b=new C;g._anyRotationVector=function(e,t,r){var i=C.abs(t,b),n=i.x>i.y?0:1;(0===n&&i.z>i.x||1===n&&i.z>i.y)&&(n=2);var o,a=new C;o=0===n?(i.x=e.x,i.y=e.y+1,i.z=e.z+1,C.UNIT_X):1===n?(i.x=e.x+1,i.y=e.y,i.z=e.z+1,C.UNIT_Y):(i.x=e.x+1,i.y=e.y+1,i.z=e.z,C.UNIT_Z);var s=(C.dot(t,i)+r)/-C.dot(t,o);return C.normalize(C.subtract(C.add(i,C.multiplyByScalar(o,s,a),i),e,i),i)};var w=new C;g._rotationVector=function(e,t,r,i,n){var o=C.subtract(i,e,w);if(o=C.normalize(o,o),C.dot(t,o)<.9999999847691291){var a=C.cross(t,o,o);if(C.magnitude(a)>l.EPSILON13)return C.normalize(a,new C)}return n};var S=new C,T=new C,E=new C,A=new C;return g._horizonToPlaneNormalDotProduct=function(e,t,r,i,n){var o=C.clone(n,S),a=C.clone(e.center,T),s=e.radius,l=C.subtract(a,o,E),u=C.magnitudeSquared(l),c=s*s;if(u<c)return!1;var d=u-c,h=Math.sqrt(d),p=h*(1/Math.sqrt(u))*h;l=C.normalize(l,l);var f=C.add(o,C.multiplyByScalar(l,p,A),A),m=Math.sqrt(d-p*p),g=this._rotationVector(a,t,r,o,i),_=C.fromElements(g.x*g.x*l.x+(g.x*g.y-g.z)*l.y+(g.x*g.z+g.y)*l.z,(g.x*g.y+g.z)*l.x+g.y*g.y*l.y+(g.y*g.z-g.x)*l.z,(g.x*g.z-g.y)*l.x+(g.y*g.z+g.x)*l.y+g.z*g.z*l.z,S);_=C.normalize(_,_);var v=C.multiplyByScalar(_,m,S);g=C.normalize(C.subtract(C.add(f,v,E),a,E),E);var y=C.dot(t,g);g=C.normalize(C.subtract(C.subtract(f,v,g),a,g),g);var b=C.dot(t,g);return y<b?y:b},g}),define("Core/Packable",["./DeveloperError"],function(e){"use strict";return{packedLength:void 0,pack:e.throwInstantiationError,unpack:e.throwInstantiationError}}),define("Core/PackableForInterpolation",["./DeveloperError"],function(e){"use strict";return{packedInterpolationLength:void 0,convertPackedArrayForInterpolation:e.throwInstantiationError,unpackInterpolationResult:e.throwInstantiationError}}),define("ThirdParty/measureText",[],function(){var A=function(e,t){return document.defaultView.getComputedStyle(e,null).getPropertyValue(t)};return function(e,t,r,i){var n=e.measureText(t),o=A(e.canvas,"font-family"),a=A(e.canvas,"font-size").replace("px",""),s=A(e.canvas,"font-style"),l=A(e.canvas,"font-weight"),u=!/\S/.test(t);n.fontsize=a;var c=document.createElement("div");c.style.position="absolute",c.style.opacity=0,c.style.font=s+" "+l+" "+a+"px "+o,c.innerHTML=t+"<br/>"+t,document.body.appendChild(c),n.leading=1.2*a;var d=A(c,"height");if(2*a<=(d=d.replace("px",""))&&(n.leading=d/2|0),document.body.removeChild(c),u)n.ascent=0,n.descent=0,n.bounds={minx:0,maxx:n.width,miny:0,maxy:0},n.height=0;else{var h=document.createElement("canvas");h.width=n.width+100,h.height=3*a,h.style.opacity=1,h.style.fontFamily=o,h.style.fontSize=a,h.style.fontStyle=s,h.style.fontWeight=l;var p=h.getContext("2d");p.font=s+" "+l+" "+a+"px "+o;var f=h.width,m=h.height,g=m/2;p.fillStyle="white",p.fillRect(-1,-1,f+2,m+2),r&&(p.strokeStyle="black",p.lineWidth=e.lineWidth,p.strokeText(t,50,g)),i&&(p.fillStyle="black",p.fillText(t,50,g));for(var _=p.getImageData(0,0,f,m).data,v=0,y=4*f,b=_.length;++v<b&&255===_[v];);var C=v/y|0;for(v=b-1;0<--v&&255===_[v];);var w=v/y|0;for(v=0;v<b&&255===_[v];)b<=(v+=y)&&(v=v-b+4);var S=v%y/4|0,T=1;for(v=b-3;0<=v&&255===_[v];)(v-=y)<0&&(v=b-3-4*T++);var E=v%y/4+1|0;n.ascent=g-C,n.descent=w-g,n.bounds={minx:S-50,maxx:E-50,miny:0,maxy:w-C},n.height=w-C+1}return n}}),define("Core/writeTextToCanvas",["../ThirdParty/measureText","./Color","./defaultValue","./defined","./DeveloperError"],function(v,y,b,C,w){"use strict";var S;return function(e,t){if(!C(e))throw new w("text is required.");if(""!==e){t=b(t,b.EMPTY_OBJECT);var r=b(t.font,"10px sans-serif"),i=b(t.stroke,!1),n=b(t.fill,!0),o=b(t.strokeWidth,1),a=b(t.backgroundColor,y.TRANSPARENT),s=b(t.padding,0),l=2*s,u=document.createElement("canvas");u.width=1,u.height=1,u.style.font=r;var c=u.getContext("2d");C(S)||(C(c.imageSmoothingEnabled)?S="imageSmoothingEnabled":C(c.mozImageSmoothingEnabled)?S="mozImageSmoothingEnabled":C(c.webkitImageSmoothingEnabled)?S="webkitImageSmoothingEnabled":C(c.msImageSmoothingEnabled)&&(S="msImageSmoothingEnabled")),c.font=r,c.lineJoin="round",c.lineWidth=o,c[S]=!1,c.textBaseline=b(t.textBaseline,"bottom"),u.style.visibility="hidden",document.body.appendChild(u);var d=v(c,e,i,n);u.dimensions=d,document.body.removeChild(u),u.style.visibility="";var h=-d.bounds.minx,p=Math.ceil(d.width)+h+l,f=d.height+l,m=f-(f-d.ascent+l)+l;if(u.width=p,u.height=f,c.font=r,c.lineJoin="round",c.lineWidth=o,c[S]=!1,a!==y.TRANSPARENT&&(c.fillStyle=a.toCssColorString(),c.fillRect(0,0,u.width,u.height)),i){var g=b(t.strokeColor,y.BLACK);c.strokeStyle=g.toCssColorString(),c.strokeText(e,h+s,m)}if(n){var _=b(t.fillColor,y.WHITE);c.fillStyle=_.toCssColorString(),c.fillText(e,h+s,m)}return u}}}),define("Core/PinBuilder",["./buildModuleUrl","./Color","./defined","./DeveloperError","./Resource","./writeTextToCanvas"],function(i,l,f,n,m,g){"use strict";function e(){this._cache={}}e.prototype.fromColor=function(e,t){if(!f(e))throw new n("color is required");if(!f(t))throw new n("size is required");return o(void 0,void 0,e,t,this._cache)},e.prototype.fromUrl=function(e,t,r){if(!f(e))throw new n("url is required");if(!f(t))throw new n("color is required");if(!f(r))throw new n("size is required");return o(e,void 0,t,r,this._cache)},e.prototype.fromMakiIconId=function(e,t,r){if(!f(e))throw new n("id is required");if(!f(t))throw new n("color is required");if(!f(r))throw new n("size is required");return o(i("Assets/Textures/maki/"+encodeURIComponent(e)+".png"),void 0,t,r,this._cache)},e.prototype.fromText=function(e,t,r){if(!f(e))throw new n("text is required");if(!f(t))throw new n("color is required");if(!f(r))throw new n("size is required");return o(void 0,e,t,r,this._cache)};var _=new l;function v(e,t,r){var i=r/2.5,n=i,o=i;t.width>t.height?o=i*(t.height/t.width):t.width<t.height&&(n=i*(t.width/t.height));var a=Math.round((r-n)/2),s=Math.round(7/24*r-o/2);e.globalCompositeOperation="destination-out",e.drawImage(t,a-1,s,n,o),e.drawImage(t,a,s-1,n,o),e.drawImage(t,a+1,s,n,o),e.drawImage(t,a,s+1,n,o),e.globalCompositeOperation="destination-over",e.fillStyle=l.BLACK.toCssColorString(),e.fillRect(a-1,s-1,n+2,o+2),e.globalCompositeOperation="destination-out",e.drawImage(t,a,s,n,o),e.globalCompositeOperation="destination-over",e.fillStyle=l.WHITE.toCssColorString(),e.fillRect(a-1,s-2,n+2,o+2)}var y=new Array(4);function o(e,t,r,i,n){y[0]=e,y[1]=t,y[2]=r,y[3]=i;var o=JSON.stringify(y),a=n[o];if(f(a))return a;var s=document.createElement("canvas");s.width=i,s.height=i;var l,u,c,d=s.getContext("2d");if(u=r,c=i,(l=d).save(),l.scale(c/24,c/24),l.fillStyle=u.toCssColorString(),l.strokeStyle=u.brighten(.6,_).toCssColorString(),l.lineWidth=.846,l.beginPath(),l.moveTo(6.72,.422),l.lineTo(17.28,.422),l.bezierCurveTo(18.553,.422,19.577,1.758,19.577,3.415),l.lineTo(19.577,10.973),l.bezierCurveTo(19.577,12.63,18.553,13.966,17.282,13.966),l.lineTo(14.386,14.008),l.lineTo(11.826,23.578),l.lineTo(9.614,14.008),l.lineTo(6.719,13.965),l.bezierCurveTo(5.446,13.983,4.422,12.629,4.422,10.972),l.lineTo(4.422,3.416),l.bezierCurveTo(4.423,1.76,5.447,.423,6.718,.423),l.closePath(),l.fill(),l.stroke(),l.restore(),f(e)){var h=m.createIfNeeded(e).fetchImage().then(function(e){return v(d,e,i),n[o]=s});return n[o]=h}if(f(t)){var p=g(t,{font:"bold "+i+"px sans-serif"});v(d,p,i)}return n[o]=s}return e}),define("Core/PlaneGeometry",["./BoundingSphere","./Cartesian3","./Check","./ComponentDatatype","./defaultValue","./defined","./Geometry","./GeometryAttribute","./GeometryAttributes","./PrimitiveType","./VertexFormat"],function(u,c,n,d,o,a,h,p,f,m,s){"use strict";function l(e){e=o(e,o.EMPTY_OBJECT);var t=o(e.vertexFormat,s.DEFAULT);this._vertexFormat=t,this._workerName="createPlaneGeometry"}l.packedLength=s.packedLength,l.pack=function(e,t,r){return n.typeOf.object("value",e),n.defined("array",t),r=o(r,0),s.pack(e._vertexFormat,t,r),t};var g=new s,_={vertexFormat:g};l.unpack=function(e,t,r){n.defined("array",e),t=o(t,0);var i=s.unpack(e,t,g);return a(r)?(r._vertexFormat=s.clone(i,r._vertexFormat),r):new l(_)};var v=new c(-.5,-.5,0),y=new c(.5,.5,0);return l.createGeometry=function(e){var t,r,i=e._vertexFormat,n=new f;if(i.position){if((r=new Float64Array(12))[0]=v.x,r[1]=v.y,r[2]=0,r[3]=y.x,r[4]=v.y,r[5]=0,r[6]=y.x,r[7]=y.y,r[8]=0,r[9]=v.x,r[10]=y.y,r[11]=0,n.position=new p({componentDatatype:d.DOUBLE,componentsPerAttribute:3,values:r}),i.normal){var o=new Float32Array(12);o[0]=0,o[1]=0,o[2]=1,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=1,o[9]=0,o[10]=0,o[11]=1,n.normal=new p({componentDatatype:d.FLOAT,componentsPerAttribute:3,values:o})}if(i.st){var a=new Float32Array(8);a[0]=0,a[1]=0,a[2]=1,a[3]=0,a[4]=1,a[5]=1,a[6]=0,a[7]=1,n.st=new p({componentDatatype:d.FLOAT,componentsPerAttribute:2,values:a})}if(i.tangent){var s=new Float32Array(12);s[0]=1,s[1]=0,s[2]=0,s[3]=1,s[4]=0,s[5]=0,s[6]=1,s[7]=0,s[8]=0,s[9]=1,s[10]=0,s[11]=0,n.tangent=new p({componentDatatype:d.FLOAT,componentsPerAttribute:3,values:s})}if(i.bitangent){var l=new Float32Array(12);l[0]=0,l[1]=1,l[2]=0,l[3]=0,l[4]=1,l[5]=0,l[6]=0,l[7]=1,l[8]=0,l[9]=0,l[10]=1,l[11]=0,n.bitangent=new p({componentDatatype:d.FLOAT,componentsPerAttribute:3,values:l})}(t=new Uint16Array(6))[0]=0,t[1]=1,t[2]=2,t[3]=0,t[4]=2,t[5]=3}return new h({attributes:n,indices:t,primitiveType:m.TRIANGLES,boundingSphere:new u(c.ZERO,Math.sqrt(2))})},l}),define("Core/PlaneOutlineGeometry",["./BoundingSphere","./Cartesian3","./Check","./ComponentDatatype","./defaultValue","./defined","./Geometry","./GeometryAttribute","./GeometryAttributes","./PrimitiveType"],function(i,n,o,a,e,s,l,u,c,d){"use strict";function h(){this._workerName="createPlaneOutlineGeometry"}h.packedLength=0,h.pack=function(e,t){return o.defined("value",e),o.defined("array",t),t},h.unpack=function(e,t,r){return o.defined("array",e),s(r)?r:new h};var p=new n(-.5,-.5,0),f=new n(.5,.5,0);return h.createGeometry=function(){var e=new c,t=new Uint16Array(8),r=new Float64Array(12);return r[0]=p.x,r[1]=p.y,r[2]=p.z,r[3]=f.x,r[4]=p.y,r[5]=p.z,r[6]=f.x,r[7]=f.y,r[8]=p.z,r[9]=p.x,r[10]=f.y,r[11]=p.z,e.position=new u({componentDatatype:a.DOUBLE,componentsPerAttribute:3,values:r}),t[0]=0,t[1]=1,t[2]=1,t[3]=2,t[4]=2,t[5]=3,t[6]=3,t[7]=0,new l({attributes:e,indices:t,primitiveType:d.LINES,boundingSphere:new i(n.ZERO,Math.sqrt(2))})},h}),define("Core/pointInsideTriangle",["./barycentricCoordinates","./Cartesian3"],function(n,e){"use strict";var o=new e;return function(e,t,r,i){return n(e,t,r,i,o),0<o.x&&0<o.y&&0<o.z}}),define("Core/Queue",["./defineProperties"],function(e){"use strict";function t(){this._array=[],this._offset=0,this._length=0}return e(t.prototype,{length:{get:function(){return this._length}}}),t.prototype.enqueue=function(e){this._array.push(e),this._length++},t.prototype.dequeue=function(){if(0!==this._length){var e=this._array,t=this._offset,r=e[t];return e[t]=void 0,10<++t&&2*t>e.length&&(this._array=e.slice(t),t=0),this._offset=t,this._length--,r}},t.prototype.peek=function(){if(0!==this._length)return this._array[this._offset]},t.prototype.contains=function(e){return-1!==this._array.indexOf(e)},t.prototype.clear=function(){this._array.length=this._offset=this._length=0},t.prototype.sort=function(e){0<this._offset&&(this._array=this._array.slice(this._offset),this._offset=0),this._array.sort(e)},t}),define("Core/PolygonGeometryLibrary",["./arrayRemoveDuplicates","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryPipeline","./IndexDatatype","./Math","./PolygonPipeline","./PrimitiveType","./Queue","./WindingOrder"],function(S,T,w,h,E,p,A,x,P,f,D,O,I,M,R,L){"use strict";var N={computeHierarchyPackedLength:function(e){for(var t=0,r=[e];0<r.length;){var i=r.pop();if(E(i)){t+=2;var n=i.positions,o=i.holes;if(E(n)&&(t+=n.length*T.packedLength),E(o))for(var a=o.length,s=0;s<a;++s)r.push(o[s])}}return t},packPolygonHierarchy:function(e,t,r){for(var i=[e];0<i.length;){var n=i.pop();if(E(n)){var o=n.positions,a=n.holes;if(t[r++]=E(o)?o.length:0,t[r++]=E(a)?a.length:0,E(o))for(var s=o.length,l=0;l<s;++l,r+=3)T.pack(o[l],t,r);if(E(a))for(var u=a.length,c=0;c<u;++c)i.push(a[c])}}return r},unpackPolygonHierarchy:function(e,t){for(var r=e[t++],i=e[t++],n=new Array(r),o=0<i?new Array(i):void 0,a=0;a<r;++a,t+=T.packedLength)n[a]=T.unpack(e,t);for(var s=0;s<i;++s)o[s]=N.unpackPolygonHierarchy(e,t),t=o[s].startingIndex,delete o[s].startingIndex;return{positions:n,holes:o,startingIndex:t}}},m=new T;N.subdivideLineCount=function(e,t,r){var i=T.distance(e,t)/r,n=Math.max(0,Math.ceil(Math.log(i)/Math.log(2)));return Math.pow(2,n)},N.subdivideLine=function(e,t,r,i){var n=N.subdivideLineCount(e,t,r),o=T.distance(e,t),a=o/n;E(i)||(i=[]);var s=i;s.length=3*n;for(var l,u,c,d,h=0,p=0;p<n;p++){var f=(l=e,u=t,c=p*a,d=o,T.subtract(u,l,m),T.multiplyByScalar(m,c/d,m),T.add(l,m,m),[m.x,m.y,m.z]);s[h++]=f[0],s[h++]=f[1],s[h++]=f[2]}return s};var g=new T,_=new T,v=new T,y=new T;N.scaleToGeodeticHeightExtruded=function(e,t,r,i,n){i=h(i,p.WGS84);var o=g,a=_,s=v,l=y;if(E(e)&&E(e.attributes)&&E(e.attributes.position))for(var u=e.attributes.position.values,c=u.length/2,d=0;d<c;d+=3)T.fromArray(u,d,s),i.geodeticSurfaceNormal(s,o),l=i.scaleToGeodeticSurface(s,l),a=T.multiplyByScalar(o,r,a),a=T.add(l,a,a),u[d+c]=a.x,u[d+1+c]=a.y,u[d+2+c]=a.z,n&&(l=T.clone(s,l)),a=T.multiplyByScalar(o,t,a),a=T.add(l,a,a),u[d]=a.x,u[d+1]=a.y,u[d+2]=a.z;return e},N.polygonsFromHierarchy=function(e,t,r,i){var n=[],o=[],a=new R;for(a.enqueue(e);0!==a.length;){var s=a.dequeue(),l=s.positions,u=s.holes;if(!((l=S(l,T.equalsEpsilon,!0)).length<3)){var c=r.projectPointsOntoPlane(l),d=[],h=I.computeWindingOrder2D(c);h===L.CLOCKWISE&&(c.reverse(),l=l.slice().reverse());var p,f,m=l.slice(),g=E(u)?u.length:0,_=[];for(p=0;p<g;p++){var v=u[p],y=S(v.positions,T.equalsEpsilon,!0);if(!(y.length<3)){var b=r.projectPointsOntoPlane(y);(h=I.computeWindingOrder2D(b))===L.CLOCKWISE&&(b.reverse(),y=y.slice().reverse()),_.push(y),d.push(m.length),m=m.concat(y),c=c.concat(b);var C=0;for(E(v.holes)&&(C=v.holes.length),f=0;f<C;f++)a.enqueue(v.holes[f])}}if(!t){for(p=0;p<l.length;p++)i.scaleToGeodeticSurface(l[p],l[p]);for(p=0;p<_.length;p++){var w=_[p];for(f=0;f<w.length;++f)i.scaleToGeodeticSurface(w[f],w[f])}}n.push({outerRing:l,holes:_}),o.push({positions:m,positions2D:c,holes:d})}}return{hierarchy:n,polygons:o}},N.createGeometryFromPositions=function(e,t,r,i,n){var o=I.triangulate(t.positions2D,t.holes);o.length<3&&(o=[0,1,2]);var a=t.positions;if(i){for(var s=a.length,l=new Array(3*s),u=0,c=0;c<s;c++){var d=a[c];l[u++]=d.x,l[u++]=d.y,l[u++]=d.z}var h=new A({attributes:{position:new x({componentDatatype:w.DOUBLE,componentsPerAttribute:3,values:l})},indices:o,primitiveType:M.TRIANGLES});return n.normal?f.computeNormal(h):h}return I.computeSubdivision(e,a,o,r)};var k=[],F=new T,B=new T;return N.computeWallGeometry=function(e,t,r,i){var n,o,a,s,l,u=e.length,c=0;if(i)for(o=3*u*2,n=new Array(2*o),a=0;a<u;a++)s=e[a],l=e[(a+1)%u],n[c]=n[c+o]=s.x,n[++c]=n[c+o]=s.y,n[++c]=n[c+o]=s.z,n[++c]=n[c+o]=l.x,n[++c]=n[c+o]=l.y,n[++c]=n[c+o]=l.z,++c;else{var d=O.chordLength(r,t.maximumRadius),h=0;for(a=0;a<u;a++)h+=N.subdivideLineCount(e[a],e[(a+1)%u],d);for(o=3*(h+u),n=new Array(2*o),a=0;a<u;a++){s=e[a],l=e[(a+1)%u];for(var p=N.subdivideLine(s,l,d,k),f=p.length,m=0;m<f;++m,++c)n[c]=p[m],n[c+o]=p[m];n[c]=l.x,n[c+o]=l.x,n[++c]=l.y,n[c+o]=l.y,n[++c]=l.z,n[c+o]=l.z,++c}}u=n.length;var g=D.createTypedArray(u/3,u-6*e.length),_=0;for(u/=6,a=0;a<u;a++){var v=a,y=v+1,b=v+u,C=b+1;s=T.fromArray(n,3*v,F),l=T.fromArray(n,3*y,B),T.equalsEpsilon(s,l,O.EPSILON14)||(g[_++]=v,g[_++]=b,g[_++]=y,g[_++]=y,g[_++]=b,g[_++]=C)}return new A({attributes:new P({position:new x({componentDatatype:w.DOUBLE,componentsPerAttribute:3,values:n})}),indices:g,primitiveType:M.TRIANGLES})},N}),define("Core/PolygonGeometry",["./BoundingRectangle","./BoundingSphere","./Cartesian2","./Cartesian3","./Cartographic","./Check","./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./EllipsoidTangentPlane","./Geometry","./GeometryAttribute","./GeometryInstance","./GeometryPipeline","./IndexDatatype","./Math","./Matrix3","./PolygonGeometryLibrary","./PolygonPipeline","./Quaternion","./Rectangle","./VertexFormat","./WindingOrder"],function(e,x,V,z,t,_,q,v,P,r,h,y,D,O,G,I,M,R,W,H,L,N,j,b,C,k){"use strict";var F=new V,B=new z,U=new j,Y=new H;var s=new t,l=new t;function X(e,t,r,i){var n=i.cartesianToCartographic(e,s).height,o=i.cartesianToCartographic(t,l);o.height=n,i.cartographicToCartesian(o,t);var a=i.cartesianToCartographic(r,l);a.height=n-100,i.cartographicToCartesian(a,r)}var Q=new e,Z=new z,K=new z,J=new z,$=new z,ee=new z,te=new z,re=new z,ie=new z,ne=new z,oe=new V,ae=new V,se=new z,le=new j,ue=new H;function ce(e){var t=e.vertexFormat,r=e.geometry,i=e.shadowVolume;if(t.st||t.normal||t.tangent||t.bitangent||i){var n=e.boundingRectangle,o=e.tangentPlane,a=e.ellipsoid,s=e.stRotation,l=e.wall,u=e.top||l,c=e.bottom||l,d=e.perPositionHeight,h=oe;h.x=n.x,h.y=n.y;var p,f=r.attributes.position.values,m=f.length,g=t.st?new Float32Array(m/3*2):void 0;t.normal&&(p=d&&u&&!l?r.attributes.normal.values:new Float32Array(m));var _=t.tangent?new Float32Array(m):void 0,v=t.bitangent?new Float32Array(m):void 0,y=i?new Float32Array(m):void 0,b=0,C=0,w=K,S=J,T=$,E=!0,A=j.fromAxisAngle(o._plane.normal,s,le),x=H.fromQuaternion(A,ue),P=0,D=0;u&&c&&(P=m/2,D=m/3,m/=2);for(var O=0;O<m;O+=3){var I=z.fromArray(f,O,se);if(t.st){var M=H.multiplyByVector(x,I,Z);M=a.scaleToGeodeticSurface(M,M);var R=o.projectPointOntoPlane(M,ae);V.subtract(R,h,R);var L=W.clamp(R.x/n.width,0,1),N=W.clamp(R.y/n.height,0,1);c&&(g[b+D]=L,g[b+1+D]=N),u&&(g[b]=L,g[b+1]=N),b+=2}if(t.normal||t.tangent||t.bitangent||i){var k=C+1,F=C+2;if(l){if(O+3<m){var B=z.fromArray(f,O+3,ee);if(E){var U=z.fromArray(f,O+m,te);d&&X(I,B,U,a),z.subtract(B,I,B),z.subtract(U,I,U),w=z.normalize(z.cross(U,B,w),w),E=!1}z.equalsEpsilon(B,I,W.EPSILON10)&&(E=!0)}(t.tangent||t.bitangent)&&(T=a.geodeticSurfaceNormal(I,T),t.tangent&&(S=z.normalize(z.cross(T,w,S),S)))}else w=a.geodeticSurfaceNormal(I,w),(t.tangent||t.bitangent)&&(d&&(re=z.fromArray(p,C,re),ie=z.cross(z.UNIT_Z,re,ie),ie=z.normalize(H.multiplyByVector(x,ie,ie),ie),t.bitangent&&(ne=z.normalize(z.cross(re,ie,ne),ne))),S=z.cross(z.UNIT_Z,w,S),S=z.normalize(H.multiplyByVector(x,S,S),S),t.bitangent&&(T=z.normalize(z.cross(w,S,T),T)));t.normal&&(e.wall?(p[C+P]=w.x,p[k+P]=w.y,p[F+P]=w.z):c&&(p[C+P]=-w.x,p[k+P]=-w.y,p[F+P]=-w.z),(u&&!d||l)&&(p[C]=w.x,p[k]=w.y,p[F]=w.z)),i&&(l&&(w=a.geodeticSurfaceNormal(I,w)),y[C+P]=-w.x,y[k+P]=-w.y,y[F+P]=-w.z),t.tangent&&(e.wall?(_[C+P]=S.x,_[k+P]=S.y,_[F+P]=S.z):c&&(_[C+P]=-S.x,_[k+P]=-S.y,_[F+P]=-S.z),u&&(_[F]=d?(_[C]=ie.x,_[k]=ie.y,ie.z):(_[C]=S.x,_[k]=S.y,S.z))),t.bitangent&&(c&&(v[C+P]=T.x,v[k+P]=T.y,v[F+P]=T.z),u&&(v[F]=d?(v[C]=ne.x,v[k]=ne.y,ne.z):(v[C]=T.x,v[k]=T.y,T.z))),C+=3}}t.st&&(r.attributes.st=new G({componentDatatype:q.FLOAT,componentsPerAttribute:2,values:g})),t.normal&&(r.attributes.normal=new G({componentDatatype:q.FLOAT,componentsPerAttribute:3,values:p})),t.tangent&&(r.attributes.tangent=new G({componentDatatype:q.FLOAT,componentsPerAttribute:3,values:_})),t.bitangent&&(r.attributes.bitangent=new G({componentDatatype:q.FLOAT,componentsPerAttribute:3,values:v})),i&&(r.attributes.extrudeDirection=new G({componentDatatype:q.FLOAT,componentsPerAttribute:3,values:y}))}return r}var de=[];function he(e,t,r,i,n,o,a,s){var l,u={walls:[]};if(o||a){var c,d,h=L.createGeometryFromPositions(e,t,r,n,s),p=h.attributes.position.values,f=h.indices;if(o&&a){var m=p.concat(p);c=m.length/3,(d=R.createTypedArray(c,2*f.length)).set(f);var g=f.length,_=c/2;for(l=0;l<g;l+=3){var v=d[l]+_,y=d[l+1]+_,b=d[l+2]+_;d[l+g]=b,d[l+1+g]=y,d[l+2+g]=v}if(h.attributes.position.values=m,n){var C=h.attributes.normal.values;h.attributes.normal.values=new Float32Array(m.length),h.attributes.normal.values.set(C)}h.indices=d}else if(a){for(c=p.length/3,d=R.createTypedArray(c,f.length),l=0;l<f.length;l+=3)d[l]=f[l+2],d[l+1]=f[l+1],d[l+2]=f[l];h.indices=d}u.topAndBottom=new I({geometry:h})}var w=i.outerRing,S=D.fromPoints(w,e),T=S.projectPointsOntoPlane(w,de),E=N.computeWindingOrder2D(T);E===k.CLOCKWISE&&(w=w.slice().reverse());var A=L.computeWallGeometry(w,e,r,n);u.walls.push(new I({geometry:A}));var x=i.holes;for(l=0;l<x.length;l++){var P=x[l];T=(S=D.fromPoints(P,e)).projectPointsOntoPlane(P,de),(E=N.computeWindingOrder2D(T))===k.COUNTER_CLOCKWISE&&(P=P.slice().reverse()),A=L.computeWallGeometry(P,e,r),u.walls.push(new I({geometry:A}))}return u}function w(e){if(_.typeOf.object("options",e),_.typeOf.object("options.polygonHierarchy",e.polygonHierarchy),P(e.perPositionHeight)&&e.perPositionHeight&&P(e.height))throw new h("Cannot use both options.perPositionHeight and options.height");var t=e.polygonHierarchy,r=v(e.vertexFormat,C.DEFAULT),i=v(e.ellipsoid,y.WGS84),n=v(e.granularity,W.RADIANS_PER_DEGREE),o=v(e.stRotation,0),a=v(e.height,0),s=v(e.perPositionHeight,!1),l=e.extrudedHeight,u=P(l);if(!s&&u)if(W.equalsEpsilon(a,l,W.EPSILON10))l=void 0,u=!1;else{var c=l;l=Math.min(c,a),a=Math.max(c,a)}this._vertexFormat=C.clone(r),this._ellipsoid=y.clone(i),this._granularity=n,this._stRotation=o,this._height=a,this._extrudedHeight=v(l,0),this._extrude=u,this._closeTop=v(e.closeTop,!0),this._closeBottom=v(e.closeBottom,!0),this._polygonHierarchy=t,this._perPositionHeight=s,this._shadowVolume=v(e.shadowVolume,!1),this._workerName="createPolygonGeometry";var d=t.positions;!P(d)||d.length<3?this._rectangle=new b:this._rectangle=b.fromCartesianArray(d,i),this.packedLength=L.computeHierarchyPackedLength(t)+y.packedLength+C.packedLength+b.packedLength+10}w.fromPositions=function(e){return e=v(e,v.EMPTY_OBJECT),_.defined("options.positions",e.positions),new w({polygonHierarchy:{positions:e.positions},height:e.height,extrudedHeight:e.extrudedHeight,vertexFormat:e.vertexFormat,stRotation:e.stRotation,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,closeTop:e.closeTop,closeBottom:e.closeBottom})},w.pack=function(e,t,r){return _.typeOf.object("value",e),_.defined("array",t),r=v(r,0),r=L.packPolygonHierarchy(e._polygonHierarchy,t,r),y.pack(e._ellipsoid,t,r),r+=y.packedLength,C.pack(e._vertexFormat,t,r),r+=C.packedLength,b.pack(e._rectangle,t,r),r+=b.packedLength,t[r++]=e._height,t[r++]=e._extrudedHeight,t[r++]=e._granularity,t[r++]=e._stRotation,t[r++]=e._extrude?1:0,t[r++]=e._perPositionHeight?1:0,t[r++]=e._closeTop?1:0,t[r++]=e._closeBottom?1:0,t[r++]=e._shadowVolume?1:0,t[r]=e.packedLength,t};var S=y.clone(y.UNIT_SPHERE),T=new C,E=new b,A={polygonHierarchy:{}};return w.unpack=function(e,t,r){_.defined("array",e),t=v(t,0);var i=L.unpackPolygonHierarchy(e,t);t=i.startingIndex,delete i.startingIndex;var n=y.unpack(e,t,S);t+=y.packedLength;var o=C.unpack(e,t,T);t+=C.packedLength;var a=b.unpack(e,t,E);t+=b.packedLength;var s=e[t++],l=e[t++],u=e[t++],c=e[t++],d=1===e[t++],h=1===e[t++],p=1===e[t++],f=1===e[t++],m=1===e[t++],g=e[t];return P(r)||(r=new w(A)),r._polygonHierarchy=i,r._ellipsoid=y.clone(n,r._ellipsoid),r._vertexFormat=C.clone(o,r._vertexFormat),r._height=s,r._extrudedHeight=l,r._granularity=u,r._stRotation=c,r._extrude=d,r._perPositionHeight=h,r._closeTop=p,r._closeBottom=f,r._rectangle=b.clone(a),r._shadowVolume=m,r.packedLength=g,r},w.createGeometry=function(e){var t=e._vertexFormat,r=e._ellipsoid,i=e._granularity,n=e._stRotation,o=e._height,a=e._extrudedHeight,s=e._extrude,l=e._polygonHierarchy,u=e._perPositionHeight,c=e._closeTop,d=e._closeBottom,h=l.positions;if(!(h.length<3)){var p=D.fromPoints(h,r),f=L.polygonsFromHierarchy(l,u,p,r),m=f.hierarchy,g=f.polygons;if(0!==m.length){var _,v,y=[],b={perPositionHeight:u,vertexFormat:t,geometry:void 0,tangentPlane:p,boundingRectangle:function(e,t,r,i){for(var n=j.fromAxisAngle(e._plane.normal,r,U),o=H.fromQuaternion(n,Y),a=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,l=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,c=t.length,d=0;d<c;++d){var h=z.clone(t[d],B);H.multiplyByVector(o,h,h);var p=e.projectPointOntoPlane(h,F);P(p)&&(a=Math.min(a,p.x),s=Math.max(s,p.x),l=Math.min(l,p.y),u=Math.max(u,p.y))}return i.x=a,i.y=l,i.width=s-a,i.height=u-l,i}(p,h=m[0].outerRing,n,Q),ellipsoid:r,stRotation:n,bottom:!1,top:!0,wall:!1};if(s)for(b.top=c,b.bottom=d,b.shadowVolume=e._shadowVolume,v=0;v<g.length;v++){var C;_=he(r,g[v],i,m[v],u,c,d,t),c&&d?(C=_.topAndBottom,b.geometry=L.scaleToGeodeticHeightExtruded(C.geometry,o,a,r,u)):c?((C=_.topAndBottom).geometry.attributes.position.values=N.scaleToGeodeticHeight(C.geometry.attributes.position.values,o,r,!u),b.geometry=C.geometry):d&&((C=_.topAndBottom).geometry.attributes.position.values=N.scaleToGeodeticHeight(C.geometry.attributes.position.values,a,r,!0),b.geometry=C.geometry),(c||d)&&(b.wall=!1,C.geometry=ce(b),y.push(C));var w=_.walls;b.wall=!0;for(var S=0;S<w.length;S++){var T=w[S];b.geometry=L.scaleToGeodeticHeightExtruded(T.geometry,o,a,r,u),T.geometry=ce(b),y.push(T)}}else for(v=0;v<g.length;v++)(_=new I({geometry:L.createGeometryFromPositions(r,g[v],i,u,t)})).geometry.attributes.position.values=N.scaleToGeodeticHeight(_.geometry.attributes.position.values,o,r,!u),b.geometry=_.geometry,_.geometry=ce(b),y.push(_);(_=M.combineInstances(y)[0]).attributes.position.values=new Float64Array(_.attributes.position.values),_.indices=R.createTypedArray(_.attributes.position.values.length/3,_.indices);var E=_.attributes,A=x.fromVertices(E.position.values);return t.position||delete E.position,new O({attributes:E,indices:_.indices,primitiveType:_.primitiveType,boundingSphere:A})}}},w.createShadowVolume=function(e,t,r){var i=e._granularity,n=e._ellipsoid,o=t(i,n),a=r(i,n);return new w({polygonHierarchy:e._polygonHierarchy,ellipsoid:n,stRotation:e._stRotation,granularity:i,perPositionHeight:!1,extrudedHeight:o,height:a,vertexFormat:C.POSITION_ONLY,shadowVolume:!0})},r(w.prototype,{rectangle:{get:function(){return this._rectangle}}}),w}),define("Core/PolygonHierarchy",["./defined"],function(r){"use strict";return function(e,t){this.positions=r(e)?e:[],this.holes=r(t)?t:[]}}),define("Core/PolygonOutlineGeometry",["./arrayRemoveDuplicates","./BoundingSphere","./Cartesian3","./Check","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./EllipsoidTangentPlane","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryInstance","./GeometryPipeline","./IndexDatatype","./Math","./PolygonGeometryLibrary","./PolygonPipeline","./PrimitiveType","./Queue","./WindingOrder"],function(C,w,S,d,b,h,T,u,p,E,A,x,P,D,O,I,M,R,L,N,k,F){"use strict";var B=[],U=[];function V(e,t,r,i){var n,o,a=E.fromPoints(t,e).projectPointsOntoPlane(t,B);L.computeWindingOrder2D(a)===F.CLOCKWISE&&(a.reverse(),t=t.slice().reverse());var s=t.length,l=0;if(i)for(n=new Float64Array(2*s*3),o=0;o<s;o++){var u=t[o],c=t[(o+1)%s];n[l++]=u.x,n[l++]=u.y,n[l++]=u.z,n[l++]=c.x,n[l++]=c.y,n[l++]=c.z}else{var d=0;for(o=0;o<s;o++)d+=R.subdivideLineCount(t[o],t[(o+1)%s],r);for(n=new Float64Array(3*d),o=0;o<s;o++)for(var h=R.subdivideLine(t[o],t[(o+1)%s],r,U),p=h.length,f=0;f<p;++f)n[l++]=h[f]}var m=2*(s=n.length/3),g=I.createTypedArray(s,m);for(o=l=0;o<s-1;o++)g[l++]=o,g[l++]=o+1;return g[l++]=s-1,g[l++]=0,new D({geometry:new A({attributes:new P({position:new x({componentDatatype:b.DOUBLE,componentsPerAttribute:3,values:n})}),indices:g,primitiveType:N.LINES})})}function z(e,t,r,i){var n,o,a=E.fromPoints(t,e).projectPointsOntoPlane(t,B);L.computeWindingOrder2D(a)===F.CLOCKWISE&&(a.reverse(),t=t.slice().reverse());var s=t.length,l=new Array(s),u=0;if(i)for(n=new Float64Array(2*s*3*2),o=0;o<s;++o){l[o]=u/3;var c=t[o],d=t[(o+1)%s];n[u++]=c.x,n[u++]=c.y,n[u++]=c.z,n[u++]=d.x,n[u++]=d.y,n[u++]=d.z}else{var h=0;for(o=0;o<s;o++)h+=R.subdivideLineCount(t[o],t[(o+1)%s],r);for(n=new Float64Array(3*h*2),o=0;o<s;++o){l[o]=u/3;for(var p=R.subdivideLine(t[o],t[(o+1)%s],r,U),f=p.length,m=0;m<f;++m)n[u++]=p[m]}}s=n.length/6;var g=l.length,_=2*(2*s+g),v=I.createTypedArray(s,_);for(o=u=0;o<s;++o)v[u++]=o,v[u++]=(o+1)%s,v[u++]=o+s,v[u++]=(o+1)%s+s;for(o=0;o<g;o++){var y=l[o];v[u++]=y,v[u++]=y+s}return new D({geometry:new A({attributes:new P({position:new x({componentDatatype:b.DOUBLE,componentsPerAttribute:3,values:n})}),indices:v,primitiveType:N.LINES})})}function f(e){if(d.typeOf.object("options",e),d.typeOf.object("options.polygonHierarchy",e.polygonHierarchy),T(e.perPositionHeight)&&e.perPositionHeight&&T(e.height))throw new u("Cannot use both options.perPositionHeight and options.height");var t=e.polygonHierarchy,r=h(e.ellipsoid,p.WGS84),i=h(e.granularity,M.RADIANS_PER_DEGREE),n=h(e.height,0),o=h(e.perPositionHeight,!1),a=e.extrudedHeight,s=T(a);if(s&&!o){var l=a;a=Math.min(l,n),n=Math.max(l,n)}this._ellipsoid=p.clone(r),this._granularity=i,this._height=n,this._extrudedHeight=h(a,0),this._extrude=s,this._polygonHierarchy=t,this._perPositionHeight=o,this._workerName="createPolygonOutlineGeometry",this.packedLength=R.computeHierarchyPackedLength(t)+p.packedLength+6}f.pack=function(e,t,r){return d.typeOf.object("value",e),d.defined("array",t),r=h(r,0),r=R.packPolygonHierarchy(e._polygonHierarchy,t,r),p.pack(e._ellipsoid,t,r),r+=p.packedLength,t[r++]=e._height,t[r++]=e._extrudedHeight,t[r++]=e._granularity,t[r++]=e._extrude?1:0,t[r++]=e._perPositionHeight?1:0,t[r++]=e.packedLength,t};var m=p.clone(p.UNIT_SPHERE),g={polygonHierarchy:{}};return f.unpack=function(e,t,r){d.defined("array",e),t=h(t,0);var i=R.unpackPolygonHierarchy(e,t);t=i.startingIndex,delete i.startingIndex;var n=p.unpack(e,t,m);t+=p.packedLength;var o=e[t++],a=e[t++],s=e[t++],l=1===e[t++],u=1===e[t++],c=e[t++];return T(r)||(r=new f(g)),r._polygonHierarchy=i,r._ellipsoid=p.clone(n,r._ellipsoid),r._height=o,r._extrudedHeight=a,r._granularity=s,r._extrude=l,r._perPositionHeight=u,r.packedLength=c,r},f.fromPositions=function(e){return e=h(e,h.EMPTY_OBJECT),d.defined("options.positions",e.positions),new f({polygonHierarchy:{positions:e.positions},height:e.height,extrudedHeight:e.extrudedHeight,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight})},f.createGeometry=function(e){var t,r=e._ellipsoid,i=e._granularity,n=e._height,o=e._extrudedHeight,a=e._extrude,s=e._polygonHierarchy,l=e._perPositionHeight,u=[],c=new k;for(c.enqueue(s);0!==c.length;){var d=c.dequeue(),h=d.positions;if(!((h=C(h,S.equalsEpsilon,!0)).length<3)){var p=d.holes?d.holes.length:0;for(t=0;t<p;t++){var f=d.holes[t];if(f.positions=C(f.positions,S.equalsEpsilon,!0),!(f.positions.length<3)){u.push(f.positions);var m=0;T(f.holes)&&(m=f.holes.length);for(var g=0;g<m;g++)c.enqueue(f.holes[g])}}u.push(h)}}if(0!==u.length){var _,v=[],y=M.chordLength(i,r.maximumRadius);if(a)for(t=0;t<u.length;t++)(_=z(r,u[t],y,l)).geometry=R.scaleToGeodeticHeightExtruded(_.geometry,n,o,r,l),v.push(_);else for(t=0;t<u.length;t++)(_=V(r,u[t],y,l)).geometry.attributes.position.values=L.scaleToGeodeticHeight(_.geometry.attributes.position.values,n,r,!l),v.push(_);_=O.combineInstances(v)[0];var b=w.fromVertices(_.attributes.position.values);return new A({attributes:_.attributes,indices:_.indices,primitiveType:_.primitiveType,boundingSphere:b})}},f}),define("Core/PolylineGeometry",["./arrayRemoveDuplicates","./BoundingSphere","./Cartesian3","./Color","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryType","./IndexDatatype","./Math","./PolylinePipeline","./PrimitiveType","./VertexFormat"],function(j,Y,X,Q,Z,p,K,f,m,J,$,ee,te,re,ie,ne,oe,g){"use strict";var ae=[];function se(e,t,r,i,n){var o,a=ae;a.length=n;var s=r.red,l=r.green,u=r.blue,c=r.alpha,d=i.red,h=i.green,p=i.blue,f=i.alpha;if(Q.equals(r,i)){for(o=0;o<n;o++)a[o]=Q.clone(r);return a}var m=(d-s)/n,g=(h-l)/n,_=(p-u)/n,v=(f-c)/n;for(o=0;o<n;o++)a[o]=new Q(s+o*m,l+o*g,u+o*_,c+o*v);return a}function _(e){var t=(e=p(e,p.EMPTY_OBJECT)).positions,r=e.colors,i=p(e.width,1),n=p(e.colorsPerVertex,!1);if(!K(t)||t.length<2)throw new f("At least two positions are required.");if("number"!=typeof i)throw new f("width must be a number");if(K(r)&&(n&&r.length<t.length||!n&&r.length<t.length-1))throw new f("colors has an invalid length.");this._positions=t,this._colors=r,this._width=i,this._colorsPerVertex=n,this._vertexFormat=g.clone(p(e.vertexFormat,g.DEFAULT)),this._followSurface=p(e.followSurface,!0),this._granularity=p(e.granularity,ie.RADIANS_PER_DEGREE),this._ellipsoid=m.clone(p(e.ellipsoid,m.WGS84)),this._workerName="createPolylineGeometry";var o=1+t.length*X.packedLength;o+=K(r)?1+r.length*Q.packedLength:1,this.packedLength=o+m.packedLength+g.packedLength+4}_.pack=function(e,t,r){if(!K(e))throw new f("value is required");if(!K(t))throw new f("array is required");var i;r=p(r,0);var n=e._positions,o=n.length;for(t[r++]=o,i=0;i<o;++i,r+=X.packedLength)X.pack(n[i],t,r);var a=e._colors;for(o=K(a)?a.length:0,t[r++]=o,i=0;i<o;++i,r+=Q.packedLength)Q.pack(a[i],t,r);return m.pack(e._ellipsoid,t,r),r+=m.packedLength,g.pack(e._vertexFormat,t,r),r+=g.packedLength,t[r++]=e._width,t[r++]=e._colorsPerVertex?1:0,t[r++]=e._followSurface?1:0,t[r]=e._granularity,t};var v=m.clone(m.UNIT_SPHERE),y=new g,b={positions:void 0,colors:void 0,ellipsoid:v,vertexFormat:y,width:void 0,colorsPerVertex:void 0,followSurface:void 0,granularity:void 0};_.unpack=function(e,t,r){if(!K(e))throw new f("array is required");var i;t=p(t,0);var n=e[t++],o=new Array(n);for(i=0;i<n;++i,t+=X.packedLength)o[i]=X.unpack(e,t);var a=0<(n=e[t++])?new Array(n):void 0;for(i=0;i<n;++i,t+=Q.packedLength)a[i]=Q.unpack(e,t);var s=m.unpack(e,t,v);t+=m.packedLength;var l=g.unpack(e,t,y);t+=g.packedLength;var u=e[t++],c=1===e[t++],d=1===e[t++],h=e[t];return K(r)?(r._positions=o,r._colors=a,r._ellipsoid=m.clone(s,r._ellipsoid),r._vertexFormat=g.clone(l,r._vertexFormat),r._width=u,r._colorsPerVertex=c,r._followSurface=d,r._granularity=h,r):(b.positions=o,b.colors=a,b.width=u,b.colorsPerVertex=c,b.followSurface=d,b.granularity=h,new _(b))};var le=new X,ue=new X,ce=new X,de=new X;return _.createGeometry=function(e){var t,r,i,n=e._width,o=e._vertexFormat,a=e._colors,s=e._colorsPerVertex,l=e._followSurface,u=e._granularity,c=e._ellipsoid,d=j(e._positions,X.equalsEpsilon),h=d.length;if(!(h<2||n<=0)){if(l){var p=ne.extractHeights(d,c),f=ie.chordLength(u,c.maximumRadius);if(K(a)){var m=1;for(t=0;t<h-1;++t)m+=ne.numberOfPoints(d[t],d[t+1],f);var g=new Array(m),_=0;for(t=0;t<h-1;++t){var v=d[t],y=d[t+1],b=a[t],C=ne.numberOfPoints(v,y,f);if(s&&t<m){var w=se(0,0,b,a[t+1],C),S=w.length;for(r=0;r<S;++r)g[_++]=w[r]}else for(r=0;r<C;++r)g[_++]=Q.clone(b)}g[_]=Q.clone(a[a.length-1]),a=g,ae.length=0}d=ne.generateCartesianArc({positions:d,minDistance:f,ellipsoid:c,height:p})}var T,E=4*(h=d.length)-4,A=new Float64Array(3*E),x=new Float64Array(3*E),P=new Float64Array(3*E),D=new Float32Array(2*E),O=o.st?new Float32Array(2*E):void 0,I=K(a)?new Uint8Array(4*E):void 0,M=0,R=0,L=0,N=0;for(r=0;r<h;++r){var k,F;0===r?(T=le,X.subtract(d[0],d[1],T),X.add(d[0],T,T)):T=d[r-1],X.clone(T,ce),X.clone(d[r],ue),r===h-1?(T=le,X.subtract(d[h-1],d[h-2],T),X.add(d[h-1],T,T)):T=d[r+1],X.clone(T,de),K(I)&&(k=0===r||s?a[r]:a[r-1],r!==h-1&&(F=a[r]));var B=r===h-1?2:4;for(i=0===r?2:0;i<B;++i){X.pack(ue,A,M),X.pack(ce,x,M),X.pack(de,P,M),M+=3;var U=i-2<0?-1:1;if(D[R++]=i%2*2-1,D[R++]=U*n,o.st&&(O[L++]=r/(h-1),O[L++]=Math.max(D[R-2],0)),K(I)){var V=i<2?k:F;I[N++]=Q.floatToByte(V.red),I[N++]=Q.floatToByte(V.green),I[N++]=Q.floatToByte(V.blue),I[N++]=Q.floatToByte(V.alpha)}}}var z=new ee;z.position=new $({componentDatatype:Z.DOUBLE,componentsPerAttribute:3,values:A}),z.prevPosition=new $({componentDatatype:Z.DOUBLE,componentsPerAttribute:3,values:x}),z.nextPosition=new $({componentDatatype:Z.DOUBLE,componentsPerAttribute:3,values:P}),z.expandAndWidth=new $({componentDatatype:Z.FLOAT,componentsPerAttribute:2,values:D}),o.st&&(z.st=new $({componentDatatype:Z.FLOAT,componentsPerAttribute:2,values:O})),K(I)&&(z.color=new $({componentDatatype:Z.UNSIGNED_BYTE,componentsPerAttribute:4,values:I,normalize:!0}));var q=re.createTypedArray(E,6*h-6),G=0,W=0,H=h-1;for(r=0;r<H;++r)q[W++]=G,q[W++]=G+2,q[W++]=G+1,q[W++]=G+1,q[W++]=G+2,q[W++]=G+3,G+=4;return new J({attributes:z,indices:q,primitiveType:oe.TRIANGLES,boundingSphere:Y.fromPoints(d),geometryType:te.POLYLINES})}},_}),define("Core/PolylineVolumeGeometry",["./arrayRemoveDuplicates","./BoundingRectangle","./BoundingSphere","./Cartesian2","./Cartesian3","./ComponentDatatype","./CornerType","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryPipeline","./IndexDatatype","./Math","./oneTimeWarning","./PolygonPipeline","./PolylineVolumeGeometryLibrary","./PrimitiveType","./VertexFormat","./WindingOrder"],function(o,a,I,d,h,M,n,p,f,m,g,R,L,N,k,F,s,B,U,l,V,_,u){"use strict";function v(e){var t=(e=p(e,p.EMPTY_OBJECT)).polylinePositions,r=e.shapePositions;if(!f(t))throw new m("options.polylinePositions is required.");if(!f(r))throw new m("options.shapePositions is required.");this._positions=t,this._shape=r,this._ellipsoid=g.clone(p(e.ellipsoid,g.WGS84)),this._cornerType=p(e.cornerType,n.ROUNDED),this._vertexFormat=_.clone(p(e.vertexFormat,_.DEFAULT)),this._granularity=p(e.granularity,s.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeGeometry";var i=1+t.length*h.packedLength;i+=1+r.length*d.packedLength,this.packedLength=i+g.packedLength+_.packedLength+2}v.pack=function(e,t,r){if(!f(e))throw new m("value is required");if(!f(t))throw new m("array is required");var i;r=p(r,0);var n=e._positions,o=n.length;for(t[r++]=o,i=0;i<o;++i,r+=h.packedLength)h.pack(n[i],t,r);var a=e._shape;for(o=a.length,t[r++]=o,i=0;i<o;++i,r+=d.packedLength)d.pack(a[i],t,r);return g.pack(e._ellipsoid,t,r),r+=g.packedLength,_.pack(e._vertexFormat,t,r),r+=_.packedLength,t[r++]=e._cornerType,t[r]=e._granularity,t};var y=g.clone(g.UNIT_SPHERE),b=new _,C={polylinePositions:void 0,shapePositions:void 0,ellipsoid:y,vertexFormat:b,cornerType:void 0,granularity:void 0};v.unpack=function(e,t,r){if(!f(e))throw new m("array is required");var i;t=p(t,0);var n=e[t++],o=new Array(n);for(i=0;i<n;++i,t+=h.packedLength)o[i]=h.unpack(e,t);n=e[t++];var a=new Array(n);for(i=0;i<n;++i,t+=d.packedLength)a[i]=d.unpack(e,t);var s=g.unpack(e,t,y);t+=g.packedLength;var l=_.unpack(e,t,b);t+=_.packedLength;var u=e[t++],c=e[t];return f(r)?(r._positions=o,r._shape=a,r._ellipsoid=g.clone(s,r._ellipsoid),r._vertexFormat=_.clone(l,r._vertexFormat),r._cornerType=u,r._granularity=c,r):(C.polylinePositions=o,C.shapePositions=a,C.cornerType=u,C.granularity=c,new v(C))};var c=new a;return v.createGeometry=function(e){var t=e._positions,r=o(t,h.equalsEpsilon),i=e._shape;if(i=l.removeDuplicatesFromShape(i),!(r.length<2||i.length<3)){U.computeWindingOrder2D(i)===u.CLOCKWISE&&i.reverse();var n=a.fromPoints(i,c);return function(e,t,r,i){var n=new N;i.position&&(n.position=new L({componentDatatype:M.DOUBLE,componentsPerAttribute:3,values:e}));var o,a,s,l,u,c,d=t.length,h=e.length/3,p=(h-2*d)/(2*d),f=U.triangulate(t),m=(p-1)*d*6+2*f.length,g=F.createTypedArray(h,m),_=2*d,v=0;for(o=0;o<p-1;o++){for(a=0;a<d-1;a++)c=(s=2*a+o*d*2)+_,u=(l=s+1)+_,g[v++]=l,g[v++]=s,g[v++]=u,g[v++]=u,g[v++]=s,g[v++]=c;u=(l=1+(s=2*d-2+o*d*2))+_,c=s+_,g[v++]=l,g[v++]=s,g[v++]=u,g[v++]=u,g[v++]=s,g[v++]=c}if(i.st||i.tangent||i.bitangent){var y,b,C=new Float32Array(2*h),w=1/(p-1),S=1/r.height,T=r.height/2,E=0;for(o=0;o<p;o++){for(y=o*w,b=S*(t[0].y+T),C[E++]=y,C[E++]=b,a=1;a<d;a++)b=S*(t[a].y+T),C[E++]=y,C[E++]=b,C[E++]=y,C[E++]=b;b=S*(t[0].y+T),C[E++]=y,C[E++]=b}for(a=0;a<d;a++)y=0,b=S*(t[a].y+T),C[E++]=y,C[E++]=b;for(a=0;a<d;a++)y=(p-1)*w,b=S*(t[a].y+T),C[E++]=y,C[E++]=b;n.st=new L({componentDatatype:M.FLOAT,componentsPerAttribute:2,values:new Float32Array(C)})}var A=h-2*d;for(o=0;o<f.length;o+=3){var x=f[o]+A,P=f[o+1]+A,D=f[o+2]+A;g[v++]=x,g[v++]=P,g[v++]=D,g[v++]=D+d,g[v++]=P+d,g[v++]=x+d}var O=new R({attributes:n,indices:g,boundingSphere:I.fromVertices(e),primitiveType:V.TRIANGLES});if(i.normal&&(O=k.computeNormal(O)),i.tangent||i.bitangent){try{O=k.computeTangentAndBitangent(O)}catch(e){B("polyline-volume-tangent-bitangent","Unable to compute tangents and bitangents for polyline volume geometry")}i.tangent||(O.attributes.tangent=void 0),i.bitangent||(O.attributes.bitangent=void 0),i.st||(O.attributes.st=void 0)}return O}(l.computePositions(r,i,n,e,!0),i,n,e._vertexFormat)}},v}),define("Core/PolylineVolumeOutlineGeometry",["./arrayRemoveDuplicates","./BoundingRectangle","./BoundingSphere","./Cartesian2","./Cartesian3","./ComponentDatatype","./CornerType","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PolygonPipeline","./PolylineVolumeGeometryLibrary","./PrimitiveType","./WindingOrder"],function(o,a,p,c,d,f,n,h,m,g,_,v,y,b,C,s,l,u,w,S){"use strict";function T(e){var t=(e=h(e,h.EMPTY_OBJECT)).polylinePositions,r=e.shapePositions;if(!m(t))throw new g("options.polylinePositions is required.");if(!m(r))throw new g("options.shapePositions is required.");this._positions=t,this._shape=r,this._ellipsoid=_.clone(h(e.ellipsoid,_.WGS84)),this._cornerType=h(e.cornerType,n.ROUNDED),this._granularity=h(e.granularity,s.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeOutlineGeometry";var i=1+t.length*d.packedLength;i+=1+r.length*c.packedLength,this.packedLength=i+_.packedLength+2}T.pack=function(e,t,r){if(!m(e))throw new g("value is required");if(!m(t))throw new g("array is required");var i;r=h(r,0);var n=e._positions,o=n.length;for(t[r++]=o,i=0;i<o;++i,r+=d.packedLength)d.pack(n[i],t,r);var a=e._shape;for(o=a.length,t[r++]=o,i=0;i<o;++i,r+=c.packedLength)c.pack(a[i],t,r);return _.pack(e._ellipsoid,t,r),r+=_.packedLength,t[r++]=e._cornerType,t[r]=e._granularity,t};var E=_.clone(_.UNIT_SPHERE),A={polylinePositions:void 0,shapePositions:void 0,ellipsoid:E,height:void 0,cornerType:void 0,granularity:void 0};T.unpack=function(e,t,r){if(!m(e))throw new g("array is required");var i;t=h(t,0);var n=e[t++],o=new Array(n);for(i=0;i<n;++i,t+=d.packedLength)o[i]=d.unpack(e,t);n=e[t++];var a=new Array(n);for(i=0;i<n;++i,t+=c.packedLength)a[i]=c.unpack(e,t);var s=_.unpack(e,t,E);t+=_.packedLength;var l=e[t++],u=e[t];return m(r)?(r._positions=o,r._shape=a,r._ellipsoid=_.clone(s,r._ellipsoid),r._cornerType=l,r._granularity=u,r):(A.polylinePositions=o,A.shapePositions=a,A.cornerType=l,A.granularity=u,new T(A))};var x=new a;return T.createGeometry=function(e){var t=e._positions,r=o(t,d.equalsEpsilon),i=e._shape;if(i=u.removeDuplicatesFromShape(i),!(r.length<2||i.length<3)){l.computeWindingOrder2D(i)===S.CLOCKWISE&&i.reverse();var n=a.fromPoints(i,x);return function(e,t){var r=new b;r.position=new y({componentDatatype:f.DOUBLE,componentsPerAttribute:3,values:e});var i,n,o=t.length,a=r.position.values.length/3,s=e.length/3/o,l=C.createTypedArray(a,2*o*(s+1)),u=0,c=(i=0)*o;for(n=0;n<o-1;n++)l[u++]=n+c,l[u++]=n+c+1;for(l[u++]=o-1+c,l[u++]=c,c=(i=s-1)*o,n=0;n<o-1;n++)l[u++]=n+c,l[u++]=n+c+1;for(l[u++]=o-1+c,l[u++]=c,i=0;i<s-1;i++){var d=o*i,h=d+o;for(n=0;n<o;n++)l[u++]=n+d,l[u++]=n+h}return new v({attributes:r,indices:C.createTypedArray(a,l),boundingSphere:p.fromVertices(e),primitiveType:w.LINES})}(u.computePositions(r,i,n,e,!1),i)}},T}),define("Core/QuaternionSpline",["./defaultValue","./defined","./defineProperties","./DeveloperError","./Quaternion","./Spline"],function(i,u,e,n,c,t){"use strict";function r(e){var a,s,l,t=(e=i(e,i.EMPTY_OBJECT)).points,r=e.times;if(!u(t)||!u(r))throw new n("points and times are required.");if(t.length<2)throw new n("points.length must be greater than or equal to 2.");if(r.length!==t.length)throw new n("times.length must be equal to points.length.");this._times=r,this._points=t,this._evaluateFunction=(s=(a=this).points,l=a.times,function(e,t){u(t)||(t=new c);var r=a._lastTimeIndex=a.findTimeInterval(e,a._lastTimeIndex),i=(e-l[r])/(l[r+1]-l[r]),n=s[r],o=s[r+1];return c.fastSlerp(n,o,i,t)}),this._lastTimeIndex=0}return e(r.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}}),r.prototype.findTimeInterval=t.prototype.findTimeInterval,r.prototype.wrapTime=t.prototype.wrapTime,r.prototype.clampTime=t.prototype.clampTime,r.prototype.evaluate=function(e,t){return this._evaluateFunction(e,t)},r}),define("Core/RectangleGeometryLibrary",["./Cartesian3","./Cartographic","./defined","./DeveloperError","./GeographicProjection","./Math","./Matrix2","./Rectangle"],function(T,e,y,E,t,A,x,P){"use strict";var b=Math.cos,C=Math.sin,w=Math.sqrt,r={computePosition:function(e,t,r,i,n){var o=e.ellipsoid.radiiSquared,a=e.nwCorner,s=e.rectangle,l=a.latitude-e.granYCos*t+r*e.granXSin,u=b(l),c=C(l),d=o.z*c,h=a.longitude+t*e.granYSin+r*e.granXCos,p=u*b(h),f=u*C(h),m=o.x*p,g=o.y*f,_=w(m*p+g*f+d*c);if(i.x=m/_,i.y=g/_,i.z=d/_,y(e.vertexFormat)&&e.vertexFormat.st){var v=e.stNwCorner;y(v)?(l=v.latitude-e.stGranYCos*t+r*e.stGranXSin,h=v.longitude+t*e.stGranYSin+r*e.stGranXCos,n.x=(h-e.stWest)*e.lonScalar,n.y=(l-e.stSouth)*e.latScalar):(n.x=(h-s.west)*e.lonScalar,n.y=(l-s.south)*e.latScalar)}}},D=new x,O=new T,I=new e,M=new T,R=new t;function L(e,t,r,i,n,o,a){var s=Math.cos(t),l=i*s,u=r*s,c=Math.sin(t),d=i*c,h=r*c;O=R.project(e,O),O=T.subtract(O,M,O);var p=x.fromRotation(t,D);O=x.multiplyByVector(p,O,O),O=T.add(O,M,O),o-=1,a-=1;var f=(e=R.unproject(O,e)).latitude,m=f+o*h,g=f-l*a,_=f-l*a+o*h,v=Math.max(f,m,g,_),y=Math.min(f,m,g,_),b=e.longitude,C=b+o*u,w=b+a*d,S=b+a*d+o*u;return{north:v,south:y,east:Math.max(b,C,w,S),west:Math.min(b,C,w,S),granYCos:l,granYSin:d,granXCos:u,granXSin:h,nwCorner:e}}return r.computeOptions=function(e,t,r,i){var n,o,a,s,l,u=e._granularity,c=e._ellipsoid,d=e._surfaceHeight,h=e._rotation,p=e._stRotation,f=e._extrudedHeight,m=t.east,g=t.west,_=t.north,v=t.south,y=_-v;s=(a=m<g?(l=A.TWO_PI-g+m)/((n=Math.ceil(l/u)+1)-1):(l=m-g)/((n=Math.ceil(l/u)+1)-1),y/((o=Math.ceil(y/u)+1)-1)),r=P.northwest(t,r);var b=P.center(t,I);0===h&&0===p||(b.longitude<r.longitude&&(b.longitude+=A.TWO_PI),M=R.project(b,M));var C={granYCos:s,granYSin:0,granXCos:a,granXSin:0,ellipsoid:c,surfaceHeight:d,extrudedHeight:f,nwCorner:r,rectangle:t,width:n,height:o};if(0!==h){var w=L(r,h,a,s,0,n,o);if(_=w.north,v=w.south,m=w.east,g=w.west,_<-A.PI_OVER_TWO||_>A.PI_OVER_TWO||v<-A.PI_OVER_TWO||v>A.PI_OVER_TWO)throw new E("Rotated rectangle is invalid.  It crosses over either the north or south pole.");C.granYCos=w.granYCos,C.granYSin=w.granYSin,C.granXCos=w.granXCos,C.granXSin=w.granXSin,t.north=_,t.south=v,t.east=m,t.west=g}if(0!==p){h-=p;var S=L(i=P.northwest(t,i),h,a,s,0,n,o);C.stGranYCos=S.granYCos,C.stGranXCos=S.granXCos,C.stGranYSin=S.granYSin,C.stGranXSin=S.granXSin,C.stNwCorner=i,C.stWest=S.west,C.stSouth=S.south}return C},r}),define("Core/RectangleGeometry",["./BoundingSphere","./Cartesian2","./Cartesian3","./Cartographic","./Check","./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryInstance","./GeometryPipeline","./IndexDatatype","./Math","./Matrix3","./PolygonPipeline","./PrimitiveType","./Quaternion","./Rectangle","./RectangleGeometryLibrary","./VertexFormat"],function(_,e,Q,t,g,Z,v,y,r,i,b,C,K,n,J,$,ee,te,O,re,o,w,S,I,ie){"use strict";var ne=new Q,oe=new Q,ae=new Q,se=new Q,T=new S,M=new e,E=new _,A=new _;function le(e,t){var r=new C({attributes:new n,primitiveType:o.TRIANGLES});return r.attributes.position=new K({componentDatatype:Z.DOUBLE,componentsPerAttribute:3,values:t.positions}),e.normal&&(r.attributes.normal=new K({componentDatatype:Z.FLOAT,componentsPerAttribute:3,values:t.normals})),e.tangent&&(r.attributes.tangent=new K({componentDatatype:Z.FLOAT,componentsPerAttribute:3,values:t.tangents})),e.bitangent&&(r.attributes.bitangent=new K({componentDatatype:Z.FLOAT,componentsPerAttribute:3,values:t.bitangents})),r}var ue=new Q,ce=new Q;function de(e){for(var t=e.vertexFormat,r=e.ellipsoid,i=e.size,n=e.height,o=e.width,a=t.position?new Float64Array(3*i):void 0,s=t.st?new Float32Array(2*i):void 0,l=0,u=0,c=ne,d=M,h=Number.MAX_VALUE,p=Number.MAX_VALUE,f=-Number.MAX_VALUE,m=-Number.MAX_VALUE,g=0;g<n;++g)for(var _=0;_<o;++_)I.computePosition(e,g,_,c,d),a[l++]=c.x,a[l++]=c.y,a[l++]=c.z,t.st&&(s[u++]=d.x,s[u++]=d.y,h=Math.min(h,d.x),p=Math.min(p,d.y),f=Math.max(f,d.x),m=Math.max(m,d.y));if(t.st&&(h<0||p<0||1<f||1<m))for(var v=0;v<s.length;v+=2)s[v]=(s[v]-h)/(f-h),s[v+1]=(s[v+1]-p)/(m-p);for(var y=function(e,t,r,i){var n=e.length,o=t.normal?new Float32Array(n):void 0,a=t.tangent?new Float32Array(n):void 0,s=t.bitangent?new Float32Array(n):void 0,l=0,u=se,c=ae,d=oe;if(t.normal||t.tangent||t.bitangent)for(var h=0;h<n;h+=3){var p=Q.fromArray(e,h,ne),f=l+1,m=l+2;d=r.geodeticSurfaceNormal(p,d),(t.tangent||t.bitangent)&&(Q.cross(Q.UNIT_Z,d,c),O.multiplyByVector(i,c,c),Q.normalize(c,c),t.bitangent&&Q.normalize(Q.cross(d,c,u),u)),t.normal&&(o[l]=d.x,o[f]=d.y,o[m]=d.z),t.tangent&&(a[l]=c.x,a[f]=c.y,a[m]=c.z),t.bitangent&&(s[l]=u.x,s[f]=u.y,s[m]=u.z),l+=3}return le(t,{positions:e,normals:o,tangents:a,bitangents:s})}(a,t,r,e.tangentRotationMatrix),b=6*(o-1)*(n-1),C=ee.createTypedArray(i,b),w=0,S=0,T=0;T<n-1;++T){for(var E=0;E<o-1;++E){var A=w,x=A+o,P=x+1,D=A+1;C[S++]=A,C[S++]=x,C[S++]=D,C[S++]=D,C[S++]=x,C[S++]=P,++w}++w}return y.indices=C,t.st&&(y.attributes.st=new K({componentDatatype:Z.FLOAT,componentsPerAttribute:2,values:s})),y}function he(e,t,r,i,n){return e[t++]=i[r],e[t++]=i[r+1],e[t++]=i[r+2],e[t++]=n[r],e[t++]=n[r+1],e[t++]=n[r+2],e}function pe(e,t,r,i){return e[t++]=i[r],e[t++]=i[r+1],e[t++]=i[r],e[t++]=i[r+1],e}var fe=new ie;function x(e){var t,r=e.shadowVolume,i=e.vertexFormat,n=e.surfaceHeight,o=e.extrudedHeight,a=Math.min(o,n),s=Math.max(o,n),l=e.height,u=e.width,c=e.ellipsoid;r&&(e.vertexFormat=ie.clone(i,fe),e.vertexFormat.normal=!0);var d=de(e);if(te.equalsEpsilon(a,s,te.EPSILON10))return d;var h=re.scaleToGeodeticHeight(d.attributes.position.values,s,c,!1),p=(h=new Float64Array(h)).length,f=2*p,m=new Float64Array(f);m.set(h);var g=re.scaleToGeodeticHeight(d.attributes.position.values,a,c);m.set(g,p),d.attributes.position.values=m;var _,v,y=i.normal?new Float32Array(f):void 0,b=i.tangent?new Float32Array(f):void 0,C=i.bitangent?new Float32Array(f):void 0,w=i.st?new Float32Array(f/3*2):void 0;if(i.normal){for(v=d.attributes.normal.values,y.set(v),t=0;t<p;t++)v[t]=-v[t];y.set(v,p),d.attributes.normal.values=y}if(r){v=d.attributes.normal.values,i.normal||(d.attributes.normal=void 0);var S=new Float32Array(f);for(t=0;t<p;t++)v[t]=-v[t];S.set(v,p),d.attributes.extrudeDirection=new K({componentDatatype:Z.FLOAT,componentsPerAttribute:3,values:S})}if(i.tangent){var T=d.attributes.tangent.values;for(b.set(T),t=0;t<p;t++)T[t]=-T[t];b.set(T,p),d.attributes.tangent.values=b}if(i.bitangent){var E=d.attributes.bitangent.values;C.set(E),C.set(E,p),d.attributes.bitangent.values=C}i.st&&(_=d.attributes.st.values,w.set(_),w.set(_,p/3*2),d.attributes.st.values=w);var A=d.indices,x=A.length,P=p/3,D=ee.createTypedArray(f/3,2*x);for(D.set(A),t=0;t<x;t+=3)D[t+x]=A[t+2]+P,D[t+1+x]=A[t+1]+P,D[t+2+x]=A[t]+P;d.indices=D;var O,I=2*u+2*l-4,M=2*(I+4),R=new Float64Array(3*M),L=r?new Float32Array(3*M):void 0,N=i.st?new Float32Array(2*M):void 0,k=0,F=0,B=0,U=u*l;for(t=0;t<U;t+=u)R=he(R,k,O=3*t,h,g),k+=6,i.st&&(N=pe(N,F,2*t,_),F+=4),r&&(B+=3,L[B++]=v[O],L[B++]=v[O+1],L[B++]=v[O+2]);for(t=U-u;t<U;t++)R=he(R,k,O=3*t,h,g),k+=6,i.st&&(N=pe(N,F,2*t,_),F+=4),r&&(B+=3,L[B++]=v[O],L[B++]=v[O+1],L[B++]=v[O+2]);for(t=U-1;0<t;t-=u)R=he(R,k,O=3*t,h,g),k+=6,i.st&&(N=pe(N,F,2*t,_),F+=4),r&&(B+=3,L[B++]=v[O],L[B++]=v[O+1],L[B++]=v[O+2]);for(t=u-1;0<=t;t--)R=he(R,k,O=3*t,h,g),k+=6,i.st&&(N=pe(N,F,2*t,_),F+=4),r&&(B+=3,L[B++]=v[O],L[B++]=v[O+1],L[B++]=v[O+2]);var V=function(e,t,r){var i=e.length,n=t.normal?new Float32Array(i):void 0,o=t.tangent?new Float32Array(i):void 0,a=t.bitangent?new Float32Array(i):void 0,s=0,l=0,u=0,c=!0,d=se,h=ae,p=oe;if(t.normal||t.tangent||t.bitangent)for(var f=0;f<i;f+=6){var m=Q.fromArray(e,f,ne),g=Q.fromArray(e,(f+6)%i,ue);if(c){var _=Q.fromArray(e,(f+3)%i,ce);Q.subtract(g,m,g),Q.subtract(_,m,_),p=Q.normalize(Q.cross(_,g,p),p),c=!1}Q.equalsEpsilon(g,m,te.EPSILON10)&&(c=!0),(t.tangent||t.bitangent)&&(d=r.geodeticSurfaceNormal(m,d),t.tangent&&(h=Q.normalize(Q.cross(d,p,h),h))),t.normal&&(n[s++]=p.x,n[s++]=p.y,n[s++]=p.z,n[s++]=p.x,n[s++]=p.y,n[s++]=p.z),t.tangent&&(o[l++]=h.x,o[l++]=h.y,o[l++]=h.z,o[l++]=h.x,o[l++]=h.y,o[l++]=h.z),t.bitangent&&(a[u++]=d.x,a[u++]=d.y,a[u++]=d.z,a[u++]=d.x,a[u++]=d.y,a[u++]=d.z)}return le(t,{positions:e,normals:n,tangents:o,bitangents:a})}(R,i,c);i.st&&(V.attributes.st=new K({componentDatatype:Z.FLOAT,componentsPerAttribute:2,values:N})),r&&(V.attributes.extrudeDirection=new K({componentDatatype:Z.FLOAT,componentsPerAttribute:3,values:L}));var z,q,G,W,H=ee.createTypedArray(M,6*I);p=R.length/3;var j=0;for(t=0;t<p-1;t+=2){W=((z=t)+2)%p;var Y=Q.fromArray(R,3*z,ue),X=Q.fromArray(R,3*W,ce);Q.equalsEpsilon(Y,X,te.EPSILON10)||(G=((q=(z+1)%p)+2)%p,H[j++]=z,H[j++]=q,H[j++]=W,H[j++]=W,H[j++]=q,H[j++]=G)}return V.indices=H,(V=$.combineInstances([new J({geometry:d}),new J({geometry:V})]))[0]}var a=new O,s=new Q,l=new w,u=[new Q,new Q,new Q,new Q],c=[new t,new t,new t,new t];function P(e){var t=(e=v(e,v.EMPTY_OBJECT)).rectangle;if(g.typeOf.object("rectangle",t),S.validate(t),t.north<t.south)throw new i("options.rectangle.north must be greater than or equal to options.rectangle.south");var r=v(e.rotation,0);this._rectangle=t,this._granularity=v(e.granularity,te.RADIANS_PER_DEGREE),this._ellipsoid=b.clone(v(e.ellipsoid,b.WGS84)),this._surfaceHeight=v(e.height,0),this._rotation=r,this._stRotation=v(e.stRotation,0),this._vertexFormat=ie.clone(v(e.vertexFormat,ie.DEFAULT)),this._extrudedHeight=v(e.extrudedHeight,0),this._extrude=y(e.extrudedHeight),this._closeTop=v(e.closeTop,!0),this._closeBottom=v(e.closeBottom,!0),this._shadowVolume=v(e.shadowVolume,!1),this._workerName="createRectangleGeometry",this._rotatedRectangle=function(e,t,r){if(0===r)return S.clone(e);S.northeast(e,c[0]),S.northwest(e,c[1]),S.southeast(e,c[2]),S.southwest(e,c[3]),t.cartographicArrayToCartesianArray(c,u);var i=t.geodeticSurfaceNormalCartographic(S.center(e,s));w.fromAxisAngle(i,r,l),O.fromQuaternion(l,a);for(var n=0;n<4;++n)O.multiplyByVector(a,u[n],u[n]);return t.cartesianArrayToCartographicArray(u,c),S.fromCartographicArray(c)}(this._rectangle,this._ellipsoid,r)}P.packedLength=S.packedLength+b.packedLength+ie.packedLength+S.packedLength+9,P.pack=function(e,t,r){return g.typeOf.object("value",e),g.defined("array",t),r=v(r,0),S.pack(e._rectangle,t,r),r+=S.packedLength,b.pack(e._ellipsoid,t,r),r+=b.packedLength,ie.pack(e._vertexFormat,t,r),r+=ie.packedLength,S.pack(e._rotatedRectangle,t,r),r+=S.packedLength,t[r++]=e._granularity,t[r++]=e._surfaceHeight,t[r++]=e._rotation,t[r++]=e._stRotation,t[r++]=e._extrudedHeight,t[r++]=e._extrude?1:0,t[r++]=e._closeTop?1:0,t[r++]=e._closeBottom?1:0,t[r]=e._shadowVolume?1:0,t};var D=new S,R=new S,L=b.clone(b.UNIT_SPHERE),N={rectangle:D,ellipsoid:L,vertexFormat:fe,granularity:void 0,height:void 0,rotation:void 0,stRotation:void 0,extrudedHeight:void 0,closeTop:void 0,closeBottom:void 0,shadowVolume:void 0};P.unpack=function(e,t,r){g.defined("array",e),t=v(t,0);var i=S.unpack(e,t,D);t+=S.packedLength;var n=b.unpack(e,t,L);t+=b.packedLength;var o=ie.unpack(e,t,fe);t+=ie.packedLength;var a=S.unpack(e,t,R);t+=S.packedLength;var s=e[t++],l=e[t++],u=e[t++],c=e[t++],d=e[t++],h=1===e[t++],p=1===e[t++],f=1===e[t++],m=1===e[t];return y(r)?(r._rectangle=S.clone(i,r._rectangle),r._ellipsoid=b.clone(n,r._ellipsoid),r._vertexFormat=ie.clone(o,r._vertexFormat),r._granularity=s,r._surfaceHeight=l,r._rotation=u,r._stRotation=c,r._extrudedHeight=h?d:void 0,r._extrude=h,r._closeTop=p,r._closeBottom=f,r._rotatedRectangle=a,r._shadowVolume=m,r):(N.granularity=s,N.height=l,N.rotation=u,N.stRotation=c,N.extrudedHeight=h?d:void 0,N.closeTop=p,N.closeBottom=f,N.shadowVolume=m,new P(N))};var k=new O,F=new t,B=new t,U=new w,V=new t;return P.createGeometry=function(e){if(!te.equalsEpsilon(e._rectangle.north,e._rectangle.south,te.EPSILON10)&&!te.equalsEpsilon(e._rectangle.east,e._rectangle.west,te.EPSILON10)){var t,r,i=S.clone(e._rectangle,T),n=e._ellipsoid,o=e._surfaceHeight,a=e._extrude,s=e._extrudedHeight,l=e._rotation,u=e._stRotation,c=e._vertexFormat,d=I.computeOptions(e,i,F,B),h=k;if(0!==u||0!==l){var p=S.center(i,V),f=n.geodeticSurfaceNormalCartographic(p,ue);w.fromAxisAngle(f,-u,U),O.fromQuaternion(U,h)}else O.clone(O.IDENTITY,h);if(d.lonScalar=1/e._rectangle.width,d.latScalar=1/e._rectangle.height,d.vertexFormat=c,d.rotation=l,d.stRotation=u,d.tangentRotationMatrix=h,d.size=d.width*d.height,i=e._rectangle,a){d.shadowVolume=e._shadowVolume,t=x(d);var m=_.fromRectangle3D(i,n,o,A),g=_.fromRectangle3D(i,n,s,E);r=_.union(m,g)}else(t=de(d)).attributes.position.values=re.scaleToGeodeticHeight(t.attributes.position.values,o,n,!1),r=_.fromRectangle3D(i,n,o);return c.position||delete t.attributes.position,new C({attributes:t.attributes,indices:t.indices,primitiveType:t.primitiveType,boundingSphere:r})}},P.createShadowVolume=function(e,t,r){var i=e._granularity,n=e._ellipsoid,o=t(i,n),a=r(i,n);return new P({rectangle:e._rectangle,rotation:e._rotation,ellipsoid:n,stRotation:e._stRotation,granularity:i,extrudedHeight:a,height:o,closeTop:!0,closeBottom:!0,vertexFormat:ie.POSITION_ONLY,shadowVolume:!0})},r(P.prototype,{rectangle:{get:function(){return this._rotatedRectangle}}}),P}),define("Core/RectangleOutlineGeometry",["./BoundingSphere","./Cartesian3","./Cartographic","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PolygonPipeline","./PrimitiveType","./Rectangle","./RectangleGeometryLibrary"],function(c,e,t,f,d,h,p,m,g,_,v,y,b,C,w,S,T){"use strict";var E=new c,A=new c,x=new e,P=new S;function D(e){var t,r=e.size,i=e.height,n=e.width,o=new Float64Array(3*r),a=0,s=0,l=x;for(t=0;t<n;t++)T.computePosition(e,s,t,l),o[a++]=l.x,o[a++]=l.y,o[a++]=l.z;for(t=n-1,s=1;s<i;s++)T.computePosition(e,s,t,l),o[a++]=l.x,o[a++]=l.y,o[a++]=l.z;for(s=i-1,t=n-2;0<=t;t--)T.computePosition(e,s,t,l),o[a++]=l.x,o[a++]=l.y,o[a++]=l.z;for(t=0,s=i-2;0<s;s--)T.computePosition(e,s,t,l),o[a++]=l.x,o[a++]=l.y,o[a++]=l.z;for(var u=o.length/3*2,c=y.createTypedArray(o.length/3,u),d=0,h=0;h<o.length/3-1;h++)c[d++]=h,c[d++]=h+1;c[d++]=o.length/3-1,c[d++]=0;var p=new g({attributes:new v,primitiveType:w.LINES});return p.attributes.position=new _({componentDatatype:f.DOUBLE,componentsPerAttribute:3,values:o}),p.indices=c,p}function O(e){var t=(e=d(e,d.EMPTY_OBJECT)).rectangle,r=d(e.granularity,b.RADIANS_PER_DEGREE),i=d(e.ellipsoid,m.WGS84),n=d(e.height,0),o=d(e.rotation,0),a=e.extrudedHeight;if(!h(t))throw new p("rectangle is required.");if(S.validate(t),t.north<t.south)throw new p("options.rectangle.north must be greater than options.rectangle.south");this._rectangle=t,this._granularity=r,this._ellipsoid=i,this._surfaceHeight=n,this._rotation=o,this._extrudedHeight=a,this._workerName="createRectangleOutlineGeometry"}O.packedLength=S.packedLength+m.packedLength+5,O.pack=function(e,t,r){if(!h(e))throw new p("value is required");if(!h(t))throw new p("array is required");return r=d(r,0),S.pack(e._rectangle,t,r),r+=S.packedLength,m.pack(e._ellipsoid,t,r),r+=m.packedLength,t[r++]=e._granularity,t[r++]=e._surfaceHeight,t[r++]=e._rotation,t[r++]=h(e._extrudedHeight)?1:0,t[r]=d(e._extrudedHeight,0),t};var I=new S,M=m.clone(m.UNIT_SPHERE),R={rectangle:I,ellipsoid:M,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0};O.unpack=function(e,t,r){if(!h(e))throw new p("array is required");t=d(t,0);var i=S.unpack(e,t,I);t+=S.packedLength;var n=m.unpack(e,t,M);t+=m.packedLength;var o=e[t++],a=e[t++],s=e[t++],l=e[t++],u=e[t];return h(r)?(r._rectangle=S.clone(i,r._rectangle),r._ellipsoid=m.clone(n,r._ellipsoid),r._surfaceHeight=a,r._rotation=s,r._extrudedHeight=l?u:void 0,r):(R.granularity=o,R.height=a,R.rotation=s,R.extrudedHeight=l?u:void 0,new O(R))};var L=new t;return O.createGeometry=function(e){var t,r,i=S.clone(e._rectangle,P),n=e._ellipsoid,o=e._surfaceHeight,a=e._extrudedHeight,s=T.computeOptions(e,i,L);if(s.size=2*s.width+2*s.height-4,i=e._rectangle,!b.equalsEpsilon(i.north,i.south,b.EPSILON10)&&!b.equalsEpsilon(i.east,i.west,b.EPSILON10)){if(h(a)){t=function(e){var t=e.surfaceHeight,r=e.extrudedHeight,i=e.ellipsoid,n=Math.min(r,t),o=Math.max(r,t),a=D(e);if(b.equalsEpsilon(n,o,b.EPSILON10))return a;var s=e.height,l=e.width,u=C.scaleToGeodeticHeight(a.attributes.position.values,o,i,!1),c=u.length,d=new Float64Array(2*c);d.set(u);var h=C.scaleToGeodeticHeight(a.attributes.position.values,n,i);d.set(h,c);var p=(a.attributes.position.values=d).length/3*2+8,f=y.createTypedArray(d.length/3,p);c=d.length/6;for(var m=0,g=0;g<c-1;g++)f[m++]=g,f[m++]=g+1,f[m++]=g+c,f[m++]=g+c+1;return f[m++]=c-1,f[m++]=0,f[m++]=c+c-1,f[m++]=c,f[m++]=0,f[m++]=c,f[m++]=l-1,f[m++]=c+l-1,f[m++]=l+s-2,f[m++]=l+s-2+c,f[m++]=2*l+s-3,f[m++]=2*l+s-3+c,a.indices=f,a}(s);var l=c.fromRectangle3D(i,n,o,A),u=c.fromRectangle3D(i,n,a,E);r=c.union(l,u)}else(t=D(s)).attributes.position.values=C.scaleToGeodeticHeight(t.attributes.position.values,o,n,!1),r=c.fromRectangle3D(i,n,o);return new g({attributes:t.attributes,indices:t.indices,primitiveType:w.LINES,boundingSphere:r})}},O}),define("Core/ReferenceFrame",["./freezeObject"],function(e){"use strict";return e({FIXED:0,INERTIAL:1})}),define("Core/requestAnimationFrame",["./defined","./getTimestamp"],function(n,o){"use strict";if("undefined"!=typeof window){var a=window.requestAnimationFrame;return function(){if(!n(a))for(var e=["webkit","moz","ms","o"],t=0,r=e.length;t<r&&!n(a);)a=window[e[t]+"RequestAnimationFrame"],++t;if(!n(a)){var i=0;a=function(e){var t=o(),r=Math.max(1e3/60-(t-i),0);return i=t+r,setTimeout(function(){e(i)},r)}}}(),function(e){return a(e)}}}),define("Core/sampleTerrain",["../ThirdParty/when","./Check"],function(f,i){"use strict";function m(e){var i=e.positions,n=e.tilingScheme.tileXYToRectangle(e.x,e.y,e.level);return function(e){for(var t=0;t<i.length;++t){var r=i[t];r.height=e.interpolateHeight(n,r.longitude,r.latitude)}}}function g(e){var t=e.positions;return function(){for(var e=0;e<t.length;++e){t[e].height=void 0}}}return function(e,t,r){return i.typeOf.object("terrainProvider",e),i.typeOf.number("level",t),i.defined("positions",r),e.readyPromise.then(function(){return function(e,t,r){var i,n=e.tilingScheme,o=[],a={};for(i=0;i<r.length;++i){var s=n.positionToTileXY(r[i],t),l=s.toString();if(!a.hasOwnProperty(l)){var u={x:s.x,y:s.y,level:t,tilingScheme:n,terrainProvider:e,positions:[]};a[l]=u,o.push(u)}a[l].positions.push(r[i])}var c=[];for(i=0;i<o.length;++i){var d=o[i],h=d.terrainProvider.requestTileGeometry(d.x,d.y,d.level),p=f(h,m(d),g(d));c.push(p)}return f.all(c,function(){return r})}(e,t,r)})}}),define("Core/sampleTerrainMostDetailed",["../ThirdParty/when","./defined","./DeveloperError","./sampleTerrain"],function(l,u,c,d){"use strict";return function(a,s){if(!u(a))throw new c("terrainProvider is required.");if(!u(s))throw new c("positions is required.");return a.readyPromise.then(function(){var e=[],t=a.availability;if(!u(t))throw new c("sampleTerrainMostDetailed requires a terrain provider that has tile availability.");for(var r=0;r<s.length;++r){var i=s[r],n=t.computeMaximumLevelAtPosition(i),o=e[n];u(o)||(e[n]=o=[]),o.push(i)}return l.all(e.map(function(e,t){if(u(e))return d(a,t,e)})).then(function(){return s})})}}),define("Core/ScreenSpaceEventType",["./freezeObject"],function(e){"use strict";return e({LEFT_DOWN:0,LEFT_UP:1,LEFT_CLICK:2,LEFT_DOUBLE_CLICK:3,RIGHT_DOWN:5,RIGHT_UP:6,RIGHT_CLICK:7,MIDDLE_DOWN:10,MIDDLE_UP:11,MIDDLE_CLICK:12,MOUSE_MOVE:15,WHEEL:16,PINCH_START:17,PINCH_END:18,PINCH_MOVE:19})}),define("Core/ScreenSpaceEventHandler",["./AssociativeArray","./Cartesian2","./defaultValue","./defined","./destroyObject","./DeveloperError","./FeatureDetection","./getTimestamp","./KeyboardEventModifier","./ScreenSpaceEventType"],function(n,S,o,T,e,a,s,t,r,E){"use strict";function h(e,t,r){var i=e._element;if(i===document)return r.x=t.clientX,r.y=t.clientY,r;var n=i.getBoundingClientRect();return r.x=t.clientX-n.left,r.y=t.clientY-n.top,r}function l(e,t){var r=e;return T(t)&&(r+="+"+t),r}function A(e){return e.shiftKey?r.SHIFT:e.ctrlKey?r.CTRL:e.altKey?r.ALT:void 0}var x={LEFT:0,MIDDLE:1,RIGHT:2};function u(t,e,r,i){function n(e){i(t,e)}r.addEventListener(e,n,!1),t._removalFunctions.push(function(){r.removeEventListener(e,n,!1)})}var c={position:new S};function d(e){e._lastSeenTouchEvent=t()}function p(e){return t()-e._lastSeenTouchEvent>q.mouseEmulationIgnoreMilliseconds}function f(e,t){if(p(e)){var r,i=t.button;if((e._buttonDown=i)===x.LEFT)r=E.LEFT_DOWN;else if(i===x.MIDDLE)r=E.MIDDLE_DOWN;else{if(i!==x.RIGHT)return;r=E.RIGHT_DOWN}var n=h(e,t,e._primaryPosition);S.clone(n,e._primaryStartPosition),S.clone(n,e._primaryPreviousPosition);var o=A(t),a=e.getInputAction(r,o);T(a)&&(S.clone(n,c.position),a(c),t.preventDefault())}}var m={position:new S},g={position:new S};function _(e,t){if(p(e)){var r,i,n=t.button;if(e._buttonDown=void 0,n===x.LEFT)r=E.LEFT_UP,i=E.LEFT_CLICK;else if(n===x.MIDDLE)r=E.MIDDLE_UP,i=E.MIDDLE_CLICK;else{if(n!==x.RIGHT)return;r=E.RIGHT_UP,i=E.RIGHT_CLICK}var o=A(t),a=e.getInputAction(r,o),s=e.getInputAction(i,o);if(T(a)||T(s)){var l=h(e,t,e._primaryPosition);if(T(a)&&(S.clone(l,m.position),a(m)),T(s)){var u=e._primaryStartPosition,c=u.x-l.x,d=u.y-l.y;Math.sqrt(c*c+d*d)<e._clickPixelTolerance&&(S.clone(l,g.position),s(g))}}}}var v={startPosition:new S,endPosition:new S};function y(e,t){if(p(e)){var r=A(t),i=h(e,t,e._primaryPosition),n=e._primaryPreviousPosition,o=e.getInputAction(E.MOUSE_MOVE,r);T(o)&&(S.clone(n,v.startPosition),S.clone(i,v.endPosition),o(v)),S.clone(i,n),T(e._buttonDown)&&t.preventDefault()}}var b={position:new S};function C(e,t){var r;if(t.button===x.LEFT){r=E.LEFT_DOUBLE_CLICK;var i=A(t),n=e.getInputAction(r,i);T(n)&&(h(e,t,b.position),n(b))}}function w(e,t){var r;if(T(t.deltaY)){var i=t.deltaMode;r=i===t.DOM_DELTA_PIXEL?-t.deltaY:i===t.DOM_DELTA_LINE?40*-t.deltaY:120*-t.deltaY}else r=0<t.detail?-120*t.detail:t.wheelDelta;if(T(r)){var n=A(t),o=e.getInputAction(E.WHEEL,n);T(o)&&(o(r),t.preventDefault())}}function P(e,t){d(e);var r,i,n,o=t.changedTouches,a=o.length,s=e._positions;for(r=0;r<a;++r)n=(i=o[r]).identifier,s.set(n,h(e,i,new S));L(e,t);var l=e._previousPositions;for(r=0;r<a;++r)n=(i=o[r]).identifier,l.set(n,S.clone(s.get(n)))}function D(e,t){d(e);var r,i,n=t.changedTouches,o=n.length,a=e._positions;for(r=0;r<o;++r)i=n[r].identifier,a.remove(i);L(e,t);var s=e._previousPositions;for(r=0;r<o;++r)i=n[r].identifier,s.remove(i)}var O={position:new S},I={position1:new S,position2:new S},M={position:new S},R={position:new S};function L(e,t){var r,i,n=A(t),o=e._positions,a=e._previousPositions,s=o.length;if(1!==s&&e._buttonDown===x.LEFT&&(e._buttonDown=void 0,r=e.getInputAction(E.LEFT_UP,n),T(r)&&(S.clone(e._primaryPosition,M.position),r(M)),0===s&&(i=e.getInputAction(E.LEFT_CLICK,n),T(i)))){var l=e._primaryStartPosition,u=a.values[0],c=l.x-u.x,d=l.y-u.y;Math.sqrt(c*c+d*d)<e._clickPixelTolerance&&(S.clone(e._primaryPosition,R.position),i(R))}if(2!==s&&e._isPinching&&(e._isPinching=!1,r=e.getInputAction(E.PINCH_END,n),T(r)&&r()),1===s){var h=o.values[0];S.clone(h,e._primaryPosition),S.clone(h,e._primaryStartPosition),S.clone(h,e._primaryPreviousPosition),e._buttonDown=x.LEFT,r=e.getInputAction(E.LEFT_DOWN,n),T(r)&&(S.clone(h,O.position),r(O)),t.preventDefault()}2===s&&(e._isPinching=!0,r=e.getInputAction(E.PINCH_START,n),T(r)&&(S.clone(o.values[0],I.position1),S.clone(o.values[1],I.position2),r(I),t.preventDefault()))}function N(e,t){d(e);var r,i,n,o=t.changedTouches,a=o.length,s=e._positions;for(r=0;r<a;++r){n=(i=o[r]).identifier;var l=s.get(n);T(l)&&h(e,i,l)}B(e,t);var u=e._previousPositions;for(r=0;r<a;++r)n=(i=o[r]).identifier,S.clone(s.get(n),u.get(n))}var k={startPosition:new S,endPosition:new S},F={distance:{startPosition:new S,endPosition:new S},angleAndHeight:{startPosition:new S,endPosition:new S}};function B(e,t){var r,i=A(t),n=e._positions,o=e._previousPositions,a=n.length;if(1===a&&e._buttonDown===x.LEFT){var s=n.values[0];S.clone(s,e._primaryPosition);var l=e._primaryPreviousPosition;r=e.getInputAction(E.MOUSE_MOVE,i),T(r)&&(S.clone(l,k.startPosition),S.clone(s,k.endPosition),r(k)),S.clone(s,l),t.preventDefault()}else if(2===a&&e._isPinching&&(r=e.getInputAction(E.PINCH_MOVE,i),T(r))){var u=n.values[0],c=n.values[1],d=o.values[0],h=o.values[1],p=c.x-u.x,f=c.y-u.y,m=.25*Math.sqrt(p*p+f*f),g=h.x-d.x,_=h.y-d.y,v=.25*Math.sqrt(g*g+_*_),y=.125*(c.y+u.y),b=.125*(h.y+d.y),C=Math.atan2(f,p),w=Math.atan2(_,g);S.fromElements(0,v,F.distance.startPosition),S.fromElements(0,m,F.distance.endPosition),S.fromElements(w,b,F.angleAndHeight.startPosition),S.fromElements(C,y,F.angleAndHeight.endPosition),r(F)}}function U(e,t){if(t.target.setPointerCapture(t.pointerId),"touch"===t.pointerType){var r=e._positions,i=t.pointerId;r.set(i,h(e,t,new S)),L(e,t),e._previousPositions.set(i,S.clone(r.get(i)))}else f(e,t)}function V(e,t){if("touch"===t.pointerType){var r=e._positions,i=t.pointerId;r.remove(i),L(e,t),e._previousPositions.remove(i)}else _(e,t)}function z(e,t){if("touch"===t.pointerType){var r=e._positions,i=t.pointerId,n=r.get(i);if(!T(n))return;h(e,t,n),B(e,t);var o=e._previousPositions;S.clone(r.get(i),o.get(i))}else y(e,t)}function q(e){var t,r,i;this._inputEvents={},this._buttonDown=void 0,this._isPinching=!1,this._lastSeenTouchEvent=-q.mouseEmulationIgnoreMilliseconds,this._primaryStartPosition=new S,this._primaryPosition=new S,this._primaryPreviousPosition=new S,this._positions=new n,this._previousPositions=new n,this._removalFunctions=[],this._clickPixelTolerance=5,this._element=o(e,document),r=(t=this)._element,i=T(r.disableRootEvents)?r:document,s.supportsPointerEvents()?(u(t,"pointerdown",r,U),u(t,"pointerup",r,V),u(t,"pointermove",r,z),u(t,"pointercancel",r,V)):(u(t,"mousedown",r,f),u(t,"mouseup",i,_),u(t,"mousemove",i,y),u(t,"touchstart",r,P),u(t,"touchend",i,D),u(t,"touchmove",i,N),u(t,"touchcancel",i,D)),u(t,"dblclick",r,C),u(t,"onwheel"in r?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",r,w)}return q.prototype.setInputAction=function(e,t,r){if(!T(e))throw new a("action is required.");if(!T(t))throw new a("type is required.");var i=l(t,r);this._inputEvents[i]=e},q.prototype.getInputAction=function(e,t){if(!T(e))throw new a("type is required.");var r=l(e,t);return this._inputEvents[r]},q.prototype.removeInputAction=function(e,t){if(!T(e))throw new a("type is required.");var r=l(e,t);delete this._inputEvents[r]},q.prototype.isDestroyed=function(){return!1},q.prototype.destroy=function(){return function(e){for(var t=e._removalFunctions,r=0;r<t.length;++r)t[r]()}(this),e(this)},q.mouseEmulationIgnoreMilliseconds=800,q}),define("Core/ShowGeometryInstanceAttribute",["./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError"],function(e,t,r,i,n){"use strict";function o(e){e=t(e,!0),this.value=o.toValue(e)}return i(o.prototype,{componentDatatype:{get:function(){return e.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 1}},normalize:{get:function(){return!1}}}),o.toValue=function(e,t){if(!r(e))throw new n("show is required.");return r(t)?(t[0]=e,t):new Uint8Array([e])},o}),define("Core/Simon1994PlanetaryPositions",["./Cartesian3","./defined","./DeveloperError","./JulianDate","./Math","./Matrix3","./TimeConstants","./TimeStandard"],function(g,_,v,n,y,b,O,e){"use strict";var t={};var o=32.184,a=2451545;function I(e,t){t=n.addSeconds(e,o,t);var r,i=n.totalDays(t)-a;return t=n.addSeconds(t,(r=6.239996+.0172019696544*i,.001657*Math.sin(r+.01671*Math.sin(r))),t)}var M=new n(2451545,0,e.TAI),R=1e3,L=y.RADIANS_PER_DEGREE,N=y.RADIANS_PER_ARCSECOND,C=new b;function k(e,t,r,i,n,o,a){if(r<0&&(r=-r,n+=y.PI),r<0||r>y.PI)throw new v("The inclination is out of range. Inclination must be greater than or equal to zero and less than or equal to Pi radians.");var s=e*(1-t),l=i-n,u=n,c=function(e,t){if(t<0||1<=t)throw new v("eccentricity out of range.");return function(e,t){if(t<0||1<=t)throw new v("eccentricity out of range.");var r=Math.floor(e/y.TWO_PI);e-=r*y.TWO_PI;var i=Math.cos(e)-t,n=Math.sin(e)*Math.sqrt(1-t*t),o=Math.atan2(n,i);o=y.zeroToTwoPi(o),e<0&&(o-=y.TWO_PI);return o+=r*y.TWO_PI}(function(e,t){if(t<0||1<=t)throw new v("eccentricity out of range.");var r,i=Math.floor(e/y.TWO_PI),n=(e-=i*y.TWO_PI)+t*Math.sin(e)/(1-Math.sin(e+t)+Math.sin(e)),o=Number.MAX_VALUE;for(r=0;r<w&&Math.abs(o-n)>S;++r){var a=(o=n)-t*Math.sin(o)-e,s=1-t*Math.cos(o);n=o-a/s}if(w<=r)throw new v("Kepler equation did not converge");return o=n+i*y.TWO_PI}(e,t),t)}(o-i,t);if("Hyperbolic"===function(e,t){if(e<0)throw new v("eccentricity cannot be negative.");{if(e<=t)return"Circular";if(e<1-t)return"Elliptical";if(e<=1+t)return"Parabolic"}return"Hyperbolic"}(t,0)&&Math.abs(y.negativePiToPi(c))>=Math.acos(-1/t))throw new v("The true anomaly of the hyperbolic orbit lies outside of the bounds of the hyperbola.");!function(e,t,r,i){if(t<0||t>y.PI)throw new v("inclination out of range");var n=Math.cos(e),o=Math.sin(e),a=Math.cos(t),s=Math.sin(t),l=Math.cos(r),u=Math.sin(r);_(i)?(i[0]=l*n-u*o*a,i[1]=u*n+l*o*a,i[2]=o*s,i[3]=-l*o-u*n*a,i[4]=-u*o+l*n*a,i[5]=n*s,i[6]=u*s,i[7]=-l*s,i[8]=a):i=new b(l*n-u*o*a,-l*o-u*n*a,u*s,u*n+l*o*a,-u*o+l*n*a,-l*s,o*s,n*s,a)}(l,r,u,C);var d=s*(1+t),h=Math.cos(c),p=Math.sin(c),f=1+t*h;if(f<=y.Epsilon10)throw new v("elements cannot be converted to cartesian");var m=d/f;return _(a)?(a.x=m*h,a.y=m*p,a.z=0):a=new g(m*h,m*p,0),b.multiplyByVector(C,a,a)}var w=50,S=y.EPSILON8;var s=100.46645683*L,l=1295977422.83429*N,F=new n(0,0,e.TAI);function i(e,t){I(e,F);var r=(F.dayNumber-M.dayNumber+(F.secondsOfDay-M.secondsOfDay)/O.SECONDS_PER_DAY)/O.DAYS_PER_JULIAN_CENTURY,i=r*r,n=i*r,o=n*r,a=383397.7725+.004*r,s=.055545526-16e-9*r,l=5.15668983*L,u=-8e-5*r+.02966*i-42e-6*n-13e-8*o,c=83.35324312*L,d=14643420.2669*r-38.2702*i-.045047*n+21301e-8*o,h=125.04455501*L,p=-6967919.3631*r+6.3602*i+.007625*n-3586e-8*o,f=218.31664563*L,m=1732559343.4847*r-6.391*i+.006588*n-3169e-8*o,g=297.85019547*L+N*(1602961601.209*r-6.3706*i+.006593*n-3169e-8*o),_=134.96340251*L+N*(1717915923.2178*r+31.8792*i+.051635*n-2447e-7*o),v=357.52910918*L+N*(129596581.0481*r-.5532*i+136e-6*n-1149e-8*o),y=310.17137918*L-N*(6967051.436*r+6.2068*i+.007618*n-3219e-8*o),b=2*g,C=4*g,w=6*g,S=2*_,T=3*_,E=4*_,A=2*(93.27209062*L+N*(1739527262.8478*r-12.7512*i-.001037*n+417e-8*o));a+=3400.4*Math.cos(b)-635.6*Math.cos(b-_)-235.6*Math.cos(_)+218.1*Math.cos(b-v)+181*Math.cos(b+_),s+=.014216*Math.cos(b-_)+.008551*Math.cos(b-S)-.001383*Math.cos(_)+.001356*Math.cos(b+_)-.001147*Math.cos(C-T)-914e-6*Math.cos(C-S)+869e-6*Math.cos(b-v-_)-627e-6*Math.cos(b)-394e-6*Math.cos(C-E)+282e-6*Math.cos(b-v-S)-279e-6*Math.cos(g-_)-236e-6*Math.cos(S)+231e-6*Math.cos(C)+229e-6*Math.cos(w-E)-201e-6*Math.cos(S-A),u+=486.26*Math.cos(b-A)-40.13*Math.cos(b)+37.51*Math.cos(A)+25.73*Math.cos(S-A)+19.97*Math.cos(b-v-A),d+=-55609*Math.sin(b-_)-34711*Math.sin(b-S)-9792*Math.sin(_)+9385*Math.sin(C-T)+7505*Math.sin(C-S)+5318*Math.sin(b+_)+3484*Math.sin(C-E)-3417*Math.sin(b-v-_)-2530*Math.sin(w-E)-2376*Math.sin(b)-2075*Math.sin(b-T)-1883*Math.sin(S)-1736*Math.sin(w-5*_)+1626*Math.sin(v)-1370*Math.sin(w-T),p+=-5392*Math.sin(b-A)-540*Math.sin(v)-441*Math.sin(b)+423*Math.sin(A)-288*Math.sin(S-A),m+=-3332.9*Math.sin(b)+1197.4*Math.sin(b-_)-662.5*Math.sin(v)+396.3*Math.sin(_)-218*Math.sin(b-v);var x=2*y,P=3*y;u+=46.997*Math.cos(y)*r-.614*Math.cos(b-A+y)*r+.614*Math.cos(b-A-y)*r-.0297*Math.cos(x)*i-.0335*Math.cos(y)*i+.0012*Math.cos(b-A+x)*i-16e-5*Math.cos(y)*n+4e-5*Math.cos(P)*n+4e-5*Math.cos(x)*n;var D=2.116*Math.sin(y)*r-.111*Math.sin(b-A-y)*r-.0015*Math.sin(y)*i;return d+=D,m+=D,p+=-520.77*Math.sin(y)*r+13.66*Math.sin(b-A+y)*r+1.12*Math.sin(b-y)*r-1.06*Math.sin(A-y)*r+.66*Math.sin(x)*i+.371*Math.sin(y)*i-.035*Math.sin(b-A+x)*i-.015*Math.sin(b-A+y)*i+.0014*Math.sin(y)*n-.0011*Math.sin(P)*n-9e-4*Math.sin(x)*n,k(a*=R,s,l+u*N,c+d*N,h+p*N,f+m*N,t)}var u=new b(1.0000000000000002,5619723173785822e-31,4690511510146299e-34,-5154129427414611e-31,.9174820620691819,-.39777715593191376,-223970096136568e-30,.39777715593191376,.9174820620691819),c=new g;return t.computeSunPositionInEarthInertialFrame=function(e,t){var r;return _(e)||(e=n.now()),_(t)||(t=new g),c=function(e,t){I(e,F);var r=(F.dayNumber-M.dayNumber+(F.secondsOfDay-M.secondsOfDay)/O.SECONDS_PER_DAY)/(10*O.DAYS_PER_JULIAN_CENTURY),i=.3595362*r,n=149598022260.7121+957426.3679999999*Math.cos(16002*i)+-2243968.05*Math.sin(16002*i)+-2273887.624*Math.cos(21863*i)+-688150.202*Math.sin(21863*i)+927506.794*Math.cos(32004*i)+1017265.516*Math.sin(32004*i)+-119678.29599999999*Math.cos(10931*i)+807828.498*Math.sin(10931*i)+478713.18399999995*Math.cos(14529*i)+209437.01799999998*Math.sin(14529*i)+-613351.267*Math.cos(16368*i)+359034.888*Math.sin(16368*i)+284235.953*Math.cos(15318*i)+-418874.03599999996*Math.sin(15318*i)+-164557.657*Math.cos(32794*i)+329115.314*Math.sin(32794*i),o=s+l*r+-325e-7*Math.cos(10*i)+-105e-7*Math.sin(10*i)+-322e-7*Math.cos(16002*i)+-137e-7*Math.sin(16002*i)+1e-7*-79*Math.cos(21863*i)+258e-7*Math.sin(21863*i)+232*1e-7*Math.cos(10931*i)+35e-7*Math.sin(10931*i)+1e-7*-52*Math.cos(1473*i)+1e-7*-116*Math.sin(1473*i)+97e-7*Math.cos(32004*i)+-88e-7*Math.sin(32004*i)+55e-7*Math.cos(4387*i)+-112e-7*Math.sin(4387*i)+-41e-7*Math.cos(73*i)+-8e-6*Math.sin(73*i);return k(n,.0167086342-.0004203654*r,469.97289*N*r,102.93734808*L+11612.3529*N*r,174.87317577*L-8679.27034*N*r,o,t)}(e,c),t=g.negate(c,t),r=i(e,r=c),g.multiplyByScalar(r,-.01215058143522694,r),g.subtract(t,c,t),b.multiplyByVector(u,t,t),t},t.computeMoonPositionInEarthInertialFrame=function(e,t){return _(e)||(e=n.now()),t=i(e,t),b.multiplyByVector(u,t,t),t},t}),define("Core/SimplePolylineGeometry",["./BoundingSphere","./Cartesian3","./Color","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PolylinePipeline","./PrimitiveType"],function(I,M,R,L,d,N,h,p,k,F,B,U,V,z,q){"use strict";function G(e,t,r,i,n,o,a){var s,l=z.numberOfPoints(e,t,n),u=r.red,c=r.green,d=r.blue,h=r.alpha,p=i.red,f=i.green,m=i.blue,g=i.alpha;if(R.equals(r,i)){for(s=0;s<l;s++)o[a++]=R.floatToByte(u),o[a++]=R.floatToByte(c),o[a++]=R.floatToByte(d),o[a++]=R.floatToByte(h);return a}var _=(p-u)/l,v=(f-c)/l,y=(m-d)/l,b=(g-h)/l,C=a;for(s=0;s<l;s++)o[C++]=R.floatToByte(u+s*_),o[C++]=R.floatToByte(c+s*v),o[C++]=R.floatToByte(d+s*y),o[C++]=R.floatToByte(h+s*b);return C}function f(e){var t=(e=d(e,d.EMPTY_OBJECT)).positions,r=e.colors,i=d(e.colorsPerVertex,!1);if(!N(t)||t.length<2)throw new h("At least two positions are required.");if(N(r)&&(i&&r.length<t.length||!i&&r.length<t.length-1))throw new h("colors has an invalid length.");this._positions=t,this._colors=r,this._colorsPerVertex=i,this._followSurface=d(e.followSurface,!0),this._granularity=d(e.granularity,V.RADIANS_PER_DEGREE),this._ellipsoid=d(e.ellipsoid,p.WGS84),this._workerName="createSimplePolylineGeometry";var n=1+t.length*M.packedLength;n+=N(r)?1+r.length*R.packedLength:1,this.packedLength=n+p.packedLength+3}f.pack=function(e,t,r){if(!N(e))throw new h("value is required");if(!N(t))throw new h("array is required");var i;r=d(r,0);var n=e._positions,o=n.length;for(t[r++]=o,i=0;i<o;++i,r+=M.packedLength)M.pack(n[i],t,r);var a=e._colors;for(o=N(a)?a.length:0,t[r++]=o,i=0;i<o;++i,r+=R.packedLength)R.pack(a[i],t,r);return p.pack(e._ellipsoid,t,r),r+=p.packedLength,t[r++]=e._colorsPerVertex?1:0,t[r++]=e._followSurface?1:0,t[r]=e._granularity,t},f.unpack=function(e,t,r){if(!N(e))throw new h("array is required");var i;t=d(t,0);var n=e[t++],o=new Array(n);for(i=0;i<n;++i,t+=M.packedLength)o[i]=M.unpack(e,t);var a=0<(n=e[t++])?new Array(n):void 0;for(i=0;i<n;++i,t+=R.packedLength)a[i]=R.unpack(e,t);var s=p.unpack(e,t);t+=p.packedLength;var l=1===e[t++],u=1===e[t++],c=e[t];return N(r)?(r._positions=o,r._colors=a,r._ellipsoid=s,r._colorsPerVertex=l,r._followSurface=u,r._granularity=c,r):new f({positions:o,colors:a,ellipsoid:s,colorsPerVertex:l,followSurface:u,granularity:c})};var W=new Array(2),H=new Array(2),j={positions:W,height:H,ellipsoid:void 0,minDistance:void 0};return f.createGeometry=function(e){var t,r,i,n,o,a=e._positions,s=e._colors,l=e._colorsPerVertex,u=e._followSurface,c=e._granularity,d=e._ellipsoid,h=V.chordLength(c,d.maximumRadius),p=N(s)&&!l,f=a.length,m=0;if(u){var g=z.extractHeights(a,d),_=j;if(_.minDistance=h,_.ellipsoid=d,p){var v=0;for(t=0;t<f-1;t++)v+=z.numberOfPoints(a[t],a[t+1],h)+1;r=new Float64Array(3*v),n=new Uint8Array(4*v),_.positions=W,_.height=H;var y=0;for(t=0;t<f-1;++t){W[0]=a[t],W[1]=a[t+1],H[0]=g[t],H[1]=g[t+1];var b=z.generateArc(_);if(N(s)){var C=b.length/3;o=s[t];for(var w=0;w<C;++w)n[y++]=R.floatToByte(o.red),n[y++]=R.floatToByte(o.green),n[y++]=R.floatToByte(o.blue),n[y++]=R.floatToByte(o.alpha)}r.set(b,m),m+=b.length}}else if(_.positions=a,_.height=g,r=new Float64Array(z.generateArc(_)),N(s)){for(n=new Uint8Array(r.length/3*4),t=0;t<f-1;++t){m=G(a[t],a[t+1],s[t],s[t+1],h,n,m)}var S=s[f-1];n[m++]=R.floatToByte(S.red),n[m++]=R.floatToByte(S.green),n[m++]=R.floatToByte(S.blue),n[m++]=R.floatToByte(S.alpha)}}else{i=p?2*f-2:f,r=new Float64Array(3*i),n=N(s)?new Uint8Array(4*i):void 0;var T=0,E=0;for(t=0;t<f;++t){var A=a[t];if(p&&0<t&&(M.pack(A,r,T),T+=3,o=s[t-1],n[E++]=R.floatToByte(o.red),n[E++]=R.floatToByte(o.green),n[E++]=R.floatToByte(o.blue),n[E++]=R.floatToByte(o.alpha)),p&&t===f-1)break;M.pack(A,r,T),T+=3,N(s)&&(o=s[t],n[E++]=R.floatToByte(o.red),n[E++]=R.floatToByte(o.green),n[E++]=R.floatToByte(o.blue),n[E++]=R.floatToByte(o.alpha))}}var x=new B;x.position=new F({componentDatatype:L.DOUBLE,componentsPerAttribute:3,values:r}),N(s)&&(x.color=new F({componentDatatype:L.UNSIGNED_BYTE,componentsPerAttribute:4,values:n,normalize:!0}));var P=2*((i=r.length/3)-1),D=U.createTypedArray(i,P),O=0;for(t=0;t<i-1;++t)D[O++]=t,D[O++]=t+1;return new k({attributes:x,indices:D,primitiveType:q.LINES,boundingSphere:I.fromPoints(a)})},f}),define("Core/SphereGeometry",["./Cartesian3","./Check","./defaultValue","./defined","./EllipsoidGeometry","./VertexFormat"],function(n,i,o,a,s,l){"use strict";function u(e){var t=o(e.radius,1),r={radii:new n(t,t,t),stackPartitions:e.stackPartitions,slicePartitions:e.slicePartitions,vertexFormat:e.vertexFormat};this._ellipsoidGeometry=new s(r),this._workerName="createSphereGeometry"}u.packedLength=s.packedLength,u.pack=function(e,t,r){return i.typeOf.object("value",e),s.pack(e._ellipsoidGeometry,t,r)};var c=new s,d={radius:void 0,radii:new n,vertexFormat:new l,stackPartitions:void 0,slicePartitions:void 0};return u.unpack=function(e,t,r){var i=s.unpack(e,t,c);return d.vertexFormat=l.clone(i._vertexFormat,d.vertexFormat),d.stackPartitions=i._stackPartitions,d.slicePartitions=i._slicePartitions,a(r)?(n.clone(i._radii,d.radii),r._ellipsoidGeometry=new s(d),r):(d.radius=i._radii.x,new u(d))},u.createGeometry=function(e){return s.createGeometry(e._ellipsoidGeometry)},u}),define("Core/SphereOutlineGeometry",["./Cartesian3","./Check","./defaultValue","./defined","./EllipsoidOutlineGeometry"],function(n,i,o,a,s){"use strict";function l(e){var t=o(e.radius,1),r={radii:new n(t,t,t),stackPartitions:e.stackPartitions,slicePartitions:e.slicePartitions,subdivisions:e.subdivisions};this._ellipsoidGeometry=new s(r),this._workerName="createSphereOutlineGeometry"}l.packedLength=s.packedLength,l.pack=function(e,t,r){return i.typeOf.object("value",e),s.pack(e._ellipsoidGeometry,t,r)};var u=new s,c={radius:void 0,radii:new n,stackPartitions:void 0,slicePartitions:void 0,subdivisions:void 0};return l.unpack=function(e,t,r){var i=s.unpack(e,t,u);return c.stackPartitions=i._stackPartitions,c.slicePartitions=i._slicePartitions,c.subdivisions=i._subdivisions,a(r)?(n.clone(i._radii,c.radii),r._ellipsoidGeometry=new s(c),r):(c.radius=i._radii.x,new l(c))},l.createGeometry=function(e){return s.createGeometry(e._ellipsoidGeometry)},l}),define("Core/Spherical",["./Check","./defaultValue","./defined"],function(a,i,s){"use strict";function l(e,t,r){this.clock=i(e,0),this.cone=i(t,0),this.magnitude=i(r,1)}return l.fromCartesian3=function(e,t){a.typeOf.object("cartesian3",e);var r=e.x,i=e.y,n=e.z,o=r*r+i*i;return s(t)||(t=new l),t.clock=Math.atan2(i,r),t.cone=Math.atan2(Math.sqrt(o),n),t.magnitude=Math.sqrt(o+n*n),t},l.clone=function(e,t){if(s(e))return s(t)?(t.clock=e.clock,t.cone=e.cone,t.magnitude=e.magnitude,t):new l(e.clock,e.cone,e.magnitude)},l.normalize=function(e,t){return a.typeOf.object("spherical",e),s(t)?(t.clock=e.clock,t.cone=e.cone,t.magnitude=1,t):new l(e.clock,e.cone,1)},l.equals=function(e,t){return e===t||s(e)&&s(t)&&e.clock===t.clock&&e.cone===t.cone&&e.magnitude===t.magnitude},l.equalsEpsilon=function(e,t,r){return r=i(r,0),e===t||s(e)&&s(t)&&Math.abs(e.clock-t.clock)<=r&&Math.abs(e.cone-t.cone)<=r&&Math.abs(e.magnitude-t.magnitude)<=r},l.prototype.equals=function(e){return l.equals(this,e)},l.prototype.clone=function(e){return l.clone(this,e)},l.prototype.equalsEpsilon=function(e,t){return l.equalsEpsilon(this,e,t)},l.prototype.toString=function(){return"("+this.clock+", "+this.cone+", "+this.magnitude+")"},l}),define("Core/subdivideArray",["./defined","./DeveloperError"],function(a,s){"use strict";return function(e,t){if(!a(e))throw new s("array is required.");if(!a(t)||t<1)throw new s("numberOfArrays must be greater than 0.");for(var r=[],i=e.length,n=0;n<i;){var o=Math.ceil((i-n)/t--);r.push(e.slice(n,n+o)),n+=o}return r}}),define("Core/TerrainData",["./defineProperties","./DeveloperError"],function(e,t){"use strict";function r(){t.throwInstantiationError()}return e(r.prototype,{credits:{get:t.throwInstantiationError},waterMask:{get:t.throwInstantiationError}}),r.prototype.interpolateHeight=t.throwInstantiationError,r.prototype.isChildAvailable=t.throwInstantiationError,r.prototype.createMesh=t.throwInstantiationError,r.prototype.upsample=t.throwInstantiationError,r.prototype.wasCreatedByUpsampling=t.throwInstantiationError,r}),define("Core/TilingScheme",["./defineProperties","./DeveloperError"],function(e,t){"use strict";function r(e){throw new t("This type should not be instantiated directly.  Instead, use WebMercatorTilingScheme or GeographicTilingScheme.")}return e(r.prototype,{ellipsoid:{get:t.throwInstantiationError},rectangle:{get:t.throwInstantiationError},projection:{get:t.throwInstantiationError}}),r.prototype.getNumberOfXTilesAtLevel=t.throwInstantiationError,r.prototype.getNumberOfYTilesAtLevel=t.throwInstantiationError,r.prototype.rectangleToNativeRectangle=t.throwInstantiationError,r.prototype.tileXYToNativeRectangle=t.throwInstantiationError,r.prototype.tileXYToRectangle=t.throwInstantiationError,r.prototype.positionToTileXY=t.throwInstantiationError,r}),define("Core/TimeIntervalCollection",["./binarySearch","./defaultValue","./defined","./defineProperties","./DeveloperError","./Event","./GregorianDate","./isLeapYear","./Iso8601","./JulianDate","./TimeInterval"],function(d,f,m,e,g,i,t,c,_,h,v){"use strict";function p(e,t){return h.compare(e.start,t.start)}function y(e){if(this._intervals=[],this._changedEvent=new i,m(e))for(var t=e.length,r=0;r<t;r++)this.addInterval(e[r])}e(y.prototype,{changedEvent:{get:function(){return this._changedEvent}},start:{get:function(){var e=this._intervals;return 0===e.length?void 0:e[0].start}},isStartIncluded:{get:function(){var e=this._intervals;return 0!==e.length&&e[0].isStartIncluded}},stop:{get:function(){var e=this._intervals,t=e.length;return 0===t?void 0:e[t-1].stop}},isStopIncluded:{get:function(){var e=this._intervals,t=e.length;return 0!==t&&e[t-1].isStopIncluded}},length:{get:function(){return this._intervals.length}},isEmpty:{get:function(){return 0===this._intervals.length}}}),y.prototype.equals=function(e,t){if(this===e)return!0;if(!(e instanceof y))return!1;var r=this._intervals,i=e._intervals,n=r.length;if(n!==i.length)return!1;for(var o=0;o<n;o++)if(!v.equals(r[o],i[o],t))return!1;return!0},y.prototype.get=function(e){if(!m(e))throw new g("index is required.");return this._intervals[e]},y.prototype.removeAll=function(){0<this._intervals.length&&(this._intervals.length=0,this._changedEvent.raiseEvent(this))},y.prototype.findIntervalContainingDate=function(e){var t=this.indexOf(e);return 0<=t?this._intervals[t]:void 0},y.prototype.findDataForIntervalContainingDate=function(e){var t=this.indexOf(e);return 0<=t?this._intervals[t].data:void 0},y.prototype.contains=function(e){return 0<=this.indexOf(e)};var n=new v;y.prototype.indexOf=function(e){if(!m(e))throw new g("date is required");var t=this._intervals;n.start=e,n.stop=e;var r=d(t,n,p);return 0<=r?t[r].isStartIncluded?r:0<r&&t[r-1].stop.equals(e)&&t[r-1].isStopIncluded?r-1:~r:0<(r=~r)&&r-1<t.length&&v.contains(t[r-1],e)?r-1:~r},y.prototype.findInterval=function(e){for(var t=(e=f(e,f.EMPTY_OBJECT)).start,r=e.stop,i=e.isStartIncluded,n=e.isStopIncluded,o=this._intervals,a=0,s=o.length;a<s;a++){var l=o[a];if((!m(t)||l.start.equals(t))&&(!m(r)||l.stop.equals(r))&&(!m(i)||l.isStartIncluded===i)&&(!m(n)||l.isStopIncluded===n))return o[a]}},y.prototype.addInterval=function(e,t){if(!m(e))throw new g("interval is required");if(!e.isEmpty){var r,i,n=this._intervals;if(0===n.length||h.greaterThan(e.start,n[n.length-1].stop))return n.push(e),void this._changedEvent.raiseEvent(this);for((i=d(n,e,p))<0?i=~i:0<i&&e.isStartIncluded&&n[i-1].isStartIncluded&&n[i-1].start.equals(e.start)?--i:i<n.length&&!e.isStartIncluded&&n[i].isStartIncluded&&n[i].start.equals(e.start)&&++i,0<i&&(0<(r=h.compare(n[i-1].stop,e.start))||0===r&&(n[i-1].isStopIncluded||e.isStartIncluded))&&((m(t)?t(n[i-1].data,e.data):n[i-1].data===e.data)?(e=h.greaterThan(e.stop,n[i-1].stop)?new v({start:n[i-1].start,stop:e.stop,isStartIncluded:n[i-1].isStartIncluded,isStopIncluded:e.isStopIncluded,data:e.data}):new v({start:n[i-1].start,stop:n[i-1].stop,isStartIncluded:n[i-1].isStartIncluded,isStopIncluded:n[i-1].isStopIncluded||e.stop.equals(n[i-1].stop)&&e.isStopIncluded,data:e.data}),n.splice(i-1,1),--i):0<(r=h.compare(n[i-1].stop,e.stop))||0===r&&n[i-1].isStopIncluded&&!e.isStopIncluded?n.splice(i-1,1,new v({start:n[i-1].start,stop:e.start,isStartIncluded:n[i-1].isStartIncluded,isStopIncluded:!e.isStartIncluded,data:n[i-1].data}),new v({start:e.stop,stop:n[i-1].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:n[i-1].isStopIncluded,data:n[i-1].data})):n[i-1]=new v({start:n[i-1].start,stop:e.start,isStartIncluded:n[i-1].isStartIncluded,isStopIncluded:!e.isStartIncluded,data:n[i-1].data}));i<n.length&&(0<(r=h.compare(e.stop,n[i].start))||0===r&&(e.isStopIncluded||n[i].isStartIncluded));)if(m(t)?t(n[i].data,e.data):n[i].data===e.data)e=new v({start:e.start,stop:h.greaterThan(n[i].stop,e.stop)?n[i].stop:e.stop,isStartIncluded:e.isStartIncluded,isStopIncluded:h.greaterThan(n[i].stop,e.stop)?n[i].isStopIncluded:e.isStopIncluded,data:e.data}),n.splice(i,1);else{if(n[i]=new v({start:e.stop,stop:n[i].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:n[i].isStopIncluded,data:n[i].data}),!n[i].isEmpty)break;n.splice(i,1)}n.splice(i,0,e),this._changedEvent.raiseEvent(this)}},y.prototype.removeInterval=function(e){if(!m(e))throw new g("interval is required");if(e.isEmpty)return!1;var t=!1,r=this._intervals,i=d(r,e,p);i<0&&(i=~i);var n=e.start,o=e.stop,a=e.isStartIncluded,s=e.isStopIncluded;if(0<i){var l=r[i-1],u=l.stop;(h.greaterThan(u,n)||v.equals(u,n)&&l.isStopIncluded&&a)&&(t=!0,(h.greaterThan(u,o)||l.isStopIncluded&&!s&&v.equals(u,o))&&r.splice(i,0,new v({start:o,stop:u,isStartIncluded:!s,isStopIncluded:l.isStopIncluded,data:l.data})),r[i-1]=new v({start:l.start,stop:n,isStartIncluded:l.isStartIncluded,isStopIncluded:!a,data:l.data}))}var c=r[i];for(i<r.length&&!a&&c.isStartIncluded&&n.equals(c.start)&&(t=!0,r.splice(i,0,new v({start:c.start,stop:c.start,isStartIncluded:!0,isStopIncluded:!0,data:c.data})),c=r[++i]);i<r.length&&h.greaterThan(o,c.stop);)t=!0,r.splice(i,1),c=r[i];return i<r.length&&o.equals(c.stop)&&(t=!0,!s&&c.isStopIncluded?(c=i+1<r.length&&r[i+1].start.equals(o)&&c.data===r[i+1].data?(r.splice(i,1),new v({start:c.start,stop:c.stop,isStartIncluded:!0,isStopIncluded:c.isStopIncluded,data:c.data})):new v({start:o,stop:o,isStartIncluded:!0,isStopIncluded:!0,data:c.data}),r[i]=c):r.splice(i,1)),i<r.length&&(h.greaterThan(o,c.start)||o.equals(c.start)&&s&&c.isStartIncluded)&&(t=!0,r[i]=new v({start:o,stop:c.stop,isStartIncluded:!s,isStopIncluded:c.isStopIncluded,data:c.data})),t&&this._changedEvent.raiseEvent(this),t},y.prototype.intersect=function(e,t,r){if(!m(e))throw new g("other is required.");for(var i=0,n=0,o=new y,a=this._intervals,s=e._intervals;i<a.length&&n<s.length;){var l=a[i],u=s[n];if(h.lessThan(l.stop,u.start))++i;else if(h.lessThan(u.stop,l.start))++n;else{if(m(r)||m(t)&&t(l.data,u.data)||!m(t)&&u.data===l.data){var c=v.intersect(l,u,new v,r);c.isEmpty||o.addInterval(c,t)}h.lessThan(l.stop,u.stop)||l.stop.equals(u.stop)&&!l.isStopIncluded&&u.isStopIncluded?++i:++n}}return o},y.fromJulianDateArray=function(e,t){if(!m(e))throw new g("options is required.");if(!m(e.julianDates))throw new g("options.iso8601Array is required.");m(t)||(t=new y);var r,i=e.julianDates,n=i.length,o=e.dataCallback,a=f(e.isStartIncluded,!0),s=f(e.isStopIncluded,!0),l=f(e.leadingInterval,!1),u=f(e.trailingInterval,!1),c=0;l&&(++c,(r=new v({start:_.MINIMUM_VALUE,stop:i[0],isStartIncluded:!0,isStopIncluded:!a})).data=m(o)?o(r,t.length):t.length,t.addInterval(r));for(var d=0;d<n-1;++d){var h=i[d],p=i[d+1];(r=new v({start:h,stop:p,isStartIncluded:t.length!==c||a,isStopIncluded:d===n-2&&s})).data=m(o)?o(r,t.length):t.length,t.addInterval(r),h=p}return u&&((r=new v({start:i[n-1],stop:_.MAXIMUM_VALUE,isStartIncluded:!s,isStopIncluded:!0})).data=m(o)?o(r,t.length):t.length,t.addInterval(r)),t};var b=new t,C=[0,31,28,31,30,31,30,31,31,30,31,30,31];function w(e,t,r){m(r)||(r=new h),h.toGregorianDate(e,b);var i=b.millisecond+t.millisecond,n=b.second+t.second,o=b.minute+t.minute,a=b.hour+t.hour,s=b.day+t.day,l=b.month+t.month,u=b.year+t.year;for(1e3<=i&&(n+=Math.floor(i/1e3),i%=1e3),60<=n&&(o+=Math.floor(n/60),n%=60),60<=o&&(a+=Math.floor(o/60),o%=60),24<=a&&(s+=Math.floor(a/24),a%=24),C[2]=c(u)?29:28;s>C[l]||13<=l;)s>C[l]&&(s-=C[l],++l),13<=l&&(--l,u+=Math.floor(l/12),l%=12,++l),C[2]=c(u)?29:28;return b.millisecond=i,b.second=n,b.minute=o,b.hour=a,b.day=s,b.month=l,b.year=u,h.fromGregorianDate(b,r)}var o=new h,a=/P(?:([\d.,]+)Y)?(?:([\d.,]+)M)?(?:([\d.,]+)W)?(?:([\d.,]+)D)?(?:T(?:([\d.,]+)H)?(?:([\d.,]+)M)?(?:([\d.,]+)S)?)?/;function S(e,t){if(!m(e)||0===e.length)return!1;if(t.year=0,t.month=0,t.day=0,t.hour=0,t.minute=0,t.second=0,"P"===e[t.millisecond=0]){var r=e.match(a);if(!m(r))return!1;if(m(r[1])&&(t.year=Number(r[1].replace(",","."))),m(r[2])&&(t.month=Number(r[2].replace(",","."))),m(r[3])&&(t.day=7*Number(r[3].replace(",","."))),m(r[4])&&(t.day+=Number(r[4].replace(",","."))),m(r[5])&&(t.hour=Number(r[5].replace(",","."))),m(r[6])&&(t.minute=Number(r[6].replace(",","."))),m(r[7])){var i=Number(r[7].replace(",","."));t.second=Math.floor(i),t.millisecond=i%1*1e3}}else"Z"!==e[e.length-1]&&(e+="Z"),h.toGregorianDate(h.fromIso8601(e,o),t);return t.year||t.month||t.day||t.hour||t.minute||t.second||t.millisecond}var T=new t;return y.fromIso8601=function(e,t){if(!m(e))throw new g("options is required.");if(!m(e.iso8601))throw new g("options.iso8601 is required.");var r=e.iso8601.split("/"),i=h.fromIso8601(r[0]),n=h.fromIso8601(r[1]),o=[];if(S(r[2],T)){var a=h.clone(i);for(o.push(a);h.compare(a,n)<0;){a=w(a,T),h.compare(n,a)<=0&&h.clone(n,a),o.push(a)}}else o.push(i,n);return y.fromJulianDateArray({julianDates:o,isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)},y.fromIso8601DateArray=function(e,t){if(!m(e))throw new g("options is required.");if(!m(e.iso8601Dates))throw new g("options.iso8601Dates is required.");return y.fromJulianDateArray({julianDates:e.iso8601Dates.map(function(e){return h.fromIso8601(e)}),isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)},y.fromIso8601DurationArray=function(e,t){if(!m(e))throw new g("options is required.");if(!m(e.epoch))throw new g("options.epoch is required.");if(!m(e.iso8601Durations))throw new g("options.iso8601Durations is required.");for(var r,i,n=e.epoch,o=e.iso8601Durations,a=f(e.relativeToPrevious,!1),s=[],l=o.length,u=0;u<l;++u)(S(o[u],T)||0===u)&&(r=a&&m(i)?w(i,T):w(n,T),s.push(r),i=r);return y.fromJulianDateArray({julianDates:s,isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)},y}),define("Core/TranslationRotationScale",["./Cartesian3","./defaultValue","./defined","./Quaternion"],function(i,n,t,o){"use strict";var a=new i(1,1,1),s=i.ZERO,l=o.IDENTITY,e=function(e,t,r){this.translation=i.clone(n(e,s)),this.rotation=o.clone(n(t,l)),this.scale=i.clone(n(r,a))};return e.prototype.equals=function(e){return this===e||t(e)&&i.equals(this.translation,e.translation)&&o.equals(this.rotation,e.rotation)&&i.equals(this.scale,e.scale)},e}),define("Core/VideoSynchronizer",["./defaultValue","./defined","./defineProperties","./destroyObject","./Iso8601","./JulianDate"],function(d,h,e,t,p,f){"use strict";function r(e){e=d(e,d.EMPTY_OBJECT),this._clock=void 0,this._element=void 0,this._clockSubscription=void 0,this._seekFunction=void 0,this.clock=e.clock,this.element=e.element,this.epoch=d(e.epoch,p.MINIMUM_VALUE),this.tolerance=d(e.tolerance,1),this._seeking=!1,this._seekFunction=void 0,this._firstTickAfterSeek=!1}return e(r.prototype,{clock:{get:function(){return this._clock},set:function(e){var t=this._clock;t!==e&&(h(t)&&(this._clockSubscription(),this._clockSubscription=void 0),h(e)&&(this._clockSubscription=e.onTick.addEventListener(r.prototype._onTick,this)),this._clock=e)}},element:{get:function(){return this._element},set:function(e){var t,r=this._element;r!==e&&(h(r)&&r.removeEventListener("seeked",this._seekFunction,!1),h(e)&&(this._seeking=!1,this._seekFunction=(t=this,function(){t._seeking=!1,t._firstTickAfterSeek=!0}),e.addEventListener("seeked",this._seekFunction,!1)),this._element=e,this._seeking=!1,this._firstTickAfterSeek=!1)}}}),r.prototype.destroy=function(){return this.element=void 0,this.clock=void 0,t(this)},r.prototype.isDestroyed=function(){return!1},r.prototype._onTick=function(e){var t=this._element;if(h(t)&&!(t.readyState<2)){var r=t.paused,i=e.shouldAnimate;if(i===r&&(i?t.play():t.pause()),this._seeking||this._firstTickAfterSeek)this._firstTickAfterSeek=!1;else{t.playbackRate=e.multiplier;var n,o=e.currentTime,a=d(this.epoch,p.MINIMUM_VALUE),s=f.secondsDifference(o,a),l=t.duration,u=t.currentTime;n=t.loop?((s%=l)<0&&(s=l-s),s):l<s?l:s<0?0:s;var c=i?d(this.tolerance,1):.001;Math.abs(n-u)>c&&(this._seeking=!0,t.currentTime=n)}}},r}),define("Core/VRTheWorldTerrainProvider",["../ThirdParty/when","./Credit","./defaultValue","./defined","./defineProperties","./deprecationWarning","./DeveloperError","./Ellipsoid","./Event","./GeographicTilingScheme","./getImagePixels","./HeightmapTerrainData","./Math","./Rectangle","./Resource","./TerrainProvider","./TileProviderError"],function(s,a,l,f,e,u,c,m,g,_,d,h,v,y,b,C,w){"use strict";function S(e,t){this.rectangle=e,this.maxLevel=t}function t(e){if(e=l(e,l.EMPTY_OBJECT),!f(e.url))throw new c("options.url is required.");f(e.proxy)&&u("VRTheWorldTerrainProvider.proxy","The options.proxy parameter has been deprecated. Specify options.url as a Resource instance and set the proxy property there.");var t=b.createIfNeeded(e.url,{proxy:e.proxy});this._resource=t,this._errorEvent=new g,this._ready=!1,this._readyPromise=s.defer(),this._terrainDataStructure={heightScale:.001,heightOffset:-1e3,elementsPerHeight:3,stride:4,elementMultiplier:256,isBigEndian:!0,lowestEncodedHeight:0,highestEncodedHeight:16777215};var r=e.credit;"string"==typeof r&&(r=new a({text:r})),this._credit=r,this._tilingScheme=void 0,this._rectangles=[];var i,d=this,h=l(e.ellipsoid,m.WGS84);function n(e){var t=e.getElementsByTagName("SRS")[0].textContent;if("EPSG:4326"===t){d._tilingScheme=new _({ellipsoid:h});var r=e.getElementsByTagName("TileFormat")[0];d._heightmapWidth=parseInt(r.getAttribute("width"),10),d._heightmapHeight=parseInt(r.getAttribute("height"),10),d._levelZeroMaximumGeometricError=C.getEstimatedLevelZeroGeometricErrorForAHeightmap(h,Math.min(d._heightmapWidth,d._heightmapHeight),d._tilingScheme.getNumberOfXTilesAtLevel(0));for(var i=e.getElementsByTagName("DataExtent"),n=0;n<i.length;++n){var o=i[n],a=v.toRadians(parseFloat(o.getAttribute("minx"))),s=v.toRadians(parseFloat(o.getAttribute("miny"))),l=v.toRadians(parseFloat(o.getAttribute("maxx"))),u=v.toRadians(parseFloat(o.getAttribute("maxy"))),c=parseInt(o.getAttribute("maxlevel"),10);d._rectangles.push(new S(new y(a,s,l,u),c))}d._ready=!0,d._readyPromise.resolve(!0)}else p("SRS "+t+" is not supported.")}function p(e){var t=l(e,"An error occurred while accessing "+d._resource.url+".");i=w.handleError(i,d,d._errorEvent,t,void 0,void 0,void 0,o)}function o(){s(d._resource.fetchXML(),n,p)}o()}e(t.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){if(!this.ready)throw new c("requestTileGeometry must not be called before ready returns true.");return this._tilingScheme}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}}}),t.prototype.requestTileGeometry=function(t,r,i,e){if(!this.ready)throw new c("requestTileGeometry must not be called before ready returns true.");var n=this._tilingScheme.getNumberOfYTilesAtLevel(i),o=this._resource.getDerivedResource({url:i+"/"+t+"/"+(n-r-1)+".tif",queryParameters:{cesium:!0},request:e}).fetchImage();if(f(o)){var a=this;return s(o,function(e){return new h({buffer:d(e),width:a._heightmapWidth,height:a._heightmapHeight,childTileMask:function(e,t,r,i){for(var n=e._tilingScheme,o=e._rectangles,a=n.tileXYToRectangle(t,r,i),s=0,l=0;l<o.length&&15!==s;++l){var u=o[l];if(!(u.maxLevel<=i)){var c=u.rectangle,d=y.intersection(c,a,p);f(d)&&(T(n,c,2*t,2*r,i+1)&&(s|=4),T(n,c,2*t+1,2*r,i+1)&&(s|=8),T(n,c,2*t,2*r+1,i+1)&&(s|=1),T(n,c,2*t+1,2*r+1,i+1)&&(s|=2))}}return s}(a,t,r,i),structure:a._terrainDataStructure})})}},t.prototype.getLevelMaximumGeometricError=function(e){if(!this.ready)throw new c("requestTileGeometry must not be called before ready returns true.");return this._levelZeroMaximumGeometricError/(1<<e)};var p=new y;function T(e,t,r,i,n){var o=e.tileXYToRectangle(r,i,n);return f(y.intersection(o,t,p))}return t.prototype.getTileDataAvailable=function(e,t,r){},t}),define("Core/WallGeometryLibrary",["./Cartographic","./defined","./EllipsoidTangentPlane","./Math","./PolygonPipeline","./PolylinePipeline","./WindingOrder"],function(b,C,w,S,T,E,A){"use strict";var e={};var x=new b,P=new b;var D=new Array(2),O=new Array(2),I={positions:void 0,height:void 0,granularity:void 0,ellipsoid:void 0};return e.computePositions=function(e,t,r,i,n,o){var a=function(e,t,r,i){var n=t.length;if(!(n<2)){var o=C(i),a=C(r),s=!0,l=new Array(n),u=new Array(n),c=new Array(n),d=t[0];l[0]=d;var h=e.cartesianToCartographic(d,x);a&&(h.height=r[0]),s=s&&h.height<=0,u[0]=h.height,c[0]=o?i[0]:0;for(var p,f,m=1,g=1;g<n;++g){var _=t[g],v=e.cartesianToCartographic(_,P);a&&(v.height=r[g]),s=s&&v.height<=0,p=h,f=v,S.equalsEpsilon(p.latitude,f.latitude,S.EPSILON14)&&S.equalsEpsilon(p.longitude,f.longitude,S.EPSILON14)?h.height<v.height&&(u[m-1]=v.height):(l[m]=_,u[m]=v.height,c[m]=o?i[g]:0,b.clone(v,h),++m)}if(!(s||m<2))return l.length=m,u.length=m,c.length=m,{positions:l,topHeights:u,bottomHeights:c}}}(e,t,r,i);if(C(a)){if(t=a.positions,r=a.topHeights,i=a.bottomHeights,3<=t.length){var s=w.fromPoints(t,e).projectPointsOntoPlane(t);T.computeWindingOrder2D(s)===A.CLOCKWISE&&(t.reverse(),r.reverse(),i.reverse())}var l,u,c=t.length,d=c-2,h=S.chordLength(n,e.maximumRadius),p=I;if(p.minDistance=h,p.ellipsoid=e,o){var f,m=0;for(f=0;f<c-1;f++)m+=E.numberOfPoints(t[f],t[f+1],h)+1;l=new Float64Array(3*m),u=new Float64Array(3*m);var g=D,_=O;p.positions=g,p.height=_;var v=0;for(f=0;f<c-1;f++){g[0]=t[f],g[1]=t[f+1],_[0]=r[f],_[1]=r[f+1];var y=E.generateArc(p);l.set(y,v),_[0]=i[f],_[1]=i[f+1],u.set(E.generateArc(p),v),v+=y.length}}else p.positions=t,p.height=r,l=new Float64Array(E.generateArc(p)),p.height=i,u=new Float64Array(E.generateArc(p));return{bottomPositions:u,topPositions:l,numCorners:d}}},e}),define("Core/WallGeometry",["./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType","./VertexFormat","./WallGeometryLibrary"],function(X,Q,Z,d,K,h,p,J,$,ee,te,re,ie,f,ne){"use strict";var oe=new Q,ae=new Q,se=new Q,le=new Q,ue=new Q,ce=new Q,de=new Q,he=new Q;function m(e){var t=(e=d(e,d.EMPTY_OBJECT)).positions,r=e.maximumHeights,i=e.minimumHeights;if(!K(t))throw new h("options.positions is required.");if(K(r)&&r.length!==t.length)throw new h("options.positions and options.maximumHeights must have the same length.");if(K(i)&&i.length!==t.length)throw new h("options.positions and options.minimumHeights must have the same length.");var n=d(e.vertexFormat,f.DEFAULT),o=d(e.granularity,re.RADIANS_PER_DEGREE),a=d(e.ellipsoid,p.WGS84);this._positions=t,this._minimumHeights=i,this._maximumHeights=r,this._vertexFormat=f.clone(n),this._granularity=o,this._ellipsoid=p.clone(a),this._workerName="createWallGeometry";var s=1+t.length*Q.packedLength+2;K(i)&&(s+=i.length),K(r)&&(s+=r.length),this.packedLength=s+p.packedLength+f.packedLength+1}m.pack=function(e,t,r){if(!K(e))throw new h("value is required");if(!K(t))throw new h("array is required");var i;r=d(r,0);var n=e._positions,o=n.length;for(t[r++]=o,i=0;i<o;++i,r+=Q.packedLength)Q.pack(n[i],t,r);var a=e._minimumHeights;if(o=K(a)?a.length:0,t[r++]=o,K(a))for(i=0;i<o;++i)t[r++]=a[i];var s=e._maximumHeights;if(o=K(s)?s.length:0,t[r++]=o,K(s))for(i=0;i<o;++i)t[r++]=s[i];return p.pack(e._ellipsoid,t,r),r+=p.packedLength,f.pack(e._vertexFormat,t,r),t[r+=f.packedLength]=e._granularity,t};var g=p.clone(p.UNIT_SPHERE),_=new f,v={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:g,vertexFormat:_,granularity:void 0};return m.unpack=function(e,t,r){if(!K(e))throw new h("array is required");var i;t=d(t,0);var n,o,a=e[t++],s=new Array(a);for(i=0;i<a;++i,t+=Q.packedLength)s[i]=Q.unpack(e,t);if(0<(a=e[t++]))for(n=new Array(a),i=0;i<a;++i)n[i]=e[t++];if(0<(a=e[t++]))for(o=new Array(a),i=0;i<a;++i)o[i]=e[t++];var l=p.unpack(e,t,g);t+=p.packedLength;var u=f.unpack(e,t,_),c=e[t+=f.packedLength];return K(r)?(r._positions=s,r._minimumHeights=n,r._maximumHeights=o,r._ellipsoid=p.clone(l,r._ellipsoid),r._vertexFormat=f.clone(u,r._vertexFormat),r._granularity=c,r):(v.positions=s,v.minimumHeights=n,v.maximumHeights=o,v.granularity=c,new m(v))},m.fromConstantHeights=function(e){var t,r,i=(e=d(e,d.EMPTY_OBJECT)).positions;if(!K(i))throw new h("options.positions is required.");var n=e.minimumHeight,o=e.maximumHeight,a=K(n),s=K(o);if(a||s){var l=i.length;t=a?new Array(l):void 0,r=s?new Array(l):void 0;for(var u=0;u<l;++u)a&&(t[u]=n),s&&(r[u]=o)}return new m({positions:i,maximumHeights:r,minimumHeights:t,ellipsoid:e.ellipsoid,vertexFormat:e.vertexFormat})},m.createGeometry=function(e){var t=e._positions,r=e._minimumHeights,i=e._maximumHeights,n=e._vertexFormat,o=e._granularity,a=e._ellipsoid,s=ne.computePositions(a,t,i,r,o,!0);if(K(s)){var l,u=s.bottomPositions,c=s.topPositions,d=s.numCorners,h=c.length,p=2*h,f=n.position?new Float64Array(p):void 0,m=n.normal?new Float32Array(p):void 0,g=n.tangent?new Float32Array(p):void 0,_=n.bitangent?new Float32Array(p):void 0,v=n.st?new Float32Array(p/3*2):void 0,y=0,b=0,C=0,w=0,S=0,T=he,E=de,A=ce,x=!0,P=0,D=1/((h/=3)-t.length+1);for(l=0;l<h;++l){var O=3*l,I=Q.fromArray(c,O,oe),M=Q.fromArray(u,O,ae);if(n.position&&(f[y++]=M.x,f[y++]=M.y,f[y++]=M.z,f[y++]=I.x,f[y++]=I.y,f[y++]=I.z),n.st&&(v[S++]=P,v[S++]=0,v[S++]=P,v[S++]=1),n.normal||n.tangent||n.bitangent){var R,L=Q.clone(Q.ZERO,ue),N=a.scaleToGeodeticSurface(Q.fromArray(c,O,ae),ae);if(l+1<h&&(R=a.scaleToGeodeticSurface(Q.fromArray(c,O+3,se),se),L=Q.fromArray(c,O+3,ue)),x){var k=Q.subtract(L,I,le),F=Q.subtract(N,I,oe);T=Q.normalize(Q.cross(F,k,T),T),x=!1}Q.equalsEpsilon(R,N,re.EPSILON10)?x=!0:(P+=D,n.tangent&&(E=Q.normalize(Q.subtract(R,N,E),E)),n.bitangent&&(A=Q.normalize(Q.cross(T,E,A),A))),n.normal&&(m[b++]=T.x,m[b++]=T.y,m[b++]=T.z,m[b++]=T.x,m[b++]=T.y,m[b++]=T.z),n.tangent&&(g[w++]=E.x,g[w++]=E.y,g[w++]=E.z,g[w++]=E.x,g[w++]=E.y,g[w++]=E.z),n.bitangent&&(_[C++]=A.x,_[C++]=A.y,_[C++]=A.z,_[C++]=A.x,_[C++]=A.y,_[C++]=A.z)}}var B=new ee;n.position&&(B.position=new $({componentDatatype:Z.DOUBLE,componentsPerAttribute:3,values:f})),n.normal&&(B.normal=new $({componentDatatype:Z.FLOAT,componentsPerAttribute:3,values:m})),n.tangent&&(B.tangent=new $({componentDatatype:Z.FLOAT,componentsPerAttribute:3,values:g})),n.bitangent&&(B.bitangent=new $({componentDatatype:Z.FLOAT,componentsPerAttribute:3,values:_})),n.st&&(B.st=new $({componentDatatype:Z.FLOAT,componentsPerAttribute:2,values:v}));var U=p/3;p-=6*(d+1);var V=te.createTypedArray(U,p),z=0;for(l=0;l<U-2;l+=2){var q=l,G=l+2,W=Q.fromArray(f,3*q,oe),H=Q.fromArray(f,3*G,ae);if(!Q.equalsEpsilon(W,H,re.EPSILON10)){var j=l+1,Y=l+3;V[z++]=j,V[z++]=q,V[z++]=Y,V[z++]=Y,V[z++]=q,V[z++]=G}}return new J({attributes:B,indices:V,primitiveType:ie.TRIANGLES,boundingSphere:new X.fromVertices(f)})}},m}),define("Core/WallOutlineGeometry",["./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType","./WallGeometryLibrary"],function(x,P,D,c,O,d,h,I,M,R,L,N,k,F){"use strict";var B=new P,U=new P;function p(e){var t=(e=c(e,c.EMPTY_OBJECT)).positions,r=e.maximumHeights,i=e.minimumHeights;if(!O(t))throw new d("options.positions is required.");if(O(r)&&r.length!==t.length)throw new d("options.positions and options.maximumHeights must have the same length.");if(O(i)&&i.length!==t.length)throw new d("options.positions and options.minimumHeights must have the same length.");var n=c(e.granularity,N.RADIANS_PER_DEGREE),o=c(e.ellipsoid,h.WGS84);this._positions=t,this._minimumHeights=i,this._maximumHeights=r,this._granularity=n,this._ellipsoid=h.clone(o),this._workerName="createWallOutlineGeometry";var a=1+t.length*P.packedLength+2;O(i)&&(a+=i.length),O(r)&&(a+=r.length),this.packedLength=a+h.packedLength+1}p.pack=function(e,t,r){if(!O(e))throw new d("value is required");if(!O(t))throw new d("array is required");var i;r=c(r,0);var n=e._positions,o=n.length;for(t[r++]=o,i=0;i<o;++i,r+=P.packedLength)P.pack(n[i],t,r);var a=e._minimumHeights;if(o=O(a)?a.length:0,t[r++]=o,O(a))for(i=0;i<o;++i)t[r++]=a[i];var s=e._maximumHeights;if(o=O(s)?s.length:0,t[r++]=o,O(s))for(i=0;i<o;++i)t[r++]=s[i];return h.pack(e._ellipsoid,t,r),t[r+=h.packedLength]=e._granularity,t};var f=h.clone(h.UNIT_SPHERE),m={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:f,granularity:void 0};return p.unpack=function(e,t,r){if(!O(e))throw new d("array is required");var i;t=c(t,0);var n,o,a=e[t++],s=new Array(a);for(i=0;i<a;++i,t+=P.packedLength)s[i]=P.unpack(e,t);if(0<(a=e[t++]))for(n=new Array(a),i=0;i<a;++i)n[i]=e[t++];if(0<(a=e[t++]))for(o=new Array(a),i=0;i<a;++i)o[i]=e[t++];var l=h.unpack(e,t,f),u=e[t+=h.packedLength];return O(r)?(r._positions=s,r._minimumHeights=n,r._maximumHeights=o,r._ellipsoid=h.clone(l,r._ellipsoid),r._granularity=u,r):(m.positions=s,m.minimumHeights=n,m.maximumHeights=o,m.granularity=u,new p(m))},p.fromConstantHeights=function(e){var t,r,i=(e=c(e,c.EMPTY_OBJECT)).positions;if(!O(i))throw new d("options.positions is required.");var n=e.minimumHeight,o=e.maximumHeight,a=O(n),s=O(o);if(a||s){var l=i.length;t=a?new Array(l):void 0,r=s?new Array(l):void 0;for(var u=0;u<l;++u)a&&(t[u]=n),s&&(r[u]=o)}return new p({positions:i,maximumHeights:r,minimumHeights:t,ellipsoid:e.ellipsoid})},p.createGeometry=function(e){var t=e._positions,r=e._minimumHeights,i=e._maximumHeights,n=e._granularity,o=e._ellipsoid,a=F.computePositions(o,t,i,r,n,!1);if(O(a)){var s,l=a.bottomPositions,u=a.topPositions,c=u.length,d=2*c,h=new Float64Array(d),p=0;for(c/=3,s=0;s<c;++s){var f=3*s,m=P.fromArray(u,f,B),g=P.fromArray(l,f,U);h[p++]=g.x,h[p++]=g.y,h[p++]=g.z,h[p++]=m.x,h[p++]=m.y,h[p++]=m.z}var _=new R({position:new M({componentDatatype:D.DOUBLE,componentsPerAttribute:3,values:h})}),v=d/3;d=2*v-4+v;var y=L.createTypedArray(v,d),b=0;for(s=0;s<v-2;s+=2){var C=s,w=s+2,S=P.fromArray(h,3*C,B),T=P.fromArray(h,3*w,U);if(!P.equalsEpsilon(S,T,N.EPSILON10)){var E=s+1,A=s+3;y[b++]=E,y[b++]=C,y[b++]=E,y[b++]=A,y[b++]=C,y[b++]=w}}return y[b++]=v-2,y[b++]=v-1,new I({attributes:_,indices:y,primitiveType:k.LINES,boundingSphere:new x.fromVertices(h)})}},p}),define("Core/WebMercatorTilingScheme",["./Cartesian2","./defaultValue","./defined","./defineProperties","./Ellipsoid","./Rectangle","./WebMercatorProjection"],function(d,n,h,e,o,p,a){"use strict";function t(e){if(e=n(e,{}),this._ellipsoid=n(e.ellipsoid,o.WGS84),this._numberOfLevelZeroTilesX=n(e.numberOfLevelZeroTilesX,1),this._numberOfLevelZeroTilesY=n(e.numberOfLevelZeroTilesY,1),this._projection=new a(this._ellipsoid),h(e.rectangleSouthwestInMeters)&&h(e.rectangleNortheastInMeters))this._rectangleSouthwestInMeters=e.rectangleSouthwestInMeters,this._rectangleNortheastInMeters=e.rectangleNortheastInMeters;else{var t=this._ellipsoid.maximumRadius*Math.PI;this._rectangleSouthwestInMeters=new d(-t,-t),this._rectangleNortheastInMeters=new d(t,t)}var r=this._projection.unproject(this._rectangleSouthwestInMeters),i=this._projection.unproject(this._rectangleNortheastInMeters);this._rectangle=new p(r.longitude,r.latitude,i.longitude,i.latitude)}return e(t.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}}),t.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e},t.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e},t.prototype.rectangleToNativeRectangle=function(e,t){var r=this._projection,i=r.project(p.southwest(e)),n=r.project(p.northeast(e));return h(t)?(t.west=i.x,t.south=i.y,t.east=n.x,t.north=n.y,t):new p(i.x,i.y,n.x,n.y)},t.prototype.tileXYToNativeRectangle=function(e,t,r,i){var n=this.getNumberOfXTilesAtLevel(r),o=this.getNumberOfYTilesAtLevel(r),a=(this._rectangleNortheastInMeters.x-this._rectangleSouthwestInMeters.x)/n,s=this._rectangleSouthwestInMeters.x+e*a,l=this._rectangleSouthwestInMeters.x+(e+1)*a,u=(this._rectangleNortheastInMeters.y-this._rectangleSouthwestInMeters.y)/o,c=this._rectangleNortheastInMeters.y-t*u,d=this._rectangleNortheastInMeters.y-(t+1)*u;return h(i)?(i.west=s,i.south=d,i.east=l,i.north=c,i):new p(s,d,l,c)},t.prototype.tileXYToRectangle=function(e,t,r,i){var n=this.tileXYToNativeRectangle(e,t,r,i),o=this._projection,a=o.unproject(new d(n.west,n.south)),s=o.unproject(new d(n.east,n.north));return n.west=a.longitude,n.south=a.latitude,n.east=s.longitude,n.north=s.latitude,n},t.prototype.positionToTileXY=function(e,t,r){var i=this._rectangle;if(p.contains(i,e)){var n=this.getNumberOfXTilesAtLevel(t),o=this.getNumberOfYTilesAtLevel(t),a=(this._rectangleNortheastInMeters.x-this._rectangleSouthwestInMeters.x)/n,s=(this._rectangleNortheastInMeters.y-this._rectangleSouthwestInMeters.y)/o,l=this._projection.project(e),u=(l.x-this._rectangleSouthwestInMeters.x)/a|0;n<=u&&(u=n-1);var c=(this._rectangleNortheastInMeters.y-l.y)/s|0;return o<=c&&(c=o-1),h(r)?(r.x=u,r.y=c,r):new d(u,c)}},t}),define("Core/WeightSpline",["./Check","./defaultValue","./defined","./defineProperties","./DeveloperError","./Spline"],function(i,n,l,e,o,t){"use strict";function r(e){var t=(e=n(e,n.EMPTY_OBJECT)).weights,r=e.times;if(i.defined("weights",t),i.defined("times",r),i.typeOf.number.greaterThanOrEquals("weights.length",t.length,3),t.length%r.length!=0)throw new o("times.length must be a factor of weights.length.");this._times=r,this._weights=t,this._count=t.length/r.length,this._lastTimeIndex=0}return e(r.prototype,{times:{get:function(){return this._times}},weights:{get:function(){return this._weights}}}),r.prototype.findTimeInterval=t.prototype.findTimeInterval,r.prototype.wrapTime=t.prototype.wrapTime,r.prototype.clampTime=t.prototype.clampTime,r.prototype.evaluate=function(e,t){var r=this.weights,i=this.times,n=this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex),o=(e-i[n])/(i[n+1]-i[n]);l(t)||(t=new Array(this._count));for(var a=0;a<this._count;a++){var s=n*this._count+a;t[a]=r[s]*(1-o)+r[s+this._count]*o}return t},r}),define("Core/wrapFunction",["./DeveloperError"],function(i){"use strict";return function(e,t,r){if("function"!=typeof t)throw new i("oldFunction is required to be a function.");if("function"!=typeof r)throw new i("oldFunction is required to be a function.");return function(){r.apply(e,arguments),t.apply(e,arguments)}}}),define("DataSources/ConstantProperty",["../Core/defined","../Core/defineProperties","../Core/Event"],function(o,e,t){"use strict";function r(e){this._value=void 0,this._hasClone=!1,this._hasEquals=!1,this._definitionChanged=new t,this.setValue(e)}return e(r.prototype,{isConstant:{value:!0},definitionChanged:{get:function(){return this._definitionChanged}}}),r.prototype.getValue=function(e,t){return this._hasClone?this._value.clone(t):this._value},r.prototype.setValue=function(e){var t=this._value;if(t!==e){var r=o(e),i=r&&"function"==typeof e.clone,n=r&&"function"==typeof e.equals;(!n||!e.equals(t))&&(this._hasClone=i,this._hasEquals=n,this._value=i?e.clone(this._value):e,this._definitionChanged.raiseEvent(this))}},r.prototype.equals=function(e){return this===e||e instanceof r&&(!this._hasEquals&&this._value===e._value||this._hasEquals&&this._value.equals(e._value))},r.prototype.valueOf=function(){return this._value},r.prototype.toString=function(){return String(this._value)},r}),define("DataSources/createPropertyDescriptor",["../Core/defaultValue","../Core/defined","./ConstantProperty"],function(l,u,t){"use strict";function c(e){return new t(e)}return function(e,t,r){return n="_"+(i=e).toString(),o="_"+e.toString()+"Subscription",a=l(t,!1),s=l(r,c),{configurable:a,get:function(){return this[n]},set:function(e){var t=this[n],r=this[o];u(r)&&(r(),this[o]=void 0),!(void 0!==e)||u(e)&&u(e.getValue)||!u(s)||(e=s(e)),t!==e&&(this[n]=e,this._definitionChanged.raiseEvent(this,i,e,t)),u(e)&&u(e.definitionChanged)&&(this[o]=e.definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this,i,e,e)},this))}};var i,n,o,a,s}}),define("DataSources/BillboardGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createPropertyDescriptor"],function(t,r,e,i,n,o){"use strict";function a(e){this._image=void 0,this._imageSubscription=void 0,this._imageSubRegion=void 0,this._imageSubRegionSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._alignedAxis=void 0,this._alignedAxisSubscription=void 0,this._horizontalOrigin=void 0,this._horizontalOriginSubscription=void 0,this._verticalOrigin=void 0,this._verticalOriginSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._eyeOffset=void 0,this._eyeOffsetSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._pixelOffset=void 0,this._pixelOffsetSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._pixelOffsetScaleByDistance=void 0,this._pixelOffsetScaleByDistanceSubscription=void 0,this._sizeInMeters=void 0,this._sizeInMetersSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this._definitionChanged=new n,this.merge(t(e,t.EMPTY_OBJECT))}return e(a.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},image:o("image"),imageSubRegion:o("imageSubRegion"),scale:o("scale"),rotation:o("rotation"),alignedAxis:o("alignedAxis"),horizontalOrigin:o("horizontalOrigin"),verticalOrigin:o("verticalOrigin"),color:o("color"),eyeOffset:o("eyeOffset"),heightReference:o("heightReference"),pixelOffset:o("pixelOffset"),show:o("show"),width:o("width"),height:o("height"),scaleByDistance:o("scaleByDistance"),translucencyByDistance:o("translucencyByDistance"),pixelOffsetScaleByDistance:o("pixelOffsetScaleByDistance"),sizeInMeters:o("sizeInMeters"),distanceDisplayCondition:o("distanceDisplayCondition"),disableDepthTestDistance:o("disableDepthTestDistance")}),a.prototype.clone=function(e){return r(e)?(e.color=this._color,e.eyeOffset=this._eyeOffset,e.heightReference=this._heightReference,e.horizontalOrigin=this._horizontalOrigin,e.image=this._image,e.imageSubRegion=this._imageSubRegion,e.pixelOffset=this._pixelOffset,e.scale=this._scale,e.rotation=this._rotation,e.alignedAxis=this._alignedAxis,e.show=this._show,e.verticalOrigin=this._verticalOrigin,e.width=this._width,e.height=this._height,e.scaleByDistance=this._scaleByDistance,e.translucencyByDistance=this._translucencyByDistance,e.pixelOffsetScaleByDistance=this._pixelOffsetScaleByDistance,e.sizeInMeters=this._sizeInMeters,e.distanceDisplayCondition=this._distanceDisplayCondition,e.disableDepthTestDistance=this._disableDepthTestDistance,e):new a(this)},a.prototype.merge=function(e){if(!r(e))throw new i("source is required.");this.color=t(this._color,e.color),this.eyeOffset=t(this._eyeOffset,e.eyeOffset),this.heightReference=t(this._heightReference,e.heightReference),this.horizontalOrigin=t(this._horizontalOrigin,e.horizontalOrigin),this.image=t(this._image,e.image),this.imageSubRegion=t(this._imageSubRegion,e.imageSubRegion),this.pixelOffset=t(this._pixelOffset,e.pixelOffset),this.scale=t(this._scale,e.scale),this.rotation=t(this._rotation,e.rotation),this.alignedAxis=t(this._alignedAxis,e.alignedAxis),this.show=t(this._show,e.show),this.verticalOrigin=t(this._verticalOrigin,e.verticalOrigin),this.width=t(this._width,e.width),this.height=t(this._height,e.height),this.scaleByDistance=t(this._scaleByDistance,e.scaleByDistance),this.translucencyByDistance=t(this._translucencyByDistance,e.translucencyByDistance),this.pixelOffsetScaleByDistance=t(this._pixelOffsetScaleByDistance,e.pixelOffsetScaleByDistance),this.sizeInMeters=t(this._sizeInMeters,e.sizeInMeters),this.distanceDisplayCondition=t(this._distanceDisplayCondition,e.distanceDisplayCondition),this.disableDepthTestDistance=t(this._disableDepthTestDistance,e.disableDepthTestDistance)},a}),define("Scene/HeightReference",["../Core/freezeObject"],function(e){"use strict";return e({NONE:0,CLAMP_TO_GROUND:1,RELATIVE_TO_GROUND:2})}),define("Scene/HorizontalOrigin",["../Core/freezeObject"],function(e){"use strict";return e({CENTER:0,LEFT:1,RIGHT:-1})}),define("Scene/VerticalOrigin",["../Core/freezeObject"],function(e){"use strict";return e({CENTER:0,BOTTOM:1,BASELINE:2,TOP:-1})}),define("DataSources/BoundingSphereState",["../Core/freezeObject"],function(e){"use strict";return e({DONE:0,PENDING:1,FAILED:2})}),define("DataSources/Property",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError"],function(n,o,e,t){"use strict";function a(){t.throwInstantiationError()}return e(a.prototype,{isConstant:{get:t.throwInstantiationError},definitionChanged:{get:t.throwInstantiationError}}),a.prototype.getValue=t.throwInstantiationError,a.prototype.equals=t.throwInstantiationError,a.equals=function(e,t){return e===t||o(e)&&e.equals(t)},a.arrayEquals=function(e,t){if(e===t)return!0;if(!o(e)||!o(t)||e.length!==t.length)return!1;for(var r=e.length,i=0;i<r;i++)if(!a.equals(e[i],t[i]))return!1;return!0},a.isConstant=function(e){return!o(e)||e.isConstant},a.getValueOrUndefined=function(e,t,r){return o(e)?e.getValue(t,r):void 0},a.getValueOrDefault=function(e,t,r,i){return o(e)?n(e.getValue(t,i),r):r},a.getValueOrClonedDefault=function(e,t,r,i){var n;return o(e)&&(n=e.getValue(t,i)),o(n)||(n=r.clone(n)),n},a}),define("DataSources/BillboardVisualizer",["../Core/AssociativeArray","../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/NearFarScalar","../Scene/HeightReference","../Scene/HorizontalOrigin","../Scene/VerticalOrigin","./BoundingSphereState","./Property"],function(r,e,t,n,i,h,o,p,a,s,l,u,c,d,f){"use strict";var m=i.WHITE,g=n.ZERO,_=l.NONE,v=t.ZERO,y=n.ZERO,b=u.CENTER,C=c.CENTER,w=new n,S=new i,T=new n,E=new t,A=new s,x=new s,P=new s,D=new e,O=new a;function I(e){this.entity=e,this.billboard=void 0,this.textureValue=void 0}function M(e,t){if(!h(e))throw new p("entityCluster is required.");if(!h(t))throw new p("entityCollection is required.");t.collectionChanged.addEventListener(M.prototype._onCollectionChanged,this),this._cluster=e,this._entityCollection=t,this._items=new r,this._onCollectionChanged(t,t.values,[],[])}function R(e,t,r){h(e)&&(e.billboard=void 0,r.removeBillboard(t))}return M.prototype.update=function(e){if(!h(e))throw new p("time is required.");for(var t=this._items.values,r=this._cluster,i=0,n=t.length;i<n;i++){var o,a=t[i],s=a.entity,l=s._billboard,u=a.billboard,c=s.isShowing&&s.isAvailable(e)&&f.getValueOrDefault(l._show,e,!0);if(c&&(w=f.getValueOrUndefined(s._position,e,w),o=f.getValueOrUndefined(l._image,e),c=h(w)&&h(o)),c){f.isConstant(s._position)||(r._clusterDirty=!0),h(u)||((u=r.getBillboard(s)).id=s,u.image=void 0,a.billboard=u),u.show=c,h(u.image)&&a.textureValue===o||(u.image=o,a.textureValue=o),u.position=w,u.color=f.getValueOrDefault(l._color,e,m,S),u.eyeOffset=f.getValueOrDefault(l._eyeOffset,e,g,T),u.heightReference=f.getValueOrDefault(l._heightReference,e,_),u.pixelOffset=f.getValueOrDefault(l._pixelOffset,e,v,E),u.scale=f.getValueOrDefault(l._scale,e,1),u.rotation=f.getValueOrDefault(l._rotation,e,0),u.alignedAxis=f.getValueOrDefault(l._alignedAxis,e,y),u.horizontalOrigin=f.getValueOrDefault(l._horizontalOrigin,e,b),u.verticalOrigin=f.getValueOrDefault(l._verticalOrigin,e,C),u.width=f.getValueOrUndefined(l._width,e),u.height=f.getValueOrUndefined(l._height,e),u.scaleByDistance=f.getValueOrUndefined(l._scaleByDistance,e,A),u.translucencyByDistance=f.getValueOrUndefined(l._translucencyByDistance,e,x),u.pixelOffsetScaleByDistance=f.getValueOrUndefined(l._pixelOffsetScaleByDistance,e,P),u.sizeInMeters=f.getValueOrDefault(l._sizeInMeters,e,!1),u.distanceDisplayCondition=f.getValueOrUndefined(l._distanceDisplayCondition,e,O),u.disableDepthTestDistance=f.getValueOrDefault(l._disableDepthTestDistance,e,0);var d=f.getValueOrUndefined(l._imageSubRegion,e,D);h(d)&&u.setImageSubRegion(u._imageId,d)}else R(a,s,r)}return!0},M.prototype.getBoundingSphere=function(e,t){if(!h(e))throw new p("entity is required.");if(!h(t))throw new p("result is required.");var r=this._items.get(e.id);if(!h(r)||!h(r.billboard))return d.FAILED;var i=r.billboard;if(i.heightReference===l.NONE)t.center=n.clone(i.position,t.center);else{if(!h(i._clampedPosition))return d.PENDING;t.center=n.clone(i._clampedPosition,t.center)}return t.radius=0,d.DONE},M.prototype.isDestroyed=function(){return!1},M.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(M.prototype._onCollectionChanged,this);for(var e=this._entityCollection.values,t=0;t<e.length;t++)this._cluster.removeBillboard(e[t]);return o(this)},M.prototype._onCollectionChanged=function(e,t,r,i){var n,o,a=this._items,s=this._cluster;for(n=t.length-1;-1<n;n--)o=t[n],h(o._billboard)&&h(o._position)&&a.set(o.id,new I(o));for(n=i.length-1;-1<n;n--)o=i[n],h(o._billboard)&&h(o._position)?a.contains(o.id)||a.set(o.id,new I(o)):(R(a.get(o.id),o,s),a.remove(o.id));for(n=r.length-1;-1<n;n--)o=r[n],R(a.get(o.id),o,s),a.remove(o.id)},M}),define("Shaders/Appearances/AllMaterialAppearanceFS",[],function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec3 v_tangentEC;\nvarying vec3 v_bitangentEC;\nvarying vec2 v_st;\nvoid main()\n{\nvec3 positionToEyeEC = -v_positionEC;\nmat3 tangentToEyeMatrix = czm_tangentToEyeSpaceMatrix(v_normalEC, v_tangentEC, v_bitangentEC);\nvec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\nnormalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\nczm_materialInput materialInput;\nmaterialInput.normalEC = normalEC;\nmaterialInput.tangentToEyeMatrix = tangentToEyeMatrix;\nmaterialInput.positionToEyeEC = positionToEyeEC;\nmaterialInput.st = v_st;\nczm_material material = czm_getMaterial(materialInput);\n#ifdef FLAT\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\ngl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"}),define("Shaders/Appearances/AllMaterialAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute vec3 tangent;\nattribute vec3 bitangent;\nattribute vec2 st;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec3 v_tangentEC;\nvarying vec3 v_bitangentEC;\nvarying vec2 v_st;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_positionEC = (czm_modelViewRelativeToEye * p).xyz;\nv_normalEC = czm_normal * normal;\nv_tangentEC = czm_normal * tangent;\nv_bitangentEC = czm_normal * bitangent;\nv_st = st;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"}),define("Shaders/Appearances/BasicMaterialAppearanceFS",[],function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvoid main()\n{\nvec3 positionToEyeEC = -v_positionEC;\nvec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\nnormalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\nczm_materialInput materialInput;\nmaterialInput.normalEC = normalEC;\nmaterialInput.positionToEyeEC = positionToEyeEC;\nczm_material material = czm_getMaterial(materialInput);\n#ifdef FLAT\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\ngl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"}),define("Shaders/Appearances/BasicMaterialAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_positionEC = (czm_modelViewRelativeToEye * p).xyz;\nv_normalEC = czm_normal * normal;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"}),define("Shaders/Appearances/TexturedMaterialAppearanceFS",[],function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\nvoid main()\n{\nvec3 positionToEyeEC = -v_positionEC;\nvec3 normalEC = normalize(v_normalEC);;\n#ifdef FACE_FORWARD\nnormalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\nczm_materialInput materialInput;\nmaterialInput.normalEC = normalEC;\nmaterialInput.positionToEyeEC = positionToEyeEC;\nmaterialInput.st = v_st;\nczm_material material = czm_getMaterial(materialInput);\n#ifdef FLAT\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\ngl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"}),define("Shaders/Appearances/TexturedMaterialAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute vec2 st;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_positionEC = (czm_modelViewRelativeToEye * p).xyz;\nv_normalEC = czm_normal * normal;\nv_st = st;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"}),define("Scene/BlendEquation",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";return e({ADD:t.FUNC_ADD,SUBTRACT:t.FUNC_SUBTRACT,REVERSE_SUBTRACT:t.FUNC_REVERSE_SUBTRACT,MIN:t.MIN,MAX:t.MAX})}),define("Scene/BlendFunction",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";return e({ZERO:t.ZERO,ONE:t.ONE,SOURCE_COLOR:t.SRC_COLOR,ONE_MINUS_SOURCE_COLOR:t.ONE_MINUS_SRC_COLOR,DESTINATION_COLOR:t.DST_COLOR,ONE_MINUS_DESTINATION_COLOR:t.ONE_MINUS_DST_COLOR,SOURCE_ALPHA:t.SRC_ALPHA,ONE_MINUS_SOURCE_ALPHA:t.ONE_MINUS_SRC_ALPHA,DESTINATION_ALPHA:t.DST_ALPHA,ONE_MINUS_DESTINATION_ALPHA:t.ONE_MINUS_DST_ALPHA,CONSTANT_COLOR:t.CONSTANT_COLOR,ONE_MINUS_CONSTANT_COLOR:t.ONE_MINUS_CONSTANT_ALPHA,CONSTANT_ALPHA:t.CONSTANT_ALPHA,ONE_MINUS_CONSTANT_ALPHA:t.ONE_MINUS_CONSTANT_ALPHA,SOURCE_ALPHA_SATURATE:t.SRC_ALPHA_SATURATE})}),define("Scene/BlendingState",["../Core/freezeObject","./BlendEquation","./BlendFunction"],function(e,t,r){"use strict";return e({DISABLED:e({enabled:!1}),ALPHA_BLEND:e({enabled:!0,equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:r.SOURCE_ALPHA,functionSourceAlpha:r.SOURCE_ALPHA,functionDestinationRgb:r.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:r.ONE_MINUS_SOURCE_ALPHA}),PRE_MULTIPLIED_ALPHA_BLEND:e({enabled:!0,equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:r.ONE,functionSourceAlpha:r.ONE,functionDestinationRgb:r.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:r.ONE_MINUS_SOURCE_ALPHA}),ADDITIVE_BLEND:e({enabled:!0,equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:r.SOURCE_ALPHA,functionSourceAlpha:r.SOURCE_ALPHA,functionDestinationRgb:r.ONE,functionDestinationAlpha:r.ONE})})}),define("Scene/CullFace",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";return e({FRONT:t.FRONT,BACK:t.BACK,FRONT_AND_BACK:t.FRONT_AND_BACK})}),define("Scene/Appearance",["../Core/clone","../Core/combine","../Core/defaultValue","../Core/defined","../Core/defineProperties","./BlendingState","./CullFace"],function(r,n,t,o,e,a,s){"use strict";function i(e){e=t(e,t.EMPTY_OBJECT),this.material=e.material,this.translucent=t(e.translucent,!0),this._vertexShaderSource=e.vertexShaderSource,this._fragmentShaderSource=e.fragmentShaderSource,this._renderState=e.renderState,this._closed=t(e.closed,!1)}return e(i.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}}}),i.prototype.getFragmentShaderSource=function(){var e=[];return this.flat&&e.push("#define FLAT"),this.faceForward&&e.push("#define FACE_FORWARD"),o(this.material)&&e.push(this.material.shaderSource),e.push(this.fragmentShaderSource),e.join("\n")},i.prototype.isTranslucent=function(){return o(this.material)&&this.material.isTranslucent()||!o(this.material)&&this.translucent},i.prototype.getRenderState=function(){var e=this.isTranslucent(),t=r(this.renderState,!1);return e?(t.depthMask=!1,t.blending=a.ALPHA_BLEND):t.depthMask=!0,t},i.getDefaultRenderState=function(e,t,r){var i={depthTest:{enabled:!0}};return e&&(i.depthMask=!1,i.blending=a.ALPHA_BLEND),t&&(i.cull={enabled:!0,face:s.BACK}),o(r)&&(i=n(r,i,!0)),i},i}),define("Renderer/ContextLimits",["../Core/defineProperties"],function(e){"use strict";var t={_maximumCombinedTextureImageUnits:0,_maximumCubeMapSize:0,_maximumFragmentUniformVectors:0,_maximumTextureImageUnits:0,_maximumRenderbufferSize:0,_maximumTextureSize:0,_maximumVaryingVectors:0,_maximumVertexAttributes:0,_maximumVertexTextureImageUnits:0,_maximumVertexUniformVectors:0,_minimumAliasedLineWidth:0,_maximumAliasedLineWidth:0,_minimumAliasedPointSize:0,_maximumAliasedPointSize:0,_maximumViewportWidth:0,_maximumViewportHeight:0,_maximumTextureFilterAnisotropy:0,_maximumDrawBuffers:0,_maximumColorAttachments:0,_highpFloatSupported:!1,_highpIntSupported:!1};return e(t,{maximumCombinedTextureImageUnits:{get:function(){return t._maximumCombinedTextureImageUnits}},maximumCubeMapSize:{get:function(){return t._maximumCubeMapSize}},maximumFragmentUniformVectors:{get:function(){return t._maximumFragmentUniformVectors}},maximumTextureImageUnits:{get:function(){return t._maximumTextureImageUnits}},maximumRenderbufferSize:{get:function(){return t._maximumRenderbufferSize}},maximumTextureSize:{get:function(){return t._maximumTextureSize}},maximumVaryingVectors:{get:function(){return t._maximumVaryingVectors}},maximumVertexAttributes:{get:function(){return t._maximumVertexAttributes}},maximumVertexTextureImageUnits:{get:function(){return t._maximumVertexTextureImageUnits}},maximumVertexUniformVectors:{get:function(){return t._maximumVertexUniformVectors}},minimumAliasedLineWidth:{get:function(){return t._minimumAliasedLineWidth}},maximumAliasedLineWidth:{get:function(){return t._maximumAliasedLineWidth}},minimumAliasedPointSize:{get:function(){return t._minimumAliasedPointSize}},maximumAliasedPointSize:{get:function(){return t._maximumAliasedPointSize}},maximumViewportWidth:{get:function(){return t._maximumViewportWidth}},maximumViewportHeight:{get:function(){return t._maximumViewportHeight}},maximumTextureFilterAnisotropy:{get:function(){return t._maximumTextureFilterAnisotropy}},maximumDrawBuffers:{get:function(){return t._maximumDrawBuffers}},maximumColorAttachments:{get:function(){return t._maximumColorAttachments}},highpFloatSupported:{get:function(){return t._highpFloatSupported}},highpIntSupported:{get:function(){return t._highpIntSupported}}}),t}),define("Renderer/CubeMapFace",["../Core/Check","../Core/defaultValue","../Core/defineProperties","../Core/DeveloperError","./PixelDatatype"],function(l,u,e,c,d){"use strict";function t(e,t,r,i,n,o,a,s,l){this._gl=e,this._texture=t,this._textureTarget=r,this._targetFace=i,this._pixelFormat=n,this._pixelDatatype=o,this._size=a,this._preMultiplyAlpha=s,this._flipY=l}return e(t.prototype,{pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},_target:{get:function(){return this._targetFace}}}),t.prototype.copyFrom=function(e,t,r){if(t=u(t,0),r=u(r,0),l.defined("source",e),l.typeOf.number.greaterThanOrEquals("xOffset",t,0),l.typeOf.number.greaterThanOrEquals("yOffset",r,0),t+e.width>this._size)throw new c("xOffset + source.width must be less than or equal to width.");if(r+e.height>this._size)throw new c("yOffset + source.height must be less than or equal to height.");var i=this._gl,n=this._textureTarget;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._preMultiplyAlpha),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,this._flipY),i.activeTexture(i.TEXTURE0),i.bindTexture(n,this._texture),e.arrayBufferView?i.texSubImage2D(this._targetFace,0,t,r,e.width,e.height,this._pixelFormat,this._pixelDatatype,e.arrayBufferView):i.texSubImage2D(this._targetFace,0,t,r,this._pixelFormat,this._pixelDatatype,e),i.bindTexture(n,null)},t.prototype.copyFromFramebuffer=function(e,t,r,i,n,o){if(e=u(e,0),t=u(t,0),r=u(r,0),i=u(i,0),n=u(n,this._size),o=u(o,this._size),l.typeOf.number.greaterThanOrEquals("xOffset",e,0),l.typeOf.number.greaterThanOrEquals("yOffset",t,0),l.typeOf.number.greaterThanOrEquals("framebufferXOffset",r,0),l.typeOf.number.greaterThanOrEquals("framebufferYOffset",i,0),e+n>this._size)throw new c("xOffset + source.width must be less than or equal to width.");if(t+o>this._size)throw new c("yOffset + source.height must be less than or equal to height.");if(this._pixelDatatype===d.FLOAT)throw new c("Cannot call copyFromFramebuffer when the texture pixel data type is FLOAT.");var a=this._gl,s=this._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(s,this._texture),a.copyTexSubImage2D(this._targetFace,0,e,t,r,i,n,o),a.bindTexture(s,null)},t}),define("Renderer/MipmapHint",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={DONT_CARE:t.DONT_CARE,FASTEST:t.FASTEST,NICEST:t.NICEST,validate:function(e){return e===r.DONT_CARE||e===r.FASTEST||e===r.NICEST}};return e(r)}),define("Renderer/TextureMagnificationFilter",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={NEAREST:t.NEAREST,LINEAR:t.LINEAR,validate:function(e){return e===r.NEAREST||e===r.LINEAR}};return e(r)}),define("Renderer/TextureMinificationFilter",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={NEAREST:t.NEAREST,LINEAR:t.LINEAR,NEAREST_MIPMAP_NEAREST:t.NEAREST_MIPMAP_NEAREST,LINEAR_MIPMAP_NEAREST:t.LINEAR_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:t.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_LINEAR:t.LINEAR_MIPMAP_LINEAR,validate:function(e){return e===r.NEAREST||e===r.LINEAR||e===r.NEAREST_MIPMAP_NEAREST||e===r.LINEAR_MIPMAP_NEAREST||e===r.NEAREST_MIPMAP_LINEAR||e===r.LINEAR_MIPMAP_LINEAR}};return e(r)}),define("Renderer/TextureWrap",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={CLAMP_TO_EDGE:t.CLAMP_TO_EDGE,REPEAT:t.REPEAT,MIRRORED_REPEAT:t.MIRRORED_REPEAT,validate:function(e){return e===r.CLAMP_TO_EDGE||e===r.REPEAT||e===r.MIRRORED_REPEAT}};return e(r)}),define("Renderer/Sampler",["../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","./TextureMagnificationFilter","./TextureMinificationFilter","./TextureWrap"],function(a,s,l,e,u,c,d,h){"use strict";function t(e){e=s(e,s.EMPTY_OBJECT);var t=s(e.wrapS,h.CLAMP_TO_EDGE),r=s(e.wrapT,h.CLAMP_TO_EDGE),i=s(e.minificationFilter,d.LINEAR),n=s(e.magnificationFilter,c.LINEAR),o=l(e.maximumAnisotropy)?e.maximumAnisotropy:1;if(!h.validate(t))throw new u("Invalid sampler.wrapS.");if(!h.validate(r))throw new u("Invalid sampler.wrapT.");if(!d.validate(i))throw new u("Invalid sampler.minificationFilter.");if(!c.validate(n))throw new u("Invalid sampler.magnificationFilter.");a.typeOf.number.greaterThanOrEquals("maximumAnisotropy",o,1),this._wrapS=t,this._wrapT=r,this._minificationFilter=i,this._magnificationFilter=n,this._maximumAnisotropy=o}return e(t.prototype,{wrapS:{get:function(){return this._wrapS}},wrapT:{get:function(){return this._wrapT}},minificationFilter:{get:function(){return this._minificationFilter}},magnificationFilter:{get:function(){return this._magnificationFilter}},maximumAnisotropy:{get:function(){return this._maximumAnisotropy}}}),t}),define("Renderer/CubeMap",["../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Math","../Core/PixelFormat","./ContextLimits","./CubeMapFace","./MipmapHint","./PixelDatatype","./Sampler","./TextureMagnificationFilter","./TextureMinificationFilter"],function(_,v,y,e,t,b,i,C,w,S,n,T,E,a,s){"use strict";function r(e){e=v(e,v.EMPTY_OBJECT),_.defined("options.context",e.context);var t,r,i=e.context,n=e.source;if(y(n)){var o=[n.positiveX,n.negativeX,n.positiveY,n.negativeY,n.positiveZ,n.negativeZ];if(!(o[0]&&o[1]&&o[2]&&o[3]&&o[4]&&o[5]))throw new b("options.source requires positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ faces.");t=o[0].width,r=o[0].height;for(var a=1;a<6;++a)if(Number(o[a].width)!==t||Number(o[a].height)!==r)throw new b("Each face in options.source must have the same width and height.")}else t=e.width,r=e.height;var s=t,l=v(e.pixelFormat,C.RGBA),u=v(e.pixelDatatype,T.UNSIGNED_BYTE);if(!y(t)||!y(r))throw new b("options requires a source field to create an initialized cube map or width and height fields to create a blank cube map.");if(t!==r)throw new b("Width must equal height.");if(s<=0)throw new b("Width and height must be greater than zero.");if(s>w.maximumCubeMapSize)throw new b("Width and height must be less than or equal to the maximum cube map size ("+w.maximumCubeMapSize+").  Check maximumCubeMapSize.");if(!C.validate(l))throw new b("Invalid options.pixelFormat.");if(C.isDepthFormat(l))throw new b("options.pixelFormat cannot be DEPTH_COMPONENT or DEPTH_STENCIL.");if(!T.validate(u))throw new b("Invalid options.pixelDatatype.");if(u===T.FLOAT&&!i.floatingPointTexture)throw new b("When options.pixelDatatype is FLOAT, this WebGL implementation must support the OES_texture_float extension.");var c=6*C.textureSizeInBytes(l,u,s,s),d=e.preMultiplyAlpha||l===C.RGB||l===C.LUMINANCE,h=v(e.flipY,!0),p=i._gl,f=p.TEXTURE_CUBE_MAP,m=p.createTexture();function g(e,t){t.arrayBufferView?p.texImage2D(e,0,l,s,s,0,l,u,t.arrayBufferView):p.texImage2D(e,0,l,l,u,t)}p.activeTexture(p.TEXTURE0),p.bindTexture(f,m),y(n)?(p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,d),p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,h),g(p.TEXTURE_CUBE_MAP_POSITIVE_X,n.positiveX),g(p.TEXTURE_CUBE_MAP_NEGATIVE_X,n.negativeX),g(p.TEXTURE_CUBE_MAP_POSITIVE_Y,n.positiveY),g(p.TEXTURE_CUBE_MAP_NEGATIVE_Y,n.negativeY),g(p.TEXTURE_CUBE_MAP_POSITIVE_Z,n.positiveZ),g(p.TEXTURE_CUBE_MAP_NEGATIVE_Z,n.negativeZ)):(p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X,0,l,s,s,0,l,u,null),p.texImage2D(p.TEXTURE_CUBE_MAP_NEGATIVE_X,0,l,s,s,0,l,u,null),p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_Y,0,l,s,s,0,l,u,null),p.texImage2D(p.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,l,s,s,0,l,u,null),p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_Z,0,l,s,s,0,l,u,null),p.texImage2D(p.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,l,s,s,0,l,u,null)),p.bindTexture(f,null),this._gl=p,this._textureFilterAnisotropic=i._textureFilterAnisotropic,this._textureTarget=f,this._texture=m,this._pixelFormat=l,this._pixelDatatype=u,this._size=s,this._hasMipmap=!1,this._sizeInBytes=c,this._preMultiplyAlpha=d,this._flipY=h,this._sampler=void 0,this._positiveX=new S(p,m,f,p.TEXTURE_CUBE_MAP_POSITIVE_X,l,u,s,d,h),this._negativeX=new S(p,m,f,p.TEXTURE_CUBE_MAP_NEGATIVE_X,l,u,s,d,h),this._positiveY=new S(p,m,f,p.TEXTURE_CUBE_MAP_POSITIVE_Y,l,u,s,d,h),this._negativeY=new S(p,m,f,p.TEXTURE_CUBE_MAP_NEGATIVE_Y,l,u,s,d,h),this._positiveZ=new S(p,m,f,p.TEXTURE_CUBE_MAP_POSITIVE_Z,l,u,s,d,h),this._negativeZ=new S(p,m,f,p.TEXTURE_CUBE_MAP_NEGATIVE_Z,l,u,s,d,h),this.sampler=y(e.sampler)?e.sampler:new E}return e(r.prototype,{positiveX:{get:function(){return this._positiveX}},negativeX:{get:function(){return this._negativeX}},positiveY:{get:function(){return this._positiveY}},negativeY:{get:function(){return this._negativeY}},positiveZ:{get:function(){return this._positiveZ}},negativeZ:{get:function(){return this._negativeZ}},sampler:{get:function(){return this._sampler},set:function(e){var t=e.minificationFilter,r=e.magnificationFilter,i=t===s.NEAREST_MIPMAP_NEAREST||t===s.NEAREST_MIPMAP_LINEAR||t===s.LINEAR_MIPMAP_NEAREST||t===s.LINEAR_MIPMAP_LINEAR;this._pixelDatatype===T.FLOAT&&(t=i?s.NEAREST_MIPMAP_NEAREST:s.NEAREST,r=a.NEAREST);var n=this._gl,o=this._textureTarget;n.activeTexture(n.TEXTURE0),n.bindTexture(o,this._texture),n.texParameteri(o,n.TEXTURE_MIN_FILTER,t),n.texParameteri(o,n.TEXTURE_MAG_FILTER,r),n.texParameteri(o,n.TEXTURE_WRAP_S,e.wrapS),n.texParameteri(o,n.TEXTURE_WRAP_T,e.wrapT),y(this._textureFilterAnisotropic)&&n.texParameteri(o,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),n.bindTexture(o,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},width:{get:function(){return this._size}},height:{get:function(){return this._size}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},_target:{get:function(){return this._textureTarget}}}),r.prototype.generateMipmap=function(e){if(e=v(e,n.DONT_CARE),1<this._size&&!i.isPowerOfTwo(this._size))throw new b("width and height must be a power of two to call generateMipmap().");if(!n.validate(e))throw new b("hint is invalid.");this._hasMipmap=!0;var t=this._gl,r=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(r,this._texture),t.generateMipmap(r),t.bindTexture(r,null)},r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return this._gl.deleteTexture(this._texture),this._positiveX=t(this._positiveX),this._negativeX=t(this._negativeX),this._positiveY=t(this._positiveY),this._negativeY=t(this._negativeY),this._positiveZ=t(this._positiveZ),this._negativeZ=t(this._negativeZ),t(this)},r}),define("Renderer/Texture",["../Core/Cartesian2","../Core/Check","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Math","../Core/PixelFormat","../Core/WebGLConstants","./ContextLimits","./MipmapHint","./PixelDatatype","./Sampler","./TextureMagnificationFilter","./TextureMinificationFilter"],function(m,g,_,v,y,e,t,b,i,C,w,S,n,T,E,a,s){"use strict";function u(e){e=v(e,v.EMPTY_OBJECT),g.defined("options.context",e.context);var t=e.context,r=e.width,i=e.height,n=e.source;y(n)&&(y(r)||(r=v(n.videoWidth,n.width)),y(i)||(i=v(n.videoHeight,n.height)));var o=v(e.pixelFormat,C.RGBA),a=v(e.pixelDatatype,T.UNSIGNED_BYTE),s=o,l=C.isCompressedFormat(s);if(t.webgl2&&(o===C.DEPTH_STENCIL?s=w.DEPTH24_STENCIL8:o===C.DEPTH_COMPONENT&&(a===T.UNSIGNED_SHORT?s=w.DEPTH_COMPONENT16:a===T.UNSIGNED_INT&&(s=w.DEPTH_COMPONENT24)),a===T.FLOAT))switch(o){case C.RGBA:s=w.RGBA32F;break;case C.RGB:s=w.RGB32F;break;case C.RG:s=w.RG32F;break;case C.R:s=w.R32F}if(!y(r)||!y(i))throw new b("options requires a source field to create an initialized texture or width and height fields to create a blank texture.");if(g.typeOf.number.greaterThan("width",r,0),r>S.maximumTextureSize)throw new b("Width must be less than or equal to the maximum texture size ("+S.maximumTextureSize+").  Check maximumTextureSize.");if(g.typeOf.number.greaterThan("height",i,0),i>S.maximumTextureSize)throw new b("Height must be less than or equal to the maximum texture size ("+S.maximumTextureSize+").  Check maximumTextureSize.");if(!C.validate(o))throw new b("Invalid options.pixelFormat.");if(!l&&!T.validate(a))throw new b("Invalid options.pixelDatatype.");if(o===C.DEPTH_COMPONENT&&a!==T.UNSIGNED_SHORT&&a!==T.UNSIGNED_INT)throw new b("When options.pixelFormat is DEPTH_COMPONENT, options.pixelDatatype must be UNSIGNED_SHORT or UNSIGNED_INT.");if(o===C.DEPTH_STENCIL&&a!==T.UNSIGNED_INT_24_8)throw new b("When options.pixelFormat is DEPTH_STENCIL, options.pixelDatatype must be UNSIGNED_INT_24_8.");if(a===T.FLOAT&&!t.floatingPointTexture)throw new b("When options.pixelDatatype is FLOAT, this WebGL implementation must support the OES_texture_float extension.  Check context.floatingPointTexture.");if(C.isDepthFormat(o)){if(y(n))throw new b("When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, source cannot be provided.");if(!t.depthTexture)throw new b("When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, this WebGL implementation must support WEBGL_depth_texture.  Check context.depthTexture.")}if(l){if(!y(n)||!y(n.arrayBufferView))throw new b("When options.pixelFormat is compressed, options.source.arrayBufferView must be defined.");if(C.isDXTFormat(s)&&!t.s3tc)throw new b("When options.pixelFormat is S3TC compressed, this WebGL implementation must support the WEBGL_texture_compression_s3tc extension. Check context.s3tc.");if(C.isPVRTCFormat(s)&&!t.pvrtc)throw new b("When options.pixelFormat is PVRTC compressed, this WebGL implementation must support the WEBGL_texture_compression_pvrtc extension. Check context.pvrtc.");if(C.isETC1Format(s)&&!t.etc1)throw new b("When options.pixelFormat is ETC1 compressed, this WebGL implementation must support the WEBGL_texture_compression_etc1 extension. Check context.etc1.");if(C.compressedTextureSizeInBytes(s,r,i)!==n.arrayBufferView.byteLength)throw new b("The byte length of the array buffer is invalid for the compressed texture with the given width and height.")}var u,c=e.preMultiplyAlpha||o===C.RGB||o===C.LUMINANCE,d=v(e.flipY,!0),h=t._gl,p=h.TEXTURE_2D,f=h.createTexture();h.activeTexture(h.TEXTURE0),h.bindTexture(p,f),y(n)?(h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,d),y(n.arrayBufferView)?l?h.compressedTexImage2D(p,0,s,r,i,0,n.arrayBufferView):h.texImage2D(p,0,s,r,i,0,o,a,n.arrayBufferView):y(n.framebuffer)?(n.framebuffer!==t.defaultFramebuffer&&n.framebuffer._bind(),h.copyTexImage2D(p,0,s,n.xOffset,n.yOffset,r,i,0),n.framebuffer!==t.defaultFramebuffer&&n.framebuffer._unBind()):h.texImage2D(p,0,s,o,a,n)):h.texImage2D(p,0,s,r,i,0,o,a,null),h.bindTexture(p,null),u=l?C.compressedTextureSizeInBytes(o,r,i):C.textureSizeInBytes(o,a,r,i),this._id=_(),this._context=t,this._textureFilterAnisotropic=t._textureFilterAnisotropic,this._textureTarget=p,this._texture=f,this._pixelFormat=o,this._pixelDatatype=a,this._width=r,this._height=i,this._dimensions=new m(r,i),this._hasMipmap=!1,this._sizeInBytes=u,this._preMultiplyAlpha=c,this._flipY=d,this._sampler=void 0,this.sampler=y(e.sampler)?e.sampler:new E}return u.fromFramebuffer=function(e){e=v(e,v.EMPTY_OBJECT),g.defined("options.context",e.context);var t=e.context,r=t._gl,i=v(e.pixelFormat,C.RGB),n=v(e.framebufferXOffset,0),o=v(e.framebufferYOffset,0),a=v(e.width,r.drawingBufferWidth),s=v(e.height,r.drawingBufferHeight),l=e.framebuffer;if(!C.validate(i))throw new b("Invalid pixelFormat.");if(C.isDepthFormat(i)||C.isCompressedFormat(i))throw new b("pixelFormat cannot be DEPTH_COMPONENT, DEPTH_STENCIL or a compressed format.");if(g.defined("options.context",e.context),g.typeOf.number.greaterThanOrEquals("framebufferXOffset",n,0),g.typeOf.number.greaterThanOrEquals("framebufferYOffset",o,0),n+a>r.drawingBufferWidth)throw new b("framebufferXOffset + width must be less than or equal to drawingBufferWidth");if(o+s>r.drawingBufferHeight)throw new b("framebufferYOffset + height must be less than or equal to drawingBufferHeight.");return new u({context:t,width:a,height:s,pixelFormat:i,source:{framebuffer:y(l)?l:t.defaultFramebuffer,xOffset:n,yOffset:o,width:a,height:s}})},e(u.prototype,{id:{get:function(){return this._id}},sampler:{get:function(){return this._sampler},set:function(e){var t=e.minificationFilter,r=e.magnificationFilter,i=t===s.NEAREST_MIPMAP_NEAREST||t===s.NEAREST_MIPMAP_LINEAR||t===s.LINEAR_MIPMAP_NEAREST||t===s.LINEAR_MIPMAP_LINEAR;this._pixelDatatype===T.FLOAT&&(t=i?s.NEAREST_MIPMAP_NEAREST:s.NEAREST,r=a.NEAREST);var n=this._context._gl,o=this._textureTarget;n.activeTexture(n.TEXTURE0),n.bindTexture(o,this._texture),n.texParameteri(o,n.TEXTURE_MIN_FILTER,t),n.texParameteri(o,n.TEXTURE_MAG_FILTER,r),n.texParameteri(o,n.TEXTURE_WRAP_S,e.wrapS),n.texParameteri(o,n.TEXTURE_WRAP_T,e.wrapT),y(this._textureFilterAnisotropic)&&n.texParameteri(o,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),n.bindTexture(o,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},_target:{get:function(){return this._textureTarget}}}),u.prototype.copyFrom=function(e,t,r){if(t=v(t,0),r=v(r,0),g.defined("source",e),C.isDepthFormat(this._pixelFormat))throw new b("Cannot call copyFrom when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.");if(C.isCompressedFormat(this._pixelFormat))throw new b("Cannot call copyFrom with a compressed texture pixel format.");g.typeOf.number.greaterThanOrEquals("xOffset",t,0),g.typeOf.number.greaterThanOrEquals("yOffset",r,0),g.typeOf.number.lessThanOrEquals("xOffset + source.width",t+e.width,this._width),g.typeOf.number.lessThanOrEquals("yOffset + source.height",r+e.height,this._height);var i=this._context._gl,n=this._textureTarget;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._preMultiplyAlpha),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,this._flipY),i.activeTexture(i.TEXTURE0),i.bindTexture(n,this._texture),e.arrayBufferView?i.texSubImage2D(n,0,t,r,e.width,e.height,this._pixelFormat,this._pixelDatatype,e.arrayBufferView):i.texSubImage2D(n,0,t,r,this._pixelFormat,this._pixelDatatype,e),i.bindTexture(n,null)},u.prototype.copyFromFramebuffer=function(e,t,r,i,n,o){if(e=v(e,0),t=v(t,0),r=v(r,0),i=v(i,0),n=v(n,this._width),o=v(o,this._height),C.isDepthFormat(this._pixelFormat))throw new b("Cannot call copyFromFramebuffer when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.");if(this._pixelDatatype===T.FLOAT)throw new b("Cannot call copyFromFramebuffer when the texture pixel data type is FLOAT.");if(C.isCompressedFormat(this._pixelFormat))throw new b("Cannot call copyFrom with a compressed texture pixel format.");g.typeOf.number.greaterThanOrEquals("xOffset",e,0),g.typeOf.number.greaterThanOrEquals("yOffset",t,0),g.typeOf.number.greaterThanOrEquals("framebufferXOffset",r,0),g.typeOf.number.greaterThanOrEquals("framebufferYOffset",i,0),g.typeOf.number.lessThanOrEquals("xOffset + width",e+n,this._width),g.typeOf.number.lessThanOrEquals("yOffset + height",t+o,this._height);var a=this._context._gl,s=this._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(s,this._texture),a.copyTexSubImage2D(s,0,e,t,r,i,n,o),a.bindTexture(s,null)},u.prototype.generateMipmap=function(e){if(e=v(e,n.DONT_CARE),C.isDepthFormat(this._pixelFormat))throw new b("Cannot call generateMipmap when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.");if(C.isCompressedFormat(this._pixelFormat))throw new b("Cannot call generateMipmap with a compressed pixel format.");if(1<this._width&&!i.isPowerOfTwo(this._width))throw new b("width must be a power of two to call generateMipmap().");if(1<this._height&&!i.isPowerOfTwo(this._height))throw new b("height must be a power of two to call generateMipmap().");if(!n.validate(e))throw new b("hint is invalid.");this._hasMipmap=!0;var t=this._context._gl,r=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(r,this._texture),t.generateMipmap(r),t.bindTexture(r,null)},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),t(this)},u}),define("Shaders/Materials/BumpMapMaterial",[],function(){"use strict";return"uniform sampler2D image;\nuniform float strength;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nvec2 centerPixel = fract(repeat * st);\nfloat centerBump = texture2D(image, centerPixel).channel;\nfloat imageWidth = float(imageDimensions.x);\nvec2 rightPixel = fract(repeat * (st + vec2(1.0 / imageWidth, 0.0)));\nfloat rightBump = texture2D(image, rightPixel).channel;\nfloat imageHeight = float(imageDimensions.y);\nvec2 leftPixel = fract(repeat * (st + vec2(0.0, 1.0 / imageHeight)));\nfloat topBump = texture2D(image, leftPixel).channel;\nvec3 normalTangentSpace = normalize(vec3(centerBump - rightBump, centerBump - topBump, clamp(1.0 - strength, 0.1, 1.0)));\nvec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;\nmaterial.normal = normalEC;\nmaterial.diffuse = vec3(0.01);\nreturn material;\n}\n"}),define("Shaders/Materials/CheckerboardMaterial",[],function(){"use strict";return"uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat b = mod(floor(repeat.s * st.s) + floor(repeat.t * st.t), 2.0);\nfloat scaledWidth = fract(repeat.s * st.s);\nscaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));\nfloat scaledHeight = fract(repeat.t * st.t);\nscaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));\nfloat value = min(scaledWidth, scaledHeight);\nvec4 currentColor = mix(lightColor, darkColor, b);\nvec4 color = czm_antialias(lightColor, darkColor, currentColor, value, 0.03);\nmaterial.diffuse = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n"}),define("Shaders/Materials/DotMaterial",[],function(){"use strict";return"uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat b = smoothstep(0.3, 0.32, length(fract(repeat * materialInput.st) - 0.5));\nvec4 color = mix(lightColor, darkColor, b);\nmaterial.diffuse = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n"}),define("Shaders/Materials/ElevationContourMaterial",[],function(){"use strict";return"#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nuniform vec4 color;\nuniform float spacing;\nuniform float width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat distanceToContour = mod(materialInput.height, spacing);\n#ifdef GL_OES_standard_derivatives\nfloat dxc = abs(dFdx(materialInput.height));\nfloat dyc = abs(dFdy(materialInput.height));\nfloat dF = max(dxc, dyc) * width;\nmaterial.alpha = (distanceToContour < dF) ? 1.0 : 0.0;\n#else\nmaterial.alpha = (distanceToContour < (czm_resolutionScale * width)) ? 1.0 : 0.0;\n#endif\nmaterial.diffuse = color.rgb;\nreturn material;\n}\n"}),define("Shaders/Materials/ElevationRampMaterial",[],function(){"use strict";return"uniform sampler2D image;\nuniform float minimumHeight;\nuniform float maximumHeight;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat scaledHeight = clamp((materialInput.height - minimumHeight) / (maximumHeight - minimumHeight), 0.0, 1.0);\nvec4 rampColor = texture2D(image, vec2(scaledHeight, 0.5));\nmaterial.diffuse = rampColor.rgb;\nmaterial.alpha = rampColor.a;\nreturn material;\n}\n"}),define("Shaders/Materials/FadeMaterial",[],function(){"use strict";return"uniform vec4 fadeInColor;\nuniform vec4 fadeOutColor;\nuniform float maximumDistance;\nuniform bool repeat;\nuniform vec2 fadeDirection;\nuniform vec2 time;\nfloat getTime(float t, float coord)\n{\nfloat scalar = 1.0 / maximumDistance;\nfloat q  = distance(t, coord) * scalar;\nif (repeat)\n{\nfloat r = distance(t, coord + 1.0) * scalar;\nfloat s = distance(t, coord - 1.0) * scalar;\nq = min(min(r, s), q);\n}\nreturn clamp(q, 0.0, 1.0);\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat s = getTime(time.x, st.s) * fadeDirection.s;\nfloat t = getTime(time.y, st.t) * fadeDirection.t;\nfloat u = length(vec2(s, t));\nvec4 color = mix(fadeInColor, fadeOutColor, u);\nmaterial.emission = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n"}),define("Shaders/Materials/GridMaterial",[],function(){"use strict";return"#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nuniform vec4 color;\nuniform float cellAlpha;\nuniform vec2 lineCount;\nuniform vec2 lineThickness;\nuniform vec2 lineOffset;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat scaledWidth = fract(lineCount.s * st.s - lineOffset.s);\nscaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));\nfloat scaledHeight = fract(lineCount.t * st.t - lineOffset.t);\nscaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));\nfloat value;\n#ifdef GL_OES_standard_derivatives\nconst float fuzz = 1.2;\nvec2 thickness = (lineThickness * czm_resolutionScale) - 1.0;\nvec2 dx = abs(dFdx(st));\nvec2 dy = abs(dFdy(st));\nvec2 dF = vec2(max(dx.s, dy.s), max(dx.t, dy.t)) * lineCount;\nvalue = min(\nsmoothstep(dF.s * thickness.s, dF.s * (fuzz + thickness.s), scaledWidth),\nsmoothstep(dF.t * thickness.t, dF.t * (fuzz + thickness.t), scaledHeight));\n#else\nconst float fuzz = 0.05;\nvec2 range = 0.5 - (lineThickness * 0.05);\nvalue = min(\n1.0 - smoothstep(range.s, range.s + fuzz, scaledWidth),\n1.0 - smoothstep(range.t, range.t + fuzz, scaledHeight));\n#endif\nfloat dRim = 1.0 - abs(dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC)));\nfloat sRim = smoothstep(0.8, 1.0, dRim);\nvalue *= (1.0 - sRim);\nvec3 halfColor = color.rgb * 0.5;\nmaterial.diffuse = halfColor;\nmaterial.emission = halfColor;\nmaterial.alpha = color.a * (1.0 - ((1.0 - cellAlpha) * value));\nreturn material;\n}\n"}),define("Shaders/Materials/NormalMapMaterial",[],function(){"use strict";return"uniform sampler2D image;\nuniform float strength;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec4 textureValue = texture2D(image, fract(repeat * materialInput.st));\nvec3 normalTangentSpace = textureValue.channels;\nnormalTangentSpace.xy = normalTangentSpace.xy * 2.0 - 1.0;\nnormalTangentSpace.z = clamp(1.0 - strength, 0.1, 1.0);\nnormalTangentSpace = normalize(normalTangentSpace);\nvec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;\nmaterial.normal = normalEC;\nreturn material;\n}\n"}),define("Shaders/Materials/PolylineArrowMaterial",[],function(){"use strict";return"#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nuniform vec4 color;\nvarying float v_width;\nfloat getPointOnLine(vec2 p0, vec2 p1, float x)\n{\nfloat slope = (p0.y - p1.y) / (p0.x - p1.x);\nreturn slope * (x - p0.x) + p0.y;\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\n#ifdef GL_OES_standard_derivatives\nfloat base = 1.0 - abs(fwidth(st.s)) * 10.0;\n#else\nfloat base = 0.99;\n#endif\nvec2 center = vec2(1.0, 0.5);\nfloat ptOnUpperLine = getPointOnLine(vec2(base, 1.0), center, st.s);\nfloat ptOnLowerLine = getPointOnLine(vec2(base, 0.0), center, st.s);\nfloat halfWidth = 0.15;\nfloat s = step(0.5 - halfWidth, st.t);\ns *= 1.0 - step(0.5 + halfWidth, st.t);\ns *= 1.0 - step(base, st.s);\nfloat t = step(base, materialInput.st.s);\nt *= 1.0 - step(ptOnUpperLine, st.t);\nt *= step(ptOnLowerLine, st.t);\nfloat dist;\nif (st.s < base)\n{\nfloat d1 = abs(st.t - (0.5 - halfWidth));\nfloat d2 = abs(st.t - (0.5 + halfWidth));\ndist = min(d1, d2);\n}\nelse\n{\nfloat d1 = czm_infinity;\nif (st.t < 0.5 - halfWidth && st.t > 0.5 + halfWidth)\n{\nd1 = abs(st.s - base);\n}\nfloat d2 = abs(st.t - ptOnUpperLine);\nfloat d3 = abs(st.t - ptOnLowerLine);\ndist = min(min(d1, d2), d3);\n}\nvec4 outsideColor = vec4(0.0);\nvec4 currentColor = mix(outsideColor, color, clamp(s + t, 0.0, 1.0));\nvec4 outColor = czm_antialias(outsideColor, color, currentColor, dist);\nmaterial.diffuse = outColor.rgb;\nmaterial.alpha = outColor.a;\nreturn material;\n}\n"}),define("Shaders/Materials/PolylineDashMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform vec4 gapColor;\nuniform float dashLength;\nuniform float dashPattern;\nvarying float v_polylineAngle;\nconst float maskLength = 16.0;\nmat2 rotate(float rad) {\nfloat c = cos(rad);\nfloat s = sin(rad);\nreturn mat2(\nc, s,\n-s, c\n);\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 pos = rotate(v_polylineAngle) * gl_FragCoord.xy;\nfloat dashPosition = fract(pos.x / dashLength);\nfloat maskIndex = floor(dashPosition * maskLength);\nfloat maskTest = floor(dashPattern / pow(2.0, maskIndex));\nvec4 fragColor = (mod(maskTest, 2.0) < 1.0) ? gapColor : color;\nif (fragColor.a < 0.005) {\ndiscard;\n}\nmaterial.emission = fragColor.rgb;\nmaterial.alpha = fragColor.a;\nreturn material;\n}\n"}),define("Shaders/Materials/PolylineGlowMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform float glowPower;\nvarying float v_width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat glow = glowPower / abs(st.t - 0.5) - (glowPower / 0.5);\nmaterial.emission = max(vec3(glow - 1.0 + color.rgb), color.rgb);\nmaterial.alpha = clamp(0.0, 1.0, glow) * color.a;\nreturn material;\n}\n"}),define("Shaders/Materials/PolylineOutlineMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform vec4 outlineColor;\nuniform float outlineWidth;\nvarying float v_width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat halfInteriorWidth =  0.5 * (v_width - outlineWidth) / v_width;\nfloat b = step(0.5 - halfInteriorWidth, st.t);\nb *= 1.0 - step(0.5 + halfInteriorWidth, st.t);\nfloat d1 = abs(st.t - (0.5 - halfInteriorWidth));\nfloat d2 = abs(st.t - (0.5 + halfInteriorWidth));\nfloat dist = min(d1, d2);\nvec4 currentColor = mix(outlineColor, color, b);\nvec4 outColor = czm_antialias(outlineColor, color, currentColor, dist);\nmaterial.diffuse = outColor.rgb;\nmaterial.alpha = outColor.a;\nreturn material;\n}\n"}),define("Shaders/Materials/RimLightingMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform vec4 rimColor;\nuniform float width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat d = 1.0 - dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC));\nfloat s = smoothstep(1.0 - width, 1.0, d);\nmaterial.diffuse = color.rgb;\nmaterial.emission = rimColor.rgb * s;\nmaterial.alpha = mix(color.a, rimColor.a, s);\nreturn material;\n}\n"}),define("Shaders/Materials/SlopeRampMaterial",[],function(){"use strict";return"uniform sampler2D image;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec4 rampColor = texture2D(image, vec2(materialInput.slope, 0.5));\nmaterial.diffuse = rampColor.rgb;\nmaterial.alpha = rampColor.a;\nreturn material;\n}\n"}),define("Shaders/Materials/StripeMaterial",[],function(){"use strict";return"uniform vec4 evenColor;\nuniform vec4 oddColor;\nuniform float offset;\nuniform float repeat;\nuniform bool horizontal;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat coord = mix(materialInput.st.s, materialInput.st.t, float(horizontal));\nfloat value = fract((coord - offset) * (repeat * 0.5));\nfloat dist = min(value, min(abs(value - 0.5), 1.0 - value));\nvec4 currentColor = mix(evenColor, oddColor, step(0.5, value));\nvec4 color = czm_antialias(evenColor, oddColor, currentColor, dist);\nmaterial.diffuse = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n"}),define("Shaders/Materials/Water",[],function(){"use strict";return"uniform sampler2D specularMap;\nuniform sampler2D normalMap;\nuniform vec4 baseWaterColor;\nuniform vec4 blendColor;\nuniform float frequency;\nuniform float animationSpeed;\nuniform float amplitude;\nuniform float specularIntensity;\nuniform float fadeFactor;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat time = czm_frameNumber * animationSpeed;\nfloat fade = max(1.0, (length(materialInput.positionToEyeEC) / 10000000000.0) * frequency * fadeFactor);\nfloat specularMapValue = texture2D(specularMap, materialInput.st).r;\nvec4 noise = czm_getWaterNoise(normalMap, materialInput.st * frequency, time, 0.0);\nvec3 normalTangentSpace = noise.xyz * vec3(1.0, 1.0, (1.0 / amplitude));\nnormalTangentSpace.xy /= fade;\nnormalTangentSpace = mix(vec3(0.0, 0.0, 50.0), normalTangentSpace, specularMapValue);\nnormalTangentSpace = normalize(normalTangentSpace);\nfloat tsPerturbationRatio = clamp(dot(normalTangentSpace, vec3(0.0, 0.0, 1.0)), 0.0, 1.0);\nmaterial.alpha = specularMapValue;\nmaterial.diffuse = mix(blendColor.rgb, baseWaterColor.rgb, specularMapValue);\nmaterial.diffuse += (0.1 * tsPerturbationRatio);\nmaterial.normal = normalize(materialInput.tangentToEyeMatrix * normalTangentSpace);\nmaterial.specular = specularIntensity;\nmaterial.shininess = 10.0;\nreturn material;\n}\n"}),define("Scene/Material",["../Core/Cartesian2","../Core/clone","../Core/Color","../Core/combine","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/isArray","../Core/loadCRN","../Core/loadKTX","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Core/Resource","../Renderer/CubeMap","../Renderer/Texture","../Shaders/Materials/BumpMapMaterial","../Shaders/Materials/CheckerboardMaterial","../Shaders/Materials/DotMaterial","../Shaders/Materials/ElevationContourMaterial","../Shaders/Materials/ElevationRampMaterial","../Shaders/Materials/FadeMaterial","../Shaders/Materials/GridMaterial","../Shaders/Materials/NormalMapMaterial","../Shaders/Materials/PolylineArrowMaterial","../Shaders/Materials/PolylineDashMaterial","../Shaders/Materials/PolylineGlowMaterial","../Shaders/Materials/PolylineOutlineMaterial","../Shaders/Materials/RimLightingMaterial","../Shaders/Materials/SlopeRampMaterial","../Shaders/Materials/StripeMaterial","../Shaders/Materials/Water","../ThirdParty/when"],function(e,a,t,u,s,l,_,r,o,m,g,v,y,i,n,c,b,C,w,d,h,p,f,S,T,E,A,x,P,D,O,I,M,R,L,N){"use strict";function k(e){this.type=void 0,this.shaderSource=void 0,this.materials=void 0,this.uniforms=void 0,this._uniforms=void 0,this.translucent=void 0,this._strict=void 0,this._template=void 0,this._count=void 0,this._texturePaths={},this._loadedImages=[],this._loadedCubeMaps=[],this._textures={},this._updateFunctions=[],this._defaultTexture=void 0,function(e,t){var r;e=l(e,l.EMPTY_OBJECT),t._strict=l(e.strict,!1),t._count=l(e.count,0),t._template=a(l(e.fabric,l.EMPTY_OBJECT)),t._template.uniforms=a(l(t._template.uniforms,l.EMPTY_OBJECT)),t._template.materials=a(l(t._template.materials,l.EMPTY_OBJECT)),t.type=_(t._template.type)?t._template.type:s(),t.shaderSource="",t.materials={},t.uniforms={},t._uniforms={},t._translucentFunctions=[];var i=k._materialCache.getMaterial(t.type);if(_(i)){var n=a(i.fabric,!0);t._template=u(t._template,n,!0),r=i.translucent}(function(e){var t=e._template,r=t.uniforms,i=t.materials,n=t.components;if(_(n)&&_(t.source))throw new m("fabric: cannot have source and components in the same template.");F(t,V,B,!0),F(n,z,B,!0);var o=[];for(var a in i)i.hasOwnProperty(a)&&o.push(a);F(r,o,U,!1)})(t),_(i)||k._materialCache.addMaterial(t.type,t);(function(e){var t=e._template.components,r=e._template.source;if(_(r))e.shaderSource+=r+"\n";else{if(e.shaderSource+="czm_material czm_getMaterial(czm_materialInput materialInput)\n{\n",e.shaderSource+="czm_material material = czm_getDefaultMaterial(materialInput);\n",_(t))for(var i in t)t.hasOwnProperty(i)&&(e.shaderSource+="material."+i+" = "+t[i]+";\n");e.shaderSource+="return material;\n}\n"}})(t),function(e){var t=e._template.uniforms;for(var r in t)t.hasOwnProperty(r)&&H(e,r)}(t),function(e){var t=e._strict,r=e._template.materials;for(var i in r)if(r.hasOwnProperty(i)){var n=new k({strict:t,fabric:r[i],count:e._count});e._count=n._count,e._uniforms=u(e._uniforms,n._uniforms,!0),e.materials[i]=n,e._translucentFunctions=e._translucentFunctions.concat(n._translucentFunctions);var o="czm_getMaterial",a=o+"_"+e._count++;j(n,o,a),e.shaderSource=n.shaderSource+e.shaderSource;var s=a+"(materialInput)",l=j(e,i,s);if(0===l&&t)throw new m("strict: shader source does not use material '"+i+"'.")}}(t);var o=0===t._translucentFunctions.length||void 0;if(r=l(r,o),r=l(e.translucent,r),_(r))if("function"==typeof r){t._translucentFunctions.push(function(){return r(t)})}else t._translucentFunctions.push(r)}(e,this),r(this,{type:{value:this.type,writable:!1}}),_(k._uniformList[this.type])||(k._uniformList[this.type]=Object.keys(this._uniforms))}function F(e,t,r,i){if(_(e))for(var n in e)if(e.hasOwnProperty(n)){var o=-1!==t.indexOf(n);(i&&!o||!i&&o)&&r(n,t)}}function B(e,t){for(var r="fabric: property name '"+e+"' is not valid. It should be ",i=0;i<t.length;i++){var n="'"+t[i]+"'";r+=i===t.length-1?"or "+n+".":n+", "}throw new m(r)}function U(e,t){throw new m("fabric: uniforms and materials cannot share the same property '"+e+"'")}k._uniformList={},k.fromType=function(e,t){if(!_(k._materialCache.getMaterial(e)))throw new m("material with type '"+e+"' does not exist.");var r=new k({fabric:{type:e}});if(_(t))for(var i in t)t.hasOwnProperty(i)&&(r.uniforms[i]=t[i]);return r},k.prototype.isTranslucent=function(){if(_(this.translucent))return"function"==typeof this.translucent?this.translucent():this.translucent;for(var e=!0,t=this._translucentFunctions,r=t.length,i=0;i<r;++i){var n=t[i];if(!(e="function"==typeof n?e&&n():e&&n))break}return e},k.prototype.update=function(e){var t,r,i=this._loadedImages,n=i.length;for(t=0;t<n;++t){var o=i[t];r=o.id;var a,s=o.image;a=_(s.internalFormat)?new w({context:e,pixelFormat:s.internalFormat,width:s.width,height:s.height,source:{arrayBufferView:s.bufferView}}):new w({context:e,source:s}),this._textures[r]=a;var l=r+"Dimensions";if(this.uniforms.hasOwnProperty(l)){var u=this.uniforms[l];u.x=a._width,u.y=a._height}}i.length=0;var c=this._loadedCubeMaps;for(n=c.length,t=0;t<n;++t){var d=c[t];r=d.id;var h=d.images,p=new C({context:e,source:{positiveX:h[0],negativeX:h[1],positiveY:h[2],negativeY:h[3],positiveZ:h[4],negativeZ:h[5]}});this._textures[r]=p}c.length=0;var f=this._updateFunctions;for(n=f.length,t=0;t<n;++t)f[t](this,e);var m=this.materials;for(var g in m)m.hasOwnProperty(g)&&m[g].update(e)},k.prototype.isDestroyed=function(){return!1},k.prototype.destroy=function(){var e=this._textures;for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];r!==this._defaultTexture&&r.destroy()}var i=this.materials;for(var n in i)i.hasOwnProperty(n)&&i[n].destroy();return o(this)};var V=["type","materials","uniforms","components","source"],z=["diffuse","specular","shininess","normal","emission","alpha"];var q={mat2:i,mat3:n,mat4:c},G=/\.ktx$/i,W=/\.crn$/i;function H(e,t){var a,d,h,r,i,n=e._strict,o=e._template.uniforms,s=o[t],l=function(e){var t=e.type;if(!_(t)){var r=typeof e;if("number"===r)t="float";else if("boolean"===r)t="bool";else if("string"===r||e instanceof HTMLCanvasElement)t=/^([rgba]){1,4}$/i.test(e)?"channels":e===k.DefaultCubeMapId?"samplerCube":"sampler2D";else if("object"===r)if(g(e))4!==e.length&&9!==e.length&&16!==e.length||(t="mat"+Math.sqrt(e.length));else{var i=0;for(var n in e)e.hasOwnProperty(n)&&(i+=1);2<=i&&i<=4?t="vec"+i:6===i&&(t="samplerCube")}}return t}(s);if(!_(l))throw new m("fabric: uniform '"+t+"' has invalid type.");if("channels"===l){if(0===j(e,t,s,!1)&&n)throw new m("strict: shader source does not use channels '"+t+"'.")}else{if("sampler2D"===l){var u=t+"Dimensions";0<j(e,r=u,r,i)&&(o[u]={type:"ivec3",x:1,y:1},H(e,u))}if(!new RegExp("uniform\\s+"+l+"\\s+"+t+"\\s*;").test(e.shaderSource)){var c="uniform "+l+" "+t+";";e.shaderSource=c+e.shaderSource}var p=t+"_"+e._count++;if(1===j(e,t,p)&&n)throw new m("strict: shader source does not use uniform '"+t+"'.");if(e.uniforms[t]=s,"sampler2D"===l)e._uniforms[p]=function(){return e._textures[t]},e._updateFunctions.push((d=t,function(t,e){var r=t.uniforms,i=r[d],n=h!==i;h=i;var o,a,s=t._textures[d];if(i instanceof HTMLVideoElement)if(2<=i.readyState){if(n&&_(s)&&(s!==e.defaultTexture&&s.destroy(),s=void 0),!_(s)||s===e.defaultTexture)return s=new w({context:e,source:i}),void(t._textures[d]=s);s.copyFrom(i)}else _(s)||(t._textures[d]=e.defaultTexture);else{if(i instanceof w&&i!==s){t._texturePaths[d]=void 0;var l=t._textures[d];return l!==t._defaultTexture&&l.destroy(),t._textures[d]=i,o=d+"Dimensions",void(r.hasOwnProperty(o)&&((a=r[o]).x=i._width,a.y=i._height))}if(_(s)||(t._texturePaths[d]=void 0,_(t._defaultTexture)||(t._defaultTexture=e.defaultTexture),s=t._textures[d]=t._defaultTexture,o=d+"Dimensions",r.hasOwnProperty(o)&&((a=r[o]).x=s._width,a.y=s._height)),i!==k.DefaultImageId&&i!==t._texturePaths[d]){if("string"==typeof i){var u,c=new b({url:i});u=G.test(i)?y(c):W.test(i)?v(c):c.fetchImage(),N(u,function(e){t._loadedImages.push({id:d,image:e})})}else i instanceof HTMLCanvasElement&&t._loadedImages.push({id:d,image:i});t._texturePaths[d]=i}}}));else if("samplerCube"===l)e._uniforms[p]=function(){return e._textures[t]},e._updateFunctions.push((a=t,function(t,e){var r=t.uniforms[a];if(r instanceof C){var i=t._textures[a];return i!==t._defaultTexture&&i.destroy(),t._texturePaths[a]=void 0,void(t._textures[a]=r)}if(_(t._textures[a])||(t._texturePaths[a]=void 0,t._textures[a]=e.defaultCubeMap),r!==k.DefaultCubeMapId){var n=r.positiveX+r.negativeX+r.positiveY+r.negativeY+r.positiveZ+r.negativeZ;if(n!==t._texturePaths[a]){var o=[b.createIfNeeded(r.positiveX).fetchImage(),b.createIfNeeded(r.negativeX).fetchImage(),b.createIfNeeded(r.positiveY).fetchImage(),b.createIfNeeded(r.negativeY).fetchImage(),b.createIfNeeded(r.positiveZ).fetchImage(),b.createIfNeeded(r.negativeZ).fetchImage()];N.all(o).then(function(e){t._loadedCubeMaps.push({id:a,images:e})}),t._texturePaths[a]=n}}}));else if(-1!==l.indexOf("mat")){var f=new q[l];e._uniforms[p]=function(){return q[l].fromColumnMajorArray(e.uniforms[t],f)}}else e._uniforms[p]=function(){return e.uniforms[t]}}}function j(e,t,i,r){r=l(r,!0);var n=0,o=new RegExp("([\\w"+(r?".":"")+"])?"+t+"([\\w])?","g");return e.shaderSource=e.shaderSource.replace(o,function(e,t,r){return t||r?e:(n+=1,i)}),n}return k._materialCache={_materials:{},addMaterial:function(e,t){this._materials[e]=t},getMaterial:function(e){return this._materials[e]}},k.DefaultImageId="czm_defaultImage",k.DefaultCubeMapId="czm_defaultCubeMap",k.ColorType="Color",k._materialCache.addMaterial(k.ColorType,{fabric:{type:k.ColorType,uniforms:{color:new t(1,0,0,.5)},components:{diffuse:"color.rgb",alpha:"color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}}),k.ImageType="Image",k._materialCache.addMaterial(k.ImageType,{fabric:{type:k.ImageType,uniforms:{image:k.DefaultImageId,repeat:new e(1,1),color:new t(1,1,1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).rgb * color.rgb",alpha:"texture2D(image, fract(repeat * materialInput.st)).a * color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}}),k.DiffuseMapType="DiffuseMap",k._materialCache.addMaterial(k.DiffuseMapType,{fabric:{type:k.DiffuseMapType,uniforms:{image:k.DefaultImageId,channels:"rgb",repeat:new e(1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:!1}),k.AlphaMapType="AlphaMap",k._materialCache.addMaterial(k.AlphaMapType,{fabric:{type:k.AlphaMapType,uniforms:{image:k.DefaultImageId,channel:"a",repeat:new e(1,1)},components:{alpha:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:!0}),k.SpecularMapType="SpecularMap",k._materialCache.addMaterial(k.SpecularMapType,{fabric:{type:k.SpecularMapType,uniforms:{image:k.DefaultImageId,channel:"r",repeat:new e(1,1)},components:{specular:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:!1}),k.EmissionMapType="EmissionMap",k._materialCache.addMaterial(k.EmissionMapType,{fabric:{type:k.EmissionMapType,uniforms:{image:k.DefaultImageId,channels:"rgb",repeat:new e(1,1)},components:{emission:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:!1}),k.BumpMapType="BumpMap",k._materialCache.addMaterial(k.BumpMapType,{fabric:{type:k.BumpMapType,uniforms:{image:k.DefaultImageId,channel:"r",strength:.8,repeat:new e(1,1)},source:d},translucent:!1}),k.NormalMapType="NormalMap",k._materialCache.addMaterial(k.NormalMapType,{fabric:{type:k.NormalMapType,uniforms:{image:k.DefaultImageId,channels:"rgb",strength:.8,repeat:new e(1,1)},source:A},translucent:!1}),k.GridType="Grid",k._materialCache.addMaterial(k.GridType,{fabric:{type:k.GridType,uniforms:{color:new t(0,1,0,1),cellAlpha:.1,lineCount:new e(8,8),lineThickness:new e(1,1),lineOffset:new e(0,0)},source:E},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.cellAlpha<1}}),k.StripeType="Stripe",k._materialCache.addMaterial(k.StripeType,{fabric:{type:k.StripeType,uniforms:{horizontal:!0,evenColor:new t(1,1,1,.5),oddColor:new t(0,0,1,.5),offset:0,repeat:5},source:R},translucent:function(e){var t=e.uniforms;return t.evenColor.alpha<1||t.oddColor.alpha<1}}),k.CheckerboardType="Checkerboard",k._materialCache.addMaterial(k.CheckerboardType,{fabric:{type:k.CheckerboardType,uniforms:{lightColor:new t(1,1,1,.5),darkColor:new t(0,0,0,.5),repeat:new e(5,5)},source:h},translucent:function(e){var t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}}),k.DotType="Dot",k._materialCache.addMaterial(k.DotType,{fabric:{type:k.DotType,uniforms:{lightColor:new t(1,1,0,.75),darkColor:new t(0,1,1,.75),repeat:new e(5,5)},source:p},translucent:function(e){var t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}}),k.WaterType="Water",k._materialCache.addMaterial(k.WaterType,{fabric:{type:k.WaterType,uniforms:{baseWaterColor:new t(.2,.3,.6,1),blendColor:new t(0,1,.699,1),specularMap:k.DefaultImageId,normalMap:k.DefaultImageId,frequency:10,animationSpeed:.01,amplitude:1,specularIntensity:.5,fadeFactor:1},source:L},translucent:function(e){var t=e.uniforms;return t.baseWaterColor.alpha<1||t.blendColor.alpha<1}}),k.RimLightingType="RimLighting",k._materialCache.addMaterial(k.RimLightingType,{fabric:{type:k.RimLightingType,uniforms:{color:new t(1,0,0,.7),rimColor:new t(1,1,1,.4),width:.3},source:I},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.rimColor.alpha<1}}),k.FadeType="Fade",k._materialCache.addMaterial(k.FadeType,{fabric:{type:k.FadeType,uniforms:{fadeInColor:new t(1,0,0,1),fadeOutColor:new t(0,0,0,0),maximumDistance:.5,repeat:!0,fadeDirection:{x:!0,y:!0},time:new e(.5,.5)},source:T},translucent:function(e){var t=e.uniforms;return t.fadeInColor.alpha<1||t.fadeOutColor.alpha<1}}),k.PolylineArrowType="PolylineArrow",k._materialCache.addMaterial(k.PolylineArrowType,{fabric:{type:k.PolylineArrowType,uniforms:{color:new t(1,1,1,1)},source:x},translucent:!0}),k.PolylineDashType="PolylineDash",k._materialCache.addMaterial(k.PolylineDashType,{fabric:{type:k.PolylineDashType,uniforms:{color:new t(1,0,1,1),gapColor:new t(0,0,0,0),dashLength:16,dashPattern:255},source:P},translucent:!0}),k.PolylineGlowType="PolylineGlow",k._materialCache.addMaterial(k.PolylineGlowType,{fabric:{type:k.PolylineGlowType,uniforms:{color:new t(0,.5,1,1),glowPower:.25},source:D},translucent:!0}),k.PolylineOutlineType="PolylineOutline",k._materialCache.addMaterial(k.PolylineOutlineType,{fabric:{type:k.PolylineOutlineType,uniforms:{color:new t(1,1,1,1),outlineColor:new t(1,0,0,1),outlineWidth:1},source:O},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.outlineColor.alpha<1}}),k.ElevationContourType="ElevationContour",k._materialCache.addMaterial(k.ElevationContourType,{fabric:{type:k.ElevationContourType,uniforms:{spacing:100,color:new t(1,0,0,1),width:1},source:f},translucent:!1}),k.ElevationRampType="ElevationRamp",k._materialCache.addMaterial(k.ElevationRampType,{fabric:{type:k.ElevationRampType,uniforms:{image:k.DefaultImageId,minimumHeight:0,maximumHeight:1e4},source:S},translucent:!1}),k.SlopeRampMaterialType="SlopeRamp",k._materialCache.addMaterial(k.SlopeRampMaterialType,{fabric:{type:k.SlopeRampMaterialType,uniforms:{image:k.DefaultImageId},source:M},translucent:!1}),k}),define("Scene/MaterialAppearance",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/freezeObject","../Core/VertexFormat","../Shaders/Appearances/AllMaterialAppearanceFS","../Shaders/Appearances/AllMaterialAppearanceVS","../Shaders/Appearances/BasicMaterialAppearanceFS","../Shaders/Appearances/BasicMaterialAppearanceVS","../Shaders/Appearances/TexturedMaterialAppearanceFS","../Shaders/Appearances/TexturedMaterialAppearanceVS","./Appearance","./Material"],function(n,o,e,t,r,i,a,s,l,u,c,d,h){"use strict";function p(e){e=n(e,n.EMPTY_OBJECT);var t=n(e.translucent,!0),r=n(e.closed,!1),i=n(e.materialSupport,p.MaterialSupport.TEXTURED);this.material=o(e.material)?e.material:h.fromType(h.ColorType),this.translucent=t,this._vertexShaderSource=n(e.vertexShaderSource,i.vertexShaderSource),this._fragmentShaderSource=n(e.fragmentShaderSource,i.fragmentShaderSource),this._renderState=d.getDefaultRenderState(t,r,e.renderState),this._closed=r,this._materialSupport=i,this._vertexFormat=i.vertexFormat,this._flat=n(e.flat,!1),this._faceForward=n(e.faceForward,!r)}return e(p.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},materialSupport:{get:function(){return this._materialSupport}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}}),p.prototype.getFragmentShaderSource=d.prototype.getFragmentShaderSource,p.prototype.isTranslucent=d.prototype.isTranslucent,p.prototype.getRenderState=d.prototype.getRenderState,p.MaterialSupport={BASIC:t({vertexFormat:r.POSITION_AND_NORMAL,vertexShaderSource:l,fragmentShaderSource:s}),TEXTURED:t({vertexFormat:r.POSITION_NORMAL_AND_ST,vertexShaderSource:c,fragmentShaderSource:u}),ALL:t({vertexFormat:r.ALL,vertexShaderSource:a,fragmentShaderSource:i})},p}),define("Shaders/Appearances/PerInstanceColorAppearanceFS",[],function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec4 v_color;\nvoid main()\n{\nvec3 positionToEyeEC = -v_positionEC;\nvec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\nnormalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\nczm_materialInput materialInput;\nmaterialInput.normalEC = normalEC;\nmaterialInput.positionToEyeEC = positionToEyeEC;\nczm_material material = czm_getDefaultMaterial(materialInput);\nmaterial.diffuse = v_color.rgb;\nmaterial.alpha = v_color.a;\ngl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n}\n"}),define("Shaders/Appearances/PerInstanceColorAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute vec4 color;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec4 v_color;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_positionEC = (czm_modelViewRelativeToEye * p).xyz;\nv_normalEC = czm_normal * normal;\nv_color = color;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"}),define("Shaders/Appearances/PerInstanceFlatColorAppearanceFS",[],function(){"use strict";return"varying vec4 v_color;\nvoid main()\n{\ngl_FragColor = v_color;\n}\n"}),define("Shaders/Appearances/PerInstanceFlatColorAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec4 color;\nattribute float batchId;\nvarying vec4 v_color;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_color = color;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"}),define("Scene/PerInstanceColorAppearance",["../Core/defaultValue","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/PerInstanceColorAppearanceFS","../Shaders/Appearances/PerInstanceColorAppearanceVS","../Shaders/Appearances/PerInstanceFlatColorAppearanceFS","../Shaders/Appearances/PerInstanceFlatColorAppearanceVS","./Appearance"],function(s,e,t,l,u,c,d,h){"use strict";function p(e){e=s(e,s.EMPTY_OBJECT);var t=s(e.translucent,!0),r=s(e.closed,!1),i=s(e.flat,!1),n=i?d:u,o=i?c:l,a=i?p.FLAT_VERTEX_FORMAT:p.VERTEX_FORMAT;this.material=void 0,this.translucent=t,this._vertexShaderSource=s(e.vertexShaderSource,n),this._fragmentShaderSource=s(e.fragmentShaderSource,o),this._renderState=h.getDefaultRenderState(t,r,e.renderState),this._closed=r,this._vertexFormat=a,this._flat=i,this._faceForward=s(e.faceForward,!r)}return e(p.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}}),p.VERTEX_FORMAT=t.POSITION_AND_NORMAL,p.FLAT_VERTEX_FORMAT=t.POSITION_ONLY,p.prototype.getFragmentShaderSource=h.prototype.getFragmentShaderSource,p.prototype.isTranslucent=h.prototype.isTranslucent,p.prototype.getRenderState=h.prototype.getRenderState,p}),define("Renderer/BufferUsage",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={STREAM_DRAW:t.STREAM_DRAW,STATIC_DRAW:t.STATIC_DRAW,DYNAMIC_DRAW:t.DYNAMIC_DRAW,validate:function(e){return e===r.STREAM_DRAW||e===r.STATIC_DRAW||e===r.DYNAMIC_DRAW}};return e(r)}),define("Renderer/DrawCommand",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/PrimitiveType"],function(t,r,e,i){"use strict";function n(e){e=t(e,t.EMPTY_OBJECT),this._boundingVolume=e.boundingVolume,this._orientedBoundingBox=e.orientedBoundingBox,this._cull=t(e.cull,!0),this._modelMatrix=e.modelMatrix,this._primitiveType=t(e.primitiveType,i.TRIANGLES),this._vertexArray=e.vertexArray,this._count=e.count,this._offset=t(e.offset,0),this._instanceCount=t(e.instanceCount,0),this._shaderProgram=e.shaderProgram,this._uniformMap=e.uniformMap,this._renderState=e.renderState,this._framebuffer=e.framebuffer,this._pass=e.pass,this._executeInClosestFrustum=t(e.executeInClosestFrustum,!1),this._owner=e.owner,this._debugShowBoundingVolume=t(e.debugShowBoundingVolume,!1),this._debugOverlappingFrustums=0,this._castShadows=t(e.castShadows,!1),this._receiveShadows=t(e.receiveShadows,!1),this.dirty=!0,this.lastDirtyTime=0,this.derivedCommands={}}return e(n.prototype,{boundingVolume:{get:function(){return this._boundingVolume},set:function(e){this._boundingVolume!==e&&(this._boundingVolume=e,this.dirty=!0)}},orientedBoundingBox:{get:function(){return this._orientedBoundingBox},set:function(e){this._orientedBoundingBox!==e&&(this._orientedBoundingBox=e,this.dirty=!0)}},cull:{get:function(){return this._cull},set:function(e){this._cull!==e&&(this._cull=e,this.dirty=!0)}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix!==e&&(this._modelMatrix=e,this.dirty=!0)}},primitiveType:{get:function(){return this._primitiveType},set:function(e){this._primitiveType!==e&&(this._primitiveType=e,this.dirty=!0)}},vertexArray:{get:function(){return this._vertexArray},set:function(e){this._vertexArray!==e&&(this._vertexArray=e,this.dirty=!0)}},count:{get:function(){return this._count},set:function(e){this._count!==e&&(this._count=e,this.dirty=!0)}},offset:{get:function(){return this._offset},set:function(e){this._offset!==e&&(this._offset=e,this.dirty=!0)}},instanceCount:{get:function(){return this._instanceCount},set:function(e){this._instanceCount!==e&&(this._instanceCount=e,this.dirty=!0)}},shaderProgram:{get:function(){return this._shaderProgram},set:function(e){this._shaderProgram!==e&&(this._shaderProgram=e,this.dirty=!0)}},castShadows:{get:function(){return this._castShadows},set:function(e){this._castShadows!==e&&(this._castShadows=e,this.dirty=!0)}},receiveShadows:{get:function(){return this._receiveShadows},set:function(e){this._receiveShadows!==e&&(this._receiveShadows=e,this.dirty=!0)}},uniformMap:{get:function(){return this._uniformMap},set:function(e){this._uniformMap!==e&&(this._uniformMap=e,this.dirty=!0)}},renderState:{get:function(){return this._renderState},set:function(e){this._renderState!==e&&(this._renderState=e,this.dirty=!0)}},framebuffer:{get:function(){return this._framebuffer},set:function(e){this._framebuffer!==e&&(this._framebuffer=e,this.dirty=!0)}},pass:{get:function(){return this._pass},set:function(e){this._pass!==e&&(this._pass=e,this.dirty=!0)}},executeInClosestFrustum:{get:function(){return this._executeInClosestFrustum},set:function(e){this._executeInClosestFrustum!==e&&(this._executeInClosestFrustum=e,this.dirty=!0)}},owner:{get:function(){return this._owner},set:function(e){this._owner!==e&&(this._owner=e,this.dirty=!0)}},debugShowBoundingVolume:{get:function(){return this._debugShowBoundingVolume},set:function(e){this._debugShowBoundingVolume!==e&&(this._debugShowBoundingVolume=e,this.dirty=!0)}},debugOverlappingFrustums:{get:function(){return this._debugOverlappingFrustums},set:function(e){this._debugOverlappingFrustums!==e&&(this._debugOverlappingFrustums=e,this.dirty=!0)}}}),n.shallowClone=function(e,t){if(r(e))return r(t)||(t=new n),t._boundingVolume=e._boundingVolume,t._orientedBoundingBox=e._orientedBoundingBox,t._cull=e._cull,t._modelMatrix=e._modelMatrix,t._primitiveType=e._primitiveType,t._vertexArray=e._vertexArray,t._count=e._count,t._offset=e._offset,t._instanceCount=e._instanceCount,t._shaderProgram=e._shaderProgram,t._uniformMap=e._uniformMap,t._renderState=e._renderState,t._framebuffer=e._framebuffer,t._pass=e._pass,t._executeInClosestFrustum=e._executeInClosestFrustum,t._owner=e._owner,t._debugShowBoundingVolume=e._debugShowBoundingVolume,t._debugOverlappingFrustums=e._debugOverlappingFrustums,t._castShadows=e._castShadows,t._receiveShadows=e._receiveShadows,t.dirty=!0,t.lastDirtyTime=0,t},n.prototype.execute=function(e,t){e.draw(this,t)},n}),define("Renderer/Pass",["../Core/freezeObject"],function(e){"use strict";return e({ENVIRONMENT:0,COMPUTE:1,GLOBE:2,TERRAIN_CLASSIFICATION:3,CESIUM_3D_TILE:4,CESIUM_3D_TILE_CLASSIFICATION:5,CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW:6,CLASSIFICATION:7,OPAQUE:8,TRANSLUCENT:9,OVERLAY:10,NUMBER_OF_PASSES:11})}),define("Renderer/freezeRenderState",["../Core/freezeObject"],function(o){"use strict";return function e(t){if("object"!=typeof t||null===t)return t;for(var r,i=Object.keys(t),n=0;n<i.length;n++)r=i[n],t.hasOwnProperty(r)&&"_applyFunctions"!==r&&(t[r]=e(t[r]));return o(t)}}),define("Renderer/RenderState",["../Core/BoundingRectangle","../Core/Color","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/WebGLConstants","../Core/WindingOrder","./ContextLimits","./freezeRenderState"],function(v,y,b,C,w,S,T,E,o){"use strict";function A(e){return e===S.FUNC_ADD||e===S.FUNC_SUBTRACT||e===S.FUNC_REVERSE_SUBTRACT||e===S.MIN||e===S.MAX}function x(e){return e===S.ZERO||e===S.ONE||e===S.SRC_COLOR||e===S.ONE_MINUS_SRC_COLOR||e===S.DST_COLOR||e===S.ONE_MINUS_DST_COLOR||e===S.SRC_ALPHA||e===S.ONE_MINUS_SRC_ALPHA||e===S.DST_ALPHA||e===S.ONE_MINUS_DST_ALPHA||e===S.CONSTANT_COLOR||e===S.ONE_MINUS_CONSTANT_COLOR||e===S.CONSTANT_ALPHA||e===S.ONE_MINUS_CONSTANT_ALPHA||e===S.SRC_ALPHA_SATURATE}function P(e){return e===S.NEVER||e===S.LESS||e===S.EQUAL||e===S.LEQUAL||e===S.GREATER||e===S.NOTEQUAL||e===S.GEQUAL||e===S.ALWAYS}function D(e){return e===S.ZERO||e===S.KEEP||e===S.REPLACE||e===S.INCR||e===S.DECR||e===S.INVERT||e===S.INCR_WRAP||e===S.DECR_WRAP}function a(e){var t,r,i=b(e,{}),n=b(i.cull,{}),o=b(i.polygonOffset,{}),a=b(i.scissorTest,{}),s=b(a.rectangle,{}),l=b(i.depthRange,{}),u=b(i.depthTest,{}),c=b(i.colorMask,{}),d=b(i.blending,{}),h=b(d.color,{}),p=b(i.stencilTest,{}),f=b(p.frontOperation,{}),m=b(p.backOperation,{}),g=b(i.sampleCoverage,{}),_=i.viewport;if(this.frontFace=b(i.frontFace,T.COUNTER_CLOCKWISE),this.cull={enabled:b(n.enabled,!1),face:b(n.face,S.BACK)},this.lineWidth=b(i.lineWidth,1),this.polygonOffset={enabled:b(o.enabled,!1),factor:b(o.factor,0),units:b(o.units,0)},this.scissorTest={enabled:b(a.enabled,!1),rectangle:v.clone(s)},this.depthRange={near:b(l.near,0),far:b(l.far,1)},this.depthTest={enabled:b(u.enabled,!1),func:b(u.func,S.LESS)},this.colorMask={red:b(c.red,!0),green:b(c.green,!0),blue:b(c.blue,!0),alpha:b(c.alpha,!0)},this.depthMask=b(i.depthMask,!0),this.stencilMask=b(i.stencilMask,-1),this.blending={enabled:b(d.enabled,!1),color:new y(b(h.red,0),b(h.green,0),b(h.blue,0),b(h.alpha,0)),equationRgb:b(d.equationRgb,S.FUNC_ADD),equationAlpha:b(d.equationAlpha,S.FUNC_ADD),functionSourceRgb:b(d.functionSourceRgb,S.ONE),functionSourceAlpha:b(d.functionSourceAlpha,S.ONE),functionDestinationRgb:b(d.functionDestinationRgb,S.ZERO),functionDestinationAlpha:b(d.functionDestinationAlpha,S.ZERO)},this.stencilTest={enabled:b(p.enabled,!1),frontFunction:b(p.frontFunction,S.ALWAYS),backFunction:b(p.backFunction,S.ALWAYS),reference:b(p.reference,0),mask:b(p.mask,-1),frontOperation:{fail:b(f.fail,S.KEEP),zFail:b(f.zFail,S.KEEP),zPass:b(f.zPass,S.KEEP)},backOperation:{fail:b(m.fail,S.KEEP),zFail:b(m.zFail,S.KEEP),zPass:b(m.zPass,S.KEEP)}},this.sampleCoverage={enabled:b(g.enabled,!1),value:b(g.value,1),invert:b(g.invert,!1)},this.viewport=C(_)?new v(_.x,_.y,_.width,_.height):void 0,this.lineWidth<E.minimumAliasedLineWidth||this.lineWidth>E.maximumAliasedLineWidth)throw new w("renderState.lineWidth is out of range.  Check minimumAliasedLineWidth and maximumAliasedLineWidth.");if(!T.validate(this.frontFace))throw new w("Invalid renderState.frontFace.");if((t=this.cull.face)!==S.FRONT&&t!==S.BACK&&t!==S.FRONT_AND_BACK)throw new w("Invalid renderState.cull.face.");if(this.scissorTest.rectangle.width<0||this.scissorTest.rectangle.height<0)throw new w("renderState.scissorTest.rectangle.width and renderState.scissorTest.rectangle.height must be greater than or equal to zero.");if(this.depthRange.near>this.depthRange.far)throw new w("renderState.depthRange.near can not be greater than renderState.depthRange.far.");if(this.depthRange.near<0)throw new w("renderState.depthRange.near must be greater than or equal to zero.");if(1<this.depthRange.far)throw new w("renderState.depthRange.far must be less than or equal to one.");if((r=this.depthTest.func)!==S.NEVER&&r!==S.LESS&&r!==S.EQUAL&&r!==S.LEQUAL&&r!==S.GREATER&&r!==S.NOTEQUAL&&r!==S.GEQUAL&&r!==S.ALWAYS)throw new w("Invalid renderState.depthTest.func.");if(this.blending.color.red<0||1<this.blending.color.red||this.blending.color.green<0||1<this.blending.color.green||this.blending.color.blue<0||1<this.blending.color.blue||this.blending.color.alpha<0||1<this.blending.color.alpha)throw new w("renderState.blending.color components must be greater than or equal to zero and less than or equal to one.");if(!A(this.blending.equationRgb))throw new w("Invalid renderState.blending.equationRgb.");if(!A(this.blending.equationAlpha))throw new w("Invalid renderState.blending.equationAlpha.");if(!x(this.blending.functionSourceRgb))throw new w("Invalid renderState.blending.functionSourceRgb.");if(!x(this.blending.functionSourceAlpha))throw new w("Invalid renderState.blending.functionSourceAlpha.");if(!x(this.blending.functionDestinationRgb))throw new w("Invalid renderState.blending.functionDestinationRgb.");if(!x(this.blending.functionDestinationAlpha))throw new w("Invalid renderState.blending.functionDestinationAlpha.");if(!P(this.stencilTest.frontFunction))throw new w("Invalid renderState.stencilTest.frontFunction.");if(!P(this.stencilTest.backFunction))throw new w("Invalid renderState.stencilTest.backFunction.");if(!D(this.stencilTest.frontOperation.fail))throw new w("Invalid renderState.stencilTest.frontOperation.fail.");if(!D(this.stencilTest.frontOperation.zFail))throw new w("Invalid renderState.stencilTest.frontOperation.zFail.");if(!D(this.stencilTest.frontOperation.zPass))throw new w("Invalid renderState.stencilTest.frontOperation.zPass.");if(!D(this.stencilTest.backOperation.fail))throw new w("Invalid renderState.stencilTest.backOperation.fail.");if(!D(this.stencilTest.backOperation.zFail))throw new w("Invalid renderState.stencilTest.backOperation.zFail.");if(!D(this.stencilTest.backOperation.zPass))throw new w("Invalid renderState.stencilTest.backOperation.zPass.");if(C(this.viewport)){if(this.viewport.width<0)throw new w("renderState.viewport.width must be greater than or equal to zero.");if(this.viewport.height<0)throw new w("renderState.viewport.height must be greater than or equal to zero.");if(this.viewport.width>E.maximumViewportWidth)throw new w("renderState.viewport.width must be less than or equal to the maximum viewport width ("+E.maximumViewportWidth.toString()+").  Check maximumViewportWidth.");if(this.viewport.height>E.maximumViewportHeight)throw new w("renderState.viewport.height must be less than or equal to the maximum viewport height ("+E.maximumViewportHeight.toString()+").  Check maximumViewportHeight.")}this.id=0,this._applyFunctions=[]}var s=0,l={};function g(e,t,r){r?e.enable(t):e.disable(t)}function f(e,t){e.frontFace(t.frontFace)}function m(e,t){var r=t.cull,i=r.enabled;g(e,e.CULL_FACE,i),i&&e.cullFace(r.face)}function _(e,t){e.lineWidth(t.lineWidth)}function O(e,t){var r=t.polygonOffset,i=r.enabled;g(e,e.POLYGON_OFFSET_FILL,i),i&&e.polygonOffset(r.factor,r.units)}function I(e,t,r){var i=t.scissorTest,n=C(r.scissorTest)?r.scissorTest.enabled:i.enabled;if(g(e,e.SCISSOR_TEST,n),n){var o=C(r.scissorTest)?r.scissorTest.rectangle:i.rectangle;e.scissor(o.x,o.y,o.width,o.height)}}function M(e,t){var r=t.depthRange;e.depthRange(r.near,r.far)}function R(e,t){var r=t.depthTest,i=r.enabled;g(e,e.DEPTH_TEST,i),i&&e.depthFunc(r.func)}function L(e,t){var r=t.colorMask;e.colorMask(r.red,r.green,r.blue,r.alpha)}function N(e,t){e.depthMask(t.depthMask)}function k(e,t){e.stencilMask(t.stencilMask)}function F(e,t,r){var i,n,o=t.blending,a=C(r.blendingEnabled)?r.blendingEnabled:o.enabled;g(e,e.BLEND,a),a&&(i=e,n=o.color,i.blendColor(n.red,n.green,n.blue,n.alpha),e.blendEquationSeparate(o.equationRgb,o.equationAlpha),e.blendFuncSeparate(o.functionSourceRgb,o.functionDestinationRgb,o.functionSourceAlpha,o.functionDestinationAlpha))}function B(e,t){var r=t.stencilTest,i=r.enabled;if(g(e,e.STENCIL_TEST,i),i){var n=r.frontFunction,o=r.backFunction,a=r.reference,s=r.mask;e.stencilFunc(n,a,s),e.stencilFuncSeparate(e.BACK,o,a,s),e.stencilFuncSeparate(e.FRONT,n,a,s);var l=r.frontOperation,u=l.fail,c=l.zFail,d=l.zPass;e.stencilOpSeparate(e.FRONT,u,c,d);var h=r.backOperation,p=h.fail,f=h.zFail,m=h.zPass;e.stencilOpSeparate(e.BACK,p,f,m)}}function U(e,t){var r=t.sampleCoverage,i=r.enabled;g(e,e.SAMPLE_COVERAGE,i),i&&e.sampleCoverage(r.value,r.invert)}a.fromCache=function(e){var t=JSON.stringify(e),r=l[t];if(C(r))return++r.referenceCount,r.state;var i=new a(e),n=JSON.stringify(i);return r=l[n],C(r)||(i.id=s++,r={referenceCount:0,state:i=o(i)},l[n]=r),++r.referenceCount,l[t]={referenceCount:1,state:r.state},r.state},a.removeFromCache=function(e){var t=new a(e),r=JSON.stringify(t),i=l[r],n=JSON.stringify(e),o=l[n];C(o)&&(--o.referenceCount,0===o.referenceCount&&(delete l[n],C(i)&&--i.referenceCount)),C(i)&&0===i.referenceCount&&delete l[r]},a.getCache=function(){return l},a.clearCache=function(){l={}};var n=new v;function V(e,t,r){var i=b(t.viewport,r.viewport);C(i)||((i=n).width=r.context.drawingBufferWidth,i.height=r.context.drawingBufferHeight),r.context.uniformState.viewport=i,e.viewport(i.x,i.y,i.width,i.height)}return a.apply=function(e,t,r){f(e,t),m(e,t),_(e,t),O(e,t),M(e,t),R(e,t),L(e,t),N(e,t),k(e,t),B(e,t),U(e,t),I(e,t,r),F(e,t,r),V(e,t,r)},a.partialApply=function(e,t,r,i,n,o){if(t!==r){var a=r._applyFunctions[t.id];C(a)||(c=r,d=[],(u=t).frontFace!==c.frontFace&&d.push(f),u.cull.enabled===c.cull.enabled&&u.cull.face===c.cull.face||d.push(m),u.lineWidth!==c.lineWidth&&d.push(_),u.polygonOffset.enabled===c.polygonOffset.enabled&&u.polygonOffset.factor===c.polygonOffset.factor&&u.polygonOffset.units===c.polygonOffset.units||d.push(O),u.depthRange.near===c.depthRange.near&&u.depthRange.far===c.depthRange.far||d.push(M),u.depthTest.enabled===c.depthTest.enabled&&u.depthTest.func===c.depthTest.func||d.push(R),u.colorMask.red===c.colorMask.red&&u.colorMask.green===c.colorMask.green&&u.colorMask.blue===c.colorMask.blue&&u.colorMask.alpha===c.colorMask.alpha||d.push(L),u.depthMask!==c.depthMask&&d.push(N),u.stencilMask!==c.stencilMask&&d.push(k),u.stencilTest.enabled===c.stencilTest.enabled&&u.stencilTest.frontFunction===c.stencilTest.frontFunction&&u.stencilTest.backFunction===c.stencilTest.backFunction&&u.stencilTest.reference===c.stencilTest.reference&&u.stencilTest.mask===c.stencilTest.mask&&u.stencilTest.frontOperation.fail===c.stencilTest.frontOperation.fail&&u.stencilTest.frontOperation.zFail===c.stencilTest.frontOperation.zFail&&u.stencilTest.backOperation.fail===c.stencilTest.backOperation.fail&&u.stencilTest.backOperation.zFail===c.stencilTest.backOperation.zFail&&u.stencilTest.backOperation.zPass===c.stencilTest.backOperation.zPass||d.push(B),u.sampleCoverage.enabled===c.sampleCoverage.enabled&&u.sampleCoverage.value===c.sampleCoverage.value&&u.sampleCoverage.invert===c.sampleCoverage.invert||d.push(U),a=d,r._applyFunctions[t.id]=a);for(var s=a.length,l=0;l<s;++l)a[l](e,r)}var u,c,d;((C(i.scissorTest)?i.scissorTest:t.scissorTest)!==(C(n.scissorTest)?n.scissorTest:r.scissorTest)||o)&&I(e,r,n);var h=C(i.blendingEnabled)?i.blendingEnabled:t.blending.enabled,p=C(n.blendingEnabled)?n.blendingEnabled:r.blending.enabled;(h!==p||p&&t.blending!==r.blending)&&F(e,r,n),t===r&&i===n&&i.context===n.context||V(e,r,n)},a.getState=function(e){if(!C(e))throw new w("renderState is required.");return{frontFace:e.frontFace,cull:{enabled:e.cull.enabled,face:e.cull.face},lineWidth:e.lineWidth,polygonOffset:{enabled:e.polygonOffset.enabled,factor:e.polygonOffset.factor,units:e.polygonOffset.units},scissorTest:{enabled:e.scissorTest.enabled,rectangle:v.clone(e.scissorTest.rectangle)},depthRange:{near:e.depthRange.near,far:e.depthRange.far},depthTest:{enabled:e.depthTest.enabled,func:e.depthTest.func},colorMask:{red:e.colorMask.red,green:e.colorMask.green,blue:e.colorMask.blue,alpha:e.colorMask.alpha},depthMask:e.depthMask,stencilMask:e.stencilMask,blending:{enabled:e.blending.enabled,color:y.clone(e.blending.color),equationRgb:e.blending.equationRgb,equationAlpha:e.blending.equationAlpha,functionSourceRgb:e.blending.functionSourceRgb,functionSourceAlpha:e.blending.functionSourceAlpha,functionDestinationRgb:e.blending.functionDestinationRgb,functionDestinationAlpha:e.blending.functionDestinationAlpha},stencilTest:{enabled:e.stencilTest.enabled,frontFunction:e.stencilTest.frontFunction,backFunction:e.stencilTest.backFunction,reference:e.stencilTest.reference,mask:e.stencilTest.mask,frontOperation:{fail:e.stencilTest.frontOperation.fail,zFail:e.stencilTest.frontOperation.zFail,zPass:e.stencilTest.frontOperation.zPass},backOperation:{fail:e.stencilTest.backOperation.fail,zFail:e.stencilTest.backOperation.zFail,zPass:e.stencilTest.backOperation.zPass}},sampleCoverage:{enabled:e.sampleCoverage.enabled,value:e.sampleCoverage.value,invert:e.sampleCoverage.invert},viewport:C(e.viewport)?v.clone(e.viewport):void 0}},a}),define("Renderer/AutomaticUniforms",["../Core/Cartesian3","../Core/Matrix4","../Core/WebGLConstants"],function(e,t,r){"use strict";var i=new e;function n(e){this._size=e.size,this._datatype=e.datatype,this.getValue=e.getValue}if("undefined"==typeof WebGLRenderingContext)return{};var o={};return o[r.FLOAT]="float",o[r.FLOAT_VEC2]="vec2",o[r.FLOAT_VEC3]="vec3",o[r.FLOAT_VEC4]="vec4",o[r.INT]="int",o[r.INT_VEC2]="ivec2",o[r.INT_VEC3]="ivec3",o[r.INT_VEC4]="ivec4",o[r.BOOL]="bool",o[r.BOOL_VEC2]="bvec2",o[r.BOOL_VEC3]="bvec3",o[r.BOOL_VEC4]="bvec4",o[r.FLOAT_MAT2]="mat2",o[r.FLOAT_MAT3]="mat3",o[r.FLOAT_MAT4]="mat4",o[r.SAMPLER_2D]="sampler2D",o[r.SAMPLER_CUBE]="samplerCube",n.prototype.getDeclaration=function(e){var t="uniform "+o[this._datatype]+" "+e,r=this._size;return t+=1===r?";":"["+r.toString()+"];"},{czm_viewport:new n({size:1,datatype:r.FLOAT_VEC4,getValue:function(e){return e.viewportCartesian4}}),czm_viewportOrthographic:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.viewportOrthographic}}),czm_viewportTransformation:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.viewportTransformation}}),czm_globeDepthTexture:new n({size:1,datatype:r.SAMPLER_2D,getValue:function(e){return e.globeDepthTexture}}),czm_model:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.model}}),czm_inverseModel:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseModel}}),czm_view:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.view}}),czm_view3D:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.view3D}}),czm_viewRotation:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.viewRotation}}),czm_viewRotation3D:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.viewRotation3D}}),czm_inverseView:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseView}}),czm_inverseView3D:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseView3D}}),czm_inverseViewRotation:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation}}),czm_inverseViewRotation3D:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation3D}}),czm_projection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.projection}}),czm_inverseProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseProjection}}),czm_infiniteProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.infiniteProjection}}),czm_modelView:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelView}}),czm_modelView3D:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelView3D}}),czm_modelViewRelativeToEye:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelViewRelativeToEye}}),czm_inverseModelView:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseModelView}}),czm_inverseModelView3D:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseModelView3D}}),czm_viewProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.viewProjection}}),czm_inverseViewProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseViewProjection}}),czm_modelViewProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelViewProjection}}),czm_inverseModelViewProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseModelViewProjection}}),czm_modelViewProjectionRelativeToEye:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelViewProjectionRelativeToEye}}),czm_modelViewInfiniteProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelViewInfiniteProjection}}),czm_normal:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.normal}}),czm_normal3D:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.normal3D}}),czm_inverseNormal:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.inverseNormal}}),czm_inverseNormal3D:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.inverseNormal3D}}),czm_eyeHeight2D:new n({size:1,datatype:r.FLOAT_VEC2,getValue:function(e){return e.eyeHeight2D}}),czm_entireFrustum:new n({size:1,datatype:r.FLOAT_VEC2,getValue:function(e){return e.entireFrustum}}),czm_currentFrustum:new n({size:1,datatype:r.FLOAT_VEC2,getValue:function(e){return e.currentFrustum}}),czm_frustumPlanes:new n({size:1,datatype:r.FLOAT_VEC4,getValue:function(e){return e.frustumPlanes}}),czm_sunPositionWC:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.sunPositionWC}}),czm_sunPositionColumbusView:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.sunPositionColumbusView}}),czm_sunDirectionEC:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.sunDirectionEC}}),czm_sunDirectionWC:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.sunDirectionWC}}),czm_moonDirectionEC:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.moonDirectionEC}}),czm_encodedCameraPositionMCHigh:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCHigh}}),czm_encodedCameraPositionMCLow:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCLow}}),czm_viewerPositionWC:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return t.getTranslation(e.inverseView,i)}}),czm_frameNumber:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.frameState.frameNumber}}),czm_morphTime:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.frameState.morphTime}}),czm_sceneMode:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.frameState.mode}}),czm_pass:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.pass}}),czm_backgroundColor:new n({size:1,datatype:r.FLOAT_VEC4,getValue:function(e){return e.backgroundColor}}),czm_brdfLut:new n({size:1,datatype:r.SAMPLER_2D,getValue:function(e){return e.brdfLut}}),czm_environmentMap:new n({size:1,datatype:r.SAMPLER_CUBE,getValue:function(e){return e.environmentMap}}),czm_temeToPseudoFixed:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.temeToPseudoFixedMatrix}}),czm_resolutionScale:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.resolutionScale}}),czm_fogDensity:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.fogDensity}}),czm_imagerySplitPosition:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.imagerySplitPosition}}),czm_geometricToleranceOverMeter:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.geometricToleranceOverMeter}}),czm_minimumDisableDepthTestDistance:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.minimumDisableDepthTestDistance}}),czm_invertClassificationColor:new n({size:1,datatype:r.FLOAT_VEC4,getValue:function(e){return e.invertClassificationColor}})}}),define("Renderer/createUniform",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/defined","../Core/DeveloperError","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Core/RuntimeError"],function(n,o,a,t,r,i,e,s,l,u){"use strict";function c(e,t,r,i){this.name=r,this.value=void 0,this._value=0,this._gl=e,this._location=i}function d(e,t,r,i){this.name=r,this.value=void 0,this._value=new n,this._gl=e,this._location=i}function h(e,t,r,i){this.name=r,this.value=void 0,this._value=void 0,this._gl=e,this._location=i}function p(e,t,r,i){this.name=r,this.value=void 0,this._value=void 0,this._gl=e,this._location=i}function f(e,t,r,i){this.name=r,this.value=void 0,this._gl=e,this._location=i,this.textureUnitIndex=void 0}function m(e,t,r,i){this.name=r,this.value=void 0,this._value=0,this._gl=e,this._location=i}function g(e,t,r,i){this.name=r,this.value=void 0,this._value=new n,this._gl=e,this._location=i}function _(e,t,r,i){this.name=r,this.value=void 0,this._value=new o,this._gl=e,this._location=i}function v(e,t,r,i){this.name=r,this.value=void 0,this._value=new a,this._gl=e,this._location=i}function y(e,t,r,i){this.name=r,this.value=void 0,this._value=new Float32Array(4),this._gl=e,this._location=i}function b(e,t,r,i){this.name=r,this.value=void 0,this._value=new Float32Array(9),this._gl=e,this._location=i}function C(e,t,r,i){this.name=r,this.value=void 0,this._value=new Float32Array(16),this._gl=e,this._location=i}return c.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1f(this._location,this.value))},d.prototype.set=function(){var e=this.value;n.equals(e,this._value)||(n.clone(e,this._value),this._gl.uniform2f(this._location,e.x,e.y))},h.prototype.set=function(){var e=this.value;if(r(e.red))t.equals(e,this._value)||(this._value=t.clone(e,this._value),this._gl.uniform3f(this._location,e.red,e.green,e.blue));else{if(!r(e.x))throw new i('Invalid vec3 value for uniform "'+this._activethis.name+'".');o.equals(e,this._value)||(this._value=o.clone(e,this._value),this._gl.uniform3f(this._location,e.x,e.y,e.z))}},p.prototype.set=function(){var e=this.value;if(r(e.red))t.equals(e,this._value)||(this._value=t.clone(e,this._value),this._gl.uniform4f(this._location,e.red,e.green,e.blue,e.alpha));else{if(!r(e.x))throw new i('Invalid vec4 value for uniform "'+this._activethis.name+'".');a.equals(e,this._value)||(this._value=a.clone(e,this._value),this._gl.uniform4f(this._location,e.x,e.y,e.z,e.w))}},f.prototype.set=function(){var e=this._gl;e.activeTexture(e.TEXTURE0+this.textureUnitIndex);var t=this.value;e.bindTexture(t._target,t._texture)},f.prototype._setSampler=function(e){return this.textureUnitIndex=e,this._gl.uniform1i(this._location,e),e+1},m.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1i(this._location,this.value))},g.prototype.set=function(){var e=this.value;n.equals(e,this._value)||(n.clone(e,this._value),this._gl.uniform2i(this._location,e.x,e.y))},_.prototype.set=function(){var e=this.value;o.equals(e,this._value)||(o.clone(e,this._value),this._gl.uniform3i(this._location,e.x,e.y,e.z))},v.prototype.set=function(){var e=this.value;a.equals(e,this._value)||(a.clone(e,this._value),this._gl.uniform4i(this._location,e.x,e.y,e.z,e.w))},y.prototype.set=function(){e.equalsArray(this.value,this._value,0)||(e.toArray(this.value,this._value),this._gl.uniformMatrix2fv(this._location,!1,this._value))},b.prototype.set=function(){s.equalsArray(this.value,this._value,0)||(s.toArray(this.value,this._value),this._gl.uniformMatrix3fv(this._location,!1,this._value))},C.prototype.set=function(){l.equalsArray(this.value,this._value,0)||(l.toArray(this.value,this._value),this._gl.uniformMatrix4fv(this._location,!1,this._value))},function(e,t,r,i){switch(t.type){case e.FLOAT:return new c(e,t,r,i);case e.FLOAT_VEC2:return new d(e,t,r,i);case e.FLOAT_VEC3:return new h(e,t,r,i);case e.FLOAT_VEC4:return new p(e,t,r,i);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new f(e,t,r,i);case e.INT:case e.BOOL:return new m(e,t,r,i);case e.INT_VEC2:case e.BOOL_VEC2:return new g(e,t,r,i);case e.INT_VEC3:case e.BOOL_VEC3:return new _(e,t,r,i);case e.INT_VEC4:case e.BOOL_VEC4:return new v(e,t,r,i);case e.FLOAT_MAT2:return new y(e,t,r,i);case e.FLOAT_MAT3:return new b(e,t,r,i);case e.FLOAT_MAT4:return new C(e,t,r,i);default:throw new u("Unrecognized uniform type: "+t.type+' for uniform "'+r+'".')}}}),define("Renderer/createUniformArray",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/defined","../Core/DeveloperError","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Core/RuntimeError"],function(s,l,u,c,d,h,p,f,m,n){"use strict";function o(e,t,r,i){var n=i.length;this.name=r,this.value=new Array(n),this._value=new Float32Array(n),this._gl=e,this._location=i[0]}function a(e,t,r,i){var n=i.length;this.name=r,this.value=new Array(n),this._value=new Float32Array(2*n),this._gl=e,this._location=i[0]}function g(e,t,r,i){var n=i.length;this.name=r,this.value=new Array(n),this._value=new Float32Array(3*n),this._gl=e,this._location=i[0]}function _(e,t,r,i){var n=i.length;this.name=r,this.value=new Array(n),this._value=new Float32Array(4*n),this._gl=e,this._location=i[0]}function v(e,t,r,i){var n=i.length;this.name=r,this.value=new Array(n),this._value=new Float32Array(n),this._gl=e,this._locations=i,this.textureUnitIndex=void 0}function y(e,t,r,i){var n=i.length;this.name=r,this.value=new Array(n),this._value=new Int32Array(n),this._gl=e,this._location=i[0]}function b(e,t,r,i){var n=i.length;this.name=r,this.value=new Array(n),this._value=new Int32Array(2*n),this._gl=e,this._location=i[0]}function C(e,t,r,i){var n=i.length;this.name=r,this.value=new Array(n),this._value=new Int32Array(3*n),this._gl=e,this._location=i[0]}function w(e,t,r,i){var n=i.length;this.name=r,this.value=new Array(n),this._value=new Int32Array(4*n),this._gl=e,this._location=i[0]}function S(e,t,r,i){var n=i.length;this.name=r,this.value=new Array(n),this._value=new Float32Array(4*n),this._gl=e,this._location=i[0]}function T(e,t,r,i){var n=i.length;this.name=r,this.value=new Array(n),this._value=new Float32Array(9*n),this._gl=e,this._location=i[0]}function E(e,t,r,i){var n=i.length;this.name=r,this.value=new Array(n),this._value=new Float32Array(16*n),this._gl=e,this._location=i[0]}return o.prototype.set=function(){for(var e=this.value,t=e.length,r=this._value,i=!1,n=0;n<t;++n){var o=e[n];o!==r[n]&&(r[n]=o,i=!0)}i&&this._gl.uniform1fv(this._location,r)},a.prototype.set=function(){for(var e=this.value,t=e.length,r=this._value,i=!1,n=0,o=0;o<t;++o){var a=e[o];s.equalsArray(a,r,n)||(s.pack(a,r,n),i=!0),n+=2}i&&this._gl.uniform2fv(this._location,r)},g.prototype.set=function(){for(var e=this.value,t=e.length,r=this._value,i=!1,n=0,o=0;o<t;++o){var a=e[o];if(d(a.red))a.red===r[n]&&a.green===r[n+1]&&a.blue===r[n+2]||(r[n]=a.red,r[n+1]=a.green,r[n+2]=a.blue,i=!0);else{if(!d(a.x))throw new h("Invalid vec3 value.");l.equalsArray(a,r,n)||(l.pack(a,r,n),i=!0)}n+=3}i&&this._gl.uniform3fv(this._location,r)},_.prototype.set=function(){for(var e=this.value,t=e.length,r=this._value,i=!1,n=0,o=0;o<t;++o){var a=e[o];if(d(a.red))c.equalsArray(a,r,n)||(c.pack(a,r,n),i=!0);else{if(!d(a.x))throw new h("Invalid vec4 value.");u.equalsArray(a,r,n)||(u.pack(a,r,n),i=!0)}n+=4}i&&this._gl.uniform4fv(this._location,r)},v.prototype.set=function(){for(var e=this._gl,t=e.TEXTURE0+this.textureUnitIndex,r=this.value,i=r.length,n=0;n<i;++n){var o=r[n];e.activeTexture(t+n),e.bindTexture(o._target,o._texture)}},v.prototype._setSampler=function(e){this.textureUnitIndex=e;for(var t=this._locations,r=t.length,i=0;i<r;++i){var n=e+i;this._gl.uniform1i(t[i],n)}return e+r},y.prototype.set=function(){for(var e=this.value,t=e.length,r=this._value,i=!1,n=0;n<t;++n){var o=e[n];o!==r[n]&&(r[n]=o,i=!0)}i&&this._gl.uniform1iv(this._location,r)},b.prototype.set=function(){for(var e=this.value,t=e.length,r=this._value,i=!1,n=0,o=0;o<t;++o){var a=e[o];s.equalsArray(a,r,n)||(s.pack(a,r,n),i=!0),n+=2}i&&this._gl.uniform2iv(this._location,r)},C.prototype.set=function(){for(var e=this.value,t=e.length,r=this._value,i=!1,n=0,o=0;o<t;++o){var a=e[o];l.equalsArray(a,r,n)||(l.pack(a,r,n),i=!0),n+=3}i&&this._gl.uniform3iv(this._location,r)},w.prototype.set=function(){for(var e=this.value,t=e.length,r=this._value,i=!1,n=0,o=0;o<t;++o){var a=e[o];u.equalsArray(a,r,n)||(u.pack(a,r,n),i=!0),n+=4}i&&this._gl.uniform4iv(this._location,r)},S.prototype.set=function(){for(var e=this.value,t=e.length,r=this._value,i=!1,n=0,o=0;o<t;++o){var a=e[o];p.equalsArray(a,r,n)||(p.pack(a,r,n),i=!0),n+=4}i&&this._gl.uniformMatrix2fv(this._location,!1,r)},T.prototype.set=function(){for(var e=this.value,t=e.length,r=this._value,i=!1,n=0,o=0;o<t;++o){var a=e[o];f.equalsArray(a,r,n)||(f.pack(a,r,n),i=!0),n+=9}i&&this._gl.uniformMatrix3fv(this._location,!1,r)},E.prototype.set=function(){for(var e=this.value,t=e.length,r=this._value,i=!1,n=0,o=0;o<t;++o){var a=e[o];m.equalsArray(a,r,n)||(m.pack(a,r,n),i=!0),n+=16}i&&this._gl.uniformMatrix4fv(this._location,!1,r)},function(e,t,r,i){switch(t.type){case e.FLOAT:return new o(e,t,r,i);case e.FLOAT_VEC2:return new a(e,t,r,i);case e.FLOAT_VEC3:return new g(e,t,r,i);case e.FLOAT_VEC4:return new _(e,t,r,i);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new v(e,t,r,i);case e.INT:case e.BOOL:return new y(e,t,r,i);case e.INT_VEC2:case e.BOOL_VEC2:return new b(e,t,r,i);case e.INT_VEC3:case e.BOOL_VEC3:return new C(e,t,r,i);case e.INT_VEC4:case e.BOOL_VEC4:return new w(e,t,r,i);case e.FLOAT_MAT2:return new S(e,t,r,i);case e.FLOAT_MAT3:return new T(e,t,r,i);case e.FLOAT_MAT4:return new E(e,t,r,i);default:throw new n("Unrecognized uniform type: "+t.type+' for uniform "'+r+'".')}}}),define("Renderer/ShaderProgram",["../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/RuntimeError","./AutomaticUniforms","./ContextLimits","./createUniform","./createUniformArray"],function(t,r,_,e,i,h,f,u,p,v,y){"use strict";var n=0;function o(e){var t=function(e,t){var r={};if(!p.highpFloatSupported||!p.highpIntSupported){var i,n,o,a,s=m(e),l=m(t),u=s.length,c=l.length;for(i=0;i<u;i++)for(n=0;n<c;n++)if(s[i]===l[n]){o=s[i],a="czm_mediump_"+o;var d=new RegExp(o+"\\b","g");t=t.replace(d,a),r[a]=o}}return{fragmentShaderText:t,duplicateUniformNames:r}}(e.vertexShaderText,e.fragmentShaderText);this._gl=e.gl,this._logShaderCompilation=e.logShaderCompilation,this._debugShaders=e.debugShaders,this._attributeLocations=e.attributeLocations,this._program=void 0,this._numberOfVertexAttributes=void 0,this._vertexAttributes=void 0,this._uniformsByName=void 0,this._uniforms=void 0,this._automaticUniforms=void 0,this._manualUniforms=void 0,this._duplicateUniformNames=t.duplicateUniformNames,this._cachedShader=void 0,this.maximumTextureUnitIndex=void 0,this._vertexShaderSource=e.vertexShaderSource,this._vertexShaderText=e.vertexShaderText,this._fragmentShaderSource=e.fragmentShaderSource,this._fragmentShaderText=t.fragmentShaderText,this.id=n++}function m(e){var t=[],r=e.match(/uniform.*?(?![^{]*})(?=[=\[;])/g);if(_(r))for(var i=r.length,n=0;n<i;n++){var o=r[n].trim(),a=o.slice(o.lastIndexOf(" ")+1);t.push(a)}return t}o.fromCache=function(e){return e=r(e,r.EMPTY_OBJECT),t.defined("options.context",e.context),e.context.shaderCache.getShaderProgram(e)},o.replaceCache=function(e){return e=r(e,r.EMPTY_OBJECT),t.defined("options.context",e.context),e.context.shaderCache.replaceShaderProgram(e)},e(o.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},vertexAttributes:{get:function(){return a(this),this._vertexAttributes}},numberOfVertexAttributes:{get:function(){return a(this),this._numberOfVertexAttributes}},allUniforms:{get:function(){return a(this),this._uniformsByName}}});var g="[Cesium WebGL] ";function a(e){if(!_(e._program)){var t=e._gl,r=function(e,t){var r=t._vertexShaderText,i=t._fragmentShaderText,n=e.createShader(e.VERTEX_SHADER);e.shaderSource(n,r),e.compileShader(n);var o=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(o,i),e.compileShader(o);var a=e.createProgram();e.attachShader(a,n),e.attachShader(a,o),e.deleteShader(n),e.deleteShader(o);var s,l=t._attributeLocations;if(_(l))for(var u in l)l.hasOwnProperty(u)&&e.bindAttribLocation(a,l[u],u);if(e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS)){var c=t._debugShaders;if(!e.getShaderParameter(o,e.COMPILE_STATUS)){if(s=e.getShaderInfoLog(o),console.error(g+"Fragment shader compile log: "+s),_(c)){var d=c.getTranslatedShaderSource(o);""!==d?console.error(g+"Translated fragment shader source:\n"+d):console.error(g+"Fragment shader translation failed.")}throw e.deleteProgram(a),new f("Fragment shader failed to compile.  Compile log: "+s)}if(e.getShaderParameter(n,e.COMPILE_STATUS))throw s=e.getProgramInfoLog(a),console.error(g+"Shader program link log: "+s),_(c)&&(console.error(g+"Translated vertex shader source:\n"+c.getTranslatedShaderSource(n)),console.error(g+"Translated fragment shader source:\n"+c.getTranslatedShaderSource(o))),e.deleteProgram(a),new f("Program failed to link.  Link log: "+s);if(s=e.getShaderInfoLog(n),console.error(g+"Vertex shader compile log: "+s),_(c)){var h=c.getTranslatedShaderSource(n);""!==h?console.error(g+"Translated vertex shader source:\n"+h):console.error(g+"Vertex shader translation failed.")}throw e.deleteProgram(a),new f("Vertex shader failed to compile.  Compile log: "+s)}var p=t._logShaderCompilation;return p&&(s=e.getShaderInfoLog(n),_(s)&&0<s.length&&console.log(g+"Vertex shader compile log: "+s)),p&&(s=e.getShaderInfoLog(o),_(s)&&0<s.length&&console.log(g+"Fragment shader compile log: "+s)),p&&(s=e.getProgramInfoLog(a),_(s)&&0<s.length&&console.log(g+"Shader program link log: "+s)),a}(t,e,e._debugShaders),i=t.getProgramParameter(r,t.ACTIVE_ATTRIBUTES),n=function(e,t){for(var r={},i=[],n=[],o=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),a=0;a<o;++a){var s=e.getActiveUniform(t,a),l=-1!==s.name.indexOf("[0]",s.name.length-"[0]".length)?s.name.slice(0,s.name.length-3):s.name;if(0!==l.indexOf("gl_"))if(s.name.indexOf("[")<0){var u=e.getUniformLocation(t,l);if(null!==u){var c=v(e,s,l,u);r[l]=c,i.push(c),c._setSampler&&n.push(c)}}else{var d,h,p,f,m=l.indexOf("[");if(0<=m){if(d=r[l.slice(0,m)],!_(d))continue;(h=d._locations).length<=1&&(p=d.value,null!==(f=e.getUniformLocation(t,l))&&(h.push(f),p.push(e.getUniform(t,f))))}else{h=[];for(var g=0;g<s.size;++g)null!==(f=e.getUniformLocation(t,l+"["+g+"]"))&&h.push(f);d=y(e,s,l,h),r[l]=d,i.push(d),d._setSampler&&n.push(d)}}}return{uniformsByName:r,uniforms:i,samplerUniforms:n}}(t,r),o=function(e,t){var r=[],i=[];for(var n in t)if(t.hasOwnProperty(n)){var o=t[n],a=n,s=e._duplicateUniformNames[a];_(s)&&(a=o.name=s);var l=u[a];_(l)?r.push({uniform:o,automaticUniform:l}):i.push(o)}return{automaticUniforms:r,manualUniforms:i}}(e,n.uniformsByName);e._program=r,e._numberOfVertexAttributes=i,e._vertexAttributes=function(e,t,r){for(var i={},n=0;n<r;++n){var o=e.getActiveAttrib(t,n),a=e.getAttribLocation(t,o.name);i[o.name]={name:o.name,type:o.type,index:a}}return i}(t,r,i),e._uniformsByName=n.uniformsByName,e._uniforms=n.uniforms,e._automaticUniforms=o.automaticUniforms,e._manualUniforms=o.manualUniforms,e.maximumTextureUnitIndex=function(e,t,r){e.useProgram(t);for(var i=0,n=r.length,o=0;o<n;++o)i=r[o]._setSampler(i);return e.useProgram(null),i}(t,r,n.samplerUniforms)}}return o.prototype._bind=function(){a(this),this._gl.useProgram(this._program)},o.prototype._setUniforms=function(e,t,r){var i,n;if(_(e)){var o=this._manualUniforms;for(i=o.length,n=0;n<i;++n){var a=o[n];a.value=e[a.name]()}}var s=this._automaticUniforms;for(i=s.length,n=0;n<i;++n){var l=s[n];l.uniform.value=l.automaticUniform.getValue(t)}var u=this._uniforms;for(i=u.length,n=0;n<i;++n)u[n].set();if(r){var c=this._gl,d=this._program;if(c.validateProgram(d),!c.getProgramParameter(d,c.VALIDATE_STATUS))throw new h("Program validation failed.  Program info log: "+c.getProgramInfoLog(d))}},o.prototype.isDestroyed=function(){return!1},o.prototype.destroy=function(){this._cachedShader.cache.releaseShaderProgram(this)},o.prototype.finalDestroy=function(){return this._gl.deleteProgram(this._program),i(this)},o}),define("Renderer/modernizeShader",["../Core/defined","../Core/DeveloperError"],function(w,S){"use strict";function T(e,t,r){for(var i=new RegExp("(^|[^\\w])("+e+")($|[^\\w])","g"),n=r.length,o=0;o<n;++o){var a=r[o];r[o]=a.replace(i,"$1"+t+"$3")}}function E(e,t){-1===t.indexOf(e)&&t.push(e)}function A(e,t){!function(e,t,r){for(var i=r.length,n=0;n<i;++n){var o=r[n];r[n]=o.replace(e,t)}}(new RegExp("#extension\\s+GL_"+e+"\\s+:\\s+[a-zA-Z0-9]+\\s*$","g"),"",t)}return function(e,t){var r=/#define OUTPUT_DECLARATION/,i=e.split("\n");if(/#version 300 es/g.test(e))return e;var n,o,a=-1;for(n=0;n<i.length;++n)if(o=i[n],r.test(o)){a=n;break}if(-1===a)throw new S("Could not find a #define OUTPUT_DECLARATION!");var s=[];for(n=0;n<10;n++){var l="gl_FragData\\["+n+"\\]",u="czm_out"+n;new RegExp(l,"g").test(e)&&(E(u,s),T(l,u,i),i.splice(a,0,"layout(location = "+n+") out vec4 "+u+";"),a+=1)}var c="czm_fragColor";(function(e,t){for(var r=new RegExp("(^|[^\\w])("+e+")($|[^\\w])","g"),i=t.length,n=0;n<i;++n){var o=t[n];if(r.test(o))return!0}return!1})("gl_FragColor",i)&&(E(c,s),T("gl_FragColor",c,i),i.splice(a,0,"layout(location = 0) out vec4 czm_fragColor;"),a+=1);var d=function(e,t){for(var r={},i=e.length,n=[],o=0;o<t.length;++o){var a=t[o],s=/(#ifdef|#if)/g.test(a),l=/#else/g.test(a),u=/#endif/g.test(a);if(s)n.push(a);else if(l){var c=n[n.length-1],d=c.replace("ifdef","ifndef");/if/g.test(d)&&(d=d.replace(/(#if\s+)(\S*)([^]*)/,"$1!($2)$3")),n.pop(),n.push(d)}else if(u)n.pop();else if(!/layout/g.test(a))for(var h=0;h<i;++h){var p=e[h];-1!==a.indexOf(p)&&(w(r[p])?r[p]=r[p].filter(function(e){return 0<=n.indexOf(e)}):r[p]=n.slice())}}return r}(s,i),h={};for(n=0;n<i.length;n++)for(var p in o=i[n],d)d.hasOwnProperty(p)&&new RegExp("(layout)[^]+(out)[^]+("+p+")[^]+","g").test(o)&&(h[o]=p);for(var f in h)if(h.hasOwnProperty(f)){var m,g=h[f],_=i.indexOf(f),v=d[g],y=v.length;for(m=0;m<y;m++)i.splice(_,0,v[m]);for(_+=y+1,m=y-1;0<=m;m--)i.splice(_,0,"#endif //"+v[m])}var b="#version 300 es",C=!1;for(n=0;n<i.length;n++)/#version/.test(i[n])&&(i[n]=b,C=!0);return C||i.splice(0,0,b),A("EXT_draw_buffers",i),A("EXT_frag_depth",i),T("texture2D","texture",i),T("texture3D","texture",i),T("textureCube","texture",i),T("gl_FragDepthEXT","gl_FragDepth",i),t?T("varying","in",i):(T("attribute","in",i),T("varying","out",i)),function(e){for(var t="",r=e.length,i=0;i<r;++i)t+=e[i]+"\n";return t}(i)}}),define("Shaders/Builtin/Constants/degreesPerRadian",[],function(){"use strict";return"const float czm_degreesPerRadian = 57.29577951308232;\n"}),define("Shaders/Builtin/Constants/depthRange",[],function(){"use strict";return"const czm_depthRangeStruct czm_depthRange = czm_depthRangeStruct(0.0, 1.0);\n"}),define("Shaders/Builtin/Constants/epsilon1",[],function(){"use strict";return"const float czm_epsilon1 = 0.1;\n"}),define("Shaders/Builtin/Constants/epsilon2",[],function(){"use strict";return"const float czm_epsilon2 = 0.01;\n"}),define("Shaders/Builtin/Constants/epsilon3",[],function(){"use strict";return"const float czm_epsilon3 = 0.001;\n"}),define("Shaders/Builtin/Constants/epsilon4",[],function(){"use strict";return"const float czm_epsilon4 = 0.0001;\n"}),define("Shaders/Builtin/Constants/epsilon5",[],function(){"use strict";return"const float czm_epsilon5 = 0.00001;\n"}),define("Shaders/Builtin/Constants/epsilon6",[],function(){"use strict";return"const float czm_epsilon6 = 0.000001;\n"}),define("Shaders/Builtin/Constants/epsilon7",[],function(){"use strict";return"const float czm_epsilon7 = 0.0000001;\n"}),define("Shaders/Builtin/Constants/infinity",[],function(){"use strict";return"const float czm_infinity = 5906376272000.0;\n"}),define("Shaders/Builtin/Constants/maxClippingPlanes",[],function(){"use strict";return"const int czm_maxClippingPlanes = 6;\n"}),define("Shaders/Builtin/Constants/oneOverPi",[],function(){"use strict";return"const float czm_oneOverPi = 0.3183098861837907;\n"}),define("Shaders/Builtin/Constants/oneOverTwoPi",[],function(){"use strict";return"const float czm_oneOverTwoPi = 0.15915494309189535;\n"}),define("Shaders/Builtin/Constants/passCesium3DTile",[],function(){"use strict";return"const float czm_passCesium3DTile = 4.0;\n"}),define("Shaders/Builtin/Constants/passCesium3DTileClassification",[],function(){"use strict";return"const float czm_passCesium3DTileClassification = 5.0;\n"}),define("Shaders/Builtin/Constants/passCesium3DTileClassificationIgnoreShow",[],function(){"use strict";return"const float czm_passCesium3DTileClassificationIgnoreShow = 6.0;\n"}),define("Shaders/Builtin/Constants/passClassification",[],function(){"use strict";return"const float czm_passClassification = 7.0;\n"}),define("Shaders/Builtin/Constants/passCompute",[],function(){"use strict";return"const float czm_passCompute = 1.0;\n"}),define("Shaders/Builtin/Constants/passEnvironment",[],function(){"use strict";return"const float czm_passEnvironment = 0.0;\n"}),define("Shaders/Builtin/Constants/passGlobe",[],function(){"use strict";return"const float czm_passGlobe = 2.0;\n"}),define("Shaders/Builtin/Constants/passOpaque",[],function(){"use strict";return"const float czm_passOpaque = 8.0;\n"}),define("Shaders/Builtin/Constants/passOverlay",[],function(){"use strict";return"const float czm_passOverlay = 10.0;\n"}),define("Shaders/Builtin/Constants/passTerrainClassification",[],function(){"use strict";return"const float czm_passTerrainClassification = 3.0;\n"}),define("Shaders/Builtin/Constants/passTranslucent",[],function(){"use strict";return"const float czm_passTranslucent = 9.0;\n"}),define("Shaders/Builtin/Constants/pi",[],function(){"use strict";return"const float czm_pi = 3.141592653589793;\n"}),define("Shaders/Builtin/Constants/piOverFour",[],function(){"use strict";return"const float czm_piOverFour = 0.7853981633974483;\n"}),define("Shaders/Builtin/Constants/piOverSix",[],function(){"use strict";return"const float czm_piOverSix = 0.5235987755982988;\n"}),define("Shaders/Builtin/Constants/piOverThree",[],function(){"use strict";return"const float czm_piOverThree = 1.0471975511965976;\n"}),define("Shaders/Builtin/Constants/piOverTwo",[],function(){"use strict";return"const float czm_piOverTwo = 1.5707963267948966;\n"}),define("Shaders/Builtin/Constants/radiansPerDegree",[],function(){"use strict";return"const float czm_radiansPerDegree = 0.017453292519943295;\n"}),define("Shaders/Builtin/Constants/sceneMode2D",[],function(){"use strict";return"const float czm_sceneMode2D = 2.0;\n"}),define("Shaders/Builtin/Constants/sceneMode3D",[],function(){"use strict";return"const float czm_sceneMode3D = 3.0;\n"}),define("Shaders/Builtin/Constants/sceneModeColumbusView",[],function(){"use strict";return"const float czm_sceneModeColumbusView = 1.0;\n"}),define("Shaders/Builtin/Constants/sceneModeMorphing",[],function(){"use strict";return"const float czm_sceneModeMorphing = 0.0;\n"}),define("Shaders/Builtin/Constants/solarRadius",[],function(){"use strict";return"const float czm_solarRadius = 695500000.0;\n"}),define("Shaders/Builtin/Constants/threePiOver2",[],function(){"use strict";return"const float czm_threePiOver2 = 4.71238898038469;\n"}),define("Shaders/Builtin/Constants/twoPi",[],function(){"use strict";return"const float czm_twoPi = 6.283185307179586;\n"}),define("Shaders/Builtin/Constants/webMercatorMaxLatitude",[],function(){"use strict";return"const float czm_webMercatorMaxLatitude = 1.4844222297453324;\n"}),define("Shaders/Builtin/Structs/depthRangeStruct",[],function(){"use strict";return"struct czm_depthRangeStruct\n{\nfloat near;\nfloat far;\n};\n"}),define("Shaders/Builtin/Structs/ellipsoid",[],function(){"use strict";return"struct czm_ellipsoid\n{\nvec3 center;\nvec3 radii;\nvec3 inverseRadii;\nvec3 inverseRadiiSquared;\n};\n"}),define("Shaders/Builtin/Structs/material",[],function(){"use strict";return"struct czm_material\n{\nvec3 diffuse;\nfloat specular;\nfloat shininess;\nvec3 normal;\nvec3 emission;\nfloat alpha;\n};\n"}),define("Shaders/Builtin/Structs/materialInput",[],function(){"use strict";return"struct czm_materialInput\n{\nfloat s;\nvec2 st;\nvec3 str;\nvec3 normalEC;\nmat3 tangentToEyeMatrix;\nvec3 positionToEyeEC;\nfloat height;\nfloat slope;\n};\n"}),define("Shaders/Builtin/Structs/ray",[],function(){"use strict";return"struct czm_ray\n{\nvec3 origin;\nvec3 direction;\n};\n"}),define("Shaders/Builtin/Structs/raySegment",[],function(){"use strict";return"struct czm_raySegment\n{\nfloat start;\nfloat stop;\n};\nconst czm_raySegment czm_emptyRaySegment = czm_raySegment(-czm_infinity, -czm_infinity);\nconst czm_raySegment czm_fullRaySegment = czm_raySegment(0.0, czm_infinity);\n"}),define("Shaders/Builtin/Structs/shadowParameters",[],function(){"use strict";return"struct czm_shadowParameters\n{\n#ifdef USE_CUBE_MAP_SHADOW\nvec3 texCoords;\n#else\nvec2 texCoords;\n#endif\nfloat depthBias;\nfloat depth;\nfloat nDotL;\nvec2 texelStepSize;\nfloat normalShadingSmooth;\nfloat darkness;\n};\n"}),define("Shaders/Builtin/Functions/alphaWeight",[],function(){"use strict";return"float czm_alphaWeight(float a)\n{\nfloat x = 2.0 * (gl_FragCoord.x - czm_viewport.x) / czm_viewport.z - 1.0;\nfloat y = 2.0 * (gl_FragCoord.y - czm_viewport.y) / czm_viewport.w - 1.0;\nfloat z = (gl_FragCoord.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];\nvec4 q = vec4(x, y, z, 0.0);\nq /= gl_FragCoord.w;\nif (czm_inverseProjection != mat4(0.0)) {\nq = czm_inverseProjection * q;\n} else {\nfloat top = czm_frustumPlanes.x;\nfloat bottom = czm_frustumPlanes.y;\nfloat left = czm_frustumPlanes.z;\nfloat right = czm_frustumPlanes.w;\nfloat near = czm_currentFrustum.x;\nfloat far = czm_currentFrustum.y;\nq.x = (q.x * (right - left) + left + right) * 0.5;\nq.y = (q.y * (top - bottom) + bottom + top) * 0.5;\nq.z = (q.z * (near - far) - near - far) * 0.5;\nq.w = 1.0;\n}\nreturn pow(a + 0.01, 4.0) + max(1e-2, min(3.0 * 1e3, 100.0 / (1e-5 + pow(abs(z) / 10.0, 3.0) + pow(abs(z) / 200.0, 6.0))));\n}\n"}),define("Shaders/Builtin/Functions/antialias",[],function(){"use strict";return"vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist, float fuzzFactor)\n{\nfloat val1 = clamp(dist / fuzzFactor, 0.0, 1.0);\nfloat val2 = clamp((dist - 0.5) / fuzzFactor, 0.0, 1.0);\nval1 = val1 * (1.0 - val2);\nval1 = val1 * val1 * (3.0 - (2.0 * val1));\nval1 = pow(val1, 0.5);\nvec4 midColor = (color1 + color2) * 0.5;\nreturn mix(midColor, currentColor, val1);\n}\nvec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist)\n{\nreturn czm_antialias(color1, color2, currentColor, dist, 0.1);\n}\n"}),define("Shaders/Builtin/Functions/cascadeColor",[],function(){"use strict";return"vec4 czm_cascadeColor(vec4 weights)\n{\nreturn vec4(1.0, 0.0, 0.0, 1.0) * weights.x +\nvec4(0.0, 1.0, 0.0, 1.0) * weights.y +\nvec4(0.0, 0.0, 1.0, 1.0) * weights.z +\nvec4(1.0, 0.0, 1.0, 1.0) * weights.w;\n}\n"}),define("Shaders/Builtin/Functions/cascadeDistance",[],function(){"use strict";return"uniform vec4 shadowMap_cascadeDistances;\nfloat czm_cascadeDistance(vec4 weights)\n{\nreturn dot(shadowMap_cascadeDistances, weights);\n}\n"}),define("Shaders/Builtin/Functions/cascadeMatrix",[],function(){"use strict";return"uniform mat4 shadowMap_cascadeMatrices[4];\nmat4 czm_cascadeMatrix(vec4 weights)\n{\nreturn shadowMap_cascadeMatrices[0] * weights.x +\nshadowMap_cascadeMatrices[1] * weights.y +\nshadowMap_cascadeMatrices[2] * weights.z +\nshadowMap_cascadeMatrices[3] * weights.w;\n}\n"}),define("Shaders/Builtin/Functions/cascadeWeights",[],function(){"use strict";return"uniform vec4 shadowMap_cascadeSplits[2];\nvec4 czm_cascadeWeights(float depthEye)\n{\nvec4 near = step(shadowMap_cascadeSplits[0], vec4(depthEye));\nvec4 far = step(depthEye, shadowMap_cascadeSplits[1]);\nreturn near * far;\n}\n"}),define("Shaders/Builtin/Functions/columbusViewMorph",[],function(){"use strict";return"vec4 czm_columbusViewMorph(vec4 position2D, vec4 position3D, float time)\n{\nvec3 p = mix(position2D.xyz, position3D.xyz, time);\nreturn vec4(p, 1.0);\n}\n"}),define("Shaders/Builtin/Functions/computePosition",[],function(){"use strict";return"vec4 czm_computePosition();\n"}),define("Shaders/Builtin/Functions/cosineAndSine",[],function(){"use strict";return"vec2 cordic(float angle)\n{\nvec2 vector = vec2(6.0725293500888267e-1, 0.0);\nfloat sense = (angle < 0.0) ? -1.0 : 1.0;\nmat2 rotation = mat2(1.0, sense, -sense, 1.0);\nvector = rotation * vector;\nangle -= sense * 7.8539816339744828e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfloat factor = sense * 5.0e-1;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 4.6364760900080609e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 2.5e-1;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 2.4497866312686414e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.25e-1;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.2435499454676144e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 6.25e-2;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 6.2418809995957350e-2;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.125e-2;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.1239833430268277e-2;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.5625e-2;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.5623728620476831e-2;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 7.8125e-3;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 7.8123410601011111e-3;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.90625e-3;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.9062301319669718e-3;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.953125e-3;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.9531225164788188e-3;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 9.765625e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 9.7656218955931946e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 4.8828125e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 4.8828121119489829e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 2.44140625e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 2.4414062014936177e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.220703125e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.2207031189367021e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 6.103515625e-5;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 6.1035156174208773e-5;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.0517578125e-5;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.0517578115526096e-5;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.52587890625e-5;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.5258789061315762e-5;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 7.62939453125e-6;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 7.6293945311019700e-6;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.814697265625e-6;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.8146972656064961e-6;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.9073486328125e-6;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.9073486328101870e-6;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 9.5367431640625e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 9.5367431640596084e-7;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 4.76837158203125e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 4.7683715820308884e-7;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 2.384185791015625e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 2.3841857910155797e-7;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.1920928955078125e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nreturn vector;\n}\nvec2 czm_cosineAndSine(float angle)\n{\nif (angle < -czm_piOverTwo || angle > czm_piOverTwo)\n{\nif (angle < 0.0)\n{\nreturn -cordic(angle + czm_pi);\n}\nelse\n{\nreturn -cordic(angle - czm_pi);\n}\n}\nelse\n{\nreturn cordic(angle);\n}\n}\n"}),define("Shaders/Builtin/Functions/decompressTextureCoordinates",[],function(){"use strict";return"vec2 czm_decompressTextureCoordinates(float encoded)\n{\nfloat temp = encoded / 4096.0;\nfloat xZeroTo4095 = floor(temp);\nfloat stx = xZeroTo4095 / 4095.0;\nfloat sty = (encoded - xZeroTo4095 * 4096.0) / 4095.0;\nreturn vec2(stx, sty);\n}\n"}),define("Shaders/Builtin/Functions/depthClampFarPlane",[],function(){"use strict";return"varying float v_WindowZ;\nvec4 czm_depthClampFarPlane(vec4 coords)\n{\nv_WindowZ = (0.5 * (coords.z / coords.w) + 0.5) * coords.w;\ncoords.z = min(coords.z, coords.w);\nreturn coords;\n}\n"}),define("Shaders/Builtin/Functions/discardIfClippedWithIntersect",[],function(){"use strict";return"float czm_discardIfClippedWithIntersect(vec4 clippingPlanes[czm_maxClippingPlanes], int clippingPlanesLength)\n{\nif (clippingPlanesLength > 0)\n{\nbool clipped = true;\nvec4 position = czm_windowToEyeCoordinates(gl_FragCoord);\nvec3 clipNormal = vec3(0.0);\nvec3 clipPosition = vec3(0.0);\nfloat clipAmount = 0.0;\nfloat pixelWidth = czm_metersPerPixel(position);\nfor (int i = 0; i < czm_maxClippingPlanes; ++i)\n{\nif (i == clippingPlanesLength)\n{\nbreak;\n}\nclipNormal = clippingPlanes[i].xyz;\nclipPosition = -clippingPlanes[i].w * clipNormal;\nfloat amount = dot(clipNormal, (position.xyz - clipPosition)) / pixelWidth;\nclipAmount = max(amount, clipAmount);\nclipped = clipped && (amount <= 0.0);\n}\nif (clipped)\n{\ndiscard;\n}\nreturn clipAmount;\n}\nreturn 0.0;\n}\n"}),define("Shaders/Builtin/Functions/discardIfClippedWithUnion",[],function(){"use strict";return"float czm_discardIfClippedWithUnion(vec4 clippingPlanes[czm_maxClippingPlanes], int clippingPlanesLength)\n{\nif (clippingPlanesLength > 0)\n{\nvec4 position = czm_windowToEyeCoordinates(gl_FragCoord);\nvec3 clipNormal = vec3(0.0);\nvec3 clipPosition = vec3(0.0);\nfloat clipAmount = 0.0;\nfloat pixelWidth = czm_metersPerPixel(position);\nfor (int i = 0; i < czm_maxClippingPlanes; ++i)\n{\nif (i == clippingPlanesLength)\n{\nbreak;\n}\nclipNormal = clippingPlanes[i].xyz;\nclipPosition = -clippingPlanes[i].w * clipNormal;\nfloat amount = dot(clipNormal, (position.xyz - clipPosition)) / pixelWidth;\nclipAmount = max(amount, clipAmount);\nif (amount <= 0.0)\n{\ndiscard;\n}\n}\nreturn clipAmount;\n}\nreturn 0.0;\n}\n"}),define("Shaders/Builtin/Functions/eastNorthUpToEyeCoordinates",[],function(){"use strict";return"mat3 czm_eastNorthUpToEyeCoordinates(vec3 positionMC, vec3 normalEC)\n{\nvec3 tangentMC = normalize(vec3(-positionMC.y, positionMC.x, 0.0));\nvec3 tangentEC = normalize(czm_normal3D * tangentMC);\nvec3 bitangentEC = normalize(cross(normalEC, tangentEC));\nreturn mat3(\ntangentEC.x,   tangentEC.y,   tangentEC.z,\nbitangentEC.x, bitangentEC.y, bitangentEC.z,\nnormalEC.x,    normalEC.y,    normalEC.z);\n}\n"}),define("Shaders/Builtin/Functions/ellipsoidContainsPoint",[],function(){"use strict";return"bool czm_ellipsoidContainsPoint(czm_ellipsoid ellipsoid, vec3 point)\n{\nvec3 scaled = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(point, 1.0)).xyz;\nreturn (dot(scaled, scaled) <= 1.0);\n}\n"}),define("Shaders/Builtin/Functions/ellipsoidNew",[],function(){"use strict";return"czm_ellipsoid czm_ellipsoidNew(vec3 center, vec3 radii)\n{\nvec3 inverseRadii = vec3(1.0 / radii.x, 1.0 / radii.y, 1.0 / radii.z);\nvec3 inverseRadiiSquared = inverseRadii * inverseRadii;\nczm_ellipsoid temp = czm_ellipsoid(center, radii, inverseRadii, inverseRadiiSquared);\nreturn temp;\n}\n"}),define("Shaders/Builtin/Functions/ellipsoidWgs84TextureCoordinates",[],function(){"use strict";return"vec2 czm_ellipsoidWgs84TextureCoordinates(vec3 normal)\n{\nreturn vec2(atan(normal.y, normal.x) * czm_oneOverTwoPi + 0.5, asin(normal.z) * czm_oneOverPi + 0.5);\n}\n"}),define("Shaders/Builtin/Functions/equalsEpsilon",[],function(){"use strict";return"bool czm_equalsEpsilon(vec4 left, vec4 right, float epsilon) {\nreturn all(lessThanEqual(abs(left - right), vec4(epsilon)));\n}\nbool czm_equalsEpsilon(vec3 left, vec3 right, float epsilon) {\nreturn all(lessThanEqual(abs(left - right), vec3(epsilon)));\n}\nbool czm_equalsEpsilon(vec2 left, vec2 right, float epsilon) {\nreturn all(lessThanEqual(abs(left - right), vec2(epsilon)));\n}\nbool czm_equalsEpsilon(float left, float right, float epsilon) {\nreturn (abs(left - right) <= epsilon);\n}\n"}),define("Shaders/Builtin/Functions/eyeOffset",[],function(){"use strict";return"vec4 czm_eyeOffset(vec4 positionEC, vec3 eyeOffset)\n{\nvec4 p = positionEC;\nvec4 zEyeOffset = normalize(p) * eyeOffset.z;\np.xy += eyeOffset.xy + zEyeOffset.xy;\np.z += zEyeOffset.z;\nreturn p;\n}\n"}),define("Shaders/Builtin/Functions/eyeToWindowCoordinates",[],function(){"use strict";return"vec4 czm_eyeToWindowCoordinates(vec4 positionEC)\n{\nvec4 q = czm_projection * positionEC;\nq.xyz /= q.w;\nq.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz;\nreturn q;\n}\n"}),define("Shaders/Builtin/Functions/fog",[],function(){"use strict";return"vec3 czm_fog(float distanceToCamera, vec3 color, vec3 fogColor)\n{\nfloat scalar = distanceToCamera * czm_fogDensity;\nfloat fog = 1.0 - exp(-(scalar * scalar));\nreturn mix(color, fogColor, fog);\n}\n"}),define("Shaders/Builtin/Functions/geodeticSurfaceNormal",[],function(){"use strict";return"vec3 czm_geodeticSurfaceNormal(vec3 positionOnEllipsoid, vec3 ellipsoidCenter, vec3 oneOverEllipsoidRadiiSquared)\n{\nreturn normalize((positionOnEllipsoid - ellipsoidCenter) * oneOverEllipsoidRadiiSquared);\n}\n"}),define("Shaders/Builtin/Functions/getDefaultMaterial",[],function(){"use strict";return"czm_material czm_getDefaultMaterial(czm_materialInput materialInput)\n{\nczm_material material;\nmaterial.diffuse = vec3(0.0);\nmaterial.specular = 0.0;\nmaterial.shininess = 1.0;\nmaterial.normal = materialInput.normalEC;\nmaterial.emission = vec3(0.0);\nmaterial.alpha = 1.0;\nreturn material;\n}\n"}),define("Shaders/Builtin/Functions/getLambertDiffuse",[],function(){"use strict";return"float czm_getLambertDiffuse(vec3 lightDirectionEC, vec3 normalEC)\n{\nreturn max(dot(lightDirectionEC, normalEC), 0.0);\n}\n"}),define("Shaders/Builtin/Functions/getSpecular",[],function(){"use strict";return"float czm_getSpecular(vec3 lightDirectionEC, vec3 toEyeEC, vec3 normalEC, float shininess)\n{\nvec3 toReflectedLight = reflect(-lightDirectionEC, normalEC);\nfloat specular = max(dot(toReflectedLight, toEyeEC), 0.0);\nreturn pow(specular, max(shininess, czm_epsilon2));\n}\n"}),define("Shaders/Builtin/Functions/getWaterNoise",[],function(){"use strict";return"vec4 czm_getWaterNoise(sampler2D normalMap, vec2 uv, float time, float angleInRadians)\n{\nfloat cosAngle = cos(angleInRadians);\nfloat sinAngle = sin(angleInRadians);\nvec2 s0 = vec2(1.0/17.0, 0.0);\nvec2 s1 = vec2(-1.0/29.0, 0.0);\nvec2 s2 = vec2(1.0/101.0, 1.0/59.0);\nvec2 s3 = vec2(-1.0/109.0, -1.0/57.0);\ns0 = vec2((cosAngle * s0.x) - (sinAngle * s0.y), (sinAngle * s0.x) + (cosAngle * s0.y));\ns1 = vec2((cosAngle * s1.x) - (sinAngle * s1.y), (sinAngle * s1.x) + (cosAngle * s1.y));\ns2 = vec2((cosAngle * s2.x) - (sinAngle * s2.y), (sinAngle * s2.x) + (cosAngle * s2.y));\ns3 = vec2((cosAngle * s3.x) - (sinAngle * s3.y), (sinAngle * s3.x) + (cosAngle * s3.y));\nvec2 uv0 = (uv/103.0) + (time * s0);\nvec2 uv1 = uv/107.0 + (time * s1) + vec2(0.23);\nvec2 uv2 = uv/vec2(897.0, 983.0) + (time * s2) + vec2(0.51);\nvec2 uv3 = uv/vec2(991.0, 877.0) + (time * s3) + vec2(0.71);\nuv0 = fract(uv0);\nuv1 = fract(uv1);\nuv2 = fract(uv2);\nuv3 = fract(uv3);\nvec4 noise = (texture2D(normalMap, uv0)) +\n(texture2D(normalMap, uv1)) +\n(texture2D(normalMap, uv2)) +\n(texture2D(normalMap, uv3));\nreturn ((noise / 4.0) - 0.5) * 2.0;\n}\n"}),define("Shaders/Builtin/Functions/getWgs84EllipsoidEC",[],function(){"use strict";return"czm_ellipsoid czm_getWgs84EllipsoidEC()\n{\nvec3 radii = vec3(6378137.0, 6378137.0, 6356752.314245);\nvec3 inverseRadii = vec3(1.0 / radii.x, 1.0 / radii.y, 1.0 / radii.z);\nvec3 inverseRadiiSquared = inverseRadii * inverseRadii;\nczm_ellipsoid temp = czm_ellipsoid(czm_view[3].xyz, radii, inverseRadii, inverseRadiiSquared);\nreturn temp;\n}\n"}),define("Shaders/Builtin/Functions/HSBToRGB",[],function(){"use strict";return"const vec4 K_HSB2RGB = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 czm_HSBToRGB(vec3 hsb)\n{\nvec3 p = abs(fract(hsb.xxx + K_HSB2RGB.xyz) * 6.0 - K_HSB2RGB.www);\nreturn hsb.z * mix(K_HSB2RGB.xxx, clamp(p - K_HSB2RGB.xxx, 0.0, 1.0), hsb.y);\n}\n"}),define("Shaders/Builtin/Functions/HSLToRGB",[],function(){"use strict";return"vec3 hueToRGB(float hue)\n{\nfloat r = abs(hue * 6.0 - 3.0) - 1.0;\nfloat g = 2.0 - abs(hue * 6.0 - 2.0);\nfloat b = 2.0 - abs(hue * 6.0 - 4.0);\nreturn clamp(vec3(r, g, b), 0.0, 1.0);\n}\nvec3 czm_HSLToRGB(vec3 hsl)\n{\nvec3 rgb = hueToRGB(hsl.x);\nfloat c = (1.0 - abs(2.0 * hsl.z - 1.0)) * hsl.y;\nreturn (rgb - 0.5) * c + hsl.z;\n}\n"}),define("Shaders/Builtin/Functions/hue",[],function(){"use strict";return"vec3 czm_hue(vec3 rgb, float adjustment)\n{\nconst mat3 toYIQ = mat3(0.299,     0.587,     0.114,\n0.595716, -0.274453, -0.321263,\n0.211456, -0.522591,  0.311135);\nconst mat3 toRGB = mat3(1.0,  0.9563,  0.6210,\n1.0, -0.2721, -0.6474,\n1.0, -1.107,   1.7046);\nvec3 yiq = toYIQ * rgb;\nfloat hue = atan(yiq.z, yiq.y) + adjustment;\nfloat chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);\nvec3 color = vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));\nreturn toRGB * color;\n}\n"}),define("Shaders/Builtin/Functions/isEmpty",[],function(){"use strict";return"bool czm_isEmpty(czm_raySegment interval)\n{\nreturn (interval.stop < 0.0);\n}\n"}),define("Shaders/Builtin/Functions/isFull",[],function(){"use strict";return"bool czm_isFull(czm_raySegment interval)\n{\nreturn (interval.start == 0.0 && interval.stop == czm_infinity);\n}\n"}),define("Shaders/Builtin/Functions/latitudeToWebMercatorFraction",[],function(){"use strict";return"float czm_latitudeToWebMercatorFraction(float latitude, float southMercatorY, float oneOverMercatorHeight)\n{\nfloat sinLatitude = sin(latitude);\nfloat mercatorY = 0.5 * log((1.0 + sinLatitude) / (1.0 - sinLatitude));\nreturn (mercatorY - southMercatorY) * oneOverMercatorHeight;\n}\n"}),define("Shaders/Builtin/Functions/luminance",[],function(){"use strict";return"float czm_luminance(vec3 rgb)\n{\nconst vec3 W = vec3(0.2125, 0.7154, 0.0721);\nreturn dot(rgb, W);\n}\n"}),define("Shaders/Builtin/Functions/metersPerPixel",[],function(){"use strict";return"float czm_metersPerPixel(vec4 positionEC)\n{\nfloat width = czm_viewport.z;\nfloat height = czm_viewport.w;\nfloat pixelWidth;\nfloat pixelHeight;\nfloat top = czm_frustumPlanes.x;\nfloat bottom = czm_frustumPlanes.y;\nfloat left = czm_frustumPlanes.z;\nfloat right = czm_frustumPlanes.w;\nif (czm_sceneMode == czm_sceneMode2D)\n{\nfloat frustumWidth = right - left;\nfloat frustumHeight = top - bottom;\npixelWidth = frustumWidth / width;\npixelHeight = frustumHeight / height;\n}\nelse\n{\nfloat distanceToPixel = -positionEC.z;\nfloat inverseNear = 1.0 / czm_currentFrustum.x;\nfloat tanTheta = top * inverseNear;\npixelHeight = 2.0 * distanceToPixel * tanTheta / height;\ntanTheta = right * inverseNear;\npixelWidth = 2.0 * distanceToPixel * tanTheta / width;\n}\nreturn max(pixelWidth, pixelHeight);\n}\n"}),define("Shaders/Builtin/Functions/modelToWindowCoordinates",[],function(){"use strict";return"vec4 czm_modelToWindowCoordinates(vec4 position)\n{\nvec4 q = czm_modelViewProjection * position;\nq.xyz /= q.w;\nq.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz;\nreturn q;\n}\n"}),define("Shaders/Builtin/Functions/multiplyWithColorBalance",[],function(){"use strict";return"vec3 czm_multiplyWithColorBalance(vec3 left, vec3 right)\n{\nconst vec3 W = vec3(0.2125, 0.7154, 0.0721);\nvec3 target = left * right;\nfloat leftLuminance = dot(left, W);\nfloat rightLuminance = dot(right, W);\nfloat targetLuminance = dot(target, W);\nreturn ((leftLuminance + rightLuminance) / (2.0 * targetLuminance)) * target;\n}\n"}),define("Shaders/Builtin/Functions/nearFarScalar",[],function(){"use strict";return"float czm_nearFarScalar(vec4 nearFarScalar, float cameraDistSq)\n{\nfloat valueAtMin = nearFarScalar.y;\nfloat valueAtMax = nearFarScalar.w;\nfloat nearDistanceSq = nearFarScalar.x * nearFarScalar.x;\nfloat farDistanceSq = nearFarScalar.z * nearFarScalar.z;\nfloat t = (cameraDistSq - nearDistanceSq) / (farDistanceSq - nearDistanceSq);\nt = pow(clamp(t, 0.0, 1.0), 0.2);\nreturn mix(valueAtMin, valueAtMax, t);\n}\n"}),define("Shaders/Builtin/Functions/octDecode",[],function(){"use strict";return"vec3 czm_octDecode(vec2 encoded, float range)\n{\nif (encoded.x == 0.0 && encoded.y == 0.0) {\nreturn vec3(0.0, 0.0, 0.0);\n}\nencoded = encoded / range * 2.0 - 1.0;\nvec3 v = vec3(encoded.x, encoded.y, 1.0 - abs(encoded.x) - abs(encoded.y));\nif (v.z < 0.0)\n{\nv.xy = (1.0 - abs(v.yx)) * czm_signNotZero(v.xy);\n}\nreturn normalize(v);\n}\nvec3 czm_octDecode(vec2 encoded)\n{\nreturn czm_octDecode(encoded, 255.0);\n}\nvec3 czm_octDecode(float encoded)\n{\nfloat temp = encoded / 256.0;\nfloat x = floor(temp);\nfloat y = (temp - x) * 256.0;\nreturn czm_octDecode(vec2(x, y));\n}\nvoid czm_octDecode(vec2 encoded, out vec3 vector1, out vec3 vector2, out vec3 vector3)\n{\nfloat temp = encoded.x / 65536.0;\nfloat x = floor(temp);\nfloat encodedFloat1 = (temp - x) * 65536.0;\ntemp = encoded.y / 65536.0;\nfloat y = floor(temp);\nfloat encodedFloat2 = (temp - y) * 65536.0;\nvector1 = czm_octDecode(encodedFloat1);\nvector2 = czm_octDecode(encodedFloat2);\nvector3 = czm_octDecode(vec2(x, y));\n}\n"}),define("Shaders/Builtin/Functions/packDepth",[],function(){"use strict";return"vec4 czm_packDepth(float depth)\n{\nvec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * depth;\nenc = fract(enc);\nenc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);\nreturn enc;\n}\n"}),define("Shaders/Builtin/Functions/phong",[],function(){"use strict";return"float czm_private_getLambertDiffuseOfMaterial(vec3 lightDirectionEC, czm_material material)\n{\nreturn czm_getLambertDiffuse(lightDirectionEC, material.normal);\n}\nfloat czm_private_getSpecularOfMaterial(vec3 lightDirectionEC, vec3 toEyeEC, czm_material material)\n{\nreturn czm_getSpecular(lightDirectionEC, toEyeEC, material.normal, material.shininess);\n}\nvec4 czm_phong(vec3 toEye, czm_material material)\n{\nfloat diffuse = czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 0.0, 1.0), material);\nif (czm_sceneMode == czm_sceneMode3D) {\ndiffuse += czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 1.0, 0.0), material);\n}\nfloat specular = czm_private_getSpecularOfMaterial(czm_sunDirectionEC, toEye, material) + czm_private_getSpecularOfMaterial(czm_moonDirectionEC, toEye, material);\nvec3 materialDiffuse = material.diffuse * 0.5;\nvec3 ambient = materialDiffuse;\nvec3 color = ambient + material.emission;\ncolor += materialDiffuse * diffuse;\ncolor += material.specular * specular;\nreturn vec4(color, material.alpha);\n}\nvec4 czm_private_phong(vec3 toEye, czm_material material)\n{\nfloat diffuse = czm_private_getLambertDiffuseOfMaterial(czm_sunDirectionEC, material);\nfloat specular = czm_private_getSpecularOfMaterial(czm_sunDirectionEC, toEye, material);\nvec3 ambient = vec3(0.0);\nvec3 color = ambient + material.emission;\ncolor += material.diffuse * diffuse;\ncolor += material.specular * specular;\nreturn vec4(color, material.alpha);\n}\n"}),define("Shaders/Builtin/Functions/pointAlongRay",[],function(){"use strict";return"vec3 czm_pointAlongRay(czm_ray ray, float time)\n{\nreturn ray.origin + (time * ray.direction);\n}\n"}),define("Shaders/Builtin/Functions/rayEllipsoidIntersectionInterval",[],function(){"use strict";return"czm_raySegment czm_rayEllipsoidIntersectionInterval(czm_ray ray, czm_ellipsoid ellipsoid)\n{\nvec3 q = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ray.origin, 1.0)).xyz;\nvec3 w = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ray.direction, 0.0)).xyz;\nq = q - ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ellipsoid.center, 1.0)).xyz;\nfloat q2 = dot(q, q);\nfloat qw = dot(q, w);\nif (q2 > 1.0)\n{\nif (qw >= 0.0)\n{\nreturn czm_emptyRaySegment;\n}\nelse\n{\nfloat qw2 = qw * qw;\nfloat difference = q2 - 1.0;\nfloat w2 = dot(w, w);\nfloat product = w2 * difference;\nif (qw2 < product)\n{\nreturn czm_emptyRaySegment;\n}\nelse if (qw2 > product)\n{\nfloat discriminant = qw * qw - product;\nfloat temp = -qw + sqrt(discriminant);\nfloat root0 = temp / w2;\nfloat root1 = difference / temp;\nif (root0 < root1)\n{\nczm_raySegment i = czm_raySegment(root0, root1);\nreturn i;\n}\nelse\n{\nczm_raySegment i = czm_raySegment(root1, root0);\nreturn i;\n}\n}\nelse\n{\nfloat root = sqrt(difference / w2);\nczm_raySegment i = czm_raySegment(root, root);\nreturn i;\n}\n}\n}\nelse if (q2 < 1.0)\n{\nfloat difference = q2 - 1.0;\nfloat w2 = dot(w, w);\nfloat product = w2 * difference;\nfloat discriminant = qw * qw - product;\nfloat temp = -qw + sqrt(discriminant);\nczm_raySegment i = czm_raySegment(0.0, temp / w2);\nreturn i;\n}\nelse\n{\nif (qw < 0.0)\n{\nfloat w2 = dot(w, w);\nczm_raySegment i = czm_raySegment(0.0, -qw / w2);\nreturn i;\n}\nelse\n{\nreturn czm_emptyRaySegment;\n}\n}\n}\n"}),define("Shaders/Builtin/Functions/RGBToHSB",[],function(){"use strict";return"const vec4 K_RGB2HSB = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec3 czm_RGBToHSB(vec3 rgb)\n{\nvec4 p = mix(vec4(rgb.bg, K_RGB2HSB.wz), vec4(rgb.gb, K_RGB2HSB.xy), step(rgb.b, rgb.g));\nvec4 q = mix(vec4(p.xyw, rgb.r), vec4(rgb.r, p.yzx), step(p.x, rgb.r));\nfloat d = q.x - min(q.w, q.y);\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + czm_epsilon7)), d / (q.x + czm_epsilon7), q.x);\n}\n"}),define("Shaders/Builtin/Functions/RGBToHSL",[],function(){"use strict";return"vec3 RGBtoHCV(vec3 rgb)\n{\nvec4 p = (rgb.g < rgb.b) ? vec4(rgb.bg, -1.0, 2.0 / 3.0) : vec4(rgb.gb, 0.0, -1.0 / 3.0);\nvec4 q = (rgb.r < p.x) ? vec4(p.xyw, rgb.r) : vec4(rgb.r, p.yzx);\nfloat c = q.x - min(q.w, q.y);\nfloat h = abs((q.w - q.y) / (6.0 * c + czm_epsilon7) + q.z);\nreturn vec3(h, c, q.x);\n}\nvec3 czm_RGBToHSL(vec3 rgb)\n{\nvec3 hcv = RGBtoHCV(rgb);\nfloat l = hcv.z - hcv.y * 0.5;\nfloat s = hcv.y / (1.0 - abs(l * 2.0 - 1.0) + czm_epsilon7);\nreturn vec3(hcv.x, s, l);\n}\n"}),define("Shaders/Builtin/Functions/RGBToXYZ",[],function(){"use strict";return"vec3 czm_RGBToXYZ(vec3 rgb)\n{\nconst mat3 RGB2XYZ = mat3(0.4124, 0.2126, 0.0193,\n0.3576, 0.7152, 0.1192,\n0.1805, 0.0722, 0.9505);\nvec3 xyz = RGB2XYZ * rgb;\nvec3 Yxy;\nYxy.r = xyz.g;\nfloat temp = dot(vec3(1.0), xyz);\nYxy.gb = xyz.rg / temp;\nreturn Yxy;\n}\n"}),define("Shaders/Builtin/Functions/saturation",[],function(){"use strict";return"vec3 czm_saturation(vec3 rgb, float adjustment)\n{\nconst vec3 W = vec3(0.2125, 0.7154, 0.0721);\nvec3 intensity = vec3(dot(rgb, W));\nreturn mix(intensity, rgb, adjustment);\n}\n"}),define("Shaders/Builtin/Functions/shadowDepthCompare",[],function(){"use strict";return"float czm_sampleShadowMap(samplerCube shadowMap, vec3 d)\n{\nreturn czm_unpackDepth(textureCube(shadowMap, d));\n}\nfloat czm_sampleShadowMap(sampler2D shadowMap, vec2 uv)\n{\n#ifdef USE_SHADOW_DEPTH_TEXTURE\nreturn texture2D(shadowMap, uv).r;\n#else\nreturn czm_unpackDepth(texture2D(shadowMap, uv));\n#endif\n}\nfloat czm_shadowDepthCompare(samplerCube shadowMap, vec3 uv, float depth)\n{\nreturn step(depth, czm_sampleShadowMap(shadowMap, uv));\n}\nfloat czm_shadowDepthCompare(sampler2D shadowMap, vec2 uv, float depth)\n{\nreturn step(depth, czm_sampleShadowMap(shadowMap, uv));\n}\n"}),define("Shaders/Builtin/Functions/shadowVisibility",[],function(){"use strict";return"float czm_private_shadowVisibility(float visibility, float nDotL, float normalShadingSmooth, float darkness)\n{\n#ifdef USE_NORMAL_SHADING\n#ifdef USE_NORMAL_SHADING_SMOOTH\nfloat strength = clamp(nDotL / normalShadingSmooth, 0.0, 1.0);\n#else\nfloat strength = step(0.0, nDotL);\n#endif\nvisibility *= strength;\n#endif\nvisibility = max(visibility, darkness);\nreturn visibility;\n}\n#ifdef USE_CUBE_MAP_SHADOW\nfloat czm_shadowVisibility(samplerCube shadowMap, czm_shadowParameters shadowParameters)\n{\nfloat depthBias = shadowParameters.depthBias;\nfloat depth = shadowParameters.depth;\nfloat nDotL = shadowParameters.nDotL;\nfloat normalShadingSmooth = shadowParameters.normalShadingSmooth;\nfloat darkness = shadowParameters.darkness;\nvec3 uvw = shadowParameters.texCoords;\ndepth -= depthBias;\nfloat visibility = czm_shadowDepthCompare(shadowMap, uvw, depth);\nreturn czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);\n}\n#else\nfloat czm_shadowVisibility(sampler2D shadowMap, czm_shadowParameters shadowParameters)\n{\nfloat depthBias = shadowParameters.depthBias;\nfloat depth = shadowParameters.depth;\nfloat nDotL = shadowParameters.nDotL;\nfloat normalShadingSmooth = shadowParameters.normalShadingSmooth;\nfloat darkness = shadowParameters.darkness;\nvec2 uv = shadowParameters.texCoords;\ndepth -= depthBias;\n#ifdef USE_SOFT_SHADOWS\nvec2 texelStepSize = shadowParameters.texelStepSize;\nfloat radius = 1.0;\nfloat dx0 = -texelStepSize.x * radius;\nfloat dy0 = -texelStepSize.y * radius;\nfloat dx1 = texelStepSize.x * radius;\nfloat dy1 = texelStepSize.y * radius;\nfloat visibility = (\nczm_shadowDepthCompare(shadowMap, uv, depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx0, 0.0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx1, 0.0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy1), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy1), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy1), depth)\n) * (1.0 / 9.0);\n#else\nfloat visibility = czm_shadowDepthCompare(shadowMap, uv, depth);\n#endif\nreturn czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);\n}\n#endif\n"}),define("Shaders/Builtin/Functions/signNotZero",[],function(){"use strict";return"float czm_signNotZero(float value)\n{\nreturn value >= 0.0 ? 1.0 : -1.0;\n}\nvec2 czm_signNotZero(vec2 value)\n{\nreturn vec2(czm_signNotZero(value.x), czm_signNotZero(value.y));\n}\nvec3 czm_signNotZero(vec3 value)\n{\nreturn vec3(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z));\n}\nvec4 czm_signNotZero(vec4 value)\n{\nreturn vec4(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z), czm_signNotZero(value.w));\n}\n"}),define("Shaders/Builtin/Functions/tangentToEyeSpaceMatrix",[],function(){"use strict";return"mat3 czm_tangentToEyeSpaceMatrix(vec3 normalEC, vec3 tangentEC, vec3 bitangentEC)\n{\nvec3 normal = normalize(normalEC);\nvec3 tangent = normalize(tangentEC);\nvec3 bitangent = normalize(bitangentEC);\nreturn mat3(tangent.x  , tangent.y  , tangent.z,\nbitangent.x, bitangent.y, bitangent.z,\nnormal.x   , normal.y   , normal.z);\n}\n"}),define("Shaders/Builtin/Functions/translateRelativeToEye",[],function(){"use strict";return"vec4 czm_translateRelativeToEye(vec3 high, vec3 low)\n{\nvec3 highDifference = high - czm_encodedCameraPositionMCHigh;\nvec3 lowDifference = low - czm_encodedCameraPositionMCLow;\nreturn vec4(highDifference + lowDifference, 1.0);\n}\n"}),define("Shaders/Builtin/Functions/translucentPhong",[],function(){"use strict";return"vec4 czm_translucentPhong(vec3 toEye, czm_material material)\n{\nfloat diffuse = czm_getLambertDiffuse(vec3(0.0, 0.0, 1.0), material.normal);\nif (czm_sceneMode == czm_sceneMode3D) {\ndiffuse += czm_getLambertDiffuse(vec3(0.0, 1.0, 0.0), material.normal);\n}\ndiffuse = clamp(diffuse, 0.0, 1.0);\nfloat specular = czm_getSpecular(czm_sunDirectionEC, toEye, material.normal, material.shininess);\nspecular += czm_getSpecular(czm_moonDirectionEC, toEye, material.normal, material.shininess);\nvec3 materialDiffuse = material.diffuse * 0.5;\nvec3 ambient = materialDiffuse;\nvec3 color = ambient + material.emission;\ncolor += materialDiffuse * diffuse;\ncolor += material.specular * specular;\nreturn vec4(color, material.alpha);\n}\n"}),define("Shaders/Builtin/Functions/transpose",[],function(){"use strict";return"mat2 czm_transpose(mat2 matrix)\n{\nreturn mat2(\nmatrix[0][0], matrix[1][0],\nmatrix[0][1], matrix[1][1]);\n}\nmat3 czm_transpose(mat3 matrix)\n{\nreturn mat3(\nmatrix[0][0], matrix[1][0], matrix[2][0],\nmatrix[0][1], matrix[1][1], matrix[2][1],\nmatrix[0][2], matrix[1][2], matrix[2][2]);\n}\nmat4 czm_transpose(mat4 matrix)\n{\nreturn mat4(\nmatrix[0][0], matrix[1][0], matrix[2][0], matrix[3][0],\nmatrix[0][1], matrix[1][1], matrix[2][1], matrix[3][1],\nmatrix[0][2], matrix[1][2], matrix[2][2], matrix[3][2],\nmatrix[0][3], matrix[1][3], matrix[2][3], matrix[3][3]);\n}\n"}),define("Shaders/Builtin/Functions/unpackDepth",[],function(){"use strict";return"float czm_unpackDepth(vec4 packedDepth)\n{\nreturn dot(packedDepth, vec4(1.0, 1.0 / 255.0, 1.0 / 65025.0, 1.0 / 16581375.0));\n}\n"}),define("Shaders/Builtin/Functions/windowToEyeCoordinates",[],function(){"use strict";return"vec4 czm_windowToEyeCoordinates(vec4 fragmentCoordinate)\n{\nfloat x = 2.0 * (fragmentCoordinate.x - czm_viewport.x) / czm_viewport.z - 1.0;\nfloat y = 2.0 * (fragmentCoordinate.y - czm_viewport.y) / czm_viewport.w - 1.0;\nfloat z = (fragmentCoordinate.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];\nvec4 q = vec4(x, y, z, 1.0);\nq /= fragmentCoordinate.w;\nif (czm_inverseProjection != mat4(0.0)) {\nq = czm_inverseProjection * q;\n} else {\nfloat top = czm_frustumPlanes.x;\nfloat bottom = czm_frustumPlanes.y;\nfloat left = czm_frustumPlanes.z;\nfloat right = czm_frustumPlanes.w;\nfloat near = czm_currentFrustum.x;\nfloat far = czm_currentFrustum.y;\nq.x = (q.x * (right - left) + left + right) * 0.5;\nq.y = (q.y * (top - bottom) + bottom + top) * 0.5;\nq.z = (q.z * (near - far) - near - far) * 0.5;\nq.w = 1.0;\n}\nreturn q;\n}\n"}),define("Shaders/Builtin/Functions/writeDepthClampedToFarPlane",[],function(){"use strict";return"varying float v_WindowZ;\nvoid czm_writeDepthClampedToFarPlane()\n{\n#ifdef GL_EXT_frag_depth\ngl_FragDepthEXT = min(v_WindowZ * gl_FragCoord.w, 1.0);\n#endif\n}\n"}),define("Shaders/Builtin/Functions/XYZToRGB",[],function(){"use strict";return"vec3 czm_XYZToRGB(vec3 Yxy)\n{\nconst mat3 XYZ2RGB = mat3( 3.2405, -0.9693,  0.0556,\n-1.5371,  1.8760, -0.2040,\n-0.4985,  0.0416,  1.0572);\nvec3 xyz;\nxyz.r = Yxy.r * Yxy.g / Yxy.b;\nxyz.g = Yxy.r;\nxyz.b = Yxy.r * (1.0 - Yxy.g - Yxy.b) / Yxy.b;\nreturn XYZ2RGB * xyz;\n}\n"}),define("Shaders/Builtin/CzmBuiltins",["./Constants/degreesPerRadian","./Constants/depthRange","./Constants/epsilon1","./Constants/epsilon2","./Constants/epsilon3","./Constants/epsilon4","./Constants/epsilon5","./Constants/epsilon6","./Constants/epsilon7","./Constants/infinity","./Constants/maxClippingPlanes","./Constants/oneOverPi","./Constants/oneOverTwoPi","./Constants/passCesium3DTile","./Constants/passCesium3DTileClassification","./Constants/passCesium3DTileClassificationIgnoreShow","./Constants/passClassification","./Constants/passCompute","./Constants/passEnvironment","./Constants/passGlobe","./Constants/passOpaque","./Constants/passOverlay","./Constants/passTerrainClassification","./Constants/passTranslucent","./Constants/pi","./Constants/piOverFour","./Constants/piOverSix","./Constants/piOverThree","./Constants/piOverTwo","./Constants/radiansPerDegree","./Constants/sceneMode2D","./Constants/sceneMode3D","./Constants/sceneModeColumbusView","./Constants/sceneModeMorphing","./Constants/solarRadius","./Constants/threePiOver2","./Constants/twoPi","./Constants/webMercatorMaxLatitude","./Structs/depthRangeStruct","./Structs/ellipsoid","./Structs/material","./Structs/materialInput","./Structs/ray","./Structs/raySegment","./Structs/shadowParameters","./Functions/alphaWeight","./Functions/antialias","./Functions/cascadeColor","./Functions/cascadeDistance","./Functions/cascadeMatrix","./Functions/cascadeWeights","./Functions/columbusViewMorph","./Functions/computePosition","./Functions/cosineAndSine","./Functions/decompressTextureCoordinates","./Functions/depthClampFarPlane","./Functions/discardIfClippedWithIntersect","./Functions/discardIfClippedWithUnion","./Functions/eastNorthUpToEyeCoordinates","./Functions/ellipsoidContainsPoint","./Functions/ellipsoidNew","./Functions/ellipsoidWgs84TextureCoordinates","./Functions/equalsEpsilon","./Functions/eyeOffset","./Functions/eyeToWindowCoordinates","./Functions/fog","./Functions/geodeticSurfaceNormal","./Functions/getDefaultMaterial","./Functions/getLambertDiffuse","./Functions/getSpecular","./Functions/getWaterNoise","./Functions/getWgs84EllipsoidEC","./Functions/HSBToRGB","./Functions/HSLToRGB","./Functions/hue","./Functions/isEmpty","./Functions/isFull","./Functions/latitudeToWebMercatorFraction","./Functions/luminance","./Functions/metersPerPixel","./Functions/modelToWindowCoordinates","./Functions/multiplyWithColorBalance","./Functions/nearFarScalar","./Functions/octDecode","./Functions/packDepth","./Functions/phong","./Functions/pointAlongRay","./Functions/rayEllipsoidIntersectionInterval","./Functions/RGBToHSB","./Functions/RGBToHSL","./Functions/RGBToXYZ","./Functions/saturation","./Functions/shadowDepthCompare","./Functions/shadowVisibility","./Functions/signNotZero","./Functions/tangentToEyeSpaceMatrix","./Functions/translateRelativeToEye","./Functions/translucentPhong","./Functions/transpose","./Functions/unpackDepth","./Functions/windowToEyeCoordinates","./Functions/writeDepthClampedToFarPlane","./Functions/XYZToRGB"],function(e,t,r,i,n,o,a,s,l,u,c,d,h,p,f,m,g,_,v,y,b,C,w,S,T,E,A,x,P,D,O,I,M,R,L,N,k,F,B,U,V,z,q,G,W,H,j,Y,X,Q,Z,K,J,$,ee,te,re,ie,ne,oe,ae,se,le,ue,ce,de,he,pe,fe,me,ge,_e,ve,ye,be,Ce,we,Se,Te,Ee,Ae,xe,Pe,De,Oe,Ie,Me,Re,Le,Ne,ke,Fe,Be,Ue,Ve,ze,qe,Ge,We,He,je,Ye,Xe){"use strict";return{czm_degreesPerRadian:e,czm_depthRange:t,czm_epsilon1:r,czm_epsilon2:i,czm_epsilon3:n,czm_epsilon4:o,czm_epsilon5:a,czm_epsilon6:s,czm_epsilon7:l,czm_infinity:u,czm_maxClippingPlanes:c,czm_oneOverPi:d,czm_oneOverTwoPi:h,czm_passCesium3DTile:p,czm_passCesium3DTileClassification:f,czm_passCesium3DTileClassificationIgnoreShow:m,czm_passClassification:g,czm_passCompute:_,czm_passEnvironment:v,czm_passGlobe:y,czm_passOpaque:b,czm_passOverlay:C,czm_passTerrainClassification:w,czm_passTranslucent:S,czm_pi:T,czm_piOverFour:E,czm_piOverSix:A,czm_piOverThree:x,czm_piOverTwo:P,czm_radiansPerDegree:D,czm_sceneMode2D:O,czm_sceneMode3D:I,czm_sceneModeColumbusView:M,czm_sceneModeMorphing:R,czm_solarRadius:L,czm_threePiOver2:N,czm_twoPi:k,czm_webMercatorMaxLatitude:F,czm_depthRangeStruct:B,czm_ellipsoid:U,czm_material:V,czm_materialInput:z,czm_ray:q,czm_raySegment:G,czm_shadowParameters:W,czm_alphaWeight:H,czm_antialias:j,czm_cascadeColor:Y,czm_cascadeDistance:X,czm_cascadeMatrix:Q,czm_cascadeWeights:Z,czm_columbusViewMorph:K,czm_computePosition:J,czm_cosineAndSine:$,czm_decompressTextureCoordinates:ee,czm_depthClampFarPlane:te,czm_discardIfClippedWithIntersect:re,czm_discardIfClippedWithUnion:ie,czm_eastNorthUpToEyeCoordinates:ne,czm_ellipsoidContainsPoint:oe,czm_ellipsoidNew:ae,czm_ellipsoidWgs84TextureCoordinates:se,czm_equalsEpsilon:le,czm_eyeOffset:ue,czm_eyeToWindowCoordinates:ce,czm_fog:de,czm_geodeticSurfaceNormal:he,czm_getDefaultMaterial:pe,czm_getLambertDiffuse:fe,czm_getSpecular:me,czm_getWaterNoise:ge,czm_getWgs84EllipsoidEC:_e,czm_HSBToRGB:ve,czm_HSLToRGB:ye,czm_hue:be,czm_isEmpty:Ce,czm_isFull:we,czm_latitudeToWebMercatorFraction:Se,czm_luminance:Te,czm_metersPerPixel:Ee,czm_modelToWindowCoordinates:Ae,czm_multiplyWithColorBalance:xe,czm_nearFarScalar:Pe,czm_octDecode:De,czm_packDepth:Oe,czm_phong:Ie,czm_pointAlongRay:Me,czm_rayEllipsoidIntersectionInterval:Re,czm_RGBToHSB:Le,czm_RGBToHSL:Ne,czm_RGBToXYZ:ke,czm_saturation:Fe,czm_shadowDepthCompare:Be,czm_shadowVisibility:Ue,czm_signNotZero:Ve,czm_tangentToEyeSpaceMatrix:ze,czm_translateRelativeToEye:qe,czm_translucentPhong:Ge,czm_transpose:We,czm_unpackDepth:He,czm_windowToEyeCoordinates:je,czm_writeDepthClampedToFarPlane:Ye,czm_XYZToRGB:Xe}}),define("Renderer/ShaderSource",["../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Renderer/modernizeShader","../Shaders/Builtin/CzmBuiltins","./AutomaticUniforms"],function(r,f,m,g,e,t){"use strict";function _(e){return(e=e.replace(/\/\/.*/g,"")).replace(/\/\*\*[\s\S]*?\*\//gm,function(e){for(var t=e.match(/\n/gm).length,r="",i=0;i<t;++i)r+="\n";return r})}function a(e,t,r){for(var i,n=0;n<r.length;++n)r[n].name===e&&(i=r[n]);return f(i)||(i={name:e,glslSource:t=_(t),dependsOn:[],requiredBy:[],evaluated:!1},r.push(i)),i}function v(e){var t=[],r=a("main",e,t);!function r(i,n){if(!i.evaluated){i.evaluated=!0;var o=i.glslSource.match(/\bczm_[a-zA-Z0-9_]*/g);f(o)&&null!==o&&(o=o.filter(function(e,t){return o.indexOf(e)===t})).forEach(function(e){if(e!==i.name&&y._czmBuiltinsAndUniforms.hasOwnProperty(e)){var t=a(e,y._czmBuiltinsAndUniforms[e],n);i.dependsOn.push(t),t.requiredBy.push(i),r(t,n)}})}}(r,t),function(e){for(var t=[],r=[];0<e.length;){var i=e.pop();r.push(i),0===i.requiredBy.length&&t.push(i)}for(;0<t.length;){var n=t.shift();e.push(n);for(var o=0;o<n.dependsOn.length;++o){var a=n.dependsOn[o],s=a.requiredBy.indexOf(n);a.requiredBy.splice(s,1),0===a.requiredBy.length&&t.push(a)}}for(var l=[],u=0;u<r.length;++u)0!==r[u].requiredBy.length&&l.push(r[u]);if(0!==l.length){for(var c="A circular dependency was found in the following built-in functions/structs/constants: \n",d=0;d<l.length;++d)c=c+l[d].name+"\n";throw new m(c)}}(t);for(var i="",n=t.length-1;0<=n;--n)i=i+t[n].glslSource+"\n";return i.replace(r.glslSource,"")}function i(e,t,r){var i,n,o,a="",s=e.sources;if(f(s))for(i=0,n=s.length;i<n;++i)a+="\n#line 0\n"+s[i];a=(a=_(a)).replace(/#version\s+(.*?)\n/gm,function(e,t){if(f(o)&&o!==t)throw new m("inconsistent versions found: "+o+" and "+t);return o=t,"\n"});var l=[];a=(a=a.replace(/#extension.*\n/gm,function(e){return l.push(e),"\n"})).replace(/precision\s(lowp|mediump|highp)\s(float|int);/,"");var u=e.pickColorQualifier;f(u)&&(a=y.createPickFragmentShaderSource(a,u));var c="";f(o)&&(c="#version "+o+"\n");var d=l.length;for(i=0;i<d;i++)c+=l[i];t&&(c+="#ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n#else\n    precision mediump float;\n#endif\n\n");var h=e.defines;if(f(h))for(i=0,n=h.length;i<n;++i){var p=h[i];0!==p.length&&(c+="#define "+p+"\n")}return r.webgl2&&(c+="#define OUTPUT_DECLARATION\n\n"),e.includeBuiltIns&&(c+=v(a)),c+="\n#line 0\n",c+=a,r.webgl2&&(c=g(c,t,!0)),c}function y(e){var t=(e=r(e,r.EMPTY_OBJECT)).pickColorQualifier;if(f(t)&&"uniform"!==t&&"varying"!==t)throw new m("options.pickColorQualifier must be 'uniform' or 'varying'.");this.defines=f(e.defines)?e.defines.slice(0):[],this.sources=f(e.sources)?e.sources.slice(0):[],this.pickColorQualifier=t,this.includeBuiltIns=r(e.includeBuiltIns,!0)}for(var n in y.prototype.clone=function(){return new y({sources:this.sources,defines:this.defines,pickColorQuantifier:this.pickColorQualifier,includeBuiltIns:this.includeBuiltIns})},y.replaceMain=function(e,t){return t="void "+t+"()",e.replace(/void\s+main\s*\(\s*(?:void)?\s*\)/g,t)},y.prototype.createCombinedVertexShader=function(e){return i(this,!1,e)},y.prototype.createCombinedFragmentShader=function(e){return i(this,!0,e)},y._czmBuiltinsAndUniforms={},e)e.hasOwnProperty(n)&&(y._czmBuiltinsAndUniforms[n]=e[n]);for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];"function"==typeof s.getDeclaration&&(y._czmBuiltinsAndUniforms[o]=s.getDeclaration(o))}y.createPickVertexShaderSource=function(e){return y.replaceMain(e,"czm_old_main")+"\nattribute vec4 pickColor; \nvarying vec4 czm_pickColor; \nvoid main() \n{ \n    czm_old_main(); \n    czm_pickColor = pickColor; \n}"},y.createPickFragmentShaderSource=function(e,t){return y.replaceMain(e,"czm_old_main")+"\n"+(t+" vec4 czm_pickColor; \nvoid main() \n{ \n    czm_old_main(); \n    if (gl_FragColor.a == 0.0) { \n       discard; \n    } \n    gl_FragColor = czm_pickColor; \n}")},y.findVarying=function(e,t){for(var r=e.sources,i=t.length,n=0;n<i;++n)for(var o=t[n],a=r.length,s=0;s<a;++s)if(-1!==r[s].indexOf(o))return o};var l=["v_normalEC","v_normal"];y.findNormalVarying=function(e){return y.findVarying(e,l)};var u=["v_positionEC"];return y.findPositionVarying=function(e){return y.findVarying(e,u)},y}),define("Renderer/Buffer",["../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/IndexDatatype","../Core/WebGLConstants","./BufferUsage"],function(l,u,c,a,e,d,s,h,p){"use strict";function f(e){if(e=u(e,u.EMPTY_OBJECT),l.defined("options.context",e.context),!c(e.typedArray)&&!c(e.sizeInBytes))throw new d("Either options.sizeInBytes or options.typedArray is required.");if(c(e.typedArray)&&c(e.sizeInBytes))throw new d("Cannot pass in both options.sizeInBytes and options.typedArray.");if(c(e.typedArray)&&(l.typeOf.object("options.typedArray",e.typedArray),l.typeOf.number("options.typedArray.byteLength",e.typedArray.byteLength)),!p.validate(e.usage))throw new d("usage is invalid.");var t=e.context._gl,r=e.bufferTarget,i=e.typedArray,n=e.sizeInBytes,o=e.usage,a=c(i);a&&(n=i.byteLength),l.typeOf.number.greaterThan("sizeInBytes",n,0);var s=t.createBuffer();t.bindBuffer(r,s),t.bufferData(r,a?i:n,o),t.bindBuffer(r,null),this._gl=t,this._webgl2=e.context._webgl2,this._bufferTarget=r,this._sizeInBytes=n,this._usage=o,this._buffer=s,this.vertexArrayDestroyable=!0}return f.createVertexBuffer=function(e){return l.defined("options.context",e.context),new f({context:e.context,bufferTarget:h.ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage})},f.createIndexBuffer=function(e){if(l.defined("options.context",e.context),!s.validate(e.indexDatatype))throw new d("Invalid indexDatatype.");if(e.indexDatatype===s.UNSIGNED_INT&&!e.context.elementIndexUint)throw new d("IndexDatatype.UNSIGNED_INT requires OES_element_index_uint, which is not supported on this system.  Check context.elementIndexUint.");var t=e.context,r=e.indexDatatype,i=s.getSizeInBytes(r),n=new f({context:t,bufferTarget:h.ELEMENT_ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage}),o=n.sizeInBytes/i;return a(n,{indexDatatype:{get:function(){return r}},bytesPerIndex:{get:function(){return i}},numberOfIndices:{get:function(){return o}}}),n},a(f.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}}}),f.prototype._getBuffer=function(){return this._buffer},f.prototype.copyFromArrayView=function(e,t){t=u(t,0),l.defined("arrayView",e),l.typeOf.number.lessThanOrEquals("offsetInBytes + arrayView.byteLength",t+e.byteLength,this._sizeInBytes);var r=this._gl,i=this._bufferTarget;r.bindBuffer(i,this._buffer),r.bufferSubData(i,t,e),r.bindBuffer(i,null)},f.prototype.copyFromBuffer=function(e,t,r,i){if(!this._webgl2)throw new d("A WebGL 2 context is required.");if(!c(e))throw new d("readBuffer must be defined.");if(!c(i)||i<=0)throw new d("sizeInBytes must be defined and be greater than zero.");if(!c(t)||t<0||t+i>e._sizeInBytes)throw new d("readOffset must be greater than or equal to zero and readOffset + sizeInBytes must be less than of equal to readBuffer.sizeInBytes.");if(!c(r)||r<0||r+i>this._sizeInBytes)throw new d("writeOffset must be greater than or equal to zero and writeOffset + sizeInBytes must be less than of equal to this.sizeInBytes.");if(this._buffer===e._buffer&&(t<=r&&r<t+i||r<t&&t<r+i))throw new d("When readBuffer is equal to this, the ranges [readOffset + sizeInBytes) and [writeOffset, writeOffset + sizeInBytes) must not overlap.");if(this._bufferTarget===h.ELEMENT_ARRAY_BUFFER&&e._bufferTarget!==h.ELEMENT_ARRAY_BUFFER||this._bufferTarget!==h.ELEMENT_ARRAY_BUFFER&&e._bufferTarget===h.ELEMENT_ARRAY_BUFFER)throw new d("Can not copy an index buffer into another buffer type.");var n=h.COPY_READ_BUFFER,o=h.COPY_WRITE_BUFFER,a=this._gl;a.bindBuffer(o,this._buffer),a.bindBuffer(n,e._buffer),a.copyBufferSubData(n,o,t,r,i),a.bindBuffer(o,null),a.bindBuffer(n,null)},f.prototype.getBufferData=function(e,t,r,i){if(t=u(t,0),r=u(r,0),!this._webgl2)throw new d("A WebGL 2 context is required.");if(!c(e))throw new d("arrayView is required.");var n,o,a=e.byteLength;if(o=c(i)?(n=i,c(a)?1:(a=e.length,e.BYTES_PER_ELEMENT)):c(a)?(n=a-r,1):(n=(a=e.length)-r,e.BYTES_PER_ELEMENT),r<0||a<r)throw new d("destinationOffset must be greater than zero and less than the arrayView length.");if(a<r+n)throw new d("destinationOffset + length must be less than or equal to the arrayViewLength.");if(t<0||t>this._sizeInBytes)throw new d("sourceOffset must be greater than zero and less than the buffers size.");if(t+n*o>this._sizeInBytes)throw new d("sourceOffset + length must be less than the buffers size.");var s=this._gl,l=h.COPY_READ_BUFFER;s.bindBuffer(l,this._buffer),s.getBufferSubData(l,t,e,r,i),s.bindBuffer(l,null)},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){return this._gl.deleteBuffer(this._buffer),e(this)},f}),define("Renderer/VertexArray",["../Core/Check","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Geometry","../Core/IndexDatatype","../Core/Math","../Core/RuntimeError","./Buffer","./BufferUsage","./ContextLimits"],function(v,w,y,S,e,n,g,b,C,T,E,A,x,d){"use strict";function _(e,t,r,i){var n=S(t.vertexBuffer),o=S(t.value),a=t.value?t.value.length:t.componentsPerAttribute;if(!n&&!o)throw new g("attribute must have a vertexBuffer or a value.");if(n&&o)throw new g("attribute cannot have both a vertexBuffer and a value.  It must have either a vertexBuffer property defining per-vertex data or a value property defining data for all vertices.");if(1!==a&&2!==a&&3!==a&&4!==a){if(o)throw new g("attribute.value.length must be in the range [1, 4].");throw new g("attribute.componentsPerAttribute must be in the range [1, 4].")}if(S(t.componentDatatype)&&!w.validate(t.componentDatatype))throw new g("attribute must have a valid componentDatatype or not specify it.");if(S(t.strideInBytes)&&255<t.strideInBytes)throw new g("attribute must have a strideInBytes less than or equal to 255 or not specify it.");if(S(t.instanceDivisor)&&0<t.instanceDivisor&&!i.instancedArrays)throw new g("instanced arrays is not supported");if(S(t.instanceDivisor)&&t.instanceDivisor<0)throw new g("attribute must have an instanceDivisor greater than or equal to zero");if(S(t.instanceDivisor)&&o)throw new g("attribute cannot have have an instanceDivisor if it is not backed by a buffer");if(S(t.instanceDivisor)&&0<t.instanceDivisor&&0===t.index)throw new g("attribute zero cannot have an instanceDivisor greater than 0");var s={index:y(t.index,r),enabled:y(t.enabled,!0),vertexBuffer:t.vertexBuffer,value:o?t.value.slice(0):void 0,componentsPerAttribute:a,componentDatatype:y(t.componentDatatype,w.FLOAT),normalize:y(t.normalize,!1),offsetInBytes:y(t.offsetInBytes,0),strideInBytes:y(t.strideInBytes,0),instanceDivisor:y(t.instanceDivisor,0)};if(n)s.vertexAttrib=function(e){var t=this.index;e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer._getBuffer()),e.vertexAttribPointer(t,this.componentsPerAttribute,this.componentDatatype,this.normalize,this.strideInBytes,this.offsetInBytes),e.enableVertexAttribArray(t),0<this.instanceDivisor&&(i.glVertexAttribDivisor(t,this.instanceDivisor),i._vertexAttribDivisors[t]=this.instanceDivisor,i._previousDrawInstanced=!0)},s.disableVertexAttribArray=function(e){e.disableVertexAttribArray(this.index),0<this.instanceDivisor&&i.glVertexAttribDivisor(r,0)};else{switch(s.componentsPerAttribute){case 1:s.vertexAttrib=function(e){e.vertexAttrib1fv(this.index,this.value)};break;case 2:s.vertexAttrib=function(e){e.vertexAttrib2fv(this.index,this.value)};break;case 3:s.vertexAttrib=function(e){e.vertexAttrib3fv(this.index,this.value)};break;case 4:s.vertexAttrib=function(e){e.vertexAttrib4fv(this.index,this.value)}}s.disableVertexAttribArray=function(e){}}e.push(s)}function P(e,t,r){for(var i=0;i<t.length;++i){var n=t[i];n.enabled&&n.vertexAttrib(e)}S(r)&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r._getBuffer())}function D(e){e=y(e,y.EMPTY_OBJECT),v.defined("options.context",e.context),v.defined("options.attributes",e.attributes);var t,r=e.context,i=r._gl,n=e.attributes,o=e.indexBuffer,a=[],s=1,l=!1,u=!1,c=n.length;for(t=0;t<c;++t)_(a,n[t],t,r);for(c=a.length,t=0;t<c;++t){var d=a[t];if(S(d.vertexBuffer)&&0===d.instanceDivisor){var h=d.strideInBytes||d.componentsPerAttribute*w.getSizeInBytes(d.componentDatatype);s=d.vertexBuffer.sizeInBytes/h;break}}for(t=0;t<c;++t)0<a[t].instanceDivisor&&(l=!0),S(a[t].value)&&(u=!0);var p,f={};for(t=0;t<c;++t){var m=a[t].index;if(f[m])throw new g("Index "+m+" is used by more than one attribute.");f[m]=!0}r.vertexArrayObject&&(p=r.glCreateVertexArray(),r.glBindVertexArray(p),P(i,a,o),r.glBindVertexArray(null)),this._numberOfVertices=s,this._hasInstancedAttributes=l,this._hasConstantAttributes=u,this._context=r,this._gl=i,this._vao=p,this._attributes=a,this._indexBuffer=o}function O(e){return e.values.length/e.componentsPerAttribute}return D.fromGeometry=function(e){e=y(e,y.EMPTY_OBJECT),v.defined("options.context",e.context);var t,r,i,n,o=e.context,a=y(e.geometry,y.EMPTY_OBJECT),s=y(e.bufferUsage,x.DYNAMIC_DRAW),l=y(e.attributeLocations,y.EMPTY_OBJECT),u=y(e.interleave,!1),c=e.vertexArrayAttributes,d=S(c)?c:[],h=a.attributes;if(u){var p=function(r){var e,t,i,n,o=[];for(t in r)r.hasOwnProperty(t)&&S(r[t])&&S(r[t].values)&&(o.push(t),r[t].componentDatatype===w.DOUBLE&&(r[t].componentDatatype=w.FLOAT,r[t].values=w.createTypedArray(w.FLOAT,r[t].values)));var a=o.length;if(0<a)for(n=O(r[o[0]]),e=1;e<a;++e){var s=O(r[o[e]]);if(s!==n)throw new E("Each attribute list must have the same number of vertices.  Attribute "+o[e]+" has a different number of vertices ("+s.toString()+") than attribute "+o[0]+" ("+n.toString()+").")}o.sort(function(e,t){return w.getSizeInBytes(r[t].componentDatatype)-w.getSizeInBytes(r[e].componentDatatype)});var l,u=0,c={};for(e=0;e<a;++e)t=o[e],i=r[t],c[t]=u,u+=(l=i,w.getSizeInBytes(l.componentDatatype)*l.componentsPerAttribute);if(0<u){var d=w.getSizeInBytes(r[o[0]].componentDatatype),h=u%d;0!==h&&(u+=d-h);var p=new ArrayBuffer(n*u),f={};for(e=0;e<a;++e){t=o[e];var m=w.getSizeInBytes(r[t].componentDatatype);f[t]={pointer:w.createTypedArray(r[t].componentDatatype,p),index:c[t]/m,strideInComponentType:u/m}}for(e=0;e<n;++e)for(var g=0;g<a;++g){t=o[g];for(var _=(i=r[t]).values,v=f[t],y=v.pointer,b=i.componentsPerAttribute,C=0;C<b;++C)y[v.index+C]=_[e*b+C];v.index+=v.strideInComponentType}return{buffer:p,offsetsInBytes:c,vertexSizeInBytes:u}}}(h);if(S(p)){i=A.createVertexBuffer({context:o,typedArray:p.buffer,usage:s});var f=p.offsetsInBytes,m=p.vertexSizeInBytes;for(t in h)h.hasOwnProperty(t)&&S(h[t])&&(r=h[t],S(r.values)?d.push({index:l[t],vertexBuffer:i,componentDatatype:r.componentDatatype,componentsPerAttribute:r.componentsPerAttribute,normalize:r.normalize,offsetInBytes:f[t],strideInBytes:m}):d.push({index:l[t],value:r.value,componentDatatype:r.componentDatatype,normalize:r.normalize}))}}else for(t in h)if(h.hasOwnProperty(t)&&S(h[t])){var g=(r=h[t]).componentDatatype;g===w.DOUBLE&&(g=w.FLOAT),i=void 0,S(r.values)&&(i=A.createVertexBuffer({context:o,typedArray:w.createTypedArray(g,r.values),usage:s})),d.push({index:l[t],vertexBuffer:i,value:r.value,componentDatatype:g,componentsPerAttribute:r.componentsPerAttribute,normalize:r.normalize})}var _=a.indices;return S(_)&&(n=b.computeNumberOfVertices(a)>=T.SIXTY_FOUR_KILOBYTES&&o.elementIndexUint?A.createIndexBuffer({context:o,typedArray:new Uint32Array(_),usage:s,indexDatatype:C.UNSIGNED_INT}):A.createIndexBuffer({context:o,typedArray:new Uint16Array(_),usage:s,indexDatatype:C.UNSIGNED_SHORT})),new D({context:o,attributes:d,indexBuffer:n})},e(D.prototype,{numberOfAttributes:{get:function(){return this._attributes.length}},numberOfVertices:{get:function(){return this._numberOfVertices}},indexBuffer:{get:function(){return this._indexBuffer}}}),D.prototype.getAttribute=function(e){return v.defined("index",e),this._attributes[e]},D.prototype._bind=function(){S(this._vao)?(this._context.glBindVertexArray(this._vao),this._context.instancedArrays&&function(e){var t=e._context,r=e._hasInstancedAttributes;if(r||t._previousDrawInstanced){t._previousDrawInstanced=r;var i,n=t._vertexAttribDivisors,o=e._attributes,a=d.maximumVertexAttributes;if(r){var s=o.length;for(i=0;i<s;++i){var l=o[i];if(l.enabled){var u=l.instanceDivisor,c=l.index;u!==n[c]&&(t.glVertexAttribDivisor(c,u),n[c]=u)}}}else for(i=0;i<a;++i)0<n[i]&&(t.glVertexAttribDivisor(i,0),n[i]=0)}}(this),this._hasConstantAttributes&&function(e,t){for(var r=e._attributes,i=r.length,n=0;n<i;++n){var o=r[n];o.enabled&&S(o.value)&&o.vertexAttrib(t)}}(this,this._gl)):P(this._gl,this._attributes,this._indexBuffer)},D.prototype._unBind=function(){if(S(this._vao))this._context.glBindVertexArray(null);else{for(var e=this._attributes,t=this._gl,r=0;r<e.length;++r){var i=e[r];i.enabled&&i.disableVertexAttribArray(t)}this._indexBuffer&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}},D.prototype.isDestroyed=function(){return!1},D.prototype.destroy=function(){for(var e=this._attributes,t=0;t<e.length;++t){var r=e[t].vertexBuffer;S(r)&&!r.isDestroyed()&&r.vertexArrayDestroyable&&r.destroy()}var i=this._indexBuffer;return S(i)&&!i.isDestroyed()&&i.vertexArrayDestroyable&&i.destroy(),S(this._vao)&&this._context.glDeleteVertexArray(this._vao),n(this)},D}),define("Scene/BatchTable",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/combine","../Core/ComponentDatatype","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/FeatureDetection","../Core/Math","../Core/PixelFormat","../Renderer/ContextLimits","../Renderer/PixelDatatype","../Renderer/Sampler","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter"],function(_,i,v,r,y,b,e,t,C,n,o,a,w,S,s,l,u,c){"use strict";function d(e,t,r){if(!b(e))throw new C("context is required");if(!b(t))throw new C("attributes is required");if(!b(r))throw new C("numberOfInstances is required");if(this._attributes=t,this._numberOfInstances=r,0!==t.length){var i=function(e){for(var t=!1,r=e.length,i=0;i<r;++i)if(e[i].componentDatatype!==y.UNSIGNED_BYTE){t=!0;break}return t?S.FLOAT:S.UNSIGNED_BYTE}(t),n=e.floatingPointTexture,o=i===S.FLOAT&&!n,a=function(e,t){for(var r=new Array(e.length),i=0,n=e.length,o=0;o<n;++o){var a=e[o],s=a.componentDatatype;r[o]=i,s!==y.UNSIGNED_BYTE&&t?i+=4:++i}return r}(t,o),s=function(e,t,r){var i=e.length,n=e[i-1];if(t[i-1].componentDatatype!==y.UNSIGNED_BYTE&&r)return n+4;return n+1}(a,t,o),l=Math.floor(w.maximumTextureSize/s),u=Math.min(r,l),c=s*u,d=Math.ceil(r/u),h=1/c,p=.5*h,f=1/d,m=.5*f;this._textureDimensions=new _(c,d),this._textureStep=new v(h,p,f,m),this._pixelDatatype=o?S.UNSIGNED_BYTE:i,this._packFloats=o,this._offsets=a,this._stride=s,this._texture=void 0;var g=4*c*d;this._batchValues=i!==S.FLOAT||o?new Uint8Array(g):new Float32Array(g),this._batchValuesDirty=!1}}function g(e,t){var r=e[t].componentsPerAttribute;return 2===r?_:3===r?i:4===r?v:Number}e(d.prototype,{attributes:{get:function(){return this._attributes}},numberOfInstances:{get:function(){return this._numberOfInstances}}});var T=new v,h=256,E=1/h,A=1/65536,x=1/16777216,P=38;function D(e){var t=e.w/2,r=Math.floor(t),i=2*(t-r);if(i=-(i=2*i-1),P<=(r-=P))return i<0?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY;var n=i*e.x*E;return n+=i*e.y*A,(n+=i*e.z*x)*Math.pow(10,r)}if(n.supportsTypedArrays()){var p=new Float32Array(1),O=new v;d.prototype.getBatchedAttribute=function(e,t,r){if(e<0||e>=this._numberOfInstances)throw new C("instanceIndex is out of range.");if(t<0||t>=this._attributes.length)throw new C("attributeIndex is out of range");var i,n,o,a,s,l,u,c,d,h=this._attributes,p=this._offsets[t],f=4*this._stride*e+4*p;i=this._packFloats&&h[t].componentDatatype!==S.UNSIGNED_BYTE?(n=this._batchValues,o=f,a=O,s=v.unpack(n,o,T),l=D(s),u=D(s=v.unpack(n,o+4,T)),c=D(s=v.unpack(n,o+8,T)),d=D(s=v.unpack(n,o+12,T)),v.fromElements(l,u,c,d,a)):v.unpack(this._batchValues,f,O);var m=g(h,t);return b(m.fromCartesian4)?m.fromCartesian4(i,r):b(m.clone)?m.clone(i,r):i.x};var f=[void 0,void 0,new _,new i,new v],m=new v;return d.prototype.setBatchedAttribute=function(e,t,r){if(e<0||e>=this._numberOfInstances)throw new C("instanceIndex is out of range.");if(t<0||t>=this._attributes.length)throw new C("attributeIndex is out of range");if(!b(r))throw new C("value is required.");var i=this._attributes,n=f[i[t].componentsPerAttribute],o=this.getBatchedAttribute(e,t,n),a=g(this._attributes,t);if(!(b(a.equals)?a.equals(o,r):o===r)){var s=m;s.x=b(r.x)?r.x:r,s.y=b(r.y)?r.y:0,s.z=b(r.z)?r.z:0,s.w=b(r.w)?r.w:0;var l,u,c,d,h=this._offsets[t],p=4*this._stride*e+4*h;this._packFloats&&i[t].componentDatatype!==S.UNSIGNED_BYTE?(l=s,u=this._batchValues,c=p,d=I(l.x,T),v.pack(d,u,c),d=I(l.y,d),v.pack(d,u,c+4),d=I(l.z,d),v.pack(d,u,c+8),d=I(l.w,d),v.pack(d,u,c+12)):v.pack(s,this._batchValues,p),this._batchValuesDirty=!0}},d.prototype.update=function(e){var t,r,i,n,o;b(this._texture)&&!this._batchValuesDirty||0===this._attributes.length||(this._batchValuesDirty=!1,b(this._texture)||(t=this,r=e.context,i=t._textureDimensions,t._texture=new l({context:r,pixelFormat:a.RGBA,pixelDatatype:t._pixelDatatype,width:i.x,height:i.y,sampler:new s({minificationFilter:c.NEAREST,magnificationFilter:u.NEAREST})})),o=(n=this)._textureDimensions,n._texture.copyFrom({width:o.x,height:o.y,arrayBufferView:n._batchValues}))},d.prototype.getUniformMapCallback=function(){var t=this;return function(e){return 0===t._attributes.length?e:r(e,{batchTexture:function(){return t._texture},batchTextureDimensions:function(){return t._textureDimensions},batchTextureStep:function(){return t._textureStep}})}},d.prototype.getVertexShaderCallback=function(){var e=this._attributes;if(0===e.length)return function(e){return e};var t,r,n="uniform sampler2D batchTexture; \n";n+=(r=(t=this)._stride,(1===t._textureDimensions.y?"uniform vec4 batchTextureStep; \nvec2 computeSt(float batchId) \n{ \n    float stepX = batchTextureStep.x; \n    float centerX = batchTextureStep.y; \n    float numberOfAttributes = float("+r+"); \n    return vec2(centerX + (batchId * numberOfAttributes * stepX), 0.5); \n} \n":"uniform vec4 batchTextureStep; \nuniform vec2 batchTextureDimensions; \nvec2 computeSt(float batchId) \n{ \n    float stepX = batchTextureStep.x; \n    float centerX = batchTextureStep.y; \n    float stepY = batchTextureStep.z; \n    float centerY = batchTextureStep.w; \n    float numberOfAttributes = float("+r+"); \n    float xId = mod(batchId * numberOfAttributes, batchTextureDimensions.x); \n    float yId = floor(batchId * numberOfAttributes / batchTextureDimensions.x); \n    return vec2(centerX + (xId * stepX), 1.0 - (centerY + (yId * stepY))); \n} \n")+"\n"),n+=(this._packFloats?"float unpackFloat(vec4 value) \n{ \n    value *= 255.0; \n    float temp = value.w / 2.0; \n    float exponent = floor(temp); \n    float sign = (temp - exponent) * 2.0; \n    exponent = exponent - float("+P+"); \n    sign = sign * 2.0 - 1.0; \n    sign = -sign; \n    float unpacked = sign * value.x * float("+E+"); \n    unpacked += sign * value.y * float("+A+"); \n    unpacked += sign * value.z * float("+x+"); \n    return unpacked * pow(10.0, exponent); \n} \n":"")+"\n";for(var i,o,a,s,l,u,c,d,h,p,f=e.length,m=0;m<f;++m)n+=(o=m,p=s=a=void 0,l=(i=this)._attributes[o],u=l.componentsPerAttribute,c=l.functionName,d=1===(a=u)?"float":"vec"+a,h=1===(s=u)?".x":2===s?".xy":3===s?".xyz":"",p=d+" "+c+"(float batchId) \n{ \n    vec2 st = computeSt(batchId); \n    st.x += batchTextureStep.x * float("+i._offsets[o]+"); \n",i._packFloats&&l.componentDatatype!==S.UNSIGNED_BYTE?p+="vec4 textureValue; \ntextureValue.x = unpackFloat(texture2D(batchTexture, st)); \ntextureValue.y = unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x, 0.0))); \ntextureValue.z = unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 2.0, 0.0))); \ntextureValue.w = unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 3.0, 0.0))); \n":p+="    vec4 textureValue = texture2D(batchTexture, st); \n",p+="    "+d+" value = textureValue"+h+"; \n",i._pixelDatatype!==S.UNSIGNED_BYTE||l.componentDatatype!==y.UNSIGNED_BYTE||l.normalize?i._pixelDatatype===S.FLOAT&&l.componentDatatype===y.UNSIGNED_BYTE&&l.normalize&&(p+="value /= 255.0; \n"):p+="value *= 255.0; \n",p+="    return value; \n} \n");return function(e){var t=e.indexOf("void main"),r=e.substring(0,t),i=e.substring(t);return r+"\n"+n+"\n"+i}},d.prototype.isDestroyed=function(){return!1},d.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),t(this)},d}function I(e,t){if(p[0]=e,0===(e=p[0]))return v.clone(v.ZERO,t);var r,i=e<0?1:0;isFinite(e)?(e=Math.abs(e),r=Math.floor(o.logBase(e,10))+1,e/=Math.pow(10,r)):(e=.1,r=P);var n=e*h;return t.x=Math.floor(n),n=(n-t.x)*h,t.y=Math.floor(n),n=(n-t.y)*h,t.z=Math.floor(n),t.w=2*(r+P)+i,t}}),define("Scene/DepthFunction",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";return e({NEVER:t.NEVER,LESS:t.LESS,EQUAL:t.EQUAL,LESS_OR_EQUAL:t.LEQUAL,GREATER:t.GREATER,NOT_EQUAL:t.NOTEQUAL,GREATER_OR_EQUAL:t.GEQUAL,ALWAYS:t.ALWAYS})}),define("Scene/PrimitivePipeline",["../Core/BoundingSphere","../Core/ComponentDatatype","../Core/defined","../Core/DeveloperError","../Core/Ellipsoid","../Core/FeatureDetection","../Core/GeographicProjection","../Core/Geometry","../Core/GeometryAttribute","../Core/GeometryAttributes","../Core/GeometryPipeline","../Core/IndexDatatype","../Core/Matrix4","../Core/WebMercatorProjection"],function(w,S,y,b,d,e,h,T,E,A,C,x,P,p){"use strict";if(!e.supportsTypedArrays())return{};function D(e,t){var r=e.attributes,i=r.position,n=i.values.length/i.componentsPerAttribute;r.batchId=new E({componentDatatype:S.FLOAT,componentsPerAttribute:1,values:new Float32Array(n)});for(var o=r.batchId.values,a=0;a<n;++a)o[a]=t}function g(e){var t,r,i,n=e.instances,o=e.projection,a=e.elementIndexUintSupported,s=e.scene3DOnly,l=e.vertexCacheOptimize,u=e.compressVertices,c=e.modelMatrix,d=n.length;for(t=0;t<d;++t)if(y(n[t].geometry)){i=n[t].geometry.primitiveType;break}for(t=1;t<d;++t)if(y(n[t].geometry)&&n[t].geometry.primitiveType!==i)throw new b("All instance geometries must have the same primitiveType.");if(function(e,t,r){var i,n=!r,o=e.length;if(!n&&1<o){var a=e[0].modelMatrix;for(i=1;i<o;++i)if(!P.equals(a,e[i].modelMatrix)){n=!0;break}}if(n)for(i=0;i<o;++i)y(e[i].geometry)&&C.transformToWorldCoordinates(e[i]);else P.multiplyTransformation(t,e[0].modelMatrix,t)}(n,c,s),!s)for(t=0;t<d;++t)y(n[t].geometry)&&C.splitLongitude(n[t]);if(function(e){for(var t=e.length,r=0;r<t;++r){var i=e[r];y(i.geometry)?D(i.geometry,r):y(i.westHemisphereGeometry)&&y(i.eastHemisphereGeometry)&&(D(i.westHemisphereGeometry,r),D(i.eastHemisphereGeometry,r))}}(n),l)for(t=0;t<d;++t){var h=n[t];y(h.geometry)?(C.reorderForPostVertexCache(h.geometry),C.reorderForPreVertexCache(h.geometry)):y(h.westHemisphereGeometry)&&y(h.eastHemisphereGeometry)&&(C.reorderForPostVertexCache(h.westHemisphereGeometry),C.reorderForPreVertexCache(h.westHemisphereGeometry),C.reorderForPostVertexCache(h.eastHemisphereGeometry),C.reorderForPreVertexCache(h.eastHemisphereGeometry))}var p=C.combineInstances(n);for(d=p.length,t=0;t<d;++t){var f,m=(r=p[t]).attributes;if(s)for(f in m)m.hasOwnProperty(f)&&m[f].componentDatatype===S.DOUBLE&&C.encodeAttribute(r,f,f+"3DHigh",f+"3DLow");else for(f in m)if(m.hasOwnProperty(f)&&m[f].componentDatatype===S.DOUBLE){var g=f+"3D",_=f+"2D";C.projectTo2D(r,f,g,_,o),y(r.boundingSphere)&&"position"===f&&(r.boundingSphereCV=w.fromVertices(r.attributes.position2D.values)),C.encodeAttribute(r,g,g+"High",g+"Low"),C.encodeAttribute(r,_,_+"High",_+"Low")}u&&C.compressVertices(r)}if(!a){var v=[];for(d=p.length,t=0;t<d;++t)r=p[t],v=v.concat(C.fitToUnsignedShortIndices(r));p=v}return p}function _(e,t,r,i){var n,o,a,s=i.length-1;if(0<=s){var l=i[s];n=l.offset+l.count,o=r[a=l.index].indices.length}else o=r[a=n=0].indices.length;for(var u=e.length,c=0;c<u;++c){var d=e[c][t];if(y(d)){var h=d.indices.length;o<n+h&&(n=0,o=r[++a].indices.length),i.push({index:a,offset:n,count:h}),n+=h}}}var f={};function n(e,t){var r=e.attributes;for(var i in r)if(r.hasOwnProperty(i)){var n=r[i];y(n)&&y(n.values)&&t.push(n.values.buffer)}y(e.indices)&&t.push(e.indices.buffer)}function o(e){var t=e.length,r=1+(w.packedLength+1)*t,i=new Float32Array(r),n=0;i[n++]=t;for(var o=0;o<t;++o){var a=e[o];y(a)?(i[n++]=1,w.pack(e[o],i,n)):i[n++]=0,n+=w.packedLength}return i}function t(e){for(var t=new Array(e[0]),r=0,i=1;i<e.length;)1===e[i++]&&(t[r]=w.unpack(e,i)),++r,i+=w.packedLength;return t}return f.combineGeometry=function(e){var t,r,i,n,o,a,s=e.instances,l=s.length;0<l&&0<(t=g(e)).length&&(r=C.createAttributeLocations(t[0]),e.createPickOffsets&&(_(n=s,"geometry",o=t,a=[]),_(n,"westHemisphereGeometry",o,a),_(n,"eastHemisphereGeometry",o,a),i=a));for(var u=new Array(l),c=new Array(l),d=0;d<l;++d){var h=s[d],p=h.geometry;y(p)&&(u[d]=p.boundingSphere,c[d]=p.boundingSphereCV);var f=h.eastHemisphereGeometry,m=h.westHemisphereGeometry;y(f)&&y(m)&&(y(f.boundingSphere)&&y(m.boundingSphere)&&(u[d]=w.union(f.boundingSphere,m.boundingSphere)),y(f.boundingSphereCV)&&y(m.boundingSphereCV)&&(c[d]=w.union(f.boundingSphereCV,m.boundingSphereCV)))}return{geometries:t,modelMatrix:e.modelMatrix,attributeLocations:r,pickOffsets:i,boundingSpheres:u,boundingSpheresCV:c}},f.packCreateGeometryResults=function(e,t){var r=new Float64Array(function(e){for(var t=1,r=e.length,i=0;i<r;i++){var n=e[i];if(++t,y(n)){var o=n.attributes;for(var a in t+=6+2*w.packedLength+(y(n.indices)?n.indices.length:0),o)o.hasOwnProperty(a)&&y(o[a])&&(t+=5+o[a].values.length)}}return t}(e)),i=[],n={},o=e.length,a=0;r[a++]=o;for(var s=0;s<o;s++){var l=e[s],u=y(l);if(r[a++]=u?1:0,u){r[a++]=l.primitiveType,r[a++]=l.geometryType;var c=y(l.boundingSphere)?1:0;(r[a++]=c)&&w.pack(l.boundingSphere,r,a),a+=w.packedLength;var d=y(l.boundingSphereCV)?1:0;(r[a++]=d)&&w.pack(l.boundingSphereCV,r,a),a+=w.packedLength;var h=l.attributes,p=[];for(var f in h)h.hasOwnProperty(f)&&y(h[f])&&(p.push(f),y(n[f])||(n[f]=i.length,i.push(f)));r[a++]=p.length;for(var m=0;m<p.length;m++){var g=p[m],_=h[g];r[a++]=n[g],r[a++]=_.componentDatatype,r[a++]=_.componentsPerAttribute,r[a++]=_.normalize?1:0,r[a++]=_.values.length,r.set(_.values,a),a+=_.values.length}var v=y(l.indices)?l.indices.length:0;0<(r[a++]=v)&&(r.set(l.indices,a),a+=v)}}return t.push(r.buffer),{stringTable:i,packedData:r}},f.unpackCreateGeometryResults=function(e){for(var t,r=e.stringTable,i=e.packedData,n=new Array(i[0]),o=0,a=1;a<i.length;){if(1===i[a++]){var s,l,u,c,d,h=i[a++],p=i[a++];1===i[a++]&&(s=w.unpack(i,a)),a+=w.packedLength,1===i[a++]&&(l=w.unpack(i,a)),a+=w.packedLength;var f,m=new A,g=i[a++];for(t=0;t<g;t++){var _=r[i[a++]],v=i[a++];d=i[a++];var y=0!==i[a++];u=i[a++],c=S.createTypedArray(v,u);for(var b=0;b<u;b++)c[b]=i[a++];m[_]=new E({componentDatatype:v,componentsPerAttribute:d,normalize:y,values:c})}if(0<(u=i[a++])){var C=c.length/d;for(f=x.createTypedArray(C,u),t=0;t<u;t++)f[t]=i[a++]}n[o++]=new T({primitiveType:h,geometryType:p,boundingSphere:s,boundingSphereCV:l,indices:f,attributes:m})}else n[o++]=void 0}return n},f.packCombineGeometryParameters=function(e,t){for(var r=e.createGeometryResults,i=r.length,n=0;n<i;n++)t.push(r[n].packedData.buffer);return{createGeometryResults:e.createGeometryResults,packedInstances:function(e,t){var r=e.length,i=new Float64Array(1+16*r),n=0;i[n++]=r;for(var o=0;o<r;o++){var a=e[o];P.pack(a.modelMatrix,i,n),n+=P.packedLength}return t.push(i.buffer),i}(e.instances,t),ellipsoid:e.ellipsoid,isGeographic:e.projection instanceof h,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e.createPickOffsets}},f.unpackCombineGeometryParameters=function(e){for(var t=function(e){for(var t=e,r=new Array(t[0]),i=0,n=1;n<t.length;){var o=P.unpack(t,n);n+=P.packedLength,r[i++]={modelMatrix:o}}return r}(e.packedInstances),r=e.createGeometryResults,i=r.length,n=0,o=0;o<i;o++)for(var a=f.unpackCreateGeometryResults(r[o]),s=a.length,l=0;l<s;l++){var u=a[l];t[n].geometry=u,++n}var c=d.clone(e.ellipsoid);return{instances:t,ellipsoid:c,projection:e.isGeographic?new h(c):new p(c),elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:P.clone(e.modelMatrix),createPickOffsets:e.createPickOffsets}},f.packCombineGeometryResults=function(e,t){y(e.geometries)&&function(e,t){for(var r=e.length,i=0;i<r;++i)n(e[i],t)}(e.geometries,t);var r=o(e.boundingSpheres),i=o(e.boundingSpheresCV);return t.push(r.buffer,i.buffer),{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,boundingSpheres:r,boundingSpheresCV:i}},f.unpackCombineGeometryResults=function(e){return{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,boundingSpheres:t(e.boundingSpheres),boundingSpheresCV:t(e.boundingSpheresCV)}},f}),define("Scene/PrimitiveState",["../Core/freezeObject"],function(e){"use strict";return e({READY:0,CREATING:1,CREATED:2,COMBINING:3,COMBINED:4,COMPLETE:5,FAILED:6})}),define("Scene/SceneMode",["../Core/freezeObject"],function(e){"use strict";var t={MORPHING:0,COLUMBUS_VIEW:1,SCENE2D:2,SCENE3D:3,getMorphTime:function(e){return e===t.SCENE3D?1:e!==t.MORPHING?0:void 0}};return e(t)}),define("Scene/ShadowMode",["../Core/freezeObject"],function(e){"use strict";var r={DISABLED:0,ENABLED:1,CAST_ONLY:2,RECEIVE_ONLY:3,NUMBER_OF_SHADOW_MODES:4,castShadows:function(e){return e===r.ENABLED||e===r.CAST_ONLY},receiveShadows:function(e){return e===r.ENABLED||e===r.RECEIVE_ONLY},fromCastReceive:function(e,t){return e&&t?r.ENABLED:e?r.CAST_ONLY:t?r.RECEIVE_ONLY:r.DISABLED}};return e(r)}),define("Scene/Primitive",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/clone","../Core/Color","../Core/combine","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EncodedCartesian3","../Core/FeatureDetection","../Core/Geometry","../Core/GeometryAttribute","../Core/GeometryAttributes","../Core/isArray","../Core/Matrix4","../Core/RuntimeError","../Core/subdivideArray","../Core/TaskProcessor","../Renderer/BufferUsage","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../ThirdParty/when","./BatchTable","./CullFace","./DepthFunction","./PrimitivePipeline","./PrimitiveState","./SceneMode","./ShadowMode"],function(C,r,i,n,e,a,E,u,A,x,P,y,o,w,S,t,l,c,d,D,T,h,b,O,f,p,v,I,s,m,g,_,M,R,L,N,k,F,B,U){"use strict";function V(e){if(e=x(e,x.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this.appearance=e.appearance,this._appearance=void 0,this._material=void 0,this.depthFailAppearance=e.depthFailAppearance,this._depthFailAppearance=void 0,this._depthFailMaterial=void 0,this.modelMatrix=T.clone(x(e.modelMatrix,T.IDENTITY)),this._modelMatrix=new T,this.show=x(e.show,!0),this._vertexCacheOptimize=x(e.vertexCacheOptimize,!1),this._interleave=x(e.interleave,!1),this._releaseGeometryInstances=x(e.releaseGeometryInstances,!0),this._allowPicking=x(e.allowPicking,!0),this._asynchronous=x(e.asynchronous,!0),this._compressVertices=x(e.compressVertices,!0),this.cull=x(e.cull,!0),this.debugShowBoundingVolume=x(e.debugShowBoundingVolume,!1),this.rtcCenter=e.rtcCenter,P(this.rtcCenter)&&(!P(this.geometryInstances)||D(this.geometryInstances)&&1!==this.geometryInstances))throw new w("Relative-to-center rendering only supports one geometry instance.");this.shadows=x(e.shadows,U.DISABLED),this._translucent=void 0,this._state=F.READY,this._geometries=[],this._error=void 0,this._numberOfInstances=0,this._boundingSpheres=[],this._boundingSphereWC=[],this._boundingSphereCV=[],this._boundingSphere2D=[],this._boundingSphereMorph=[],this._perInstanceAttributeCache=[],this._instanceIds=[],this._lastPerInstanceAttributeIndex=0,this._va=[],this._attributeLocations=void 0,this._primitiveType=void 0,this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._depthFailAppearance=void 0,this._spDepthFail=void 0,this._frontFaceDepthFailRS=void 0,this._backFaceDepthFailRS=void 0,this._pickRS=void 0,this._pickSP=void 0,this._pickIds=[],this._colorCommands=[],this._pickCommands=[],this._readOnlyInstanceAttributes=e._readOnlyInstanceAttributes,this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._createRenderStatesFunction=e._createRenderStatesFunction,this._createShaderProgramFunction=e._createShaderProgramFunction,this._createCommandsFunction=e._createCommandsFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._createPickOffsets=e._createPickOffsets,this._pickOffsets=void 0,this._createGeometryResults=void 0,this._ready=!1,this._readyPromise=M.defer(),this._batchTable=void 0,this._batchTableAttributeIndices=void 0,this._instanceBoundingSpheres=void 0,this._instanceBoundingSpheresCV=void 0,this._batchTableBoundingSpheresUpdated=!1,this._batchTableBoundingSphereAttributeIndices=void 0}y(V.prototype,{vertexCacheOptimize:{get:function(){return this._vertexCacheOptimize}},interleave:{get:function(){return this._interleave}},releaseGeometryInstances:{get:function(){return this._releaseGeometryInstances}},allowPicking:{get:function(){return this._allowPicking}},asynchronous:{get:function(){return this._asynchronous}},compressVertices:{get:function(){return this._compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}});var z=new r,q=new i,G=new n;function W(e){var t=e.length;return 1===t?e[0]:2===t?r.unpack(e,0,z):3===t?i.unpack(e,0,q):4===t?n.unpack(e,0,G):void 0}function H(e,t){var r=e.geometryInstances,i=D(r)?r:[r],n=i.length;if(0!==n){var o,a,s,l=function(e){var t,r=e.length,i=[],n=e[0].attributes;for(t in n)if(n.hasOwnProperty(t)){for(var o=n[t],a=!0,s=1;s<r;++s){var l=e[s].attributes[t];if(!P(l)||o.componentDatatype!==l.componentDatatype||o.componentsPerAttribute!==l.componentsPerAttribute||o.normalize!==l.normalize){a=!1;break}}a&&i.push(t)}return i}(i),u=l.length,c=e.allowPicking,d=[],h={},p={},f=i[0].attributes;for(o=0;o<u;++o)s=f[a=l[o]],h[a]=o,d.push({functionName:"czm_batchTable_"+a,componentDatatype:s.componentDatatype,componentsPerAttribute:s.componentsPerAttribute,normalize:s.normalize});-1!==l.indexOf("distanceDisplayCondition")&&(d.push({functionName:"czm_batchTable_boundingSphereCenter3DHigh",componentDatatype:A.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter3DLow",componentDatatype:A.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DHigh",componentDatatype:A.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DLow",componentDatatype:A.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereRadius",componentDatatype:A.FLOAT,componentsPerAttribute:1}),p.center3DHigh=d.length-5,p.center3DLow=d.length-4,p.center2DHigh=d.length-3,p.center2DLow=d.length-2,p.radius=d.length-1),c&&d.push({functionName:"czm_batchTable_pickColor",componentDatatype:A.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0});var m=d.length,g=new R(t,d,n);for(o=0;o<n;++o){var _=i[o];f=_.attributes;for(var v=0;v<u;++v){var y=W((s=f[a=l[v]]).value),b=h[a];g.setBatchedAttribute(o,b,y)}if(c){var C={primitive:x(_.pickPrimitive,e)};P(_.id)&&(C.id=_.id);var w=t.createPickId(C);e._pickIds.push(w);var S=w.color,T=G;T.x=E.floatToByte(S.red),T.y=E.floatToByte(S.green),T.z=E.floatToByte(S.blue),T.w=E.floatToByte(S.alpha),g.setBatchedAttribute(o,m-1,T)}}e._batchTable=g,e._batchTableAttributeIndices=h,e._batchTableBoundingSphereAttributeIndices=p}}function j(e){var t,r,i,n=e.attributes,o=new d;for(var a in n)n.hasOwnProperty(a)&&P(n[a])&&(o[a]=(t=n[a],r=void 0,r=D(t.values)?t.values.slice(0):new t.values.constructor(t.values),new c({componentDatatype:t.componentDatatype,componentsPerAttribute:t.componentsPerAttribute,normalize:t.normalize,values:r})));if(P(e.indices)){var s=e.indices;i=D(s)?s.slice(0):new s.constructor(s)}return new l({attributes:o,indices:i,primitiveType:e.primitiveType,boundingSphere:C.clone(e.boundingSphere)})}var Y=/attribute\s+vec(?:3|4)\s+(.*)3DHigh;/g;function X(e,t){if(!e.compressVertices)return t;var r=-1!==t.search(/attribute\s+vec3\s+normal;/g),i=-1!==t.search(/attribute\s+vec2\s+st;/g);if(!r&&!i)return t;var n=-1!==t.search(/attribute\s+vec3\s+tangent;/g),o=-1!==t.search(/attribute\s+vec3\s+bitangent;/g),a=i&&r?2:1,s="compressedAttributes",l="attribute "+(1<(a+=n||o?1:0)?"vec"+a:"float")+" "+s+";",u="",c="";i&&(u+="vec2 st;\n",c+="    st = czm_decompressTextureCoordinates("+(1<a?s+".x":s)+");\n");r&&n&&o?(u+="vec3 normal;\nvec3 tangent;\nvec3 bitangent;\n",c+="    czm_octDecode("+s+"."+(i?"yz":"xy")+", normal, tangent, bitangent);\n"):(r&&(u+="vec3 normal;\n",c+="    normal = czm_octDecode("+s+(1<a?"."+(i?"y":"x"):"")+");\n"),n&&(u+="vec3 tangent;\n",c+="    tangent = czm_octDecode("+s+"."+(i&&r?"z":"y")+");\n"),o&&(u+="vec3 bitangent;\n",c+="    bitangent = czm_octDecode("+s+"."+(i&&r?"z":"y")+");\n"));var d=t;return d=(d=(d=(d=d.replace(/attribute\s+vec3\s+normal;/g,"")).replace(/attribute\s+vec2\s+st;/g,"")).replace(/attribute\s+vec3\s+tangent;/g,"")).replace(/attribute\s+vec3\s+bitangent;/g,""),[l,u,d=g.replaceMain(d,"czm_non_compressed_main"),"void main() \n{ \n"+c+"    czm_non_compressed_main(); \n}"].join("\n")}function Q(e,t){var r=e.vertexAttributes;for(var i in r)if(r.hasOwnProperty(i)&&!P(t[i]))throw new w("Appearance/Geometry mismatch.  The appearance requires vertex shader attribute input '"+i+"', which was not computed as part of the Geometry.  Use the appearance's vertexFormat property when constructing the geometry.")}function Z(e,t){return function(){return e[t]}}V._modifyShaderPosition=function(e,t,r){for(var i,n="",o="",a="";null!==(i=Y.exec(t));){var s=i[1],l="vec4 czm_compute"+s[0].toUpperCase()+s.substr(1)+"()";"vec4 czm_computePosition()"!==l&&(n+=l+";\n"),P(e.rtcCenter)?(n+="uniform mat4 u_modifiedModelView;\n",o+="attribute vec4 position;\n",a+=l+"\n{\n    return u_modifiedModelView * position;\n}\n\n",t=(t=(t=(t=t.replace(/attribute\s+vec(?:3|4)\s+position3DHigh;/g,"")).replace(/attribute\s+vec(?:3|4)\s+position3DLow;/g,"")).replace(/czm_modelViewRelativeToEye\s+\*\s+/g,"")).replace(/czm_modelViewProjectionRelativeToEye/g,"czm_projection")):r?a+=l+"\n{\n    return czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow);\n}\n\n":(o+="attribute vec3 "+s+"2DHigh;\nattribute vec3 "+s+"2DLow;\n",a+=l+"\n{\n    vec4 p;\n    if (czm_morphTime == 1.0)\n    {\n        p = czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n        p = czm_translateRelativeToEye("+s+"2DHigh.zxy, "+s+"2DLow.zxy);\n    }\n    else\n    {\n        p = czm_columbusViewMorph(\n                czm_translateRelativeToEye("+s+"2DHigh.zxy, "+s+"2DLow.zxy),\n                czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow),\n                czm_morphTime);\n    }\n    return p;\n}\n\n")}return[n,o,t,a].join("\n")},V._appendShowToShader=function(e,t){if(!P(e._batchTableAttributeIndices.show))return t;return g.replaceMain(t,"czm_non_show_main")+"\nvoid main() \n{ \n    czm_non_show_main(); \n    gl_Position *= czm_batchTable_show(batchId); \n}"},V._updateColorAttribute=function(e,t,r){if(!P(e._batchTableAttributeIndices.color)&&!P(e._batchTableAttributeIndices.depthFailColor))return t;if(-1===t.search(/attribute\s+vec4\s+color;/g))return t;if(r&&!P(e._batchTableAttributeIndices.depthFailColor))throw new w("A depthFailColor per-instance attribute is required when using a depth fail appearance that uses a color attribute.");var i=t;return i=i.replace(/attribute\s+vec4\s+color;/g,""),i=r?i.replace(/(\b)color(\b)/g,"$1czm_batchTable_depthFailColor(batchId)$2"):i.replace(/(\b)color(\b)/g,"$1czm_batchTable_color(batchId)$2")},V._updatePickColorAttribute=function(e){var t=e.replace(/attribute\s+vec4\s+pickColor;/g,"");return t=t.replace(/(\b)pickColor(\b)/g,"$1czm_batchTable_pickColor(batchId)$2")},V._appendDistanceDisplayConditionToShader=function(e,t,r){if(!P(e._batchTableAttributeIndices.distanceDisplayCondition))return t;var i="void main() \n{ \n    czm_non_distanceDisplayCondition_main(); \n    vec2 distanceDisplayCondition = czm_batchTable_distanceDisplayCondition(batchId);\n    vec3 boundingSphereCenter3DHigh = czm_batchTable_boundingSphereCenter3DHigh(batchId);\n    vec3 boundingSphereCenter3DLow = czm_batchTable_boundingSphereCenter3DLow(batchId);\n    vec3 boundingSphereCenter2DHigh = czm_batchTable_boundingSphereCenter2DHigh(batchId);\n    vec3 boundingSphereCenter2DLow = czm_batchTable_boundingSphereCenter2DLow(batchId);\n    float boundingSphereRadius = czm_batchTable_boundingSphereRadius(batchId);\n";return i+=r?"    vec4 centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\n":"    vec4 centerRTE;\n    if (czm_morphTime == 1.0)\n    {\n        centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n        centerRTE = czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy);\n    }\n    else\n    {\n        centerRTE = czm_columbusViewMorph(\n                czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy),\n                czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow),\n                czm_morphTime);\n    }\n",g.replaceMain(t,"czm_non_distanceDisplayCondition_main")+"\n"+(i+="    float radiusSq = boundingSphereRadius * boundingSphereRadius; \n    float distanceSq; \n    if (czm_sceneMode == czm_sceneMode2D) \n    { \n        distanceSq = czm_eyeHeight2D.y - radiusSq; \n    } \n    else \n    { \n        distanceSq = dot(centerRTE.xyz, centerRTE.xyz) - radiusSq; \n    } \n    distanceSq = max(distanceSq, 0.0); \n    float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x; \n    float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y; \n    float show = (distanceSq >= nearSq && distanceSq <= farSq) ? 1.0 : 0.0; \n    gl_Position *= show; \n}")};var K,J=Math.max(t.hardwareConcurrency-1,1),$=new O("combineGeometry",Number.POSITIVE_INFINITY);var ee=new S,te=new e,re=new i,ie=new C;function ne(e,t,r,i){var n,o=r.getRenderState();e._backFaceRS=i?((n=a(o,!1)).cull={enabled:!0,face:L.BACK},e._frontFaceRS=s.fromCache(n),n.cull.face=L.FRONT,s.fromCache(n)):(e._frontFaceRS=s.fromCache(o),e._frontFaceRS),n=a(o,!1),P(e._depthFailAppearance)&&(n.depthTest.enabled=!1),e.allowPicking||(n.colorMask={red:!1,green:!1,blue:!1,alpha:!1}),e._pickRS=(i&&(n.cull={enabled:!1}),s.fromCache(n)),P(e._depthFailAppearance)&&(o=e._depthFailAppearance.getRenderState(),(n=a(o,!1)).depthTest.func=N.GREATER,e._backFaceDepthFailRS=i?(n.cull={enabled:!0,face:L.BACK},e._frontFaceDepthFailRS=s.fromCache(n),n.cull.face=L.FRONT,s.fromCache(n)):(e._frontFaceDepthFailRS=s.fromCache(n),e._frontFaceRS))}function oe(e,t,r){var i=t.context,n=e._attributeLocations,o=e._batchTable.getVertexShaderCallback()(r.vertexShaderSource);o=V._appendShowToShader(e,o),o=V._appendDistanceDisplayConditionToShader(e,o,t.scene3DOnly),o=X(e,o=V._updateColorAttribute(e,o,!1)),o=V._modifyShaderPosition(e,o,t.scene3DOnly);var a,s,l,u,c=r.getFragmentShaderSource();if(e.allowPicking){var d=g.createPickVertexShaderSource(o);d=V._updatePickColorAttribute(d),e._pickSP=m.replaceCache({context:i,shaderProgram:e._pickSP,vertexShaderSource:d,fragmentShaderSource:g.createPickFragmentShaderSource(c,"varying"),attributeLocations:n})}else e._pickSP=m.fromCache({context:i,vertexShaderSource:o,fragmentShaderSource:c,attributeLocations:n});Q(e._pickSP,n),e._sp=m.replaceCache({context:i,shaderProgram:e._sp,vertexShaderSource:o,fragmentShaderSource:c,attributeLocations:n}),Q(e._sp,n),P(e._depthFailAppearance)&&(o=e._batchTable.getVertexShaderCallback()(e._depthFailAppearance.vertexShaderSource),o=V._appendShowToShader(e,o),o=V._appendDistanceDisplayConditionToShader(e,o,t.scene3DOnly),o=X(e,o=V._updateColorAttribute(e,o,!0)),o=V._modifyShaderPosition(e,o,t.scene3DOnly),l=o,u=g.replaceMain(l,"czm_non_depth_clamp_main"),o=u+="varying float v_WindowZ;\nvoid main() {\n    czm_non_depth_clamp_main();\n    vec4 position = gl_Position;\n    v_WindowZ = (0.5 * (position.z / position.w) + 0.5) * position.w;\n    position.z = min(position.z, position.w);\n    gl_Position = position;}\n",a=e._depthFailAppearance.getFragmentShaderSource(),s=g.replaceMain(a,"czm_non_depth_clamp_main"),c=s="#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\n"+(s+="varying float v_WindowZ;\nvoid main() {\n    czm_non_depth_clamp_main();\n#ifdef GL_EXT_frag_depth\n    gl_FragDepthEXT = min(v_WindowZ * gl_FragCoord.w, 1.0);\n#endif\n}\n"),e._spDepthFail=m.replaceCache({context:i,shaderProgram:e._spDepthFail,vertexShaderSource:o,fragmentShaderSource:c,attributeLocations:n}),Q(e._spDepthFail,n))}var ae=new T,se=new i;function le(t,e,r,i){var n=P(r)?r._uniforms:void 0,o={},a=e.uniforms;if(P(a))for(var s in a)if(a.hasOwnProperty(s)){if(P(n)&&P(n[s]))throw new w("Appearance and material have a uniform with the same name: "+s);o[s]=Z(a,s)}var l=u(o,n);return l=t._batchTable.getUniformMapCallback()(l),P(t.rtcCenter)&&(l.u_modifiedModelView=function(){var e=i.context.uniformState.view;return T.multiply(e,t._modelMatrix,ae),T.multiplyByPoint(ae,t.rtcCenter,se),T.setTranslation(ae,se,ae),ae}),l}function ue(e,t,r,i,n,o,a,s){var l,u=le(e,t,r,s);P(e._depthFailAppearance)&&(l=le(e,e._depthFailAppearance,e._depthFailAppearance.material,s));var c=i?I.TRANSLUCENT:I.OPAQUE,d=n?2:1;d*=P(e._depthFailAppearance)?2:1,o.length=e._va.length*d,a.length=e._va.length;for(var h=o.length,p=0,f=0,m=0;m<h;++m){var g;n&&(g=o[m],P(g)||(g=o[m]=new v({owner:e,primitiveType:e._primitiveType})),g.vertexArray=e._va[f],g.renderState=e._backFaceRS,g.shaderProgram=e._sp,g.uniformMap=u,g.pass=c,++m),g=o[m],P(g)||(g=o[m]=new v({owner:e,primitiveType:e._primitiveType})),g.vertexArray=e._va[f],g.renderState=e._frontFaceRS,g.shaderProgram=e._sp,g.uniformMap=u,g.pass=c,P(e._depthFailAppearance)&&(n&&(g=o[++m],P(g)||(g=o[m]=new v({owner:e,primitiveType:e._primitiveType})),g.vertexArray=e._va[f],g.renderState=e._backFaceDepthFailRS,g.shaderProgram=e._spDepthFail,g.uniformMap=l,g.pass=c),g=o[++m],P(g)||(g=o[m]=new v({owner:e,primitiveType:e._primitiveType})),g.vertexArray=e._va[f],g.renderState=e._frontFaceDepthFailRS,g.shaderProgram=e._spDepthFail,g.uniformMap=l,g.pass=c);var _=a[p];P(_)||(_=a[p]=new v({owner:e,primitiveType:e._primitiveType})),_.vertexArray=e._va[f],_.renderState=e._pickRS,_.shaderProgram=e._pickSP,_.uniformMap=u,_.pass=c,++p,++f}}function ce(e,t,r,i,n,o,a,s){if(t.mode!==B.SCENE3D&&!T.equals(n,T.IDENTITY))throw new w("Primitive.modelMatrix is only supported in 3D mode.");var l;V._updateBoundingVolumes(e,t,n),t.mode===B.SCENE3D?l=e._boundingSphereWC:t.mode===B.COLUMBUS_VIEW?l=e._boundingSphereCV:t.mode===B.SCENE2D&&P(e._boundingSphere2D)?l=e._boundingSphere2D:P(e._boundingSphereMorph)&&(l=e._boundingSphereMorph);var u=t.commandList,c=t.passes;if(c.render){var d=U.castShadows(e.shadows),h=U.receiveShadows(e.shadows),p=r.length,f=s?2:1;f*=P(e._depthFailAppearance)?2:1;for(var m=0;m<p;++m){var g=Math.floor(m/f),_=r[m];_.modelMatrix=n,_.boundingVolume=l[g],_.cull=o,_.debugShowBoundingVolume=a,_.castShadows=d,_.receiveShadows=h,u.push(_)}}if(c.pick)for(var v=i.length,y=0;y<v;++y){var b=i[y];b.modelMatrix=n,b.boundingVolume=l[y],b.cull=o,u.push(b)}}function de(n,o,a){return function(){var e=n.getBatchedAttribute(o,a),t=n.attributes[a],r=t.componentsPerAttribute,i=A.createTypedArray(t.componentDatatype,r);return P(e.constructor.pack)?e.constructor.pack(e,i,0):i[0]=e,i}}function he(r,i,n){return function(e){if(!P(e)||!P(e.length)||e.length<1||4<e.length)throw new w("value must be and array with length between 1 and 4.");var t=W(e);r.setBatchedAttribute(i,n,t)}}function pe(e,t,r,i){e._error=i,e._state=r,t.afterRender.push(function(){e._ready=e._state===F.COMPLETE||e._state===F.FAILED,P(i)?e._readyPromise.reject(i):e._readyPromise.resolve(e)})}return V._updateBoundingVolumes=function(e,t,r){var i,n,o,a=e.appearance.pixelSize;if(P(a))for(n=e._boundingSpheres.length,i=0;i<n;++i){o=e._boundingSpheres[i];var s=e._boundingSphereWC[i],l=t.camera.getPixelSize(o,t.context.drawingBufferWidth,t.context.drawingBufferHeight)*a;s.radius=o.radius+l}if(!T.equals(r,e._modelMatrix))for(T.clone(r,e._modelMatrix),n=e._boundingSpheres.length,i=0;i<n;++i)o=e._boundingSpheres[i],P(o)&&(e._boundingSphereWC[i]=C.transform(o,r,e._boundingSphereWC[i]),t.scene3DOnly||(e._boundingSphere2D[i]=C.clone(e._boundingSphereCV[i],e._boundingSphere2D[i]),e._boundingSphere2D[i].center.x=0,e._boundingSphereMorph[i]=C.union(e._boundingSphereWC[i],e._boundingSphereCV[i])))},V.prototype.update=function(e){if(!(!P(this.geometryInstances)&&0===this._va.length||P(this.geometryInstances)&&D(this.geometryInstances)&&0===this.geometryInstances.length||!P(this.appearance)||e.mode!==B.SCENE3D&&e.scene3DOnly||!e.passes.render&&!e.passes.pick)){if(P(this._error))throw this._error;if(P(this.rtcCenter)&&!e.scene3DOnly)throw new w("RTC rendering is only available for 3D only scenes.");if(this._state!==F.FAILED){var t=e.context;if(P(this._batchTable)||H(this,t),0<this._batchTable.attributes.length){if(0===p.maximumVertexTextureImageUnits)throw new h("Vertex texture fetch support is required to render primitives with per-instance attributes. The maximum number of vertex texture image units must be greater than zero.");this._batchTable.update(e)}if(this._state!==F.COMPLETE&&this._state!==F.COMBINED&&(this.asynchronous?function(r,i){var e,t,n,o,a=r._instanceIds;if(r._state===F.READY){e=D(r.geometryInstances)?r.geometryInstances:[r.geometryInstances];var s,l=r._numberOfInstances=e.length,u=[],c=[];for(n=0;n<l;++n){if(t=e[n].geometry,a.push(e[n].id),!P(t._workerName))throw new w("_workerName must be defined for asynchronous geometry.");c.push({moduleName:t._workerName,geometry:t})}if(!P(K))for(K=new Array(J),n=0;n<J;n++)K[n]=new O("createGeometry",Number.POSITIVE_INFINITY);for(c=b(c,J),n=0;n<c.length;n++){var d,h=0,p=c[n],f=p.length;for(o=0;o<f;++o)t=(s=p[o]).geometry,P(t.constructor.pack)&&(s.offset=h,h+=x(t.constructor.packedLength,t.packedLength));if(0<h){var m=new Float64Array(h);for(d=[m.buffer],o=0;o<f;++o)t=(s=p[o]).geometry,P(t.constructor.pack)&&(t.constructor.pack(t,m,s.offset),s.geometry=m)}u.push(K[n].scheduleTask({subTasks:c[n]},d))}r._state=F.CREATING,M.all(u,function(e){r._createGeometryResults=e,r._state=F.CREATED}).otherwise(function(e){pe(r,i,F.FAILED,e)})}else if(r._state===F.CREATED){var g=[];e=D(r.geometryInstances)?r.geometryInstances:[r.geometryInstances];var _=i.scene3DOnly,v=i.mapProjection,y=$.scheduleTask(k.packCombineGeometryParameters({createGeometryResults:r._createGeometryResults,instances:e,ellipsoid:v.ellipsoid,projection:v,elementIndexUintSupported:i.context.elementIndexUint,scene3DOnly:_,vertexCacheOptimize:r.vertexCacheOptimize,compressVertices:r.compressVertices,modelMatrix:r.modelMatrix,createPickOffsets:r._createPickOffsets},g),g);r._createGeometryResults=void 0,r._state=F.COMBINING,M(y,function(e){var t=k.unpackCombineGeometryResults(e);r._geometries=t.geometries,r._attributeLocations=t.attributeLocations,r.modelMatrix=T.clone(t.modelMatrix,r.modelMatrix),r._pickOffsets=t.pickOffsets,r._instanceBoundingSpheres=t.boundingSpheres,r._instanceBoundingSpheresCV=t.boundingSpheresCV,P(r._geometries)&&0<r._geometries.length?r._state=F.COMBINED:pe(r,i,F.FAILED,void 0)}).otherwise(function(e){pe(r,i,F.FAILED,e)})}}(this,e):function(e,t){var r,i,n,o=D(e.geometryInstances)?e.geometryInstances:[e.geometryInstances],a=e._numberOfInstances=o.length,s=new Array(a),l=e._instanceIds,u=0;for(i=0;i<a;i++){var c,d=(r=o[i]).geometry;c=P(d.attributes)&&P(d.primitiveType)?j(d):d.constructor.createGeometry(d),s[u++]=(n=r,{geometry:c,modelMatrix:T.clone(n.modelMatrix),pickPrimitive:n.pickPrimitive,id:n.id}),l.push(r.id)}s.length=u;var h=t.scene3DOnly,p=t.mapProjection,f=k.combineGeometry({instances:s,ellipsoid:p.ellipsoid,projection:p,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:h,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets});e._geometries=f.geometries,e._attributeLocations=f.attributeLocations,e.modelMatrix=T.clone(f.modelMatrix,e.modelMatrix),e._pickOffsets=f.pickOffsets,e._instanceBoundingSpheres=f.boundingSpheres,e._instanceBoundingSpheresCV=f.boundingSpheresCV,P(e._geometries)&&0<e._geometries.length?e._state=F.COMBINED:pe(e,t,F.FAILED,void 0)}(this,e)),this._state===F.COMBINED&&(function(e,t){if(P(e._batchTableAttributeIndices.distanceDisplayCondition)&&!e._batchTableBoundingSpheresUpdated){for(var r=e._batchTableBoundingSphereAttributeIndices,i=r.center3DHigh,n=r.center3DLow,o=r.center2DHigh,a=r.center2DLow,s=r.radius,l=t.mapProjection,u=l.ellipsoid,c=e._batchTable,d=e._instanceBoundingSpheres,h=d.length,p=0;p<h;++p){var f=d[p];if(P(f)){var m=e.modelMatrix;P(m)&&(f=C.transform(f,m,ie));var g=f.center,_=f.radius,v=S.fromCartesian(g,ee);c.setBatchedAttribute(p,i,v.high),c.setBatchedAttribute(p,n,v.low);var y=u.cartesianToCartographic(g,te),b=l.project(y,re);v=S.fromCartesian(b,ee),c.setBatchedAttribute(p,o,v.high),c.setBatchedAttribute(p,a,v.low),c.setBatchedAttribute(p,s,_)}}e._batchTableBoundingSpheresUpdated=!0}}(this,e),function(e,t){for(var r=e._attributeLocations,i=e._geometries,n=t.scene3DOnly,o=t.context,a=[],s=i.length,l=0;l<s;++l){var u=i[l];if(a.push(_.fromGeometry({context:o,geometry:u,attributeLocations:r,bufferUsage:f.STATIC_DRAW,interleave:e._interleave})),P(e._createBoundingVolumeFunction))e._createBoundingVolumeFunction(t,u);else if(e._boundingSpheres.push(C.clone(u.boundingSphere)),e._boundingSphereWC.push(new C),!n){var c=u.boundingSphereCV.center,d=c.x,h=c.y,p=c.z;c.x=p,c.y=d,c.z=h,e._boundingSphereCV.push(C.clone(u.boundingSphereCV)),e._boundingSphere2D.push(new C),e._boundingSphereMorph.push(new C)}}e._va=a,e._primitiveType=i[0].primitiveType,e.releaseGeometryInstances&&(e.geometryInstances=void 0),e._geometries=void 0,pe(e,t,F.COMPLETE,void 0)}(this,e)),this.show&&this._state===F.COMPLETE){var r=this.appearance,i=r.material,n=!1,o=!1;this._appearance!==r?(this._appearance=r,this._material=i,o=n=!0):this._material!==i&&(this._material=i,o=!0);var a=this.depthFailAppearance,s=P(a)?a.material:void 0;this._depthFailAppearance!==a?(this._depthFailAppearance=a,this._depthFailMaterial=s,o=n=!0):this._depthFailMaterial!==s&&(this._depthFailMaterial=s,o=!0);var l=this._appearance.isTranslucent();this._translucent!==l&&(this._translucent=l,n=!0),P(this._material)&&this._material.update(t);var u=r.closed&&l;if(n)x(this._createRenderStatesFunction,ne)(this,t,r,u);if(o)x(this._createShaderProgramFunction,oe)(this,e,r);if(n||o)x(this._createCommandsFunction,ue)(this,r,i,l,u,this._colorCommands,this._pickCommands,e);x(this._updateAndQueueCommandsFunction,ce)(this,e,this._colorCommands,this._pickCommands,this.modelMatrix,this.cull,this.debugShowBoundingVolume,u)}}}},V.prototype.getGeometryInstanceAttributes=function(e){if(!P(e))throw new w("id is required");if(!P(this._batchTable))throw new w("must call update before calling getGeometryInstanceAttributes");for(var t=-1,r=this._lastPerInstanceAttributeIndex,i=this._instanceIds,n=i.length,o=0;o<n;++o){var a=(r+o)%n;if(e===i[a]){t=a;break}}if(-1!==t){var s=this._perInstanceAttributeCache[t];if(P(s))return s;var l=this._batchTable,u=this._batchTableAttributeIndices;s={};var c,d,h,p={};for(var f in u)if(u.hasOwnProperty(f)){var m=u[f];p[f]={get:de(l,t,m)};var g=!0,_=this._readOnlyInstanceAttributes;if(g&&P(_)){n=_.length;for(var v=0;v<n;++v)if(f===_[v]){g=!1;break}}g&&(p[f].set=he(l,t,m))}return c=this,h=t,(d=p).boundingSphere={get:function(){var e=c._instanceBoundingSpheres[h],t=c.modelMatrix;return P(t)&&P(e)&&(e=C.transform(e,t)),e}},d.boundingSphereCV={get:function(){return c._instanceBoundingSpheresCV[h]}},y(s,p),this._lastPerInstanceAttributeIndex=t,this._perInstanceAttributeCache[t]=s}},V.prototype.isDestroyed=function(){return!1},V.prototype.destroy=function(){var e,t;this._sp=this._sp&&this._sp.destroy(),this._pickSP=this._pickSP&&this._pickSP.destroy();var r=this._va;for(e=r.length,t=0;t<e;++t)r[t].destroy();this._va=void 0;var i=this._pickIds;for(e=i.length,t=0;t<e;++t)i[t].destroy();return this._pickIds=void 0,this._batchTable=this._batchTable&&this._batchTable.destroy(),this._instanceIds=void 0,this._perInstanceAttributeCache=void 0,this._attributeLocations=void 0,o(this)},V}),define("DataSources/ColorMaterialProperty",["../Core/Color","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(r,i,e,t,n,o){"use strict";function a(e){this._definitionChanged=new t,this._color=void 0,this._colorSubscription=void 0,this.color=e}return e(a.prototype,{isConstant:{get:function(){return o.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:n("color")}),a.prototype.getType=function(e){return"Color"},a.prototype.getValue=function(e,t){return i(t)||(t={}),t.color=o.getValueOrClonedDefault(this._color,e,r.WHITE,t.color),t},a.prototype.equals=function(e){return this===e||e instanceof a&&o.equals(this._color,e._color)},a}),define("DataSources/dynamicGeometryGetBoundingSphere",["../Core/BoundingSphere","../Core/defined","../Core/DeveloperError","./BoundingSphereState"],function(o,a,s,l){"use strict";return function(e,t,r,i){if(!a(e))throw new s("entity is required.");if(!a(i))throw new s("result is required.");var n;return a(t)&&t.show&&t.ready&&(n=t.getGeometryInstanceAttributes(e),a(n)&&a(n.boundingSphere))?(o.clone(n.boundingSphere,i),l.DONE):a(r)&&r.show&&r.ready&&(n=r.getGeometryInstanceAttributes(e),a(n)&&a(n.boundingSphere))?(o.clone(n.boundingSphere,i),l.DONE):a(t)&&!t.ready||a(r)&&!r.ready?l.PENDING:l.FAILED}}),define("DataSources/MaterialProperty",["../Core/Color","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Scene/Material"],function(n,o,e,t,a){"use strict";function r(){t.throwInstantiationError()}return e(r.prototype,{isConstant:{get:t.throwInstantiationError},definitionChanged:{get:t.throwInstantiationError}}),r.prototype.getType=t.throwInstantiationError,r.prototype.getValue=t.throwInstantiationError,r.prototype.equals=t.throwInstantiationError,r.getValue=function(e,t,r){var i;return o(t)&&(i=t.getType(e),o(i))?(o(r)&&r.type===i||(r=a.fromType(i)),t.getValue(e,r.uniforms)):(o(r)&&r.type===a.ColorType||(r=a.fromType(a.ColorType)),n.clone(n.WHITE,r.uniforms.color)),r},r}),define("DataSources/BoxGeometryUpdater",["../Core/BoxGeometry","../Core/BoxOutlineGeometry","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/ShowGeometryInstanceAttribute","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(g,_,v,y,b,C,e,t,w,r,S,i,T,E,l,A,x,P,n,D,o,a,O,I){"use strict";var M=new D(v.WHITE),R=new o(!0),L=new o(!0),N=new o(!1),k=new o(v.BLACK),F=new o(n.DISABLED),B=new o(new r),U=new v;function s(e){this.id=e,this.vertexFormat=void 0,this.dimensions=void 0}function u(e,t){if(!C(e))throw new w("entity is required");if(!C(t))throw new w("scene is required");this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(u.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new i,this._showProperty=void 0,this._materialProperty=void 0,this._hasConstantOutline=!0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._options=new s(e),this._onEntityPropertyChanged(e,"box",e.box,void 0)}function c(e,t){this._primitives=e,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=t,this._options=new s(t._entity)}return e(u,{perInstanceColorAppearanceType:{value:x},materialAppearanceType:{value:A}}),e(u.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!C(this._entity.availability)&&I.isConstant(this._showProperty)&&I.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!C(this._entity.availability)&&I.isConstant(this._showProperty)&&I.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:!0},geometryChanged:{get:function(){return this._geometryChanged}}}),u.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)},u.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)},u.prototype.createFillGeometryInstance=function(e){if(!C(e))throw new w("time is required.");if(!this._fillEnabled)throw new w("This instance does not represent a filled geometry.");var t,r=this._entity,i=r.isAvailable(e),n=new l(i&&r.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),a=S.fromDistanceDisplayCondition(o);if(this._materialProperty instanceof D){var s=v.WHITE;C(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(s=this._materialProperty.color.getValue(e)),t={show:n,distanceDisplayCondition:a,color:y.fromColor(s)}}else t={show:n,distanceDisplayCondition:a};return new T({id:r,geometry:g.fromDimensions(this._options),modelMatrix:r.computeModelMatrix(E.MINIMUM_VALUE),attributes:t})},u.prototype.createOutlineGeometryInstance=function(e){if(!C(e))throw new w("time is required.");if(!this._outlineEnabled)throw new w("This instance does not represent an outlined geometry.");var t=this._entity,r=t.isAvailable(e),i=I.getValueOrDefault(this._outlineColorProperty,e,v.BLACK),n=this._distanceDisplayConditionProperty.getValue(e);return new T({id:t,geometry:_.fromDimensions(this._options),modelMatrix:t.computeModelMatrix(E.MINIMUM_VALUE),attributes:{show:new l(r&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:y.fromColor(i),distanceDisplayCondition:S.fromDistanceDisplayCondition(n)}})},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){this._entitySubscription(),t(this)},u.prototype._onEntityPropertyChanged=function(e,t,r,i){if("availability"===t||"position"===t||"orientation"===t||"box"===t){var n=this._entity.box;if(C(n)){var o=n.fill,a=!C(o)||!o.isConstant||o.getValue(E.MINIMUM_VALUE),s=n.outline,l=C(s);if(l&&s.isConstant&&(l=s.getValue(E.MINIMUM_VALUE)),a||l){var u=n.dimensions,c=e.position,d=n.show;if(!C(u)||!C(c)||C(d)&&d.isConstant&&!d.getValue(E.MINIMUM_VALUE))(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this));else{var h=b(n.material,M),p=h instanceof D;this._materialProperty=h,this._fillProperty=b(o,L),this._showProperty=b(d,R),this._showOutlineProperty=b(n.outline,N),this._outlineColorProperty=l?b(n.outlineColor,k):void 0,this._shadowsProperty=b(n.shadows,F),this._distanceDisplayConditionProperty=b(n.distanceDisplayCondition,B);var f=n.outlineWidth;if(this._fillEnabled=a,this._outlineEnabled=l,c.isConstant&&I.isConstant(e.orientation)&&u.isConstant&&I.isConstant(f)){var m=this._options;m.vertexFormat=p?x.VERTEX_FORMAT:A.MaterialSupport.TEXTURED.vertexFormat,m.dimensions=u.getValue(E.MINIMUM_VALUE,m.dimensions),this._outlineWidth=C(f)?f.getValue(E.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}},u.prototype.createDynamicUpdater=function(e){if(!this._dynamic)throw new w("This instance does not represent dynamic geometry.");if(!C(e))throw new w("primitives is required.");return new c(e,this)},c.prototype.update=function(e){if(!C(e))throw new w("time is required.");var t=this._primitives;t.removeAndDestroy(this._primitive),t.removeAndDestroy(this._outlinePrimitive),this._primitive=void 0,this._outlinePrimitive=void 0;var r=this._geometryUpdater,i=r._entity,n=i.box;if(i.isShowing&&i.isAvailable(e)&&I.getValueOrDefault(n.show,e,!0)){var o=this._options,a=i.computeModelMatrix(e),s=I.getValueOrUndefined(n.dimensions,e,o.dimensions);if(C(a)&&C(s)){o.dimensions=s;var l=this._geometryUpdater.shadowsProperty.getValue(e),u=this._geometryUpdater.distanceDisplayConditionProperty.getValue(e),c=S.fromDistanceDisplayCondition(u);if(I.getValueOrDefault(n.fill,e,!0)){var d=O.getValue(e,r.fillMaterialProperty,this._material);this._material=d;var h=new A({material:d,translucent:d.isTranslucent(),closed:!0});o.vertexFormat=h.vertexFormat,this._primitive=t.add(new P({geometryInstances:new T({id:i,geometry:g.fromDimensions(o),modelMatrix:a,attributes:{distanceDisplayCondition:c}}),appearance:h,asynchronous:!1,shadows:l}))}if(I.getValueOrDefault(n.outline,e,!1)){o.vertexFormat=x.VERTEX_FORMAT;var p=I.getValueOrClonedDefault(n.outlineColor,e,v.BLACK,U),f=I.getValueOrDefault(n.outlineWidth,e,1),m=1!==p.alpha;this._outlinePrimitive=t.add(new P({geometryInstances:new T({id:i,geometry:_.fromDimensions(o),modelMatrix:a,attributes:{color:y.fromColor(p),distanceDisplayCondition:c}}),appearance:new x({flat:!0,translucent:m,renderState:{lineWidth:r._scene.clampLineWidth(f)}}),asynchronous:!1,shadows:l}))}}}},c.prototype.getBoundingSphere=function(e,t){return a(e,this._primitive,this._outlinePrimitive,t)},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),t(this)},u}),define("DataSources/ImageMaterialProperty",["../Core/Cartesian2","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,o,a,s){"use strict";var l=new e(1,1),u=t.WHITE;function c(e){e=r(e,r.EMPTY_OBJECT),this._definitionChanged=new o,this._image=void 0,this._imageSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._transparent=void 0,this._transparentSubscription=void 0,this.image=e.image,this.repeat=e.repeat,this.color=e.color,this.transparent=e.transparent}return n(c.prototype,{isConstant:{get:function(){return s.isConstant(this._image)&&s.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},image:a("image"),repeat:a("repeat"),color:a("color"),transparent:a("transparent")}),c.prototype.getType=function(e){return"Image"},c.prototype.getValue=function(e,t){return i(t)||(t={}),t.image=s.getValueOrUndefined(this._image,e),t.repeat=s.getValueOrClonedDefault(this._repeat,e,l,t.repeat),t.color=s.getValueOrClonedDefault(this._color,e,u,t.color),s.getValueOrDefault(this._transparent,e,!1)&&(t.color.alpha=Math.min(.99,t.color.alpha)),t},c.prototype.equals=function(e){return this===e||e instanceof c&&s.equals(this._image,e._image)&&s.equals(this._color,e._color)&&s.equals(this._transparent,e._transparent)&&s.equals(this._repeat,e._repeat)},c}),define("DataSources/createMaterialPropertyDescriptor",["../Core/Color","../Core/DeveloperError","../Core/Resource","./ColorMaterialProperty","./createPropertyDescriptor","./ImageMaterialProperty"],function(r,i,n,o,a,s){"use strict";function l(e){if(e instanceof r)return new o(e);if("string"==typeof e||e instanceof n||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement){var t=new s;return t.image=e,t}throw new i("Unable to infer material type: "+e)}return function(e,t){return a(e,t,l)}}),define("DataSources/BoxGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(t,r,e,i,n,o,a){"use strict";function s(e){this._dimensions=void 0,this._dimensionsSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new n,this.merge(t(e,t.EMPTY_OBJECT))}return e(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),dimensions:a("dimensions"),material:o("material"),fill:a("fill"),outline:a("outline"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return r(e)?(e.dimensions=this.dimensions,e.show=this.show,e.material=this.material,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(e){if(!r(e))throw new i("source is required.");this.dimensions=t(this.dimensions,e.dimensions),this.show=t(this.show,e.show),this.material=t(this.material,e.material),this.fill=t(this.fill,e.fill),this.outline=t(this.outline,e.outline),this.outlineColor=t(this.outlineColor,e.outlineColor),this.outlineWidth=t(this.outlineWidth,e.outlineWidth),this.shadows=t(this.shadows,e.shadows),this.distanceDisplayCondition=t(this.distanceDisplayCondition,e.distanceDisplayCondition)},s}),define("DataSources/CallbackProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event"],function(i,e,n,r){"use strict";function t(e,t){this._callback=void 0,this._isConstant=void 0,this._definitionChanged=new r,this.setCallback(e,t)}return e(t.prototype,{isConstant:{get:function(){return this._isConstant}},definitionChanged:{get:function(){return this._definitionChanged}}}),t.prototype.getValue=function(e,t){return this._callback(e,t)},t.prototype.setCallback=function(e,t){if(!i(e))throw new n("callback is required.");if(!i(t))throw new n("isConstant is required.");var r=this._callback!==e||this._isConstant!==t;this._callback=e,this._isConstant=t,r&&this._definitionChanged.raiseEvent(this)},t.prototype.equals=function(e){return this===e||e instanceof t&&this._callback===e._callback&&this._isConstant===e._isConstant},t}),define("DataSources/CheckerboardMaterialProperty",["../Core/Cartesian2","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,o,a,s){"use strict";var l=t.WHITE,u=t.BLACK,c=new e(2,2);function d(e){e=r(e,r.EMPTY_OBJECT),this._definitionChanged=new o,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.evenColor=e.evenColor,this.oddColor=e.oddColor,this.repeat=e.repeat}return n(d.prototype,{isConstant:{get:function(){return s.isConstant(this._evenColor)&&s.isConstant(this._oddColor)&&s.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},evenColor:a("evenColor"),oddColor:a("oddColor"),repeat:a("repeat")}),d.prototype.getType=function(e){return"Checkerboard"},d.prototype.getValue=function(e,t){return i(t)||(t={}),t.lightColor=s.getValueOrClonedDefault(this._evenColor,e,l,t.lightColor),t.darkColor=s.getValueOrClonedDefault(this._oddColor,e,u,t.darkColor),t.repeat=s.getValueOrDefault(this._repeat,e,c),t},d.prototype.equals=function(e){return this===e||e instanceof d&&s.equals(this._evenColor,e._evenColor)&&s.equals(this._oddColor,e._oddColor)&&s.equals(this._repeat,e._repeat)},d}),define("DataSources/PositionProperty",["../Core/Cartesian3","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Matrix3","../Core/ReferenceFrame","../Core/Transforms"],function(a,s,e,t,l,u,c){"use strict";function r(){t.throwInstantiationError()}e(r.prototype,{isConstant:{get:t.throwInstantiationError},definitionChanged:{get:t.throwInstantiationError},referenceFrame:{get:t.throwInstantiationError}}),r.prototype.getValue=t.throwInstantiationError,r.prototype.getValueInReferenceFrame=t.throwInstantiationError,r.prototype.equals=t.throwInstantiationError;var d=new l;return r.convertToReferenceFrame=function(e,t,r,i,n){if(!s(t))return t;if(s(n)||(n=new a),r===i)return a.clone(t,n);var o=c.computeIcrfToFixedMatrix(e,d);return s(o)||(o=c.computeTemeToPseudoFixedMatrix(e,d)),r===u.INERTIAL?l.multiplyByVector(o,t,n):r===u.FIXED?l.multiplyByVector(l.transpose(o,d),t,n):void 0},r}),define("DataSources/ConstantPositionProperty",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/ReferenceFrame","./PositionProperty"],function(i,r,n,e,o,a,s,l){"use strict";function t(e,t){this._definitionChanged=new a,this._value=i.clone(e),this._referenceFrame=r(t,s.FIXED)}return e(t.prototype,{isConstant:{get:function(){return!n(this._value)||this._referenceFrame===s.FIXED}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}}),t.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,s.FIXED,t)},t.prototype.setValue=function(e,t){var r=!1;i.equals(this._value,e)||(r=!0,this._value=i.clone(e)),n(t)&&this._referenceFrame!==t&&(r=!0,this._referenceFrame=t),r&&this._definitionChanged.raiseEvent(this)},t.prototype.getValueInReferenceFrame=function(e,t,r){if(!n(e))throw new o("time is required.");if(!n(t))throw new o("referenceFrame is required.");return l.convertToReferenceFrame(e,this._value,this._referenceFrame,t,r)},t.prototype.equals=function(e){return this===e||e instanceof t&&i.equals(this._value,e._value)&&this._referenceFrame===e._referenceFrame},t}),define("DataSources/CorridorGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(t,r,e,i,n,o,a){"use strict";function s(e){this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._cornerType=void 0,this._cornerTypeSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new n,this.merge(t(e,t.EMPTY_OBJECT))}return e(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),material:o("material"),positions:a("positions"),height:a("height"),extrudedHeight:a("extrudedHeight"),granularity:a("granularity"),width:a("width"),fill:a("fill"),outline:a("outline"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),cornerType:a("cornerType"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return r(e)?(e.show=this.show,e.material=this.material,e.positions=this.positions,e.height=this.height,e.extrudedHeight=this.extrudedHeight,e.granularity=this.granularity,e.width=this.width,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.cornerType=this.cornerType,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(e){if(!r(e))throw new i("source is required.");this.show=t(this.show,e.show),this.material=t(this.material,e.material),this.positions=t(this.positions,e.positions),this.height=t(this.height,e.height),this.extrudedHeight=t(this.extrudedHeight,e.extrudedHeight),this.granularity=t(this.granularity,e.granularity),this.width=t(this.width,e.width),this.fill=t(this.fill,e.fill),this.outline=t(this.outline,e.outline),this.outlineColor=t(this.outlineColor,e.outlineColor),this.outlineWidth=t(this.outlineWidth,e.outlineWidth),this.cornerType=t(this.cornerType,e.cornerType),this.shadows=t(this.shadows,e.shadows),this.distanceDisplayCondition=t(this.distanceDisplayCondition,e.distanceDisplayCondition)},s}),define("DataSources/createRawPropertyDescriptor",["./createPropertyDescriptor"],function(r){"use strict";function i(e){return e}return function(e,t){return r(e,t,i)}}),define("DataSources/CylinderGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(t,r,e,i,n,o,a){"use strict";function s(e){this._length=void 0,this._lengthSubscription=void 0,this._topRadius=void 0,this._topRadiusSubscription=void 0,this._bottomRadius=void 0,this._bottomRadiusSubscription=void 0,this._numberOfVerticalLines=void 0,this._numberOfVerticalLinesSubscription=void 0,this._slices=void 0,this._slicesSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new n,this.merge(t(e,t.EMPTY_OBJECT))}return e(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},length:a("length"),topRadius:a("topRadius"),bottomRadius:a("bottomRadius"),numberOfVerticalLines:a("numberOfVerticalLines"),slices:a("slices"),show:a("show"),material:o("material"),fill:a("fill"),outline:a("outline"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return r(e)?(e.bottomRadius=this.bottomRadius,e.length=this.length,e.topRadius=this.topRadius,e.show=this.show,e.material=this.material,e.numberOfVerticalLines=this.numberOfVerticalLines,e.slices=this.slices,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(e){if(!r(e))throw new i("source is required.");this.bottomRadius=t(this.bottomRadius,e.bottomRadius),this.length=t(this.length,e.length),this.topRadius=t(this.topRadius,e.topRadius),this.show=t(this.show,e.show),this.material=t(this.material,e.material),this.numberOfVerticalLines=t(this.numberOfVerticalLines,e.numberOfVerticalLines),this.slices=t(this.slices,e.slices),this.fill=t(this.fill,e.fill),this.outline=t(this.outline,e.outline),this.outlineColor=t(this.outlineColor,e.outlineColor),this.outlineWidth=t(this.outlineWidth,e.outlineWidth),this.shadows=t(this.shadows,e.shadows),this.distanceDisplayCondition=t(this.distanceDisplayCondition,e.distanceDisplayCondition)},s}),define("DataSources/EllipseGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(t,r,e,i,n,o,a){"use strict";function s(e){this._semiMajorAxis=void 0,this._semiMajorAxisSubscription=void 0,this._semiMinorAxis=void 0,this._semiMinorAxisSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._numberOfVerticalLines=void 0,this._numberOfVerticalLinesSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new n,this.merge(t(e,t.EMPTY_OBJECT))}return e(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},semiMajorAxis:a("semiMajorAxis"),semiMinorAxis:a("semiMinorAxis"),rotation:a("rotation"),show:a("show"),material:o("material"),height:a("height"),extrudedHeight:a("extrudedHeight"),granularity:a("granularity"),stRotation:a("stRotation"),fill:a("fill"),outline:a("outline"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),numberOfVerticalLines:a("numberOfVerticalLines"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return r(e)?(e.rotation=this.rotation,e.semiMajorAxis=this.semiMajorAxis,e.semiMinorAxis=this.semiMinorAxis,e.show=this.show,e.material=this.material,e.height=this.height,e.extrudedHeight=this.extrudedHeight,e.granularity=this.granularity,e.stRotation=this.stRotation,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.numberOfVerticalLines=this.numberOfVerticalLines,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(e){if(!r(e))throw new i("source is required.");this.rotation=t(this.rotation,e.rotation),this.semiMajorAxis=t(this.semiMajorAxis,e.semiMajorAxis),this.semiMinorAxis=t(this.semiMinorAxis,e.semiMinorAxis),this.show=t(this.show,e.show),this.material=t(this.material,e.material),this.height=t(this.height,e.height),this.extrudedHeight=t(this.extrudedHeight,e.extrudedHeight),this.granularity=t(this.granularity,e.granularity),this.stRotation=t(this.stRotation,e.stRotation),this.fill=t(this.fill,e.fill),this.outline=t(this.outline,e.outline),this.outlineColor=t(this.outlineColor,e.outlineColor),this.outlineWidth=t(this.outlineWidth,e.outlineWidth),this.numberOfVerticalLines=t(this.numberOfVerticalLines,e.numberOfVerticalLines),this.shadows=t(this.shadows,e.shadows),this.distanceDisplayCondition=t(this.distanceDisplayCondition,e.distanceDisplayCondition)},s}),define("DataSources/EllipsoidGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(t,r,e,i,n,o,a){"use strict";function s(e){this._show=void 0,this._showSubscription=void 0,this._radii=void 0,this._radiiSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._stackPartitions=void 0,this._stackPartitionsSubscription=void 0,this._slicePartitions=void 0,this._slicePartitionsSubscription=void 0,this._subdivisions=void 0,this._subdivisionsSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new n,this.merge(t(e,t.EMPTY_OBJECT))}return e(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),radii:a("radii"),material:o("material"),fill:a("fill"),outline:a("outline"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),stackPartitions:a("stackPartitions"),slicePartitions:a("slicePartitions"),subdivisions:a("subdivisions"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return r(e)?(e.show=this.show,e.radii=this.radii,e.material=this.material,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.stackPartitions=this.stackPartitions,e.slicePartitions=this.slicePartitions,e.subdivisions=this.subdivisions,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(e){if(!r(e))throw new i("source is required.");this.show=t(this.show,e.show),this.radii=t(this.radii,e.radii),this.material=t(this.material,e.material),this.fill=t(this.fill,e.fill),this.outline=t(this.outline,e.outline),this.outlineColor=t(this.outlineColor,e.outlineColor),this.outlineWidth=t(this.outlineWidth,e.outlineWidth),this.stackPartitions=t(this.stackPartitions,e.stackPartitions),this.slicePartitions=t(this.slicePartitions,e.slicePartitions),this.subdivisions=t(this.subdivisions,e.subdivisions),this.shadows=t(this.shadows,e.shadows),this.distanceDisplayCondition=t(this.distanceDisplayCondition,e.distanceDisplayCondition)},s}),define("DataSources/LabelGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createPropertyDescriptor"],function(t,r,e,i,n,o){"use strict";function a(e){this._text=void 0,this._textSubscription=void 0,this._font=void 0,this._fontSubscription=void 0,this._style=void 0,this._styleSubscription=void 0,this._fillColor=void 0,this._fillColorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._horizontalOrigin=void 0,this._horizontalOriginSubscription=void 0,this._verticalOrigin=void 0,this._verticalOriginSubscription=void 0,this._eyeOffset=void 0,this._eyeOffsetSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._pixelOffset=void 0,this._pixelOffsetSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._showBackground=void 0,this._showBackgroundSubscription=void 0,this._backgroundColor=void 0,this._backgroundColorSubscription=void 0,this._backgroundPadding=void 0,this._backgroundPaddingSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._pixelOffsetScaleByDistance=void 0,this._pixelOffsetScaleByDistanceSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this._definitionChanged=new n,this.merge(t(e,t.EMPTY_OBJECT))}return e(a.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},text:o("text"),font:o("font"),style:o("style"),fillColor:o("fillColor"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),horizontalOrigin:o("horizontalOrigin"),verticalOrigin:o("verticalOrigin"),eyeOffset:o("eyeOffset"),heightReference:o("heightReference"),pixelOffset:o("pixelOffset"),scale:o("scale"),show:o("show"),showBackground:o("showBackground"),backgroundColor:o("backgroundColor"),backgroundPadding:o("backgroundPadding"),translucencyByDistance:o("translucencyByDistance"),pixelOffsetScaleByDistance:o("pixelOffsetScaleByDistance"),scaleByDistance:o("scaleByDistance"),distanceDisplayCondition:o("distanceDisplayCondition"),disableDepthTestDistance:o("disableDepthTestDistance")}),a.prototype.clone=function(e){return r(e)?(e.text=this.text,e.font=this.font,e.show=this.show,e.style=this.style,e.fillColor=this.fillColor,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.showBackground=this.showBackground,e.backgroundColor=this.backgroundColor,e.backgroundPadding=this.backgroundPadding,e.scale=this.scale,e.horizontalOrigin=this.horizontalOrigin,e.verticalOrigin=this.verticalOrigin,e.eyeOffset=this.eyeOffset,e.heightReference=this.heightReference,e.pixelOffset=this.pixelOffset,e.translucencyByDistance=this.translucencyByDistance,e.pixelOffsetScaleByDistance=this.pixelOffsetScaleByDistance,e.scaleByDistance=this.scaleByDistance,e.distanceDisplayCondition=this.distanceDisplayCondition,e.disableDepthTestDistance=this.disableDepthTestDistance,e):new a(this)},a.prototype.merge=function(e){if(!r(e))throw new i("source is required.");this.text=t(this.text,e.text),this.font=t(this.font,e.font),this.show=t(this.show,e.show),this.style=t(this.style,e.style),this.fillColor=t(this.fillColor,e.fillColor),this.outlineColor=t(this.outlineColor,e.outlineColor),this.outlineWidth=t(this.outlineWidth,e.outlineWidth),this.showBackground=t(this.showBackground,e.showBackground),this.backgroundColor=t(this.backgroundColor,e.backgroundColor),this.backgroundPadding=t(this.backgroundPadding,e.backgroundPadding),this.scale=t(this.scale,e.scale),this.horizontalOrigin=t(this.horizontalOrigin,e.horizontalOrigin),this.verticalOrigin=t(this.verticalOrigin,e.verticalOrigin),this.eyeOffset=t(this.eyeOffset,e.eyeOffset),this.heightReference=t(this.heightReference,e.heightReference),this.pixelOffset=t(this.pixelOffset,e.pixelOffset),this.translucencyByDistance=t(this.translucencyByDistance,e.translucencyByDistance),this.pixelOffsetScaleByDistance=t(this.pixelOffsetScaleByDistance,e.pixelOffsetScaleByDistance),this.scaleByDistance=t(this.scaleByDistance,e.scaleByDistance),this.distanceDisplayCondition=t(this.distanceDisplayCondition,e.distanceDisplayCondition),this.disableDepthTestDistance=t(this.disableDepthTestDistance,e.disableDepthTestDistance)},a}),define("DataSources/NodeTransformationProperty",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","../Core/TranslationRotationScale","./createPropertyDescriptor","./Property"],function(t,r,e,i,n,o,a){"use strict";var s=new n,l=function(e){e=t(e,t.EMPTY_OBJECT),this._definitionChanged=new i,this._translation=void 0,this._translationSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this.translation=e.translation,this.rotation=e.rotation,this.scale=e.scale};return e(l.prototype,{isConstant:{get:function(){return a.isConstant(this._translation)&&a.isConstant(this._rotation)&&a.isConstant(this._scale)}},definitionChanged:{get:function(){return this._definitionChanged}},translation:o("translation"),rotation:o("rotation"),scale:o("scale")}),l.prototype.getValue=function(e,t){return r(t)||(t=new n),t.translation=a.getValueOrClonedDefault(this._translation,e,s.translation,t.translation),t.rotation=a.getValueOrClonedDefault(this._rotation,e,s.rotation,t.rotation),t.scale=a.getValueOrClonedDefault(this._scale,e,s.scale,t.scale),t},l.prototype.equals=function(e){return this===e||e instanceof l&&a.equals(this._translation,e._translation)&&a.equals(this._rotation,e._rotation)&&a.equals(this._scale,e._scale)},l}),define("DataSources/PropertyBag",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./ConstantProperty","./createPropertyDescriptor","./Property"],function(n,u,e,c,r,t,o,s){"use strict";var i=function(e,t){this._propertyNames=[],this._definitionChanged=new r,u(e)&&this.merge(e,t)};function a(e){return new t(e)}return e(i.prototype,{propertyNames:{get:function(){return this._propertyNames}},isConstant:{get:function(){for(var e=this._propertyNames,t=0,r=e.length;t<r;t++)if(!s.isConstant(this[e[t]]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}}}),i.prototype.hasProperty=function(e){return-1!==this._propertyNames.indexOf(e)},i.prototype.addProperty=function(e,t,r){var i=this._propertyNames;if(!u(e))throw new c("propertyName is required.");if(-1!==i.indexOf(e))throw new c(e+" is already a registered property.");i.push(e),Object.defineProperty(this,e,o(e,!0,n(r,a))),u(t)&&(this[e]=t),this._definitionChanged.raiseEvent(this)},i.prototype.removeProperty=function(e){var t=this._propertyNames.indexOf(e);if(!u(e))throw new c("propertyName is required.");if(-1===t)throw new c(e+" is not a registered property.");this._propertyNames.splice(t,1),delete this[e],this._definitionChanged.raiseEvent(this)},i.prototype.getValue=function(e,t){if(!u(e))throw new c("time is required.");u(t)||(t={});for(var r=this._propertyNames,i=0,n=r.length;i<n;i++){var o=r[i];t[o]=s.getValueOrUndefined(this[o],e,t[o])}return t},i.prototype.merge=function(e,t){if(!u(e))throw new c("source is required.");for(var r=this._propertyNames,i=u(e._propertyNames)?e._propertyNames:Object.keys(e),n=0,o=i.length;n<o;n++){var a=i[n],s=this[a],l=e[a];void 0===s&&-1===r.indexOf(a)&&this.addProperty(a,void 0,t),void 0!==l&&(void 0!==s?u(s)&&u(s.merge)&&s.merge(l):u(l)&&u(l.merge)&&u(l.clone)?this[a]=l.clone():this[a]=l)}},i.prototype.equals=function(e){return this===e||e instanceof i&&function(e,t){var r=e._propertyNames,i=t._propertyNames,n=r.length;if(n!==i.length)return!1;for(var o=0;o<n;++o){var a=r[o];if(-1===i.indexOf(a))return!1;if(!s.equals(e[a],t[a]))return!1}return!0}(this,e)},i}),define("DataSources/ModelGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createPropertyDescriptor","./NodeTransformationProperty","./PropertyBag"],function(i,n,e,o,t,r,a,s){"use strict";function l(e){return new a(e)}function u(e){this._show=void 0,this._showSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._minimumPixelSize=void 0,this._minimumPixelSizeSubscription=void 0,this._maximumScale=void 0,this._maximumScaleSubscription=void 0,this._incrementallyLoadTextures=void 0,this._incrementallyLoadTexturesSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._uri=void 0,this._uriSubscription=void 0,this._runAnimations=void 0,this._clampAnimations=void 0,this._runAnimationsSubscription=void 0,this._nodeTransformations=void 0,this._nodeTransformationsSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._silhouetteColor=void 0,this._silhouetteColorSubscription=void 0,this._silhouetteSize=void 0,this._silhouetteSizeSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._colorBlendMode=void 0,this._colorBlendModeSubscription=void 0,this._colorBlendAmount=void 0,this._colorBlendAmountSubscription=void 0,this._clippingPlanes=void 0,this._clippingPlanesSubscription=void 0,this._definitionChanged=new t,this.merge(i(e,i.EMPTY_OBJECT))}return e(u.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:r("show"),scale:r("scale"),minimumPixelSize:r("minimumPixelSize"),maximumScale:r("maximumScale"),incrementallyLoadTextures:r("incrementallyLoadTextures"),shadows:r("shadows"),uri:r("uri"),runAnimations:r("runAnimations"),clampAnimations:r("clampAnimations"),nodeTransformations:r("nodeTransformations",void 0,function(e){return new s(e,l)}),heightReference:r("heightReference"),distanceDisplayCondition:r("distanceDisplayCondition"),silhouetteColor:r("silhouetteColor"),silhouetteSize:r("silhouetteSize"),color:r("color"),colorBlendMode:r("colorBlendMode"),colorBlendAmount:r("colorBlendAmount"),clippingPlanes:r("clippingPlanes")}),u.prototype.clone=function(e){return n(e)?(e.show=this.show,e.scale=this.scale,e.minimumPixelSize=this.minimumPixelSize,e.maximumScale=this.maximumScale,e.incrementallyLoadTextures=this.incrementallyLoadTextures,e.shadows=this.shadows,e.uri=this.uri,e.runAnimations=this.runAnimations,e.clampAnimations=this.clampAnimations,e.nodeTransformations=this.nodeTransformations,e.heightReference=this._heightReference,e.distanceDisplayCondition=this.distanceDisplayCondition,e.silhouetteColor=this.silhouetteColor,e.silhouetteSize=this.silhouetteSize,e.color=this.color,e.colorBlendMode=this.colorBlendMode,e.colorBlendAmount=this.colorBlendAmount,e.clippingPlanes=this.clippingPlanes,e):new u(this)},u.prototype.merge=function(e){if(!n(e))throw new o("source is required.");this.show=i(this.show,e.show),this.scale=i(this.scale,e.scale),this.minimumPixelSize=i(this.minimumPixelSize,e.minimumPixelSize),this.maximumScale=i(this.maximumScale,e.maximumScale),this.incrementallyLoadTextures=i(this.incrementallyLoadTextures,e.incrementallyLoadTextures),this.shadows=i(this.shadows,e.shadows),this.uri=i(this.uri,e.uri),this.runAnimations=i(this.runAnimations,e.runAnimations),this.clampAnimations=i(this.clampAnimations,e.clampAnimations),this.heightReference=i(this.heightReference,e.heightReference),this.distanceDisplayCondition=i(this.distanceDisplayCondition,e.distanceDisplayCondition),this.silhouetteColor=i(this.silhouetteColor,e.silhouetteColor),this.silhouetteSize=i(this.silhouetteSize,e.silhouetteSize),this.color=i(this.color,e.color),this.colorBlendMode=i(this.colorBlendMode,e.colorBlendMode),this.colorBlendAmount=i(this.colorBlendAmount,e.colorBlendAmount),this.clippingPlanes=i(this.clippingPlanes,e.clippingPlanes);var t=e.nodeTransformations;if(n(t)){var r=this.nodeTransformations;n(r)?r.merge(t):this.nodeTransformations=new s(t,l)}},u}),define("DataSources/PathGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(t,r,e,i,n,o,a){"use strict";function s(e){this._material=void 0,this._materialSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._resolution=void 0,this._resolutionSubscription=void 0,this._leadTime=void 0,this._leadTimeSubscription=void 0,this._trailTime=void 0,this._trailTimeSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new n,this.merge(t(e,t.EMPTY_OBJECT))}return e(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),material:o("material"),width:a("width"),resolution:a("resolution"),leadTime:a("leadTime"),trailTime:a("trailTime"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return r(e)?(e.material=this.material,e.width=this.width,e.resolution=this.resolution,e.show=this.show,e.leadTime=this.leadTime,e.trailTime=this.trailTime,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(e){if(!r(e))throw new i("source is required.");this.material=t(this.material,e.material),this.width=t(this.width,e.width),this.resolution=t(this.resolution,e.resolution),this.show=t(this.show,e.show),this.leadTime=t(this.leadTime,e.leadTime),this.trailTime=t(this.trailTime,e.trailTime),this.distanceDisplayCondition=t(this.distanceDisplayCondition,e.distanceDisplayCondition)},s}),define("DataSources/PlaneGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(t,r,e,i,n,o,a){"use strict";function s(e){this._plane=void 0,this._planeSubscription=void 0,this._dimensions=void 0,this._dimensionsSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new n,this.merge(t(e,t.EMPTY_OBJECT))}return e(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),plane:a("plane"),dimensions:a("dimensions"),material:o("material"),fill:a("fill"),outline:a("outline"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return r(e)?(e.plane=this.plane,e.dimensions=this.dimensions,e.show=this.show,e.material=this.material,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(e){if(!r(e))throw new i("source is required.");this.plane=t(this.plane,e.plane),this.dimensions=t(this.dimensions,e.dimensions),this.show=t(this.show,e.show),this.material=t(this.material,e.material),this.fill=t(this.fill,e.fill),this.outline=t(this.outline,e.outline),this.outlineColor=t(this.outlineColor,e.outlineColor),this.outlineWidth=t(this.outlineWidth,e.outlineWidth),this.shadows=t(this.shadows,e.shadows),this.distanceDisplayCondition=t(this.distanceDisplayCondition,e.distanceDisplayCondition)},s}),define("DataSources/PointGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createPropertyDescriptor"],function(t,r,e,i,n,o){"use strict";function a(e){this._color=void 0,this._colorSubscription=void 0,this._pixelSize=void 0,this._pixelSizeSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this._definitionChanged=new n,this.merge(t(e,t.EMPTY_OBJECT))}return e(a.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},color:o("color"),pixelSize:o("pixelSize"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),show:o("show"),scaleByDistance:o("scaleByDistance"),translucencyByDistance:o("translucencyByDistance"),heightReference:o("heightReference"),distanceDisplayCondition:o("distanceDisplayCondition"),disableDepthTestDistance:o("disableDepthTestDistance")}),a.prototype.clone=function(e){return r(e)?(e.color=this.color,e.pixelSize=this.pixelSize,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.show=this.show,e.scaleByDistance=this.scaleByDistance,e.translucencyByDistance=this._translucencyByDistance,e.heightReference=this.heightReference,e.distanceDisplayCondition=this.distanceDisplayCondition,e.disableDepthTestDistance=this.disableDepthTestDistance,e):new a(this)},a.prototype.merge=function(e){if(!r(e))throw new i("source is required.");this.color=t(this.color,e.color),this.pixelSize=t(this.pixelSize,e.pixelSize),this.outlineColor=t(this.outlineColor,e.outlineColor),this.outlineWidth=t(this.outlineWidth,e.outlineWidth),this.show=t(this.show,e.show),this.scaleByDistance=t(this.scaleByDistance,e.scaleByDistance),this.translucencyByDistance=t(this._translucencyByDistance,e.translucencyByDistance),this.heightReference=t(this.heightReference,e.heightReference),this.distanceDisplayCondition=t(this.distanceDisplayCondition,e.distanceDisplayCondition),this.disableDepthTestDistance=t(this.disableDepthTestDistance,e.disableDepthTestDistance)},a}),define("DataSources/PolygonGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(t,r,e,i,n,o,a){"use strict";function s(e){this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._hierarchy=void 0,this._hierarchySubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._perPositionHeight=void 0,this._perPositionHeightSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._definitionChanged=new n,this._closeTop=void 0,this._closeTopSubscription=void 0,this._closeBottom=void 0,this._closeBottomSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(t(e,t.EMPTY_OBJECT))}return e(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),material:o("material"),hierarchy:a("hierarchy"),height:a("height"),extrudedHeight:a("extrudedHeight"),granularity:a("granularity"),stRotation:a("stRotation"),fill:a("fill"),outline:a("outline"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),perPositionHeight:a("perPositionHeight"),closeTop:a("closeTop"),closeBottom:a("closeBottom"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return r(e)?(e.show=this.show,e.material=this.material,e.hierarchy=this.hierarchy,e.height=this.height,e.extrudedHeight=this.extrudedHeight,e.granularity=this.granularity,e.stRotation=this.stRotation,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.perPositionHeight=this.perPositionHeight,e.closeTop=this.closeTop,e.closeBottom=this.closeBottom,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(e){if(!r(e))throw new i("source is required.");this.show=t(this.show,e.show),this.material=t(this.material,e.material),this.hierarchy=t(this.hierarchy,e.hierarchy),this.height=t(this.height,e.height),this.extrudedHeight=t(this.extrudedHeight,e.extrudedHeight),this.granularity=t(this.granularity,e.granularity),this.stRotation=t(this.stRotation,e.stRotation),this.fill=t(this.fill,e.fill),this.outline=t(this.outline,e.outline),this.outlineColor=t(this.outlineColor,e.outlineColor),this.outlineWidth=t(this.outlineWidth,e.outlineWidth),this.perPositionHeight=t(this.perPositionHeight,e.perPositionHeight),this.closeTop=t(this.closeTop,e.closeTop),this.closeBottom=t(this.closeBottom,e.closeBottom),this.shadows=t(this.shadows,e.shadows),this.distanceDisplayCondition=t(this.distanceDisplayCondition,e.distanceDisplayCondition)},s}),define("DataSources/PolylineGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(t,r,e,i,n,o,a){"use strict";function s(e){this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._depthFailMaterial=void 0,this._depthFailMaterialSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._followSurface=void 0,this._followSurfaceSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._widthSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new n,this.merge(t(e,t.EMPTY_OBJECT))}return e(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),material:o("material"),depthFailMaterial:o("depthFailMaterial"),positions:a("positions"),width:a("width"),followSurface:a("followSurface"),granularity:a("granularity"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return r(e)?(e.show=this.show,e.material=this.material,e.depthFailMaterial=this.depthFailMaterial,e.positions=this.positions,e.width=this.width,e.followSurface=this.followSurface,e.granularity=this.granularity,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(e){if(!r(e))throw new i("source is required.");this.show=t(this.show,e.show),this.material=t(this.material,e.material),this.depthFailMaterial=t(this.depthFailMaterial,e.depthFailMaterial),this.positions=t(this.positions,e.positions),this.width=t(this.width,e.width),this.followSurface=t(this.followSurface,e.followSurface),this.granularity=t(this.granularity,e.granularity),this.shadows=t(this.shadows,e.shadows),this.distanceDisplayCondition=t(this.distanceDisplayCondition,e.distanceDisplayCondition)},s}),define("DataSources/PolylineVolumeGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(t,r,e,i,n,o,a){"use strict";function s(e){this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._shape=void 0,this._shapeSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._cornerType=void 0,this._cornerTypeSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubsription=void 0,this._definitionChanged=new n,this.merge(t(e,t.EMPTY_OBJECT))}return e(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),material:o("material"),positions:a("positions"),shape:a("shape"),granularity:a("granularity"),fill:a("fill"),outline:a("outline"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),cornerType:a("cornerType"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return r(e)?(e.show=this.show,e.material=this.material,e.positions=this.positions,e.shape=this.shape,e.granularity=this.granularity,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.cornerType=this.cornerType,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(e){if(!r(e))throw new i("source is required.");this.show=t(this.show,e.show),this.material=t(this.material,e.material),this.positions=t(this.positions,e.positions),this.shape=t(this.shape,e.shape),this.granularity=t(this.granularity,e.granularity),this.fill=t(this.fill,e.fill),this.outline=t(this.outline,e.outline),this.outlineColor=t(this.outlineColor,e.outlineColor),this.outlineWidth=t(this.outlineWidth,e.outlineWidth),this.cornerType=t(this.cornerType,e.cornerType),this.shadows=t(this.shadows,e.shadows),this.distanceDisplayCondition=t(this.distanceDisplayCondition,e.distanceDisplayCondition)},s}),define("DataSources/RectangleGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(t,r,e,i,n,o,a){"use strict";function s(e){this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._coordinates=void 0,this._coordinatesSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._closeTop=void 0,this._closeTopSubscription=void 0,this._closeBottom=void 0,this._closeBottomSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distancedisplayConditionSubscription=void 0,this._definitionChanged=new n,this.merge(t(e,t.EMPTY_OBJECT))}return e(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),coordinates:a("coordinates"),material:o("material"),height:a("height"),extrudedHeight:a("extrudedHeight"),granularity:a("granularity"),stRotation:a("stRotation"),rotation:a("rotation"),fill:a("fill"),outline:a("outline"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),closeTop:a("closeTop"),closeBottom:a("closeBottom"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return r(e)?(e.show=this.show,e.coordinates=this.coordinates,e.material=this.material,e.height=this.height,e.extrudedHeight=this.extrudedHeight,e.granularity=this.granularity,e.stRotation=this.stRotation,e.rotation=this.rotation,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.closeTop=this.closeTop,e.closeBottom=this.closeBottom,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(e){if(!r(e))throw new i("source is required.");this.show=t(this.show,e.show),this.coordinates=t(this.coordinates,e.coordinates),this.material=t(this.material,e.material),this.height=t(this.height,e.height),this.extrudedHeight=t(this.extrudedHeight,e.extrudedHeight),this.granularity=t(this.granularity,e.granularity),this.stRotation=t(this.stRotation,e.stRotation),this.rotation=t(this.rotation,e.rotation),this.fill=t(this.fill,e.fill),this.outline=t(this.outline,e.outline),this.outlineColor=t(this.outlineColor,e.outlineColor),this.outlineWidth=t(this.outlineWidth,e.outlineWidth),this.closeTop=t(this.closeTop,e.closeTop),this.closeBottom=t(this.closeBottom,e.closeBottom),this.shadows=t(this.shadows,e.shadows),this.distanceDisplayCondition=t(this.distanceDisplayCondition,e.distanceDisplayCondition)},s}),define("DataSources/WallGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(t,r,e,i,n,o,a){"use strict";function s(e){this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._minimumHeights=void 0,this._minimumHeightsSubscription=void 0,this._maximumHeights=void 0,this._maximumHeightsSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new n,this.merge(t(e,t.EMPTY_OBJECT))}return e(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),material:o("material"),positions:a("positions"),minimumHeights:a("minimumHeights"),maximumHeights:a("maximumHeights"),granularity:a("granularity"),fill:a("fill"),outline:a("outline"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return r(e)?(e.show=this.show,e.material=this.material,e.positions=this.positions,e.minimumHeights=this.minimumHeights,e.maximumHeights=this.maximumHeights,e.granularity=this.granularity,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(e){if(!r(e))throw new i("source is required.");this.show=t(this.show,e.show),this.material=t(this.material,e.material),this.positions=t(this.positions,e.positions),this.minimumHeights=t(this.minimumHeights,e.minimumHeights),this.maximumHeights=t(this.maximumHeights,e.maximumHeights),this.granularity=t(this.granularity,e.granularity),this.fill=t(this.fill,e.fill),this.outline=t(this.outline,e.outline),this.outlineColor=t(this.outlineColor,e.outlineColor),this.outlineWidth=t(this.outlineWidth,e.outlineWidth),this.shadows=t(this.shadows,e.shadows),this.distanceDisplayCondition=t(this.distanceDisplayCondition,e.distanceDisplayCondition)},s}),define("DataSources/Entity",["../Core/Cartesian3","../Core/Check","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/Matrix3","../Core/Matrix4","../Core/Quaternion","../Core/Transforms","./BillboardGraphics","./BoxGraphics","./ConstantPositionProperty","./CorridorGraphics","./createPropertyDescriptor","./createRawPropertyDescriptor","./CylinderGraphics","./EllipseGraphics","./EllipsoidGraphics","./LabelGraphics","./ModelGraphics","./PathGraphics","./PlaneGraphics","./PointGraphics","./PolygonGraphics","./PolylineGraphics","./PolylineVolumeGraphics","./Property","./PropertyBag","./RectangleGraphics","./WallGraphics"],function(e,n,r,l,u,t,c,i,o,a,s,d,h,p,f,m,g,_,v,y,b,C,w,S,T,E,A,x,P,D,O,I,M){"use strict";function R(e){return new f(e)}function L(e,t){return g(e,void 0,function(e){return e instanceof t?e:new t(e)})}function N(e){var t=(e=l(e,l.EMPTY_OBJECT)).id;u(t)||(t=r()),this._availability=void 0,this._id=t,this._definitionChanged=new i,this._name=e.name,this._show=l(e.show,!0),this._parent=void 0,this._propertyNames=["billboard","box","corridor","cylinder","description","ellipse","ellipsoid","label","model","orientation","path","plane","point","polygon","polyline","polylineVolume","position","properties","rectangle","viewFrom","wall"],this._billboard=void 0,this._billboardSubscription=void 0,this._box=void 0,this._boxSubscription=void 0,this._corridor=void 0,this._corridorSubscription=void 0,this._cylinder=void 0,this._cylinderSubscription=void 0,this._description=void 0,this._descriptionSubscription=void 0,this._ellipse=void 0,this._ellipseSubscription=void 0,this._ellipsoid=void 0,this._ellipsoidSubscription=void 0,this._label=void 0,this._labelSubscription=void 0,this._model=void 0,this._modelSubscription=void 0,this._orientation=void 0,this._orientationSubscription=void 0,this._path=void 0,this._pathSubscription=void 0,this._plane=void 0,this._planeSubscription=void 0,this._point=void 0,this._pointSubscription=void 0,this._polygon=void 0,this._polygonSubscription=void 0,this._polyline=void 0,this._polylineSubscription=void 0,this._polylineVolume=void 0,this._polylineVolumeSubscription=void 0,this._position=void 0,this._positionSubscription=void 0,this._properties=void 0,this._propertiesSubscription=void 0,this._rectangle=void 0,this._rectangleSubscription=void 0,this._viewFrom=void 0,this._viewFromSubscription=void 0,this._wall=void 0,this._wallSubscription=void 0,this._children=[],this.entityCollection=void 0,this.parent=e.parent,this.merge(e)}function k(e,t,r){for(var i=t.length,n=0;n<i;n++){var o=t[n],a=o._show;(!r&&a)!==(r&&a)&&k(o,o._children,r)}e._definitionChanged.raiseEvent(e,"isShowing",r,!r)}var F;t(N.prototype,{availability:_("availability"),id:{get:function(){return this._id}},definitionChanged:{get:function(){return this._definitionChanged}},name:_("name"),show:{get:function(){return this._show},set:function(e){if(!u(e))throw new c("value is required.");if(e!==this._show){var t=this.isShowing;this._show=e;var r=this.isShowing;t!==r&&k(this,this._children,r),this._definitionChanged.raiseEvent(this,"show",e,!e)}}},isShowing:{get:function(){return this._show&&(!u(this.entityCollection)||this.entityCollection.show)&&(!u(this._parent)||this._parent.isShowing)}},parent:{get:function(){return this._parent},set:function(e){var t=this._parent;if(t!==e){var r=this.isShowing;if(u(t)){var i=t._children.indexOf(this);t._children.splice(i,1)}this._parent=e,u(e)&&e._children.push(this);var n=this.isShowing;r!==n&&k(this,this._children,n),this._definitionChanged.raiseEvent(this,"parent",e,t)}}},propertyNames:{get:function(){return this._propertyNames}},billboard:L("billboard",h),box:L("box",p),corridor:L("corridor",m),cylinder:L("cylinder",v),description:g("description"),ellipse:L("ellipse",y),ellipsoid:L("ellipsoid",b),label:L("label",C),model:L("model",w),orientation:g("orientation"),path:L("path",S),plane:L("plane",T),point:L("point",E),polygon:L("polygon",A),polyline:L("polyline",x),polylineVolume:L("polylineVolume",P),properties:L("properties",O),position:(F="position",g(F,void 0,R)),rectangle:L("rectangle",I),viewFrom:g("viewFrom"),wall:L("wall",M)}),N.prototype.isAvailable=function(e){if(!u(e))throw new c("time is required.");var t=this._availability;return!u(t)||t.contains(e)},N.prototype.addProperty=function(e){var t=this._propertyNames;if(!u(e))throw new c("propertyName is required.");if(-1!==t.indexOf(e))throw new c(e+" is already a registered property.");if(e in this)throw new c(e+" is a reserved property name.");t.push(e),Object.defineProperty(this,e,_(e,!0))},N.prototype.removeProperty=function(e){var t=this._propertyNames.indexOf(e);if(!u(e))throw new c("propertyName is required.");if(-1===t)throw new c(e+" is not a registered property.");this._propertyNames.splice(t,1),delete this[e]},N.prototype.merge=function(e){if(!u(e))throw new c("source is required.");this.name=l(this.name,e.name),this.availability=l(e.availability,this.availability);for(var t=this._propertyNames,r=u(e._propertyNames)?e._propertyNames:Object.keys(e),i=r.length,n=0;n<i;n++){var o=r[n];if("parent"!==o){var a=this[o],s=e[o];u(a)||-1!==t.indexOf(o)||this.addProperty(o),u(s)&&(u(a)?u(a.merge)&&a.merge(s):u(s.merge)&&u(s.clone)?this[o]=s.clone():this[o]=s)}}};var B=new o,U=new e,V=new s;return N.prototype.computeModelMatrix=function(e,t){n.typeOf.object("time",e);var r=D.getValueOrUndefined(this._position,e,U);if(u(r)){var i=D.getValueOrUndefined(this._orientation,e,V);return t=u(i)?a.fromRotationTranslation(o.fromQuaternion(i,B),r,t):d.eastNorthUpToFixedFrame(r,void 0,t)}},N}),define("DataSources/EntityCollection",["../Core/AssociativeArray","../Core/createGuid","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/Iso8601","../Core/JulianDate","../Core/RuntimeError","../Core/TimeInterval","./Entity"],function(t,r,u,e,s,i,l,c,n,d,o){"use strict";var a={id:void 0};function h(e){if(e._firing)e._refire=!0;else if(0===e._suspendCount){var t=e._addedEntities,r=e._removedEntities,i=e._changedEntities;if(0!==i.length||0!==t.length||0!==r.length){e._firing=!0;do{e._refire=!1;var n=t.values.slice(0),o=r.values.slice(0),a=i.values.slice(0);t.removeAll(),r.removeAll(),i.removeAll(),e._collectionChanged.raiseEvent(e,n,o,a)}while(e._refire);e._firing=!1}}}function p(e){this._owner=e,this._entities=new t,this._addedEntities=new t,this._removedEntities=new t,this._changedEntities=new t,this._suspendCount=0,this._collectionChanged=new i,this._id=r(),this._show=!0,this._firing=!1,this._refire=!1}return p.prototype.suspendEvents=function(){this._suspendCount++},p.prototype.resumeEvents=function(){if(0===this._suspendCount)throw new s("resumeEvents can not be called before suspendEvents.");this._suspendCount--,h(this)},p.collectionChangedEventCallback=void 0,e(p.prototype,{collectionChanged:{get:function(){return this._collectionChanged}},id:{get:function(){return this._id}},values:{get:function(){return this._entities.values}},show:{get:function(){return this._show},set:function(e){if(!u(e))throw new s("value is required.");if(e!==this._show){var t;this.suspendEvents();var r=[],i=this._entities.values,n=i.length;for(t=0;t<n;t++)r.push(i[t].isShowing);for(this._show=e,t=0;t<n;t++){var o=r[t],a=i[t];o!==a.isShowing&&a.definitionChanged.raiseEvent(a,"isShowing",a.isShowing,o)}this.resumeEvents()}}},owner:{get:function(){return this._owner}}}),p.prototype.computeAvailability=function(){for(var e=l.MAXIMUM_VALUE,t=l.MINIMUM_VALUE,r=this._entities.values,i=0,n=r.length;i<n;i++){var o=r[i].availability;if(u(o)){var a=o.start,s=o.stop;c.lessThan(a,e)&&!a.equals(l.MINIMUM_VALUE)&&(e=a),c.greaterThan(s,t)&&!s.equals(l.MAXIMUM_VALUE)&&(t=s)}}return l.MAXIMUM_VALUE.equals(e)&&(e=l.MINIMUM_VALUE),l.MINIMUM_VALUE.equals(t)&&(t=l.MAXIMUM_VALUE),new d({start:e,stop:t})},p.prototype.add=function(e){if(!u(e))throw new s("entity is required.");e instanceof o||(e=new o(e));var t=e.id,r=this._entities;if(r.contains(t))throw new n("An entity with id "+t+" already exists in this collection.");return e.entityCollection=this,r.set(t,e),this._removedEntities.remove(t)||this._addedEntities.set(t,e),e.definitionChanged.addEventListener(p.prototype._onEntityDefinitionChanged,this),h(this),e},p.prototype.remove=function(e){return!!u(e)&&this.removeById(e.id)},p.prototype.contains=function(e){if(!u(e))throw new s("entity is required");return this._entities.get(e.id)===e},p.prototype.removeById=function(e){if(!u(e))return!1;var t=this._entities.get(e);return!!this._entities.remove(e)&&(this._addedEntities.remove(e)||(this._removedEntities.set(e,t),this._changedEntities.remove(e)),this._entities.remove(e),t.definitionChanged.removeEventListener(p.prototype._onEntityDefinitionChanged,this),h(this),!0)},p.prototype.removeAll=function(){for(var e=this._entities,t=e.length,r=e.values,i=this._addedEntities,n=this._removedEntities,o=0;o<t;o++){var a=r[o],s=a.id,l=i.get(s);u(l)||(a.definitionChanged.removeEventListener(p.prototype._onEntityDefinitionChanged,this),n.set(s,a))}e.removeAll(),i.removeAll(),this._changedEntities.removeAll(),h(this)},p.prototype.getById=function(e){if(!u(e))throw new s("id is required.");return this._entities.get(e)},p.prototype.getOrCreateEntity=function(e){if(!u(e))throw new s("id is required.");var t=this._entities.get(e);return u(t)||(a.id=e,t=new o(a),this.add(t)),t},p.prototype._onEntityDefinitionChanged=function(e){var t=e.id;this._addedEntities.contains(t)||this._changedEntities.set(t,e),h(this)},p}),define("DataSources/CompositeEntityCollection",["../Core/createGuid","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Math","./Entity","./EntityCollection"],function(r,v,e,i,o,y,g){"use strict";var b={id:void 0},a=new Array(2);function C(e){for(var t=e.propertyNames,r=t.length,i=0;i<r;i++)e[t[i]]=void 0}function w(e,t,r,i){a[0]=r,a[1]=i.id,t[JSON.stringify(a)]=i.definitionChanged.addEventListener(_.prototype._onDefinitionChanged,e)}function S(e,t,r,i){a[0]=r,a[1]=i.id;var n=JSON.stringify(a);t[n](),t[n]=void 0}function s(e){if(e._shouldRecomposite=!0,0===e._suspendCount){var t,r,i,n,o,a,s=e._collections,l=s.length,u=e._collectionsCopy,c=u.length,d=e._composite,h=new g(e),p=e._eventHash;for(t=0;t<c;t++)for((o=u[t]).collectionChanged.removeEventListener(_.prototype._onCollectionChanged,e),i=o.values,a=o.id,n=i.length-1;-1<n;n--)S(0,p,a,r=i[n]);for(t=l-1;0<=t;t--)for((o=s[t]).collectionChanged.addEventListener(_.prototype._onCollectionChanged,e),i=o.values,a=o.id,n=i.length-1;-1<n;n--){w(e,p,a,r=i[n]);var f=h.getById(r.id);v(f)||(f=d.getById(r.id),v(f)?C(f):(b.id=r.id,f=new y(b)),h.add(f)),f.merge(r)}e._collectionsCopy=s.slice(0),d.suspendEvents(),d.removeAll();var m=h.values;for(t=0;t<m.length;t++)d.add(m[t]);d.resumeEvents()}}function _(e,t){this._owner=t,this._composite=new g(this),this._suspendCount=0,this._collections=v(e)?e.slice():[],this._collectionsCopy=[],this._id=r(),this._eventHash={},s(this),this._shouldRecomposite=!1}function n(e,t){if(!v(t))throw new i("collection is required.");var r=e.indexOf(t);if(-1===r)throw new i("collection is not in this composite.");return r}function l(e,t,r){var i=e._collections;if((t=o.clamp(t,0,i.length-1))!==(r=o.clamp(r,0,i.length-1))){var n=i[t];i[t]=i[r],i[r]=n,s(e)}}return e(_.prototype,{collectionChanged:{get:function(){return this._composite._collectionChanged}},id:{get:function(){return this._id}},values:{get:function(){return this._composite.values}},owner:{get:function(){return this._owner}}}),_.prototype.addCollection=function(e,t){var r=v(t);if(!v(e))throw new i("collection is required.");if(r){if(t<0)throw new i("index must be greater than or equal to zero.");if(t>this._collections.length)throw new i("index must be less than or equal to the number of collections.")}r?this._collections.splice(t,0,e):(t=this._collections.length,this._collections.push(e)),s(this)},_.prototype.removeCollection=function(e){var t=this._collections.indexOf(e);return-1!==t&&(this._collections.splice(t,1),s(this),!0)},_.prototype.removeAllCollections=function(){this._collections.length=0,s(this)},_.prototype.containsCollection=function(e){return-1!==this._collections.indexOf(e)},_.prototype.contains=function(e){return this._composite.contains(e)},_.prototype.indexOfCollection=function(e){return this._collections.indexOf(e)},_.prototype.getCollection=function(e){if(!v(e))throw new i("index is required.","index");return this._collections[e]},_.prototype.getCollectionsLength=function(){return this._collections.length},_.prototype.raiseCollection=function(e){var t=n(this._collections,e);l(this,t,t+1)},_.prototype.lowerCollection=function(e){var t=n(this._collections,e);l(this,t,t-1)},_.prototype.raiseCollectionToTop=function(e){var t=n(this._collections,e);t!==this._collections.length-1&&(this._collections.splice(t,1),this._collections.push(e),s(this))},_.prototype.lowerCollectionToBottom=function(e){var t=n(this._collections,e);0!==t&&(this._collections.splice(t,1),this._collections.splice(0,0,e),s(this))},_.prototype.suspendEvents=function(){this._suspendCount++,this._composite.suspendEvents()},_.prototype.resumeEvents=function(){if(0===this._suspendCount)throw new i("resumeEvents can not be called before suspendEvents.");this._suspendCount--,this._shouldRecomposite&&0===this._suspendCount&&(s(this),this._shouldRecomposite=!1),this._composite.resumeEvents()},_.prototype.computeAvailability=function(){return this._composite.computeAvailability()},_.prototype.getById=function(e){return this._composite.getById(e)},_.prototype._onCollectionChanged=function(e,t,r){var i,n,o,a,s=this._collectionsCopy,l=s.length,u=this._composite;u.suspendEvents();var c=r.length,d=this._eventHash,h=e.id;for(i=0;i<c;i++){var p=r[i];S(0,d,h,p);var f=p.id;for(n=l-1;0<=n;n--)o=s[n].getById(f),v(o)&&(v(a)||C(a=u.getById(f)),a.merge(o));v(a)||u.removeById(f),a=void 0}var m=t.length;for(i=0;i<m;i++){var g=t[i];w(this,d,h,g);var _=g.id;for(n=l-1;0<=n;n--)o=s[n].getById(_),v(o)&&(v(a)||(a=u.getById(_),v(a)?C(a):(b.id=_,a=new y(b),u.add(a))),a.merge(o));a=void 0}u.resumeEvents()},_.prototype._onDefinitionChanged=function(e,t,r,i){for(var n=this._collections,o=this._composite,a=n.length,s=e.id,l=o.getById(s),u=l[t],c=!v(u),d=!0,h=a-1;0<=h;h--){var p=n[h].getById(e.id);if(v(p)){var f=p[t];if(v(f)){if(d){if(d=!1,!v(f.merge)||!v(f.clone)){u=f;break}u=f.clone(u)}u.merge(f)}}}c&&-1===l.propertyNames.indexOf(t)&&l.addProperty(t),l[t]=u},_}),define("DataSources/CompositeProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/EventHelper","../Core/TimeIntervalCollection","./Property"],function(u,e,i,t,r,n,o){"use strict";function a(){this._eventHelper=new r,this._definitionChanged=new t,this._intervals=new n,this._intervals.changedEvent.addEventListener(a.prototype._intervalsChanged,this)}return e(a.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}}),a.prototype.getValue=function(e,t){if(!u(e))throw new i("time is required");var r=this._intervals.findDataForIntervalContainingDate(e);if(u(r))return r.getValue(e,t)},a.prototype.equals=function(e){return this===e||e instanceof a&&this._intervals.equals(e._intervals,o.equals)},a.prototype._intervalsChanged=function(){!function(e,t,r,i){function n(){r.raiseEvent(e)}var o=[];t.removeAll();for(var a=i.length,s=0;s<a;s++){var l=i.get(s);u(l.data)&&-1===o.indexOf(l.data)&&t.add(l.data.definitionChanged,n)}}(this,this._eventHelper,this._definitionChanged,this._intervals),this._definitionChanged.raiseEvent(this)},a}),define("DataSources/CompositeMaterialProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./CompositeProperty","./Property"],function(i,e,n,t,r,o){"use strict";function a(){this._definitionChanged=new t,this._composite=new r,this._composite.definitionChanged.addEventListener(a.prototype._raiseDefinitionChanged,this)}return e(a.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite._intervals}}}),a.prototype.getType=function(e){if(!i(e))throw new n("time is required");var t=this._composite._intervals.findDataForIntervalContainingDate(e);if(i(t))return t.getType(e)},a.prototype.getValue=function(e,t){if(!i(e))throw new n("time is required");var r=this._composite._intervals.findDataForIntervalContainingDate(e);if(i(r))return r.getValue(e,t)},a.prototype.equals=function(e){return this===e||e instanceof a&&this._composite.equals(e._composite,o.equals)},a.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)},a}),define("DataSources/CompositePositionProperty",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/ReferenceFrame","./CompositeProperty","./Property"],function(t,n,e,o,r,i,a,s){"use strict";function l(e){this._referenceFrame=t(e,i.FIXED),this._definitionChanged=new r,this._composite=new a,this._composite.definitionChanged.addEventListener(l.prototype._raiseDefinitionChanged,this)}return e(l.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite.intervals}},referenceFrame:{get:function(){return this._referenceFrame},set:function(e){this._referenceFrame=e}}}),l.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,i.FIXED,t)},l.prototype.getValueInReferenceFrame=function(e,t,r){if(!n(e))throw new o("time is required.");if(!n(t))throw new o("referenceFrame is required.");var i=this._composite._intervals.findDataForIntervalContainingDate(e);if(n(i))return i.getValueInReferenceFrame(e,t,r)},l.prototype.equals=function(e){return this===e||e instanceof l&&this._referenceFrame===e._referenceFrame&&this._composite.equals(e._composite,s.equals)},l.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)},l}),define("Shaders/ShadowVolumeFS",[],function(){"use strict";return"#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\n#ifdef VECTOR_TILE\nuniform vec4 u_highlightColor;\n#else\nvarying vec4 v_color;\n#endif\nvoid main(void)\n{\n#ifdef VECTOR_TILE\ngl_FragColor = u_highlightColor;\n#else\ngl_FragColor = v_color;\n#endif\nczm_writeDepthClampedToFarPlane();\n}\n"}),define("Shaders/ShadowVolumeVS",[],function(){"use strict";return"#ifdef VECTOR_TILE\nattribute vec3 position;\nattribute float a_batchId;\nuniform mat4 u_modifiedModelViewProjection;\n#else\nattribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec4 color;\nattribute float batchId;\n#endif\n#ifdef EXTRUDED_GEOMETRY\nattribute vec3 extrudeDirection;\nuniform float u_globeMinimumAltitude;\n#endif\n#ifndef VECTOR_TILE\nvarying vec4 v_color;\n#endif\nvoid main()\n{\n#ifdef VECTOR_TILE\ngl_Position = czm_depthClampFarPlane(u_modifiedModelViewProjection * vec4(position, 1.0));\n#else\nv_color = color;\nvec4 position = czm_computePosition();\n#ifdef EXTRUDED_GEOMETRY\nfloat delta = min(u_globeMinimumAltitude, czm_geometricToleranceOverMeter * length(position.xyz));\ndelta *= czm_sceneMode == czm_sceneMode3D ? 1.0 : 0.0;\nposition = position + vec4(extrudeDirection * delta, 0.0);\n#endif\ngl_Position = czm_depthClampFarPlane(czm_modelViewProjectionRelativeToEye * position);\n#endif\n}\n"}),define("Scene/ClassificationType",["../Core/freezeObject"],function(e){"use strict";return e({TERRAIN:0,CESIUM_3D_TILE:1,BOTH:2})}),define("Scene/StencilFunction",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";return e({NEVER:t.NEVER,LESS:t.LESS,EQUAL:t.EQUAL,LESS_OR_EQUAL:t.LEQUAL,GREATER:t.GREATER,NOT_EQUAL:t.NOTEQUAL,GREATER_OR_EQUAL:t.GEQUAL,ALWAYS:t.ALWAYS})}),define("Scene/StencilOperation",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";return e({ZERO:t.ZERO,KEEP:t.KEEP,REPLACE:t.REPLACE,INCREMENT:t.INCR,DECREMENT:t.DECR,INVERT:t.INVERT,INCREMENT_WRAP:t.INCR_WRAP,DECREMENT_WRAP:t.DECR_WRAP})}),define("Scene/ClassificationPrimitive",["../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/GeometryInstance","../Core/isArray","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Shaders/ShadowVolumeFS","../Shaders/ShadowVolumeVS","../ThirdParty/when","./BlendingState","./ClassificationType","./DepthFunction","./PerInstanceColorAppearance","./Primitive","./SceneMode","./StencilFunction","./StencilOperation"],function(c,d,S,e,t,h,p,f,m,T,g,_,v,y,b,i,r,E,n,o,A,x,a,s){"use strict";var l=["color"];function u(e){e=d(e,d.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this.show=d(e.show,!0),this.classificationType=d(e.classificationType,E.BOTH),this.debugShowBoundingVolume=d(e.debugShowBoundingVolume,!1),this.debugShowShadowVolume=d(e.debugShowShadowVolume,!1),this._debugShowShadowVolume=!1,this._extruded=d(e._extruded,!1),this._uniformMap=e._uniformMap,this._sp=void 0,this._spStencil=void 0,this._spPick=void 0,this._rsStencilPreloadPass=void 0,this._rsStencilDepthPass=void 0,this._rsColorPass=void 0,this._rsPickPass=void 0,this._commandsIgnoreShow=[],this._ready=!1,this._readyPromise=i.defer(),this._primitive=void 0,this._pickPrimitive=e._pickPrimitive;var t,r=new o({flat:!0});S(this.geometryInstances)&&f(this.geometryInstances)&&1<this.geometryInstances.length&&(t=l),this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._primitiveOptions={geometryInstances:void 0,appearance:r,vertexCacheOptimize:d(e.vertexCacheOptimize,!1),interleave:d(e.interleave,!1),releaseGeometryInstances:d(e.releaseGeometryInstances,!0),allowPicking:d(e.allowPicking,!0),asynchronous:d(e.asynchronous,!0),compressVertices:d(e.compressVertices,!0),_readOnlyInstanceAttributes:t,_createBoundingVolumeFunction:void 0,_createRenderStatesFunction:void 0,_createShaderProgramFunction:void 0,_createCommandsFunction:void 0,_updateAndQueueCommandsFunction:void 0,_createPickOffsets:!0}}e(u.prototype,{vertexCacheOptimize:{get:function(){return this._primitiveOptions.vertexCacheOptimize}},interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},compressVertices:{get:function(){return this._primitiveOptions.compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}}),u.isSupported=function(e){return e.context.stencilBuffer};var C=15,w=0;function P(e){return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:e,frontFunction:a.ALWAYS,frontOperation:{fail:s.KEEP,zFail:s.DECREMENT_WRAP,zPass:s.DECREMENT_WRAP},backFunction:a.ALWAYS,backOperation:{fail:s.KEEP,zFail:s.INCREMENT_WRAP,zPass:s.INCREMENT_WRAP},reference:w,mask:C},depthTest:{enabled:!1},depthMask:!1}}function D(e){return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:e,frontFunction:a.ALWAYS,frontOperation:{fail:s.KEEP,zFail:s.KEEP,zPass:s.INCREMENT_WRAP},backFunction:a.ALWAYS,backOperation:{fail:s.KEEP,zFail:s.KEEP,zPass:s.DECREMENT_WRAP},reference:w,mask:C},depthTest:{enabled:!0,func:n.LESS_OR_EQUAL},depthMask:!1}}function O(e){return{stencilTest:{enabled:e,frontFunction:a.NOT_EQUAL,frontOperation:{fail:s.KEEP,zFail:s.KEEP,zPass:s.DECREMENT_WRAP},backFunction:a.NOT_EQUAL,backOperation:{fail:s.KEEP,zFail:s.KEEP,zPass:s.DECREMENT_WRAP},reference:w,mask:C},depthTest:{enabled:!1},depthMask:!1,blending:r.ALPHA_BLEND}}var I={stencilTest:{enabled:!0,frontFunction:a.NOT_EQUAL,frontOperation:{fail:s.KEEP,zFail:s.KEEP,zPass:s.DECREMENT_WRAP},backFunction:a.NOT_EQUAL,backOperation:{fail:s.KEEP,zFail:s.KEEP,zPass:s.DECREMENT_WRAP},reference:w,mask:C},depthTest:{enabled:!1},depthMask:!1};function M(e,t,r){if(!S(e._sp)){var i=t.context,n=e._primitive,o=b;o=e._primitive._batchTable.getVertexShaderCallback()(o),o=A._appendDistanceDisplayConditionToShader(n,o),o=A._modifyShaderPosition(e,o,t.scene3DOnly),o=A._updateColorAttribute(n,o),e._extruded&&(o=function(e,t){if(!e.compressVertices)return t;if(-1!==t.search(/attribute\s+vec3\s+extrudeDirection;/g)){var r="compressedAttributes",i="attribute vec2 "+r+";",n=t;return n=n.replace(/attribute\s+vec3\s+extrudeDirection;/g,""),[i,"vec3 extrudeDirection;\n",n=v.replaceMain(n,"czm_non_compressed_main"),"void main() \n{ \n    extrudeDirection = czm_octDecode(compressedAttributes, 65535.0);\n    czm_non_compressed_main(); \n}"].join("\n")}}(n,o));var a=e._extruded?"EXTRUDED_GEOMETRY":"",s=new v({defines:[a],sources:[o]}),l=new v({sources:[y]}),u=e._primitive._attributeLocations;if(e._spStencil=_.replaceCache({context:i,shaderProgram:e._spStencil,vertexShaderSource:s,fragmentShaderSource:l,attributeLocations:u}),e._primitive.allowPicking){var c=v.createPickVertexShaderSource(o);c=A._appendShowToShader(n,c),c=A._updatePickColorAttribute(c);var d=new v({defines:[a],sources:[c]}),h=new v({sources:[y],pickColorQualifier:"varying"});e._spPick=_.replaceCache({context:i,shaderProgram:e._spPick,vertexShaderSource:d,fragmentShaderSource:h,attributeLocations:u})}else e._spPick=_.fromCache({context:i,vertexShaderSource:s,fragmentShaderSource:l,attributeLocations:u});o=A._appendShowToShader(n,o),s=new v({defines:[a],sources:[o]}),e._sp=_.replaceCache({context:i,shaderProgram:e._sp,vertexShaderSource:s,fragmentShaderSource:l,attributeLocations:u})}}function R(e,t,r,i,n,o,a){!function(e,t){var r,i,n=e._primitive,o=3*n._va.length;t.length=o;var a=0,s=n._batchTable.getUniformMapCallback()(e._uniformMap);for(r=0;r<o;r+=3){var l=n._va[a++];i=t[r],S(i)||(i=t[r]=new m({owner:e,primitiveType:n._primitiveType})),i.vertexArray=l,i.renderState=e._rsStencilPreloadPass,i.shaderProgram=e._sp,i.uniformMap=s,i=t[r+1],S(i)||(i=t[r+1]=new m({owner:e,primitiveType:n._primitiveType})),i.vertexArray=l,i.renderState=e._rsStencilDepthPass,i.shaderProgram=e._sp,i.uniformMap=s,i=t[r+2],S(i)||(i=t[r+2]=new m({owner:e,primitiveType:n._primitiveType})),i.vertexArray=l,i.renderState=e._rsColorPass,i.shaderProgram=e._sp,i.uniformMap=s}var u=e._commandsIgnoreShow,c=e._spStencil,d=0;o=u.length=o/3*2;for(var h=0;h<o;h+=2){var p=u[h]=m.shallowClone(t[d],u[h]);p.shaderProgram=c,p.pass=T.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,(p=u[h+1]=m.shallowClone(t[d+1],u[h+1])).shaderProgram=c,p.pass=T.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,d+=3}}(e,o),function(e,t){var r,i,n=e._primitive,o=n._pickOffsets,a=3*o.length;t.length=a;var s=0,l=n._batchTable.getUniformMapCallback()(e._uniformMap);for(r=0;r<a;r+=3){var u=o[s++],c=u.offset,d=u.count,h=n._va[u.index];i=t[r],S(i)||(i=t[r]=new m({owner:e,primitiveType:n._primitiveType})),i.vertexArray=h,i.offset=c,i.count=d,i.renderState=e._rsStencilPreloadPass,i.shaderProgram=e._spStencil,i.uniformMap=l,i=t[r+1],S(i)||(i=t[r+1]=new m({owner:e,primitiveType:n._primitiveType})),i.vertexArray=h,i.offset=c,i.count=d,i.renderState=e._rsStencilDepthPass,i.shaderProgram=e._spStencil,i.uniformMap=l,i=t[r+2],S(i)||(i=t[r+2]=new m({owner:e,primitiveType:n._primitiveType})),i.vertexArray=h,i.offset=c,i.count=d,i.renderState=e._rsPickPass,i.shaderProgram=e._spPick,i.uniformMap=l}}(e,a)}function L(e,t){return Math.floor(e%t/3)}return u.prototype.update=function(e){if(this.show&&(S(this._primitive)||S(this.geometryInstances))){var l=this,t=this._primitiveOptions;if(!S(this._primitive)){var r,i,n,o=f(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],a=o.length;for(r=0;r<a;++r){var s=(i=o[r]).attributes;if(!S(s)||!S(s.color))throw new h("Not all of the geometry instances have the same color attribute.");if(S(n)&&!c.equals(n,s.color))throw new h("Not all of the geometry instances have the same color attribute.");S(n)||(n=s.color)}var u=new Array(a);for(r=0;r<a;++r)i=o[r],u[r]=new p({geometry:i.geometry,attributes:i.attributes,modelMatrix:i.modelMatrix,id:i.id,pickPrimitive:d(this._pickPrimitive,l)});t.geometryInstances=u,S(this._createBoundingVolumeFunction)&&(t._createBoundingVolumeFunction=function(e,t){l._createBoundingVolumeFunction(e,t)}),t._createRenderStatesFunction=function(e,t,r,i){!function(e,t,r,i){if(!S(e._rsStencilPreloadPass)){var n=!e.debugShowShadowVolume;e._rsStencilPreloadPass=g.fromCache(P(n)),e._rsStencilDepthPass=g.fromCache(D(n)),e._rsColorPass=g.fromCache(O(n)),e._rsPickPass=g.fromCache(I)}}(l)},t._createShaderProgramFunction=function(e,t,r){M(l,t)},t._createCommandsFunction=function(e,t,r,i,n,o,a){R(l,0,0,0,0,o,a)},S(this._updateAndQueueCommandsFunction)?t._updateAndQueueCommandsFunction=function(e,t,r,i,n,o,a,s){l._updateAndQueueCommandsFunction(e,t,r,i,n,o,a,s)}:t._updateAndQueueCommandsFunction=function(e,t,r,i,n,o,a,s){!function(e,t,r,i,n,o,a,s){var l,u=e._primitive;A._updateBoundingVolumes(u,t,n),t.mode===x.SCENE3D?l=u._boundingSphereWC:t.mode===x.COLUMBUS_VIEW?l=u._boundingSphereCV:t.mode===x.SCENE2D&&S(u._boundingSphere2D)?l=u._boundingSphere2D:S(u._boundingSphereMorph)&&(l=u._boundingSphereMorph);var c,d,h=t.commandList,p=t.passes;switch(e.classificationType){case E.TERRAIN:d=T.TERRAIN_CLASSIFICATION;break;case E.CESIUM_3D_TILE:d=T.CESIUM_3D_TILE_CLASSIFICATION;break;default:d=T.CLASSIFICATION}if(p.render){var f,m=r.length;for(c=0;c<m;++c)(f=r[c]).modelMatrix=n,f.boundingVolume=l[L(c,m)],f.cull=o,f.debugShowBoundingVolume=a,f.pass=d,h.push(f);if(t.invertClassification){var g=e._commandsIgnoreShow,_=g.length;for(c=0;c<_;++c){var v=Math.floor(c/2);(f=g[c]).modelMatrix=n,f.boundingVolume=l[v],f.cull=o,f.debugShowBoundingVolume=a,h.push(f)}}}if(p.pick){var y=i.length,b=u._pickOffsets;for(c=0;c<y;++c){var C=b[L(c,y)],w=i[c];w.modelMatrix=n,w.boundingVolume=l[C.index],w.cull=o,w.pass=d,h.push(w)}}}(l,t,r,i,n,o,a)},this._primitive=new A(t),this._primitive.readyPromise.then(function(e){l._ready=!0,l.releaseGeometryInstances&&(l.geometryInstances=void 0);var t=e._error;S(t)?l._readyPromise.reject(t):l._readyPromise.resolve(l)})}this.debugShowShadowVolume&&!this._debugShowShadowVolume&&this._ready?(this._debugShowShadowVolume=!0,this._rsStencilPreloadPass=g.fromCache(P(!1)),this._rsStencilDepthPass=g.fromCache(D(!1)),this._rsColorPass=g.fromCache(O(!1))):!this.debugShowShadowVolume&&this._debugShowShadowVolume&&(this._debugShowShadowVolume=!1,this._rsStencilPreloadPass=g.fromCache(P(!0)),this._rsStencilDepthPass=g.fromCache(D(!0)),this._rsColorPass=g.fromCache(O(!0))),this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e)}},u.prototype.getGeometryInstanceAttributes=function(e){if(!S(this._primitive))throw new h("must call update before calling getGeometryInstanceAttributes");return this._primitive.getGeometryInstanceAttributes(e)},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),t(this)},u}),define("Scene/GroundPrimitive",["../Core/BoundingSphere","../Core/buildModuleUrl","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/GeographicTilingScheme","../Core/GeometryInstance","../Core/isArray","../Core/Math","../Core/OrientedBoundingBox","../Core/Rectangle","../Core/Resource","../Renderer/Pass","../ThirdParty/when","./ClassificationPrimitive","./ClassificationType","./SceneMode"],function(g,e,t,v,c,r,y,i,n,_,o,b,C,w,S,T,a,E,s,A,x,P){"use strict";var l={u_globeMinimumAltitude:function(){return 55e3}},u=new a({url:e("Assets/approximateTerrainHeights.json")});function D(e){e=r(e,r.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this.show=r(e.show,!0),this.classificationType=r(e.classificationType,x.BOTH),this.debugShowBoundingVolume=r(e.debugShowBoundingVolume,!1),this.debugShowShadowVolume=r(e.debugShowShadowVolume,!1),this._boundingVolumes=[],this._boundingVolumes2D=[],this._ready=!1,this._readyPromise=s.defer(),this._primitive=void 0,this._maxHeight=void 0,this._minHeight=void 0,this._maxTerrainHeight=D._defaultMaxTerrainHeight,this._minTerrainHeight=D._defaultMinTerrainHeight,this._boundingSpheresKeys=[],this._boundingSpheres=[];this._primitiveOptions={geometryInstances:void 0,vertexCacheOptimize:r(e.vertexCacheOptimize,!1),interleave:r(e.interleave,!1),releaseGeometryInstances:r(e.releaseGeometryInstances,!0),allowPicking:r(e.allowPicking,!0),asynchronous:r(e.asynchronous,!0),compressVertices:r(e.compressVertices,!0),_createBoundingVolumeFunction:void 0,_updateAndQueueCommandsFunction:void 0,_pickPrimitive:this,_extruded:!0,_uniformMap:l}}function O(n){return function(e,t){var r=t.maximumRadius,i=r/Math.cos(.5*e)-r;return n._maxHeight+i}}function I(r){return function(e,t){return r._minHeight}}i(D.prototype,{vertexCacheOptimize:{get:function(){return this._primitiveOptions.vertexCacheOptimize}},interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},compressVertices:{get:function(){return this._primitiveOptions.compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}}),D.isSupported=A.isSupported,D._defaultMaxTerrainHeight=9e3,D._defaultMinTerrainHeight=-1e5,D._terrainHeights=void 0,D._terrainHeightsMaxLevel=6;var M=new v,R=new v,L=new v,N=new c,k=new T,d=new o,h=[new c,new c,new c,new c],p=new t;function F(e,t){var r=e.mapProjection.ellipsoid;if(!y(t.attributes)||!y(t.attributes.position3DHigh))return y(t.rectangle)?t.rectangle:void 0;for(var i=t.attributes.position3DHigh.values,n=t.attributes.position3DLow.values,o=i.length,a=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,u=Number.NEGATIVE_INFINITY,c=0;c<o;c+=3){var d=v.unpack(i,c,M),h=v.unpack(n,c,R),p=v.add(d,h,L),f=r.cartesianToCartographic(p,N),m=f.latitude,g=f.longitude;a=Math.min(a,m),s=Math.min(s,g),l=Math.max(l,m),u=Math.max(u,g)}var _=k;return _.north=l,_.south=a,_.east=u,_.west=s,_}var B=new v,U=new v,V=new c,z=new v,q=new v;function G(e){c.fromRadians(e.east,e.north,0,h[0]),c.fromRadians(e.west,e.north,0,h[1]),c.fromRadians(e.east,e.south,0,h[2]),c.fromRadians(e.west,e.south,0,h[3]);var t,r=0,i=0,n=0,o=0,a=D._terrainHeightsMaxLevel;for(t=0;t<=a;++t){for(var s=!1,l=0;l<4;++l){var u=h[l];if(d.positionToTileXY(u,t,p),0===l)n=p.x,o=p.y;else if(n!==p.x||o!==p.y){s=!0;break}}if(s)break;r=n,i=o}if(0!==t)return{x:r,y:i,level:a<t?a:t-1}}var f=new g;function W(e,t){var r=G(e),i=D._defaultMaxTerrainHeight;if(y(r)){var n=r.level+"-"+r.x+"-"+r.y,o=D._terrainHeights[n];y(o)&&(i=o[1])}var a=g.fromRectangle3D(e,t,0);return g.fromRectangle3D(e,t,i,f),g.union(a,f,a)}function H(e,t){return Math.floor(e%t/3)}return D._initialized=!1,D._initPromise=void 0,D.initializeTerrainHeights=function(){var e=D._initPromise;return y(e)?e:D._initPromise=u.fetchJson().then(function(e){D._initialized=!0,D._terrainHeights=e})},D.prototype.update=function(e){if(this.show&&(y(this._primitive)||y(this.geometryInstances)))if(D._initialized){var l=this,t=this._primitiveOptions;if(!y(this._primitive)){var r,i,n,o,a,s=e.mapProjection.ellipsoid,u=C(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],c=u.length,d=new Array(c);for(o=0;o<c;++o){var h=F(e,i=(r=u[o]).geometry);y(a)?y(h)&&T.union(a,h,a):a=h;var p=r.id;if(y(p)&&y(h)){var f=W(h,s);this._boundingSpheresKeys.push(p),this._boundingSpheres.push(f)}if(n=i.constructor,!y(n)||!y(n.createShadowVolume))throw new _("Not all of the geometry instances have GroundPrimitive support.")}!function(e,t,r){var i=G(t),n=D._defaultMinTerrainHeight,o=D._defaultMaxTerrainHeight;if(y(i)){var a=i.level+"-"+i.x+"-"+i.y,s=D._terrainHeights[a];y(s)&&(n=s[0],o=s[1]),r.cartographicToCartesian(T.northeast(t,V),B),r.cartographicToCartesian(T.southwest(t,V),U),v.subtract(U,B,z),v.add(B,v.multiplyByScalar(z,.5,z),z);var l=r.scaleToGeodeticSurface(z,q);if(y(l)){var u=v.distance(z,l);n=Math.min(n,-u)}else n=D._defaultMinTerrainHeight}e._minTerrainHeight=Math.max(D._defaultMinTerrainHeight,n),e._maxTerrainHeight=o}(this,a,e.mapProjection.ellipsoid);var m=e.terrainExaggeration;for(this._minHeight=this._minTerrainHeight*m,this._maxHeight=this._maxTerrainHeight*m,o=0;o<c;++o)n=(i=(r=u[o]).geometry).constructor,d[o]=new b({geometry:n.createShadowVolume(i,I(this),O(this)),attributes:r.attributes,id:r.id});t.geometryInstances=d,t._createBoundingVolumeFunction=function(e,t){!function(e,t,r){var i=t.mapProjection.ellipsoid,n=F(t,r);if(n.width<w.PI){var o=S.fromRectangle(n,e._maxHeight,e._minHeight,i);e._boundingVolumes.push(o)}else{var a=r.attributes.position3DHigh.values,s=r.attributes.position3DLow.values;e._boundingVolumes.push(g.fromEncodedCartesianVertices(a,s))}if(!t.scene3DOnly){var l=t.mapProjection,u=g.fromRectangleWithHeights2D(n,l,e._maxHeight,e._minHeight);v.fromElements(u.center.z,u.center.x,u.center.y,u.center),e._boundingVolumes2D.push(u)}}(l,e,t)},t._updateAndQueueCommandsFunction=function(e,t,r,i,n,o,a,s){!function(e,t,r,i,n,o,a,s){var l,u;switch(l=t.mode===P.SCENE3D?e._boundingVolumes:e._boundingVolumes2D,e.classificationType){case x.TERRAIN:u=E.TERRAIN_CLASSIFICATION;break;case x.CESIUM_3D_TILE:u=E.CESIUM_3D_TILE_CLASSIFICATION;break;default:u=E.CLASSIFICATION}var c=t.commandList,d=t.passes;if(d.render){var h,p,f=r.length;for(h=0;h<f;++h)(p=r[h]).owner=e,p.modelMatrix=n,p.boundingVolume=l[H(h,f)],p.cull=o,p.debugShowBoundingVolume=a,p.pass=u,c.push(p);if(t.invertClassification){var m=e._primitive._commandsIgnoreShow,g=m.length;for(h=0;h<g;++h){var _=Math.floor(h/2);(p=m[h]).modelMatrix=n,p.boundingVolume=l[_],p.cull=o,p.debugShowBoundingVolume=a,c.push(p)}}}if(d.pick)for(var v=i.length,y=e._primitive._primitive._pickOffsets,b=0;b<v;++b){var C=l[y[H(b,v)].index],w=i[b];w.owner=e,w.modelMatrix=n,w.boundingVolume=C,w.cull=o,w.pass=u,c.push(w)}}(l,t,r,i,n,o,a)},this._primitive=new A(t),this._primitive.readyPromise.then(function(e){l._ready=!0,l.releaseGeometryInstances&&(l.geometryInstances=void 0);var t=e._error;y(t)?l._readyPromise.reject(t):l._readyPromise.resolve(l)})}this._primitive.debugShowShadowVolume=this.debugShowShadowVolume,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e)}else{if(!this.asynchronous)throw new _("For synchronous GroundPrimitives, you must call GroundPrimitive.initializeTerrainHeights() and wait for the returned promise to resolve.");D.initializeTerrainHeights()}},D.prototype.getBoundingSphere=function(e){var t=this._boundingSpheresKeys.indexOf(e);if(-1!==t)return this._boundingSpheres[t]},D.prototype.getGeometryInstanceAttributes=function(e){if(!y(this._primitive))throw new _("must call update before calling getGeometryInstanceAttributes");return this._primitive.getGeometryInstanceAttributes(e)},D.prototype.isDestroyed=function(){return!1},D.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),n(this)},D}),define("DataSources/CorridorGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/CorridorGeometry","../Core/CorridorOutlineGeometry","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/oneTimeWarning","../Core/ShowGeometryInstanceAttribute","../Scene/GroundPrimitive","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(b,C,w,S,T,E,e,r,A,t,x,i,P,D,O,s,I,M,R,L,n,N,o,a,k,F){"use strict";var B=new N(b.WHITE),U=new o(!0),V=new o(!0),z=new o(!1),q=new o(b.BLACK),G=new o(n.DISABLED),W=new o(new t),H=new b;function l(e){this.id=e,this.vertexFormat=void 0,this.positions=void 0,this.width=void 0,this.cornerType=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0}function u(e,t){if(!E(e))throw new A("entity is required");if(!E(t))throw new A("scene is required");this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(u.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._isClosed=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new i,this._showProperty=void 0,this._materialProperty=void 0,this._hasConstantOutline=!0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._onTerrain=!1,this._options=new l(e),this._onEntityPropertyChanged(e,"corridor",e.corridor,void 0)}function c(e,t,r){this._primitives=e,this._groundPrimitives=t,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=r,this._options=new l(r._entity)}return e(u,{perInstanceColorAppearanceType:{value:R},materialAppearanceType:{value:M}}),e(u.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!E(this._entity.availability)&&F.isConstant(this._showProperty)&&F.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!E(this._entity.availability)&&F.isConstant(this._showProperty)&&F.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayCondition}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}}),u.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)},u.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)},u.prototype.createFillGeometryInstance=function(e){if(!E(e))throw new A("time is required.");if(!this._fillEnabled)throw new A("This instance does not represent a filled geometry.");var t,r=this._entity,i=r.isAvailable(e),n=new s(i&&r.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),o=x.fromDistanceDisplayCondition(this._distanceDisplayCondition.getValue(e));if(this._materialProperty instanceof N){var a=b.WHITE;E(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(a=this._materialProperty.color.getValue(e)),t={show:n,distanceDisplayCondition:o,color:C.fromColor(a)}}else t={show:n,distanceDisplayCondition:o};return new P({id:r,geometry:new w(this._options),attributes:t})},u.prototype.createOutlineGeometryInstance=function(e){if(!E(e))throw new A("time is required.");if(!this._outlineEnabled)throw new A("This instance does not represent an outlined geometry.");var t=this._entity,r=t.isAvailable(e),i=F.getValueOrDefault(this._outlineColorProperty,e,b.BLACK);return new P({id:t,geometry:new S(this._options),attributes:{show:new s(r&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:C.fromColor(i),distanceDisplayCondition:x.fromDistanceDisplayCondition(this._distanceDisplayCondition.getValue(e))}})},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){this._entitySubscription(),r(this)},u.prototype._onEntityPropertyChanged=function(e,t,r,i){if("availability"===t||"corridor"===t){var n=this._entity.corridor;if(E(n)){var o=n.fill,a=!E(o)||!o.isConstant||o.getValue(D.MINIMUM_VALUE),s=n.outline,l=E(s);if(l&&s.isConstant&&(l=s.getValue(D.MINIMUM_VALUE)),a||l){var u=n.positions,c=n.show;if(E(c)&&c.isConstant&&!c.getValue(D.MINIMUM_VALUE)||!E(u))(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this));else{var d=T(n.material,B),h=d instanceof N;this._materialProperty=d,this._fillProperty=T(o,V),this._showProperty=T(c,U),this._showOutlineProperty=T(n.outline,z),this._outlineColorProperty=l?T(n.outlineColor,q):void 0,this._shadowsProperty=T(n.shadows,G),this._distanceDisplayCondition=T(n.distanceDisplayCondition,W);var p=n.height,f=n.extrudedHeight,m=n.granularity,g=n.width,_=n.outlineWidth,v=n.cornerType,y=a&&!E(p)&&!E(f)&&h&&I.isSupported(this._scene);if(l&&y&&(O(O.geometryOutlines),l=!1),this._fillEnabled=a,this._onTerrain=y,this._isClosed=E(f)||y,this._outlineEnabled=l,u.isConstant&&F.isConstant(p)&&F.isConstant(f)&&F.isConstant(m)&&F.isConstant(g)&&F.isConstant(_)&&F.isConstant(v)&&(!y||F.isConstant(d))){var b=this._options;b.vertexFormat=h?R.VERTEX_FORMAT:M.MaterialSupport.TEXTURED.vertexFormat,b.positions=u.getValue(D.MINIMUM_VALUE,b.positions),b.height=E(p)?p.getValue(D.MINIMUM_VALUE):void 0,b.extrudedHeight=E(f)?f.getValue(D.MINIMUM_VALUE):void 0,b.granularity=E(m)?m.getValue(D.MINIMUM_VALUE):void 0,b.width=E(g)?g.getValue(D.MINIMUM_VALUE):void 0,b.cornerType=E(v)?v.getValue(D.MINIMUM_VALUE):void 0,this._outlineWidth=E(_)?_.getValue(D.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}},u.prototype.createDynamicUpdater=function(e,t){if(!this._dynamic)throw new A("This instance does not represent dynamic geometry.");if(!E(e))throw new A("primitives is required.");return new c(e,t,this)},c.prototype.update=function(e){if(!E(e))throw new A("time is required.");var t=this._geometryUpdater,r=t._onTerrain,i=this._primitives,n=this._groundPrimitives;r?n.removeAndDestroy(this._primitive):(i.removeAndDestroy(this._primitive),i.removeAndDestroy(this._outlinePrimitive),this._outlinePrimitive=void 0),this._primitive=void 0;var o=t._entity,a=o.corridor;if(o.isShowing&&o.isAvailable(e)&&F.getValueOrDefault(a.show,e,!0)){var s=this._options,l=F.getValueOrUndefined(a.positions,e,s.positions),u=F.getValueOrUndefined(a.width,e);if(E(l)&&E(u)){s.positions=l,s.width=u,s.height=F.getValueOrUndefined(a.height,e),s.extrudedHeight=F.getValueOrUndefined(a.extrudedHeight,e),s.granularity=F.getValueOrUndefined(a.granularity,e),s.cornerType=F.getValueOrUndefined(a.cornerType,e);var c=this._geometryUpdater.shadowsProperty.getValue(e),d=this._geometryUpdater.distanceDisplayConditionProperty.getValue(e),h=x.fromDistanceDisplayCondition(d);if(!E(a.fill)||a.fill.getValue(e)){var p=t.fillMaterialProperty,f=k.getValue(e,p,this._material);if(this._material=f,r){var m=b.WHITE;E(p.color)&&(m=p.color.getValue(e)),this._primitive=n.add(new I({geometryInstances:new P({id:o,geometry:new w(s),attributes:{color:C.fromColor(m),distanceDisplayCondition:h}}),asynchronous:!1,shadows:c}))}else{var g=new M({material:f,translucent:f.isTranslucent(),closed:E(s.extrudedHeight)});s.vertexFormat=g.vertexFormat,this._primitive=i.add(new L({geometryInstances:new P({id:o,geometry:new w(s),attributes:{distanceDisplayCondition:h}}),appearance:g,asynchronous:!1,shadows:c}))}}if(!r&&E(a.outline)&&a.outline.getValue(e)){s.vertexFormat=R.VERTEX_FORMAT;var _=F.getValueOrClonedDefault(a.outlineColor,e,b.BLACK,H),v=F.getValueOrDefault(a.outlineWidth,e,1),y=1!==_.alpha;this._outlinePrimitive=i.add(new L({geometryInstances:new P({id:o,geometry:new S(s),attributes:{color:C.fromColor(_),distanceDisplayCondition:h}}),appearance:new R({flat:!0,translucent:y,renderState:{lineWidth:t._scene.clampLineWidth(v)}}),asynchronous:!1,shadows:c}))}}}},c.prototype.getBoundingSphere=function(e,t){return a(e,this._primitive,this._outlinePrimitive,t)},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){var e=this._primitives,t=this._groundPrimitives;this._geometryUpdater._onTerrain?t.removeAndDestroy(this._primitive):e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),r(this)},u}),define("DataSources/DataSource",["../Core/defineProperties","../Core/DeveloperError"],function(e,t){"use strict";function r(){t.throwInstantiationError()}return e(r.prototype,{name:{get:t.throwInstantiationError},clock:{get:t.throwInstantiationError},entities:{get:t.throwInstantiationError},isLoading:{get:t.throwInstantiationError},changedEvent:{get:t.throwInstantiationError},errorEvent:{get:t.throwInstantiationError},loadingEvent:{get:t.throwInstantiationError},show:{get:t.throwInstantiationError},clustering:{get:t.throwInstantiationError}}),r.prototype.update=t.throwInstantiationError,r.setLoading=function(e,t){e._isLoading!==t&&(t?e._entityCollection.suspendEvents():e._entityCollection.resumeEvents(),e._isLoading=t,e._loading.raiseEvent(e,t))},r}),define("Scene/SceneTransforms",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/defined","../Core/DeveloperError","../Core/Math","../Core/Matrix4","../Core/OrthographicFrustum","../Core/OrthographicOffCenterFrustum","../Core/Transforms","./SceneMode"],function(e,w,S,d,t,T,E,A,x,P,D,O,I){"use strict";var M={},R=new d(0,0,0,1),L=new d,N=new e,k=new w,F=new w;M.wgs84ToWindowCoordinates=function(e,t,r){return M.wgs84WithEyeOffsetToWindowCoordinates(e,t,S.ZERO,r)};var s=new d,l=new S;function B(e,t,r,i){var n=r.viewMatrix,o=x.multiplyByVector(n,d.fromElements(e.x,e.y,e.z,1,s),s),a=S.multiplyComponents(t,S.normalize(o,l),l);return o.x+=t.x+a.x,o.y+=t.y+a.y,o.z+=a.z,x.multiplyByVector(r.frustum.projectionMatrix,o,i)}var U=new t(Math.PI,A.PI_OVER_TWO),V=new S,z=new S;M.wgs84WithEyeOffsetToWindowCoordinates=function(e,t,r,i){if(!T(e))throw new E("scene is required.");if(!T(t))throw new E("position is required.");var n=e.frameState,o=M.computeActualWgs84Position(n,t,R);if(T(o)){var a=e.canvas,s=N;s.x=0,s.y=0,s.width=a.clientWidth,s.height=a.clientHeight;var l=e.camera,u=!1;if(n.mode===I.SCENE2D){var c=e.mapProjection,d=U,h=c.project(d,V),p=S.clone(l.position,z),f=l.frustum.clone(),m=x.computeViewportTransformation(s,0,1,new x),g=l.frustum.projectionMatrix,_=l.positionWC.y,v=S.fromElements(A.sign(_)*h.x-_,0,-l.positionWC.x),y=O.pointToGLWindowCoordinates(g,m,v);if(0===_||y.x<=0||y.x>=a.clientWidth)u=!0;else{if(y.x>.5*a.clientWidth){s.width=y.x,l.frustum.right=h.x-_,L=B(o,r,l,L),M.clipToGLWindowCoordinates(s,L,k),s.x+=y.x,l.position.x=-l.position.x;var b=l.frustum.right;l.frustum.right=-l.frustum.left,l.frustum.left=-b,L=B(o,r,l,L),M.clipToGLWindowCoordinates(s,L,F)}else{s.x+=y.x,s.width-=y.x,l.frustum.left=-h.x-_,L=B(o,r,l,L),M.clipToGLWindowCoordinates(s,L,k),s.x=s.x-s.width,l.position.x=-l.position.x;var C=l.frustum.left;l.frustum.left=-l.frustum.right,l.frustum.right=-C,L=B(o,r,l,L),M.clipToGLWindowCoordinates(s,L,F)}S.clone(p,l.position),l.frustum=f.clone(),((i=w.clone(k,i)).x<0||i.x>a.clientWidth)&&(i.x=F.x)}}if(n.mode!==I.SCENE2D||u){if((L=B(o,r,l,L)).z<0&&!(l.frustum instanceof P)&&!(l.frustum instanceof D))return;i=M.clipToGLWindowCoordinates(s,L,i)}return i.y=a.clientHeight-i.y,i}},M.wgs84ToDrawingBufferCoordinates=function(e,t,r){if(r=M.wgs84ToWindowCoordinates(e,t,r),T(r))return M.transformWindowToDrawingBuffer(e,r,r)};var u=new S,c=new t;M.computeActualWgs84Position=function(e,t,r){var i=e.mode;if(i===I.SCENE3D)return S.clone(t,r);var n=e.mapProjection,o=n.ellipsoid.cartesianToCartographic(t,c);if(T(o)){if(n.project(o,u),i===I.COLUMBUS_VIEW)return S.fromElements(u.z,u.x,u.y,r);if(i===I.SCENE2D)return S.fromElements(0,u.x,u.y,r);var a=e.morphTime;return S.fromElements(A.lerp(u.z,t.x,a),A.lerp(u.x,t.y,a),A.lerp(u.y,t.z,a),r)}};var i=new S,n=new S,o=new x;M.clipToGLWindowCoordinates=function(e,t,r){return S.divideByScalar(t,t.w,i),x.computeViewportTransformation(e,0,1,o),x.multiplyByPoint(o,i,n),w.fromCartesian3(n,r)},M.transformWindowToDrawingBuffer=function(e,t,r){var i=e.canvas,n=e.drawingBufferWidth/i.clientWidth,o=e.drawingBufferHeight/i.clientHeight;return w.fromElements(t.x*n,t.y*o,r)};var h=new d,p=new d;return M.drawingBufferToWgs84Coordinates=function(e,t,r,i){var n,o=e.context.uniformState,a=e._passState.viewport,s=d.clone(d.UNIT_W,h);s.x=(t.x-a.x)/a.width*2-1,s.y=(t.y-a.y)/a.height*2-1,s.z=2*r-1,s.w=1;var l=e.camera.frustum;if(T(l.fovy)){var u=1/(n=x.multiplyByVector(o.inverseViewProjection,s,p)).w;S.multiplyByScalar(n,u,n)}else{T(l._offCenterFrustum)&&(l=l._offCenterFrustum);var c=o.currentFrustum;(n=p).x=.5*(s.x*(l.right-l.left)+l.left+l.right),n.y=.5*(s.y*(l.top-l.bottom)+l.bottom+l.top),n.z=.5*(s.z*(c.x-c.y)-c.x-c.y),n.w=1,n=x.multiplyByVector(o.inverseView,n,n)}return S.fromCartesian4(n,i)},M}),define("Scene/Billboard",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/Color","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/Matrix4","../Core/NearFarScalar","../Core/Resource","./HeightReference","./HorizontalOrigin","./SceneMode","./SceneTransforms","./VerticalOrigin"],function(l,u,d,e,h,c,p,f,m,t,g,_,v,y,r,b,C,w,S,T){"use strict";function E(e,t){if(e=f(e,f.EMPTY_OBJECT),m(e.disableDepthTestDistance)&&e.disableDepthTestDistance<0)throw new g("disableDepthTestDistance must be greater than or equal to 0.0.");var r=e.translucencyByDistance,i=e.pixelOffsetScaleByDistance,n=e.scaleByDistance,o=e.distanceDisplayCondition;if(m(r)){if(r.far<=r.near)throw new g("translucencyByDistance.far must be greater than translucencyByDistance.near.");r=y.clone(r)}if(m(i)){if(i.far<=i.near)throw new g("pixelOffsetScaleByDistance.far must be greater than pixelOffsetScaleByDistance.near.");i=y.clone(i)}if(m(n)){if(n.far<=n.near)throw new g("scaleByDistance.far must be greater than scaleByDistance.near.");n=y.clone(n)}if(m(o)){if(o.far<=o.near)throw new g("distanceDisplayCondition.far must be greater than distanceDisplayCondition.near.");o=_.clone(o)}this._show=f(e.show,!0),this._position=d.clone(f(e.position,d.ZERO)),this._actualPosition=d.clone(this._position),this._pixelOffset=u.clone(f(e.pixelOffset,u.ZERO)),this._translate=new u(0,0),this._eyeOffset=d.clone(f(e.eyeOffset,d.ZERO)),this._heightReference=f(e.heightReference,b.NONE),this._verticalOrigin=f(e.verticalOrigin,T.CENTER),this._horizontalOrigin=f(e.horizontalOrigin,C.CENTER),this._scale=f(e.scale,1),this._color=c.clone(f(e.color,c.WHITE)),this._rotation=f(e.rotation,0),this._alignedAxis=d.clone(f(e.alignedAxis,d.ZERO)),this._width=e.width,this._height=e.height,this._scaleByDistance=n,this._translucencyByDistance=r,this._pixelOffsetScaleByDistance=i,this._sizeInMeters=f(e.sizeInMeters,!1),this._distanceDisplayCondition=o,this._disableDepthTestDistance=f(e.disableDepthTestDistance,0),this._id=e.id,this._collection=f(e.collection,t),this._pickId=void 0,this._pickPrimitive=f(e._pickPrimitive,this),this._billboardCollection=t,this._dirty=!1,this._index=-1,this._batchIndex=void 0,this._imageIndex=-1,this._imageIndexPromise=void 0,this._imageId=void 0,this._image=void 0,this._imageSubRegion=void 0,this._imageWidth=void 0,this._imageHeight=void 0;var a=e.image,s=e.imageId;m(a)&&(m(s)||(s="string"==typeof a?a:m(a.src)?a.src:p()),this._imageId=s,this._image=a),m(e.imageSubRegion)&&(this._imageId=s,this._imageSubRegion=e.imageSubRegion),m(this._billboardCollection._textureAtlas)&&this._loadImage(),this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=w.SCENE3D,this._clusterShow=!0,this._updateClamping()}var i=E.SHOW_INDEX=0,n=E.POSITION_INDEX=1,o=E.PIXEL_OFFSET_INDEX=2,a=E.EYE_OFFSET_INDEX=3,s=E.HORIZONTAL_ORIGIN_INDEX=4,A=E.VERTICAL_ORIGIN_INDEX=5,x=E.SCALE_INDEX=6,P=E.IMAGE_INDEX_INDEX=7,D=E.COLOR_INDEX=8,O=E.ROTATION_INDEX=9,I=E.ALIGNED_AXIS_INDEX=10,M=E.SCALE_BY_DISTANCE_INDEX=11,R=E.TRANSLUCENCY_BY_DISTANCE_INDEX=12,L=E.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX=13,N=E.DISTANCE_DISPLAY_CONDITION=14,k=E.DISABLE_DEPTH_DISTANCE=15;function F(e,t){var r=e._billboardCollection;m(r)&&(r._updateBillboard(e,t),e._dirty=!0)}E.NUMBER_OF_PROPERTIES=16,t(E.prototype,{show:{get:function(){return this._show},set:function(e){if(!m(e))throw new g("value is required.");this._show!==e&&(this._show=e,F(this,i))}},position:{get:function(){return this._position},set:function(e){if(!m(e))throw new g("value is required.");var t=this._position;d.equals(t,e)||(d.clone(e,t),d.clone(e,this._actualPosition),this._updateClamping(),F(this,n))}},heightReference:{get:function(){return this._heightReference},set:function(e){if(!m(e))throw new g("value is required.");e!==this._heightReference&&(this._heightReference=e,this._updateClamping(),F(this,n))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){if(!m(e))throw new g("value is required.");var t=this._pixelOffset;u.equals(t,e)||(u.clone(e,t),F(this,o))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){if(m(e)&&e.far<=e.near)throw new g("far distance must be greater than near distance.");var t=this._scaleByDistance;y.equals(t,e)||(this._scaleByDistance=y.clone(e,t),F(this,M))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){if(m(e)&&e.far<=e.near)throw new g("far distance must be greater than near distance.");var t=this._translucencyByDistance;y.equals(t,e)||(this._translucencyByDistance=y.clone(e,t),F(this,R))}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){if(m(e)&&e.far<=e.near)throw new g("far distance must be greater than near distance.");var t=this._pixelOffsetScaleByDistance;y.equals(t,e)||(this._pixelOffsetScaleByDistance=y.clone(e,t),F(this,L))}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){if(!m(e))throw new g("value is required.");var t=this._eyeOffset;d.equals(t,e)||(d.clone(e,t),F(this,a))}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){if(!m(e))throw new g("value is required.");this._horizontalOrigin!==e&&(this._horizontalOrigin=e,F(this,s))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){if(!m(e))throw new g("value is required.");this._verticalOrigin!==e&&(this._verticalOrigin=e,F(this,A))}},scale:{get:function(){return this._scale},set:function(e){if(!m(e))throw new g("value is required.");this._scale!==e&&(this._scale=e,F(this,x))}},color:{get:function(){return this._color},set:function(e){if(!m(e))throw new g("value is required.");var t=this._color;c.equals(t,e)||(c.clone(e,t),F(this,D))}},rotation:{get:function(){return this._rotation},set:function(e){if(!m(e))throw new g("value is required.");this._rotation!==e&&(this._rotation=e,F(this,O))}},alignedAxis:{get:function(){return this._alignedAxis},set:function(e){if(!m(e))throw new g("value is required.");var t=this._alignedAxis;d.equals(t,e)||(d.clone(e,t),F(this,I))}},width:{get:function(){return f(this._width,this._imageWidth)},set:function(e){this._width!==e&&(this._width=e,F(this,P))}},height:{get:function(){return f(this._height,this._imageHeight)},set:function(e){this._height!==e&&(this._height=e,F(this,P))}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(e){this._sizeInMeters!==e&&(this._sizeInMeters=e,F(this,D))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(!_.equals(e,this._distanceDisplayCondition)){if(m(e)&&e.far<=e.near)throw new g("far distance must be greater than near distance.");this._distanceDisplayCondition=_.clone(e,this._distanceDisplayCondition),F(this,N)}}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){if(this._disableDepthTestDistance!==e){if(!m(e)||e<0)throw new g("disableDepthTestDistance must be greater than or equal to 0.0.");this._disableDepthTestDistance=e,F(this,k)}}},id:{get:function(){return this._id},set:function(e){this._id=e,m(this._pickId)&&(this._pickId.object.id=e)}},pickPrimitive:{get:function(){return this._pickPrimitive},set:function(e){this._pickPrimitive=e,m(this._pickId)&&(this._pickId.object.primitive=e)}},image:{get:function(){return this._imageId},set:function(e){m(e)?"string"==typeof e?this.setImage(e,e):e instanceof r?this.setImage(e.url,e):m(e.src)?this.setImage(e.src,e):this.setImage(p(),e):(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=void 0,this._image=void 0,this._imageIndexPromise=void 0,F(this,P))}},ready:{get:function(){return-1!==this._imageIndex}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=d.clone(e,this._actualClampedPosition),F(this,n)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){this._clusterShow!==e&&(this._clusterShow=e,F(this,i))}}}),E.prototype.getPickId=function(e){return m(this._pickId)||(this._pickId=e.createPickId({primitive:this._pickPrimitive,collection:this._collection,id:this._id})),this._pickId},E.prototype._updateClamping=function(){E._updateClamping(this._billboardCollection,this)};var B=new h,U=new d;E._updateClamping=function(e,r){var t=e._scene;if(m(t)&&m(t.globe)){var i=t.globe,n=i.ellipsoid,o=i._surface,a=t.frameState.mode,s=a!==r._mode;if(r._mode=a,(r._heightReference===b.NONE||s)&&m(r._removeCallbackFunc)&&(r._removeCallbackFunc(),r._removeCallbackFunc=void 0,r._clampedPosition=void 0),r._heightReference!==b.NONE&&m(r._position)){var l=n.cartesianToCartographic(r._position);if(m(l)){m(r._removeCallbackFunc)&&r._removeCallbackFunc(),r._removeCallbackFunc=o.updateHeight(l,c),h.clone(l,B);var u=i.getHeight(l);m(u)&&(B.height=u),n.cartographicToCartesian(B,U),c(U)}else r._actualClampedPosition=void 0}}else if(r._heightReference!==b.NONE)throw new g("Height reference is not supported without a scene and globe.");function c(e){if(r._heightReference===b.RELATIVE_TO_GROUND)if(r._mode===w.SCENE3D){var t=n.cartesianToCartographic(e,B);t.height+=l.height,n.cartographicToCartesian(t,e)}else e.x+=l.height;r._clampedPosition=d.clone(e,r._clampedPosition)}},E.prototype._loadImage=function(){var e,r=this._billboardCollection._textureAtlas,i=this._imageId,n=this._image,o=this._imageSubRegion;if(m(n)&&(e=r.addImage(i,n)),m(o)&&(e=r.addSubRegion(i,o)),this._imageIndexPromise=e,m(e)){var a=this;e.then(function(e){if(a._imageId===i&&a._image===n&&l.equals(a._imageSubRegion,o)){var t=r.textureCoordinates[e];a._imageWidth=r.texture.width*t.width,a._imageHeight=r.texture.height*t.height,a._imageIndex=e,a._ready=!0,a._image=void 0,a._imageIndexPromise=void 0,F(a,P)}}).otherwise(function(e){console.error("Error loading image for billboard: "+e),a._imageIndexPromise=void 0})}},E.prototype.setImage=function(e,t){if(!m(e))throw new g("id is required.");if(!m(t))throw new g("image is required.");this._imageId!==e&&(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=e,this._image=t,m(this._billboardCollection._textureAtlas)&&this._loadImage())},E.prototype.setImageSubRegion=function(e,t){if(!m(e))throw new g("id is required.");if(!m(t))throw new g("subRegion is required.");this._imageId===e&&l.equals(this._imageSubRegion,t)||(this._imageIndex=-1,this._imageId=e,this._imageSubRegion=l.clone(t),m(this._billboardCollection._textureAtlas)&&this._loadImage())},E.prototype._setTranslate=function(e){if(!m(e))throw new g("value is required.");var t=this._translate;u.equals(t,e)||(u.clone(e,t),F(this,o))},E.prototype._getActualPosition=function(){return m(this._clampedPosition)?this._clampedPosition:this._actualPosition},E.prototype._setActualPosition=function(e){m(this._clampedPosition)||d.clone(e,this._actualPosition),F(this,n)};var V=new e;E._computeActualPosition=function(e,t,r,i){return m(e._clampedPosition)?(r.mode!==e._mode&&e._updateClamping(),e._clampedPosition):r.mode===w.SCENE3D?t:(v.multiplyByPoint(i,t,V),S.computeActualWgs84Position(r,V))};var z=new d;E._computeScreenSpacePosition=function(e,t,r,i,n,o){var a=v.multiplyByPoint(e,t,z),s=S.wgs84WithEyeOffsetToWindowCoordinates(n,a,r,o);if(m(s))return u.add(s,i,s),s};var q=new u(0,0);return E.prototype.computeScreenSpacePosition=function(e,t){var r=this._billboardCollection;if(m(t)||(t=new u),!m(r))throw new g("Billboard must be in a collection.  Was it removed?");if(!m(e))throw new g("scene is required.");u.clone(this._pixelOffset,q),u.add(q,this._translate,q);var i=r.modelMatrix,n=this._position;if(m(this._clampedPosition)&&(n=this._clampedPosition,e.mode!==w.SCENE3D)){var o=e.mapProjection,a=o.ellipsoid,s=o.unproject(n,B);n=a.cartographicToCartesian(s,z),i=v.IDENTITY}return E._computeScreenSpacePosition(i,n,this._eyeOffset,q,e,t)},E.getScreenSpaceBoundingBox=function(e,t,r){var i=e.width,n=e.height,o=e.scale;i*=o,n*=o;var a=t.x;e.horizontalOrigin===C.RIGHT?a-=i:e.horizontalOrigin===C.CENTER&&(a-=.5*i);var s=t.y;return e.verticalOrigin===T.BOTTOM||e.verticalOrigin===T.BASELINE?s-=n:e.verticalOrigin===T.CENTER&&(s-=.5*n),m(r)||(r=new l),r.x=a,r.y=s,r.width=i,r.height=n,r},E.prototype.equals=function(e){return this===e||m(e)&&this._id===e._id&&d.equals(this._position,e._position)&&this._imageId===e._imageId&&this._show===e._show&&this._scale===e._scale&&this._verticalOrigin===e._verticalOrigin&&this._horizontalOrigin===e._horizontalOrigin&&this._heightReference===e._heightReference&&l.equals(this._imageSubRegion,e._imageSubRegion)&&c.equals(this._color,e._color)&&u.equals(this._pixelOffset,e._pixelOffset)&&u.equals(this._translate,e._translate)&&d.equals(this._eyeOffset,e._eyeOffset)&&y.equals(this._scaleByDistance,e._scaleByDistance)&&y.equals(this._translucencyByDistance,e._translucencyByDistance)&&y.equals(this._pixelOffsetScaleByDistance,e._pixelOffsetScaleByDistance)&&_.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance},E.prototype._destroy=function(){m(this._customData)&&(this._billboardCollection._scene.globe._surface.removeTileCustomData(this._customData),this._customData=void 0),m(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this.image=void 0,this._pickId=this._pickId&&this._pickId.destroy(),this._billboardCollection=void 0},E}),define("Renderer/VertexArrayFacade",["../Core/Check","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Math","./Buffer","./BufferUsage","./VertexArray"],function(m,g,_,v,n,y,d,o,u,h){"use strict";function b(e,t,r,i){if(m.defined("context",e),!t||0===t.length)throw new y("At least one attribute is required.");var n=b._verifyAttributes(t);r=_(r,0);for(var o,a,s=[],l={},u=n.length,c=0;c<u;++c){var d=n[c];d.vertexBuffer?s.push(d):(o=l[a=d.usage],v(o)||(o=l[a]=[]),o.push(d))}function h(e,t){return g.getSizeInBytes(t.componentDatatype)-g.getSizeInBytes(e.componentDatatype)}for(a in this._allBuffers=[],l)if(l.hasOwnProperty(a)){(o=l[a]).sort(h);var p=b._vertexSizeInBytes(o),f={vertexSizeInBytes:p,vertexBuffer:void 0,usage:o[0].usage,needsCommit:!1,arrayBuffer:void 0,arrayViews:b._createArrayViews(o,p)};this._allBuffers.push(f)}this._size=0,this._instanced=_(i,!1),this._precreated=s,this._context=e,this.writers=void 0,this.va=void 0,this.resize(r)}b._verifyAttributes=function(e){for(var t=[],r=0;r<e.length;++r){var i=e[r],n={index:_(i.index,r),enabled:_(i.enabled,!0),componentsPerAttribute:i.componentsPerAttribute,componentDatatype:_(i.componentDatatype,g.FLOAT),normalize:_(i.normalize,!1),vertexBuffer:i.vertexBuffer,usage:_(i.usage,u.STATIC_DRAW)};if(t.push(n),1!==n.componentsPerAttribute&&2!==n.componentsPerAttribute&&3!==n.componentsPerAttribute&&4!==n.componentsPerAttribute)throw new y("attribute.componentsPerAttribute must be in the range [1, 4].");var o=n.componentDatatype;if(!g.validate(o))throw new y("Attribute must have a valid componentDatatype or not specify it.");if(!u.validate(n.usage))throw new y("Attribute must have a valid usage or not specify it.")}for(var a=new Array(t.length),s=0;s<t.length;++s){var l=t[s].index;if(a[l])throw new y("Index "+l+" is used by more than one attribute.");a[l]=!0}return t},b._vertexSizeInBytes=function(e){for(var t=0,r=e.length,i=0;i<r;++i){var n=e[i];t+=n.componentsPerAttribute*g.getSizeInBytes(n.componentDatatype)}var o=0<r?g.getSizeInBytes(e[0].componentDatatype):0,a=0<o?t%o:0;return t+=0===a?0:o-a},b._createArrayViews=function(e,t){for(var r=[],i=0,n=e.length,o=0;o<n;++o){var a=e[o],s=a.componentDatatype;r.push({index:a.index,enabled:a.enabled,componentsPerAttribute:a.componentsPerAttribute,componentDatatype:s,normalize:a.normalize,offsetInBytes:i,vertexSizeInComponentType:t/g.getSizeInBytes(s),view:void 0}),i+=a.componentsPerAttribute*g.getSizeInBytes(s)}return r},b.prototype.resize=function(e){this._size=e;var t=this._allBuffers;this.writers=[];for(var r=0,i=t.length;r<i;++r){var n=t[r];b._resize(n,this._size),b._appendWriters(this.writers,n)}f(this)},b._resize=function(e,t){if(0<e.vertexSizeInBytes){var r=new ArrayBuffer(t*e.vertexSizeInBytes);if(v(e.arrayBuffer))for(var i=new Uint8Array(r),n=new Uint8Array(e.arrayBuffer),o=n.length,a=0;a<o;++a)i[a]=n[a];for(var s=e.arrayViews,l=s.length,u=0;u<l;++u){var c=s[u];c.view=g.createArrayBufferView(c.componentDatatype,r,c.offsetInBytes)}e.arrayBuffer=r}};var a=[function(r,i,n){return function(e,t){i[e*n]=t,r.needsCommit=!0}},function(n,o,a){return function(e,t,r){var i=e*a;o[i]=t,o[i+1]=r,n.needsCommit=!0}},function(o,a,s){return function(e,t,r,i){var n=e*s;a[n]=t,a[n+1]=r,a[n+2]=i,o.needsCommit=!0}},function(a,s,l){return function(e,t,r,i,n){var o=e*l;s[o]=t,s[o+1]=r,s[o+2]=i,s[o+3]=n,a.needsCommit=!0}}];function p(e,t){if(t.needsCommit&&0<t.vertexSizeInBytes){t.needsCommit=!1;var r=t.vertexBuffer,i=e._size*t.vertexSizeInBytes,n=v(r);if(!n||r.sizeInBytes<i)return n&&r.destroy(),t.vertexBuffer=o.createVertexBuffer({context:e._context,typedArray:t.arrayBuffer,usage:t.usage}),!(t.vertexBuffer.vertexArrayDestroyable=!1);t.vertexBuffer.copyFromArrayView(t.arrayBuffer)}return!1}function s(e,t,r){if(e.needsCommit&&0<e.vertexSizeInBytes){var i=e.vertexSizeInBytes*t,n=e.vertexSizeInBytes*r;e.vertexBuffer.copyFromArrayView(new Uint8Array(e.arrayBuffer,i,n),i)}}function f(e){var t=e.va;if(v(t)){for(var r=t.length,i=0;i<r;++i)t[i].va.destroy();e.va=void 0}}return b._appendWriters=function(e,t){for(var r=t.arrayViews,i=r.length,n=0;n<i;++n){var o=r[n];e[o.index]=a[o.componentsPerAttribute-1](t,o.view,o.vertexSizeInComponentType)}},b.prototype.commit=function(e){var t,r,i,n=!1,o=this._allBuffers;for(r=0,i=o.length;r<i;++r)n=p(this,t=o[r])||n;if(n||!v(this.va)){f(this);for(var a=this.va=[],s=v(e)?Math.ceil(this._size/(d.SIXTY_FOUR_KILOBYTES-1)):1,l=0;l<s;++l){var u=[];for(r=0,i=o.length;r<i;++r){var c=l*((t=o[r]).vertexSizeInBytes*(d.SIXTY_FOUR_KILOBYTES-1));b._appendAttributes(u,t,c,this._instanced)}u=u.concat(this._precreated),a.push({va:new h({context:this._context,attributes:u,indexBuffer:e}),indicesCount:1.5*(l!==s-1?d.SIXTY_FOUR_KILOBYTES-1:this._size%(d.SIXTY_FOUR_KILOBYTES-1))})}}},b._appendAttributes=function(e,t,r,i){for(var n=t.arrayViews,o=n.length,a=0;a<o;++a){var s=n[a];e.push({index:s.index,enabled:s.enabled,componentsPerAttribute:s.componentsPerAttribute,componentDatatype:s.componentDatatype,normalize:s.normalize,vertexBuffer:t.vertexBuffer,offsetInBytes:r+s.offsetInBytes,strideInBytes:t.vertexSizeInBytes,instanceDivisor:i?1:0})}},b.prototype.subCommit=function(e,t){if(e<0||e>=this._size)throw new y("offsetInVertices must be greater than or equal to zero and less than the vertex array size.");if(e+t>this._size)throw new y("offsetInVertices + lengthInVertices cannot exceed the vertex array size.");for(var r=this._allBuffers,i=0,n=r.length;i<n;++i)s(r[i],e,t)},b.prototype.endSubCommits=function(){for(var e=this._allBuffers,t=0,r=e.length;t<r;++t)e[t].needsCommit=!1},b.prototype.isDestroyed=function(){return!1},b.prototype.destroy=function(){for(var e=this._allBuffers,t=0,r=e.length;t<r;++t){var i=e[t];i.vertexBuffer=i.vertexBuffer&&i.vertexBuffer.destroy()}return f(this),n(this)},b}),define("Shaders/BillboardCollectionFS",[],function(){"use strict";return"uniform sampler2D u_atlas;\n#ifdef VECTOR_TILE\nuniform vec4 u_highlightColor;\n#endif\nvarying vec2 v_textureCoordinates;\n#ifdef RENDER_FOR_PICK\nvarying vec4 v_pickColor;\n#else\nvarying vec4 v_color;\n#endif\nvoid main()\n{\n#ifdef RENDER_FOR_PICK\nvec4 vertexColor = vec4(1.0, 1.0, 1.0, 1.0);\n#else\nvec4 vertexColor = v_color;\n#endif\nvec4 color = texture2D(u_atlas, v_textureCoordinates) * vertexColor;\n#if defined(RENDER_FOR_PICK) || (!defined(OPAQUE) && !defined(TRANSLUCENT))\nif (color.a < 0.005)\n{\ndiscard;\n}\n#else\n#ifdef OPAQUE\nif (color.a < 0.995)\n{\ndiscard;\n}\n#else\nif (color.a >= 0.995)\n{\ndiscard;\n}\n#endif\n#endif\n#ifdef VECTOR_TILE\ncolor *= u_highlightColor;\n#endif\n#ifdef RENDER_FOR_PICK\ngl_FragColor = v_pickColor;\n#else\ngl_FragColor = color;\n#endif\n}\n"}),define("Shaders/BillboardCollectionVS",[],function(){"use strict";return"#ifdef INSTANCED\nattribute vec2 direction;\n#endif\nattribute vec4 positionHighAndScale;\nattribute vec4 positionLowAndRotation;\nattribute vec4 compressedAttribute0;\nattribute vec4 compressedAttribute1;\nattribute vec4 compressedAttribute2;\nattribute vec4 eyeOffset;\nattribute vec4 scaleByDistance;\nattribute vec4 pixelOffsetScaleByDistance;\nattribute vec3 distanceDisplayConditionAndDisableDepth;\n#ifdef VECTOR_TILE\nattribute float a_batchId;\n#endif\nvarying vec2 v_textureCoordinates;\n#ifdef RENDER_FOR_PICK\nvarying vec4 v_pickColor;\n#else\nvarying vec4 v_color;\n#endif\nconst float UPPER_BOUND = 32768.0;\nconst float SHIFT_LEFT16 = 65536.0;\nconst float SHIFT_LEFT8 = 256.0;\nconst float SHIFT_LEFT7 = 128.0;\nconst float SHIFT_LEFT5 = 32.0;\nconst float SHIFT_LEFT3 = 8.0;\nconst float SHIFT_LEFT2 = 4.0;\nconst float SHIFT_LEFT1 = 2.0;\nconst float SHIFT_RIGHT8 = 1.0 / 256.0;\nconst float SHIFT_RIGHT7 = 1.0 / 128.0;\nconst float SHIFT_RIGHT5 = 1.0 / 32.0;\nconst float SHIFT_RIGHT3 = 1.0 / 8.0;\nconst float SHIFT_RIGHT2 = 1.0 / 4.0;\nconst float SHIFT_RIGHT1 = 1.0 / 2.0;\nvec4 computePositionWindowCoordinates(vec4 positionEC, vec2 imageSize, float scale, vec2 direction, vec2 origin, vec2 translate, vec2 pixelOffset, vec3 alignedAxis, bool validAlignedAxis, float rotation, bool sizeInMeters)\n{\nvec2 halfSize = imageSize * scale * czm_resolutionScale * 0.5;\nhalfSize *= ((direction * 2.0) - 1.0);\nvec2 originTranslate = origin * abs(halfSize);\n#if defined(ROTATION) || defined(ALIGNED_AXIS)\nif (validAlignedAxis || rotation != 0.0)\n{\nfloat angle = rotation;\nif (validAlignedAxis)\n{\nvec4 projectedAlignedAxis = czm_modelViewProjection * vec4(alignedAxis, 0.0);\nangle += sign(-projectedAlignedAxis.x) * acos( sign(projectedAlignedAxis.y) * (projectedAlignedAxis.y * projectedAlignedAxis.y) /\n(projectedAlignedAxis.x * projectedAlignedAxis.x + projectedAlignedAxis.y * projectedAlignedAxis.y) );\n}\nfloat cosTheta = cos(angle);\nfloat sinTheta = sin(angle);\nmat2 rotationMatrix = mat2(cosTheta, sinTheta, -sinTheta, cosTheta);\nhalfSize = rotationMatrix * halfSize;\n}\n#endif\nif (sizeInMeters)\n{\npositionEC.xy += halfSize;\n}\nvec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\nif (sizeInMeters)\n{\noriginTranslate /= czm_metersPerPixel(positionEC);\n}\npositionWC.xy += originTranslate;\nif (!sizeInMeters)\n{\npositionWC.xy += halfSize;\n}\npositionWC.xy += translate;\npositionWC.xy += (pixelOffset * czm_resolutionScale);\nreturn positionWC;\n}\nvoid main()\n{\nvec3 positionHigh = positionHighAndScale.xyz;\nvec3 positionLow = positionLowAndRotation.xyz;\nfloat scale = positionHighAndScale.w;\n#if defined(ROTATION) || defined(ALIGNED_AXIS)\nfloat rotation = positionLowAndRotation.w;\n#else\nfloat rotation = 0.0;\n#endif\nfloat compressed = compressedAttribute0.x;\nvec2 pixelOffset;\npixelOffset.x = floor(compressed * SHIFT_RIGHT7);\ncompressed -= pixelOffset.x * SHIFT_LEFT7;\npixelOffset.x -= UPPER_BOUND;\nvec2 origin;\norigin.x = floor(compressed * SHIFT_RIGHT5);\ncompressed -= origin.x * SHIFT_LEFT5;\norigin.y = floor(compressed * SHIFT_RIGHT3);\ncompressed -= origin.y * SHIFT_LEFT3;\norigin -= vec2(1.0);\nfloat show = floor(compressed * SHIFT_RIGHT2);\ncompressed -= show * SHIFT_LEFT2;\n#ifdef INSTANCED\nvec2 textureCoordinatesBottomLeft = czm_decompressTextureCoordinates(compressedAttribute0.w);\nvec2 textureCoordinatesRange = czm_decompressTextureCoordinates(eyeOffset.w);\nvec2 textureCoordinates = textureCoordinatesBottomLeft + direction * textureCoordinatesRange;\n#else\nvec2 direction;\ndirection.x = floor(compressed * SHIFT_RIGHT1);\ndirection.y = compressed - direction.x * SHIFT_LEFT1;\nvec2 textureCoordinates = czm_decompressTextureCoordinates(compressedAttribute0.w);\n#endif\nfloat temp = compressedAttribute0.y  * SHIFT_RIGHT8;\npixelOffset.y = -(floor(temp) - UPPER_BOUND);\nvec2 translate;\ntranslate.y = (temp - floor(temp)) * SHIFT_LEFT16;\ntemp = compressedAttribute0.z * SHIFT_RIGHT8;\ntranslate.x = floor(temp) - UPPER_BOUND;\ntranslate.y += (temp - floor(temp)) * SHIFT_LEFT8;\ntranslate.y -= UPPER_BOUND;\ntemp = compressedAttribute1.x * SHIFT_RIGHT8;\nvec2 imageSize = vec2(floor(temp), compressedAttribute2.w);\n#ifdef EYE_DISTANCE_TRANSLUCENCY\nvec4 translucencyByDistance;\ntranslucencyByDistance.x = compressedAttribute1.z;\ntranslucencyByDistance.z = compressedAttribute1.w;\ntranslucencyByDistance.y = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\ntemp = compressedAttribute1.y * SHIFT_RIGHT8;\ntranslucencyByDistance.w = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\n#endif\n#ifdef ALIGNED_AXIS\nvec3 alignedAxis = czm_octDecode(floor(compressedAttribute1.y * SHIFT_RIGHT8));\ntemp = compressedAttribute2.z * SHIFT_RIGHT5;\nbool validAlignedAxis = (temp - floor(temp)) * SHIFT_LEFT1 > 0.0;\n#else\nvec3 alignedAxis = vec3(0.0);\nbool validAlignedAxis = false;\n#endif\n#ifdef RENDER_FOR_PICK\ntemp = compressedAttribute2.y;\n#else\ntemp = compressedAttribute2.x;\n#endif\nvec4 color;\ntemp = temp * SHIFT_RIGHT8;\ncolor.b = (temp - floor(temp)) * SHIFT_LEFT8;\ntemp = floor(temp) * SHIFT_RIGHT8;\ncolor.g = (temp - floor(temp)) * SHIFT_LEFT8;\ncolor.r = floor(temp);\ntemp = compressedAttribute2.z * SHIFT_RIGHT8;\nbool sizeInMeters = floor((temp - floor(temp)) * SHIFT_LEFT7) > 0.0;\ntemp = floor(temp) * SHIFT_RIGHT8;\n#ifdef RENDER_FOR_PICK\ncolor.a = (temp - floor(temp)) * SHIFT_LEFT8;\nvec4 pickColor = color / 255.0;\n#else\ncolor.a = floor(temp);\ncolor /= 255.0;\n#endif\nvec4 p = czm_translateRelativeToEye(positionHigh, positionLow);\nvec4 positionEC = czm_modelViewRelativeToEye * p;\npositionEC = czm_eyeOffset(positionEC, eyeOffset.xyz);\npositionEC.xyz *= show;\n#if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(EYE_DISTANCE_PIXEL_OFFSET) || defined(DISTANCE_DISPLAY_CONDITION) || defined(DISABLE_DEPTH_DISTANCE)\nfloat lengthSq;\nif (czm_sceneMode == czm_sceneMode2D)\n{\nlengthSq = czm_eyeHeight2D.y;\n}\nelse\n{\nlengthSq = dot(positionEC.xyz, positionEC.xyz);\n}\n#endif\n#ifdef EYE_DISTANCE_SCALING\nfloat distanceScale = czm_nearFarScalar(scaleByDistance, lengthSq);\nscale *= distanceScale;\ntranslate *= distanceScale;\nif (scale == 0.0)\n{\npositionEC.xyz = vec3(0.0);\n}\n#endif\nfloat translucency = 1.0;\n#ifdef EYE_DISTANCE_TRANSLUCENCY\ntranslucency = czm_nearFarScalar(translucencyByDistance, lengthSq);\nif (translucency == 0.0)\n{\npositionEC.xyz = vec3(0.0);\n}\n#endif\n#ifdef EYE_DISTANCE_PIXEL_OFFSET\nfloat pixelOffsetScale = czm_nearFarScalar(pixelOffsetScaleByDistance, lengthSq);\npixelOffset *= pixelOffsetScale;\n#endif\n#ifdef DISTANCE_DISPLAY_CONDITION\nfloat nearSq = distanceDisplayConditionAndDisableDepth.x;\nfloat farSq = distanceDisplayConditionAndDisableDepth.y;\nif (lengthSq < nearSq || lengthSq > farSq)\n{\npositionEC.xyz = vec3(0.0);\n}\n#endif\nvec4 positionWC = computePositionWindowCoordinates(positionEC, imageSize, scale, direction, origin, translate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters);\ngl_Position = czm_viewportOrthographic * vec4(positionWC.xy, -positionWC.z, 1.0);\nv_textureCoordinates = textureCoordinates;\n#ifdef DISABLE_DEPTH_DISTANCE\nfloat disableDepthTestDistance = distanceDisplayConditionAndDisableDepth.z;\nif (disableDepthTestDistance == 0.0 && czm_minimumDisableDepthTestDistance != 0.0)\n{\ndisableDepthTestDistance = czm_minimumDisableDepthTestDistance;\n}\nif (disableDepthTestDistance != 0.0)\n{\nfloat zclip = gl_Position.z / gl_Position.w;\nbool clipped = (zclip < -1.0 || zclip > 1.0);\nif (!clipped && (disableDepthTestDistance < 0.0 || (lengthSq > 0.0 && lengthSq < disableDepthTestDistance)))\n{\ngl_Position.z = -gl_Position.w;\n}\n}\n#endif\n#ifdef RENDER_FOR_PICK\nv_pickColor = pickColor;\n#else\nv_color = color;\nv_color.a *= translucency;\n#endif\n}\n"}),define("Scene/BlendOption",["../Core/freezeObject"],function(e){"use strict";return e({OPAQUE:0,TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2})}),define("Renderer/Framebuffer",["../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/PixelFormat","./ContextLimits"],function(h,p,f,e,a,m,g,_){"use strict";function v(e,t,r){var i=e._gl;i.framebufferTexture2D(i.FRAMEBUFFER,t,r._target,r._texture,0)}function y(e,t,r){var i=e._gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,t,i.RENDERBUFFER,r._getRenderbuffer())}function t(e){e=p(e,p.EMPTY_OBJECT),h.defined("options.context",e.context);var t=e.context._gl,r=_.maximumColorAttachments;if(this._gl=t,this._framebuffer=t.createFramebuffer(),this._colorTextures=[],this._colorRenderbuffers=[],this._activeColorAttachments=[],this._depthTexture=void 0,this._depthRenderbuffer=void 0,this._stencilRenderbuffer=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this.destroyAttachments=p(e.destroyAttachments,!0),f(e.colorTextures)&&f(e.colorRenderbuffers))throw new m("Cannot have both color texture and color renderbuffer attachments.");if(f(e.depthTexture)&&f(e.depthRenderbuffer))throw new m("Cannot have both a depth texture and depth renderbuffer attachment.");if(f(e.depthStencilTexture)&&f(e.depthStencilRenderbuffer))throw new m("Cannot have both a depth-stencil texture and depth-stencil renderbuffer attachment.");var i,n,o,a,s,l=f(e.depthTexture)||f(e.depthRenderbuffer),u=f(e.depthStencilTexture)||f(e.depthStencilRenderbuffer);if(l&&u)throw new m("Cannot have both a depth and depth-stencil attachment.");if(f(e.stencilRenderbuffer)&&u)throw new m("Cannot have both a stencil and depth-stencil attachment.");if(l&&f(e.stencilRenderbuffer))throw new m("Cannot have both a depth and stencil attachment.");if(this._bind(),f(e.colorTextures)){var c=e.colorTextures;if(r<(a=this._colorTextures.length=this._activeColorAttachments.length=c.length))throw new m("The number of color attachments exceeds the number supported.");for(o=0;o<a;++o){if(i=c[o],!g.isColorFormat(i.pixelFormat))throw new m("The color-texture pixel-format must be a color format.");v(this,s=this._gl.COLOR_ATTACHMENT0+o,i),this._activeColorAttachments[o]=s,this._colorTextures[o]=i}}if(f(e.colorRenderbuffers)){var d=e.colorRenderbuffers;if(r<(a=this._colorRenderbuffers.length=this._activeColorAttachments.length=d.length))throw new m("The number of color attachments exceeds the number supported.");for(o=0;o<a;++o)n=d[o],y(this,s=this._gl.COLOR_ATTACHMENT0+o,n),this._activeColorAttachments[o]=s,this._colorRenderbuffers[o]=n}if(f(e.depthTexture)){if((i=e.depthTexture).pixelFormat!==g.DEPTH_COMPONENT)throw new m("The depth-texture pixel-format must be DEPTH_COMPONENT.");v(this,this._gl.DEPTH_ATTACHMENT,i),this._depthTexture=i}if(f(e.depthRenderbuffer)&&(n=e.depthRenderbuffer,y(this,this._gl.DEPTH_ATTACHMENT,n),this._depthRenderbuffer=n),f(e.stencilRenderbuffer)&&(n=e.stencilRenderbuffer,y(this,this._gl.STENCIL_ATTACHMENT,n),this._stencilRenderbuffer=n),f(e.depthStencilTexture)){if((i=e.depthStencilTexture).pixelFormat!==g.DEPTH_STENCIL)throw new m("The depth-stencil pixel-format must be DEPTH_STENCIL.");v(this,this._gl.DEPTH_STENCIL_ATTACHMENT,i),this._depthStencilTexture=i}f(e.depthStencilRenderbuffer)&&(n=e.depthStencilRenderbuffer,y(this,this._gl.DEPTH_STENCIL_ATTACHMENT,n),this._depthStencilRenderbuffer=n),this._unBind()}return e(t.prototype,{status:{get:function(){this._bind();var e=this._gl.checkFramebufferStatus(this._gl.FRAMEBUFFER);return this._unBind(),e}},numberOfColorAttachments:{get:function(){return this._activeColorAttachments.length}},depthTexture:{get:function(){return this._depthTexture}},depthRenderbuffer:{get:function(){return this._depthRenderbuffer}},stencilRenderbuffer:{get:function(){return this._stencilRenderbuffer}},depthStencilTexture:{get:function(){return this._depthStencilTexture}},depthStencilRenderbuffer:{get:function(){return this._depthStencilRenderbuffer}},hasDepthAttachment:{get:function(){return!!(this.depthTexture||this.depthRenderbuffer||this.depthStencilTexture||this.depthStencilRenderbuffer)}}}),t.prototype._bind=function(){var e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer)},t.prototype._unBind=function(){var e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,null)},t.prototype._getActiveColorAttachments=function(){return this._activeColorAttachments},t.prototype.getColorTexture=function(e){if(!f(e)||e<0||e>=this._colorTextures.length)throw new m("index is required, must be greater than or equal to zero and must be less than the number of color attachments.");return this._colorTextures[e]},t.prototype.getColorRenderbuffer=function(e){if(!f(e)||e<0||e>=this._colorRenderbuffers.length)throw new m("index is required, must be greater than or equal to zero and must be less than the number of color attachments.");return this._colorRenderbuffers[e]},t.prototype.isDestroyed=function(){return!1},t.prototype.destroy=function(){if(this.destroyAttachments){for(var e=0,t=this._colorTextures,r=t.length;e<r;++e){var i=t[e];f(i)&&i.destroy()}var n=this._colorRenderbuffers;for(r=n.length,e=0;e<r;++e){var o=n[e];f(o)&&o.destroy()}this._depthTexture=this._depthTexture&&this._depthTexture.destroy(),this._depthRenderbuffer=this._depthRenderbuffer&&this._depthRenderbuffer.destroy(),this._stencilRenderbuffer=this._stencilRenderbuffer&&this._stencilRenderbuffer.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy()}return this._gl.deleteFramebuffer(this._framebuffer),a(this)},t}),define("Scene/TextureAtlas",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/PixelFormat","../Core/Resource","../Core/RuntimeError","../Renderer/Framebuffer","../Renderer/Texture","../ThirdParty/when"],function(h,C,p,o,w,e,t,n,i,a,r,S,T,s){"use strict";function E(e,t,r,i,n){this.bottomLeft=o(e,C.ZERO),this.topRight=o(t,C.ZERO),this.childNode1=r,this.childNode2=i,this.imageIndex=n}var l=new C(16,16);function u(e){e=o(e,o.EMPTY_OBJECT);var t=o(e.borderWidthInPixels,1),r=o(e.initialSize,l);if(!w(e.context))throw new n("context is required.");if(t<0)throw new n("borderWidthInPixels must be greater than or equal to zero.");if(r.x<1||r.y<1)throw new n("initialSize must be greater than zero.");this._context=e.context,this._pixelFormat=o(e.pixelFormat,i.RGBA),this._borderWidthInPixels=t,this._textureCoordinates=[],this._guid=p(),this._idHash={},this._initialSize=r,this._root=void 0}function f(e,t,r){var i=function e(t,r,i){if(w(r)){if(w(r.childNode1)||w(r.childNode2))return e(t,r.childNode1,i)||e(t,r.childNode2,i);if(w(r.imageIndex))return;var n=r.topRight.x-r.bottomLeft.x,o=r.topRight.y-r.bottomLeft.y,a=n-i.width,s=o-i.height;if(a<0||s<0)return;if(0===a&&0===s)return r;if(s<a){r.childNode1=new E(new C(r.bottomLeft.x,r.bottomLeft.y),new C(r.bottomLeft.x+i.width,r.topRight.y));var l=r.bottomLeft.x+i.width+t._borderWidthInPixels;l<r.topRight.x&&(r.childNode2=new E(new C(l,r.bottomLeft.y),new C(r.topRight.x,r.topRight.y)))}else{r.childNode1=new E(new C(r.bottomLeft.x,r.bottomLeft.y),new C(r.topRight.x,r.bottomLeft.y+i.height));var u=r.bottomLeft.y+i.height+t._borderWidthInPixels;u<r.topRight.y&&(r.childNode2=new E(new C(r.bottomLeft.x,u),new C(r.topRight.x,r.topRight.y)))}return e(t,r.childNode1,i)}}(e,e._root,t);if(w(i)){i.imageIndex=r;var n=e._texture.width,o=e._texture.height,a=i.topRight.x-i.bottomLeft.x,s=i.topRight.y-i.bottomLeft.y,l=i.bottomLeft.x/n,u=i.bottomLeft.y/o,c=a/n,d=s/o;e._textureCoordinates[r]=new h(l,u,c,d),e._texture.copyFrom(t,i.bottomLeft.x,i.bottomLeft.y)}else!function(e,t){var r=e._context,i=e.numberOfImages,n=e._borderWidthInPixels;if(0<i){for(var o=e._texture.width,a=e._texture.height,s=2*(o+t.width+n),l=2*(a+t.height+n),u=o/s,c=a/l,d=new E(new C(o+n,n),new C(s,a)),h=new E(new C,new C(s,a),e._root,d),p=new E(new C(n,a+n),new C(s,l)),f=new E(new C,new C(s,l),h,p),m=0;m<e._textureCoordinates.length;m++){var g=e._textureCoordinates[m];w(g)&&(g.x*=u,g.y*=c,g.width*=u,g.height*=c)}var _=new T({context:e._context,width:s,height:l,pixelFormat:e._pixelFormat}),v=new S({context:r,colorTextures:[e._texture],destroyAttachments:!1});v._bind(),_.copyFromFramebuffer(0,0,0,0,s,l),v._unBind(),v.destroy(),e._texture=e._texture&&e._texture.destroy(),e._texture=_,e._root=f}else{var y=2*(t.width+2*n),b=2*(t.height+2*n);y<e._initialSize.x&&(y=e._initialSize.x),b<e._initialSize.y&&(b=e._initialSize.y),e._texture=e._texture&&e._texture.destroy(),e._texture=new T({context:e._context,width:y,height:b,pixelFormat:e._pixelFormat}),e._root=new E(new C(n,n),new C(y,b))}}(e,t),f(e,t,r);e._guid=p()}return e(u.prototype,{borderWidthInPixels:{get:function(){return this._borderWidthInPixels}},textureCoordinates:{get:function(){return this._textureCoordinates}},texture:{get:function(){return w(this._texture)||(this._texture=new T({context:this._context,width:this._initialSize.x,height:this._initialSize.y,pixelFormat:this._pixelFormat})),this._texture}},numberOfImages:{get:function(){return this._textureCoordinates.length}},guid:{get:function(){return this._guid}}}),u.prototype.addImage=function(e,t){if(!w(e))throw new n("id is required.");if(!w(t))throw new n("image is required.");var r=this._idHash[e];if(w(r))return r;if("function"==typeof t){if(t=t(e),!w(t))throw new n("image is required.")}else if("string"==typeof t||t instanceof a){t=a.createIfNeeded(t).fetchImage()}var i=this;return r=s(t,function(e){if(i.isDestroyed())return-1;var t=i.numberOfImages;return f(i,e,t),t}),this._idHash[e]=r},u.prototype.addSubRegion=function(e,u){if(!w(e))throw new n("id is required.");if(!w(u))throw new n("subRegion is required.");var t=this._idHash[e];if(!w(t))throw new r('image with id "'+e+'" not found in the atlas.');var c=this;return s(t,function(e){if(-1===e)return-1;var t=c._texture.width,r=c._texture.height,i=c.numberOfImages,n=c._textureCoordinates[e],o=n.x+u.x/t,a=n.y+u.y/r,s=u.width/t,l=u.height/r;return c._textureCoordinates.push(new h(o,a,s,l)),c._guid=p(),i})},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),t(this)},u}),define("Scene/BillboardCollection",["../Core/AttributeCompression","../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EncodedCartesian3","../Core/IndexDatatype","../Core/Math","../Core/Matrix4","../Core/WebGLConstants","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArrayFacade","../Shaders/BillboardCollectionFS","../Shaders/BillboardCollectionVS","./Billboard","./BlendingState","./BlendOption","./HeightReference","./HorizontalOrigin","./SceneMode","./TextureAtlas","./VerticalOrigin"],function(R,te,e,w,S,l,T,re,t,r,L,p,o,N,ie,ne,u,c,oe,ae,se,le,ue,d,ce,de,h,he,pe,f,k,fe,me,F){"use strict";var ge,_e,ve=h.SHOW_INDEX,ye=h.POSITION_INDEX,be=h.PIXEL_OFFSET_INDEX,Ce=h.EYE_OFFSET_INDEX,we=h.HORIZONTAL_ORIGIN_INDEX,Se=h.VERTICAL_ORIGIN_INDEX,Te=h.SCALE_INDEX,Ee=h.IMAGE_INDEX_INDEX,Ae=h.COLOR_INDEX,xe=h.ROTATION_INDEX,Pe=h.ALIGNED_AXIS_INDEX,De=h.SCALE_BY_DISTANCE_INDEX,Oe=h.TRANSLUCENCY_BY_DISTANCE_INDEX,Ie=h.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX,Me=h.DISTANCE_DISPLAY_CONDITION_INDEX,Re=h.DISABLE_DEPTH_DISTANCE,Le=h.NUMBER_OF_PROPERTIES,Ne={positionHighAndScale:0,positionLowAndRotation:1,compressedAttribute0:2,compressedAttribute1:3,compressedAttribute2:4,eyeOffset:5,scaleByDistance:6,pixelOffsetScaleByDistance:7,distanceDisplayConditionAndDisableDepth:8,a_batchId:9},ke={direction:0,positionHighAndScale:1,positionLowAndRotation:2,compressedAttribute0:3,compressedAttribute1:4,compressedAttribute2:5,eyeOffset:6,scaleByDistance:7,pixelOffsetScaleByDistance:8,distanceDisplayConditionAndDisableDepth:9,a_batchId:10};function i(e){e=T(e,T.EMPTY_OBJECT),this._scene=e.scene,this._batchTable=e.batchTable,this._textureAtlas=void 0,this._textureAtlasGUID=void 0,this._destroyTextureAtlas=!0,this._sp=void 0,this._spTranslucent=void 0,this._spPick=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!1,this._shaderRotation=!1,this._compiledShaderRotation=!1,this._compiledShaderRotationPick=!1,this._shaderAlignedAxis=!1,this._compiledShaderAlignedAxis=!1,this._compiledShaderAlignedAxisPick=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._compiledShaderScaleByDistancePick=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistancePick=!1,this._shaderPixelOffsetScaleByDistance=!1,this._compiledShaderPixelOffsetScaleByDistance=!1,this._compiledShaderPixelOffsetScaleByDistancePick=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayConditionPick=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistancePick=!1,this._propertiesChanged=new Uint32Array(Le),this._maxSize=0,this._maxEyeOffset=0,this._maxScale=1,this._maxPixelOffset=0,this._allHorizontalCenter=!0,this._allVerticalCenter=!0,this._allSizedInMeters=!0,this._baseVolume=new te,this._baseVolumeWC=new te,this._baseVolume2D=new te,this._boundingVolume=new te,this._boundingVolumeDirty=!1,this._colorCommands=[],this._pickCommands=[],this.modelMatrix=ie.clone(T(e.modelMatrix,ie.IDENTITY)),this._modelMatrix=ie.clone(ie.IDENTITY),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this.blendOption=T(e.blendOption,pe.OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=fe.SCENE3D,this._buffersUsage=[c.STATIC_DRAW,c.STATIC_DRAW,c.STATIC_DRAW,c.STATIC_DRAW,c.STATIC_DRAW,c.STATIC_DRAW,c.STATIC_DRAW,c.STATIC_DRAW,c.STATIC_DRAW,c.STATIC_DRAW,c.STATIC_DRAW,c.STATIC_DRAW,c.STATIC_DRAW,c.STATIC_DRAW,c.STATIC_DRAW],this._highlightColor=S.clone(S.WHITE);var t=this;this._uniforms={u_atlas:function(){return t._textureAtlas.texture},u_highlightColor:function(){return t._highlightColor}};var r=this._scene;re(r)&&re(r.terrainProviderChanged)&&(this._removeCallbackFunc=r.terrainProviderChanged.addEventListener(function(){for(var e=this._billboards,t=e.length,r=0;r<t;++r)e[r]._updateClamping()},this))}function n(e){for(var t=e.length,r=0;r<t;++r)e[r]&&e[r]._destroy()}function Fe(e){if(e._billboardsRemoved){e._billboardsRemoved=!1;for(var t=[],r=e._billboards,i=r.length,n=0,o=0;n<i;++n){var a=r[n];a&&(a._index=o++,t.push(a))}e._billboards=t}}function Be(e){var t=e.cache.billboardCollection_indexBufferBatched;if(re(t))return t;for(var r=new Uint16Array(98298),i=0,n=0;i<98298;i+=6,n+=4)r[i]=n,r[i+1]=n+1,r[i+2]=n+2,r[i+3]=n+0,r[i+4]=n+2,r[i+5]=n+3;return(t=u.createIndexBuffer({context:e,typedArray:r,usage:c.STATIC_DRAW,indexDatatype:o.UNSIGNED_SHORT})).vertexArrayDestroyable=!1,e.cache.billboardCollection_indexBufferBatched=t}function Ue(e){var t=e.cache.billboardCollection_indexBufferInstanced;return re(t)?t:((t=u.createIndexBuffer({context:e,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:c.STATIC_DRAW,indexDatatype:o.UNSIGNED_SHORT})).vertexArrayDestroyable=!1,e.cache.billboardCollection_indexBufferInstanced=t)}function Ve(e,t,r,i,n){var o,a,s=[{index:ge.positionHighAndScale,componentsPerAttribute:4,componentDatatype:l.FLOAT,usage:r[ye]},{index:ge.positionLowAndRotation,componentsPerAttribute:4,componentDatatype:l.FLOAT,usage:r[ye]},{index:ge.compressedAttribute0,componentsPerAttribute:4,componentDatatype:l.FLOAT,usage:r[be]},{index:ge.compressedAttribute1,componentsPerAttribute:4,componentDatatype:l.FLOAT,usage:r[Oe]},{index:ge.compressedAttribute2,componentsPerAttribute:4,componentDatatype:l.FLOAT,usage:r[Ae]},{index:ge.eyeOffset,componentsPerAttribute:4,componentDatatype:l.FLOAT,usage:r[Ce]},{index:ge.scaleByDistance,componentsPerAttribute:4,componentDatatype:l.FLOAT,usage:r[De]},{index:ge.pixelOffsetScaleByDistance,componentsPerAttribute:4,componentDatatype:l.FLOAT,usage:r[Ie]},{index:ge.distanceDisplayConditionAndDisableDepth,componentsPerAttribute:3,componentDatatype:l.FLOAT,usage:r[Me]}];return i&&s.push({index:ge.direction,componentsPerAttribute:2,componentDatatype:l.FLOAT,vertexBuffer:(o=e,a=o.cache.billboardCollection_vertexBufferInstanced,re(a)?a:((a=u.createVertexBuffer({context:o,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:c.STATIC_DRAW})).vertexArrayDestroyable=!1,o.cache.billboardCollection_vertexBufferInstanced=a))}),re(n)&&s.push({index:ge.a_batchId,componentsPerAttribute:1,componentDatatyps:l.FLOAT,bufferUsage:c.STATIC_DRAW}),new d(e,s,i?t:4*t,i)}t(i.prototype,{length:{get:function(){return Fe(this),this._billboards.length}},textureAtlas:{get:function(){return this._textureAtlas},set:function(e){this._textureAtlas!==e&&(this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._textureAtlas=e,this._createVertexArray=!0)}},destroyTextureAtlas:{get:function(){return this._destroyTextureAtlas},set:function(e){this._destroyTextureAtlas=e}}}),i.prototype.add=function(e){var t=new h(e,this);return t._index=this._billboards.length,this._billboards.push(t),this._createVertexArray=!0,t},i.prototype.remove=function(e){return!!this.contains(e)&&(this._billboards[e._index]=null,this._billboardsRemoved=!0,this._createVertexArray=!0,e._destroy(),!0)},i.prototype.removeAll=function(){n(this._billboards),this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!0},i.prototype._updateBillboard=function(e,t){e._dirty||(this._billboardsToUpdate[this._billboardsToUpdateIndex++]=e),++this._propertiesChanged[t]},i.prototype.contains=function(e){return re(e)&&e._billboardCollection===this},i.prototype.get=function(e){if(!re(e))throw new L("index is required.");return Fe(this),this._billboards[e]},i.prototype.computeNewBuffersUsage=function(){for(var e=this._buffersUsage,t=!1,r=this._propertiesChanged,i=0;i<Le;++i){var n=0===r[i]?c.STATIC_DRAW:c.STREAM_DRAW;t=t||e[i]!==n,e[i]=n}return t};var m=new p;function ze(e,t,r,i,n){var o,a=i[ge.positionHighAndScale],s=i[ge.positionLowAndRotation],l=n._getActualPosition();e._mode===fe.SCENE3D&&(te.expand(e._baseVolume,l,e._baseVolume),e._boundingVolumeDirty=!0),p.fromCartesian(l,m);var u=n.scale,c=n.rotation;0!==c&&(e._shaderRotation=!0),e._maxScale=Math.max(e._maxScale,u);var d=m.high,h=m.low;e._instanced?(a(o=n._index,d.x,d.y,d.z,u),s(o,h.x,h.y,h.z,c)):(a((o=4*n._index)+0,d.x,d.y,d.z,u),a(o+1,d.x,d.y,d.z,u),a(o+2,d.x,d.y,d.z,u),a(o+3,d.x,d.y,d.z,u),s(o+0,h.x,h.y,h.z,c),s(o+1,h.x,h.y,h.z,c),s(o+2,h.x,h.y,h.z,c),s(o+3,h.x,h.y,h.z,c))}var B=new e,U=32768,E=65536,V=256,z=128,q=32,G=8,W=4,H=1/256,j=0,Y=2,X=3,Q=1;function qe(e,t,r,i,n){var o,a=i[ge.compressedAttribute0],s=n.pixelOffset,l=s.x,u=s.y,c=n._translate,d=c.x,h=c.y;e._maxPixelOffset=Math.max(e._maxPixelOffset,Math.abs(l+d),Math.abs(-u+h));var p=n.horizontalOrigin,f=n._verticalOrigin,m=n.show&&n.clusterShow;0===n.color.alpha&&(m=!1),f===F.BASELINE&&(f=F.BOTTOM),e._allHorizontalCenter=e._allHorizontalCenter&&p===k.CENTER,e._allVerticalCenter=e._allVerticalCenter&&f===F.CENTER;var g=0,_=0,v=0,y=0,b=n._imageIndex;if(-1!==b){var C=r[b];if(!re(C))throw new L("Invalid billboard image index: "+b);g=C.x,_=C.y,v=C.width,y=C.height}var w=g+v,S=_+y,T=Math.floor(N.clamp(l,-U,U)+U)*z;T+=(p+1)*q,T+=(f+1)*G,T+=(m?1:0)*W;var E=Math.floor(N.clamp(u,-U,U)+U)*V,A=Math.floor(N.clamp(d,-U,U)+U)*V,x=(N.clamp(h,-U,U)+U)*H,P=Math.floor(x);E+=P,A+=Math.floor((x-P)*V),B.x=g,B.y=_;var D=R.compressTextureCoordinates(B);B.x=w;var O=R.compressTextureCoordinates(B);B.y=S;var I=R.compressTextureCoordinates(B);B.x=g;var M=R.compressTextureCoordinates(B);e._instanced?a(o=n._index,T,E,A,D):(a((o=4*n._index)+0,T+j,E,A,D),a(o+1,T+Y,E,A,O),a(o+2,T+X,E,A,I),a(o+3,T+Q,E,A,M))}function Ge(e,t,r,i,n){var o,a=i[ge.compressedAttribute1],s=n.alignedAxis;w.equals(s,w.ZERO)||(e._shaderAlignedAxis=!0);var l=0,u=1,c=1,d=1,h=n.translucencyByDistance;re(h)&&(l=h.near,u=h.nearValue,c=h.far,d=h.farValue,1===u&&1===d||(e._shaderTranslucencyByDistance=!0));var p=0,f=n._imageIndex;if(-1!==f){var m=r[f];if(!re(m))throw new L("Invalid billboard image index: "+f);p=m.width}var g=e._textureAtlas.texture.width,_=Math.round(T(n.width,g*p));e._maxSize=Math.max(e._maxSize,_);var v=N.clamp(_,0,E),y=0;Math.abs(w.magnitudeSquared(s)-1)<N.EPSILON6&&(y=R.octEncodeFloat(s)),u=N.clamp(u,0,1),v=v*V+(u=1===u?255:255*u|0),d=N.clamp(d,0,1),y=y*V+(d=1===d?255:255*d|0),e._instanced?a(o=n._index,v,y,l,c):(a((o=4*n._index)+0,v,y,l,c),a(o+1,v,y,l,c),a(o+2,v,y,l,c),a(o+3,v,y,l,c))}function We(e,t,r,i,n){var o,a=i[ge.compressedAttribute2],s=n.color,l=re(e._batchTable)?S.WHITE:n.getPickId(t).color,u=n.sizeInMeters?1:0,c=Math.abs(w.magnitudeSquared(n.alignedAxis)-1)<N.EPSILON6?1:0;e._allSizedInMeters=e._allSizedInMeters&&1===u;var d=0,h=n._imageIndex;if(-1!==h){var p=r[h];if(!re(p))throw new L("Invalid billboard image index: "+h);d=p.height}var f=e._textureAtlas.texture.dimensions,m=Math.round(T(n.height,f.y*d));e._maxSize=Math.max(e._maxSize,m);var g=S.floatToByte(s.red),_=S.floatToByte(s.green),v=S.floatToByte(s.blue),y=g*E+_*V+v;g=S.floatToByte(l.red),_=S.floatToByte(l.green),v=S.floatToByte(l.blue);var b=g*E+_*V+v,C=S.floatToByte(s.alpha)*E+S.floatToByte(l.alpha)*V;C+=2*u+c,e._instanced?a(o=n._index,y,b,C,m):(a((o=4*n._index)+0,y,b,C,m),a(o+1,y,b,C,m),a(o+2,y,b,C,m),a(o+3,y,b,C,m))}function He(e,t,r,i,n){var o,a=i[ge.eyeOffset],s=n.eyeOffset,l=s.z;if(n._heightReference!==f.NONE&&(l*=1.005),e._maxEyeOffset=Math.max(e._maxEyeOffset,Math.abs(s.x),Math.abs(s.y),Math.abs(l)),e._instanced){var u=0,c=0,d=n._imageIndex;if(-1!==d){var h=r[d];if(!re(h))throw new L("Invalid billboard image index: "+d);u=h.width,c=h.height}B.x=u,B.y=c;var p=R.compressTextureCoordinates(B);a(o=n._index,s.x,s.y,l,p)}else a((o=4*n._index)+0,s.x,s.y,l,0),a(o+1,s.x,s.y,l,0),a(o+2,s.x,s.y,l,0),a(o+3,s.x,s.y,l,0)}function je(e,t,r,i,n){var o,a=i[ge.scaleByDistance],s=0,l=1,u=1,c=1,d=n.scaleByDistance;re(d)&&(s=d.near,l=d.nearValue,u=d.far,c=d.farValue,1===l&&1===c||(e._shaderScaleByDistance=!0)),e._instanced?a(o=n._index,s,l,u,c):(a((o=4*n._index)+0,s,l,u,c),a(o+1,s,l,u,c),a(o+2,s,l,u,c),a(o+3,s,l,u,c))}function Ye(e,t,r,i,n){var o,a=i[ge.pixelOffsetScaleByDistance],s=0,l=1,u=1,c=1,d=n.pixelOffsetScaleByDistance;re(d)&&(s=d.near,l=d.nearValue,u=d.far,c=d.farValue,1===l&&1===c||(e._shaderPixelOffsetScaleByDistance=!0)),e._instanced?a(o=n._index,s,l,u,c):(a((o=4*n._index)+0,s,l,u,c),a(o+1,s,l,u,c),a(o+2,s,l,u,c),a(o+3,s,l,u,c))}function Xe(e,t,r,i,n){var o,a=i[ge.distanceDisplayConditionAndDisableDepth],s=0,l=Number.MAX_VALUE,u=n.distanceDisplayCondition;re(u)&&(s=u.near,l=u.far,s*=s,l*=l,e._shaderDistanceDisplayCondition=!0);var c=n.disableDepthTestDistance;0<(c*=c)&&(e._shaderDisableDepthDistance=!0,c===Number.POSITIVE_INFINITY&&(c=-1)),e._instanced?a(o=n._index,s,l,c):(a((o=4*n._index)+0,s,l,c),a(o+1,s,l,c),a(o+2,s,l,c),a(o+3,s,l,c))}function Qe(e,t,r,i,n){ze(e,0,0,i,n),qe(e,0,r,i,n),Ge(e,0,r,i,n),We(e,t,r,i,n),He(e,0,r,i,n),je(e,0,0,i,n),Ye(e,0,0,i,n),Xe(e,0,0,i,n),function(e,t,r,i,n){if(re(e._batchTable)){var o,a=i[ge.a_batchId],s=n._batchIndex;e._instanced?a(o=n._index,s):(a(0+(o=4*n._index),s),a(o+1,s),a(o+2,s),a(o+3,s))}}(e,0,0,i,n)}function Ze(e,t,r,i,n,o){var a;i.mode===fe.SCENE3D?(a=e._baseVolume,e._boundingVolumeDirty=!0):a=e._baseVolume2D;for(var s=[],l=0;l<r;++l){var u=t[l],c=u.position,d=h._computeActualPosition(u,c,i,n);re(d)&&(u._setActualPosition(d),o?s.push(d):te.expand(a,d,a))}o&&te.fromPoints(s,a)}var Ke=[];return i.prototype.update=function(e){Fe(this);var t=this._billboards,r=t.length,i=e.context;this._instanced=i.instancedArrays,ge=this._instanced?ke:Ne,_e=this._instanced?Ue:Be;var n=this._textureAtlas;if(!re(n)){n=this._textureAtlas=new me({context:i});for(var o=0;o<r;++o)t[o]._loadImage()}var a=n.textureCoordinates;if(0!==a.length){var s,l,u,c,d,h;s=this,u=(l=e).mode,c=s._billboards,d=s._billboardsToUpdate,h=s._modelMatrix,s._createVertexArray||s._mode!==u||u!==fe.SCENE3D&&!ie.equals(h,s.modelMatrix)?(s._mode=u,ie.clone(s.modelMatrix,h),s._createVertexArray=!0,u!==fe.SCENE3D&&u!==fe.SCENE2D&&u!==fe.COLUMBUS_VIEW||Ze(s,c,c.length,l,h,!0)):u===fe.MORPHING?Ze(s,c,c.length,l,h,!0):u!==fe.SCENE2D&&u!==fe.COLUMBUS_VIEW||Ze(s,d,s._billboardsToUpdateIndex,l,h,!1),r=(t=this._billboards).length;var p,f=this._billboardsToUpdate,m=this._billboardsToUpdateIndex,g=this._propertiesChanged,_=n.guid,v=this._createVertexArray||this._textureAtlasGUID!==_;this._textureAtlasGUID=_;var y=e.passes,b=y.pick;if(v||!b&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(var C=0;C<Le;++C)g[C]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),0<r){this._vaf=Ve(i,r,this._buffersUsage,this._instanced,this._batchTable),p=this._vaf.writers;for(var w=0;w<r;++w){var S=this._billboards[w];S._dirty=!1,Qe(this,i,a,p,S)}this._vaf.commit(_e(i))}this._billboardsToUpdateIndex=0}else if(0<m){var T=Ke;T.length=0,(g[ye]||g[xe]||g[Te])&&T.push(ze),(g[Ee]||g[be]||g[we]||g[Se]||g[ve])&&(T.push(qe),this._instanced&&T.push(He)),(g[Ee]||g[Pe]||g[Oe])&&(T.push(Ge),T.push(We)),(g[Ee]||g[Ae])&&T.push(We),g[Ce]&&T.push(He),g[De]&&T.push(je),g[Ie]&&T.push(Ye),(g[Me]||g[Re])&&T.push(Xe);var E=T.length;if(p=this._vaf.writers,.1<m/r){for(var A=0;A<m;++A){var x=f[A];x._dirty=!1;for(var P=0;P<E;++P)T[P](this,i,a,p,x)}this._vaf.commit(_e(i))}else{for(var D=0;D<m;++D){var O=f[D];O._dirty=!1;for(var I=0;I<E;++I)T[I](this,i,a,p,O);this._instanced?this._vaf.subCommit(O._index,1):this._vaf.subCommit(4*O._index,4)}this._vaf.endSubCommits()}this._billboardsToUpdateIndex=0}if(1.5*r<m&&(f.length=r),re(this._vaf)&&re(this._vaf.va)){var M;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,te.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));var R=ie.IDENTITY;(function(e,t,r){var i=1;e._allSizedInMeters&&0===e._maxPixelOffset||(i=t.camera.getPixelSize(r,t.context.drawingBufferWidth,t.context.drawingBufferHeight));var n=i*e._maxScale*e._maxSize*2;e._allHorizontalCenter&&e._allVerticalCenter&&(n*=.5);var o=i*e._maxPixelOffset+e._maxEyeOffset;r.radius+=n+o})(this,e,M=e.mode===fe.SCENE3D?(R=this.modelMatrix,te.clone(this._baseVolumeWC,this._boundingVolume)):te.clone(this._baseVolume2D,this._boundingVolume));var L,N,k,F,B,U,V,z,q,G,W=this._blendOption!==this.blendOption;if(this._blendOption=this.blendOption,W){this._blendOption===pe.OPAQUE||this._blendOption===pe.OPAQUE_AND_TRANSLUCENT?this._rsOpaque=se.fromCache({depthTest:{enabled:!0,func:ne.LESS},depthMask:!0}):this._rsOpaque=void 0;var H=this._blendOption===pe.TRANSLUCENT;this._blendOption===pe.TRANSLUCENT||this._blendOption===pe.OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=se.fromCache({depthTest:{enabled:!0,func:H?ne.LEQUAL:ne.LESS},depthMask:H,blending:he.ALPHA_BLEND}):this._rsTranslucent=void 0}if(this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||0!==e.minimumDisableDepthTestDistance,W||this._shaderRotation!==this._compiledShaderRotation||this._shaderAlignedAxis!==this._compiledShaderAlignedAxis||this._shaderScaleByDistance!==this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance!==this._compiledShaderTranslucencyByDistance||this._shaderPixelOffsetScaleByDistance!==this._compiledShaderPixelOffsetScaleByDistance||this._shaderDistanceDisplayCondition!==this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance){L=de,N=ce,B=[],re(this._batchTable)&&(B.push("VECTOR_TILE"),L=this._batchTable.getVertexShaderCallback(!1,"a_batchId",void 0)(L),N=this._batchTable.getFragmentShaderCallback(!1,void 0)(N)),k=new ue({defines:B,sources:[L]}),this._instanced&&k.defines.push("INSTANCED"),this._shaderRotation&&k.defines.push("ROTATION"),this._shaderAlignedAxis&&k.defines.push("ALIGNED_AXIS"),this._shaderScaleByDistance&&k.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&k.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderPixelOffsetScaleByDistance&&k.defines.push("EYE_DISTANCE_PIXEL_OFFSET"),this._shaderDistanceDisplayCondition&&k.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&k.defines.push("DISABLE_DEPTH_DISTANCE");var j=re(this._batchTable)?"VECTOR_TILE":"";this._blendOption===pe.OPAQUE_AND_TRANSLUCENT&&(F=new ue({defines:["OPAQUE",j],sources:[N]}),this._sp=le.replaceCache({context:i,shaderProgram:this._sp,vertexShaderSource:k,fragmentShaderSource:F,attributeLocations:ge}),F=new ue({defines:["TRANSLUCENT",j],sources:[N]}),this._spTranslucent=le.replaceCache({context:i,shaderProgram:this._spTranslucent,vertexShaderSource:k,fragmentShaderSource:F,attributeLocations:ge})),this._blendOption===pe.OPAQUE&&(F=new ue({defines:[j],sources:[N]}),this._sp=le.replaceCache({context:i,shaderProgram:this._sp,vertexShaderSource:k,fragmentShaderSource:F,attributeLocations:ge})),this._blendOption===pe.TRANSLUCENT&&(F=new ue({defines:[j],sources:[N]}),this._spTranslucent=le.replaceCache({context:i,shaderProgram:this._spTranslucent,vertexShaderSource:k,fragmentShaderSource:F,attributeLocations:ge})),this._compiledShaderRotation=this._shaderRotation,this._compiledShaderAlignedAxis=this._shaderAlignedAxis,this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderPixelOffsetScaleByDistance=this._shaderPixelOffsetScaleByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance}re(this._spPick)&&this._shaderRotation===this._compiledShaderRotationPick&&this._shaderAlignedAxis===this._compiledShaderAlignedAxisPick&&this._shaderScaleByDistance===this._compiledShaderScaleByDistancePick&&this._shaderTranslucencyByDistance===this._compiledShaderTranslucencyByDistancePick&&this._shaderPixelOffsetScaleByDistance===this._compiledShaderPixelOffsetScaleByDistancePick&&this._shaderDistanceDisplayCondition===this._compiledShaderDistanceDisplayConditionPick&&this._shaderDisableDepthDistance===this._compiledShaderDisableDepthDistancePick||(L=de,N=ce,B=[],re(this._batchTable)&&(B.push("VECTOR_TILE"),L=this._batchTable.getPickVertexShaderCallback("a_batchId")(L),N=this._batchTable.getPickFragmentShaderCallback()(N)),B.push(re(this._batchTable)?"":"RENDER_FOR_PICK"),k=new ue({defines:B,sources:[L]}),this._instanced&&k.defines.push("INSTANCED"),this._shaderRotation&&k.defines.push("ROTATION"),this._shaderAlignedAxis&&k.defines.push("ALIGNED_AXIS"),this._shaderScaleByDistance&&k.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&k.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderPixelOffsetScaleByDistance&&k.defines.push("EYE_DISTANCE_PIXEL_OFFSET"),this._shaderDistanceDisplayCondition&&k.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&k.defines.push("DISABLE_DEPTH_DISTANCE"),F=new ue({defines:B,sources:[N]}),this._spPick=le.replaceCache({context:i,shaderProgram:this._spPick,vertexShaderSource:k,fragmentShaderSource:F,attributeLocations:ge}),this._compiledShaderRotationPick=this._shaderRotation,this._compiledShaderAlignedAxisPick=this._shaderAlignedAxis,this._compiledShaderScaleByDistancePick=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistancePick=this._shaderTranslucencyByDistance,this._compiledShaderPixelOffsetScaleByDistancePick=this._shaderPixelOffsetScaleByDistance,this._compiledShaderDistanceDisplayConditionPick=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistancePick=this._shaderDisableDepthDistance);var Y=e.commandList;if(y.render){var X=this._colorCommands,Q=this._blendOption===pe.OPAQUE,Z=this._blendOption===pe.OPAQUE_AND_TRANSLUCENT;V=(U=this._vaf.va).length,q=this._uniforms,re(this._batchTable)&&(q=this._batchTable.getUniformMapCallback()(q)),X.length=V;var K=Z?2*V:V;for(G=0;G<K;++G){z=X[G],re(z)||(z=X[G]=new oe);var J=Q||Z&&G%2==0;z.pass=J||!Z?ae.OPAQUE:ae.TRANSLUCENT,z.owner=this;var $=Z?Math.floor(G/2):G;z.boundingVolume=M,z.modelMatrix=R,z.count=U[$].indicesCount,z.shaderProgram=J?this._sp:this._spTranslucent,z.uniformMap=q,z.vertexArray=U[$].va,z.renderState=J?this._rsOpaque:this._rsTranslucent,z.debugShowBoundingVolume=this.debugShowBoundingVolume,this._instanced&&(z.count=6,z.instanceCount=r),Y.push(z)}}if(b){var ee=this._pickCommands;for(V=(U=this._vaf.va).length,q=this._uniforms,re(this._batchTable)&&(q=this._batchTable.getPickUniformMapCallback()(q)),ee.length=V,G=0;G<V;++G)z=ee[G],re(z)||(z=ee[G]=new oe({pass:ae.OPAQUE,owner:this})),z.boundingVolume=M,z.modelMatrix=R,z.count=U[G].indicesCount,z.shaderProgram=this._spPick,z.uniformMap=q,z.vertexArray=U[G].va,z.renderState=this._rsOpaque,this._instanced&&(z.count=6,z.instanceCount=r),Y.push(z)}}}},i.prototype.isDestroyed=function(){return!1},i.prototype.destroy=function(){return re(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),n(this._billboards),r(this)},i}),define("Scene/LabelStyle",["../Core/freezeObject"],function(e){"use strict";return e({FILL:0,OUTLINE:1,FILL_AND_OUTLINE:2})}),define("Scene/Label",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/freezeObject","../Core/NearFarScalar","./Billboard","./HeightReference","./HorizontalOrigin","./LabelStyle","./VerticalOrigin"],function(b,s,l,a,u,C,e,c,d,t,h,n,p,f,m,w){"use strict";var g=t({LTR:0,RTL:1,WEAK:2,BRACKETS:3});function r(e){e._rebindAllGlyphs||e._repositionAllGlyphs||e._labelCollection._labelsToUpdate.push(e),e._rebindAllGlyphs=!0}function _(e){e._rebindAllGlyphs||e._repositionAllGlyphs||e._labelCollection._labelsToUpdate.push(e),e._repositionAllGlyphs=!0}function i(e,t){if(e=u(e,u.EMPTY_OBJECT),C(e.disableDepthTestDistance)&&e.disableDepthTestDistance<0)throw new c("disableDepthTestDistance must be greater than 0.0.");var r=e.translucencyByDistance,i=e.pixelOffsetScaleByDistance,n=e.scaleByDistance,o=e.distanceDisplayCondition;if(C(r)){if(r.far<=r.near)throw new c("translucencyByDistance.far must be greater than translucencyByDistance.near.");r=h.clone(r)}if(C(i)){if(i.far<=i.near)throw new c("pixelOffsetScaleByDistance.far must be greater than pixelOffsetScaleByDistance.near.");i=h.clone(i)}if(C(n)){if(n.far<=n.near)throw new c("scaleByDistance.far must be greater than scaleByDistance.near.");n=h.clone(n)}if(C(o)){if(o.far<=o.near)throw new c("distanceDisplayCondition.far must be greater than distanceDisplayCondition.near.");o=d.clone(o)}this._renderedText=void 0,this._text=void 0,this._show=u(e.show,!0),this._font=u(e.font,"30px sans-serif"),this._fillColor=a.clone(u(e.fillColor,a.WHITE)),this._outlineColor=a.clone(u(e.outlineColor,a.BLACK)),this._outlineWidth=u(e.outlineWidth,1),this._showBackground=u(e.showBackground,!1),this._backgroundColor=u(e.backgroundColor,new a(.165,.165,.165,.8)),this._backgroundPadding=u(e.backgroundPadding,new s(7,5)),this._style=u(e.style,m.FILL),this._verticalOrigin=u(e.verticalOrigin,w.BASELINE),this._horizontalOrigin=u(e.horizontalOrigin,f.LEFT),this._pixelOffset=s.clone(u(e.pixelOffset,s.ZERO)),this._eyeOffset=l.clone(u(e.eyeOffset,l.ZERO)),this._position=l.clone(u(e.position,l.ZERO)),this._scale=u(e.scale,1),this._id=e.id,this._translucencyByDistance=r,this._pixelOffsetScaleByDistance=i,this._scaleByDistance=n,this._heightReference=u(e.heightReference,p.NONE),this._distanceDisplayCondition=o,this._disableDepthTestDistance=u(e.disableDepthTestDistance,0),this._labelCollection=t,this._glyphs=[],this._backgroundBillboard=void 0,this._batchIndex=void 0,this._rebindAllGlyphs=!0,this._repositionAllGlyphs=!0,this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=void 0,this._clusterShow=!0,this.text=u(e.text,""),this._updateClamping()}function v(e,t){for(var r=/[a-zA-Z0-9]/,i=/[()[\]{}<>]/,n=[],o="",a=g.LTR,s="",l=e.length,u=0;u<l;++u){var c=e.charAt(u);s=t.test(c)?g.RTL:r.test(c)?g.LTR:i.test(c)?g.BRACKETS:g.WEAK,0===u&&(a=s),a===s&&s!==g.BRACKETS?o+=c:(""!==o&&n.push({Type:a,Word:o}),a=s,o=c)}return n.push({Type:s,Word:o}),n}function y(e){return e.split("").reverse().join("")}function S(e,t,r){return e.slice(0,t)+r+e.slice(t)}function T(e){switch(e){case"(":return")";case")":return"(";case"[":return"]";case"]":return"[";case"{":return"}";case"}":return"{";case"<":return">";case">":return"<"}}e(i.prototype,{show:{get:function(){return this._show},set:function(e){if(!C(e))throw new c("value is required.");if(this._show!==e){this._show=e;for(var t=this._glyphs,r=0,i=t.length;r<i;r++){var n=t[r].billboard;C(n)&&(n.show=e)}var o=this._backgroundBillboard;C(o)&&(o.show=e)}}},position:{get:function(){return this._position},set:function(e){if(!C(e))throw new c("value is required.");var t=this._position;if(!l.equals(t,e)){l.clone(e,t);for(var r=this._glyphs,i=0,n=r.length;i<n;i++){var o=r[i].billboard;C(o)&&(o.position=e)}var a=this._backgroundBillboard;C(a)&&(a.position=e),this._updateClamping()}}},heightReference:{get:function(){return this._heightReference},set:function(e){if(!C(e))throw new c("value is required.");if(e!==this._heightReference){this._heightReference=e;for(var t=this._glyphs,r=0,i=t.length;r<i;r++){var n=t[r].billboard;C(n)&&(n.heightReference=e)}var o=this._backgroundBillboard;C(o)&&(o.heightReference=e),_(this),this._updateClamping()}}},text:{get:function(){return this._text},set:function(e){if(!C(e))throw new c("value is required.");this._text!==e&&(this._text=e,this._renderedText=i.enableRightToLeftDetection?function(e){for(var t=e.split("\n"),r="",i=0;i<t.length;i++){for(var n=t[i],o=E.test(n.charAt(0)),a=v(n,E),s=0,l="",u=0;u<a.length;++u){var c=a[u],d=c.Type===g.BRACKETS?T(c.Word):c.Word;o?c.Type===g.RTL?(l=y(c.Word)+l,s=0):c.Type===g.LTR?(l=S(l,s,c.Word),s+=c.Word.length):c.Type!==g.WEAK&&c.Type!==g.BRACKETS||(c.Type===g.WEAK&&a[u-1].Type===g.BRACKETS?l=y(c.Word)+l:a[u-1].Type===g.RTL?(l=d+l,s=0):a.length>u+1?a[u+1].Type===g.RTL?(l=d+l,s=0):(l=S(l,s,c.Word),s+=c.Word.length):l=S(l,0,d)):c.Type===g.RTL?l=S(l,s,y(c.Word)):c.Type===g.LTR?(l+=c.Word,s=l.length):c.Type!==g.WEAK&&c.Type!==g.BRACKETS||(0<u&&a[u-1].Type===g.RTL?a.length>u+1?a[u+1].Type===g.RTL?l=S(l,s,d):(l+=c.Word,s=l.length):l+=c.Word:(l+=c.Word,s=l.length))}r+=l,i<t.length-1&&(r+="\n")}return r}(e):e,r(this))}},font:{get:function(){return this._font},set:function(e){if(!C(e))throw new c("value is required.");this._font!==e&&(this._font=e,r(this))}},fillColor:{get:function(){return this._fillColor},set:function(e){if(!C(e))throw new c("value is required.");var t=this._fillColor;a.equals(t,e)||(a.clone(e,t),r(this))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){if(!C(e))throw new c("value is required.");var t=this._outlineColor;a.equals(t,e)||(a.clone(e,t),r(this))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){if(!C(e))throw new c("value is required.");this._outlineWidth!==e&&(this._outlineWidth=e,r(this))}},showBackground:{get:function(){return this._showBackground},set:function(e){if(!C(e))throw new c("value is required.");this._showBackground!==e&&(this._showBackground=e,r(this))}},backgroundColor:{get:function(){return this._backgroundColor},set:function(e){if(!C(e))throw new c("value is required.");var t=this._backgroundColor;if(!a.equals(t,e)){a.clone(e,t);var r=this._backgroundBillboard;C(r)&&(r.color=t)}}},backgroundPadding:{get:function(){return this._backgroundPadding},set:function(e){if(!C(e))throw new c("value is required.");var t=this._backgroundPadding;s.equals(t,e)||(s.clone(e,t),_(this))}},style:{get:function(){return this._style},set:function(e){if(!C(e))throw new c("value is required.");this._style!==e&&(this._style=e,r(this))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){if(!C(e))throw new c("value is required.");var t=this._pixelOffset;if(!s.equals(t,e)){s.clone(e,t);for(var r=this._glyphs,i=0,n=r.length;i<n;i++){var o=r[i];C(o.billboard)&&(o.billboard.pixelOffset=e)}var a=this._backgroundBillboard;C(a)&&(a.pixelOffset=e)}}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){if(C(e)&&e.far<=e.near)throw new c("far distance must be greater than near distance.");var t=this._translucencyByDistance;if(!h.equals(t,e)){this._translucencyByDistance=h.clone(e,t);for(var r=this._glyphs,i=0,n=r.length;i<n;i++){var o=r[i];C(o.billboard)&&(o.billboard.translucencyByDistance=e)}var a=this._backgroundBillboard;C(a)&&(a.translucencyByDistance=e)}}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){if(C(e)&&e.far<=e.near)throw new c("far distance must be greater than near distance.");var t=this._pixelOffsetScaleByDistance;if(!h.equals(t,e)){this._pixelOffsetScaleByDistance=h.clone(e,t);for(var r=this._glyphs,i=0,n=r.length;i<n;i++){var o=r[i];C(o.billboard)&&(o.billboard.pixelOffsetScaleByDistance=e)}var a=this._backgroundBillboard;C(a)&&(a.pixelOffsetScaleByDistance=e)}}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){if(C(e)&&e.far<=e.near)throw new c("far distance must be greater than near distance.");var t=this._scaleByDistance;if(!h.equals(t,e)){this._scaleByDistance=h.clone(e,t);for(var r=this._glyphs,i=0,n=r.length;i<n;i++){var o=r[i];C(o.billboard)&&(o.billboard.scaleByDistance=e)}var a=this._backgroundBillboard;C(a)&&(a.scaleByDistance=e)}}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){if(!C(e))throw new c("value is required.");var t=this._eyeOffset;if(!l.equals(t,e)){l.clone(e,t);for(var r=this._glyphs,i=0,n=r.length;i<n;i++){var o=r[i];C(o.billboard)&&(o.billboard.eyeOffset=e)}var a=this._backgroundBillboard;C(a)&&(a.eyeOffset=e)}}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){if(!C(e))throw new c("value is required.");this._horizontalOrigin!==e&&(this._horizontalOrigin=e,_(this))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){if(!C(e))throw new c("value is required.");if(this._verticalOrigin!==e){this._verticalOrigin=e;for(var t=this._glyphs,r=0,i=t.length;r<i;r++){var n=t[r];C(n.billboard)&&(n.billboard.verticalOrigin=e)}var o=this._backgroundBillboard;C(o)&&(o.verticalOrigin=e),_(this)}}},scale:{get:function(){return this._scale},set:function(e){if(!C(e))throw new c("value is required.");if(this._scale!==e){this._scale=e;for(var t=this._glyphs,r=0,i=t.length;r<i;r++){var n=t[r];C(n.billboard)&&(n.billboard.scale=e)}var o=this._backgroundBillboard;C(o)&&(o.scale=e),_(this)}}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(C(e)&&e.far<=e.near)throw new c("far must be greater than near");if(!d.equals(e,this._distanceDisplayCondition)){this._distanceDisplayCondition=d.clone(e,this._distanceDisplayCondition);for(var t=this._glyphs,r=0,i=t.length;r<i;r++){var n=t[r];C(n.billboard)&&(n.billboard.distanceDisplayCondition=e)}var o=this._backgroundBillboard;C(o)&&(o.distanceDisplayCondition=e)}}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){if(this._disableDepthTestDistance!==e){if(!C(e)||e<0)throw new c("disableDepthTestDistance must be greater than 0.0.");this._disableDepthTestDistance=e;for(var t=this._glyphs,r=0,i=t.length;r<i;r++){var n=t[r];C(n.billboard)&&(n.billboard.disableDepthTestDistance=e)}var o=this._backgroundBillboard;C(o)&&(o.disableDepthTestDistance=e)}}},id:{get:function(){return this._id},set:function(e){if(this._id!==e){this._id=e;for(var t=this._glyphs,r=0,i=t.length;r<i;r++){var n=t[r];C(n.billboard)&&(n.billboard.id=e)}var o=this._backgroundBillboard;C(o)&&(o.id=e)}}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=l.clone(e,this._actualClampedPosition);for(var t=this._glyphs,r=0,i=t.length;r<i;r++){var n=t[r];C(n.billboard)&&(n.billboard._clampedPosition=e)}var o=this._backgroundBillboard;C(o)&&(o._clampedPosition=e)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){if(this._clusterShow!==e){this._clusterShow=e;for(var t=this._glyphs,r=0,i=t.length;r<i;r++){var n=t[r];C(n.billboard)&&(n.billboard.clusterShow=e)}var o=this._backgroundBillboard;C(o)&&(o.clusterShow=e)}}}}),i.prototype._updateClamping=function(){n._updateClamping(this._labelCollection,this)},i.prototype.computeScreenSpacePosition=function(e,t){if(!C(e))throw new c("scene is required.");C(t)||(t=new s);var r=this._labelCollection.modelMatrix,i=C(this._actualClampedPosition)?this._actualClampedPosition:this._position;return n._computeScreenSpacePosition(r,i,this._eyeOffset,this._pixelOffset,e,t)},i.getScreenSpaceBoundingBox=function(e,t,r){var i=0,n=0,o=0,a=0,s=e.scale,l=e._labelCollection._resolutionScale,u=e._backgroundBillboard;if(C(u))i=t.x+u._translate.x/l,n=t.y-u._translate.y/l,o=u.width*s,a=u.height*s,e.verticalOrigin===w.BOTTOM||e.verticalOrigin===w.BASELINE?n-=a:e.verticalOrigin===w.CENTER&&(n-=.5*a);else{i=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY;for(var c=0,d=0,h=e._glyphs,p=h.length,f=0;f<p;++f){var m=h[f].billboard;if(C(m)){var g=t.x+m._translate.x/l,_=t.y-m._translate.y/l,v=m.width*s,y=m.height*s;e.verticalOrigin===w.BOTTOM||e.verticalOrigin===w.BASELINE?_-=y:e.verticalOrigin===w.CENTER&&(_-=.5*y),i=Math.min(i,g),n=Math.min(n,_),c=Math.max(c,g+v),d=Math.max(d,_+y)}}o=c-i,a=d-n}return C(r)||(r=new b),r.x=i,r.y=n,r.width=o,r.height=a,r},i.prototype.equals=function(e){return this===e||C(e)&&this._show===e._show&&this._scale===e._scale&&this._outlineWidth===e._outlineWidth&&this._showBackground===e._showBackground&&this._style===e._style&&this._verticalOrigin===e._verticalOrigin&&this._horizontalOrigin===e._horizontalOrigin&&this._heightReference===e._heightReference&&this._renderedText===e._renderedText&&this._font===e._font&&l.equals(this._position,e._position)&&a.equals(this._fillColor,e._fillColor)&&a.equals(this._outlineColor,e._outlineColor)&&a.equals(this._backgroundColor,e._backgroundColor)&&s.equals(this._backgroundPadding,e._backgroundPadding)&&s.equals(this._pixelOffset,e._pixelOffset)&&l.equals(this._eyeOffset,e._eyeOffset)&&h.equals(this._translucencyByDistance,e._translucencyByDistance)&&h.equals(this._pixelOffsetScaleByDistance,e._pixelOffsetScaleByDistance)&&h.equals(this._scaleByDistance,e._scaleByDistance)&&d.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance&&this._id===e._id},i.prototype.isDestroyed=function(){return!1},i.enableRightToLeftDetection=!1;var E=new RegExp("abcdefg");return i}),define("Scene/LabelCollection",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Matrix4","../Core/writeTextToCanvas","./BillboardCollection","./BlendOption","./HorizontalOrigin","./Label","./LabelStyle","./TextureAtlas","./VerticalOrigin"],function(e,x,t,r,M,i,o,n,a,R,s,p,L,l,N,f,k){"use strict";function F(){this.textureInfo=void 0,this.dimensions=void 0,this.billboard=void 0}function B(e,t,r){this.labelCollection=e,this.index=t,this.dimensions=r}var P=1.2,U="ID_WHITE_PIXEL",m=new x(4,4),V=new e(1,1,1,1);var z={};function q(e,t){t.textureInfo=void 0,t.dimensions=void 0;var r=t.billboard;M(r)&&(r.show=!1,r.image=void 0,M(r._removeCallbackFunc)&&(r._removeCallbackFunc(),r._removeCallbackFunc=void 0),e._spareBillboards.push(r),t.billboard=void 0)}function G(e,t,r,i){e.addImage(t,r).then(function(e){i.index=e})}function g(e,t){var r,i,n,o=t._renderedText,a=o.length,s=t._glyphs,l=s.length;if(a<l)for(i=a;i<l;++i)q(e,s[i]);s.length=a;var u=t._showBackground&&0<o.split("\n").join("").length,c=t._backgroundBillboard,d=e._backgroundBillboardCollection;u?(M(c)||(c=d.add({collection:e,image:U,imageSubRegion:V}),t._backgroundBillboard=c),c.color=t._backgroundColor,c.show=t._show,c.position=t._position,c.eyeOffset=t._eyeOffset,c.pixelOffset=t._pixelOffset,c.horizontalOrigin=L.LEFT,c.verticalOrigin=t._verticalOrigin,c.heightReference=t._heightReference,c.scale=t._scale,c.pickPrimitive=t,c.id=t._id,c.translucencyByDistance=t._translucencyByDistance,c.pixelOffsetScaleByDistance=t._pixelOffsetScaleByDistance,c.scaleByDistance=t._scaleByDistance,c.distanceDisplayCondition=t._distanceDisplayCondition,c.disableDepthTestDistance=t._disableDepthTestDistance):M(c)&&(d.remove(c),t._backgroundBillboard=c=void 0);var h,p,f,m,g,_,v,y=e._glyphTextureCache;for(n=0;n<a;++n){var b=o.charAt(n),C=t._font,w=t._fillColor,S=t._outlineColor,T=t._outlineWidth,E=t._style,A=t._verticalOrigin,x=JSON.stringify([b,C,w.toRgba(),S.toRgba(),T,+E,+A]),P=y[x];if(!M(P)){var D=(h=b,p=C,f=w,m=S,g=T,_=E,v=A,z.font=p,z.fillColor=f,z.strokeColor=m,z.strokeWidth=g,v===k.CENTER?z.textBaseline="middle":v===k.TOP?z.textBaseline="top":z.textBaseline="bottom",z.fill=_===N.FILL||_===N.FILL_AND_OUTLINE,z.stroke=_===N.OUTLINE||_===N.FILL_AND_OUTLINE,R(h,z));P=new B(e,-1,D.dimensions),y[x]=P,0<D.width&&0<D.height&&G(e._textureAtlas,x,D,P)}if(r=s[n],M(r)?-1===P.index?q(e,r):M(r.textureInfo)&&(r.textureInfo=void 0):(r=new F,s[n]=r),r.textureInfo=P,r.dimensions=P.dimensions,-1!==P.index){var O=r.billboard,I=e._spareBillboards;M(O)||(O=0<I.length?I.pop():e._billboardCollection.add({collection:e}),r.billboard=O),O.show=t._show,O.position=t._position,O.eyeOffset=t._eyeOffset,O.pixelOffset=t._pixelOffset,O.horizontalOrigin=L.LEFT,O.verticalOrigin=t._verticalOrigin,O.heightReference=t._heightReference,O.scale=t._scale,O.pickPrimitive=t,O.id=t._id,O.image=x,O.translucencyByDistance=t._translucencyByDistance,O.pixelOffsetScaleByDistance=t._pixelOffsetScaleByDistance,O.scaleByDistance=t._scaleByDistance,O.distanceDisplayCondition=t._distanceDisplayCondition,O.disableDepthTestDistance=t._disableDepthTestDistance,O._batchIndex=t._batchIndex}}t._repositionAllGlyphs=!0}function D(e,t,r){return t===L.CENTER?-e/2:t===L.RIGHT?-(e+r.x):r.x}var O=new x,I=new x;function _(e,t){var r,i,n=e._glyphs,o=e._renderedText,a=0,s=0,l=[],u=Number.NEGATIVE_INFINITY,c=0,d=1,h=0,p=n.length,f=e._backgroundBillboard,m=I;for(x.clone(M(f)?e._backgroundPadding:x.ZERO,m),h=0;h<p;++h)"\n"===o.charAt(h)?(l.push(a),++d,a=0):(i=(r=n[h]).dimensions,c=Math.max(c,i.height-i.descent),u=Math.max(u,i.descent),a+=i.width-i.bounds.minx,h<p-1&&(a+=n[h+1].dimensions.bounds.minx),s=Math.max(s,a));l.push(a);var g=c+u,_=e._scale,v=e._horizontalOrigin,y=e._verticalOrigin,b=0,C=l[b],w=D(C,v,m),S=P*g,T=S*(d-1);O.x=w*_*t;var E=O.y=0;for(h=0;h<p;++h)if("\n"===o.charAt(h))E+=S,w=D(C=l[++b],v,m),O.x=w*_*t;else if(i=(r=n[h]).dimensions,y===k.TOP?O.y=i.height-c-m.y:y===k.CENTER?O.y=(T+i.height-c)/2:y===k.BASELINE?O.y=T:O.y=T+u+m.y,O.y=(O.y-i.descent-E)*_*t,M(r.billboard)&&r.billboard._setTranslate(O),h<p-1){var A=n[h+1];O.x+=(i.width-i.bounds.minx+A.dimensions.bounds.minx)*_*t}M(f)&&0<o.split("\n").join("").length&&(w=v===L.CENTER?-s/2-m.x:v===L.RIGHT?-(s+2*m.x):0,O.x=w*_*t,y===k.TOP?O.y=g-c-u:y===k.CENTER?O.y=(g-c)/2-u:y===k.BASELINE?O.y=-m.y-u:O.y=0,O.y=O.y*_*t,f.width=s+2*m.x,f.height=g+T+2*m.y,f._setTranslate(O))}function u(e,t){for(var r=t._glyphs,i=0,n=r.length;i<n;++i)q(e,r[i]);M(t._backgroundBillboard)&&(e._backgroundBillboardCollection.remove(t._backgroundBillboard),t._backgroundBillboard=void 0),t._labelCollection=void 0,M(t._removeCallbackFunc)&&t._removeCallbackFunc(),o(t)}function c(e){e=r(e,r.EMPTY_OBJECT),this._scene=e.scene,this._batchTable=e.batchTable,this._textureAtlas=void 0,this._backgroundTextureAtlas=void 0,this._whitePixelIndex=void 0,this._backgroundBillboardCollection=new s({scene:this._scene}),this._backgroundBillboardCollection.destroyTextureAtlas=!1,this._billboardCollection=new s({scene:this._scene,batchTable:this._batchTable}),this._billboardCollection.destroyTextureAtlas=!1,this._spareBillboards=[],this._glyphTextureCache={},this._labels=[],this._labelsToUpdate=[],this._totalGlyphCount=0,this._resolutionScale=void 0,this._highlightColor=t.clone(t.WHITE),this.modelMatrix=a.clone(r(e.modelMatrix,a.IDENTITY)),this.debugShowBoundingVolume=r(e.debugShowBoundingVolume,!1),this.blendOption=r(e.blendOption,p.OPAQUE_AND_TRANSLUCENT)}return i(c.prototype,{length:{get:function(){return this._labels.length}}}),c.prototype.add=function(e){var t=new l(e,this);return this._labels.push(t),this._labelsToUpdate.push(t),t},c.prototype.remove=function(e){if(M(e)&&e._labelCollection===this){var t=this._labels.indexOf(e);if(-1!==t)return this._labels.splice(t,1),u(this,e),!0}return!1},c.prototype.removeAll=function(){for(var e=this._labels,t=0,r=e.length;t<r;++t)u(this,e[t]);e.length=0},c.prototype.contains=function(e){return M(e)&&e._labelCollection===this},c.prototype.get=function(e){if(!M(e))throw new n("index is required.");return this._labels[e]},c.prototype.update=function(e){var t=this._billboardCollection,r=this._backgroundBillboardCollection;t.modelMatrix=this.modelMatrix,t.debugShowBoundingVolume=this.debugShowBoundingVolume,r.modelMatrix=this.modelMatrix,r.debugShowBoundingVolume=this.debugShowBoundingVolume;var i=e.context;M(this._textureAtlas)||(this._textureAtlas=new f({context:i}),t.textureAtlas=this._textureAtlas),M(this._backgroundTextureAtlas)||(this._backgroundTextureAtlas=new f({context:i,initialSize:m}),r.textureAtlas=this._backgroundTextureAtlas,function(e,t){var r=document.createElement("canvas");r.width=m.x,r.height=m.y;var i=r.getContext("2d");i.fillStyle="#fff",i.fillRect(0,0,r.width,r.height),e.addImage(U,r).then(function(e){t._whitePixelIndex=e})}(this._backgroundTextureAtlas,this));var n,o=i.uniformState.resolutionScale,a=this._resolutionScale!==o;this._resolutionScale=o;for(var s=(n=a?this._labels:this._labelsToUpdate).length,l=0;l<s;++l){var u=n[l];if(!u.isDestroyed()){var c=u._glyphs.length;u._rebindAllGlyphs&&(g(this,u),u._rebindAllGlyphs=!1),(a||u._repositionAllGlyphs)&&(_(u,o),u._repositionAllGlyphs=!1);var d=u._glyphs.length-c;this._totalGlyphCount+=d}}var h=0<r.length?p.TRANSLUCENT:this.blendOption;t.blendOption=h,r.blendOption=h,t._highlightColor=this._highlightColor,r._highlightColor=this._highlightColor,this._labelsToUpdate.length=0,r.update(e),t.update(e)},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){return this.removeAll(),this._billboardCollection=this._billboardCollection.destroy(),this._textureAtlas=this._textureAtlas&&this._textureAtlas.destroy(),this._backgroundBillboardCollection=this._backgroundBillboardCollection.destroy(),this._backgroundTextureAtlas=this._backgroundTextureAtlas&&this._backgroundTextureAtlas.destroy(),o(this)},c}),define("Scene/PointPrimitive",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/Matrix4","../Core/NearFarScalar","./SceneMode","./SceneTransforms"],function(u,o,a,s,l,c,d,e,h,p,f,m,i,g){"use strict";function _(e,t){if(e=c(e,c.EMPTY_OBJECT),d(e.disableDepthTestDistance)&&e.disableDepthTestDistance<0)throw new h("disableDepthTestDistance must be greater than or equal to 0.0.");var r=e.translucencyByDistance,i=e.scaleByDistance,n=e.distanceDisplayCondition;if(d(r)){if(r.far<=r.near)throw new h("translucencyByDistance.far must be greater than translucencyByDistance.near.");r=m.clone(r)}if(d(i)){if(i.far<=i.near)throw new h("scaleByDistance.far must be greater than scaleByDistance.near.");i=m.clone(i)}if(d(n)){if(n.far<=n.near)throw new h("distanceDisplayCondition.far must be greater than distanceDisplayCondition.near.");n=p.clone(n)}this._show=c(e.show,!0),this._position=a.clone(c(e.position,a.ZERO)),this._actualPosition=a.clone(this._position),this._color=l.clone(c(e.color,l.WHITE)),this._outlineColor=l.clone(c(e.outlineColor,l.TRANSPARENT)),this._outlineWidth=c(e.outlineWidth,0),this._pixelSize=c(e.pixelSize,10),this._scaleByDistance=i,this._translucencyByDistance=r,this._distanceDisplayCondition=n,this._disableDepthTestDistance=c(e.disableDepthTestDistance,0),this._id=e.id,this._collection=c(e.collection,t),this._clusterShow=!0,this._pickId=void 0,this._pointPrimitiveCollection=t,this._dirty=!1,this._index=-1}var t=_.SHOW_INDEX=0,r=_.POSITION_INDEX=1,n=_.COLOR_INDEX=2,v=_.OUTLINE_COLOR_INDEX=3,y=_.OUTLINE_WIDTH_INDEX=4,b=_.PIXEL_SIZE_INDEX=5,C=_.SCALE_BY_DISTANCE_INDEX=6,w=_.TRANSLUCENCY_BY_DISTANCE_INDEX=7,S=_.DISTANCE_DISPLAY_CONDITION_INDEX=8,T=_.DISABLE_DEPTH_DISTANCE_INDEX=9;function E(e,t){var r=e._pointPrimitiveCollection;d(r)&&(r._updatePointPrimitive(e,t),e._dirty=!0)}_.NUMBER_OF_PROPERTIES=10,e(_.prototype,{show:{get:function(){return this._show},set:function(e){if(!d(e))throw new h("value is required.");this._show!==e&&(this._show=e,E(this,t))}},position:{get:function(){return this._position},set:function(e){if(!d(e))throw new h("value is required.");var t=this._position;a.equals(t,e)||(a.clone(e,t),a.clone(e,this._actualPosition),E(this,r))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){if(d(e)&&e.far<=e.near)throw new h("far distance must be greater than near distance.");var t=this._scaleByDistance;m.equals(t,e)||(this._scaleByDistance=m.clone(e,t),E(this,C))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){if(d(e)&&e.far<=e.near)throw new h("far distance must be greater than near distance.");var t=this._translucencyByDistance;m.equals(t,e)||(this._translucencyByDistance=m.clone(e,t),E(this,w))}},pixelSize:{get:function(){return this._pixelSize},set:function(e){if(!d(e))throw new h("value is required.");this._pixelSize!==e&&(this._pixelSize=e,E(this,b))}},color:{get:function(){return this._color},set:function(e){if(!d(e))throw new h("value is required.");var t=this._color;l.equals(t,e)||(l.clone(e,t),E(this,n))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){if(!d(e))throw new h("value is required.");var t=this._outlineColor;l.equals(t,e)||(l.clone(e,t),E(this,v))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){if(!d(e))throw new h("value is required.");this._outlineWidth!==e&&(this._outlineWidth=e,E(this,y))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(d(e)&&e.far<=e.near)throw new h("far must be greater than near");p.equals(this._distanceDisplayCondition,e)||(this._distanceDisplayCondition=p.clone(e,this._distanceDisplayCondition),E(this,S))}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){if(this._disableDepthTestDistance!==e){if(!d(e)||e<0)throw new h("disableDepthTestDistance must be greater than or equal to 0.0.");this._disableDepthTestDistance=e,E(this,T)}}},id:{get:function(){return this._id},set:function(e){this._id=e,d(this._pickId)&&(this._pickId.object.id=e)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){this._clusterShow!==e&&(this._clusterShow=e,E(this,t))}}}),_.prototype.getPickId=function(e){return d(this._pickId)||(this._pickId=e.createPickId({primitive:this,collection:this._collection,id:this._id})),this._pickId},_.prototype._getActualPosition=function(){return this._actualPosition},_.prototype._setActualPosition=function(e){a.clone(e,this._actualPosition),E(this,r)};var A=new s;_._computeActualPosition=function(e,t,r){return t.mode===i.SCENE3D?e:(f.multiplyByPoint(r,e,A),g.computeActualWgs84Position(t,A))};var x=new s;return _._computeScreenSpacePosition=function(e,t,r,i){var n=f.multiplyByVector(e,s.fromElements(t.x,t.y,t.z,1,x),x);return g.wgs84ToWindowCoordinates(r,n,i)},_.prototype.computeScreenSpacePosition=function(e,t){var r=this._pointPrimitiveCollection;if(d(t)||(t=new o),!d(r))throw new h("PointPrimitive must be in a collection.");if(!d(e))throw new h("scene is required.");var i=r.modelMatrix,n=_._computeScreenSpacePosition(i,this._actualPosition,e,t);if(d(n))return n.y=e.canvas.clientHeight-n.y,n},_.getScreenSpaceBoundingBox=function(e,t,r){var i=e.pixelSize,n=.5*i,o=t.x-n,a=t.y-n,s=i,l=i;return d(r)||(r=new u),r.x=o,r.y=a,r.width=s,r.height=l,r},_.prototype.equals=function(e){return this===e||d(e)&&this._id===e._id&&a.equals(this._position,e._position)&&l.equals(this._color,e._color)&&this._pixelSize===e._pixelSize&&this._outlineWidth===e._outlineWidth&&this._show===e._show&&l.equals(this._outlineColor,e._outlineColor)&&m.equals(this._scaleByDistance,e._scaleByDistance)&&m.equals(this._translucencyByDistance,e._translucencyByDistance)&&p.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance},_.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._pointPrimitiveCollection=void 0},_}),define("Shaders/PointPrimitiveCollectionFS",[],function(){"use strict";return"varying vec4 v_color;\nvarying vec4 v_outlineColor;\nvarying float v_innerPercent;\nvarying float v_pixelDistance;\n#ifdef RENDER_FOR_PICK\nvarying vec4 v_pickColor;\n#endif\nvoid main()\n{\nfloat distanceToCenter = length(gl_PointCoord - vec2(0.5));\nfloat maxDistance = max(0.0, 0.5 - v_pixelDistance);\nfloat wholeAlpha = 1.0 - smoothstep(maxDistance, 0.5, distanceToCenter);\nfloat innerAlpha = 1.0 - smoothstep(maxDistance * v_innerPercent, 0.5 * v_innerPercent, distanceToCenter);\nvec4 color = mix(v_outlineColor, v_color, innerAlpha);\ncolor.a *= wholeAlpha;\n#if defined(RENDER_FOR_PICK) || (!defined(OPAQUE) && !defined(TRANSLUCENT))\nif (color.a < 0.005)\n{\ndiscard;\n}\n#else\n#ifdef OPAQUE\nif (color.a < 0.995)\n{\ndiscard;\n}\n#else\nif (color.a >= 0.995)\n{\ndiscard;\n}\n#endif\n#endif\n#ifdef RENDER_FOR_PICK\ngl_FragColor = v_pickColor;\n#else\ngl_FragColor = color;\n#endif\n}\n"}),define("Shaders/PointPrimitiveCollectionVS",[],function(){"use strict";return"uniform float u_maxTotalPointSize;\nattribute vec4 positionHighAndSize;\nattribute vec4 positionLowAndOutline;\nattribute vec4 compressedAttribute0;\nattribute vec4 compressedAttribute1;\nattribute vec4 scaleByDistance;\nattribute vec3 distanceDisplayConditionAndDisableDepth;\nvarying vec4 v_color;\nvarying vec4 v_outlineColor;\nvarying float v_innerPercent;\nvarying float v_pixelDistance;\n#ifdef RENDER_FOR_PICK\nvarying vec4 v_pickColor;\n#endif\nconst float SHIFT_LEFT8 = 256.0;\nconst float SHIFT_RIGHT8 = 1.0 / 256.0;\nvoid main()\n{\nvec3 positionHigh = positionHighAndSize.xyz;\nvec3 positionLow = positionLowAndOutline.xyz;\nfloat outlineWidthBothSides = 2.0 * positionLowAndOutline.w;\nfloat totalSize = positionHighAndSize.w + outlineWidthBothSides;\nfloat outlinePercent = outlineWidthBothSides / totalSize;\ntotalSize *= czm_resolutionScale;\ntotalSize += 3.0;\nfloat temp = compressedAttribute1.x * SHIFT_RIGHT8;\nfloat show = floor(temp);\n#ifdef EYE_DISTANCE_TRANSLUCENCY\nvec4 translucencyByDistance;\ntranslucencyByDistance.x = compressedAttribute1.z;\ntranslucencyByDistance.z = compressedAttribute1.w;\ntranslucencyByDistance.y = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\ntemp = compressedAttribute1.y * SHIFT_RIGHT8;\ntranslucencyByDistance.w = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\n#endif\nvec4 color;\nvec4 outlineColor;\n#ifdef RENDER_FOR_PICK\ncolor = vec4(0.0);\noutlineColor = vec4(0.0);\nvec4 pickColor;\ntemp = compressedAttribute0.z * SHIFT_RIGHT8;\npickColor.b = (temp - floor(temp)) * SHIFT_LEFT8;\ntemp = floor(temp) * SHIFT_RIGHT8;\npickColor.g = (temp - floor(temp)) * SHIFT_LEFT8;\npickColor.r = floor(temp);\n#else\ntemp = compressedAttribute0.x * SHIFT_RIGHT8;\ncolor.b = (temp - floor(temp)) * SHIFT_LEFT8;\ntemp = floor(temp) * SHIFT_RIGHT8;\ncolor.g = (temp - floor(temp)) * SHIFT_LEFT8;\ncolor.r = floor(temp);\ntemp = compressedAttribute0.y * SHIFT_RIGHT8;\noutlineColor.b = (temp - floor(temp)) * SHIFT_LEFT8;\ntemp = floor(temp) * SHIFT_RIGHT8;\noutlineColor.g = (temp - floor(temp)) * SHIFT_LEFT8;\noutlineColor.r = floor(temp);\n#endif\ntemp = compressedAttribute0.w * SHIFT_RIGHT8;\n#ifdef RENDER_FOR_PICK\npickColor.a = (temp - floor(temp)) * SHIFT_LEFT8;\npickColor = pickColor / 255.0;\n#endif\ntemp = floor(temp) * SHIFT_RIGHT8;\noutlineColor.a = (temp - floor(temp)) * SHIFT_LEFT8;\noutlineColor /= 255.0;\ncolor.a = floor(temp);\ncolor /= 255.0;\nvec4 p = czm_translateRelativeToEye(positionHigh, positionLow);\nvec4 positionEC = czm_modelViewRelativeToEye * p;\npositionEC.xyz *= show;\n#if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(DISTANCE_DISPLAY_CONDITION) || defined(DISABLE_DEPTH_DISTANCE)\nfloat lengthSq;\nif (czm_sceneMode == czm_sceneMode2D)\n{\nlengthSq = czm_eyeHeight2D.y;\n}\nelse\n{\nlengthSq = dot(positionEC.xyz, positionEC.xyz);\n}\n#endif\n#ifdef EYE_DISTANCE_SCALING\ntotalSize *= czm_nearFarScalar(scaleByDistance, lengthSq);\n#endif\ntotalSize = min(totalSize, u_maxTotalPointSize);\nif (totalSize < 1.0)\n{\npositionEC.xyz = vec3(0.0);\ntotalSize = 1.0;\n}\nfloat translucency = 1.0;\n#ifdef EYE_DISTANCE_TRANSLUCENCY\ntranslucency = czm_nearFarScalar(translucencyByDistance, lengthSq);\nif (translucency < 0.004)\n{\npositionEC.xyz = vec3(0.0);\n}\n#endif\n#ifdef DISTANCE_DISPLAY_CONDITION\nfloat nearSq = distanceDisplayConditionAndDisableDepth.x;\nfloat farSq = distanceDisplayConditionAndDisableDepth.y;\nif (lengthSq < nearSq || lengthSq > farSq) {\npositionEC.xyz = vec3(0.0);\n}\n#endif\nvec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\ngl_Position = czm_viewportOrthographic * vec4(positionWC.xy, -positionWC.z, 1.0);\n#ifdef DISABLE_DEPTH_DISTANCE\nfloat disableDepthTestDistance = distanceDisplayConditionAndDisableDepth.z;\nif (disableDepthTestDistance == 0.0 && czm_minimumDisableDepthTestDistance != 0.0)\n{\ndisableDepthTestDistance = czm_minimumDisableDepthTestDistance;\n}\nif (disableDepthTestDistance != 0.0)\n{\nfloat zclip = gl_Position.z / gl_Position.w;\nbool clipped = (zclip < -1.0 || zclip > 1.0);\nif (!clipped && (disableDepthTestDistance < 0.0 || (lengthSq > 0.0 && lengthSq < disableDepthTestDistance)))\n{\ngl_Position.z = -gl_Position.w;\n}\n}\n#endif\nv_color = color;\nv_color.a *= translucency;\nv_outlineColor = outlineColor;\nv_outlineColor.a *= translucency;\nv_innerPercent = 1.0 - outlinePercent;\nv_pixelDistance = 2.0 / totalSize;\ngl_PointSize = totalSize;\n#ifdef RENDER_FOR_PICK\nv_pickColor = pickColor;\n#endif\n}\n"}),define("Scene/PointPrimitiveCollection",["../Core/BoundingSphere","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EncodedCartesian3","../Core/Math","../Core/Matrix4","../Core/PrimitiveType","../Core/WebGLConstants","../Renderer/BufferUsage","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArrayFacade","../Shaders/PointPrimitiveCollectionFS","../Shaders/PointPrimitiveCollectionVS","./BlendingState","./BlendOption","./PointPrimitive","./SceneMode"],function(te,m,re,r,ie,e,t,i,h,p,ne,oe,ae,o,se,le,ue,ce,de,he,pe,fe,me,ge,_e,f,ve){"use strict";var ye=f.SHOW_INDEX,be=f.POSITION_INDEX,Ce=f.COLOR_INDEX,we=f.OUTLINE_COLOR_INDEX,Se=f.OUTLINE_WIDTH_INDEX,Te=f.PIXEL_SIZE_INDEX,Ee=f.SCALE_BY_DISTANCE_INDEX,Ae=f.TRANSLUCENCY_BY_DISTANCE_INDEX,xe=f.DISTANCE_DISPLAY_CONDITION_INDEX,Pe=f.DISABLE_DEPTH_DISTANCE_INDEX,De=f.NUMBER_OF_PROPERTIES,Oe={positionHighAndSize:0,positionLowAndOutline:1,compressedAttribute0:2,compressedAttribute1:3,scaleByDistance:4,distanceDisplayConditionAndDisableDepth:5};function n(e){e=r(e,r.EMPTY_OBJECT),this._sp=void 0,this._spTranslucent=void 0,this._spPick=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._compiledShaderScaleByDistancePick=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistancePick=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayConditionPick=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistancePick=!1,this._propertiesChanged=new Uint32Array(De),this._maxPixelSize=1,this._baseVolume=new te,this._baseVolumeWC=new te,this._baseVolume2D=new te,this._boundingVolume=new te,this._boundingVolumeDirty=!1,this._colorCommands=[],this._pickCommands=[],this.modelMatrix=ne.clone(r(e.modelMatrix,ne.IDENTITY)),this._modelMatrix=ne.clone(ne.IDENTITY),this.debugShowBoundingVolume=r(e.debugShowBoundingVolume,!1),this.blendOption=r(e.blendOption,_e.OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=ve.SCENE3D,this._maxTotalPointSize=1,this._buffersUsage=[o.STATIC_DRAW,o.STATIC_DRAW,o.STATIC_DRAW,o.STATIC_DRAW,o.STATIC_DRAW,o.STATIC_DRAW,o.STATIC_DRAW,o.STATIC_DRAW,o.STATIC_DRAW];var t=this;this._uniforms={u_maxTotalPointSize:function(){return t._maxTotalPointSize}}}function a(e){for(var t=e.length,r=0;r<t;++r)e[r]&&e[r]._destroy()}function Ie(e){if(e._pointPrimitivesRemoved){e._pointPrimitivesRemoved=!1;for(var t=[],r=e._pointPrimitives,i=r.length,n=0,o=0;n<i;++n){var a=r[n];a&&(a._index=o++,t.push(a))}e._pointPrimitives=t}}e(n.prototype,{length:{get:function(){return Ie(this),this._pointPrimitives.length}}}),n.prototype.add=function(e){var t=new f(e,this);return t._index=this._pointPrimitives.length,this._pointPrimitives.push(t),this._createVertexArray=!0,t},n.prototype.remove=function(e){return!!this.contains(e)&&(this._pointPrimitives[e._index]=null,this._pointPrimitivesRemoved=!0,this._createVertexArray=!0,e._destroy(),!0)},n.prototype.removeAll=function(){a(this._pointPrimitives),this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!0},n.prototype._updatePointPrimitive=function(e,t){e._dirty||(this._pointPrimitivesToUpdate[this._pointPrimitivesToUpdateIndex++]=e),++this._propertiesChanged[t]},n.prototype.contains=function(e){return ie(e)&&e._pointPrimitiveCollection===this},n.prototype.get=function(e){if(!ie(e))throw new i("index is required.");return Ie(this),this._pointPrimitives[e]},n.prototype.computeNewBuffersUsage=function(){for(var e=this._buffersUsage,t=!1,r=this._propertiesChanged,i=0;i<De;++i){var n=0===r[i]?o.STATIC_DRAW:o.STREAM_DRAW;t=t||e[i]!==n,e[i]=n}return t};var g=new h;function Me(e,t,r,i){var n=i._index,o=i._getActualPosition();e._mode===ve.SCENE3D&&(te.expand(e._baseVolume,o,e._baseVolume),e._boundingVolumeDirty=!0),h.fromCartesian(o,g);var a=i.pixelSize,s=i.outlineWidth;e._maxPixelSize=Math.max(e._maxPixelSize,a+s);var l=r[Oe.positionHighAndSize],u=g.high;l(n,u.x,u.y,u.z,a);var c=r[Oe.positionLowAndOutline],d=g.low;c(n,d.x,d.y,d.z,s)}var _=65536,v=256;function Re(e,t,r,i){var n=i._index,o=i.color,a=i.getPickId(t).color,s=i.outlineColor,l=m.floatToByte(o.red),u=m.floatToByte(o.green),c=m.floatToByte(o.blue),d=l*_+u*v+c;l=m.floatToByte(s.red),u=m.floatToByte(s.green),c=m.floatToByte(s.blue);var h=l*_+u*v+c;l=m.floatToByte(a.red),u=m.floatToByte(a.green),c=m.floatToByte(a.blue);var p=l*_+u*v+c,f=m.floatToByte(o.alpha)*_+m.floatToByte(s.alpha)*v+m.floatToByte(a.alpha);(0,r[Oe.compressedAttribute0])(n,d,h,p,f)}function Le(e,t,r,i){var n=i._index,o=0,a=1,s=1,l=1,u=i.translucencyByDistance;ie(u)&&(o=u.near,a=u.nearValue,s=u.far,l=u.farValue,1===a&&1===l||(e._shaderTranslucencyByDistance=!0));var c=i.show&&i.clusterShow;0===i.color.alpha&&0===i.outlineColor.alpha&&(c=!1),a=p.clamp(a,0,1);var d=(c?1:0)*v+(a=1===a?255:255*a|0),h=l=1===(l=p.clamp(l,0,1))?255:255*l|0;(0,r[Oe.compressedAttribute1])(n,d,h,o,s)}function Ne(e,t,r,i){var n=i._index,o=r[Oe.scaleByDistance],a=0,s=1,l=1,u=1,c=i.scaleByDistance;ie(c)&&(a=c.near,s=c.nearValue,l=c.far,u=c.farValue,1===s&&1===u||(e._shaderScaleByDistance=!0)),o(n,a,s,l,u)}function ke(e,t,r,i){var n=i._index,o=r[Oe.distanceDisplayConditionAndDisableDepth],a=0,s=Number.MAX_VALUE,l=i.distanceDisplayCondition;ie(l)&&(a=l.near,s=l.far,a*=a,s*=s,e._shaderDistanceDisplayCondition=!0);var u=i.disableDepthTestDistance;0<(u*=u)&&(e._shaderDisableDepthDistance=!0,u===Number.POSITIVE_INFINITY&&(u=-1)),o(n,a,s,u)}function Fe(e,t,r,i,n,o){var a;i.mode===ve.SCENE3D?(a=e._baseVolume,e._boundingVolumeDirty=!0):a=e._baseVolume2D;for(var s=[],l=0;l<r;++l){var u=t[l],c=u.position,d=f._computeActualPosition(c,i,n);ie(d)&&(u._setActualPosition(d),o?s.push(d):te.expand(a,d,a))}o&&te.fromPoints(s,a)}var Be=[];return n.prototype.update=function(e){var t,r,i,n,o,a;Ie(this),this._maxTotalPointSize=se.maximumAliasedPointSize,t=this,i=(r=e).mode,n=t._pointPrimitives,o=t._pointPrimitivesToUpdate,a=t._modelMatrix,t._createVertexArray||t._mode!==i||i!==ve.SCENE3D&&!ne.equals(a,t.modelMatrix)?(t._mode=i,ne.clone(t.modelMatrix,a),t._createVertexArray=!0,i!==ve.SCENE3D&&i!==ve.SCENE2D&&i!==ve.COLUMBUS_VIEW||Fe(t,n,n.length,r,a,!0)):i===ve.MORPHING?Fe(t,n,n.length,r,a,!0):i!==ve.SCENE2D&&i!==ve.COLUMBUS_VIEW||Fe(t,o,t._pointPrimitivesToUpdateIndex,r,a,!1);var s,l,u,c,d,h,p,f,m=this._pointPrimitives.length,g=this._pointPrimitivesToUpdate,_=this._pointPrimitivesToUpdateIndex,v=this._propertiesChanged,y=this._createVertexArray,b=e.context,C=e.passes,w=C.pick;if(y||!w&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(var S=0;S<De;++S)v[S]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),0<m){this._vaf=(h=b,p=m,f=this._buffersUsage,new pe(h,[{index:Oe.positionHighAndSize,componentsPerAttribute:4,componentDatatype:re.FLOAT,usage:f[be]},{index:Oe.positionLowAndShow,componentsPerAttribute:4,componentDatatype:re.FLOAT,usage:f[be]},{index:Oe.compressedAttribute0,componentsPerAttribute:4,componentDatatype:re.FLOAT,usage:f[Ce]},{index:Oe.compressedAttribute1,componentsPerAttribute:4,componentDatatype:re.FLOAT,usage:f[Ae]},{index:Oe.scaleByDistance,componentsPerAttribute:4,componentDatatype:re.FLOAT,usage:f[Ee]},{index:Oe.distanceDisplayConditionAndDisableDepth,componentsPerAttribute:3,componentDatatype:re.FLOAT,usage:f[xe]}],p)),s=this._vaf.writers;for(var T=0;T<m;++T){var E=this._pointPrimitives[T];E._dirty=!1,u=b,Me(l=this,0,c=s,d=E),Re(0,u,c,d),Le(l,0,c,d),Ne(l,0,c,d),ke(l,0,c,d)}this._vaf.commit()}this._pointPrimitivesToUpdateIndex=0}else if(0<_){var A=Be;A.length=0,(v[be]||v[Se]||v[Te])&&A.push(Me),(v[Ce]||v[we])&&A.push(Re),(v[ye]||v[Ae])&&A.push(Le),v[Ee]&&A.push(Ne),(v[xe]||v[Pe])&&A.push(ke);var x=A.length;if(s=this._vaf.writers,.1<_/m){for(var P=0;P<_;++P){var D=g[P];D._dirty=!1;for(var O=0;O<x;++O)A[O](this,b,s,D)}this._vaf.commit()}else{for(var I=0;I<_;++I){var M=g[I];M._dirty=!1;for(var R=0;R<x;++R)A[R](this,b,s,M);this._vaf.subCommit(M._index,1)}this._vaf.endSubCommits()}this._pointPrimitivesToUpdateIndex=0}if(1.5*m<_&&(g.length=m),ie(this._vaf)&&ie(this._vaf.va)){var L;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,te.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));var N,k,F,B,U=ne.IDENTITY;L=e.mode===ve.SCENE3D?(U=this.modelMatrix,te.clone(this._baseVolumeWC,this._boundingVolume)):te.clone(this._baseVolume2D,this._boundingVolume),N=this,F=L,B=(k=e).camera.getPixelSize(F,k.context.drawingBufferWidth,k.context.drawingBufferHeight)*N._maxPixelSize,F.radius+=B;var V,z,q,G,W,H,j=this._blendOption!==this.blendOption;this._blendOption=this.blendOption,j&&(this._blendOption===_e.OPAQUE||this._blendOption===_e.OPAQUE_AND_TRANSLUCENT?this._rsOpaque=ce.fromCache({depthTest:{enabled:!0,func:ae.LEQUAL},depthMask:!0}):this._rsOpaque=void 0,this._blendOption===_e.TRANSLUCENT||this._blendOption===_e.OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=ce.fromCache({depthTest:{enabled:!0,func:ae.LEQUAL},depthMask:!1,blending:ge.ALPHA_BLEND}):this._rsTranslucent=void 0),this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||0!==e.minimumDisableDepthTestDistance,(j||this._shaderScaleByDistance&&!this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance&&!this._compiledShaderTranslucencyByDistance||this._shaderDistanceDisplayCondition&&!this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance)&&(V=new he({sources:[me]}),this._shaderScaleByDistance&&V.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&V.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderDistanceDisplayCondition&&V.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&V.defines.push("DISABLE_DEPTH_DISTANCE"),this._blendOption===_e.OPAQUE_AND_TRANSLUCENT&&(z=new he({defines:["OPAQUE"],sources:[fe]}),this._sp=de.replaceCache({context:b,shaderProgram:this._sp,vertexShaderSource:V,fragmentShaderSource:z,attributeLocations:Oe}),z=new he({defines:["TRANSLUCENT"],sources:[fe]}),this._spTranslucent=de.replaceCache({context:b,shaderProgram:this._spTranslucent,vertexShaderSource:V,fragmentShaderSource:z,attributeLocations:Oe})),this._blendOption===_e.OPAQUE&&(z=new he({sources:[fe]}),this._sp=de.replaceCache({context:b,shaderProgram:this._sp,vertexShaderSource:V,fragmentShaderSource:z,attributeLocations:Oe})),this._blendOption===_e.TRANSLUCENT&&(z=new he({sources:[fe]}),this._spTranslucent=de.replaceCache({context:b,shaderProgram:this._spTranslucent,vertexShaderSource:V,fragmentShaderSource:z,attributeLocations:Oe})),this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance),(!ie(this._spPick)||this._shaderScaleByDistance&&!this._compiledShaderScaleByDistancePick||this._shaderTranslucencyByDistance&&!this._compiledShaderTranslucencyByDistancePick||this._shaderDistanceDisplayCondition&&!this._compiledShaderDistanceDisplayConditionPick||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistancePick)&&(V=new he({defines:["RENDER_FOR_PICK"],sources:[me]}),this._shaderScaleByDistance&&V.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&V.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderDistanceDisplayCondition&&V.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&V.defines.push("DISABLE_DEPTH_DISTANCE"),z=new he({defines:["RENDER_FOR_PICK"],sources:[fe]}),this._spPick=de.replaceCache({context:b,shaderProgram:this._spPick,vertexShaderSource:V,fragmentShaderSource:z,attributeLocations:Oe}),this._compiledShaderScaleByDistancePick=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistancePick=this._shaderTranslucencyByDistance,this._compiledShaderDistanceDisplayConditionPick=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistancePick=this._shaderDisableDepthDistance);var Y=e.commandList;if(C.render){var X=this._colorCommands,Q=this._blendOption===_e.OPAQUE,Z=this._blendOption===_e.OPAQUE_AND_TRANSLUCENT;G=(q=this._vaf.va).length,X.length=G;var K=Z?2*G:G;for(H=0;H<K;++H){var J=Q||Z&&H%2==0;W=X[H],ie(W)||(W=X[H]=new le),W.primitiveType=oe.POINTS,W.pass=J||!Z?ue.OPAQUE:ue.TRANSLUCENT,W.owner=this;var $=Z?Math.floor(H/2):H;W.boundingVolume=L,W.modelMatrix=U,W.shaderProgram=J?this._sp:this._spTranslucent,W.uniformMap=this._uniforms,W.vertexArray=q[$].va,W.renderState=J?this._rsOpaque:this._rsTranslucent,W.debugShowBoundingVolume=this.debugShowBoundingVolume,Y.push(W)}}if(w){var ee=this._pickCommands;for(G=(q=this._vaf.va).length,ee.length=G,H=0;H<G;++H)W=ee[H],ie(W)||(W=ee[H]=new le({primitiveType:oe.POINTS,pass:ue.OPAQUE,owner:this})),W.boundingVolume=L,W.modelMatrix=U,W.shaderProgram=this._spPick,W.uniformMap=this._uniforms,W.vertexArray=q[H].va,W.renderState=this._rsOpaque,Y.push(W)}}},n.prototype.isDestroyed=function(){return!1},n.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),a(this._pointPrimitives),t(this)},n}),define("ThirdParty/kdbush",[],function(){"use strict";function o(e,t,r,i,n){t=t||a,r=r||s,n=n||Array,this.nodeSize=i||64,this.points=e,this.ids=new n(e.length),this.coords=new n(2*e.length);for(var o=0;o<e.length;o++)this.ids[o]=o,this.coords[2*o]=t(e[o]),this.coords[2*o+1]=r(e[o]);!function e(t,r,i,n,o,a){if(o-n<=i)return;var s=Math.floor((n+o)/2);f(t,r,s,n,o,a%2);e(t,r,i,n,s-1,a+1);e(t,r,i,s+1,o,a+1)}(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function a(e){return e[0]}function s(e){return e[1]}function f(e,t,r,i,n,o){for(;i<n;){if(600<n-i){var a=n-i+1,s=r-i+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(s-a/2<0?-1:1);f(e,t,r,Math.max(i,Math.floor(r-s*u/a+c)),Math.min(n,Math.floor(r+(a-s)*u/a+c)),o)}var d=t[2*r+o],h=i,p=n;for(m(e,t,i,r),t[2*n+o]>d&&m(e,t,i,n);h<p;){for(m(e,t,h,p),h++,p--;t[2*h+o]<d;)h++;for(;t[2*p+o]>d;)p--}t[2*i+o]===d?m(e,t,i,p):m(e,t,++p,n),p<=r&&(i=p+1),r<=p&&(n=p-1)}}function m(e,t,r,i){n(e,r,i),n(t,2*r,2*i),n(t,2*r+1,2*i+1)}function n(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function _(e,t,r,i){var n=e-r,o=t-i;return n*n+o*o}return o.prototype={range:function(e,t,r,i){return function(e,t,r,i,n,o,a){var s,l,u=[0,e.length-1,0],c=[];for(;u.length;){var d=u.pop(),h=u.pop(),p=u.pop();if(h-p<=a)for(var f=p;f<=h;f++)s=t[2*f],l=t[2*f+1],r<=s&&s<=n&&i<=l&&l<=o&&c.push(e[f]);else{var m=Math.floor((p+h)/2);s=t[2*m],l=t[2*m+1],r<=s&&s<=n&&i<=l&&l<=o&&c.push(e[m]);var g=(d+1)%2;(0===d?r<=s:i<=l)&&(u.push(p),u.push(m-1),u.push(g)),(0===d?s<=n:l<=o)&&(u.push(m+1),u.push(h),u.push(g))}}return c}(this.ids,this.coords,e,t,r,i,this.nodeSize)},within:function(e,t,r){return function(e,t,r,i,n,o){var a=[0,e.length-1,0],s=[],l=n*n;for(;a.length;){var u=a.pop(),c=a.pop(),d=a.pop();if(c-d<=o)for(var h=d;h<=c;h++)_(t[2*h],t[2*h+1],r,i)<=l&&s.push(e[h]);else{var p=Math.floor((d+c)/2),f=t[2*p],m=t[2*p+1];_(f,m,r,i)<=l&&s.push(e[p]);var g=(u+1)%2;(0===u?r-n<=f:i-n<=m)&&(a.push(d),a.push(p-1),a.push(g)),(0===u?f<=r+n:m<=i+n)&&(a.push(p+1),a.push(c),a.push(g))}}return s}(this.ids,this.coords,e,t,r,this.nodeSize)}},function(e,t,r,i,n){return new o(e,t,r,i,n)}}),define("DataSources/EntityCluster",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/EllipsoidalOccluder","../Core/Event","../Core/Matrix4","../Scene/Billboard","../Scene/BillboardCollection","../Scene/Label","../Scene/LabelCollection","../Scene/PointPrimitive","../Scene/PointPrimitiveCollection","../Scene/SceneMode","../ThirdParty/kdbush"],function(Y,X,Q,t,Z,e,K,r,J,$,ee,l,te,u,re,h,ie){"use strict";function i(e){e=t(e,t.EMPTY_OBJECT),this._enabled=t(e.enabled,!1),this._pixelRange=t(e.pixelRange,80),this._minimumClusterSize=t(e.minimumClusterSize,2),this._clusterBillboards=t(e.clusterBillboards,!0),this._clusterLabels=t(e.clusterLabels,!0),this._clusterPoints=t(e.clusterPoints,!0),this._labelCollection=void 0,this._billboardCollection=void 0,this._pointCollection=void 0,this._clusterBillboardCollection=void 0,this._clusterLabelCollection=void 0,this._clusterPointCollection=void 0,this._collectionIndicesByEntity={},this._unusedLabelIndices=[],this._unusedBillboardIndices=[],this._unusedPointIndices=[],this._previousClusters=[],this._previousHeight=void 0,this._enabledDirty=!1,this._clusterDirty=!1,this._cluster=void 0,this._removeEventListener=void 0,this._clusterEvent=new r}function ne(e){return e.coord.x}function oe(e){return e.coord.y}function c(e,t){e.x-=t,e.y-=t,e.width+=2*t,e.height+=2*t}var d=new Y;function ae(e,t,r,i,n){if(Z(e._labelCollection)&&i._clusterLabels?n=l.getScreenSpaceBoundingBox(e,t,n):Z(e._billboardCollection)&&i._clusterBillboards?n=$.getScreenSpaceBoundingBox(e,t,n):Z(e._pointPrimitiveCollection)&&i._clusterPoints&&(n=u.getScreenSpaceBoundingBox(e,t,n)),c(n,r),i._clusterLabels&&!Z(e._labelCollection)&&Z(e.id)&&p(i,e.id)&&Z(e.id._label)){var o=i._collectionIndicesByEntity[e.id],a=i._labelCollection.get(o),s=l.getScreenSpaceBoundingBox(a,t,d);c(s,r),n=Y.union(n,s,n)}return n}function se(e,t){if(e.clusterShow=!0,!Z(e._labelCollection)&&Z(e.id)&&p(t,e.id)&&Z(e.id._label)){var r=t._collectionIndicesByEntity[e.id];t._labelCollection.get(r).clusterShow=!0}}function le(e,t,r,i){var n={billboard:i._clusterBillboardCollection.add(),label:i._clusterLabelCollection.add(),point:i._clusterPointCollection.add()};n.billboard.show=!1,n.point.show=!1,n.label.show=!0,n.label.text=t.toLocaleString(),n.label.id=r,n.billboard.position=n.label.position=n.point.position=e,i._clusterEvent.raiseEvent(r,n)}function p(e,t){return Z(e)&&Z(e._collectionIndicesByEntity[t])&&Z(e._collectionIndicesByEntity[t].labelIndex)}function ue(e,t,r,i,n){if(Z(e))for(var o=e.length,a=0;a<o;++a){var s=e.get(a);if(s.clusterShow=!1,s.show&&(n._scene.mode!==h.SCENE3D||i.isPointVisible(s.position))){var l=n._clusterLabels&&Z(s._labelCollection),u=n._clusterBillboards&&Z(s.id._billboard),c=n._clusterPoints&&Z(s.id._point);if(!l||!c&&!u){var d=s.computeScreenSpacePosition(r);Z(d)&&t.push({index:a,collection:e,clustered:!1,coord:d})}}}}var ce=new Y,de=new Y,he=new Y;function n(a,s,l,u){return function(e){var t=this[a];Z(this._collectionIndicesByEntity)||(this._collectionIndicesByEntity={});var r,i,n=this._collectionIndicesByEntity[e.id];if(Z(n)||(n=this._collectionIndicesByEntity[e.id]={billboardIndex:void 0,labelIndex:void 0,pointIndex:void 0}),Z(t)&&Z(n[u]))return t.get(n[u]);Z(t)||(t=this[a]=new s({scene:this._scene}));var o=this[l];return 0<o.length?(r=o.pop(),i=t.get(r)):(i=t.add(),r=t.length-1),n[u]=r,this._clusterDirty=!0,i}}function o(e,t){var r=e._collectionIndicesByEntity[t];Z(r.billboardIndex)||Z(r.labelIndex)||Z(r.pointIndex)||delete e._collectionIndicesByEntity[t]}function a(e){if(Z(e))for(var t=e.length,r=0;r<t;++r)e.get(r).clusterShow=!0}return i.prototype._initialize=function(e){this._scene=e;var j,t=(j=this,function(e){if(!(Z(e)&&e<.05)&&j.enabled){var t=j._scene,r=j._labelCollection,i=j._billboardCollection,n=j._pointCollection;if((Z(r)||Z(i)||Z(n))&&(j._clusterBillboards||j._clusterLabels||j._clusterPoints)){var o=j._clusterLabelCollection,a=j._clusterBillboardCollection,s=j._clusterPointCollection;Z(o)?o.removeAll():o=j._clusterLabelCollection=new te({scene:t}),Z(a)?a.removeAll():a=j._clusterBillboardCollection=new ee({scene:t}),Z(s)?s.removeAll():s=j._clusterPointCollection=new re;var l,u,c,d,h,p,f,m,g,_,v,y=j._pixelRange,b=j._minimumClusterSize,C=j._previousClusters,w=[],S=j._previousHeight,T=t.camera.positionCartographic.height,E=t.mapProjection.ellipsoid,A=t.camera.positionWC,x=new K(E,A),P=[];j._clusterLabels&&ue(r,P,t,x,j),j._clusterBillboards&&ue(i,P,t,x,j),j._clusterPoints&&ue(n,P,t,x,j);var D=ie(P,ne,oe,64,Int32Array);if(T<S)for(c=C.length,l=0;l<c;++l){var O=C[l];if(x.isPointVisible(O.position)){var I=$._computeScreenSpacePosition(J.IDENTITY,O.position,Q.ZERO,X.ZERO,t);if(Z(I)){var M=1-T/S,R=O.width=O.width*M,L=O.height=O.height*M;R=Math.max(R,O.minimumWidth),L=Math.max(L,O.minimumHeight);var N=I.x-.5*R,k=I.y-.5*L,F=I.x+R,B=I.y+L;for(p=(h=D.range(N,k,F,B)).length,m=[],u=g=0;u<p;++u)(f=P[h[u]]).clustered||(++g,_=f.collection,v=f.index,m.push(_.get(v).id));if(b<=g)for(le(O.position,g,m,j),w.push(O),u=0;u<p;++u)P[h[u]].clustered=!0}}}for(c=P.length,l=0;l<c;++l){var U=P[l];if(!U.clustered){U.clustered=!0,_=U.collection,v=U.index;var V=_.get(v);d=ae(V,U.coord,y,j,ce);var z=Y.clone(d,de);p=(h=D.range(d.x,d.y,d.x+d.width,d.y+d.height)).length;var q=Q.clone(V.position);for(g=1,m=[V.id],u=0;u<p;++u)if(!(f=P[h[u]]).clustered){var G=f.collection.get(f.index),W=ae(G,f.coord,y,j,he);Q.add(G.position,q,q),Y.union(z,W,z),++g,m.push(G.id)}if(b<=g){var H=Q.multiplyByScalar(q,1/g,q);for(le(H,g,m,j),w.push({position:H,width:z.width,height:z.height,minimumWidth:d.width,minimumHeight:d.height}),u=0;u<p;++u)P[h[u]].clustered=!0}else se(V,j)}}0===o.length&&(o.destroy(),j._clusterLabelCollection=void 0),0===a.length&&(a.destroy(),j._clusterBillboardCollection=void 0),0===s.length&&(s.destroy(),j._clusterPointCollection=void 0),j._previousClusters=w,j._previousHeight=T}}});this._cluster=t,this._removeEventListener=e.camera.changed.addEventListener(t)},e(i.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this._enabledDirty=e!==this._enabled,this._enabled=e}},pixelRange:{get:function(){return this._pixelRange},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._pixelRange,this._pixelRange=e}},minimumClusterSize:{get:function(){return this._minimumClusterSize},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._minimumClusterSize,this._minimumClusterSize=e}},clusterEvent:{get:function(){return this._clusterEvent}},clusterBillboards:{get:function(){return this._clusterBillboards},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterBillboards,this._clusterBillboards=e}},clusterLabels:{get:function(){return this._clusterLabels},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterLabels,this._clusterLabels=e}},clusterPoints:{get:function(){return this._clusterPoints},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterPoints,this._clusterPoints=e}}}),i.prototype.getLabel=n("_labelCollection",te,"_unusedLabelIndices","labelIndex"),i.prototype.removeLabel=function(e){var t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(Z(this._labelCollection)&&Z(t)&&Z(t.labelIndex)){var r=t.labelIndex;t.labelIndex=void 0,o(this,e.id);var i=this._labelCollection.get(r);i.show=!1,i.text="",i.id=void 0,this._unusedLabelIndices.push(r),this._clusterDirty=!0}},i.prototype.getBillboard=n("_billboardCollection",ee,"_unusedBillboardIndices","billboardIndex"),i.prototype.removeBillboard=function(e){var t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(Z(this._billboardCollection)&&Z(t)&&Z(t.billboardIndex)){var r=t.billboardIndex;t.billboardIndex=void 0,o(this,e.id);var i=this._billboardCollection.get(r);i.id=void 0,i.show=!1,i.image=void 0,this._unusedBillboardIndices.push(r),this._clusterDirty=!0}},i.prototype.getPoint=n("_pointCollection",re,"_unusedPointIndices","pointIndex"),i.prototype.removePoint=function(e){var t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(Z(this._pointCollection)&&Z(t)&&Z(t.pointIndex)){var r=t.pointIndex;t.pointIndex=void 0,o(this,e.id);var i=this._pointCollection.get(r);i.show=!1,i.id=void 0,this._unusedPointIndices.push(r),this._clusterDirty=!0}},i.prototype.update=function(e){var t,r;Z(this._labelCollection)&&0<this._labelCollection.length&&0===this._labelCollection.get(0)._glyphs.length&&(t=e.commandList,e.commandList=[],this._labelCollection.update(e),e.commandList=t),Z(this._billboardCollection)&&0<this._billboardCollection.length&&!Z(this._billboardCollection.get(0).width)&&(t=e.commandList,e.commandList=[],this._billboardCollection.update(e),e.commandList=t),this._enabledDirty&&(this._enabledDirty=!1,(r=this).enabled||(Z(r._clusterLabelCollection)&&r._clusterLabelCollection.destroy(),Z(r._clusterBillboardCollection)&&r._clusterBillboardCollection.destroy(),Z(r._clusterPointCollection)&&r._clusterPointCollection.destroy(),r._clusterLabelCollection=void 0,r._clusterBillboardCollection=void 0,r._clusterPointCollection=void 0,a(r._labelCollection),a(r._billboardCollection),a(r._pointCollection)),this._clusterDirty=!0),this._clusterDirty&&(this._clusterDirty=!1,this._cluster()),Z(this._clusterLabelCollection)&&this._clusterLabelCollection.update(e),Z(this._clusterBillboardCollection)&&this._clusterBillboardCollection.update(e),Z(this._clusterPointCollection)&&this._clusterPointCollection.update(e),Z(this._labelCollection)&&this._labelCollection.update(e),Z(this._billboardCollection)&&this._billboardCollection.update(e),Z(this._pointCollection)&&this._pointCollection.update(e)},i.prototype.destroy=function(){this._labelCollection=this._labelCollection&&this._labelCollection.destroy(),this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),this._pointCollection=this._pointCollection&&this._pointCollection.destroy(),this._clusterLabelCollection=this._clusterLabelCollection&&this._clusterLabelCollection.destroy(),this._clusterBillboardCollection=this._clusterBillboardCollection&&this._clusterBillboardCollection.destroy(),this._clusterPointCollection=this._clusterPointCollection&&this._clusterPointCollection.destroy(),Z(this._removeEventListener)&&(this._removeEventListener(),this._removeEventListener=void 0),this._labelCollection=void 0,this._billboardCollection=void 0,this._pointCollection=void 0,this._clusterBillboardCollection=void 0,this._clusterLabelCollection=void 0,this._clusterPointCollection=void 0,this._collectionIndicesByEntity=void 0,this._unusedLabelIndices=[],this._unusedBillboardIndices=[],this._unusedPointIndices=[],this._previousClusters=[],this._previousHeight=void 0,this._enabledDirty=!1,this._pixelRangeDirty=!1,this._minimumClusterSizeDirty=!1},i}),define("DataSources/CustomDataSource",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./DataSource","./EntityCluster","./EntityCollection"],function(t,e,r,i,n,o,a){"use strict";function s(e){this._name=e,this._clock=void 0,this._changed=new i,this._error=new i,this._isLoading=!1,this._loading=new i,this._entityCollection=new a(this),this._entityCluster=new o}return e(s.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{get:function(){return this._clock},set:function(e){this._clock!==e&&(this._clock=e,this._changed.raiseEvent(this))}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading},set:function(e){n.setLoading(this,e)}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!t(e))throw new r("value must be defined.");this._entityCluster=e}}}),s}),define("DataSources/CylinderGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/CylinderGeometry","../Core/CylinderOutlineGeometry","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/ShowGeometryInstanceAttribute","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(v,y,b,C,w,S,e,t,T,r,E,i,A,x,l,P,D,O,n,I,o,a,M,R){"use strict";var L=new I(v.WHITE),N=new o(!0),k=new o(!0),F=new o(!1),B=new o(v.BLACK),U=new o(n.DISABLED),V=new o(new r),z=new v;function s(e){this.id=e,this.vertexFormat=void 0,this.length=void 0,this.topRadius=void 0,this.bottomRadius=void 0,this.slices=void 0,this.numberOfVerticalLines=void 0}function u(e,t){if(!S(e))throw new T("entity is required");if(!S(t))throw new T("scene is required");this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(u.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new i,this._showProperty=void 0,this._materialProperty=void 0,this._hasConstantOutline=!0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._options=new s(e),this._onEntityPropertyChanged(e,"cylinder",e.cylinder,void 0)}function c(e,t){this._primitives=e,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=t,this._options=new s(t._entity)}return e(u,{perInstanceColorAppearanceType:{value:D},materialAppearanceType:{value:P}}),e(u.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!S(this._entity.availability)&&R.isConstant(this._showProperty)&&R.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!S(this._entity.availability)&&R.isConstant(this._showProperty)&&R.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:!0},geometryChanged:{get:function(){return this._geometryChanged}}}),u.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)},u.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)},u.prototype.createFillGeometryInstance=function(e){if(!S(e))throw new T("time is required.");if(!this._fillEnabled)throw new T("This instance does not represent a filled geometry.");var t,r=this._entity,i=r.isAvailable(e),n=new l(i&&r.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),a=E.fromDistanceDisplayCondition(o);if(this._materialProperty instanceof I){var s=v.WHITE;S(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(s=this._materialProperty.color.getValue(e)),t={show:n,distanceDisplayCondition:a,color:y.fromColor(s)}}else t={show:n,distanceDisplayCondition:a};return new A({id:r,geometry:new b(this._options),modelMatrix:r.computeModelMatrix(x.MINIMUM_VALUE),attributes:t})},u.prototype.createOutlineGeometryInstance=function(e){if(!S(e))throw new T("time is required.");if(!this._outlineEnabled)throw new T("This instance does not represent an outlined geometry.");var t=this._entity,r=t.isAvailable(e),i=R.getValueOrDefault(this._outlineColorProperty,e,v.BLACK),n=this._distanceDisplayConditionProperty.getValue(e);return new A({id:t,geometry:new C(this._options),modelMatrix:t.computeModelMatrix(x.MINIMUM_VALUE),attributes:{show:new l(r&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:y.fromColor(i),distanceDisplayCondition:E.fromDistanceDisplayCondition(n)}})},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){this._entitySubscription(),t(this)},u.prototype._onEntityPropertyChanged=function(e,t,r,i){if("availability"===t||"position"===t||"orientation"===t||"cylinder"===t){var n=e.cylinder;if(S(n)){var o=n.fill,a=!S(o)||!o.isConstant||o.getValue(x.MINIMUM_VALUE),s=n.outline,l=S(s);if(l&&s.isConstant&&(l=s.getValue(x.MINIMUM_VALUE)),a||l){var u=e.position,c=n.length,d=n.topRadius,h=n.bottomRadius,p=n.show;if((!S(p)||!p.isConstant||p.getValue(x.MINIMUM_VALUE))&&S(u)&&S(c)&&S(d)&&S(h)){var f=w(n.material,L),m=f instanceof I;this._materialProperty=f,this._fillProperty=w(o,k),this._showProperty=w(p,N),this._showOutlineProperty=w(n.outline,F),this._outlineColorProperty=l?w(n.outlineColor,B):void 0,this._shadowsProperty=w(n.shadows,U),this._distanceDisplayConditionProperty=w(n.distanceDisplayCondition,V);var g=n.slices,_=n.outlineWidth,v=n.numberOfVerticalLines;if(this._fillEnabled=a,this._outlineEnabled=l,u.isConstant&&R.isConstant(e.orientation)&&c.isConstant&&d.isConstant&&h.isConstant&&R.isConstant(g)&&R.isConstant(_)&&R.isConstant(v)){var y=this._options;y.vertexFormat=m?D.VERTEX_FORMAT:P.MaterialSupport.TEXTURED.vertexFormat,y.length=c.getValue(x.MINIMUM_VALUE),y.topRadius=d.getValue(x.MINIMUM_VALUE),y.bottomRadius=h.getValue(x.MINIMUM_VALUE),y.slices=S(g)?g.getValue(x.MINIMUM_VALUE):void 0,y.numberOfVerticalLines=S(v)?v.getValue(x.MINIMUM_VALUE):void 0,this._outlineWidth=S(_)?_.getValue(x.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}},u.prototype.createDynamicUpdater=function(e){if(!this._dynamic)throw new T("This instance does not represent dynamic geometry.");if(!S(e))throw new T("primitives is required.");return new c(e,this)},c.prototype.update=function(e){if(!S(e))throw new T("time is required.");var t=this._primitives;t.removeAndDestroy(this._primitive),t.removeAndDestroy(this._outlinePrimitive),this._primitive=void 0,this._outlinePrimitive=void 0;var r=this._geometryUpdater,i=r._entity,n=i.cylinder;if(i.isShowing&&i.isAvailable(e)&&R.getValueOrDefault(n.show,e,!0)){var o=this._options,a=i.computeModelMatrix(e),s=R.getValueOrUndefined(n.length,e),l=R.getValueOrUndefined(n.topRadius,e),u=R.getValueOrUndefined(n.bottomRadius,e);if(S(a)&&S(s)&&S(l)&&S(u)){o.length=s,o.topRadius=l,o.bottomRadius=u,o.slices=R.getValueOrUndefined(n.slices,e),o.numberOfVerticalLines=R.getValueOrUndefined(n.numberOfVerticalLines,e);var c=this._geometryUpdater.shadowsProperty.getValue(e),d=this._geometryUpdater.distanceDisplayConditionProperty.getValue(e),h=E.fromDistanceDisplayCondition(d);if(R.getValueOrDefault(n.fill,e,!0)){var p=M.getValue(e,r.fillMaterialProperty,this._material);this._material=p;var f=new P({material:p,translucent:p.isTranslucent(),closed:!0});o.vertexFormat=f.vertexFormat,this._primitive=t.add(new O({geometryInstances:new A({id:i,geometry:new b(o),modelMatrix:a,attributes:{distanceDisplayCondition:h}}),appearance:f,asynchronous:!1,shadows:c}))}if(R.getValueOrDefault(n.outline,e,!1)){o.vertexFormat=D.VERTEX_FORMAT;var m=R.getValueOrClonedDefault(n.outlineColor,e,v.BLACK,z),g=R.getValueOrDefault(n.outlineWidth,e,1),_=1!==m.alpha;this._outlinePrimitive=t.add(new O({geometryInstances:new A({id:i,geometry:new C(o),modelMatrix:a,attributes:{color:y.fromColor(m),distanceDisplayCondition:h}}),appearance:new D({flat:!0,translucent:_,renderState:{lineWidth:r._scene.clampLineWidth(g)}}),asynchronous:!1,shadows:c}))}}}},c.prototype.getBoundingSphere=function(e,t){return a(e,this._primitive,this._outlinePrimitive,t)},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),t(this)},u}),define("Scene/ColorBlendMode",["../Core/freezeObject","../Core/Math"],function(e,r){"use strict";var i={HIGHLIGHT:0,REPLACE:1,MIX:2,getColorBlend:function(e,t){return e===i.HIGHLIGHT?0:e===i.REPLACE?1:e===i.MIX?r.clamp(t,r.EPSILON4,1):void 0}};return e(i)}),define("DataSources/DataSourceClock",["../Core/Clock","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/JulianDate","./createRawPropertyDescriptor"],function(t,r,i,e,n,o,a,s){"use strict";function l(){this._startTime=void 0,this._stopTime=void 0,this._currentTime=void 0,this._clockRange=void 0,this._clockStep=void 0,this._multiplier=void 0,this._definitionChanged=new o}return e(l.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},startTime:s("startTime"),stopTime:s("stopTime"),currentTime:s("currentTime"),clockRange:s("clockRange"),clockStep:s("clockStep"),multiplier:s("multiplier")}),l.prototype.clone=function(e){return i(e)||(e=new l),e.startTime=this.startTime,e.stopTime=this.stopTime,e.currentTime=this.currentTime,e.clockRange=this.clockRange,e.clockStep=this.clockStep,e.multiplier=this.multiplier,e},l.prototype.equals=function(e){return this===e||i(e)&&a.equals(this.startTime,e.startTime)&&a.equals(this.stopTime,e.stopTime)&&a.equals(this.currentTime,e.currentTime)&&this.clockRange===e.clockRange&&this.clockStep===e.clockStep&&this.multiplier===e.multiplier},l.prototype.merge=function(e){if(!i(e))throw new n("source is required.");this.startTime=r(this.startTime,e.startTime),this.stopTime=r(this.stopTime,e.stopTime),this.currentTime=r(this.currentTime,e.currentTime),this.clockRange=r(this.clockRange,e.clockRange),this.clockStep=r(this.clockStep,e.clockStep),this.multiplier=r(this.multiplier,e.multiplier)},l.prototype.getValue=function(e){return i(e)||(e=new t),e.startTime=r(this.startTime,e.startTime),e.stopTime=r(this.stopTime,e.stopTime),e.currentTime=r(this.currentTime,e.currentTime),e.clockRange=r(this.clockRange,e.clockRange),e.multiplier=r(this.multiplier,e.multiplier),e.clockStep=r(this.clockStep,e.clockStep),e},l}),define("DataSources/GridMaterialProperty",["../Core/Cartesian2","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,o,a,s){"use strict";var l=t.WHITE,u=new e(8,8),c=new e(0,0),d=new e(1,1);function h(e){e=r(e,r.EMPTY_OBJECT),this._definitionChanged=new o,this._color=void 0,this._colorSubscription=void 0,this._cellAlpha=void 0,this._cellAlphaSubscription=void 0,this._lineCount=void 0,this._lineCountSubscription=void 0,this._lineThickness=void 0,this._lineThicknessSubscription=void 0,this._lineOffset=void 0,this._lineOffsetSubscription=void 0,this.color=e.color,this.cellAlpha=e.cellAlpha,this.lineCount=e.lineCount,this.lineThickness=e.lineThickness,this.lineOffset=e.lineOffset}return n(h.prototype,{isConstant:{get:function(){return s.isConstant(this._color)&&s.isConstant(this._cellAlpha)&&s.isConstant(this._lineCount)&&s.isConstant(this._lineThickness)&&s.isConstant(this._lineOffset)}},definitionChanged:{get:function(){return this._definitionChanged}},color:a("color"),cellAlpha:a("cellAlpha"),lineCount:a("lineCount"),lineThickness:a("lineThickness"),lineOffset:a("lineOffset")}),h.prototype.getType=function(e){return"Grid"},h.prototype.getValue=function(e,t){return i(t)||(t={}),t.color=s.getValueOrClonedDefault(this._color,e,l,t.color),t.cellAlpha=s.getValueOrDefault(this._cellAlpha,e,.1),t.lineCount=s.getValueOrClonedDefault(this._lineCount,e,u,t.lineCount),t.lineThickness=s.getValueOrClonedDefault(this._lineThickness,e,d,t.lineThickness),t.lineOffset=s.getValueOrClonedDefault(this._lineOffset,e,c,t.lineOffset),t},h.prototype.equals=function(e){return this===e||e instanceof h&&s.equals(this._color,e._color)&&s.equals(this._cellAlpha,e._cellAlpha)&&s.equals(this._lineCount,e._lineCount)&&s.equals(this._lineThickness,e._lineThickness)&&s.equals(this._lineOffset,e._lineOffset)},h}),define("DataSources/PolylineArrowMaterialProperty",["../Core/Color","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(r,i,e,t,n,o){"use strict";function a(e){this._definitionChanged=new t,this._color=void 0,this._colorSubscription=void 0,this.color=e}return e(a.prototype,{isConstant:{get:function(){return o.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:n("color")}),a.prototype.getType=function(e){return"PolylineArrow"},a.prototype.getValue=function(e,t){return i(t)||(t={}),t.color=o.getValueOrClonedDefault(this._color,e,r.WHITE,t.color),t},a.prototype.equals=function(e){return this===e||e instanceof a&&o.equals(this._color,e._color)},a}),define("DataSources/PolylineDashMaterialProperty",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,o,a){"use strict";var s=e.WHITE,l=e.TRANSPARENT;function u(e){e=t(e,t.EMPTY_OBJECT),this._definitionChanged=new n,this._color=void 0,this._colorSubscription=void 0,this._gapColor=void 0,this._gapColorSubscription=void 0,this._dashLength=void 0,this._dashLengthSubscription=void 0,this._dashPattern=void 0,this._dashPatternSubscription=void 0,this.color=e.color,this.gapColor=e.gapColor,this.dashLength=e.dashLength,this.dashPattern=e.dashPattern}return i(u.prototype,{isConstant:{get:function(){return a.isConstant(this._color)&&a.isConstant(this._gapColor)&&a.isConstant(this._dashLength)&&a.isConstant(this._dashPattern)}},definitionChanged:{get:function(){return this._definitionChanged}},color:o("color"),gapColor:o("gapColor"),dashLength:o("dashLength"),dashPattern:o("dashPattern")}),u.prototype.getType=function(e){return"PolylineDash"},u.prototype.getValue=function(e,t){return r(t)||(t={}),t.color=a.getValueOrClonedDefault(this._color,e,s,t.color),t.gapColor=a.getValueOrClonedDefault(this._gapColor,e,l,t.gapColor),t.dashLength=a.getValueOrDefault(this._dashLength,e,16,t.dashLength),t.dashPattern=a.getValueOrDefault(this._dashPattern,e,255,t.dashPattern),t},u.prototype.equals=function(e){return this===e||e instanceof u&&a.equals(this._color,e._color)&&a.equals(this._gapColor,e._gapColor)&&a.equals(this._dashLength,e._dashLength)&&a.equals(this._dashPattern,e._dashPattern)},u}),define("DataSources/PolylineGlowMaterialProperty",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,o,a){"use strict";var s=e.WHITE;function l(e){e=t(e,t.EMPTY_OBJECT),this._definitionChanged=new n,this._color=void 0,this._colorSubscription=void 0,this._glowPower=void 0,this._glowPowerSubscription=void 0,this.color=e.color,this.glowPower=e.glowPower}return i(l.prototype,{isConstant:{get:function(){return a.isConstant(this._color)&&a.isConstant(this._glow)}},definitionChanged:{get:function(){return this._definitionChanged}},color:o("color"),glowPower:o("glowPower")}),l.prototype.getType=function(e){return"PolylineGlow"},l.prototype.getValue=function(e,t){return r(t)||(t={}),t.color=a.getValueOrClonedDefault(this._color,e,s,t.color),t.glowPower=a.getValueOrDefault(this._glowPower,e,.25,t.glowPower),t},l.prototype.equals=function(e){return this===e||e instanceof l&&a.equals(this._color,e._color)&&a.equals(this._glowPower,e._glowPower)},l}),define("DataSources/PolylineOutlineMaterialProperty",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,o,a){"use strict";var s=e.WHITE,l=e.BLACK;function u(e){e=t(e,t.EMPTY_OBJECT),this._definitionChanged=new n,this._color=void 0,this._colorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this.color=e.color,this.outlineColor=e.outlineColor,this.outlineWidth=e.outlineWidth}return i(u.prototype,{isConstant:{get:function(){return a.isConstant(this._color)&&a.isConstant(this._outlineColor)&&a.isConstant(this._outlineWidth)}},definitionChanged:{get:function(){return this._definitionChanged}},color:o("color"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth")}),u.prototype.getType=function(e){return"PolylineOutline"},u.prototype.getValue=function(e,t){return r(t)||(t={}),t.color=a.getValueOrClonedDefault(this._color,e,s,t.color),t.outlineColor=a.getValueOrClonedDefault(this._outlineColor,e,l,t.outlineColor),t.outlineWidth=a.getValueOrDefault(this._outlineWidth,e,1),t},u.prototype.equals=function(e){return this===e||e instanceof u&&a.equals(this._color,e._color)&&a.equals(this._outlineColor,e._outlineColor)&&a.equals(this._outlineWidth,e._outlineWidth)},u}),define("DataSources/PositionPropertyArray",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/EventHelper","../Core/ReferenceFrame","./Property"],function(r,l,e,u,i,n,o,a){"use strict";function s(e,t){this._value=void 0,this._definitionChanged=new i,this._eventHelper=new n,this._referenceFrame=r(t,o.FIXED),this.setValue(e)}return e(s.prototype,{isConstant:{get:function(){var e=this._value;if(!l(e))return!0;for(var t=e.length,r=0;r<t;r++)if(!a.isConstant(e[r]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}}),s.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,o.FIXED,t)},s.prototype.getValueInReferenceFrame=function(e,t,r){if(!l(e))throw new u("time is required.");if(!l(t))throw new u("referenceFrame is required.");var i=this._value;if(l(i)){var n=i.length;l(r)||(r=new Array(n));for(var o=0,a=0;o<n;){var s=i[o].getValueInReferenceFrame(e,t,r[o]);l(s)&&(r[a]=s,a++),o++}return r.length=a,r}},s.prototype.setValue=function(e){var t=this._eventHelper;if(t.removeAll(),l(e)){this._value=e.slice();for(var r=e.length,i=0;i<r;i++){var n=e[i];l(n)&&t.add(n.definitionChanged,s.prototype._raiseDefinitionChanged,this)}}else this._value=void 0;this._definitionChanged.raiseEvent(this)},s.prototype.equals=function(e){return this===e||e instanceof s&&this._referenceFrame===e._referenceFrame&&a.arrayEquals(this._value,e._value)},s.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)},s}),define("DataSources/PropertyArray",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/EventHelper","./Property"],function(s,e,l,t,r,i){"use strict";function o(e){this._value=void 0,this._definitionChanged=new t,this._eventHelper=new r,this.setValue(e)}return e(o.prototype,{isConstant:{get:function(){var e=this._value;if(!s(e))return!0;for(var t=e.length,r=0;r<t;r++)if(!i.isConstant(e[r]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}}}),o.prototype.getValue=function(e,t){if(!s(e))throw new l("time is required.");var r=this._value;if(s(r)){var i=r.length;s(t)||(t=new Array(i));for(var n=0,o=0;n<i;){var a=this._value[n].getValue(e,t[n]);s(a)&&(t[o]=a,o++),n++}return t.length=o,t}},o.prototype.setValue=function(e){var t=this._eventHelper;if(t.removeAll(),s(e)){this._value=e.slice();for(var r=e.length,i=0;i<r;i++){var n=e[i];s(n)&&t.add(n.definitionChanged,o.prototype._raiseDefinitionChanged,this)}}else this._value=void 0;this._definitionChanged.raiseEvent(this)},o.prototype.equals=function(e){return this===e||e instanceof o&&i.arrayEquals(this._value,e._value)},o.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)},o}),define("DataSources/ReferenceProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/RuntimeError","./Property"],function(u,e,c,o,a,t){"use strict";function n(e){var t=e._targetProperty;if(e._resolveProperty){var r=function(e){var t=!0;if(e._resolveEntity){var r=e._targetCollection.getById(e._targetId);if(u(r)?(r.definitionChanged.addEventListener(d.prototype._onTargetEntityDefinitionChanged,e),e._targetEntity=r,e._resolveEntity=!1):(r=e._targetEntity,t=!1),!u(r))throw new a('target entity "'+e._targetId+'" could not be resolved.')}return t}(e),i=e._targetPropertyNames;t=e._targetEntity;for(var n=i.length,o=0;o<n&&u(t);o++)t=t[i[o]];if(u(t))e._targetProperty=t,e._resolveProperty=!r;else if(!u(e._targetProperty))throw new a('targetProperty "'+e._targetId+"."+i.join(".")+'" could not be resolved.')}return t}function d(e,t,r){if(!u(e))throw new c("targetCollection is required.");if(!u(t)||""===t)throw new c("targetId is required.");if(!u(r)||0===r.length)throw new c("targetPropertyNames is required.");for(var i=0;i<r.length;i++){var n=r[i];if(!u(n)||""===n)throw new c("reference contains invalid properties.")}this._targetCollection=e,this._targetId=t,this._targetPropertyNames=r,this._targetProperty=void 0,this._targetEntity=void 0,this._definitionChanged=new o,this._resolveEntity=!0,this._resolveProperty=!0,e.collectionChanged.addEventListener(d.prototype._onCollectionChanged,this)}return e(d.prototype,{isConstant:{get:function(){return t.isConstant(n(this))}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return n(this).referenceFrame}},targetId:{get:function(){return this._targetId}},targetCollection:{get:function(){return this._targetCollection}},targetPropertyNames:{get:function(){return this._targetPropertyNames}},resolvedProperty:{get:function(){return n(this)}}}),d.fromString=function(e,t){if(!u(e))throw new c("targetCollection is required.");if(!u(t))throw new c("referenceString is required.");for(var r,i=[],n=!0,o=!1,a="",s=0;s<t.length;++s){var l=t.charAt(s);o?(a+=l,o=!1):"\\"===l?o=!0:n&&"#"===l?(r=a,n=!1,a=""):n||"."!==l?a+=l:(i.push(a),a="")}return i.push(a),new d(e,r,i)},d.prototype.getValue=function(e,t){return n(this).getValue(e,t)},d.prototype.getValueInReferenceFrame=function(e,t,r){return n(this).getValueInReferenceFrame(e,t,r)},d.prototype.getType=function(e){return n(this).getType(e)},d.prototype.equals=function(e){if(this===e)return!0;var t=this._targetPropertyNames,r=e._targetPropertyNames;if(this._targetCollection!==e._targetCollection||this._targetId!==e._targetId||t.length!==r.length)return!1;for(var i=this._targetPropertyNames.length,n=0;n<i;n++)if(t[n]!==r[n])return!1;return!0},d.prototype._onTargetEntityDefinitionChanged=function(e,t,r,i){this._targetPropertyNames[0]===t&&(this._resolveProperty=!0,this._definitionChanged.raiseEvent(this))},d.prototype._onCollectionChanged=function(e,t,r){var i=this._targetEntity;u(i)&&(-1!==r.indexOf(i)?(i.definitionChanged.removeEventListener(d.prototype._onTargetEntityDefinitionChanged,this),this._resolveEntity=!0,this._resolveProperty=!0):this._resolveEntity&&(n(this),this._resolveEntity||this._definitionChanged.raiseEvent(this)))},d}),define("DataSources/Rotation",["../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/Math"],function(l,u,c,d){"use strict";return{packedLength:1,pack:function(e,t,r){if(!u(e))throw new c("value is required");if(!u(t))throw new c("array is required");return t[r=l(r,0)]=e,t},unpack:function(e,t,r){if(!u(e))throw new c("array is required");return e[t=l(t,0)]},convertPackedArrayForInterpolation:function(e,t,r,i){if(!u(e))throw new c("packedArray is required");var n;t=l(t,0);for(var o=0,a=(r=l(r,e.length))-t+1;o<a;o++){var s=e[t+o];0===o||Math.abs(n-s)<Math.PI?i[o]=s:i[o]=s-d.TWO_PI,n=s}},unpackInterpolationResult:function(e,t,r,i,n){if(!u(e))throw new c("array is required");if(!u(t))throw new c("sourceArray is required");return(n=e[0])<0?n+d.TWO_PI:n}}}),define("DataSources/SampledProperty",["../Core/binarySearch","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/ExtrapolationType","../Core/JulianDate","../Core/LinearApproximation"],function(O,d,I,e,M,h,R,L,p){"use strict";var f={packedLength:1,pack:function(e,t,r){t[r=d(r,0)]=e},unpack:function(e,t,r){return e[t=d(t,0)]}};function m(e,t,r){var i,n=e.length,o=r.length,a=n+o;if(e.length=a,n!==t){var s=n-1;for(i=a-1;t<=i;i--)e[i]=e[s--]}for(i=0;i<o;i++)e[t++]=r[i]}function g(e,t){return e instanceof L?e:"string"==typeof e?L.fromIso8601(e):L.addSeconds(t,e,new L)}var _=[],v=[];function y(e,t,r,i,n){for(var o,a,s,l,u,c,d=0;d<i.length;){u=g(i[d],e);var h=0,p=0;if((s=O(t,u,L.compare))<0){for(l=(s=~s)*n,a=void 0,c=t[s];d<i.length&&(u=g(i[d],e),!(I(a)&&0<=L.compare(a,u)||I(c)&&0<=L.compare(u,c)));){for(_[h++]=u,d+=1,o=0;o<n;o++)v[p++]=i[d],d+=1;a=u}0<h&&(v.length=p,m(r,l,v),_.length=h,m(t,s,_))}else{for(o=0;o<n;o++)d++,r[s*n+o]=i[d];d++}}}function t(e,t){if(!I(e))throw new M("type is required.");var r=e;r===Number&&(r=f);var i,n=r.packedLength,o=d(r.packedInterpolationLength,n),a=0;if(I(t)){var s=t.length;i=new Array(s);for(var l=0;l<s;l++){var u=t[l];u===Number&&(u=f);var c=u.packedLength;n+=c,o+=d(u.packedInterpolationLength,c),i[l]=u}a=s}this._type=e,this._innerType=r,this._interpolationDegree=1,this._interpolationAlgorithm=p,this._numberOfPoints=0,this._times=[],this._values=[],this._xTable=[],this._yTable=[],this._packedLength=n,this._packedInterpolationLength=o,this._updateTableLength=!0,this._interpolationResult=new Array(o),this._definitionChanged=new h,this._derivativeTypes=t,this._innerDerivativeTypes=i,this._inputOrder=a,this._forwardExtrapolationType=R.NONE,this._forwardExtrapolationDuration=0,this._backwardExtrapolationType=R.NONE,this._backwardExtrapolationDuration=0}return e(t.prototype,{isConstant:{get:function(){return 0===this._values.length}},definitionChanged:{get:function(){return this._definitionChanged}},type:{get:function(){return this._type}},derivativeTypes:{get:function(){return this._derivativeTypes}},interpolationDegree:{get:function(){return this._interpolationDegree}},interpolationAlgorithm:{get:function(){return this._interpolationAlgorithm}},forwardExtrapolationType:{get:function(){return this._forwardExtrapolationType},set:function(e){this._forwardExtrapolationType!==e&&(this._forwardExtrapolationType=e,this._definitionChanged.raiseEvent(this))}},forwardExtrapolationDuration:{get:function(){return this._forwardExtrapolationDuration},set:function(e){this._forwardExtrapolationDuration!==e&&(this._forwardExtrapolationDuration=e,this._definitionChanged.raiseEvent(this))}},backwardExtrapolationType:{get:function(){return this._backwardExtrapolationType},set:function(e){this._backwardExtrapolationType!==e&&(this._backwardExtrapolationType=e,this._definitionChanged.raiseEvent(this))}},backwardExtrapolationDuration:{get:function(){return this._backwardExtrapolationDuration},set:function(e){this._backwardExtrapolationDuration!==e&&(this._backwardExtrapolationDuration=e,this._definitionChanged.raiseEvent(this))}}}),t.prototype.getValue=function(e,t){if(!I(e))throw new M("time is required.");var r=this._times,i=r.length;if(0!==i){var n,o=this._innerType,a=this._values,s=O(r,e,L.compare);if(s<0){if(0===(s=~s)){var l=r[s];if(n=this._backwardExtrapolationDuration,this._backwardExtrapolationType===R.NONE||0!==n&&L.secondsDifference(l,e)>n)return;if(this._backwardExtrapolationType===R.HOLD)return o.unpack(a,0,t)}if(i<=s){var u=r[s=i-1];if(n=this._forwardExtrapolationDuration,this._forwardExtrapolationType===R.NONE||0!==n&&L.secondsDifference(e,u)>n)return;if(this._forwardExtrapolationType===R.HOLD)return s=i-1,o.unpack(a,s*o.packedLength,t)}var c=this._xTable,d=this._yTable,h=this._interpolationAlgorithm,p=this._packedInterpolationLength,f=this._inputOrder;if(this._updateTableLength){this._updateTableLength=!1;var m=Math.min(h.getRequiredDataPoints(this._interpolationDegree,f),i);m!==this._numberOfPoints&&(this._numberOfPoints=m,c.length=m,d.length=m*p)}var g=this._numberOfPoints-1;if(g<1)return;var _=0,v=i-1;if(g+1<=v-_+1){var y=s-(g/2|0)-1;y<_&&(y=_);var b=y+g;v<b&&(y=(b=v)-g)<_&&(y=_),_=y,v=b}for(var C=v-_+1,w=0;w<C;++w)c[w]=L.secondsDifference(r[_+w],r[v]);if(I(o.convertPackedArrayForInterpolation))o.convertPackedArrayForInterpolation(a,_,v,d);else for(var S=0,T=this._packedLength,E=_*T,A=(v+1)*T;E<A;)d[S]=a[E],E++,S++;var x,P=L.secondsDifference(e,r[v]);if(0!==f&&I(h.interpolate)){var D=Math.floor(p/(f+1));x=h.interpolate(P,c,d,D,f,f,this._interpolationResult)}else x=h.interpolateOrderZero(P,c,d,p,this._interpolationResult);return I(o.unpackInterpolationResult)?o.unpackInterpolationResult(x,a,_,v,t):o.unpack(x,0,t)}return o.unpack(a,s*this._packedLength,t)}},t.prototype.setInterpolationOptions=function(e){if(I(e)){var t=!1,r=e.interpolationAlgorithm,i=e.interpolationDegree;I(r)&&this._interpolationAlgorithm!==r&&(this._interpolationAlgorithm=r,t=!0),I(i)&&this._interpolationDegree!==i&&(this._interpolationDegree=i,t=!0),t&&(this._updateTableLength=!0,this._definitionChanged.raiseEvent(this))}},t.prototype.addSample=function(e,t,r){var i=this._innerDerivativeTypes,n=I(i);if(!I(e))throw new M("time is required.");if(!I(t))throw new M("value is required.");if(n&&!I(r))throw new M("derivatives is required.");var o=this._innerType,a=[];if(a.push(e),o.pack(t,a,a.length),n)for(var s=i.length,l=0;l<s;l++)i[l].pack(r[l],a,a.length);y(void 0,this._times,this._values,a,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)},t.prototype.addSamples=function(e,t,r){var i=this._innerDerivativeTypes,n=I(i);if(!I(e))throw new M("times is required.");if(!I(t))throw new M("values is required.");if(e.length!==t.length)throw new M("times and values must be the same length.");if(n&&(!I(r)||r.length!==e.length))throw new M("times and derivativeValues must be the same length.");for(var o=this._innerType,a=e.length,s=[],l=0;l<a;l++)if(s.push(e[l]),o.pack(t[l],s,s.length),n)for(var u=r[l],c=i.length,d=0;d<c;d++)i[d].pack(u[d],s,s.length);y(void 0,this._times,this._values,s,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)},t.prototype.addSamplesPackedArray=function(e,t){if(!I(e))throw new M("packedSamples is required.");y(t,this._times,this._values,e,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)},t.prototype.equals=function(e){if(this===e)return!0;if(!I(e))return!1;if(this._type!==e._type||this._interpolationDegree!==e._interpolationDegree||this._interpolationAlgorithm!==e._interpolationAlgorithm)return!1;var t,r,i=this._derivativeTypes,n=I(i),o=e._derivativeTypes;if(n!==I(o))return!1;if(n){if((r=i.length)!==o.length)return!1;for(t=0;t<r;t++)if(i[t]!==o[t])return!1}var a=this._times,s=e._times;if((r=a.length)!==s.length)return!1;for(t=0;t<r;t++)if(!L.equals(a[t],s[t]))return!1;var l=this._values,u=e._values;for(t=0;t<r;t++)if(l[t]!==u[t])return!1;return!0},t._mergeNewSamples=y,t}),define("DataSources/SampledPositionProperty",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/ReferenceFrame","./PositionProperty","./Property","./SampledProperty"],function(n,o,a,e,s,l,u,i,t,c){"use strict";function r(e,t){var r;if(0<(t=o(t,0))){r=new Array(t);for(var i=0;i<t;i++)r[i]=n}this._numberOfDerivatives=t,this._property=new c(n,r),this._definitionChanged=new l,this._referenceFrame=o(e,u.FIXED),this._property._definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this)},this)}return e(r.prototype,{isConstant:{get:function(){return this._property.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}},interpolationDegree:{get:function(){return this._property.interpolationDegree}},interpolationAlgorithm:{get:function(){return this._property.interpolationAlgorithm}},numberOfDerivatives:{get:function(){return this._numberOfDerivatives}},forwardExtrapolationType:{get:function(){return this._property.forwardExtrapolationType},set:function(e){this._property.forwardExtrapolationType=e}},forwardExtrapolationDuration:{get:function(){return this._property.forwardExtrapolationDuration},set:function(e){this._property.forwardExtrapolationDuration=e}},backwardExtrapolationType:{get:function(){return this._property.backwardExtrapolationType},set:function(e){this._property.backwardExtrapolationType=e}},backwardExtrapolationDuration:{get:function(){return this._property.backwardExtrapolationDuration},set:function(e){this._property.backwardExtrapolationDuration=e}}}),r.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,u.FIXED,t)},r.prototype.getValueInReferenceFrame=function(e,t,r){if(!a(e))throw new s("time is required.");if(!a(t))throw new s("referenceFrame is required.");if(r=this._property.getValue(e,r),a(r))return i.convertToReferenceFrame(e,r,this._referenceFrame,t,r)},r.prototype.setInterpolationOptions=function(e){this._property.setInterpolationOptions(e)},r.prototype.addSample=function(e,t,r){var i=this._numberOfDerivatives;if(0<i&&(!a(r)||r.length!==i))throw new s("derivatives length must be equal to the number of derivatives.");this._property.addSample(e,t,r)},r.prototype.addSamples=function(e,t,r){this._property.addSamples(e,t,r)},r.prototype.addSamplesPackedArray=function(e,t){this._property.addSamplesPackedArray(e,t)},r.prototype.equals=function(e){return this===e||e instanceof r&&t.equals(this._property,e._property)&&this._referenceFrame===e._referenceFrame},r}),define("DataSources/StripeOrientation",["../Core/freezeObject"],function(e){"use strict";return e({HORIZONTAL:0,VERTICAL:1})}),define("DataSources/StripeMaterialProperty",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property","./StripeOrientation"],function(e,t,r,i,n,o,a,s){"use strict";var l=s.HORIZONTAL,u=e.WHITE,c=e.BLACK;function d(e){e=t(e,t.EMPTY_OBJECT),this._definitionChanged=new n,this._orientation=void 0,this._orientationSubscription=void 0,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._offset=void 0,this._offsetSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.orientation=e.orientation,this.evenColor=e.evenColor,this.oddColor=e.oddColor,this.offset=e.offset,this.repeat=e.repeat}return i(d.prototype,{isConstant:{get:function(){return a.isConstant(this._orientation)&&a.isConstant(this._evenColor)&&a.isConstant(this._oddColor)&&a.isConstant(this._offset)&&a.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},orientation:o("orientation"),evenColor:o("evenColor"),oddColor:o("oddColor"),offset:o("offset"),repeat:o("repeat")}),d.prototype.getType=function(e){return"Stripe"},d.prototype.getValue=function(e,t){return r(t)||(t={}),t.horizontal=a.getValueOrDefault(this._orientation,e,l)===s.HORIZONTAL,t.evenColor=a.getValueOrClonedDefault(this._evenColor,e,u,t.evenColor),t.oddColor=a.getValueOrClonedDefault(this._oddColor,e,c,t.oddColor),t.offset=a.getValueOrDefault(this._offset,e,0),t.repeat=a.getValueOrDefault(this._repeat,e,1),t},d.prototype.equals=function(e){return this===e||e instanceof d&&a.equals(this._orientation,e._orientation)&&a.equals(this._evenColor,e._evenColor)&&a.equals(this._oddColor,e._oddColor)&&a.equals(this._offset,e._offset)&&a.equals(this._repeat,e._repeat)},d}),define("DataSources/TimeIntervalCollectionPositionProperty",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/ReferenceFrame","../Core/TimeIntervalCollection","./PositionProperty","./Property"],function(t,n,e,o,r,i,a,s,l){"use strict";function u(e){this._definitionChanged=new r,this._intervals=new a,this._intervals.changedEvent.addEventListener(u.prototype._intervalsChanged,this),this._referenceFrame=t(e,i.FIXED)}return e(u.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}},referenceFrame:{get:function(){return this._referenceFrame}}}),u.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,i.FIXED,t)},u.prototype.getValueInReferenceFrame=function(e,t,r){if(!n(e))throw new o("time is required.");if(!n(t))throw new o("referenceFrame is required.");var i=this._intervals.findDataForIntervalContainingDate(e);if(n(i))return s.convertToReferenceFrame(e,i,this._referenceFrame,t,r)},u.prototype.equals=function(e){return this===e||e instanceof u&&this._intervals.equals(e._intervals,l.equals)&&this._referenceFrame===e._referenceFrame},u.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)},u}),define("DataSources/TimeIntervalCollectionProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/TimeIntervalCollection","./Property"],function(i,e,n,t,r,o){"use strict";function a(){this._definitionChanged=new t,this._intervals=new r,this._intervals.changedEvent.addEventListener(a.prototype._intervalsChanged,this)}return e(a.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}}),a.prototype.getValue=function(e,t){if(!i(e))throw new n("time is required");var r=this._intervals.findDataForIntervalContainingDate(e);return i(r)&&"function"==typeof r.clone?r.clone(t):r},a.prototype.equals=function(e){return this===e||e instanceof a&&this._intervals.equals(e._intervals,o.equals)},a.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)},a}),define("DataSources/VelocityVectorProperty",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/JulianDate","./Property"],function(s,r,l,e,u,i,c,d){"use strict";function t(e,t){this._position=void 0,this._subscription=void 0,this._definitionChanged=new i,this._normalize=r(t,!0),this.position=e}e(t.prototype,{isConstant:{get:function(){return d.isConstant(this._position)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._position},set:function(e){var t=this._position;t!==e&&(l(t)&&this._subscription(),this._position=e,l(e)&&(this._subscription=e._definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this)},this)),this._definitionChanged.raiseEvent(this))}},normalize:{get:function(){return this._normalize},set:function(e){this._normalize!==e&&(this._normalize=e,this._definitionChanged.raiseEvent(this))}}});var h=new s,p=new s,f=new c;return t.prototype.getValue=function(e,t){return this._getValue(e,t)},t.prototype._getValue=function(e,t,r){if(!l(e))throw new u("time is required");l(t)||(t=new s);var i=this._position;if(d.isConstant(i))return this._normalize?void 0:s.clone(s.ZERO,t);var n=i.getValue(e,h),o=i.getValue(c.addSeconds(e,1/60,f),p);if(l(n)&&(l(o)||(o=n,n=i.getValue(c.addSeconds(e,-1/60,f),p),l(n)))){if(s.equals(n,o))return this._normalize?void 0:s.clone(s.ZERO,t);l(r)&&n.clone(r);var a=s.subtract(o,n,t);return this._normalize?s.normalize(a,t):s.divideByScalar(a,1/60,t)}},t.prototype.equals=function(e){return this===e||e instanceof t&&d.equals(this._position,e._position)},t}),define("DataSources/VelocityOrientationProperty",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Ellipsoid","../Core/Event","../Core/Matrix3","../Core/Quaternion","../Core/Transforms","./Property","./VelocityVectorProperty"],function(e,i,n,t,o,a,r,s,l,u,c){"use strict";function d(e,t){this._velocityVectorProperty=new c(e,!0),this._subscription=void 0,this._ellipsoid=void 0,this._definitionChanged=new a,this.ellipsoid=i(t,o.WGS84);var r=this;this._velocityVectorProperty.definitionChanged.addEventListener(function(){r._definitionChanged.raiseEvent(r)})}t(d.prototype,{isConstant:{get:function(){return u.isConstant(this._velocityVectorProperty)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._velocityVectorProperty.position},set:function(e){this._velocityVectorProperty.position=e}},ellipsoid:{get:function(){return this._ellipsoid},set:function(e){this._ellipsoid!==e&&(this._ellipsoid=e,this._definitionChanged.raiseEvent(this))}}});var h=new e,p=new e,f=new r;return d.prototype.getValue=function(e,t){var r=this._velocityVectorProperty._getValue(e,p,h);if(n(r))return l.rotationMatrixFromPositionVelocity(h,r,this._ellipsoid,f),s.fromRotationMatrix(f,t)},d.prototype.equals=function(e){return this===e||e instanceof d&&u.equals(this._velocityVectorProperty,e._velocityVectorProperty)&&(this._ellipsoid===e._ellipsoid||this._ellipsoid.equals(e._ellipsoid))},d}),define("DataSources/CzmlDataSource",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/ClockRange","../Core/ClockStep","../Core/Color","../Core/CornerType","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/Ellipsoid","../Core/Event","../Core/ExtrapolationType","../Core/getFilenameFromUri","../Core/HermitePolynomialApproximation","../Core/isArray","../Core/Iso8601","../Core/JulianDate","../Core/LagrangePolynomialApproximation","../Core/LinearApproximation","../Core/Math","../Core/NearFarScalar","../Core/Quaternion","../Core/Rectangle","../Core/ReferenceFrame","../Core/Resource","../Core/RuntimeError","../Core/Spherical","../Core/TimeInterval","../Core/TimeIntervalCollection","../Scene/ColorBlendMode","../Scene/HeightReference","../Scene/HorizontalOrigin","../Scene/LabelStyle","../Scene/ShadowMode","../Scene/VerticalOrigin","../ThirdParty/Uri","../ThirdParty/when","./BillboardGraphics","./BoxGraphics","./ColorMaterialProperty","./CompositeMaterialProperty","./CompositePositionProperty","./CompositeProperty","./ConstantPositionProperty","./ConstantProperty","./CorridorGraphics","./CylinderGraphics","./DataSource","./DataSourceClock","./EllipseGraphics","./EllipsoidGraphics","./EntityCluster","./EntityCollection","./GridMaterialProperty","./ImageMaterialProperty","./LabelGraphics","./ModelGraphics","./NodeTransformationProperty","./PathGraphics","./PointGraphics","./PolygonGraphics","./PolylineArrowMaterialProperty","./PolylineDashMaterialProperty","./PolylineGlowMaterialProperty","./PolylineGraphics","./PolylineOutlineMaterialProperty","./PositionPropertyArray","./PropertyArray","./PropertyBag","./RectangleGraphics","./ReferenceProperty","./Rotation","./SampledPositionProperty","./SampledProperty","./StripeMaterialProperty","./StripeOrientation","./TimeIntervalCollectionPositionProperty","./TimeIntervalCollectionProperty","./VelocityOrientationProperty","./VelocityVectorProperty","./WallGraphics"],function(p,f,b,e,u,c,m,l,d,C,w,t,s,h,g,_,r,v,y,i,S,T,E,n,o,A,x,P,D,O,I,M,a,R,L,N,k,F,B,U,V,z,q,G,W,H,j,Y,X,Q,Z,K,J,$,ee,te,re,ie,ne,oe,ae,se,le,ue,ce,de,he,pe,fe,me,ge,_e,ve,ye,be,Ce,we,Se,Te,Ee,Ae,xe,Pe,De,Oe,Ie,Me){"use strict";function Re(){}var Le;function Ne(e,t){return"#"===t[0]&&(t=Le+t),we.fromString(e,t)}function ke(e,t,r){if(w(r.reference))return Ne(t,r.reference);if(w(r.velocityReference)){var i=Ne(t,r.velocityReference);switch(e){case b:case Re:return new Ie(i,e===Re);case P:return new Oe(i)}}throw new M(JSON.stringify(r)+" is not valid CZML.")}Re.packedLength=b.packedLength,Re.unpack=b.unpack,Re.pack=b.pack;var Fe=new b,Be=new a,Ue=new e,Ve=new R,ze=new P;function qe(e,t){var r=C(e.uri,e);return w(t)?t.getDerivedResource({url:r}):I.createIfNeeded(r)}function Ge(e){var t=e.cartesian;if(w(t))return t;var r=e.cartesianVelocity;if(w(r))return r;var i=e.unitCartesian;if(w(i))return i;var n=e.unitSpherical;if(w(n))return function(e){var t=e.length;if(Be.magnitude=1,2===t)return Be.clock=e[0],Be.cone=e[1],b.fromSpherical(Be,Fe),[Fe.x,Fe.y,Fe.z];for(var r=new Array(t/3*4),i=0,n=0;i<t;i+=3,n+=4)r[n]=e[i],Be.clock=e[i+1],Be.cone=e[i+2],b.fromSpherical(Be,Fe),r[n+1]=Fe.x,r[n+2]=Fe.y,r[n+3]=Fe.z;return r}(n);var o=e.spherical;if(w(o))return function(e){var t=e.length;if(3===t)return Be.clock=e[0],Be.cone=e[1],Be.magnitude=e[2],b.fromSpherical(Be,Fe),[Fe.x,Fe.y,Fe.z];for(var r=new Array(t),i=0;i<t;i+=4)r[i]=e[i],Be.clock=e[i+1],Be.cone=e[i+2],Be.magnitude=e[i+3],b.fromSpherical(Be,Fe),r[i+1]=Fe.x,r[i+2]=Fe.y,r[i+3]=Fe.z;return r}(o);var a=e.cartographicRadians;if(w(a))return function(e){var t=e.length;if(3===t)return Ue.longitude=e[0],Ue.latitude=e[1],Ue.height=e[2],_.WGS84.cartographicToCartesian(Ue,Fe),[Fe.x,Fe.y,Fe.z];for(var r=new Array(t),i=0;i<t;i+=4)r[i]=e[i],Ue.longitude=e[i+1],Ue.latitude=e[i+2],Ue.height=e[i+3],_.WGS84.cartographicToCartesian(Ue,Fe),r[i+1]=Fe.x,r[i+2]=Fe.y,r[i+3]=Fe.z;return r}(a);var s=e.cartographicDegrees;if(w(s))return function(e){var t=e.length;if(3===t)return Ue.longitude=A.toRadians(e[0]),Ue.latitude=A.toRadians(e[1]),Ue.height=e[2],_.WGS84.cartographicToCartesian(Ue,Fe),[Fe.x,Fe.y,Fe.z];for(var r=new Array(t),i=0;i<t;i+=4)r[i]=e[i],Ue.longitude=A.toRadians(e[i+1]),Ue.latitude=A.toRadians(e[i+2]),Ue.height=e[i+3],_.WGS84.cartographicToCartesian(Ue,Fe),r[i+1]=Fe.x,r[i+2]=Fe.y,r[i+3]=Fe.z;return r}(s);throw new M(JSON.stringify(e)+" is not a valid CZML interval.")}function We(e,t){b.unpack(e,t,Fe),b.normalize(Fe,Fe),b.pack(Fe,e,t)}function He(e,t){P.unpack(e,t,ze),P.normalize(ze,ze),P.pack(ze,e,t)}function je(e){return"boolean"==typeof e?Boolean:"number"==typeof e?Number:"string"==typeof e?String:e.hasOwnProperty("array")?Array:e.hasOwnProperty("boolean")?Boolean:e.hasOwnProperty("boundingRectangle")?p:e.hasOwnProperty("cartesian2")?f:e.hasOwnProperty("cartesian")||e.hasOwnProperty("spherical")||e.hasOwnProperty("cartographicRadians")||e.hasOwnProperty("cartographicDegrees")?b:e.hasOwnProperty("unitCartesian")||e.hasOwnProperty("unitSpherical")?Re:e.hasOwnProperty("rgba")||e.hasOwnProperty("rgbaf")?m:e.hasOwnProperty("colorBlendMode")?N:e.hasOwnProperty("cornerType")?l:e.hasOwnProperty("heightReference")?k:e.hasOwnProperty("horizontalOrigin")?F:e.hasOwnProperty("date")?E:e.hasOwnProperty("labelStyle")?B:e.hasOwnProperty("number")?Number:e.hasOwnProperty("nearFarScalar")?x:e.hasOwnProperty("distanceDisplayCondition")?g:e.hasOwnProperty("object")||e.hasOwnProperty("value")?Object:e.hasOwnProperty("unitQuaternion")?P:e.hasOwnProperty("shadowMode")?U:e.hasOwnProperty("string")?String:e.hasOwnProperty("stripeOrientation")?xe:e.hasOwnProperty("wsen")||e.hasOwnProperty("wsenDegrees")?D:e.hasOwnProperty("uri")?z:e.hasOwnProperty("verticalOrigin")?V:Object}function Ye(e,t,r){switch(e){case Array:return t.array;case Boolean:return C(t.boolean,t);case p:return t.boundingRectangle;case f:return t.cartesian2;case b:return Ge(t);case Re:return function(e){var t=Ge(e);if(3===t.length)return We(t,0),t;for(var r=1;r<t.length;r+=4)We(t,r);return t}(t);case m:return function(e){var t=e.rgbaf;if(w(t))return t;var r=e.rgba;if(w(r)){var i=r.length;if(i===m.packedLength)return[m.byteToFloat(r[0]),m.byteToFloat(r[1]),m.byteToFloat(r[2]),m.byteToFloat(r[3])];t=new Array(i);for(var n=0;n<i;n+=5)t[n]=r[n],t[n+1]=m.byteToFloat(r[n+1]),t[n+2]=m.byteToFloat(r[n+2]),t[n+3]=m.byteToFloat(r[n+3]),t[n+4]=m.byteToFloat(r[n+4]);return t}}(t);case N:return N[C(t.colorBlendMode,t)];case l:return l[C(t.cornerType,t)];case k:return k[C(t.heightReference,t)];case F:return F[C(t.horizontalOrigin,t)];case Image:return qe(t,r);case E:return E.fromIso8601(C(t.date,t));case B:return B[C(t.labelStyle,t)];case Number:return C(t.number,t);case x:return t.nearFarScalar;case g:return t.distanceDisplayCondition;case Object:return C(C(t.object,t.value),t);case P:return function(e){var t=e.unitQuaternion;if(w(t)){if(4===t.length)return He(t,0),t;for(var r=1;r<t.length;r+=5)He(t,r)}return t}(t);case Se:return C(t.number,t);case U:return U[C(C(t.shadowMode,t.shadows),t)];case String:return C(t.string,t);case xe:return xe[C(t.stripeOrientation,t)];case D:return function(e){var t=e.wsen;if(w(t))return t;var r=e.wsenDegrees;if(w(r)){var i=r.length;if(i===D.packedLength)return[A.toRadians(r[0]),A.toRadians(r[1]),A.toRadians(r[2]),A.toRadians(r[3])];t=new Array(i);for(var n=0;n<i;n+=5)t[n]=r[n],t[n+1]=A.toRadians(r[n+1]),t[n+2]=A.toRadians(r[n+2]),t[n+3]=A.toRadians(r[n+3]),t[n+4]=A.toRadians(r[n+4]);return t}}(t);case z:return qe(t,r);case V:return V[C(t.verticalOrigin,t)];default:throw new M(e)}}var Xe={HERMITE:i,LAGRANGE:n,LINEAR:o};function Qe(e,t){var r=e.interpolationAlgorithm;(w(r)||w(e.interpolationDegree))&&t.setInterpolationOptions({interpolationAlgorithm:Xe[r],interpolationDegree:e.interpolationDegree});var i=e.forwardExtrapolationType;w(i)&&(t.forwardExtrapolationType=v[i]);var n=e.forwardExtrapolationDuration;w(n)&&(t.forwardExtrapolationDuration=n);var o=e.backwardExtrapolationType;w(o)&&(t.backwardExtrapolationType=v[o]);var a=e.backwardExtrapolationDuration;w(a)&&(t.backwardExtrapolationDuration=a)}var Ze={iso8601:void 0};function Ke(e,t,r,i,n,o,a){var s,l,u,c,d,h=i.interval;w(h)?(Ze.iso8601=h,s=R.fromIso8601(Ze),w(n)&&(s=R.intersect(s,n,Ve))):w(n)&&(s=n);var p=!w(i.reference)&&!w(i.velocityReference),f=w(s)&&!s.equals(T.MAXIMUM_INTERVAL);p&&(c=Ye(e,i,o),l=C(e.packedLength,1),d=C(c.length,1),u=!w(i.array)&&"string"!=typeof c&&l<d&&e!==Object);var m="function"==typeof e.unpack&&e!==Se;if(u||f){var g,_,v=t[r],y=i.epoch;if(w(y)&&(g=E.fromIso8601(y)),u&&!f)return v instanceof Ee||(v=new Ee(e),t[r]=v),v.addSamplesPackedArray(c,g),void Qe(i,v);if(!u&&f)return(s=s.clone()).data=p?m?e.unpack(c,0):c:ke(e,a,i),w(v)||(v=p?new De:new X,t[r]=v),p&&v instanceof De||(v instanceof X||((_=T.MAXIMUM_INTERVAL.clone()).data=v,v=new X,(t[r]=v).intervals.addInterval(_)),p&&(s.data=new Z(s.data))),void v.intervals.addInterval(s);w(v)||(v=new X,t[r]=v),v instanceof X||((_=T.MAXIMUM_INTERVAL.clone()).data=v,v=new X,(t[r]=v).intervals.addInterval(_));var b=v.intervals;_=b.findInterval(s),w(_)&&_.data instanceof Ee||((_=s.clone()).data=new Ee(e),b.addInterval(_)),_.data.addSamplesPackedArray(c,g),Qe(i,_.data)}else t[r]=p?new Z(m?e.unpack(c,0):c):ke(e,a,i)}function Je(e,t,r,i,n,o,a){if(w(i))if(S(i))for(var s=0,l=i.length;s<l;s++)Ke(e,t,r,i[s],n,o,a);else Ke(e,t,r,i,n,o,a)}function $e(e,t,r,i,n,o){var a,s,l,u=r.interval;w(u)?(Ze.iso8601=u,a=R.fromIso8601(Ze),w(i)&&(a=R.intersect(a,i,Ve))):w(i)&&(a=i);var c=!1,d=w(r.cartesianVelocity)?1:0,h=b.packedLength*(d+1),p=!w(r.reference),f=w(a)&&!a.equals(T.MAXIMUM_INTERVAL);if(p&&(w(r.referenceFrame)&&(s=O[r.referenceFrame]),s=C(s,O.FIXED),l=Ge(r),c=h<C(l.length,1)),c||f){var m,g,_=e[t],v=r.epoch;if(w(v)&&(m=E.fromIso8601(v)),c&&!f)return _ instanceof Te&&(!w(s)||_.referenceFrame===s)||(_=new Te(s,d),e[t]=_),_.addSamplesPackedArray(l,m),void Qe(r,_);if(!c&&f)return(a=a.clone()).data=p?b.unpack(l):Ne(o,r.reference),w(_)||(_=p?new Pe(s):new Y(s),e[t]=_),p&&_ instanceof Pe&&w(s)&&_.referenceFrame===s||(_ instanceof Y||((g=T.MAXIMUM_INTERVAL.clone()).data=_,_=new Y(_.referenceFrame),(e[t]=_).intervals.addInterval(g)),p&&(a.data=new Q(a.data,s))),void _.intervals.addInterval(a);w(_)?_ instanceof Y||((g=T.MAXIMUM_INTERVAL.clone()).data=_,_=new Y(_.referenceFrame),(e[t]=_).intervals.addInterval(g)):(_=new Y(s),e[t]=_);var y=_.intervals;g=y.findInterval(a),w(g)&&g.data instanceof Te&&(!w(s)||g.data.referenceFrame===s)||((g=a.clone()).data=new Te(s,d),y.addInterval(g)),g.data.addSamplesPackedArray(l,m),Qe(r,g.data)}else e[t]=p?new Q(b.unpack(l),s):Ne(o,r.reference)}function et(e,t,r,i,n,o){if(w(r))if(S(r))for(var a=0,s=r.length;a<s;a++)$e(e,t,r[a],i,0,o);else $e(e,t,r,i,0,o)}function tt(e,t,r,i,n,o){var a,s=r.interval;w(s)?(Ze.iso8601=s,a=R.fromIso8601(Ze),w(i)&&(a=R.intersect(a,i,Ve))):w(i)&&(a=i);var l,u,c,d=e[t];if(w(a)){d instanceof j||(d=new j,e[t]=d);var h=d.intervals;u=h.findInterval({start:a.start,stop:a.stop}),w(u)?l=u.data:(u=a.clone(),h.addInterval(u))}else l=d;w(r.solidColor)?(l instanceof H||(l=new H),c=r.solidColor,Je(m,l,"color",c.color,void 0,void 0,o)):w(r.grid)?(l instanceof oe||(l=new oe),c=r.grid,Je(m,l,"color",c.color,void 0,n,o),Je(Number,l,"cellAlpha",c.cellAlpha,void 0,n,o),Je(f,l,"lineCount",c.lineCount,void 0,n,o),Je(f,l,"lineThickness",c.lineThickness,void 0,n,o),Je(f,l,"lineOffset",c.lineOffset,void 0,n,o)):w(r.image)?(l instanceof ae||(l=new ae),c=r.image,Je(Image,l,"image",c.image,void 0,n,o),Je(f,l,"repeat",c.repeat,void 0,n,o),Je(m,l,"color",c.color,void 0,n,o),Je(Boolean,l,"transparent",c.transparent,void 0,n,o)):w(r.stripe)?(l instanceof Ae||(l=new Ae),c=r.stripe,Je(xe,l,"orientation",c.orientation,void 0,n,o),Je(m,l,"evenColor",c.evenColor,void 0,n,o),Je(m,l,"oddColor",c.oddColor,void 0,n,o),Je(Number,l,"offset",c.offset,void 0,n,o),Je(Number,l,"repeat",c.repeat,void 0,n,o)):w(r.polylineOutline)?(l instanceof _e||(l=new _e),c=r.polylineOutline,Je(m,l,"color",c.color,void 0,n,o),Je(m,l,"outlineColor",c.outlineColor,void 0,n,o),Je(Number,l,"outlineWidth",c.outlineWidth,void 0,n,o)):w(r.polylineGlow)?(l instanceof me||(l=new me),c=r.polylineGlow,Je(m,l,"color",c.color,void 0,n,o),Je(Number,l,"glowPower",c.glowPower,void 0,n,o)):w(r.polylineArrow)?(l instanceof pe||(l=new pe),c=r.polylineArrow,Je(m,l,"color",c.color,void 0,void 0,o)):w(r.polylineDash)&&(l instanceof fe||(l=new fe),c=r.polylineDash,Je(m,l,"color",c.color,void 0,void 0,o),Je(m,l,"gapColor",c.gapColor,void 0,void 0,o),Je(Number,l,"dashLength",c.dashLength,void 0,n,o),Je(Number,l,"dashPattern",c.dashPattern,void 0,n,o)),w(u)?u.data=l:e[t]=l}function rt(e,t,r,i,n,o){if(w(r))if(S(r))for(var a=0,s=r.length;a<s;a++)tt(e,t,r[a],i,n,o);else tt(e,t,r,i,n,o)}function it(e,t,r,i){var n=r.references;if(w(n)){var o=n.map(function(e){return Ne(i,e)}),a=r.interval;if(w(a)){if(a=R.fromIso8601(a),!(e[t]instanceof Y)){a.data=new ye(o);var s=new X;s.intervals.addInterval(a),e[t]=s}}else e[t]=new ye(o)}else Je(Array,e,t,r,void 0,void 0,i)}function nt(e,t,r,i){if(w(r))if(S(r))for(var n=0,o=r.length;n<o;++n)it(e,t,r[n],i);else it(e,t,r,i)}function ot(e,t,r,i){if(w(r.references)){var n=r.references.map(function(e){return Ne(i,e)}),o=r.interval;if(w(o)){if(o=R.fromIso8601(o),!(e[t]instanceof Y)){o.data=new ve(n);var a=new Y;a.intervals.addInterval(o),e[t]=a}}else e[t]=new ve(n)}else w(r.cartesian)?r.array=b.unpackArray(r.cartesian):w(r.cartographicRadians)?r.array=b.fromRadiansArrayHeights(r.cartographicRadians):w(r.cartographicDegrees)&&(r.array=b.fromDegreesArrayHeights(r.cartographicDegrees)),w(r.array)&&Je(Array,e,t,r,void 0,void 0,i)}function at(e,t,r,i){if(w(r))if(S(r))for(var n=0,o=r.length;n<o;n++)ot(e,t,r[n],i);else ot(e,t,r,i)}function st(e,t,r,i,n){var o,a=t.interval;w(a)?(Ze.iso8601=a,o=R.fromIso8601(Ze),w(r)&&(o=R.intersect(o,r,Ve))):w(r)&&(o=r);for(var s=e.nodeTransformations,l=Object.keys(t),u=0,c=l.length;u<c;++u){var d=l[u];if("interval"!==d){var h=t[d];if(w(h)){w(s)||(e.nodeTransformations=s=new be),s.hasProperty(d)||s.addProperty(d);var p=s[d];w(p)||(s[d]=p=new ue),Je(b,p,"translation",h.translation,o,i,n),Je(P,p,"rotation",h.rotation,o,i,n),Je(b,p,"scale",h.scale,o,i,n)}}}}function lt(e,t,r,i,n){var o=e.id;if(w(o)||(o=d()),Le=o,!w(n._version)&&"document"!==o)throw new M("The first CZML packet is required to be the document object.");if(!0===e.delete)t.removeById(o);else if("document"===o)!function(e,t){var r=e.version;if(w(r)&&"string"==typeof r){var i=r.split(".");if(2===i.length){if("1"!==i[0])throw new M("Cesium only supports CZML version 1.");t._version=r}}if(!w(t._version))throw new M("CZML version information invalid.  It is expected to be a property on the document object in the <Major>.<Minor> version format.");var n=t._documentPacket;w(e.name)&&(n.name=e.name);var o=e.clock;if(w(o)){var a=n.clock;w(a)?(a.interval=C(o.interval,a.interval),a.currentTime=C(o.currentTime,a.currentTime),a.range=C(o.range,a.range),a.step=C(o.step,a.step),a.multiplier=C(o.multiplier,a.multiplier)):n.clock={interval:o.interval,currentTime:o.currentTime,range:o.range,step:o.step,multiplier:o.multiplier}}}(e,n);else{var a=t.getOrCreateEntity(o),s=e.parent;w(s)&&(a.parent=t.getOrCreateEntity(s));for(var l=r.length-1;-1<l;l--)r[l](a,e,t,i)}Le=void 0}function ut(t,e,r,i){if(!w(e))throw new h("czml is required.");r=C(r,C.EMPTY_OBJECT),w(r.query)&&s("CzmlDataSource.query","The options.query parameter has been deprecated. Specify czml or options.sourceUri as a Resource instance and add query parameters there.");var n=e,o=r.sourceUri,a=r.query;return("string"==typeof e||e instanceof I)&&(n=(e=I.createIfNeeded(e,{queryParameters:a})).fetchJson(),o=C(o,e.clone())),o=I.createIfNeeded(o,{queryParameters:a}),$.setLoading(t,!0),q(n,function(e){return function(e,t,r,i){$.setLoading(e,!0);var n=e._entityCollection;i&&(e._version=void 0,e._documentPacket=new ct,n.removeAll());dt._processCzml(t,n,r,void 0,e);var o=function(e){var t,r=e._documentPacket.clock;if(!w(r)){if(!w(e._clock)){var i=e._entityCollection.computeAvailability();if(!i.start.equals(T.MINIMUM_VALUE)){var n=i.start,o=i.stop,a=E.secondsDifference(o,n),s=Math.round(a/120);return(t=new ee).startTime=E.clone(n),t.stopTime=E.clone(o),t.clockRange=u.LOOP_STOP,t.multiplier=s,t.currentTime=E.clone(n),t.clockStep=c.SYSTEM_CLOCK_MULTIPLIER,e._clock=t,!0}}return!1}if(w(e._clock)?t=e._clock.clone():((t=new ee).startTime=T.MINIMUM_VALUE.clone(),t.stopTime=T.MAXIMUM_VALUE.clone(),t.currentTime=T.MINIMUM_VALUE.clone(),t.clockRange=u.LOOP_STOP,t.clockStep=c.SYSTEM_CLOCK_MULTIPLIER,t.multiplier=1),w(r.interval)){Ze.iso8601=r.interval;var l=R.fromIso8601(Ze);t.startTime=l.start,t.stopTime=l.stop}return w(r.currentTime)&&(t.currentTime=E.fromIso8601(r.currentTime)),w(r.range)&&(t.clockRange=C(u[r.range],u.LOOP_STOP)),w(r.step)&&(t.clockStep=C(c[r.step],c.SYSTEM_CLOCK_MULTIPLIER)),w(r.multiplier)&&(t.multiplier=r.multiplier),!t.equals(e._clock)&&(e._clock=t.clone(e._clock),!0)}(e),a=e._documentPacket;w(a.name)&&e._name!==a.name?(e._name=a.name,o=!0):!w(e._name)&&w(r)&&(e._name=y(r.getUrlComponent()),o=!0);$.setLoading(e,!1),o&&e._changed.raiseEvent(e);return e}(t,e,o,i)}).otherwise(function(e){return $.setLoading(t,!1),t._error.raiseEvent(t,e),console.log(e),q.reject(e)})}function ct(){this.name=void 0,this.clock=void 0}function dt(e){this._name=e,this._changed=new r,this._error=new r,this._isLoading=!1,this._loading=new r,this._clock=void 0,this._documentPacket=new ct,this._version=void 0,this._entityCollection=new ne(this),this._entityCluster=new ie}return dt.load=function(e,t){return(new dt).load(e,t)},t(dt.prototype,{name:{get:function(){return this._name}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!w(e))throw new h("value must be defined.");this._entityCluster=e}}}),dt.updaters=[function(e,t,r,i){var n=t.billboard;if(w(n)){var o,a=n.interval;w(a)&&(Ze.iso8601=a,o=R.fromIso8601(Ze));var s,l,u,c,d,h=e.billboard;w(h)||(e.billboard=h=new G),Je(Boolean,h,"show",n.show,o,i,r),Je(Image,h,"image",n.image,o,i,r),Je(Number,h,"scale",n.scale,o,i,r),Je(f,h,"pixelOffset",n.pixelOffset,o,i,r),Je(b,h,"eyeOffset",n.eyeOffset,o,i,r),Je(F,h,"horizontalOrigin",n.horizontalOrigin,o,i,r),Je(V,h,"verticalOrigin",n.verticalOrigin,o,i,r),Je(k,h,"heightReference",n.heightReference,o,i,r),Je(m,h,"color",n.color,o,i,r),Je(Se,h,"rotation",n.rotation,o,i,r),s=h,l=n.alignedAxis,u=o,c=i,d=r,w(l)&&Je(Re,s,"alignedAxis",l,u,c,d),Je(Boolean,h,"sizeInMeters",n.sizeInMeters,o,i,r),Je(Number,h,"width",n.width,o,i,r),Je(Number,h,"height",n.height,o,i,r),Je(x,h,"scaleByDistance",n.scaleByDistance,o,i,r),Je(x,h,"translucencyByDistance",n.translucencyByDistance,o,i,r),Je(x,h,"pixelOffsetScaleByDistance",n.pixelOffsetScaleByDistance,o,i,r),Je(p,h,"imageSubRegion",n.imageSubRegion,o,i,r),Je(g,h,"distanceDisplayCondition",n.distanceDisplayCondition,o,i,r),Je(Number,h,"disableDepthTestDistance",n.disableDepthTestDistance,o,i,r)}},function(e,t,r,i){var n=t.box;if(w(n)){var o,a=n.interval;w(a)&&(Ze.iso8601=a,o=R.fromIso8601(Ze));var s=e.box;w(s)||(e.box=s=new W),Je(Boolean,s,"show",n.show,o,i,r),Je(b,s,"dimensions",n.dimensions,o,i,r),Je(Boolean,s,"fill",n.fill,o,i,r),rt(s,"material",n.material,o,i,r),Je(Boolean,s,"outline",n.outline,o,i,r),Je(m,s,"outlineColor",n.outlineColor,o,i,r),Je(Number,s,"outlineWidth",n.outlineWidth,o,i,r),Je(U,s,"shadows",n.shadows,o,i,r),Je(g,s,"distanceDisplayCondition",n.distanceDisplayCondition,o,i,r)}},function(e,t,r,i){var n=t.corridor;if(w(n)){var o,a=n.interval;w(a)&&(Ze.iso8601=a,o=R.fromIso8601(Ze));var s=e.corridor;w(s)||(e.corridor=s=new K),Je(Boolean,s,"show",n.show,o,i,r),at(s,"positions",n.positions,r),Je(Number,s,"width",n.width,o,i,r),Je(Number,s,"height",n.height,o,i,r),Je(Number,s,"extrudedHeight",n.extrudedHeight,o,i,r),Je(l,s,"cornerType",n.cornerType,o,i,r),Je(Number,s,"granularity",n.granularity,o,i,r),Je(Boolean,s,"fill",n.fill,o,i,r),rt(s,"material",n.material,o,i,r),Je(Boolean,s,"outline",n.outline,o,i,r),Je(m,s,"outlineColor",n.outlineColor,o,i,r),Je(Number,s,"outlineWidth",n.outlineWidth,o,i,r),Je(U,s,"shadows",n.shadows,o,i,r),Je(g,s,"distanceDisplayCondition",n.distanceDisplayCondition,o,i,r)}},function(e,t,r,i){var n=t.cylinder;if(w(n)){var o,a=n.interval;w(a)&&(Ze.iso8601=a,o=R.fromIso8601(Ze));var s=e.cylinder;w(s)||(e.cylinder=s=new J),Je(Boolean,s,"show",n.show,o,i,r),Je(Number,s,"length",n.length,o,i,r),Je(Number,s,"topRadius",n.topRadius,o,i,r),Je(Number,s,"bottomRadius",n.bottomRadius,o,i,r),Je(Boolean,s,"fill",n.fill,o,i,r),rt(s,"material",n.material,o,i,r),Je(Boolean,s,"outline",n.outline,o,i,r),Je(m,s,"outlineColor",n.outlineColor,o,i,r),Je(Number,s,"outlineWidth",n.outlineWidth,o,i,r),Je(Number,s,"numberOfVerticalLines",n.numberOfVerticalLines,o,i,r),Je(Number,s,"slices",n.slices,o,i,r),Je(U,s,"shadows",n.shadows,o,i,r),Je(g,s,"distanceDisplayCondition",n.distanceDisplayCondition,o,i,r)}},function(e,t,r,i){var n=t.ellipse;if(w(n)){var o,a=n.interval;w(a)&&(Ze.iso8601=a,o=R.fromIso8601(Ze));var s=e.ellipse;w(s)||(e.ellipse=s=new te),Je(Boolean,s,"show",n.show,o,i,r),Je(Number,s,"semiMajorAxis",n.semiMajorAxis,o,i,r),Je(Number,s,"semiMinorAxis",n.semiMinorAxis,o,i,r),Je(Number,s,"height",n.height,o,i,r),Je(Number,s,"extrudedHeight",n.extrudedHeight,o,i,r),Je(Se,s,"rotation",n.rotation,o,i,r),Je(Se,s,"stRotation",n.stRotation,o,i,r),Je(Number,s,"granularity",n.granularity,o,i,r),Je(Boolean,s,"fill",n.fill,o,i,r),rt(s,"material",n.material,o,i,r),Je(Boolean,s,"outline",n.outline,o,i,r),Je(m,s,"outlineColor",n.outlineColor,o,i,r),Je(Number,s,"outlineWidth",n.outlineWidth,o,i,r),Je(Number,s,"numberOfVerticalLines",n.numberOfVerticalLines,o,i,r),Je(U,s,"shadows",n.shadows,o,i,r),Je(g,s,"distanceDisplayCondition",n.distanceDisplayCondition,o,i,r)}},function(e,t,r,i){var n=t.ellipsoid;if(w(n)){var o,a=n.interval;w(a)&&(Ze.iso8601=a,o=R.fromIso8601(Ze));var s=e.ellipsoid;w(s)||(e.ellipsoid=s=new re),Je(Boolean,s,"show",n.show,o,i,r),Je(b,s,"radii",n.radii,o,i,r),Je(Boolean,s,"fill",n.fill,o,i,r),rt(s,"material",n.material,o,i,r),Je(Boolean,s,"outline",n.outline,o,i,r),Je(m,s,"outlineColor",n.outlineColor,o,i,r),Je(Number,s,"outlineWidth",n.outlineWidth,o,i,r),Je(Number,s,"stackPartitions",n.stackPartitions,o,i,r),Je(Number,s,"slicePartitions",n.slicePartitions,o,i,r),Je(Number,s,"subdivisions",n.subdivisions,o,i,r),Je(U,s,"shadows",n.shadows,o,i,r),Je(g,s,"distanceDisplayCondition",n.distanceDisplayCondition,o,i,r)}},function(e,t,r,i){var n=t.label;if(w(n)){var o,a=n.interval;w(a)&&(Ze.iso8601=a,o=R.fromIso8601(Ze));var s=e.label;w(s)||(e.label=s=new se),Je(Boolean,s,"show",n.show,o,i,r),Je(String,s,"text",n.text,o,i,r),Je(String,s,"font",n.font,o,i,r),Je(B,s,"style",n.style,o,i,r),Je(Number,s,"scale",n.scale,o,i,r),Je(Boolean,s,"showBackground",n.showBackground,o,i,r),Je(m,s,"backgroundColor",n.backgroundColor,o,i,r),Je(f,s,"backgroundPadding",n.backgroundPadding,o,i,r),Je(f,s,"pixelOffset",n.pixelOffset,o,i,r),Je(b,s,"eyeOffset",n.eyeOffset,o,i,r),Je(F,s,"horizontalOrigin",n.horizontalOrigin,o,i,r),Je(V,s,"verticalOrigin",n.verticalOrigin,o,i,r),Je(k,s,"heightReference",n.heightReference,o,i,r),Je(m,s,"fillColor",n.fillColor,o,i,r),Je(m,s,"outlineColor",n.outlineColor,o,i,r),Je(Number,s,"outlineWidth",n.outlineWidth,o,i,r),Je(x,s,"translucencyByDistance",n.translucencyByDistance,o,i,r),Je(x,s,"pixelOffsetScaleByDistance",n.pixelOffsetScaleByDistance,o,i,r),Je(x,s,"scaleByDistance",n.scaleByDistance,o,i,r),Je(g,s,"distanceDisplayCondition",n.distanceDisplayCondition,o,i,r),Je(Number,s,"disableDepthTestDistance",n.disableDepthTestDistance,o,i,r)}},function(e,t,r,i){var n=t.model;if(w(n)){var o,a=n.interval;w(a)&&(Ze.iso8601=a,o=R.fromIso8601(Ze));var s=e.model;w(s)||(e.model=s=new le),Je(Boolean,s,"show",n.show,o,i,r),Je(z,s,"uri",n.gltf,o,i,r),Je(Number,s,"scale",n.scale,o,i,r),Je(Number,s,"minimumPixelSize",n.minimumPixelSize,o,i,r),Je(Number,s,"maximumScale",n.maximumScale,o,i,r),Je(Boolean,s,"incrementallyLoadTextures",n.incrementallyLoadTextures,o,i,r),Je(Boolean,s,"runAnimations",n.runAnimations,o,i,r),Je(Boolean,s,"clampAnimations",n.clampAnimations,o,i,r),Je(U,s,"shadows",n.shadows,o,i,r),Je(k,s,"heightReference",n.heightReference,o,i,r),Je(m,s,"silhouetteColor",n.silhouetteColor,o,i,r),Je(Number,s,"silhouetteSize",n.silhouetteSize,o,i,r),Je(m,s,"color",n.color,o,i,r),Je(N,s,"colorBlendMode",n.colorBlendMode,o,i,r),Je(Number,s,"colorBlendAmount",n.colorBlendAmount,o,i,r),Je(g,s,"distanceDisplayCondition",n.distanceDisplayCondition,o,i,r);var l=n.nodeTransformations;if(w(l))if(S(l))for(var u=0,c=l.length;u<c;u++)st(s,l[u],o,i,r);else st(s,l,o,i,r)}},function(e,t,r,i){e.name=C(t.name,e.name)},function(e,t,r,i){var n=t.description;w(n)&&Je(String,e,"description",n,void 0,i,r)},function(e,t,r,i){var n=t.path;if(w(n)){var o,a=n.interval;w(a)&&(Ze.iso8601=a,o=R.fromIso8601(Ze));var s=e.path;w(s)||(e.path=s=new ce),Je(Boolean,s,"show",n.show,o,i,r),Je(Number,s,"width",n.width,o,i,r),Je(Number,s,"resolution",n.resolution,o,i,r),Je(Number,s,"leadTime",n.leadTime,o,i,r),Je(Number,s,"trailTime",n.trailTime,o,i,r),rt(s,"material",n.material,o,i,r),Je(g,s,"distanceDisplayCondition",n.distanceDisplayCondition,o,i,r)}},function(e,t,r,i){var n=t.point;if(w(n)){var o,a=n.interval;w(a)&&(Ze.iso8601=a,o=R.fromIso8601(Ze));var s=e.point;w(s)||(e.point=s=new de),Je(Boolean,s,"show",n.show,o,i,r),Je(Number,s,"pixelSize",n.pixelSize,o,i,r),Je(k,s,"heightReference",n.heightReference,o,i,r),Je(m,s,"color",n.color,o,i,r),Je(m,s,"outlineColor",n.outlineColor,o,i,r),Je(Number,s,"outlineWidth",n.outlineWidth,o,i,r),Je(x,s,"scaleByDistance",n.scaleByDistance,o,i,r),Je(x,s,"translucencyByDistance",n.translucencyByDistance,o,i,r),Je(g,s,"distanceDisplayCondition",n.distanceDisplayCondition,o,i,r),Je(Number,s,"disableDepthTestDistance",n.disableDepthTestDistance,o,i,r)}},function(e,t,r,i){var n=t.polygon;if(w(n)){var o,a=n.interval;w(a)&&(Ze.iso8601=a,o=R.fromIso8601(Ze));var s=e.polygon;w(s)||(e.polygon=s=new he),Je(Boolean,s,"show",n.show,o,i,r),at(s,"hierarchy",n.positions,r),Je(Number,s,"height",n.height,o,i,r),Je(Number,s,"extrudedHeight",n.extrudedHeight,o,i,r),Je(Se,s,"stRotation",n.stRotation,o,i,r),Je(Number,s,"granularity",n.granularity,o,i,r),Je(Boolean,s,"fill",n.fill,o,i,r),rt(s,"material",n.material,o,i,r),Je(Boolean,s,"outline",n.outline,o,i,r),Je(m,s,"outlineColor",n.outlineColor,o,i,r),Je(Number,s,"outlineWidth",n.outlineWidth,o,i,r),Je(Boolean,s,"perPositionHeight",n.perPositionHeight,o,i,r),Je(Boolean,s,"closeTop",n.closeTop,o,i,r),Je(Boolean,s,"closeBottom",n.closeBottom,o,i,r),Je(U,s,"shadows",n.shadows,o,i,r),Je(g,s,"distanceDisplayCondition",n.distanceDisplayCondition,o,i,r)}},function(e,t,r,i){var n=t.polyline;if(w(n)){var o,a=n.interval;w(a)&&(Ze.iso8601=a,o=R.fromIso8601(Ze));var s=e.polyline;w(s)||(e.polyline=s=new ge),Je(Boolean,s,"show",n.show,o,i,r),at(s,"positions",n.positions,r),Je(Number,s,"width",n.width,o,i,r),Je(Number,s,"granularity",n.granularity,o,i,r),rt(s,"material",n.material,o,i,r),rt(s,"depthFailMaterial",n.depthFailMaterial,o,i,r),Je(Boolean,s,"followSurface",n.followSurface,o,i,r),Je(U,s,"shadows",n.shadows,o,i,r),Je(g,s,"distanceDisplayCondition",n.distanceDisplayCondition,o,i,r)}},function(e,t,r,i){var n=t.properties;if(w(n))for(var o in w(e.properties)||(e.properties=new be),n)if(n.hasOwnProperty(o)){e.properties.hasProperty(o)||e.properties.addProperty(o);var a=n[o];if(S(a))for(var s=0,l=a.length;s<l;s++)Ke(je(a[s]),e.properties,o,a[s],void 0,i,r);else Ke(je(a),e.properties,o,a,void 0,i,r)}},function(e,t,r,i){var n=t.rectangle;if(w(n)){var o,a=n.interval;w(a)&&(Ze.iso8601=a,o=R.fromIso8601(Ze));var s=e.rectangle;w(s)||(e.rectangle=s=new Ce),Je(Boolean,s,"show",n.show,o,i,r),Je(D,s,"coordinates",n.coordinates,o,i,r),Je(Number,s,"height",n.height,o,i,r),Je(Number,s,"extrudedHeight",n.extrudedHeight,o,i,r),Je(Se,s,"rotation",n.rotation,o,i,r),Je(Se,s,"stRotation",n.stRotation,o,i,r),Je(Number,s,"granularity",n.granularity,o,i,r),Je(Boolean,s,"fill",n.fill,o,i,r),rt(s,"material",n.material,o,i,r),Je(Boolean,s,"outline",n.outline,o,i,r),Je(m,s,"outlineColor",n.outlineColor,o,i,r),Je(Number,s,"outlineWidth",n.outlineWidth,o,i,r),Je(Boolean,s,"closeTop",n.closeTop,o,i,r),Je(Boolean,s,"closeBottom",n.closeBottom,o,i,r),Je(U,s,"shadows",n.shadows,o,i,r),Je(g,s,"distanceDisplayCondition",n.distanceDisplayCondition,o,i,r)}},function(e,t,r,i){var n=t.position;w(n)&&et(e,"position",n,void 0,0,r)},function(e,t,r,i){var n=t.viewFrom;w(n)&&Je(b,e,"viewFrom",n,void 0,i,r)},function(e,t,r,i){var n=t.wall;if(w(n)){var o,a=n.interval;w(a)&&(Ze.iso8601=a,o=R.fromIso8601(Ze));var s=e.wall;w(s)||(e.wall=s=new Me),Je(Boolean,s,"show",n.show,o,i,r),at(s,"positions",n.positions,r),nt(s,"minimumHeights",n.minimumHeights,r),nt(s,"maximumHeights",n.maximumHeights,r),Je(Number,s,"granularity",n.granularity,o,i,r),Je(Boolean,s,"fill",n.fill,o,i,r),rt(s,"material",n.material,o,i,r),Je(Boolean,s,"outline",n.outline,o,i,r),Je(m,s,"outlineColor",n.outlineColor,o,i,r),Je(Number,s,"outlineWidth",n.outlineWidth,o,i,r),Je(U,s,"shadows",n.shadows,o,i,r),Je(g,s,"distanceDisplayCondition",n.distanceDisplayCondition,o,i,r)}},function(e,t,r,i){var n=t.orientation;w(n)&&Je(P,e,"orientation",n,void 0,i,r)},function(e,t,r,i){var n,o=t.availability;if(w(o)){var a;if(S(o))for(var s=o.length,l=0;l<s;l++)w(a)||(a=new L),Ze.iso8601=o[l],n=R.fromIso8601(Ze),a.addInterval(n);else Ze.iso8601=o,n=R.fromIso8601(Ze),(a=new L).addInterval(n);e.availability=a}}],dt.prototype.process=function(e,t){return ut(this,e,t,!1)},dt.prototype.load=function(e,t){return ut(this,e,t,!0)},dt.processPacketData=Je,dt.processPositionPacketData=et,dt.processMaterialPacketData=rt,dt._processCzml=function(e,t,r,i,n){if(i=w(i)?i:dt.updaters,S(e))for(var o=0,a=e.length;o<a;o++)lt(e[o],t,i,r,n);else lt(e,t,i,r,n)},dt}),define("DataSources/DataSourceCollection",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Event","../ThirdParty/when"],function(o,i,e,t,n,r,a){"use strict";function s(){this._dataSources=[],this._dataSourceAdded=new r,this._dataSourceRemoved=new r}return e(s.prototype,{length:{get:function(){return this._dataSources.length}},dataSourceAdded:{get:function(){return this._dataSourceAdded}},dataSourceRemoved:{get:function(){return this._dataSourceRemoved}}}),s.prototype.add=function(e){if(!i(e))throw new n("dataSource is required.");var t=this,r=this._dataSources;return a(e,function(e){return r===t._dataSources&&(t._dataSources.push(e),t._dataSourceAdded.raiseEvent(t,e)),e})},s.prototype.remove=function(e,t){t=o(t,!1);var r=this._dataSources.indexOf(e);return-1!==r&&(this._dataSources.splice(r,1),this._dataSourceRemoved.raiseEvent(this,e),t&&"function"==typeof e.destroy&&e.destroy(),!0)},s.prototype.removeAll=function(e){e=o(e,!1);for(var t=this._dataSources,r=0,i=t.length;r<i;++r){var n=t[r];this._dataSourceRemoved.raiseEvent(this,n),e&&"function"==typeof n.destroy&&n.destroy()}this._dataSources=[]},s.prototype.contains=function(e){return-1!==this.indexOf(e)},s.prototype.indexOf=function(e){return this._dataSources.indexOf(e)},s.prototype.get=function(e){if(!i(e))throw new n("index is required.");return this._dataSources[e]},s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){return this.removeAll(!0),t(this)},s}),define("DataSources/EllipseGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/EllipseGeometry","../Core/EllipseOutlineGeometry","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/oneTimeWarning","../Core/ShowGeometryInstanceAttribute","../Scene/GroundPrimitive","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(C,w,T,E,e,r,S,t,A,x,P,i,D,O,I,l,M,R,L,N,n,k,o,a,F,B){"use strict";var U=new k(C.WHITE),V=new o(!0),z=new o(!0),q=new o(!1),G=new o(C.BLACK),W=new o(n.DISABLED),H=new o(new t),j=new C;function s(e){this.id=e,this.vertexFormat=void 0,this.center=void 0,this.semiMajorAxis=void 0,this.semiMinorAxis=void 0,this.rotation=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.numberOfVerticalLines=void 0}function u(e,t){if(!E(e))throw new S("entity is required");if(!E(t))throw new S("scene is required");this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(u.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._isClosed=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new i,this._showProperty=void 0,this._materialProperty=void 0,this._hasConstantOutline=!0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._onTerrain=!1,this._options=new s(e),this._onEntityPropertyChanged(e,"ellipse",e.ellipse,void 0)}function c(e,t,r){this._primitives=e,this._groundPrimitives=t,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=r,this._options=new s(r._entity)}return e(u,{perInstanceColorAppearanceType:{value:L},materialAppearanceType:{value:R}}),e(u.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!E(this._entity.availability)&&B.isConstant(this._showProperty)&&B.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!E(this._entity.availability)&&B.isConstant(this._showProperty)&&B.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}}),u.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)},u.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)},u.prototype.createFillGeometryInstance=function(e){if(!E(e))throw new S("time is required.");if(!this._fillEnabled)throw new S("This instance does not represent a filled geometry.");var t,r=this._entity,i=r.isAvailable(e),n=new l(i&&r.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),a=A.fromDistanceDisplayCondition(o);if(this._materialProperty instanceof k){var s=C.WHITE;E(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(s=this._materialProperty.color.getValue(e)),t={show:n,distanceDisplayCondition:a,color:w.fromColor(s)}}else t={show:n,distanceDisplayCondition:a};return new D({id:r,geometry:new x(this._options),attributes:t})},u.prototype.createOutlineGeometryInstance=function(e){if(!E(e))throw new S("time is required.");if(!this._outlineEnabled)throw new S("This instance does not represent an outlined geometry.");var t=this._entity,r=t.isAvailable(e),i=B.getValueOrDefault(this._outlineColorProperty,e,C.BLACK),n=this._distanceDisplayConditionProperty.getValue(e);return new D({id:t,geometry:new P(this._options),attributes:{show:new l(r&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:w.fromColor(i),distanceDisplayCondition:A.fromDistanceDisplayCondition(n)}})},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){this._entitySubscription(),r(this)},u.prototype._onEntityPropertyChanged=function(e,t,r,i){if("availability"===t||"position"===t||"ellipse"===t){var n=this._entity.ellipse;if(E(n)){var o=n.fill,a=!E(o)||!o.isConstant||o.getValue(O.MINIMUM_VALUE),s=n.outline,l=E(s);if(l&&s.isConstant&&(l=s.getValue(O.MINIMUM_VALUE)),a||l){var u=this._entity.position,c=n.semiMajorAxis,d=n.semiMinorAxis,h=n.show;if((!E(h)||!h.isConstant||h.getValue(O.MINIMUM_VALUE))&&E(u)&&E(c)&&E(d)){var p=T(n.material,U),f=p instanceof k;this._materialProperty=p,this._fillProperty=T(o,z),this._showProperty=T(h,V),this._showOutlineProperty=T(n.outline,q),this._outlineColorProperty=l?T(n.outlineColor,G):void 0,this._shadowsProperty=T(n.shadows,W),this._distanceDisplayConditionProperty=T(n.distanceDisplayCondition,H);var m=n.rotation,g=n.height,_=n.extrudedHeight,v=n.granularity,y=n.stRotation,b=n.outlineWidth,C=n.numberOfVerticalLines,w=a&&!E(g)&&!E(_)&&f&&M.isSupported(this._scene);if(l&&w&&(I(I.geometryOutlines),l=!1),this._fillEnabled=a,this._onTerrain=w,this._isClosed=E(_)||w,this._outlineEnabled=l,u.isConstant&&c.isConstant&&d.isConstant&&B.isConstant(m)&&B.isConstant(g)&&B.isConstant(_)&&B.isConstant(v)&&B.isConstant(y)&&B.isConstant(b)&&B.isConstant(C)&&(!w||B.isConstant(p))){var S=this._options;S.vertexFormat=f?L.VERTEX_FORMAT:R.MaterialSupport.TEXTURED.vertexFormat,S.center=u.getValue(O.MINIMUM_VALUE,S.center),S.semiMajorAxis=c.getValue(O.MINIMUM_VALUE,S.semiMajorAxis),S.semiMinorAxis=d.getValue(O.MINIMUM_VALUE,S.semiMinorAxis),S.rotation=E(m)?m.getValue(O.MINIMUM_VALUE):void 0,S.height=E(g)?g.getValue(O.MINIMUM_VALUE):void 0,S.extrudedHeight=E(_)?_.getValue(O.MINIMUM_VALUE):void 0,S.granularity=E(v)?v.getValue(O.MINIMUM_VALUE):void 0,S.stRotation=E(y)?y.getValue(O.MINIMUM_VALUE):void 0,S.numberOfVerticalLines=E(C)?C.getValue(O.MINIMUM_VALUE):void 0,this._outlineWidth=E(b)?b.getValue(O.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}},u.prototype.createDynamicUpdater=function(e,t){if(!this._dynamic)throw new S("This instance does not represent dynamic geometry.");if(!E(e))throw new S("primitives is required.");return new c(e,t,this)},c.prototype.update=function(e){if(!E(e))throw new S("time is required.");var t=this._geometryUpdater,r=t._onTerrain,i=this._primitives,n=this._groundPrimitives;r?n.removeAndDestroy(this._primitive):(i.removeAndDestroy(this._primitive),i.removeAndDestroy(this._outlinePrimitive),this._outlinePrimitive=void 0),this._primitive=void 0;var o=t._entity,a=o.ellipse;if(o.isShowing&&o.isAvailable(e)&&B.getValueOrDefault(a.show,e,!0)){var s=this._options,l=B.getValueOrUndefined(o.position,e,s.center),u=B.getValueOrUndefined(a.semiMajorAxis,e),c=B.getValueOrUndefined(a.semiMinorAxis,e);if(E(l)&&E(u)&&E(c)){s.center=l,s.semiMajorAxis=u,s.semiMinorAxis=c,s.rotation=B.getValueOrUndefined(a.rotation,e),s.height=B.getValueOrUndefined(a.height,e),s.extrudedHeight=B.getValueOrUndefined(a.extrudedHeight,e),s.granularity=B.getValueOrUndefined(a.granularity,e),s.stRotation=B.getValueOrUndefined(a.stRotation,e),s.numberOfVerticalLines=B.getValueOrUndefined(a.numberOfVerticalLines,e);var d=this._geometryUpdater.shadowsProperty.getValue(e),h=this._geometryUpdater.distanceDisplayConditionProperty.getValue(e),p=A.fromDistanceDisplayCondition(h);if(B.getValueOrDefault(a.fill,e,!0)){var f=t.fillMaterialProperty,m=F.getValue(e,f,this._material);if(this._material=m,r){var g=C.WHITE;E(f.color)&&(g=f.color.getValue(e)),this._primitive=n.add(new M({geometryInstances:new D({id:o,geometry:new x(s),attributes:{color:w.fromColor(g),distanceDisplayCondition:p}}),asynchronous:!1,shadows:d}))}else{var _=new R({material:m,translucent:m.isTranslucent(),closed:E(s.extrudedHeight)});s.vertexFormat=_.vertexFormat,this._primitive=i.add(new N({geometryInstances:new D({id:o,geometry:new x(s)}),attributes:{distanceDisplayCondition:p},appearance:_,asynchronous:!1,shadows:d}))}}if(!r&&B.getValueOrDefault(a.outline,e,!1)){s.vertexFormat=L.VERTEX_FORMAT;var v=B.getValueOrClonedDefault(a.outlineColor,e,C.BLACK,j),y=B.getValueOrDefault(a.outlineWidth,e,1),b=1!==v.alpha;this._outlinePrimitive=i.add(new N({geometryInstances:new D({id:o,geometry:new P(s),attributes:{color:w.fromColor(v),distanceDisplayCondition:p}}),appearance:new L({flat:!0,translucent:b,renderState:{lineWidth:t._scene.clampLineWidth(y)}}),asynchronous:!1,shadows:d}))}}}},c.prototype.getBoundingSphere=function(e,t){return a(e,this._primitive,this._outlinePrimitive,t)},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){var e=this._primitives,t=this._groundPrimitives;this._geometryUpdater._onTerrain?t.removeAndDestroy(this._primitive):e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),r(this)},u}),define("DataSources/EllipsoidGeometryUpdater",["../Core/Cartesian3","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/EllipsoidGeometry","../Core/EllipsoidOutlineGeometry","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/Matrix4","../Core/ShowGeometryInstanceAttribute","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/SceneMode","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,E,A,x,P,t,r,D,O,I,M,R,i,L,y,N,k,F,B,U,V,n,b,o,a,z,q){"use strict";var G=new b(E.WHITE),C=new o(!0),w=new o(!0),S=new o(!1),T=new o(E.BLACK),W=new o(n.DISABLED),H=new o(new O),j=new e,Y=new E,X=new e(1,1,1);function s(e){this.id=e,this.vertexFormat=void 0,this.radii=void 0,this.stackPartitions=void 0,this.slicePartitions=void 0,this.subdivisions=void 0}function l(e,t){if(!P(e))throw new D("entity is required");if(!P(t))throw new D("scene is required");this._scene=t,this._entity=e,this._entitySubscription=e.definitionChanged.addEventListener(l.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new i,this._showProperty=void 0,this._materialProperty=void 0,this._hasConstantOutline=!0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._options=new s(e),this._onEntityPropertyChanged(e,"ellipsoid",e.ellipsoid,void 0)}function u(e,t){this._entity=t._entity,this._scene=t._scene,this._primitives=e,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=t,this._options=new s(t._entity),this._modelMatrix=new N,this._material=void 0,this._attributes=void 0,this._outlineAttributes=void 0,this._lastSceneMode=void 0,this._lastShow=void 0,this._lastOutlineShow=void 0,this._lastOutlineWidth=void 0,this._lastOutlineColor=void 0}return t(l,{perInstanceColorAppearanceType:{value:B},materialAppearanceType:{value:F}}),t(l.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!P(this._entity.availability)&&q.isConstant(this._showProperty)&&q.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!P(this._entity.availability)&&q.isConstant(this._showProperty)&&q.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:!0},geometryChanged:{get:function(){return this._geometryChanged}}}),l.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)},l.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)},l.prototype.createFillGeometryInstance=function(e){if(!P(e))throw new D("time is required.");if(!this._fillEnabled)throw new D("This instance does not represent a filled geometry.");var t,r=this._entity,i=r.isAvailable(e),n=new k(i&&r.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),a=I.fromDistanceDisplayCondition(o);if(this._materialProperty instanceof b){var s=E.WHITE;P(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(s=this._materialProperty.color.getValue(e)),t={show:n,distanceDisplayCondition:a,color:A.fromColor(s)}}else t={show:n,distanceDisplayCondition:a};return new L({id:r,geometry:new M(this._options),modelMatrix:r.computeModelMatrix(y.MINIMUM_VALUE),attributes:t})},l.prototype.createOutlineGeometryInstance=function(e){if(!P(e))throw new D("time is required.");if(!this._outlineEnabled)throw new D("This instance does not represent an outlined geometry.");var t=this._entity,r=t.isAvailable(e),i=q.getValueOrDefault(this._outlineColorProperty,e,E.BLACK),n=this._distanceDisplayConditionProperty.getValue(e);return new L({id:t,geometry:new R(this._options),modelMatrix:t.computeModelMatrix(y.MINIMUM_VALUE),attributes:{show:new k(r&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:A.fromColor(i),distanceDisplayCondition:I.fromDistanceDisplayCondition(n)}})},l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){this._entitySubscription(),r(this)},l.prototype._onEntityPropertyChanged=function(e,t,r,i){if("availability"===t||"position"===t||"orientation"===t||"ellipsoid"===t){var n=e.ellipsoid;if(P(n)){var o=n.fill,a=!P(o)||!o.isConstant||o.getValue(y.MINIMUM_VALUE),s=n.outline,l=P(s);if(l&&s.isConstant&&(l=s.getValue(y.MINIMUM_VALUE)),a||l){var u=e.position,c=n.radii,d=n.show;if(P(d)&&d.isConstant&&!d.getValue(y.MINIMUM_VALUE)||!P(u)||!P(c))(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this));else{var h=x(n.material,G),p=h instanceof b;this._materialProperty=h,this._fillProperty=x(o,w),this._showProperty=x(d,C),this._showOutlineProperty=x(n.outline,S),this._outlineColorProperty=l?x(n.outlineColor,T):void 0,this._shadowsProperty=x(n.shadows,W),this._distanceDisplayConditionProperty=x(n.distanceDisplayCondition,H),this._fillEnabled=a,this._outlineEnabled=l;var f=n.stackPartitions,m=n.slicePartitions,g=n.outlineWidth,_=n.subdivisions;if(u.isConstant&&q.isConstant(e.orientation)&&c.isConstant&&q.isConstant(f)&&q.isConstant(m)&&q.isConstant(g)&&q.isConstant(_)){var v=this._options;v.vertexFormat=p?B.VERTEX_FORMAT:F.MaterialSupport.TEXTURED.vertexFormat,v.radii=c.getValue(y.MINIMUM_VALUE,v.radii),v.stackPartitions=P(f)?f.getValue(y.MINIMUM_VALUE):void 0,v.slicePartitions=P(m)?m.getValue(y.MINIMUM_VALUE):void 0,v.subdivisions=P(_)?_.getValue(y.MINIMUM_VALUE):void 0,this._outlineWidth=P(g)?g.getValue(y.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}},l.prototype.createDynamicUpdater=function(e){if(!this._dynamic)throw new D("This instance does not represent dynamic geometry.");if(!P(e))throw new D("primitives is required.");return new u(e,this)},u.prototype.update=function(e){if(!P(e))throw new D("time is required.");var t=this._entity,r=t.ellipsoid;if(!t.isShowing||!t.isAvailable(e)||!q.getValueOrDefault(r.show,e,!0))return P(this._primitive)&&(this._primitive.show=!1),void(P(this._outlinePrimitive)&&(this._outlinePrimitive.show=!1));var i,n=q.getValueOrUndefined(r.radii,e,j),o=t.computeModelMatrix(e,this._modelMatrix);if(!P(o)||!P(n))return P(this._primitive)&&(this._primitive.show=!1),void(P(this._outlinePrimitive)&&(this._outlinePrimitive.show=!1));var a=q.getValueOrDefault(r.fill,e,!0),s=q.getValueOrDefault(r.outline,e,!1),l=q.getValueOrClonedDefault(r.outlineColor,e,E.BLACK,Y),u=z.getValue(e,x(r.material,G),this._material);this._material=u;var c=q.getValueOrUndefined(r.stackPartitions,e),d=q.getValueOrUndefined(r.slicePartitions,e),h=q.getValueOrUndefined(r.subdivisions,e),p=q.getValueOrDefault(r.outlineWidth,e,1),f=this._scene.mode,m=f===V.SCENE3D,g=this._options,_=this._geometryUpdater.shadowsProperty.getValue(e),v=this._geometryUpdater.distanceDisplayConditionProperty.getValue(e),y=I.fromDistanceDisplayCondition(v);if(!m||this._lastSceneMode!==f||!P(this._primitive)||g.stackPartitions!==c||g.slicePartitions!==d||g.subdivisions!==h||this._lastOutlineWidth!==p){var b=this._primitives;b.removeAndDestroy(this._primitive),b.removeAndDestroy(this._outlinePrimitive),this._primitive=void 0,this._outlinePrimitive=void 0,this._lastSceneMode=f,this._lastOutlineWidth=p,g.stackPartitions=c,g.slicePartitions=d,g.subdivisions=h,g.radii=m?X:n,i=new F({material:u,translucent:u.isTranslucent(),closed:!0}),g.vertexFormat=i.vertexFormat,this._primitive=b.add(new U({geometryInstances:new L({id:t,geometry:new M(g),modelMatrix:m?void 0:o,attributes:{show:new k(a),distanceDisplayCondition:y}}),appearance:i,asynchronous:!1,shadows:_})),g.vertexFormat=B.VERTEX_FORMAT,this._outlinePrimitive=b.add(new U({geometryInstances:new L({id:t,geometry:new R(g),modelMatrix:m?void 0:o,attributes:{show:new k(s),color:A.fromColor(l),distanceDisplayCondition:y}}),appearance:new B({flat:!0,translucent:1!==l.alpha,renderState:{lineWidth:this._geometryUpdater._scene.clampLineWidth(p)}}),asynchronous:!1,shadows:_})),this._lastShow=a,this._lastOutlineShow=s,this._lastOutlineColor=E.clone(l,this._lastOutlineColor),this._lastDistanceDisplayCondition=v}else if(this._primitive.ready){var C=this._primitive,w=this._outlinePrimitive;C.show=!0,w.show=!0,(i=C.appearance).material=u;var S=this._attributes;P(S)||(S=C.getGeometryInstanceAttributes(t),this._attributes=S),a!==this._lastShow&&(S.show=k.toValue(a,S.show),this._lastShow=a);var T=this._outlineAttributes;P(T)||(T=w.getGeometryInstanceAttributes(t),this._outlineAttributes=T),s!==this._lastOutlineShow&&(T.show=k.toValue(s,T.show),this._lastOutlineShow=s),E.equals(l,this._lastOutlineColor)||(T.color=A.toValue(l,T.color),E.clone(l,this._lastOutlineColor)),O.equals(v,this._lastDistanceDisplayCondition)||(S.distanceDisplayCondition=I.toValue(v,S.distanceDisplayCondition),T.distanceDisplayCondition=I.toValue(v,T.distanceDisplayCondition),O.clone(v,this._lastDistanceDisplayCondition))}m&&(n.x=Math.max(n.x,.001),n.y=Math.max(n.y,.001),n.z=Math.max(n.z,.001),o=N.multiplyByScale(o,n,o),this._primitive.modelMatrix=o,this._outlinePrimitive.modelMatrix=o)},u.prototype.getBoundingSphere=function(e,t){return a(e,this._primitive,this._outlinePrimitive,t)},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),r(this)},l}),define("DataSources/StaticGeometryColorBatch",["../Core/AssociativeArray","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defined","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/ShowGeometryInstanceAttribute","../Scene/Primitive","./BoundingSphereState","./ColorMaterialProperty","./MaterialProperty","./Property"],function(l,C,w,S,T,E,A,x,a,P,D,O){"use strict";var I=new C,M=new T;function u(e,t,r,i,n,o,a){var s;this.translucent=t,this.appearanceType=r,this.depthFailAppearanceType=i,this.depthFailMaterialProperty=n,this.depthFailMaterial=void 0,this.closed=o,this.shadows=a,this.primitives=e,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new l,this.updaters=new l,this.updatersWithAttributes=new l,this.attributes=new l,this.subscriptions=new l,this.showsUpdated=new l,this.itemsToRemove=[],this.invalidated=!1,S(n)&&(s=n.definitionChanged.addEventListener(u.prototype.onMaterialChanged,this)),this.removeMaterialSubscription=s}function e(e,t,r,i,n){this._solidItems=[],this._translucentItems=[],this._primitives=e,this._appearanceType=t,this._depthFailAppearanceType=r,this._closed=i,this._shadows=n}function t(e,t){for(var r=e.length-1;0<=r;r--){var i=e[r];if(i.remove(t)&&0===i.updaters.length)return e.splice(r,1),i.destroy(),!0}return!1}function n(e,t,r){for(var i=!1,n=t.length,o=0;o<n;++o){var a=t[o],s=a.itemsToRemove,l=s.length;if(0<l)for(o=0;o<l;o++){var u=s[o];a.remove(u),e.add(r,u),i=!0}}return i}function o(e,t,r,i){var n,o=t.length;for(n=o-1;0<=n;n--){var a=t[n];if(a.invalidated){t.splice(n,1);for(var s=a.updaters.values,l=s.length,u=0;u<l;u++)e.add(r,s[u]);a.destroy()}}for(o=t.length,n=0;n<o;++n)i=t[n].update(r)&&i;return i}function i(e,t,r){for(var i=e.length,n=0;n<i;n++){var o=e[n];if(o.contains(t))return o.getBoundingSphere(t,r)}return a.FAILED}function r(e){for(var t=e.length,r=0;r<t;r++)e[r].destroy();e.length=0}return u.prototype.onMaterialChanged=function(){this.invalidated=!0},u.prototype.isMaterial=function(e){var t=this.depthFailMaterialProperty,r=e.depthFailMaterialProperty;return r===t||!!S(t)&&t.equals(r)},u.prototype.add=function(n,e){var t=n.entity.id;if(this.createPrimitive=!0,this.geometry.set(t,e),this.updaters.set(t,n),n.hasConstantFill&&n.fillMaterialProperty.isConstant&&O.isConstant(n.distanceDisplayConditionProperty)){var o=this;this.subscriptions.set(t,n.entity.definitionChanged.addEventListener(function(e,t,r,i){"isShowing"===t&&o.showsUpdated.set(e.id,n)}))}else this.updatersWithAttributes.set(t,n)},u.prototype.remove=function(e){var t=e.entity.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var r=this.subscriptions.get(t);S(r)&&(r(),this.subscriptions.remove(t))}},u.prototype.update=function(e){var t,r,i=!0,n=0,o=this.primitive,a=this.primitives;if(this.createPrimitive){var s=this.geometry.values,l=s.length;if(0<l){for(S(o)&&(S(this.oldPrimitive)?a.remove(o):this.oldPrimitive=o),r=0;r<l;r++){var u=s[r],c=u.attributes;t=this.attributes.get(u.id.id),S(t)&&(S(c.show)&&(c.show.value=t.show),S(c.color)&&(c.color.value=t.color),S(c.depthFailColor)&&(c.depthFailColor.value=t.depthFailColor))}var d;S(this.depthFailAppearanceType)&&(S(this.depthFailMaterialProperty)&&(this.depthFailMaterial=D.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial)),d=new this.depthFailAppearanceType({material:this.depthFailMaterial,translucent:this.translucent,closed:this.closed})),o=new x({asynchronous:!0,geometryInstances:s,appearance:new this.appearanceType({translucent:this.translucent,closed:this.closed}),depthFailAppearance:d,shadows:this.shadows}),a.add(o),i=!1}else{S(o)&&(a.remove(o),o=void 0);var h=this.oldPrimitive;S(h)&&(a.remove(h),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=o,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(S(o)&&o.ready){S(this.oldPrimitive)&&(a.remove(this.oldPrimitive),this.oldPrimitive=void 0),!S(this.depthFailAppearanceType)||this.depthFailMaterialProperty instanceof P||(this.depthFailMaterial=D.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),this.primitive.depthFailAppearance.material=this.depthFailMaterial);var p=this.updatersWithAttributes.values,f=p.length,m=this.waitingOnCreate;for(r=0;r<f;r++){var g=p[r],_=this.geometry.get(g.entity.id);if(t=this.attributes.get(_.id.id),S(t)||(t=o.getGeometryInstanceAttributes(_.id),this.attributes.set(_.id.id,t)),!g.fillMaterialProperty.isConstant||m)g.fillMaterialProperty.color.getValue(e,I),C.equals(t._lastColor,I)||(t._lastColor=C.clone(I,t._lastColor),t.color=w.toValue(I,t.color),(this.translucent&&255===t.color[3]||!this.translucent&&255!==t.color[3])&&(this.itemsToRemove[n++]=g));if(S(this.depthFailAppearanceType)&&this.depthFailAppearanceType instanceof P&&(!g.depthFailMaterialProperty.isConstant||m))g.depthFailMaterialProperty.color.getValue(e,I),C.equals(t._lastDepthFailColor,I)||(t._lastDepthFailColor=C.clone(I,t._lastDepthFailColor),t.depthFailColor=w.toValue(I,t.depthFailColor));var v=g.entity.isShowing&&(g.hasConstantFill||g.isFilled(e));v!==(1===t.show[0])&&(t.show=A.toValue(v,t.show));var y=g.distanceDisplayConditionProperty;if(!O.isConstant(y)){var b=y.getValue(e,M);T.equals(b,t._lastDistanceDisplayCondition)||(t._lastDistanceDisplayCondition=T.clone(b,t._lastDistanceDisplayCondition),t.distanceDisplayCondition=E.toValue(b,t.distanceDisplayCondition))}}this.updateShows(o),this.waitingOnCreate=!1}else S(o)&&!o.ready&&(i=!1);return this.itemsToRemove.length=n,i},u.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,r=t.length,i=0;i<r;i++){var n=t[i],o=this.geometry.get(n.entity.id),a=this.attributes.get(o.id.id);S(a)||(a=e.getGeometryInstanceAttributes(o.id),this.attributes.set(o.id.id,a));var s=n.entity.isShowing;s!==(1===a.show[0])&&(a.show=A.toValue(s,a.show))}this.showsUpdated.removeAll()},u.prototype.contains=function(e){return this.updaters.contains(e.id)},u.prototype.getBoundingSphere=function(e,t){var r=this.primitive;if(!r.ready)return a.PENDING;var i=r.getGeometryInstanceAttributes(e);return!S(i)||!S(i.boundingSphere)||S(i.show)&&0===i.show[0]?a.FAILED:(i.boundingSphere.clone(t),a.DONE)},u.prototype.removeAllPrimitives=function(){var e=this.primitives,t=this.primitive;S(t)&&(e.remove(t),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());var r=this.oldPrimitive;S(r)&&(e.remove(r),this.oldPrimitive=void 0)},u.prototype.destroy=function(){var e=this.primitive,t=this.primitives;S(e)&&t.remove(e);var r=this.oldPrimitive;S(r)&&t.remove(r),S(this.removeMaterialSubscription)&&this.removeMaterialSubscription()},e.prototype.add=function(e,t){var r,i,n=t.createFillGeometryInstance(e);i=255===n.attributes.color.value[3]?(r=this._solidItems,!1):(r=this._translucentItems,!0);for(var o=r.length,a=0;a<o;a++){var s=r[a];if(s.isMaterial(t))return void s.add(t,n)}var l=new u(this._primitives,i,this._appearanceType,this._depthFailAppearanceType,t.depthFailMaterialProperty,this._closed,this._shadows);l.add(t,n),r.push(l)},e.prototype.remove=function(e){t(this._solidItems,e)||t(this._translucentItems,e)},e.prototype.update=function(e){var t=o(this,this._solidItems,e,!0);t=o(this,this._translucentItems,e,t)&&t;var r=n(this,this._solidItems,e),i=n(this,this._translucentItems,e);return(r||i)&&(t=o(this,this._solidItems,e,t)&&t,t=o(this,this._translucentItems,e,t)&&t),t},e.prototype.getBoundingSphere=function(e,t){var r=i(this._solidItems,e,t);return r===a.FAILED?i(this._translucentItems,e,t):r},e.prototype.removeAllPrimitives=function(){r(this._solidItems),r(this._translucentItems)},e}),define("DataSources/StaticGeometryPerMaterialBatch",["../Core/AssociativeArray","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defined","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/ShowGeometryInstanceAttribute","../Scene/Primitive","./BoundingSphereState","./ColorMaterialProperty","./MaterialProperty","./Property"],function(s,C,w,S,T,E,A,x,a,P,D,O){"use strict";var I=new T;function l(e,t,r,i,n,o,a){this.primitives=e,this.appearanceType=t,this.materialProperty=r,this.depthFailAppearanceType=i,this.depthFailMaterialProperty=n,this.closed=o,this.shadows=a,this.updaters=new s,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new s,this.material=void 0,this.depthFailMaterial=void 0,this.updatersWithAttributes=new s,this.attributes=new s,this.invalidated=!1,this.removeMaterialSubscription=r.definitionChanged.addEventListener(l.prototype.onMaterialChanged,this),this.subscriptions=new s,this.showsUpdated=new s}l.prototype.onMaterialChanged=function(){this.invalidated=!0},l.prototype.isMaterial=function(e){var t=this.materialProperty,r=e.fillMaterialProperty,i=this.depthFailMaterialProperty,n=e.depthFailMaterialProperty;if(r===t&&n===i)return!0;var o=S(t)&&t.equals(r);return o=(!S(i)&&!S(n)||S(i)&&i.equals(n))&&o},l.prototype.add=function(e,n){var t=n.entity.id;if(this.updaters.set(t,n),this.geometry.set(t,n.createFillGeometryInstance(e)),n.hasConstantFill&&n.fillMaterialProperty.isConstant&&O.isConstant(n.distanceDisplayConditionProperty)){var o=this;this.subscriptions.set(t,n.entity.definitionChanged.addEventListener(function(e,t,r,i){"isShowing"===t&&o.showsUpdated.set(e.id,n)}))}else this.updatersWithAttributes.set(t,n);this.createPrimitive=!0},l.prototype.remove=function(e){var t=e.entity.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var r=this.subscriptions.get(t);S(r)&&(r(),this.subscriptions.remove(t))}return this.createPrimitive};var M=new C;function e(e,t,r,i,n){this._items=[],this._primitives=e,this._appearanceType=t,this._depthFailAppearanceType=r,this._closed=i,this._shadows=n}return l.prototype.update=function(e){var t,r,i=!0,n=this.primitive,o=this.primitives,a=this.geometry.values;if(this.createPrimitive){var s=a.length;if(0<s){for(S(n)&&(S(this.oldPrimitive)?o.remove(n):this.oldPrimitive=n),r=0;r<s;r++){var l=a[r],u=l.attributes;t=this.attributes.get(l.id.id),S(t)&&(S(u.show)&&(u.show.value=t.show),S(u.color)&&(u.color.value=t.color),S(u.depthFailColor)&&(u.depthFailColor.value=t.depthFailColor))}var c,d;if(this.material=D.getValue(e,this.materialProperty,this.material),S(this.depthFailMaterialProperty))d=this.depthFailMaterialProperty instanceof D?(this.depthFailMaterial=D.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),this.depthFailMaterial.isTranslucent()):this.material.isTranslucent(),c=new this.depthFailAppearanceType({material:this.depthFailMaterial,translucent:d,closed:this.closed});n=new x({asynchronous:!0,geometryInstances:a,appearance:new this.appearanceType({material:this.material,translucent:this.material.isTranslucent(),closed:this.closed}),depthFailAppearance:c,shadows:this.shadows}),o.add(n),i=!1}else{S(n)&&(o.remove(n),n=void 0);var h=this.oldPrimitive;S(h)&&(o.remove(h),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=n,this.createPrimitive=!1}else if(S(n)&&n.ready){S(this.oldPrimitive)&&(o.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.material=D.getValue(e,this.materialProperty,this.material),this.primitive.appearance.material=this.material,!S(this.depthFailAppearanceType)||this.depthFailMaterialProperty instanceof P||(this.depthFailMaterial=D.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),this.primitive.depthFailAppearance.material=this.depthFailMaterial);var p=this.updatersWithAttributes.values,f=p.length;for(r=0;r<f;r++){var m=p[r],g=m.entity,_=this.geometry.get(g.id);if(t=this.attributes.get(_.id.id),S(t)||(t=n.getGeometryInstanceAttributes(_.id),this.attributes.set(_.id.id,t)),S(this.depthFailAppearanceType)&&this.depthFailAppearanceType instanceof P&&!m.depthFailMaterialProperty.isConstant)m.depthFailMaterialProperty.color.getValue(e,M),C.equals(t._lastDepthFailColor,M)||(t._lastDepthFailColor=C.clone(M,t._lastDepthFailColor),t.depthFailColor=w.toValue(M,t.depthFailColor));var v=g.isShowing&&(m.hasConstantFill||m.isFilled(e));v!==(1===t.show[0])&&(t.show=A.toValue(v,t.show));var y=m.distanceDisplayConditionProperty;if(!O.isConstant(y)){var b=y.getValue(e,I);T.equals(b,t._lastDistanceDisplayCondition)||(t._lastDistanceDisplayCondition=T.clone(b,t._lastDistanceDisplayCondition),t.distanceDisplayCondition=E.toValue(b,t.distanceDisplayCondition))}}this.updateShows(n)}else S(n)&&!n.ready&&(i=!1);return i},l.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,r=t.length,i=0;i<r;i++){var n=t[i].entity,o=this.geometry.get(n.id),a=this.attributes.get(o.id.id);S(a)||(a=e.getGeometryInstanceAttributes(o.id),this.attributes.set(o.id.id,a));var s=n.isShowing;s!==(1===a.show[0])&&(a.show=A.toValue(s,a.show))}this.showsUpdated.removeAll()},l.prototype.contains=function(e){return this.updaters.contains(e.id)},l.prototype.getBoundingSphere=function(e,t){var r=this.primitive;if(!r.ready)return a.PENDING;var i=r.getGeometryInstanceAttributes(e);return!S(i)||!S(i.boundingSphere)||S(i.show)&&0===i.show[0]?a.FAILED:(i.boundingSphere.clone(t),a.DONE)},l.prototype.destroy=function(){var e=this.primitive,t=this.primitives;S(e)&&t.remove(e);var r=this.oldPrimitive;S(r)&&t.remove(r),this.removeMaterialSubscription()},e.prototype.add=function(e,t){for(var r=this._items,i=r.length,n=0;n<i;n++){var o=r[n];if(o.isMaterial(t))return void o.add(e,t)}var a=new l(this._primitives,this._appearanceType,t.fillMaterialProperty,this._depthFailAppearanceType,t.depthFailMaterialProperty,this._closed,this._shadows);a.add(e,t),r.push(a)},e.prototype.remove=function(e){for(var t=this._items,r=t.length-1;0<=r;r--){var i=t[r];if(i.remove(e)){0===i.updaters.length&&(t.splice(r,1),i.destroy());break}}},e.prototype.update=function(e){var t,r=this._items,i=r.length;for(t=i-1;0<=t;t--){var n=r[t];if(n.invalidated){r.splice(t,1);for(var o=n.updaters.values,a=o.length,s=0;s<a;s++)this.add(e,o[s]);n.destroy()}}var l=!0;for(t=0;t<i;t++)l=r[t].update(e)&&l;return l},e.prototype.getBoundingSphere=function(e,t){for(var r=this._items,i=r.length,n=0;n<i;n++){var o=r[n];if(o.contains(e))return o.getBoundingSphere(e,t)}return a.FAILED},e.prototype.removeAllPrimitives=function(){for(var e=this._items,t=e.length,r=0;r<t;r++)e[r].destroy();this._items.length=0},e}),define("DataSources/StaticGroundGeometryColorBatch",["../Core/AssociativeArray","../Core/Color","../Core/defined","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/ShowGeometryInstanceAttribute","../Scene/GroundPrimitive","./BoundingSphereState","./Property"],function(i,w,S,T,E,A,x,a,P){"use strict";var D=new w,O=new T;function s(e,t,r){this.primitives=e,this.color=t,this.key=r,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new i,this.updaters=new i,this.updatersWithAttributes=new i,this.attributes=new i,this.subscriptions=new i,this.showsUpdated=new i,this.itemsToRemove=[],this.isDirty=!1}s.prototype.add=function(n,e){var t=n.entity.id;if(this.createPrimitive=!0,this.geometry.set(t,e),this.updaters.set(t,n),n.hasConstantFill&&n.fillMaterialProperty.isConstant&&P.isConstant(n.distanceDisplayConditionProperty)){var o=this;this.subscriptions.set(t,n.entity.definitionChanged.addEventListener(function(e,t,r,i){"isShowing"===t&&o.showsUpdated.set(e.id,n)}))}else this.updatersWithAttributes.set(t,n)},s.prototype.remove=function(e){var t=e.entity.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var r=this.subscriptions.get(t);S(r)&&(r(),this.subscriptions.remove(t))}};var I=new Array(4);function e(e){this._batches=new i,this._primitives=e}return s.prototype.update=function(e){var t,r,i=!0,n=0,o=this.primitive,a=this.primitives;if(this.createPrimitive){var s=this.geometry.values,l=s.length;if(0<l){for(S(o)&&(S(this.oldPrimitive)?a.remove(o):this.oldPrimitive=o),r=0;r<l;r++){var u=s[r],c=u.attributes;t=this.attributes.get(u.id.id),S(t)&&(S(c.show)&&(c.show.value=t.show),S(c.color)&&(c.color.value=t.color))}o=new x({asynchronous:!0,geometryInstances:s}),a.add(o),i=!1}else{S(o)&&(a.remove(o),o=void 0);var d=this.oldPrimitive;S(d)&&(a.remove(d),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=o,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(S(o)&&o.ready){S(this.oldPrimitive)&&(a.remove(this.oldPrimitive),this.oldPrimitive=void 0);var h=this.updatersWithAttributes.values,p=h.length,f=this.waitingOnCreate;for(r=0;r<p;r++){var m=h[r],g=this.geometry.get(m.entity.id);if(t=this.attributes.get(g.id.id),S(t)||(t=o.getGeometryInstanceAttributes(g.id),this.attributes.set(g.id.id,t)),!m.fillMaterialProperty.isConstant||f)if(m.fillMaterialProperty.color.getValue(e,D),!w.equals(t._lastColor,D)){t._lastColor=w.clone(D,t._lastColor);var _=this.color,v=D.toBytes(I);_[0]===v[0]&&_[1]===v[1]&&_[2]===v[2]&&_[3]===v[3]||(this.itemsToRemove[n++]=m)}var y=m.entity.isShowing&&(m.hasConstantFill||m.isFilled(e));y!==(1===t.show[0])&&(t.show=A.toValue(y,t.show));var b=m.distanceDisplayConditionProperty;if(!P.isConstant(b)){var C=b.getValue(e,O);T.equals(C,t._lastDistanceDisplayCondition)||(t._lastDistanceDisplayCondition=T.clone(C,t._lastDistanceDisplayCondition),t.distanceDisplayCondition=E.toValue(C,t.distanceDisplayCondition))}}this.updateShows(o),this.waitingOnCreate=!1}else S(o)&&!o.ready&&(i=!1);return this.itemsToRemove.length=n,i},s.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,r=t.length,i=0;i<r;i++){var n=t[i],o=this.geometry.get(n.entity.id),a=this.attributes.get(o.id.id);S(a)||(a=e.getGeometryInstanceAttributes(o.id),this.attributes.set(o.id.id,a));var s=n.entity.isShowing;s!==(1===a.show[0])&&(a.show=A.toValue(s,a.show))}this.showsUpdated.removeAll()},s.prototype.contains=function(e){return this.updaters.contains(e.id)},s.prototype.getBoundingSphere=function(e,t){var r=this.primitive;if(!r.ready)return a.PENDING;var i=r.getBoundingSphere(e);return S(i)?(i.clone(t),a.DONE):a.FAILED},s.prototype.removeAllPrimitives=function(){var e=this.primitives,t=this.primitive;S(t)&&(e.remove(t),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());var r=this.oldPrimitive;S(r)&&(e.remove(r),this.oldPrimitive=void 0)},e.prototype.add=function(e,t){var r,i=t.createFillGeometryInstance(e),n=this._batches,o=new Uint32Array(i.attributes.color.value.buffer)[0];return n.contains(o)?r=n.get(o):(r=new s(this._primitives,i.attributes.color.value,o),n.set(o,r)),r.add(t,i),r},e.prototype.remove=function(e){for(var t=this._batches.values,r=t.length,i=0;i<r;++i)if(t[i].remove(e))return},e.prototype.update=function(e){var t,r,i=!0,n=this._batches,o=n.values,a=o.length;for(t=0;t<a;++t)i=o[t].update(e)&&i;for(t=0;t<a;++t)for(var s=o[t],l=s.itemsToRemove,u=l.length,c=0;c<u;c++){r=l[c],s.remove(r);var d=this.add(e,r);s.isDirty=!0,d.isDirty=!0}var h=o.slice(),p=h.length;for(t=0;t<p;++t){var f=h[t];f.isDirty&&(i=h[t].update(e)&&i,f.isDirty=!1),0===f.geometry.length&&n.remove(f.key)}return i},e.prototype.getBoundingSphere=function(e,t){for(var r=this._batches.values,i=r.length,n=0;n<i;++n){var o=r[n];if(o.contains(e))return o.getBoundingSphere(e,t)}return a.FAILED},e.prototype.removeAllPrimitives=function(){for(var e=this._batches.values,t=e.length,r=0;r<t;++r)e[r].removeAllPrimitives()},e}),define("DataSources/StaticOutlineGeometryBatch",["../Core/AssociativeArray","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defined","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/ShowGeometryInstanceAttribute","../Scene/PerInstanceColorAppearance","../Scene/Primitive","./BoundingSphereState","./Property"],function(n,b,C,w,S,T,E,A,x,u,P){"use strict";function a(e,t,r,i){this.translucent=t,this.width=r,this.shadows=i,this.primitives=e,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new n,this.updaters=new n,this.updatersWithAttributes=new n,this.attributes=new n,this.itemsToRemove=[],this.subscriptions=new n,this.showsUpdated=new n}a.prototype.add=function(n,e){var t=n.entity.id;if(this.createPrimitive=!0,this.geometry.set(t,e),this.updaters.set(t,n),n.hasConstantOutline&&n.outlineColorProperty.isConstant&&P.isConstant(n.distanceDisplayConditionProperty)){var o=this;this.subscriptions.set(t,n.entity.definitionChanged.addEventListener(function(e,t,r,i){"isShowing"===t&&o.showsUpdated.set(e.id,n)}))}else this.updatersWithAttributes.set(t,n)},a.prototype.remove=function(e){var t=e.entity.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var r=this.subscriptions.get(t);w(r)&&(r(),this.subscriptions.remove(t))}};var D=new b,O=new S;function e(e,t,r){this._primitives=e,this._scene=t,this._shadows=r,this._solidBatches=new n,this._translucentBatches=new n}return a.prototype.update=function(e){var t,r,i=!0,n=0,o=this.primitive,a=this.primitives;if(this.createPrimitive){var s=this.geometry.values,l=s.length;if(0<l){for(w(o)&&(w(this.oldPrimitive)?a.remove(o):this.oldPrimitive=o),r=0;r<l;r++){var u=s[r],c=u.attributes;t=this.attributes.get(u.id.id),w(t)&&(w(c.show)&&(c.show.value=t.show),w(c.color)&&(c.color.value=t.color))}o=new x({asynchronous:!0,geometryInstances:s,appearance:new A({flat:!0,translucent:this.translucent,renderState:{lineWidth:this.width}}),shadows:this.shadows}),a.add(o),i=!1}else{w(o)&&(a.remove(o),o=void 0);var d=this.oldPrimitive;w(d)&&(a.remove(d),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=o,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(w(o)&&o.ready){w(this.oldPrimitive)&&(a.remove(this.oldPrimitive),this.oldPrimitive=void 0);var h=this.updatersWithAttributes.values,p=h.length,f=this.waitingOnCreate;for(r=0;r<p;r++){var m=h[r],g=this.geometry.get(m.entity.id);if(t=this.attributes.get(g.id.id),w(t)||(t=o.getGeometryInstanceAttributes(g.id),this.attributes.set(g.id.id,t)),!m.outlineColorProperty.isConstant||f)m.outlineColorProperty.getValue(e,D),b.equals(t._lastColor,D)||(t._lastColor=b.clone(D,t._lastColor),t.color=C.toValue(D,t.color),(this.translucent&&255===t.color[3]||!this.translucent&&255!==t.color[3])&&(this.itemsToRemove[n++]=m));var _=m.entity.isShowing&&(m.hasConstantOutline||m.isOutlineVisible(e));_!==(1===t.show[0])&&(t.show=E.toValue(_,t.show));var v=m.distanceDisplayConditionProperty;if(!P.isConstant(v)){var y=v.getValue(e,O);S.equals(y,t._lastDistanceDisplayCondition)||(t._lastDistanceDisplayCondition=S.clone(y,t._lastDistanceDisplayCondition),t.distanceDisplayCondition=T.toValue(y,t.distanceDisplayCondition))}}this.updateShows(o),this.waitingOnCreate=!1}else w(o)&&!o.ready&&(i=!1);return this.itemsToRemove.length=n,i},a.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,r=t.length,i=0;i<r;i++){var n=t[i],o=this.geometry.get(n.entity.id),a=this.attributes.get(o.id.id);w(a)||(a=e.getGeometryInstanceAttributes(o.id),this.attributes.set(o.id.id,a));var s=n.entity.isShowing;s!==(1===a.show[0])&&(a.show=E.toValue(s,a.show))}this.showsUpdated.removeAll()},a.prototype.contains=function(e){return this.updaters.contains(e.id)},a.prototype.getBoundingSphere=function(e,t){var r=this.primitive;if(!r.ready)return u.PENDING;var i=r.getGeometryInstanceAttributes(e);return!w(i)||!w(i.boundingSphere)||w(i.show)&&0===i.show[0]?u.FAILED:(i.boundingSphere.clone(t),u.DONE)},a.prototype.removeAllPrimitives=function(){var e=this.primitives,t=this.primitive;w(t)&&(e.remove(t),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());var r=this.oldPrimitive;w(r)&&(e.remove(r),this.oldPrimitive=void 0)},e.prototype.add=function(e,t){var r,i,n=t.createOutlineGeometryInstance(e),o=this._scene.clampLineWidth(t.outlineWidth);255===n.attributes.color.value[3]?(i=(r=this._solidBatches).get(o),w(i)||(i=new a(this._primitives,!1,o,this._shadows),r.set(o,i))):(i=(r=this._translucentBatches).get(o),w(i)||(i=new a(this._primitives,!0,o,this._shadows),r.set(o,i))),i.add(t,n)},e.prototype.remove=function(e){var t,r=this._solidBatches.values,i=r.length;for(t=0;t<i;t++)if(r[t].remove(e))return;var n=this._translucentBatches.values,o=n.length;for(t=0;t<o;t++)if(n[t].remove(e))return},e.prototype.update=function(e){var t,r,i,n,o,a=this._solidBatches.values,s=a.length,l=this._translucentBatches.values,u=l.length,c=!0,d=!1;do{for(d=!1,r=0;r<s;r++){c=(n=a[r]).update(e);var h=(o=n.itemsToRemove).length;if(0<h)for(d=!0,t=0;t<h;t++)i=o[t],n.remove(i),this.add(e,i)}for(r=0;r<u;r++){c=(n=l[r]).update(e);var p=(o=n.itemsToRemove).length;if(0<p)for(d=!0,t=0;t<p;t++)i=o[t],n.remove(i),this.add(e,i)}}while(d);return c},e.prototype.getBoundingSphere=function(e,t){var r,i=this._solidBatches.values,n=i.length;for(r=0;r<n;r++){var o=i[r];if(o.contains(e))return o.getBoundingSphere(e,t)}var a=this._translucentBatches.values,s=a.length;for(r=0;r<s;r++){var l=a[r];if(l.contains(e))return l.getBoundingSphere(e,t)}return u.FAILED},e.prototype.removeAllPrimitives=function(){var e,t=this._solidBatches.values,r=t.length;for(e=0;e<r;e++)t[e].removeAllPrimitives();var i=this._translucentBatches.values,n=i.length;for(e=0;e<n;e++)i[e].removeAllPrimitives()},e}),define("DataSources/GeometryVisualizer",["../Core/AssociativeArray","../Core/BoundingSphere","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Scene/ShadowMode","./BoundingSphereState","./ColorMaterialProperty","./StaticGeometryColorBatch","./StaticGeometryPerMaterialBatch","./StaticGroundGeometryColorBatch","./StaticOutlineGeometryBatch"],function(s,u,f,n,m,l,c,a,d,h,p,g){"use strict";var _=[];function v(e,t){this._primitives=e,this._groundPrimitives=t,this._dynamicUpdaters=new s}function y(e,t){for(var r=e._batches,i=r.length,n=0;n<i;n++)r[n].remove(t)}function b(e,t,r){if(r.isDynamic)e._dynamicBatch.add(t,r);else{var i;(r.outlineEnabled||r.fillEnabled)&&(i=r.shadowsProperty.getValue(t)),r.outlineEnabled&&e._outlineBatches[i].add(t,r);var n,o=0;f(r.depthFailMaterialProperty)&&(o=r.depthFailMaterialProperty instanceof a?1:2),f(i)&&(n=i+o*l.NUMBER_OF_SHADOW_MODES),r.fillEnabled&&(r.onTerrain?e._groundColorBatch.add(t,r):r.isClosed?r.fillMaterialProperty instanceof a?e._closedColorBatches[n].add(t,r):e._closedMaterialBatches[n].add(t,r):r.fillMaterialProperty instanceof a?e._openColorBatches[n].add(t,r):e._openMaterialBatches[n].add(t,r))}}function C(e,t,r){if(!f(e))throw new m("type is required.");if(!f(t))throw new m("scene is required.");if(!f(r))throw new m("entityCollection is required.");this._type=e;var i=t.primitives,n=t.groundPrimitives;this._scene=t,this._primitives=i,this._groundPrimitives=n,this._entityCollection=void 0,this._addedObjects=new s,this._removedObjects=new s,this._changedObjects=new s;var o=l.NUMBER_OF_SHADOW_MODES;this._outlineBatches=new Array(o),this._closedColorBatches=new Array(3*o),this._closedMaterialBatches=new Array(3*o),this._openColorBatches=new Array(3*o),this._openMaterialBatches=new Array(3*o);for(var a=0;a<o;++a)this._outlineBatches[a]=new g(i,t,a),this._closedColorBatches[a]=new d(i,e.perInstanceColorAppearanceType,void 0,!0,a),this._closedMaterialBatches[a]=new h(i,e.materialAppearanceType,void 0,!0,a),this._openColorBatches[a]=new d(i,e.perInstanceColorAppearanceType,void 0,!1,a),this._openMaterialBatches[a]=new h(i,e.materialAppearanceType,void 0,!1,a),this._closedColorBatches[a+o]=new d(i,e.perInstanceColorAppearanceType,e.perInstanceColorAppearanceType,!0,a),this._closedMaterialBatches[a+o]=new h(i,e.materialAppearanceType,e.perInstanceColorAppearanceType,!0,a),this._openColorBatches[a+o]=new d(i,e.perInstanceColorAppearanceType,e.perInstanceColorAppearanceType,!1,a),this._openMaterialBatches[a+o]=new h(i,e.materialAppearanceType,e.perInstanceColorAppearanceType,!1,a),this._closedColorBatches[a+2*o]=new d(i,e.perInstanceColorAppearanceType,e.materialAppearanceType,!0,a),this._closedMaterialBatches[a+2*o]=new h(i,e.materialAppearanceType,e.materialAppearanceType,!0,a),this._openColorBatches[a+2*o]=new d(i,e.perInstanceColorAppearanceType,e.materialAppearanceType,!1,a),this._openMaterialBatches[a+2*o]=new h(i,e.materialAppearanceType,e.materialAppearanceType,!1,a);this._groundColorBatch=new p(n),this._dynamicBatch=new v(i,n),this._batches=this._outlineBatches.concat(this._closedColorBatches,this._closedMaterialBatches,this._openColorBatches,this._openMaterialBatches,this._groundColorBatch,this._dynamicBatch),this._subscriptions=new s,this._updaters=new s,(this._entityCollection=r).collectionChanged.addEventListener(C.prototype._onCollectionChanged,this),this._onCollectionChanged(r,r.values,_)}v.prototype.add=function(e,t){this._dynamicUpdaters.set(t.entity.id,t.createDynamicUpdater(this._primitives,this._groundPrimitives))},v.prototype.remove=function(e){var t=e.entity.id,r=this._dynamicUpdaters.get(t);f(r)&&(this._dynamicUpdaters.remove(t),r.destroy())},v.prototype.update=function(e){for(var t=this._dynamicUpdaters.values,r=0,i=t.length;r<i;r++)t[r].update(e);return!0},v.prototype.removeAllPrimitives=function(){for(var e=this._dynamicUpdaters.values,t=0,r=e.length;t<r;t++)e[t].destroy();this._dynamicUpdaters.removeAll()},v.prototype.getBoundingSphere=function(e,t){var r=this._dynamicUpdaters.get(e.id);return f(r)&&f(r.getBoundingSphere)?r.getBoundingSphere(e,t):c.FAILED},C.prototype.update=function(e){if(!f(e))throw new m("time is required.");var t,r,i,n,o=this._addedObjects,a=o.values,s=this._removedObjects,l=s.values,u=this._changedObjects,c=u.values;for(t=c.length-1;-1<t;t--)i=(r=c[t]).id,(n=this._updaters.get(i)).entity===r?(y(this,n),b(this,e,n)):(l.push(r),a.push(r));for(t=l.length-1;-1<t;t--)i=(r=l[t]).id,y(this,n=this._updaters.get(i)),n.destroy(),this._updaters.remove(i),this._subscriptions.get(i)(),this._subscriptions.remove(i);for(t=a.length-1;-1<t;t--)i=(r=a[t]).id,n=new this._type(r,this._scene),this._updaters.set(i,n),b(this,e,n),this._subscriptions.set(i,n.geometryChanged.addEventListener(C._onGeometryChanged,this));o.removeAll(),s.removeAll(),u.removeAll();var d=!0,h=this._batches,p=h.length;for(t=0;t<p;t++)d=h[t].update(e)&&d;return d};var w=[],S=new u;return C.prototype.getBoundingSphere=function(e,t){if(!f(e))throw new m("entity is required.");if(!f(t))throw new m("result is required.");for(var r=w,i=S,n=0,o=c.DONE,a=this._batches,s=a.length,l=0;l<s;l++){if((o=a[l].getBoundingSphere(e,i))===c.PENDING)return c.PENDING;o===c.DONE&&(r[n]=u.clone(i,r[n]),n++)}return 0===n?c.FAILED:(r.length=n,u.fromBoundingSpheres(r,t),c.DONE)},C.prototype.isDestroyed=function(){return!1},C.prototype.destroy=function(){var e;this._entityCollection.collectionChanged.removeEventListener(C.prototype._onCollectionChanged,this),this._addedObjects.removeAll(),this._removedObjects.removeAll();var t=this._batches,r=t.length;for(e=0;e<r;e++)t[e].removeAllPrimitives();var i=this._subscriptions.values;for(r=i.length,e=0;e<r;e++)i[e]();return this._subscriptions.removeAll(),n(this)},C._onGeometryChanged=function(e){var t=this._removedObjects,r=this._changedObjects,i=e.entity,n=i.id;f(t.get(n))||f(r.get(n))||r.set(n,i)},C.prototype._onCollectionChanged=function(e,t,r){var i,n,o,a=this._addedObjects,s=this._removedObjects,l=this._changedObjects;for(i=r.length-1;-1<i;i--)n=(o=r[i]).id,a.remove(n)||(s.set(n,o),l.remove(n));for(i=t.length-1;-1<i;i--)n=(o=t[i]).id,s.remove(n)?l.set(n,o):a.set(n,o)},C}),define("DataSources/LabelVisualizer",["../Core/AssociativeArray","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/NearFarScalar","../Scene/HeightReference","../Scene/HorizontalOrigin","../Scene/LabelStyle","../Scene/VerticalOrigin","./BoundingSphereState","./Property"],function(r,e,n,t,o,d,i,h,a,s,l,u,c,p,f,m){"use strict";var g=c.FILL,_=t.WHITE,v=t.BLACK,y=new t(.165,.165,.165,.8),b=new e(7,5),C=e.ZERO,w=n.ZERO,S=l.NONE,T=u.CENTER,E=p.CENTER,A=new n,x=new t,P=new t,D=new t,O=new e,I=new n,M=new e,R=new s,L=new s,N=new s,k=new a;function F(e){this.entity=e,this.label=void 0,this.index=void 0}function B(e,t){if(!d(e))throw new h("entityCluster is required.");if(!d(t))throw new h("entityCollection is required.");t.collectionChanged.addEventListener(B.prototype._onCollectionChanged,this),this._cluster=e,this._entityCollection=t,this._items=new r,this._onCollectionChanged(t,t.values,[],[])}function U(e,t,r){d(e)&&(e.label=void 0,r.removeLabel(t))}return B.prototype.update=function(e){if(!d(e))throw new h("time is required.");for(var t=this._items.values,r=this._cluster,i=0,n=t.length;i<n;i++){var o,a=t[i],s=a.entity,l=s._label,u=a.label,c=s.isShowing&&s.isAvailable(e)&&m.getValueOrDefault(l._show,e,!0);c&&(A=m.getValueOrUndefined(s._position,e,A),o=m.getValueOrUndefined(l._text,e),c=d(A)&&d(o)),c?(m.isConstant(s._position)||(r._clusterDirty=!0),d(u)||((u=r.getLabel(s)).id=s,a.label=u),u.show=!0,u.position=A,u.text=o,u.scale=m.getValueOrDefault(l._scale,e,1),u.font=m.getValueOrDefault(l._font,e,"30px sans-serif"),u.style=m.getValueOrDefault(l._style,e,g),u.fillColor=m.getValueOrDefault(l._fillColor,e,_,x),u.outlineColor=m.getValueOrDefault(l._outlineColor,e,v,P),u.outlineWidth=m.getValueOrDefault(l._outlineWidth,e,1),u.showBackground=m.getValueOrDefault(l._showBackground,e,!1),u.backgroundColor=m.getValueOrDefault(l._backgroundColor,e,y,D),u.backgroundPadding=m.getValueOrDefault(l._backgroundPadding,e,b,O),u.pixelOffset=m.getValueOrDefault(l._pixelOffset,e,C,M),u.eyeOffset=m.getValueOrDefault(l._eyeOffset,e,w,I),u.heightReference=m.getValueOrDefault(l._heightReference,e,S),u.horizontalOrigin=m.getValueOrDefault(l._horizontalOrigin,e,T),u.verticalOrigin=m.getValueOrDefault(l._verticalOrigin,e,E),u.translucencyByDistance=m.getValueOrUndefined(l._translucencyByDistance,e,R),u.pixelOffsetScaleByDistance=m.getValueOrUndefined(l._pixelOffsetScaleByDistance,e,L),u.scaleByDistance=m.getValueOrUndefined(l._scaleByDistance,e,N),u.distanceDisplayCondition=m.getValueOrUndefined(l._distanceDisplayCondition,e,k),u.disableDepthTestDistance=m.getValueOrDefault(l._disableDepthTestDistance,e,0)):U(a,s,r)}return!0},B.prototype.getBoundingSphere=function(e,t){if(!d(e))throw new h("entity is required.");if(!d(t))throw new h("result is required.");var r=this._items.get(e.id);if(!d(r)||!d(r.label))return f.FAILED;var i=r.label;return t.center=n.clone(o(i._clampedPosition,i.position),t.center),t.radius=0,f.DONE},B.prototype.isDestroyed=function(){return!1},B.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(B.prototype._onCollectionChanged,this);for(var e=this._entityCollection.values,t=0;t<e.length;t++)this._cluster.removeLabel(e[t]);return i(this)},B.prototype._onCollectionChanged=function(e,t,r,i){var n,o,a=this._items,s=this._cluster;for(n=t.length-1;-1<n;n--)o=t[n],d(o._label)&&d(o._position)&&a.set(o.id,new F(o));for(n=i.length-1;-1<n;n--)o=i[n],d(o._label)&&d(o._position)?a.contains(o.id)||a.set(o.id,new F(o)):(U(a.get(o.id),o,s),a.remove(o.id));for(n=r.length-1;-1<n;n--)o=r[n],U(a.get(o.id),o,s),a.remove(o.id)},B}),define("ThirdParty/GltfPipeline/addToArray",[],function(){"use strict";return function(e,t){return e.push(t),e.length-1}}),define("ThirdParty/GltfPipeline/ForEach",["../../Core/defined"],function(l){"use strict";var u={object:function(e,t){if(l(e))for(var r=0;r<e.length;r++){var i=t(e[r],r);if("number"==typeof i)r+=i;else if(i)break}},topLevel:function(e,t,r){var i=e[t];u.object(i,r)},accessor:function(e,t){u.topLevel(e,"accessors",t)},accessorWithSemantic:function(e,i,n){u.mesh(e,function(e){u.meshPrimitive(e,function(r){u.meshPrimitiveAttribute(r,function(e,t){0===t.indexOf(i)&&n(e,t,r)})})})},animation:function(e,t){u.topLevel(e,"animations",t)},animationSampler:function(e,t){var r=e.samplers;l(r)&&u.object(r,t)},buffer:function(e,t){u.topLevel(e,"buffers",t)},bufferView:function(e,t){u.topLevel(e,"bufferViews",t)},camera:function(e,t){u.topLevel(e,"cameras",t)},image:function(e,t){u.topLevel(e,"images",t)},material:function(e,t){u.topLevel(e,"materials",t)},materialValue:function(e,t){var r=e.values;if(l(r))for(var i in r)r.hasOwnProperty(i)&&t(r[i],i)},mesh:function(e,t){u.topLevel(e,"meshes",t)},meshPrimitive:function(e,t){var r=e.primitives;if(l(r))for(var i=r.length,n=0;n<i;n++){t(r[n],n)}},meshPrimitiveAttribute:function(e,t){var r=e.attributes;if(l(r))for(var i in r)r.hasOwnProperty(i)&&t(r[i],i)},meshPrimitiveTargetAttribute:function(e,t){var r=e.targets;if(l(r))for(var i in r)if(r.hasOwnProperty(i)){var n=r[i];for(var o in n)n.hasOwnProperty(o)&&"extras"!==o&&t(n[o],o)}},node:function(e,t){u.topLevel(e,"nodes",t)},nodeInTree:function(e,t,r){var i=e.nodes;if(l(i))for(var n=0;n<t.length;n++){var o=t[n],a=i[o];if(l(a)){r(a,o);var s=a.children;l(s)&&u.nodeInTree(e,s,r)}}},nodeInScene:function(e,t,r){var i=t.nodes;l(i)&&u.nodeInTree(e,i,r)},program:function(e,t){u.topLevel(e,"programs",t)},sampler:function(e,t){u.topLevel(e,"samplers",t)},scene:function(e,t){u.topLevel(e,"scenes",t)},shader:function(e,t){u.topLevel(e,"shaders",t)},skin:function(e,t){u.topLevel(e,"skins",t)},techniqueAttribute:function(e,t){var r=e.attributes;if(l(r))for(var i in r)if(r.hasOwnProperty(i)&&t(r[i],i))break},techniqueParameter:function(e,t){var r=e.parameters;if(l(r))for(var i in r)if(r.hasOwnProperty(i)&&t(r[i],i))break},technique:function(e,t){u.topLevel(e,"techniques",t)},texture:function(e,t){u.topLevel(e,"textures",t)}};return u}),define("ThirdParty/GltfPipeline/addDefaults",["./addToArray","./ForEach","../../Core/clone","../../Core/defaultValue","../../Core/defined","../../Core/WebGLConstants"],function(m,l,g,_,v,u){"use strict";var i={accessors:[],animations:[{channels:[],samplers:[{interpolation:"LINEAR"}]}],asset:{},buffers:[{byteLength:0,type:"arraybuffer"}],bufferViews:[{byteLength:0}],cameras:[],images:[],materials:[{values:function(e){var t=_(e.extensions,{}).KHR_materials_common;if(!v(t))return{}},extensions:function(e){var t=_(e.extensions,{}).KHR_materials_common;if(v(t)){var r=t.technique,i={ambient:[0,0,0,1],emission:[0,0,0,1],transparency:1};return"CONSTANT"!==r&&(i.diffuse=[0,0,0,1],"LAMBERT"!==r&&(i.specular=[0,0,0,1],i.shininess=0)),{KHR_materials_common:{doubleSided:!1,transparent:!1,values:i}}}}}],meshes:[{primitives:[{attributes:{},mode:u.TRIANGLES}]}],nodes:[{children:[],matrix:function(e){if(!v(e.translation)&&!v(e.rotation)&&!v(e.scale))return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},rotation:function(e){if(v(e.translation)||v(e.scale))return[0,0,0,1]},scale:function(e){if(v(e.translation)||v(e.rotation))return[1,1,1]},translation:function(e){if(v(e.rotation)||v(e.scale))return[0,0,0]}}],programs:[{attributes:[]}],samplers:[{magFilter:u.LINEAR,minFilter:u.NEAREST_MIPMAP_LINEAR,wrapS:u.REPEAT,wrapT:u.REPEAT}],scenes:[{nodes:[]}],shaders:[],skins:[{bindShapeMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}],techniques:[{parameters:{},attributes:{},uniforms:{},states:{enable:[]}}],textures:[{format:u.RGBA,internalFormat:u.RGBA,target:u.TEXTURE_2D,type:u.UNSIGNED_BYTE}],extensionsUsed:[],extensionsRequired:[]};var c={values:{emission:[.5,.5,.5,1]},extras:{_pipeline:{}}},y={attributes:{a_position:"position"},parameters:{modelViewMatrix:{semantic:"MODELVIEW",type:u.FLOAT_MAT4},projectionMatrix:{semantic:"PROJECTION",type:u.FLOAT_MAT4},emission:{type:u.FLOAT_VEC4,value:[.5,.5,.5,1]},position:{semantic:"POSITION",type:u.FLOAT_VEC3}},states:{enable:[u.CULL_FACE,u.DEPTH_TEST]},uniforms:{u_modelViewMatrix:"modelViewMatrix",u_projectionMatrix:"projectionMatrix",u_emission:"emission"}},b={attributes:["a_position"]},C={type:u.VERTEX_SHADER,extras:{_pipeline:{extension:".vert",source:"precision highp float;\n\nuniform mat4 u_modelViewMatrix;\nuniform mat4 u_projectionMatrix;\n\nattribute vec3 a_position;\n\nvoid main (void)\n{\n    gl_Position = u_projectionMatrix * u_modelViewMatrix * vec4(a_position, 1.0);\n}\n"}}},w={type:u.FRAGMENT_SHADER,extras:{_pipeline:{extension:".frag",source:"precision highp float;\n\nuniform vec4 u_emission;\n\nvoid main(void)\n{\n    gl_FragColor = u_emission;\n}\n"}}};return function(e,t){var r;return t=_(t,{}),function e(t,r){for(var i in r)if(r.hasOwnProperty(i)){var n=r[i];if("function"==typeof n&&(n=n(t)),v(n))if("object"==typeof n)if(Array.isArray(n)){var o=_(t[i],[]);if(0<n.length){var a=n[0];if("object"==typeof a)for(var s=o.length,l=0;l<s;l++)e(o[l],a);else o=_(t[i],n)}t[i]=o}else{var u=n["*"];t[i]=_(t[i],{});var c=t[i];if(v(u))for(var d in c)c.hasOwnProperty(d)&&"extras"!==d&&e(c[d],u);else e(c,n)}else t[i]=_(t[i],n)}}(e,i),function(e){for(var t,r=e.materials,i=e.meshes,n=i.length,o=0;o<n;o++)for(var a=i[o].primitives,s=a.length,l=0;l<s;l++){var u=a[l];v(u.material)||(v(t)||(t=m(r,g(c,!0))),u.material=t)}}(e),function(e){for(var t,r=e.materials,i=e.techniques,n=e.programs,o=e.shaders,a=r.length,s=0;s<a;s++){var l=r[s],u=l.technique,c=_(l.extensions,{}).KHR_materials_common;if(!v(u)){if(!v(t)&&!v(c)){var d=g(y,!0);t=m(i,d);var h=g(b,!0);d.program=m(n,h);var p=g(C,!0);h.vertexShader=m(o,p);var f=g(w,!0);h.fragmentShader=m(o,f)}l.technique=t}}}(e),function(e){for(var t=e.accessors,r=t.length,i=0;i<r;i++){var n=t[i];v(n.byteOffset)||(n.byteOffset=0)}for(var o=e.bufferViews,a=o.length,s=0;s<a;s++){var l=o[s];v(l.byteOffset)||(l.byteOffset=0)}}(e),v((r=e).scenes)&&!v(r.scene)&&(r.scene=0),function(e){var n={},o=0;if(l.bufferView(e,function(e,t){v(e.target)||(n[t]=!0,o++)}),0<o){var a=e.accessors,s=e.bufferViews;l.mesh(e,function(e){if(l.meshPrimitive(e,function(e){var t=e.indices;if(v(t)){var r=a[t].bufferView;if(n[r]){var i=s[r];v(i)&&(i.target=u.ELEMENT_ARRAY_BUFFER,n[r]=!1,o--)}}l.meshPrimitiveAttribute(e,function(e){var t=a[e].bufferView;if(n[t]){var r=s[t];v(r)&&(r.target=u.ARRAY_BUFFER,n[t]=!1,o--)}}),l.meshPrimitiveTargetAttribute(e,function(e){var t=a[e].bufferView;if(n[t]){var r=s[t];v(r)&&(r.target=u.ARRAY_BUFFER,n[t]=!1,o--)}})}),0===o)return!0})}}(e),t.optimizeForCesium&&function(e){for(var t=e.techniques,r=t.length,i=0;i<r;i++){var n=t[i].parameters;v(n.diffuse)&&(n.diffuse.semantic="_3DTILESDIFFUSE")}}(e),e}}),define("ThirdParty/GltfPipeline/addPipelineExtras",["../../Core/defaultValue","../../Core/defined"],function(c,d){"use strict";var h={attributes:!0,uniforms:!0,extensions:!0,values:!0,samplers:!0};return function(e){var t=[];for(var r in e)if(e.hasOwnProperty(r))for(var i=e[r],n=i.length,o=0;o<n;o++){var a=i[o];d(a)&&"object"==typeof a&&(a.extras=c(a.extras,{}),a.extras._pipeline=c(a.extras._pipeline,{}),t.push(a))}for(;0<t.length;){var s=t.pop();for(var l in s)if(s.hasOwnProperty(l)){var u=s[l];d(u)&&"object"==typeof u&&"extras"!==l&&(t.push(u),h[l]||Array.isArray(u)||(u.extras=c(u.extras,{}),u.extras._pipeline=c(u.extras._pipeline,{})))}}return e.extras=c(e.extras,{}),e.extras._pipeline=c(e.extras._pipeline,{}),e.asset=c(e.asset,{}),e.asset.extras=c(e.asset.extras,{}),d(e.asset.extras)&&"object"!=typeof e.asset.extras&&(e.asset.extras={extras:e.asset.extras}),e.asset.extras._pipeline=c(e.asset.extras._pipeline,{}),e}}),define("ThirdParty/GltfPipeline/byteLengthForComponentType",["../../Core/WebGLConstants"],function(t){"use strict";return function(e){switch(e){case t.BYTE:case t.UNSIGNED_BYTE:return 1;case t.SHORT:case t.UNSIGNED_SHORT:return 2;case t.FLOAT:case t.UNSIGNED_INT:return 4}}}),define("ThirdParty/GltfPipeline/numberOfComponentsForType",[],function(){"use strict";return function(e){switch(e){case"SCALAR":return 1;case"VEC2":return 2;case"VEC3":return 3;case"VEC4":case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16}}}),define("ThirdParty/GltfPipeline/getAccessorByteStride",["./byteLengthForComponentType","./numberOfComponentsForType","../../Core/defined"],function(i,n,o){"use strict";return function(e,t){var r=e.bufferViews[t.bufferView];return o(r.byteStride)&&0<r.byteStride?r.byteStride:i(t.componentType)*n(t.type)}}),define("ThirdParty/GltfPipeline/removeExtensionsRequired",["../../Core/defined"],function(n){"use strict";return function(e,t){var r=e.extensionsRequired;if(n(r)){var i=r.indexOf(t);0<=i&&r.splice(i,1),0===r.length&&delete e.extensionsRequired}}}),define("ThirdParty/GltfPipeline/removeExtensionsUsed",["./removeExtensionsRequired","../../Core/defined"],function(n,o){"use strict";return function(e,t){var r=e.extensionsUsed;if(o(r)){var i=r.indexOf(t);0<=i&&r.splice(i,1),n(e,t),0===r.length&&delete e.extensionsUsed}}}),define("ThirdParty/GltfPipeline/addExtensionsUsed",["../../Core/defined"],function(i){"use strict";return function(e,t){var r=e.extensionsUsed;i(r)||(r=[],e.extensionsUsed=r),r.indexOf(t)<0&&r.push(t)}}),define("ThirdParty/GltfPipeline/addExtensionsRequired",["./addExtensionsUsed","../../Core/defined"],function(i,n){"use strict";return function(e,t){var r=e.extensionsRequired;n(r)||(r=[],e.extensionsRequired=r),r.indexOf(t)<0&&r.push(t),i(e,t)}}),define("ThirdParty/GltfPipeline/updateVersion",["./addExtensionsRequired","./addToArray","./ForEach","./getAccessorByteStride","./numberOfComponentsForType","../../Core/Cartesian3","../../Core/Math","../../Core/clone","../../Core/ComponentDatatype","../../Core/defaultValue","../../Core/defined","../../Core/Quaternion","../../Core/WebGLConstants"],function(f,m,g,_,O,I,v,y,M,b,R,L,C){"use strict";var o={.8:function(e){R(e.asset)||(e.asset={});var t=e.asset;t.version="1.0",R(t.profile)&&"string"!=typeof t.profile||(t.profile={});R(e.version)&&delete e.version;if(w(e),function(e){var t=e.meshes;for(var r in t)if(t.hasOwnProperty(r)){var i=t[r],n=i.primitives;if(R(n))for(var o=n.length,a=0;a<o;a++){var s=n[a],l=b(s.primitive,C.TRIANGLES);s.mode=b(s.mode,l),delete s.primitive}}}(e),function(e){var t=e.nodes,r=new I,i=new L;for(var n in t)if(t.hasOwnProperty(n)){var o=t[n];if(R(o.rotation)){var a=o.rotation;I.fromArray(a,0,r),L.fromAxisAngle(r,a[3],i),o.rotation=[i.x,i.y,i.z,i.w]}var s=o.instanceSkin;R(s)&&(o.skeletons=s.skeletons,o.skin=s.skin,o.meshes=s.meshes,delete o.instanceSkin)}}(e),function(e){var t=e.animations,r=e.accessors,i=e.bufferViews,n=e.buffers,o={},a=new I,s=new L;for(var l in t)if(t.hasOwnProperty(l)){var u=t[l],c=u.channels,d=u.parameters,h=u.samplers;if(R(c))for(var p=c.length,f=0;f<p;++f){var m=c[f];if("rotation"===m.target.path){var g=d[h[m.sampler].output];if(R(o[g]))continue;o[g]=!0;for(var _=r[g],v=i[_.bufferView],y=n[v.buffer],b=y.extras._pipeline.source,C=b.byteOffset+v.byteOffset+_.byteOffset,w=_.componentType,S=_.count,T=O(_.type),E=_.count*T,A=M.createArrayBufferView(w,b.buffer,C,E),x=0;x<S;x++){var P=x*T;I.unpack(A,P,a);var D=A[P+3];L.fromAxisAngle(a,D,s),L.pack(s,A,P)}}}}}(e),function(e){var t=e.techniques;for(var r in t)if(t.hasOwnProperty(r)){var i=t[r],n=i.passes;if(R(n)){var o=b(i.pass,"defaultPass");if(n.hasOwnProperty(o)){var a=n[o],s=a.instanceProgram;i.attributes=b(i.attributes,s.attributes),i.program=b(i.program,s.program),i.uniforms=b(i.uniforms,s.uniforms),i.states=b(i.states,a.states)}delete i.passes,delete i.pass}}}(e),R(e.lights)){var r=b(e.extensions,{});e.extensions=r;var i=b(r.KHR_materials_common,{});(r.KHR_materials_common=i).lights=e.lights,delete e.lights}R(e.allExtensions)&&(e.extensionsUsed=e.allExtensions,e.allExtensions=void 0)},"1.0":function(e){R(e.asset)||(e.asset={});e.asset.version="2.0",w(e),function(e){var t=e.animations;for(var r in t)if(t.hasOwnProperty(r)){var i=t[r],n=i.parameters;if(R(n)){var o=i.samplers;for(var a in o)if(o.hasOwnProperty(a)){var s=o[a];s.input=n[s.input],s.output=n[s.output]}delete i.parameters}}}(e),function(c){var d,e,h={accessors:{},animations:{},bufferViews:{},buffers:{},cameras:{},materials:{},meshes:{},nodes:{},programs:{},shaders:{},skins:{},techniques:{}},i={},t=c.nodes;for(var r in t)t.hasOwnProperty(r)&&(e=t[r].jointName,R(e)&&(i[e]=r));for(var n in c)if(c.hasOwnProperty(n)&&"extras"!==n&&"asset"!==n&&"extensions"!==n){var o={},a=c[n];"object"!=typeof a||Array.isArray(a)||(c[n]=S(a,o),h[n]=o,"animations"===n&&(o={},a.samplers=S(a.samplers,o),h[n].samplers=o))}for(e in i)i.hasOwnProperty(e)&&(i[e]=h.nodes[i[e]]);R(c.scene)&&(c.scene=h.scenes[c.scene]);g.bufferView(c,function(e){R(e.buffer)&&(e.buffer=h.buffers[e.buffer])}),g.accessor(c,function(e){R(e.bufferView)&&(e.bufferView=h.bufferViews[e.bufferView])}),g.shader(c,function(e){var t=e.extensions;if(R(t)){var r=t.KHR_binary_glTF;R(r)&&(e.bufferView=h.bufferViews[r.bufferView],delete t.KHR_binary_glTF),0===Object.keys(t).length&&delete e.extensions}}),g.program(c,function(e){R(e.vertexShader)&&(e.vertexShader=h.shaders[e.vertexShader]),R(e.fragmentShader)&&(e.fragmentShader=h.shaders[e.fragmentShader])}),g.technique(c,function(e){R(e.program)&&(e.program=h.programs[e.program]),g.techniqueParameter(e,function(e){R(e.node)&&(e.node=h.nodes[e.node]);var t=e.value;if(R(t))if(Array.isArray(t)){if(1===t.length){var r=t[0];"string"==typeof r&&(t[0]=h.textures[r])}}else"string"==typeof t&&(e.value=[h.textures[t]])})}),g.mesh(c,function(e){g.meshPrimitive(e,function(r){R(r.indices)&&(r.indices=h.accessors[r.indices]),g.meshPrimitiveAttribute(r,function(e,t){r.attributes[t]=h.accessors[e]}),R(r.material)&&(r.material=h.materials[r.material])})}),g.node(c,function(e){var t=e.children;if(R(t)){var r=t.length;for(d=0;d<r;d++)t[d]=h.nodes[t[d]]}if(R(e.meshes)){var i=e.meshes,n=i.length;if(0<n)for(e.mesh=h.meshes[i[0]],d=1;d<n;d++){var o={mesh:h.meshes[i[d]],extras:{_pipeline:{}}},a=m(c.nodes,o);R(t)||(t=[],e.children=t),t.push(a)}delete e.meshes}if(R(e.camera)&&(e.camera=h.cameras[e.camera]),R(e.skeletons)){var s=e.skeletons,l=s.length;if(0<l&&R(e.skin)){var u=c.skins[h.skins[e.skin]];u.skeleton=h.nodes[s[0]]}delete e.skeletons}R(e.skin)&&(e.skin=h.skins[e.skin]),R(e.jointName)&&delete e.jointName}),g.skin(c,function(e){R(e.inverseBindMatrices)&&(e.inverseBindMatrices=h.accessors[e.inverseBindMatrices]);var t=[],r=e.jointNames;if(R(r)){for(d=0;d<r.length;d++)t[d]=i[r[d]];e.joints=t,delete e.jointNames}}),g.scene(c,function(e){var t=e.nodes;if(R(t)){var r=t.length;for(d=0;d<r;d++)t[d]=h.nodes[t[d]]}}),g.animation(c,function(e){var t={};e.samplers=S(e.samplers,t),g.animationSampler(e,function(e){e.input=h.accessors[e.input],e.output=h.accessors[e.output]});var r=e.channels;if(R(r)){var i=r.length;for(d=0;d<i;d++){var n=r[d];n.sampler=t[n.sampler];var o=n.target;R(o)&&(o.node=h.nodes[o.id],delete o.id)}}}),g.material(c,function(i){R(i.technique)&&(i.technique=h.techniques[i.technique]),g.materialValue(i,function(e,t){if(Array.isArray(e)){if(1===e.length){var r=e[0];"string"==typeof r&&(e[0]=h.textures[r])}}else"string"==typeof e&&(i.values[t]={index:h.textures[e]})});var e=i.extensions;if(R(e)){var n=e.KHR_materials_common;R(n)&&g.materialValue(n,function(e,t){if(Array.isArray(e)){if(1===e.length){var r=e[0];"string"==typeof r&&(e[0]=h.textures[r])}}else"string"==typeof e&&(n.values[t]={index:h.textures[e]})})}}),g.image(c,function(e){var t=e.extensions;if(R(t)){var r=t.KHR_binary_glTF;R(r)&&(e.bufferView=h.bufferViews[r.bufferView],e.mimeType=r.mimeType,delete t.KHR_binary_glTF),0===Object.keys(t).length&&delete e.extensions}if(R(e.extras)){var i=e.extras.compressedImage3DTiles;for(var n in i)if(i.hasOwnProperty(n)){var o=i[n],a=o.extensions;if(R(a)){var s=a.KHR_binary_glTF;R(s)&&(o.bufferView=h.bufferViews[s.bufferView],o.mimeType=s.mimeType,delete a.KHR_binary_glTF),0===Object.keys(a).length&&delete o.extensions}}}}),g.texture(c,function(e){R(e.sampler)&&(e.sampler=h.samplers[e.sampler]),R(e.source)&&(e.source=h.images[e.source])})}(e),p=e,delete p.asset.profile,function(e){var t=e.extensionsUsed;if(e.extensionsRequired=b(e.extensionsRequired,[]),R(t))for(var r=t.length,i=0;i<r;i++){var n=t[i];R(T[n])&&e.extensionsRequired.push(n)}}(e),h=e,g.buffer(h,function(e){R(e.byteLength)||(e.byteLength=e.extras._pipeline.source.length)}),g.bufferView(h,function(e){if(!R(e.byteLength)){var t=e.buffer,r=h.buffers[t];e.byteLength=r.byteLength}}),function(n){var o=n.bufferViews,a={};g.accessor(n,function(e){var t=e.bufferView;if(R(t)){R(a[t])||(a[t]=!0);var r=y(o[t]),i=R(e.byteStride)&&0!==e.byteStride?e.byteStride:_(n,e);R(i)&&(r.byteStride=i,0!==r.byteStride&&(r.byteLength=e.count*i),r.byteOffset+=e.byteOffset,e.byteOffset=0,delete e.byteStride),e.bufferView=m(o,r)}});var s={},r=0;g.bufferView(n,function(e,t){R(a[t])?r++:s[t]=t-r});var e=0;for(var t in a)if(R(t)){var i=parseInt(t)-e;o.splice(i,1),e++}g.accessor(n,function(e){var t=e.bufferView;R(t)&&(e.bufferView=s[t])}),g.shader(n,function(e){var t=e.bufferView;R(t)&&(e.bufferView=s[t])}),g.image(n,function(e){var t=e.bufferView;if(R(t)&&(e.bufferView=s[t]),R(e.extras)){var r=e.extras.compressedImage3DTiles;for(var i in r)if(r.hasOwnProperty(i)){var n=r[i],o=n.bufferView;R(o)&&(n.bufferView=s[o])}}})}(e),d=e,g.buffer(d,function(e){delete e.type}),c=e,g.mesh(c,function(e){g.meshPrimitive(e,function(r){g.meshPrimitiveAttribute(r,function(e,t){"TEXCOORD"===t?r.attributes.TEXCOORD_0=e:"COLOR"===t&&(r.attributes.COLOR_0=e)}),delete r.attributes.TEXCOORD,delete r.attributes.COLOR})}),g.technique(c,function(e){g.techniqueParameter(e,function(e){var t=e.semantic;R(t)&&("TEXCOORD"===t?e.semantic="TEXCOORD_0":"COLOR"===t&&(e.semantic="COLOR_0"))})}),l=e,u={},g.mesh(l,function(e){g.meshPrimitive(e,function(e){for(var t in g.meshPrimitiveAttribute(e,function(e,t){if("_"!==t.charAt(0)){var r=t.search(/_[0-9]+/g),i=t;if(0<=r&&(i=t.substring(0,r)),!R(E[i])){var n="_"+t;u[t]=n}}}),u)if(u.hasOwnProperty(t)){var r=u[t],i=e.attributes[t];R(i)&&(delete e.attributes[t],e.attributes[r]=i)}})}),g.technique(l,function(e){g.techniqueParameter(e,function(e){var t=u[e.semantic];R(t)&&(e.semantic=t)})}),s=e,g.technique(s,function(e){var t=e.states;if(R(t)){var r=t.functions;R(r)&&delete r.scissor;var i=t.enable;if(R(i)){var n=i.indexOf(C.SCISSOR_TEST);0<=n&&i.splice(n,1)}}}),a=e,g.technique(a,function(e){var t=e.states;if(R(t)){var r=t.functions;if(R(r)){var i=r.blendColor;if(R(i))for(var n=0;n<4;n++)i[n]=v.clamp(i[n],0,1);var o=r.depthRange;R(o)&&(o[1]=v.clamp(o[1],0,1),o[0]=v.clamp(o[0],0,o[1]))}}}),o=e,g.camera(o,function(e){var t=e.perspective;if(R(t)){var r=t.aspectRatio;R(r)&&0===r&&delete t.aspectRatio;var i=t.yfov;R(i)&&0===i&&(t.yfov=1)}}),n=e,g.technique(n,function(r){g.techniqueAttribute(r,function(e){var t=r.parameters[e];R(t.value)&&delete t.value})}),i=e,g.technique(i,function(e){g.techniqueParameter(e,function(e){if(R(e.count)){var t=e.semantic;(!R(t)||"JOINTMATRIX"!==t&&0!==t.indexOf("_"))&&delete e.count}})}),t=e,r=t.techniques,R(r)&&0<r.length&&f(t,"KHR_technique_webgl");var t,r;var i;var n;var o;var a;var s;var l,u;var c;var d;var h;var p},"2.0":void 0};function w(e){var t=e.materials;for(var r in t)if(t.hasOwnProperty(r)){var i=t[r],n=i.instanceTechnique;R(n)&&(i.technique=n.technique,i.values=n.values,delete i.instanceTechnique)}}function S(e,t){var r=[];for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];t[i]=r.length,r.push(n),R(n.name)||"object"!=typeof n||(n.name=i)}return r}var T={CESIUM_RTC:!0,KHR_materials_common:!0,WEB3D_quantized_attributes:!0};var E={POSITION:!0,NORMAL:!0,TEXCOORD:!0,COLOR:!0,JOINT:!0,WEIGHT:!0};return function(e,t){var r=(t=b(t,{})).targetVersion,i=e.version;e.asset=b(e.asset,{version:"1.0"}),i=b(i,e.asset.version),o.hasOwnProperty(i)||(R(i)&&(i=(""+i).substring(0,3)),o.hasOwnProperty(i)||(i="1.0"));for(var n=o[i];R(n)&&i!==r;)n(e),i=e.asset.version,n=o[i];return e}}),define("ThirdParty/GltfPipeline/parseBinaryGltf",["./addPipelineExtras","./removeExtensionsUsed","./updateVersion","../../Core/ComponentDatatype","../../Core/defined","../../Core/DeveloperError","../../Core/getMagic","../../Core/getStringFromTypedArray","../../Core/WebGLConstants"],function(v,y,b,C,w,S,T,E,A){"use strict";return function(e){var t=C.createArrayBufferView(A.INT,e.buffer,e.byteOffset,5);if("glTF"!==T(e))throw new S("File is not valid binary glTF");var r,i,n,o=t[1];if(1!==o&&2!==o)throw new S("Binary glTF version is not 1 or 2");if(1===o){n=t[2];var a=t[3];if(0!==t[4])throw new S("Binary glTF scene format is not JSON");var s=20+a,l=E(e,20,a);r=JSON.parse(l);var u=e.subarray(s,n);if(i=r.buffers,w(i)&&0<Object.keys(i).length){var c=i.binary_glTF;w(c)||(c=i.KHR_binary_glTF),w(c)&&(c.extras={_pipeline:{source:u}})}b(r),y(r,"KHR_binary_glTF"),v(r)}if(2===o){n=t[2];for(var d,h=12;h<n;){var p=C.createArrayBufferView(A.INT,e.buffer,e.byteOffset+h,2),f=p[0],m=p[1];h+=8;var g=e.subarray(h,h+f);if(h+=f,1313821514===m){var _=E(g);r=JSON.parse(_),v(r)}else 5130562===m&&(d=g)}w(r)&&w(d)&&(i=r.buffers,w(i)&&0<i.length&&(i[0].extras._pipeline.source=d))}return r}}),define("ThirdParty/GltfPipeline/techniqueParameterForSemantic",["../../Core/defined"],function(o){"use strict";return function(e,t){var r=e.parameters;for(var i in r)if(r.hasOwnProperty(i)){var n=r[i].semantic;if(o(n)&&n===t)return i}}}),define("ThirdParty/GltfPipeline/webGLConstantToGlslType",["../../Core/WebGLConstants"],function(t){"use strict";return function(e){switch(e){case t.FLOAT:return"float";case t.FLOAT_VEC2:return"vec2";case t.FLOAT_VEC3:return"vec3";case t.FLOAT_VEC4:return"vec4";case t.FLOAT_MAT2:return"mat2";case t.FLOAT_MAT3:return"mat3";case t.FLOAT_MAT4:return"mat4";case t.SAMPLER_2D:return"sampler2D";case t.BOOL:return"bool"}}}),define("ThirdParty/GltfPipeline/glslTypeToWebGLConstant",["../../Core/WebGLConstants"],function(t){"use strict";return function(e){switch(e){case"float":return t.FLOAT;case"vec2":return t.FLOAT_VEC2;case"vec3":return t.FLOAT_VEC3;case"vec4":return t.FLOAT_VEC4;case"mat2":return t.FLOAT_MAT2;case"mat3":return t.FLOAT_MAT3;case"mat4":return t.FLOAT_MAT4;case"sampler2D":return t.SAMPLER_2D}}}),define("ThirdParty/GltfPipeline/processModelMaterialsCommon",["./addToArray","./ForEach","./numberOfComponentsForType","./techniqueParameterForSemantic","./webGLConstantToGlslType","./glslTypeToWebGLConstant","../../Core/clone","../../Core/defined","../../Core/defaultValue","../../Core/WebGLConstants"],function(oe,a,ae,y,se,le,f,ue,ce,de){"use strict";function he(e,t){var r;switch(r=ue(t.value)?t.value:ue(t.index)?[t.index]:t,e){case"ambient":case"diffuse":case"emission":case"specular":return 1===r.length?de.SAMPLER_2D:de.FLOAT_VEC4;case"shininess":case"transparency":return de.FLOAT;case"transparent":case"doubleSided":return de.BOOL}}function pe(e){return"SCALAR"===e?"float":e.toLowerCase()}return function(s,l){if(l=ce(l,{}),ue(s)){var t,e,h,p,r=!1,i=s.extensionsRequired,n=s.extensionsUsed;if(ue(n)){var o=n.indexOf("KHR_materials_common");0<=o&&(n.splice(o,1),r=!0),ue(i)&&0<=(o=i.indexOf("KHR_materials_common"))&&i.splice(o,1)}if(r){ue(s.programs)||(s.programs=[]),ue(s.shaders)||(s.shaders=[]),ue(s.techniques)||(s.techniques=[]),function(e){ue(e.extensions)||(e.extensions={});var t=e.extensions;ue(t.KHR_materials_common)||(t.KHR_materials_common={});var r=t.KHR_materials_common;ue(r.lights)||(r.lights={});for(var i=r.lights,n=i.length,o=0;o<n;o++){var a=i[o];if("ambient"===a.type){ue(a.ambient)||(a.ambient={});var s=a.ambient;ue(s.color)||(s.color=[1,1,1])}else if("directional"===a.type){ue(a.directional)||(a.directional={});var l=a.directional;ue(l.color)||(l.color=[1,1,1])}else if("point"===a.type){ue(a.point)||(a.point={});var u=a.point;ue(u.color)||(u.color=[1,1,1]),u.constantAttenuation=ce(u.constantAttenuation,1),u.linearAttenuation=ce(u.linearAttenuation,0),u.quadraticAttenuation=ce(u.quadraticAttenuation,0)}else if("spot"===a.type){ue(a.spot)||(a.spot={});var c=a.spot;ue(c.color)||(c.color=[1,1,1]),c.constantAttenuation=ce(c.constantAttenuation,1),c.fallOffAngle=ce(c.fallOffAngle,3.14159265),c.fallOffExponent=ce(c.fallOffExponent,0),c.linearAttenuation=ce(c.linearAttenuation,0),c.quadraticAttenuation=ce(c.quadraticAttenuation,0)}}}(s);var u=function(e){var t,r={};if(ue(e.extensions)&&ue(e.extensions.KHR_materials_common)&&(t=e.extensions.KHR_materials_common.lights),ue(t)){var i=e.nodes;for(var n in i)if(i.hasOwnProperty(n)){var o=i[n];if(ue(o.extensions)&&ue(o.extensions.KHR_materials_common)){var a=o.extensions.KHR_materials_common.light;ue(a)&&ue(t[a])&&(t[a].node=n),delete o.extensions.KHR_materials_common}}var s=0;for(var l in t)if(t.hasOwnProperty(l)){var u=t[l],c=u.type;if("ambient"!==c&&!ue(u.node)){delete t[l];continue}var d="light"+s.toString();switch(u.baseName=d,c){case"ambient":var h=u.ambient;r[d+"Color"]={type:de.FLOAT_VEC3,value:h.color};break;case"directional":var p=u.directional;r[d+"Color"]={type:de.FLOAT_VEC3,value:p.color},ue(u.node)&&(r[d+"Transform"]={node:u.node,semantic:"MODELVIEW",type:de.FLOAT_MAT4});break;case"point":var f=u.point;r[d+"Color"]={type:de.FLOAT_VEC3,value:f.color},ue(u.node)&&(r[d+"Transform"]={node:u.node,semantic:"MODELVIEW",type:de.FLOAT_MAT4}),r[d+"Attenuation"]={type:de.FLOAT_VEC3,value:[f.constantAttenuation,f.linearAttenuation,f.quadraticAttenuation]};break;case"spot":var m=u.spot;r[d+"Color"]={type:de.FLOAT_VEC3,value:m.color},ue(u.node)&&(r[d+"Transform"]={node:u.node,semantic:"MODELVIEW",type:de.FLOAT_MAT4},r[d+"InverseTransform"]={node:u.node,semantic:"MODELVIEWINVERSE",type:de.FLOAT_MAT4,useInFragment:!0}),r[d+"Attenuation"]={type:de.FLOAT_VEC3,value:[m.constantAttenuation,m.linearAttenuation,m.quadraticAttenuation]},r[d+"FallOff"]={type:de.FLOAT_VEC2,value:[m.fallOffAngle,m.fallOffExponent]}}++s}}return r}(s);h=(e=s).accessors,p=e.materials,a.mesh(e,function(e){a.meshPrimitive(e,function(e){var t=e.material,r=p[t];if(ue(r.extensions)&&ue(r.extensions.KHR_materials_common)){var i,n,o=r.extensions.KHR_materials_common,a=e.attributes.JOINT;if(ue(a)){var s=h[a];i=s.componentType,n=s.type}var l=ue(a),u=ue(e.attributes.COLOR_0),c=o.extras._pipeline.primitive;if(ue(c)){if(c.skinning.skinned!==l||c.skinning.type!==n||c.hasVertexColors!==u){var d=f(r,!0);d.extensions.KHR_materials_common.extras._pipeline.primitive={skinning:{skinned:l,componentType:i,type:n},hasVertexColors:u},t=oe(p,d),e.material=t}}else o.extras._pipeline.primitive={skinning:{skinned:l,componentType:i,type:n},hasVertexColors:u}}})});var c={};a.material(s,function(e){if(ue(e.extensions)&&ue(e.extensions.KHR_materials_common)){var t=e.extensions.KHR_materials_common,r=function(e){var t="";t+="technique:"+e.technique+";";for(var r=e.values,i=Object.keys(r).sort(),n=i.length,o=0;o<n;++o){var a=i[o];r.hasOwnProperty(a)&&(t+=a+":"+he(a,r[a]),t+=";")}var s=ce(e.doubleSided,ce(e.values.doubleSided,!1));t+=s.toString()+";";var l=ce(e.transparent,ce(e.values.transparent,!1));t+=l.toString()+";";var u=ce(e.jointCount,0);t+=u.toString()+";";var c=e.extras._pipeline.primitive,d=c.skinning;return 0<u&&(t+=d.type+";"),t+=c.hasVertexColors}(t),i=c[r];ue(i)||(i=function(e,t,r,i){var n,o=ce(i.optimizeForCesium,!1),a=ue(e.extensions)&&ue(e.extensions.CESIUM_RTC),s=ce(i.addBatchIdToGeneratedShaders,!1),l=e.techniques,u=e.shaders,c=e.programs,d=t.technique.toUpperCase();ue(e.extensions)&&ue(e.extensions.KHR_materials_common)&&(n=e.extensions.KHR_materials_common.lights);var h=t.values;ue(t.transparent)&&(h.transparent=t.transparent),ue(t.doubleSided)&&(h.doubleSided=t.doubleSided);var p,f=ce(t.jointCount,0),m=0<f,g=t.extras._pipeline.primitive,_=g.skinning,v=g.hasVertexColors,y="precision highp float;\n",b="precision highp float;\n",C="CONSTANT"!==d,w={modelViewMatrix:{semantic:a?"CESIUM_RTC_MODELVIEW":"MODELVIEW",type:de.FLOAT_MAT4},projectionMatrix:{semantic:"PROJECTION",type:de.FLOAT_MAT4}};C&&(w.normalMatrix={semantic:"MODELVIEWINVERSETRANSPOSE",type:de.FLOAT_MAT3}),m&&(w.jointMatrix={count:f,semantic:"JOINTMATRIX",type:de.FLOAT_MAT4});var S=!1;for(var T in h)if(h.hasOwnProperty(T)&&"transparent"!==T&&"doubleSided"!==T){var E=he(T,h[T]);p=T.toLowerCase(),S||E!==de.SAMPLER_2D||(S=!0),w[p]={type:E}}if(ue(w.diffuse)&&o&&(w.diffuse.semantic="_3DTILESDIFFUSE"),ue(r))for(var A in r)r.hasOwnProperty(A)&&(w[A]=r[A]);var x={};for(var P in w)if(w.hasOwnProperty(P)&&"extras"!==P){var D=w[P];x["u_"+P]=P;var O=ue(D.count)?"["+D.count+"]":"";D.type!==de.FLOAT_MAT3&&D.type!==de.FLOAT_MAT4||D.useInFragment?(b+="uniform "+se(D.type)+" u_"+P+O+";\n",delete D.useInFragment):y+="uniform "+se(D.type)+" u_"+P+O+";\n"}var I="";if(m){var M,R,L=ae(_.type),N=!1;if(0===_.type.indexOf("MAT")&&(N=!0,L=Math.sqrt(L)),N)for(M=0;M<L;M++)for(R=0;R<L;R++)I+=0===M&&0===R?"  mat4 skinMat = ":"  skinMat += ",I+="a_weight["+M+"]["+R+"] * u_jointMatrix[int(a_joint["+M+"]["+R+"])];\n";else for(M=0;M<L;M++)I+=0===M?"  mat4 skinMat = ":"  skinMat += ",I+="a_weight["+M+"] * u_jointMatrix[int(a_joint["+M+"])];\n"}var k,F={a_position:"position"};if(w.position={semantic:"POSITION",type:de.FLOAT_VEC3},y+="attribute vec3 a_position;\n",y+="varying vec3 v_positionEC;\n",I+=m?"  vec4 pos = u_modelViewMatrix * skinMat * vec4(a_position,1.0);\n":"  vec4 pos = u_modelViewMatrix * vec4(a_position,1.0);\n",I+="  v_positionEC = pos.xyz;\n",I+="  gl_Position = u_projectionMatrix * pos;\n",b+="varying vec3 v_positionEC;\n",C&&(F.a_normal="normal",w.normal={semantic:"NORMAL",type:de.FLOAT_VEC3},y+="attribute vec3 a_normal;\n",y+="varying vec3 v_normal;\n",I+=m?"  v_normal = u_normalMatrix * mat3(skinMat) * a_normal;\n":"  v_normal = u_normalMatrix * a_normal;\n",b+="varying vec3 v_normal;\n"),S&&(F.a_texcoord_0="texcoord_0",w.texcoord_0={semantic:"TEXCOORD_0",type:de.FLOAT_VEC2},y+="attribute vec2 a_texcoord_0;\n",y+="varying vec2 "+(k="v_texcoord_0")+";\n",I+="  "+k+" = a_texcoord_0;\n",b+="varying vec2 "+k+";\n"),m){F.a_joint="joint";var B=pe(_.type),U=le(B);w.joint={semantic:"JOINT",type:U},F.a_weight="weight",w.weight={semantic:"WEIGHT",type:U},y+="attribute "+B+" a_joint;\n",y+="attribute "+B+" a_weight;\n"}v&&(F.a_vertexColor="vertexColor",w.vertexColor={semantic:"COLOR_0",type:de.FLOAT_VEC4},y+="attribute vec4 a_vertexColor;\n",y+="varying vec4 v_vertexColor;\n",I+="  v_vertexColor = a_vertexColor;\n",b+="varying vec4 v_vertexColor;\n"),s&&(F.a_batchId="batchId",w.batchId={semantic:"_BATCHID",type:de.FLOAT},y+="attribute float a_batchId;\n");var V=C&&("BLINN"===d||"PHONG"===d)&&ue(w.specular)&&ue(w.shininess)&&0<w.shininess,z=!1,q=!1,G="";for(var W in n)if(n.hasOwnProperty(W)){var H=n[W],j=H.type.toLowerCase(),Y=H.baseName;G+="  {\n";var X,Q,Z="u_"+Y+"Color";"ambient"===j?(q=!0,G+="    ambientLight += "+Z+";\n"):C&&(z=!0,X="v_"+Y+"Direction",Q="v_"+Y+"Position","point"!==j&&(y+="varying vec3 "+X+";\n",b+="varying vec3 "+X+";\n",I+="  "+X+" = mat3(u_"+Y+"Transform) * vec3(0.,0.,1.);\n","directional"===j&&(G+="    vec3 l = normalize("+X+");\n")),"directional"!==j?(y+="varying vec3 "+Q+";\n",b+="varying vec3 "+Q+";\n",I+="  "+Q+" = u_"+Y+"Transform[3].xyz;\n",G+="    vec3 VP = "+Q+" - v_positionEC;\n",G+="    vec3 l = normalize(VP);\n",G+="    float range = length(VP);\n",G+="    float attenuation = 1.0 / (u_"+Y+"Attenuation.x + ",G+="(u_"+Y+"Attenuation.y * range) + ",G+="(u_"+Y+"Attenuation.z * range * range));\n"):G+="    float attenuation = 1.0;\n","spot"===j&&(G+="    float spotDot = dot(l, normalize("+X+"));\n",G+="    if (spotDot < cos(u_"+Y+"FallOff.x * 0.5))\n",G+="    {\n",G+="      attenuation = 0.0;\n",G+="    }\n",G+="    else\n",G+="    {\n",G+="        attenuation *= max(0.0, pow(spotDot, u_"+Y+"FallOff.y));\n",G+="    }\n"),G+="    diffuseLight += "+Z+"* max(dot(normal,l), 0.) * attenuation;\n",V&&("BLINN"===d?(G+="    vec3 h = normalize(l + viewDir);\n",G+="    float specularIntensity = max(0., pow(max(dot(normal, h), 0.), u_shininess)) * attenuation;\n"):(G+="    vec3 reflectDir = reflect(-l, normal);\n",G+="    float specularIntensity = max(0., pow(max(dot(reflectDir, viewDir), 0.), u_shininess)) * attenuation;\n"),G+="    specularLight += "+Z+" * specularIntensity;\n")),G+="  }\n"}if(q||(G+="  ambientLight += vec3(0.2, 0.2, 0.2);\n"),!z&&"CONSTANT"!==d){G+=o?"  vec3 l = normalize(czm_sunDirectionEC);\n":"  vec3 l = vec3(0.0, 0.0, 1.0);\n";var K=o?"0.2":"0.0";G+="  diffuseLight += vec3(1.0, 1.0, 1.0) * max(dot(normal,l), "+K+");\n",V&&("BLINN"===d?(G+="  vec3 h = normalize(l + viewDir);\n",G+="  float specularIntensity = max(0., pow(max(dot(normal, h), 0.), u_shininess));\n"):(G+="  vec3 reflectDir = reflect(-l, normal);\n",G+="  float specularIntensity = max(0., pow(max(dot(reflectDir, viewDir), 0.), u_shininess));\n"),G+="  specularLight += vec3(1.0, 1.0, 1.0) * specularIntensity;\n")}y+="void main(void) {\n",y+=I,y+="}\n",b+="void main(void) {\n";var J,$,ee="  vec3 color = vec3(0.0, 0.0, 0.0);\n";C&&(b+="  vec3 normal = normalize(v_normal);\n",t.doubleSided&&(b+="  if (gl_FrontFacing == false)\n",b+="  {\n",b+="    normal = -normal;\n",b+="  }\n")),J="CONSTANT"!==d?(ue(w.diffuse)&&(w.diffuse.type===de.SAMPLER_2D?b+="  vec4 diffuse = texture2D(u_diffuse, "+k+");\n":b+="  vec4 diffuse = u_diffuse;\n",b+="  vec3 diffuseLight = vec3(0.0, 0.0, 0.0);\n",ee+="  color += diffuse.rgb * diffuseLight;\n"),V&&(w.specular.type===de.SAMPLER_2D?b+="  vec3 specular = texture2D(u_specular, "+k+").rgb;\n":b+="  vec3 specular = u_specular.rgb;\n",b+="  vec3 specularLight = vec3(0.0, 0.0, 0.0);\n",ee+="  color += specular * specularLight;\n"),ue(w.transparency)?"  gl_FragColor = vec4(color * diffuse.a * u_transparency, diffuse.a * u_transparency);\n":"  gl_FragColor = vec4(color * diffuse.a, diffuse.a);\n"):ue(w.transparency)?"  gl_FragColor = vec4(color * u_transparency, u_transparency);\n":"  gl_FragColor = vec4(color, 1.0);\n",v&&(ee+="  color *= v_vertexColor.rgb;\n"),ue(w.emission)&&(w.emission.type===de.SAMPLER_2D?b+="  vec3 emission = texture2D(u_emission, "+k+").rgb;\n":b+="  vec3 emission = u_emission.rgb;\n",ee+="  color += emission;\n"),(ue(w.ambient)||"CONSTANT"!==d)&&(ue(w.ambient)?w.ambient.type===de.SAMPLER_2D?b+="  vec3 ambient = texture2D(u_ambient, "+k+").rgb;\n":b+="  vec3 ambient = u_ambient.rgb;\n":b+="  vec3 ambient = diffuse.rgb;\n",ee+="  color += ambient * ambientLight;\n"),b+="  vec3 viewDir = -normalize(v_positionEC);\n",b+="  vec3 ambientLight = vec3(0.0, 0.0, 0.0);\n",b+=G,b+=ee,b+=J,b+="}\n",$=h.transparent?{enable:[de.DEPTH_TEST,de.BLEND],functions:{depthMask:[!1],blendEquationSeparate:[de.FUNC_ADD,de.FUNC_ADD],blendFuncSeparate:[de.ONE,de.ONE_MINUS_SRC_ALPHA,de.ONE,de.ONE_MINUS_SRC_ALPHA]}}:t.doubleSided?{enable:[de.DEPTH_TEST]}:{enable:[de.CULL_FACE,de.DEPTH_TEST]};var te=oe(u,{type:de.VERTEX_SHADER,extras:{_pipeline:{source:y,extension:".glsl"}}}),re=oe(u,{type:de.FRAGMENT_SHADER,extras:{_pipeline:{source:b,extension:".glsl"}}}),ie=Object.keys(F),ne=oe(c,{attributes:ie,fragmentShader:re,vertexShader:te});return oe(l,{attributes:F,parameters:w,program:ne,states:$,uniforms:x})}(s,t,u,l),c[r]=i),e.values={};var n=t.values;for(var o in n)if(n.hasOwnProperty(o)){var a=n[o];e.values[o]=a}e.technique=i,delete e.extensions.KHR_materials_common,0===Object.keys(e.extensions).length&&delete e.extensions}}),ue(s.extensions)&&(delete s.extensions.KHR_materials_common,0===Object.keys(s.extensions).length&&delete s.extensions),t=s,a.mesh(t,function(e){a.meshPrimitive(e,function(e){!function(e,t){var r=e.accessors,i=e.materials,n=e.techniques,o=e.programs,a=e.shaders,s=t.attributes,l=i[t.material],u=n[l.technique],c=o[u.program],d=a[c.vertexShader];for(var h in s)if(s.hasOwnProperty(h)&&!ue(y(u,h))){var p=s[h],f=r[p],m=h.toLowerCase();"_"===m.charAt(0)&&(m=m.slice(1));var g="a_"+m;u.parameters[m]={semantic:h,type:f.componentType},u.attributes[g]=m,c.attributes.push(g);var _=d.extras._pipeline,v=_.source;v="attribute "+pe(f.type)+" "+g+";\n"+v,_.source=v}}(t,e)})})}return s}}}),define("ThirdParty/GltfPipeline/processPbrMetallicRoughness",["./addToArray","./ForEach","./numberOfComponentsForType","./techniqueParameterForSemantic","./webGLConstantToGlslType","./glslTypeToWebGLConstant","../../Core/clone","../../Core/defined","../../Core/defaultValue","../../Core/WebGLConstants"],function(Z,K,J,S,$,ee,p,te,re,ie){"use strict";function ne(e){switch(e){case"baseColorFactor":return ie.FLOAT_VEC4;case"metallicFactor":case"roughnessFactor":return ie.FLOAT;case"baseColorTexture":case"metallicRoughnessTexture":case"normalTexture":case"occlusionTexture":case"emissiveTexture":return ie.SAMPLER_2D;case"emissiveFactor":return ie.FLOAT_VEC3;case"doubleSided":return ie.BOOL}}function oe(e){return"SCALAR"===e?"float":e.toLowerCase()}return function(i,n){n=re(n,{});var t,e,d,h,r=!1;return K.material(i,function(e){te(e.pbrMetallicRoughness)&&(r=!0)}),r&&(te(i.programs)||(i.programs=[]),te(i.shaders)||(i.shaders=[]),te(i.techniques)||(i.techniques=[]),d=(e=i).accessors,h=e.materials,K.mesh(e,function(e){K.meshPrimitive(e,function(e){var t,r,i=e.material,n=h[i],o=e.attributes.JOINTS_0;if(te(o)){var a=d[o];t=a.componentType,r=a.type}var s=te(o),l=te(e.attributes.COLOR_0),u=n.extras._pipeline.primitive;if(te(u)){if(u.skinning.skinned!==s||u.skinning.type!==r||u.hasVertexColors!==l){var c=p(n,!0);c.extras._pipeline.skinning={skinning:{skinned:s,componentType:t,type:r},hasVertexColors:l},i=Z(h,c),e.material=i}}else n.extras._pipeline.primitive={skinning:{skinned:s,componentType:t,type:r},hasVertexColors:l}})}),K.material(i,function(e){var t=e.pbrMetallicRoughness;if(te(t)){var r=function(e,t,r){var i=re(r.optimizeForCesium,!1),n=te(e.extensions)&&te(e.extensions.CESIUM_RTC),o=re(r.addBatchIdToGeneratedShaders,!1),a=e.techniques,s=e.shaders,l=e.programs,u=t.pbrMetallicRoughness;for(var c in t)(t.hasOwnProperty(c)&&(0<=c.indexOf("Texture")||0<=c.indexOf("Factor"))||"doubleSided"===c)&&(u[c]=t[c]);var d,h="precision highp float;\n",p="precision highp float;\n";te(e.skins)&&(d=e.skins[0]);var f,m=(te(d)?d.joints:[]).length,g=t.extras._pipeline.primitive,_=g.skinning,v=_.skinned,y=g.hasVertexColors,b=!1,C=!1;K.mesh(e,function(e){K.meshPrimitive(e,function(e){var t=e.targets;!C&&te(t)&&(C=!0,f=t);var r=e.attributes;for(var i in r)0<=i.indexOf("TANGENT")&&(b=!0)})});var w={modelViewMatrix:{semantic:n?"CESIUM_RTC_MODELVIEW":"MODELVIEW",type:ie.FLOAT_MAT4},projectionMatrix:{semantic:"PROJECTION",type:ie.FLOAT_MAT4}};w.normalMatrix={semantic:"MODELVIEWINVERSETRANSPOSE",type:ie.FLOAT_MAT3},v&&(w.jointMatrix={count:m,semantic:"JOINTMATRIX",type:ie.FLOAT_MAT4}),C&&(w.morphWeights={count:f.length,semantic:"MORPHWEIGHTS",type:ie.FLOAT});var S=!1;for(var T in u)if(u.hasOwnProperty(T)){var E=ne(T);S||E!==ie.SAMPLER_2D||(S=!0),w[T]={type:E}}var A={};for(var x in w)if(w.hasOwnProperty(x)&&"extras"!==x){var P=w[x];A["u_"+x]=x;var D=te(P.count)?"["+P.count+"]":"";P.type!==ie.FLOAT_MAT3&&P.type!==ie.FLOAT_MAT4&&"morphWeights"!==x||P.useInFragment?(p+="uniform "+$(P.type)+" u_"+x+D+";\n",delete P.useInFragment):h+="uniform "+$(P.type)+" u_"+x+D+";\n"}var O="";if(v){var I,M,R=J(_.type),L=!1;if(0===_.type.indexOf("MAT")&&(L=!0,R=Math.sqrt(R)),L)for(I=0;I<R;I++)for(M=0;M<R;M++)O+=0===I&&0===M?"    mat4 skinMatrix = ":"    skinMatrix += ",O+="a_weight["+I+"]["+M+"] * u_jointMatrix[int(a_joint["+I+"]["+M+"])];\n";else for(I=0;I<R;I++)O+=0===I?"    mat4 skinMatrix = ":"    skinMatrix += ",O+="a_weight["+I+"] * u_jointMatrix[int(a_joint["+I+"])];\n"}var N,k={a_position:"position"};if(w.position={semantic:"POSITION",type:ie.FLOAT_VEC3},h+="attribute vec3 a_position;\n",h+="varying vec3 v_positionEC;\n",i&&(h+="varying vec3 v_positionWC;\n"),O+="    vec3 weightedPosition = a_position;\n",O+="    vec3 weightedNormal = a_normal;\n",b&&(O+="    vec3 weightedTangent = a_tangent;\n"),C)for(var F=0;F<f.length;F++){var B=f[F];for(var U in B)if(B.hasOwnProperty(U)&&"extras"!==U){var V=U.toLowerCase()+"_"+F;k["a_"+V]=V,w[V]={semantic:U+"_"+F,type:ie.FLOAT_VEC3},h+="attribute vec3 a_"+V+";\n","POSITION"===U?O+="    weightedPosition += u_morphWeights["+F+"] * a_"+V+";\n":"NORMAL"===U?O+="    weightedNormal += u_morphWeights["+F+"] * a_"+V+";\n":"TANGENT"===U&&(O+="    weightedTangent += u_morphWeights["+F+"] * a_"+V+";\n")}}if(O+=v?"    vec4 position = skinMatrix * vec4(weightedPosition, 1.0);\n":"    vec4 position = vec4(weightedPosition, 1.0);\n",i&&(O+="    v_positionWC = (czm_model * position).xyz;\n"),O+="    position = u_modelViewMatrix * position;\n",O+="    v_positionEC = position.xyz;\n",O+="    gl_Position = u_projectionMatrix * position;\n",p+="varying vec3 v_positionEC;\n",i&&(p+="varying vec3 v_positionWC;\n"),k.a_normal="normal",w.normal={semantic:"NORMAL",type:ie.FLOAT_VEC3},h+="attribute vec3 a_normal;\n",h+="varying vec3 v_normal;\n",O+=v?"    v_normal = u_normalMatrix * mat3(skinMatrix) * weightedNormal;\n":"    v_normal = u_normalMatrix * weightedNormal;\n",p+="varying vec3 v_normal;\n",b&&(k.a_tangent="tangent",w.tangent={semantic:"TANGENT",type:ie.FLOAT_VEC3},h+="attribute vec3 a_tangent;\n",h+="varying vec3 v_tangent;\n",O+="    v_tangent = (u_modelViewMatrix * vec4(weightedTangent, 1.0)).xyz;\n",p+="varying vec3 v_tangent;\n"),S&&(k.a_texcoord_0="texcoord_0",w.texcoord_0={semantic:"TEXCOORD_0",type:ie.FLOAT_VEC2},h+="attribute vec2 a_texcoord_0;\n",h+="varying vec2 "+(N="v_texcoord_0")+";\n",O+="    "+N+" = a_texcoord_0;\n",p+="varying vec2 "+N+";\n"),v){k.a_joint="joint";var z=oe(_.type),q=ee(z);w.joint={semantic:"JOINTS_0",type:q},k.a_weight="weight",w.weight={semantic:"WEIGHTS_0",type:q},h+="attribute "+z+" a_joint;\n",h+="attribute "+z+" a_weight;\n"}y&&(k.a_vertexColor="vertexColor",w.vertexColor={semantic:"COLOR_0",type:ie.FLOAT_VEC4},h+="attribute vec4 a_vertexColor;\n",h+="varying vec4 v_vertexColor;\n",O+="  v_vertexColor = a_vertexColor;\n",p+="varying vec4 v_vertexColor;\n"),o&&(k.a_batchId="batchId",w.batchId={semantic:"_BATCHID",type:ie.FLOAT},h+="attribute float a_batchId;\n"),h+="void main(void) \n{\n",h+=O,h+="}\n",p+="const float M_PI = 3.141592653589793;\n",p+="vec3 lambertianDiffuse(vec3 baseColor) \n{\n    return baseColor / M_PI;\n}\n\n",p+="vec3 fresnelSchlick2(vec3 f0, vec3 f90, float VdotH) \n{\n    return f0 + (f90 - f0) * pow(clamp(1.0 - VdotH, 0.0, 1.0), 5.0);\n}\n\n",p+="vec3 fresnelSchlick(float metalness, float VdotH) \n{\n    return metalness + (vec3(1.0) - metalness) * pow(1.0 - VdotH, 5.0);\n}\n\n",p+="float smithVisibilityG1(float NdotV, float roughness) \n{\n    float k = (roughness + 1.0) * (roughness + 1.0) / 8.0;\n    return NdotV / (NdotV * (1.0 - k) + k);\n}\n\n",p+="float smithVisibilityGGX(float roughness, float NdotL, float NdotV) \n{\n    return smithVisibilityG1(NdotL, roughness) * smithVisibilityG1(NdotV, roughness);\n}\n\n",p+="float GGX(float roughness, float NdotH) \n{\n    float roughnessSquared = roughness * roughness;\n    float f = (NdotH * roughnessSquared - NdotH) * NdotH + 1.0;\n    return roughnessSquared / (M_PI * f * f);\n}\n\n",p+="void main(void) \n{\n",p+="    vec3 ng = normalize(v_normal);\n",te(u.normalTexture)?b?(p+="    vec3 t = normalize(v_tangent);\n",p+="    vec3 b = normalize(cross(ng, t));\n",p+="    mat3 tbn = mat3(t, b, ng);\n",p+="    vec3 n = texture2D(u_normalTexture, "+N+").rgb;\n",p+="    n = normalize(tbn * (2.0 * n - 1.0));\n"):(p="#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\n"+p,p+="#ifdef GL_OES_standard_derivatives\n",p+="    vec3 pos_dx = dFdx(v_positionEC);\n",p+="    vec3 pos_dy = dFdy(v_positionEC);\n",p+="    vec3 tex_dx = dFdx(vec3("+N+",0.0));\n",p+="    vec3 tex_dy = dFdy(vec3("+N+",0.0));\n",p+="    vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n",p+="    t = normalize(t - ng * dot(ng, t));\n",p+="    vec3 b = normalize(cross(ng, t));\n",p+="    mat3 tbn = mat3(t, b, ng);\n",p+="    vec3 n = texture2D(u_normalTexture, "+N+").rgb;\n",p+="    n = normalize(tbn * (2.0 * n - 1.0));\n",p+="#else\n",p+="    vec3 n = ng;\n",p+="#endif\n"):p+="    vec3 n = ng;\n",u.doubleSided&&(p+="    if (!gl_FrontFacing)\n",p+="    {\n",p+="        n = -n;\n",p+="    }\n"),te(u.baseColorTexture)?(p+="    vec4 baseColorWithAlpha = texture2D(u_baseColorTexture, "+N+");\n",te(u.baseColorFactor)&&(p+="    baseColorWithAlpha *= u_baseColorFactor;\n")):te(u.baseColorFactor)?p+="    vec4 baseColorWithAlpha = u_baseColorFactor;\n":p+="    vec4 baseColorWithAlpha = vec4(1.0);\n",y&&(p+="    baseColorWithAlpha *= v_vertexColor;\n"),p+="    vec3 baseColor = baseColorWithAlpha.rgb;\n",te(u.metallicRoughnessTexture)?(p+="    vec3 metallicRoughness = texture2D(u_metallicRoughnessTexture, "+N+").rgb;\n",p+="    float metalness = clamp(metallicRoughness.b, 0.0, 1.0);\n",p+="    float roughness = clamp(metallicRoughness.g, 0.04, 1.0);\n",te(u.metallicFactor)&&(p+="    metalness *= u_metallicFactor;\n"),te(u.roughnessFactor)&&(p+="    roughness *= u_roughnessFactor;\n")):(te(u.metallicFactor)?p+="    float metalness = clamp(u_metallicFactor, 0.0, 1.0);\n":p+="    float metalness = 1.0;\n",te(u.roughnessFactor)?p+="    float roughness = clamp(u_roughnessFactor, 0.04, 1.0);\n":p+="    float roughness = 1.0;\n"),p+="    vec3 v = -normalize(v_positionEC);\n",p+="    vec3 lightColor = vec3(1.0, 1.0, 1.0);\n",p+=i?"    vec3 l = normalize(czm_sunDirectionEC);\n":"    vec3 l = vec3(0.0, 0.0, 1.0);\n",p+="    vec3 h = normalize(v + l);\n",i?(p+="    vec3 r = normalize(czm_inverseViewRotation * normalize(reflect(v, n)));\n",p+="    czm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\n",p+="    float vertexRadius = length(v_positionWC);\n",p+="    float horizonDotNadir = 1.0 - ellipsoid.radii.x / vertexRadius;\n",p+="    float reflectionDotNadir = dot(r, normalize(v_positionWC));\n",p+="    r.x = -r.x;\n",p+="    r = -normalize(czm_temeToPseudoFixed * r);\n",p+="    r.x = -r.x;\n"):p+="    vec3 r = normalize(reflect(v, n));\n",p+="    float NdotL = clamp(dot(n, l), 0.001, 1.0);\n",p+="    float NdotV = abs(dot(n, v)) + 0.001;\n",p+="    float NdotH = clamp(dot(n, h), 0.0, 1.0);\n",p+="    float LdotH = clamp(dot(l, h), 0.0, 1.0);\n",p+="    float VdotH = clamp(dot(v, h), 0.0, 1.0);\n",p+="    vec3 f0 = vec3(0.04);\n",p+="    float alpha = roughness * roughness;\n",p+="    vec3 diffuseColor = baseColor * (1.0 - metalness);\n",p+="    vec3 specularColor = mix(f0, baseColor, metalness);\n",p+="    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n",p+="    vec3 r90 = vec3(clamp(reflectance * 25.0, 0.0, 1.0));\n",p+="    vec3 r0 = specularColor.rgb;\n",p+="    vec3 F = fresnelSchlick2(r0, r90, VdotH);\n",p+="    float G = smithVisibilityGGX(alpha, NdotL, NdotV);\n",p+="    float D = GGX(alpha, NdotH);\n",p+="    vec3 diffuseContribution = (1.0 - F) * lambertianDiffuse(baseColor);\n",p+="    vec3 specularContribution = F * G * D / (4.0 * NdotL * NdotV);\n",p+="    vec3 color = NdotL * lightColor * (diffuseContribution + specularContribution);\n",i&&(p+="    float inverseRoughness = 1.0 - roughness;\n",p+="    inverseRoughness *= inverseRoughness;\n",p+="    vec3 sceneSkyBox = textureCube(czm_environmentMap, r).rgb * inverseRoughness;\n",p+="    float atmosphereHeight = 0.05;\n",p+="    float blendRegionSize = 0.1 * ((1.0 - inverseRoughness) * 8.0 + 1.1 - horizonDotNadir);\n",p+="    float farAboveHorizon = clamp(horizonDotNadir - blendRegionSize * 0.5, 1.0e-10 - blendRegionSize, 0.99999);\n",p+="    float aroundHorizon = clamp(horizonDotNadir + blendRegionSize * 0.5, 1.0e-10 - blendRegionSize, 0.99999);\n",p+="    float farBelowHorizon = clamp(horizonDotNadir + blendRegionSize * 1.5, 1.0e-10 - blendRegionSize, 0.99999);\n",p+="    float smoothstepHeight = smoothstep(0.0, atmosphereHeight, horizonDotNadir);\n",p+="    float lightScale = smoothstepHeight * 1.5 + 1.0;\n",p+="    vec3 diffuseIrradiance = mix(vec3(0.5), vec3(0.05), smoothstepHeight);\n",p+="    vec3 belowHorizonColor = mix(vec3(0.1, 0.2, 0.4), vec3(0.2, 0.5, 0.7), smoothstepHeight);\n",p+="    vec3 nadirColor = belowHorizonColor * 0.5;\n",p+="    vec3 aboveHorizonColor = vec3(0.8, 0.9, 0.95);\n",p+="    vec3 blueSkyColor = mix(vec3(0.09, 0.13, 0.24), aboveHorizonColor, reflectionDotNadir * inverseRoughness * 0.5 + 0.5);\n",p+="    vec3 zenithColor = mix(blueSkyColor, sceneSkyBox, smoothstepHeight);\n",p+="    vec3 specularIrradiance = mix(zenithColor, aboveHorizonColor, smoothstep(farAboveHorizon, aroundHorizon, reflectionDotNadir) * inverseRoughness);\n",p+="    specularIrradiance = mix(specularIrradiance, belowHorizonColor, smoothstep(aroundHorizon, farBelowHorizon, reflectionDotNadir) * inverseRoughness);\n",p+="    specularIrradiance = mix(specularIrradiance, nadirColor, smoothstep(farBelowHorizon, 1.0, reflectionDotNadir) * inverseRoughness);\n",p+="    vec2 brdfLut = texture2D(czm_brdfLut, vec2(NdotV, 1.0 - roughness)).rg;\n",p+="    vec3 IBLColor = (diffuseIrradiance * diffuseColor) + (specularIrradiance * (specularColor * brdfLut.x + brdfLut.y));\n",p+="    color = color * lightScale + IBLColor;\n"),te(u.occlusionTexture)&&(p+="    color *= texture2D(u_occlusionTexture, "+N+").r;\n"),te(u.emissiveTexture)?(p+="    vec3 emissive = texture2D(u_emissiveTexture, "+N+").rgb;\n",te(u.emissiveFactor)&&(p+="    emissive *= u_emissiveFactor;\n"),p+="    color += emissive;\n"):te(u.emissiveFactor)&&(p+="    color += u_emissiveFactor;\n");var G,W=t.alphaMode;if(te(W))if("MASK"===W){var H=t.alphaCutoff;te(H)?p+="    gl_FragColor = vec4(color, int(baseColorWithAlpha.a >= "+H+"));\n":p+="    gl_FragColor = vec4(color, 1.0);\n"}else p+="BLEND"===W?"    gl_FragColor = vec4(color, baseColorWithAlpha.a);\n":"    gl_FragColor = vec4(color, 1.0);\n";else p+="    gl_FragColor = vec4(color, 1.0);\n";p+="}\n",G=te(W)&&"OPAQUE"!==W?{enable:[ie.DEPTH_TEST,ie.BLEND],functions:{depthMask:[!1],blendEquationSeparate:[ie.FUNC_ADD,ie.FUNC_ADD],blendFuncSeparate:[ie.ONE,ie.ONE_MINUS_SRC_ALPHA,ie.ONE,ie.ONE_MINUS_SRC_ALPHA]}}:u.doubleSided?{enable:[ie.DEPTH_TEST]}:{enable:[ie.CULL_FACE,ie.DEPTH_TEST]};var j=Z(s,{type:ie.VERTEX_SHADER,extras:{_pipeline:{source:h,extension:".glsl"}}}),Y=Z(s,{type:ie.FRAGMENT_SHADER,extras:{_pipeline:{source:p,extension:".glsl"}}}),X=Object.keys(k),Q=Z(l,{attributes:X,fragmentShader:Y,vertexShader:j});return Z(a,{attributes:k,parameters:w,program:Q,states:G,uniforms:A})}(i,e,n);e.values=t,e.technique=r,delete e.pbrMetallicRoughness}}),t=i,K.mesh(t,function(e){K.meshPrimitive(e,function(e){!function(e,t){var r=e.accessors,i=e.materials,n=e.techniques,o=e.programs,a=e.shaders,s=t.targets,l=t.attributes;for(var u in s)if(te(u)){var c=s[u];for(var d in c)"extras"!==d&&(l[d+"_"+u]=c[d])}var h=i[t.material],p=n[h.technique],f=o[p.program],m=a[f.vertexShader];for(var g in l)if(l.hasOwnProperty(g)&&!te(S(p,g))){var _=l[g],v=r[_],y=g.toLowerCase();"_"===y.charAt(0)&&(y=y.slice(1));var b="a_"+y;p.parameters[y]={semantic:g,type:v.componentType},p.attributes[b]=y,f.attributes.push(b);var C=m.extras._pipeline,w=C.source;w="attribute "+oe(v.type)+" "+b+";\n"+w,C.source=w}}(t,e)})})),i}}),define("Scene/AttributeType",["../Core/freezeObject"],function(e){"use strict";return e({SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4"})}),define("Scene/Axis",["../Core/Check","../Core/freezeObject","../Core/Math","../Core/Matrix3","../Core/Matrix4"],function(t,e,r,i,n){"use strict";var o={X:0,Y:1,Z:2,Y_UP_TO_Z_UP:n.fromRotationTranslation(i.fromRotationX(r.PI_OVER_TWO)),Z_UP_TO_Y_UP:n.fromRotationTranslation(i.fromRotationX(-r.PI_OVER_TWO)),X_UP_TO_Z_UP:n.fromRotationTranslation(i.fromRotationY(-r.PI_OVER_TWO)),Z_UP_TO_X_UP:n.fromRotationTranslation(i.fromRotationY(r.PI_OVER_TWO)),X_UP_TO_Y_UP:n.fromRotationTranslation(i.fromRotationZ(r.PI_OVER_TWO)),Y_UP_TO_X_UP:n.fromRotationTranslation(i.fromRotationZ(-r.PI_OVER_TWO)),fromName:function(e){return t.typeOf.string("name",e),o[e]}};return e(o)}),define("Scene/JobType",["../Core/freezeObject"],function(e){"use strict";return e({TEXTURE:0,PROGRAM:1,BUFFER:2,NUMBER_OF_JOB_TYPES:3})}),define("Scene/ModelAnimationCache",["./AttributeType","../Core/Cartesian3","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/LinearSpline","../Core/Matrix4","../Core/Quaternion","../Core/QuaternionSpline","../Core/WebGLConstants","../Core/WeightSpline","../ThirdParty/GltfPipeline/getAccessorByteStride","../ThirdParty/GltfPipeline/numberOfComponentsForType"],function(g,_,v,y,b,f,C,w,m,S,T,E,A){"use strict";function e(){}var u=/^data\:/i;function x(e,t){var r=e.gltf,i=r.buffers,n=r.bufferViews[t.bufferView],o=i[n.buffer],a=n.byteOffset+t.byteOffset,s=t.count*A(t.type),l=u.test(o.uri)?"":o.uri;return e.cacheKey+"//"+l+"/"+a+"/"+s}var P={};e.getAnimationParameterValues=function(e,t){var r=x(e,t),i=P[r];if(!b(i)){var n=e.gltf,o=n.buffers,a=n.bufferViews[t.bufferView],s=o[a.buffer].extras._pipeline.source,l=t.componentType,u=t.type,c=A(u),d=t.count,h=E(n,t);i=new Array(d);for(var p=y(t.byteOffset,0),f=a.byteOffset+p,m=0;m<d;m++){var g=v.createArrayBufferView(l,s.buffer,s.byteOffset+f,c);"SCALAR"===u?i[m]=g[0]:"VEC3"===u?i[m]=_.fromArray(g):"VEC4"===u&&(i[m]=w.unpack(g)),f+=h}b(e.cacheKey)&&(P[r]=i)}return i};var D={};function O(e){this._value=e}O.prototype.evaluate=function(e,t){return this._value},e.getAnimationSpline=function(e,t,r,i,n,o,a,s){var l,u,c=(l=t,u=i,e.cacheKey+"//"+l+"/"+u),d=D[c];if(!b(d)){var h=o,p=s;1===h.length&&1===p.length?d=new O(p[0]):"LINEAR"===n.interpolation&&("translation"===a||"scale"===a?d=new f({times:h,points:p}):"rotation"===a?d=new m({times:h,points:p}):"weights"===a&&(d=new T({times:h,weights:p}))),b(e.cacheKey)&&(D[c]=d)}return d};var I={};return e.getSkinInverseBindMatrices=function(e,t){var r=x(e,t),i=I[r];if(!b(i)){var n=e.gltf,o=n.buffers,a=n.bufferViews[t.bufferView],s=o[a.buffer].extras._pipeline.source,l=t.componentType,u=t.type,c=t.count,d=E(n,t),h=a.byteOffset+t.byteOffset,p=A(u);if(i=new Array(c),l===S.FLOAT&&u===g.MAT4)for(var f=0;f<c;++f){var m=v.createArrayBufferView(l,s.buffer,s.byteOffset+h,p);i[f]=C.fromArray(m),h+=d}I[r]=i}return i},e}),define("Scene/ModelAnimationLoop",["../Core/freezeObject"],function(e){"use strict";return e({NONE:0,REPEAT:1,MIRRORED_REPEAT:2})}),define("Scene/ModelAnimationState",["../Core/freezeObject"],function(e){"use strict";return e({STOPPED:0,ANIMATING:1})}),define("Scene/ModelAnimation",["../Core/defaultValue","../Core/defineProperties","../Core/Event","../Core/JulianDate","./ModelAnimationLoop","./ModelAnimationState"],function(n,e,o,a,s,l){"use strict";function t(e,t,r){this._name=r.name,this._startTime=a.clone(e.startTime),this._delay=n(e.delay,0),this._stopTime=e.stopTime,this.removeOnStop=n(e.removeOnStop,!1),this._speedup=n(e.speedup,1),this._reverse=n(e.reverse,!1),this._loop=n(e.loop,s.NONE),this.start=new o,this.update=new o,this.stop=new o,this._state=l.STOPPED,this._runtimeAnimation=r,this._computedStartTime=void 0,this._duration=void 0;var i=this;this._raiseStartEvent=function(){i.start.raiseEvent(t,i)},this._updateEventTime=0,this._raiseUpdateEvent=function(){i.update.raiseEvent(t,i,i._updateEventTime)},this._raiseStopEvent=function(){i.stop.raiseEvent(t,i)}}return e(t.prototype,{name:{get:function(){return this._name}},startTime:{get:function(){return this._startTime}},delay:{get:function(){return this._delay}},stopTime:{get:function(){return this._stopTime}},speedup:{get:function(){return this._speedup}},reverse:{get:function(){return this._reverse}},loop:{get:function(){return this._loop}}}),t}),define("Scene/ModelAnimationCollection",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/JulianDate","../Core/Math","./ModelAnimation","./ModelAnimationLoop","./ModelAnimationState"],function(b,C,e,o,t,w,S,a,T,E){"use strict";function r(e){this.animationAdded=new t,this.animationRemoved=new t,this._model=e,this._scheduledAnimations=[],this._previousTime=void 0}function s(e,t,r){var i=e._model,n=i._runtime.animations[t],o=new a(r,i,n);return e._scheduledAnimations.push(o),e.animationAdded.raiseEvent(i,o),o}function A(e,t){for(var r=e.channelEvaluators,i=r.length,n=0;n<i;++n)r[n](t)}e(r.prototype,{length:{get:function(){return this._scheduledAnimations.length}}}),r.prototype.add=function(e){e=b(e,b.EMPTY_OBJECT);var t,r=this._model._runtime.animations;if(!C(r))throw new o("Animations are not loaded.  Wait for Model.readyPromise to resolve.");if(!C(e.name)&&!C(e.index))throw new o("Either options.name or options.index must be defined.");if(C(e.speedup)&&e.speedup<=0)throw new o("options.speedup must be greater than zero.");if(C(e.index)&&(e.index>=r.length||e.index<0))throw new o("options.index must be a valid animation index.");if(C(e.index))return s(this,e.index,e);for(var i=r.length,n=0;n<i;++n)if(r[n].name===e.name){t=n;break}if(!C(t))throw new o("options.name must be a valid animation name.");return s(this,t,e)},r.prototype.addAll=function(e){if(e=b(e,b.EMPTY_OBJECT),!C(this._model._runtime.animations))throw new o("Animations are not loaded.  Wait for Model.readyPromise to resolve.");if(C(e.speedup)&&e.speedup<=0)throw new o("options.speedup must be greater than zero.");for(var t=[],r=this._model._runtime.animations.length,i=0;i<r;++i)t.push(s(this,i,e));return t},r.prototype.remove=function(e){if(C(e)){var t=this._scheduledAnimations,r=t.indexOf(e);if(-1!==r)return t.splice(r,1),this.animationRemoved.raiseEvent(this._model,e),!0}return!1},r.prototype.removeAll=function(){var e=this._model,t=this._scheduledAnimations,r=t.length;this._scheduledAnimations=[];for(var i=0;i<r;++i)this.animationRemoved.raiseEvent(e,t[i])},r.prototype.contains=function(e){return!!C(e)&&-1!==this._scheduledAnimations.indexOf(e)},r.prototype.get=function(e){if(!C(e))throw new o("index is required.");return this._scheduledAnimations[e]};var x=[];function P(e,t,r){return function(){e.animationRemoved.raiseEvent(t,r)}}return r.prototype.update=function(e){var t=this._scheduledAnimations,r=t.length;if(0===r)return this._previousTime=void 0,!1;if(w.equals(e.time,this._previousTime))return!1;this._previousTime=w.clone(e.time,this._previousTime);for(var i=!1,n=e.time,o=this._model,a=0;a<r;++a){var s=t[a],l=s._runtimeAnimation;C(s._computedStartTime)||(s._computedStartTime=w.addSeconds(b(s.startTime,n),s.delay,new w)),C(s._duration)||(s._duration=l.stopTime*(1/s.speedup));var u=s._computedStartTime,c=s._duration,d=s.stopTime,h=0!==c?w.secondsDifference(n,u)/c:0,p=0<=h,f=s.loop===T.REPEAT||s.loop===T.MIRRORED_REPEAT;if((p||f&&!C(s.startTime))&&(h<=1||f)&&(!C(d)||w.lessThanOrEquals(n,d))){if(s._state===E.STOPPED&&(s._state=E.ANIMATING,0<s.start.numberOfListeners&&e.afterRender.push(s._raiseStartEvent)),s.loop===T.REPEAT)h-=Math.floor(h);else if(s.loop===T.MIRRORED_REPEAT){var m=Math.floor(h),g=h-m;h=m%2==1?1-g:g}s.reverse&&(h=1-h);var _=h*c*s.speedup;A(l,_=S.clamp(_,l.startTime,l.stopTime)),0<s.update.numberOfListeners&&(s._updateEventTime=_,e.afterRender.push(s._raiseUpdateEvent)),i=!0}else p&&s._state===E.ANIMATING&&(s._state=E.STOPPED,0<s.stop.numberOfListeners&&e.afterRender.push(s._raiseStopEvent),s.removeOnStop&&x.push(s))}r=x.length;for(var v=0;v<r;++v){var y=x[v];t.splice(t.indexOf(y),1),e.afterRender.push(P(this,o,y))}return x.length=0,i},r}),define("Scene/ModelLoadResources",["../Core/Queue"],function(e){"use strict";function t(){this.vertexBuffersToCreate=new e,this.indexBuffersToCreate=new e,this.buffers={},this.pendingBufferLoads=0,this.programsToCreate=new e,this.shaders={},this.pendingShaderLoads=0,this.texturesToCreate=new e,this.pendingTextureLoads=0,this.texturesToCreateFromBufferView=new e,this.pendingBufferViewToImage=0,this.createSamplers=!0,this.createSkins=!0,this.createRuntimeAnimations=!0,this.createVertexArrays=!0,this.createRenderStates=!0,this.createUniformMaps=!0,this.createRuntimeNodes=!0,this.skinnedNodesIds=[]}return t.prototype.getBuffer=function(e){return t=this.buffers[e.buffer],r=e.byteOffset,i=e.byteLength,t.subarray(r,r+i);var t,r,i},t.prototype.finishedPendingBufferLoads=function(){return 0===this.pendingBufferLoads},t.prototype.finishedBuffersCreation=function(){return 0===this.pendingBufferLoads&&0===this.vertexBuffersToCreate.length&&0===this.indexBuffersToCreate.length},t.prototype.finishedProgramCreation=function(){return 0===this.pendingShaderLoads&&0===this.programsToCreate.length},t.prototype.finishedTextureCreation=function(){var e=0===this.pendingTextureLoads,t=0===this.texturesToCreate.length&&0===this.texturesToCreateFromBufferView.length;return e&&t},t.prototype.finishedEverythingButTextureCreation=function(){var e=0===this.pendingBufferLoads&&0===this.pendingShaderLoads,t=0===this.vertexBuffersToCreate.length&&0===this.indexBuffersToCreate.length&&0===this.programsToCreate.length&&0===this.pendingBufferViewToImage;return e&&t},t.prototype.finished=function(){return this.finishedTextureCreation()&&this.finishedEverythingButTextureCreation()},t}),define("Scene/ModelMaterial",["../Core/defined","../Core/defineProperties","../Core/DeveloperError"],function(i,e,n){"use strict";function t(e,t,r){this._name=t.name,this._id=r,this._uniformMap=e._uniformMaps[r]}return e(t.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}}}),t.prototype.setValue=function(e,t){if(!i(e))throw new n("name is required.");var r=this._uniformMap.values[e];if(!i(r))throw new n("name must match a parameter name in the material's technique that is targetable and not optimized out.");r.value=r.clone(t,r.value)},t.prototype.getValue=function(e){if(!i(e))throw new n("name is required.");var t=this._uniformMap.values[e];if(i(t))return t.value},t}),define("Scene/ModelMesh",["../Core/defineProperties"],function(e){"use strict";function t(e,t,r){for(var i=[],n=e.primitives,o=n.length,a=0;a<o;++a){var s=n[a];i[a]=t[s.material]}this._name=e.name,this._materials=i,this._id=r}return e(t.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},materials:{get:function(){return this._materials}}}),t}),define("Scene/ModelNode",["../Core/defineProperties","../Core/Matrix4"],function(e,o){"use strict";function t(e,t,r,i,n){this._model=e,this._runtimeNode=r,this._name=t.name,this._id=i,this.useMatrix=!1,this._show=!0,this._matrix=o.clone(n)}return e(t.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,this._model._perNodeShowDirty=!0)}},matrix:{get:function(){return this._matrix},set:function(e){this._matrix=o.clone(e,this._matrix),this.useMatrix=!0;var t=this._model;t._cesiumAnimationsDirty=!0,this._runtimeNode.dirtyNumber=t._maxDirtyNumber}}}),t.prototype.setMatrix=function(e){o.clone(e,this._matrix)},t}),define("Scene/ModelUtility",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/defined","../Core/defineProperties","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Core/Quaternion","../Core/RuntimeError","../Core/WebGLConstants","../Renderer/ShaderSource","./AttributeType"],function(r,i,n,y,e,b,C,w,o,a,t,v,S){"use strict";var s={getAccessorMinMax:function(e,t){var r=e.accessors[t],i=r.extensions,n=r.min,o=r.max;if(y(i)){var a=i.WEB3D_quantized_attributes;y(a)&&(n=a.decodedMin,o=a.decodedMax)}return{min:n,max:o}},getAttributeOrUniformBySemantic:function(e,t,r){var i,n=e.techniques;for(var o in n)if(n.hasOwnProperty(o)){var a=n[o];if(y(r)&&a.program!==r)continue;var s=a.parameters,l=a.attributes,u=a.uniforms;for(var c in l)if(l.hasOwnProperty(c)&&(i=s[l[c]],y(i)&&i.semantic===t))return c;for(var d in u)if(u.hasOwnProperty(d)&&(i=s[u[d]],y(i)&&i.semantic===t))return d}},getDiffuseAttributeOrUniform:function(e,t){var r=s.getAttributeOrUniformBySemantic(e,"COLOR_0",t);return y(r)||(r=s.getAttributeOrUniformBySemantic(e,"_3DTILESDIFFUSE",t)),r}},l=new i,u=new o,c=new i;function T(e,t,r){var i=e.indexOf(t);return e.replace(new RegExp(t,"g"),function(e,t){return i===t?e:r})}function E(e,t){var r=e.accessors[t].extensions;if(y(r))return r.WEB3D_quantized_attributes}function A(e,t,r){var i=t.material,n=e.materials[i].technique,o=e.techniques[n];for(var a in o.parameters){if(o.parameters.hasOwnProperty(a))if(o.parameters[a].semantic===r){var s=o.attributes;for(var l in s){if(s.hasOwnProperty(l))if(s[l]===a)return l}}}}function d(e){var t={value:e,clone:function(e,t){return e},func:function(){return t.value}};return t}function h(e){var t={value:r.fromArray(e),clone:r.clone,func:function(){return t.value}};return t}function p(e){var t={value:i.fromArray(e),clone:i.clone,func:function(){return t.value}};return t}function x(e){var t={value:n.fromArray(e),clone:n.clone,func:function(){return t.value}};return t}function P(e){var t={value:b.fromColumnMajorArray(e),clone:b.clone,func:function(){return t.value}};return t}function D(e){var t={value:C.fromColumnMajorArray(e),clone:C.clone,func:function(){return t.value}};return t}function O(e){var t={value:w.fromColumnMajorArray(e),clone:w.clone,func:function(){return t.value}};return t}function f(e,t,r){this._value=void 0,this._textureId=e.index,this._textures=t,this._defaultTexture=r}s.getTransform=function(e,t){return y(e.matrix)?w.fromColumnMajorArray(e.matrix,t):w.fromTranslationQuaternionRotationScale(i.fromArray(e.translation,0,l),o.unpack(e.rotation,0,u),i.fromArray(e.scale,0,c),t)},s.getUsedExtensions=function(e){var t=e.extensionsUsed,r={};if(y(t))for(var i=t.length,n=0;n<i;n++){r[t[n]]=!0}return r},s.getRequiredExtensions=function(e){var t=e.extensionsRequired,r={};if(y(t))for(var i=t.length,n=0;n<i;n++){r[t[n]]=!0}return r},s.checkSupportedExtensions=function(e){for(var t in e)if(e.hasOwnProperty(t)&&"CESIUM_RTC"!==t&&"KHR_technique_webgl"!==t&&"KHR_binary_glTF"!==t&&"KHR_materials_common"!==t&&"WEB3D_quantized_attributes"!==t)throw new a("Unsupported glTF Extension: "+t)},s.checkSupportedGlExtensions=function(e,t){if(y(e))for(var r=e.length,i=0;i<r;i++){var n=e[i];if("OES_element_index_uint"!==n)throw new a("Unsupported WebGL Extension: "+n);if(!t.elementIndexUint)throw new a("OES_element_index_uint WebGL extension is not enabled.")}},s.modifyShaderForQuantizedAttributes=function(e,t,r){var i={},n=t.attributes;for(var o in n)if(n.hasOwnProperty(o)){var a=A(e,t,o),s=t.attributes[o];"_"===o.charAt(0)&&(o=o.substring(1));var l="gltf_u_dec_"+o.toLowerCase(),u=l+"_scale",c=l+"_translate";if(!y(i[l])&&!y(i[u])){var d=E(e,s);if(y(d)){var h,p=d.decodeMatrix,f="gltf_decoded_"+o,m=a.replace("a_","gltf_a_dec_"),g=Math.floor(Math.sqrt(p.length));r=(h=2<g?"vec"+(g-1):"float")+" "+m+";\n"+(r=T(r,a,m));var _="";5===g?(r="uniform vec4 "+c+";\n"+(r="uniform mat4 "+u+";\n"+r),_="\nvoid main() {\n    "+m+" = "+u+" * "+a+" + "+c+";\n    "+f+"();\n}\n",i[u]={mat:4},i[c]={vec:4}):(r="uniform mat"+g+" "+l+";\n"+r,_="\nvoid main() {\n    "+m+" = "+h+"("+l+" * vec"+g+"("+a+",1.0));\n    "+f+"();\n}\n",i[l]={mat:g}),r=v.replaceMain(r,f),r+=_}}}return{shader:r,uniforms:i}},e(f.prototype,{value:{get:function(){if(!y(this._value)){var e=this._textures[this._textureId];if(!y(e))return this._defaultTexture;this._value=e}return this._value},set:function(e){this._value=e}}}),f.prototype.clone=function(e){return e},f.prototype.func=void 0;var m={};m[t.FLOAT]=d,m[t.FLOAT_VEC2]=h,m[t.FLOAT_VEC3]=p,m[t.FLOAT_VEC4]=x,m[t.INT]=d,m[t.INT_VEC2]=h,m[t.INT_VEC3]=p,m[t.INT_VEC4]=x,m[t.BOOL]=d,m[t.BOOL_VEC2]=h,m[t.BOOL_VEC3]=p,m[t.BOOL_VEC4]=x,m[t.FLOAT_MAT2]=P,m[t.FLOAT_MAT3]=D,m[t.FLOAT_MAT4]=O,m[t.SAMPLER_2D]=function(e,t,r){var i=new f(e,t,r);return i.func=function(){return i.value},i},s.createUniformFunction=function(e,t,r,i){return m[e](t,r,i)},s.createUniformsForQuantizedAttributes=function(e,t,r){var i,n,o=e.accessors,a={},s={},l=t.attributes;for(var u in l)if(l.hasOwnProperty(u)){var c=o[l[u]],d=c.extensions;if("_"===u.charAt(0)&&(u=u.substring(1)),y(d)){var h=d.WEB3D_quantized_attributes;if(y(h)){var p=h.decodeMatrix,f="gltf_u_dec_"+u.toLowerCase();switch(c.type){case S.SCALAR:s[f]=P(p).func,a[f]=!0;break;case S.VEC2:s[f]=D(p).func,a[f]=!0;break;case S.VEC3:s[f]=O(p).func,a[f]=!0;break;case S.VEC4:var m=f+"_scale",g=f+"_translate";s[m]=O((n=p,[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]])).func,s[g]=x((i=p,[i[20],i[21],i[22],i[23]])).func,a[m]=!0,a[g]=!0}}}}for(var _ in r)if(r.hasOwnProperty(_)&&!a[_]){var v=r[_];y(v.mat)&&(2===v.mat?s[_]=P(b.IDENTITY).func:3===v.mat?s[_]=D(C.IDENTITY).func:4===v.mat&&(s[_]=O(w.IDENTITY).func)),y(v.vec)&&4===v.vec&&(s[_]=x([0,0,0,0]).func)}return s};var g=new i,_={MODEL:function(e,t){return function(){return e.model}},VIEW:function(e,t){return function(){return e.view}},PROJECTION:function(e,t){return function(){return e.projection}},MODELVIEW:function(e,t){return function(){return e.modelView}},CESIUM_RTC_MODELVIEW:function(e,t){var r=new w;return function(){return y(t._rtcCenter)?(w.getTranslation(e.model,g),i.add(g,t._rtcCenter,g),w.multiplyByPoint(e.view,g,g),w.setTranslation(e.modelView,g,r)):e.modelView}},MODELVIEWPROJECTION:function(e,t){return function(){return e.modelViewProjection}},MODELINVERSE:function(e,t){return function(){return e.inverseModel}},VIEWINVERSE:function(e,t){return function(){return e.inverseView}},PROJECTIONINVERSE:function(e,t){return function(){return e.inverseProjection}},MODELVIEWINVERSE:function(e,t){return function(){return e.inverseModelView}},MODELVIEWPROJECTIONINVERSE:function(e,t){return function(){return e.inverseModelViewProjection}},MODELINVERSETRANSPOSE:function(e,t){return function(){return e.inverseTransposeModel}},MODELVIEWINVERSETRANSPOSE:function(e,t){return function(){return e.normal}},VIEWPORT:function(e,t){return function(){return e.viewportCartesian4}}};return s.getGltfSemanticUniforms=function(){return _},s}),define("Scene/Model",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/ClippingPlaneCollection","../Core/clone","../Core/Color","../Core/combine","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/FeatureDetection","../Core/getAbsoluteUri","../Core/getMagic","../Core/getStringFromTypedArray","../Core/IndexDatatype","../Core/loadCRN","../Core/loadImageFromTypedArray","../Core/loadKTX","../Core/Math","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Core/PixelFormat","../Core/Plane","../Core/PrimitiveType","../Core/Resource","../Core/Quaternion","../Core/Queue","../Core/RuntimeError","../Core/Transforms","../Core/WebGLConstants","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/Sampler","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/Texture","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","../Renderer/VertexArray","../ThirdParty/GltfPipeline/addDefaults","../ThirdParty/GltfPipeline/addPipelineExtras","../ThirdParty/GltfPipeline/ForEach","../ThirdParty/GltfPipeline/getAccessorByteStride","../ThirdParty/GltfPipeline/numberOfComponentsForType","../ThirdParty/GltfPipeline/parseBinaryGltf","../ThirdParty/GltfPipeline/processModelMaterialsCommon","../ThirdParty/GltfPipeline/processPbrMetallicRoughness","../ThirdParty/GltfPipeline/updateVersion","../ThirdParty/Uri","../ThirdParty/when","./AttributeType","./Axis","./BlendingState","./ColorBlendMode","./HeightReference","./JobType","./ModelAnimationCache","./ModelAnimationCollection","./ModelLoadResources","./ModelMaterial","./ModelMesh","./ModelNode","./ModelUtility","./SceneMode","./ShadowMode"],function(de,e,he,pe,fe,C,w,a,ne,me,ge,t,l,i,_e,r,n,u,c,ve,oe,ye,d,be,Ce,o,s,we,h,p,Se,f,x,m,g,Te,Ee,_,v,ae,se,S,y,T,E,b,A,P,D,Ae,xe,Pe,O,I,M,De,Oe,Ie,R,L,N,Me,k,F,Re,B,U,V,Le,Ne,ke,Fe,Be,Ue,Ve){"use strict";if(!n.supportsTypedArrays())return{};var z=new he,ze={NEEDS_LOAD:0,LOADING:1,LOADED:2,FAILED:3};function q(e,t){e._cachedGltf=t}function G(e){this._gltf=e.gltf,this.ready=e.ready,this.modelsToLoad=[],this.count=0}t(G.prototype,{gltf:{set:function(e){this._gltf=e},get:function(){return this._gltf}}}),G.prototype.makeReady=function(e){this.gltf=e;for(var t=this.modelsToLoad,r=t.length,i=0;i<r;++i){var n=t[i];n.isDestroyed()||q(n,this)}this.modelsToLoad=void 0,this.ready=!0};var W={};function H(e){var t,r=(e=me(e,me.EMPTY_OBJECT)).cacheKey;if(this._cacheKey=r,this._cachedGltf=void 0,this._releaseGltfJson=me(e.releaseGltfJson,!1),ge(r)&&ge(W[r])&&W[r].ready)++(t=W[r]).count;else{var i=e.gltf;if(ge(i)){if(i instanceof ArrayBuffer&&(i=new Uint8Array(i)),i instanceof Uint8Array)t=new G({gltf:M(i),ready:!0});else t=new G({gltf:e.gltf,ready:!0});t.count=1,ge(r)&&(W[r]=t)}}q(this,t);var n=me(e.basePath,"");this._resource=f.createIfNeeded(n),this.show=me(e.show,!0),this.silhouetteColor=me(e.silhouetteColor,a.RED),this._silhouetteColor=new a,this._silhouetteColorPreviousAlpha=1,this._normalAttributeName=void 0,this.silhouetteSize=me(e.silhouetteSize,0),this.modelMatrix=we.clone(me(e.modelMatrix,we.IDENTITY)),this._modelMatrix=we.clone(this.modelMatrix),this._clampedModelMatrix=void 0,this.scale=me(e.scale,1),this._scale=this.scale,this.minimumPixelSize=me(e.minimumPixelSize,0),this._minimumPixelSize=this.minimumPixelSize,this.maximumScale=e.maximumScale,this._maximumScale=this.maximumScale,this.id=e.id,this._id=e.id,this.heightReference=me(e.heightReference,Re.NONE),this._heightReference=this.heightReference,this._heightChanged=!1,this._removeUpdateHeightCallback=void 0;var o=e.scene;this._scene=o,ge(o)&&ge(o.terrainProviderChanged)&&(this._terrainProviderChangedCallback=o.terrainProviderChanged.addEventListener(function(){this._heightChanged=!0},this)),this._pickObject=e.pickObject,this._allowPicking=me(e.allowPicking,!0),this._ready=!1,this._readyPromise=L.defer(),this.activeAnimations=new V(this),this.clampAnimations=me(e.clampAnimations,!0),this._defaultTexture=void 0,this._incrementallyLoadTextures=me(e.incrementallyLoadTextures,!0),this._asynchronous=me(e.asynchronous,!0),this.shadows=me(e.shadows,Ve.ENABLED),this._shadows=this.shadows,this.color=me(e.color,a.WHITE),this._color=new a,this._colorPreviousAlpha=1,this.colorBlendMode=me(e.colorBlendMode,F.HIGHLIGHT),this.colorBlendAmount=me(e.colorBlendAmount,.5),this.clippingPlanes=e.clippingPlanes,this.debugShowBoundingVolume=me(e.debugShowBoundingVolume,!1),this._debugShowBoundingVolume=!1,this.debugWireframe=me(e.debugWireframe,!1),this._debugWireframe=!1,this._distanceDisplayCondition=e.distanceDisplayCondition,this._addBatchIdToGeneratedShaders=e.addBatchIdToGeneratedShaders,this._precreatedAttributes=e.precreatedAttributes,this._vertexShaderLoaded=e.vertexShaderLoaded,this._fragmentShaderLoaded=e.fragmentShaderLoaded,this._uniformMapLoaded=e.uniformMapLoaded,this._pickVertexShaderLoaded=e.pickVertexShaderLoaded,this._pickFragmentShaderLoaded=e.pickFragmentShaderLoaded,this._pickUniformMapLoaded=e.pickUniformMapLoaded,this._ignoreCommands=me(e.ignoreCommands,!1),this._requestType=e.requestType,this._upAxis=me(e.upAxis,Me.Y),this.cull=me(e.cull,!0),this.opaquePass=me(e.opaquePass,se.OPAQUE),this._computedModelMatrix=new we,this._modelViewMatrix=we.clone(we.IDENTITY),this._initialRadius=void 0,this._boundingSphere=void 0,this._scaledBoundingSphere=new de,this._state=ze.NEEDS_LOAD,this._loadResources=void 0,this._mode=void 0,this._perNodeShowDirty=!1,this._cesiumAnimationsDirty=!1,this._dirty=!1,this._maxDirtyNumber=0,this._runtime={animations:void 0,rootNodes:void 0,nodes:void 0,nodesByName:void 0,skinnedNodes:void 0,meshesByName:void 0,materialsByName:void 0,materialsById:void 0},this._uniformMaps={},this._extensionsUsed=void 0,this._extensionsRequired=void 0,this._quantizedUniforms={},this._programPrimitives={},this._rendererResources={buffers:{},vertexArrays:{},programs:{},pickPrograms:{},silhouettePrograms:{},textures:{},samplers:{},renderStates:{}},this._cachedRendererResources=void 0,this._loadRendererResourcesFromCache=!1,this._updatedGltfVersion=!1,this._cachedGeometryByteLength=0,this._cachedTexturesByteLength=0,this._geometryByteLength=0,this._texturesByteLength=0,this._trianglesLength=0,this._nodeCommands=[],this._pickIds=[],this._rtcCenter=void 0,this._rtcCenterEye=void 0,this._rtcCenter3D=void 0,this._rtcCenter2D=void 0,this._packedClippingPlanes=[]}function j(e){return e.stencilBuffer}function Y(e,t,r){if(e._state!==ze.LOADED)throw new _e("The model is not loaded.  Use Model.readyPromise or wait for Model.ready to be true.");if(!ge(r))throw new _e("name is required.");return e._runtime[t][r]}t(H.prototype,{gltf:{get:function(){return ge(this._cachedGltf)?this._cachedGltf.gltf:void 0}},releaseGltfJson:{get:function(){return this._releaseGltfJson}},cacheKey:{get:function(){return this._cacheKey}},basePath:{get:function(){return this._resource.url}},boundingSphere:{get:function(){if(this._state!==ze.LOADED)throw new _e("The model is not loaded.  Use Model.readyPromise or wait for Model.ready to be true.");var e=this.modelMatrix;this.heightReference!==Re.NONE&&this._clampedModelMatrix&&(e=this._clampedModelMatrix);var t=we.getScale(e,z),r=ge(this.maximumScale)?Math.min(this.maximumScale,this.scale):this.scale;he.multiplyByScalar(t,r,t);var i=this._scaledBoundingSphere;return i.center=he.multiplyComponents(this._boundingSphere.center,t,i.center),i.radius=he.maximumComponent(t)*this._initialRadius,ge(this._rtcCenter)&&he.add(this._rtcCenter,i.center,i.center),i}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},asynchronous:{get:function(){return this._asynchronous}},allowPicking:{get:function(){return this._allowPicking}},incrementallyLoadTextures:{get:function(){return this._incrementallyLoadTextures}},pendingTextureLoads:{get:function(){return ge(this._loadResources)?this._loadResources.pendingTextureLoads:0}},dirty:{get:function(){return this._dirty}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(ge(e)&&e.far<=e.near)throw new _e("far must be greater than near");this._distanceDisplayCondition=r.clone(e,this._distanceDisplayCondition)}},extensionsUsed:{get:function(){return ge(this._extensionsUsed)||(this._extensionsUsed=Be.getUsedExtensions(this.gltf)),this._extensionsUsed}},extensionsRequired:{get:function(){return ge(this._extensionsRequired)||(this._extensionsRequired=Be.getRequiredExtensions(this.gltf)),this._extensionsRequired}},upAxis:{get:function(){return this._upAxis}},trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},texturesByteLength:{get:function(){return this._texturesByteLength}},cachedGeometryByteLength:{get:function(){return this._cachedGeometryByteLength}},cachedTexturesByteLength:{get:function(){return this._cachedTexturesByteLength}}}),H.silhouetteSupported=function(e){return j(e.context)},H.fromGltf=function(e){if(!ge(e)||!ge(e.url))throw new _e("options.url is required");ge(e.headers)&&l("Model.fromGltf.headers","The options.headers parameter has been deprecated. Specify options.url as a Resource instance and set the headers property there.");var t=e.url;e=w(e);var r=f.createIfNeeded(t,{headers:e.headers}),i=me(e.basePath,r.clone()),n=f.createIfNeeded(i,{headers:e.headers}),o=me(e.cacheKey,u(r.url));ge(e.basePath)&&!ge(e.cacheKey)&&(o+=n.url),e.cacheKey=o,e.basePath=n;var a=new H(e),s=W[o];return ge(s)?s.ready||(++s.count,s.modelsToLoad.push(a)):((s=new G({ready:!1})).count=1,s.modelsToLoad.push(a),q(a,s),W[o]=s,ge(r.headers.Accept)||(r.headers.Accept="model/gltf-binary,model/gltf+json;q=0.8,application/json;q=0.2,*/*;q=0.01"),r.fetchArrayBuffer().then(function(e){var t=new Uint8Array(e);if("glTF"===c(t)){var r=M(t);s.makeReady(r,t)}else{var i=ve(t);s.makeReady(JSON.parse(i))}}).otherwise(We(a,"model",t))),a},H._gltfCache=W,H.prototype.getNode=function(e){var t=Y(this,"nodesByName",e);return ge(t)?t.publicNode:void 0},H.prototype.getMesh=function(e){return Y(this,"meshesByName",e)},H.prototype.getMaterial=function(e){return Y(this,"materialsByName",e)};var qe=new he,Ge=new he;function We(e,t,r){return function(){e._state=ze.FAILED,e._readyPromise.reject(new g("Failed to load "+t+": "+r))}}function He(i,n){return function(e){var t=i._loadResources,r=new Uint8Array(e);--t.pendingBufferLoads,i.gltf.buffers[n].extras._pipeline.source=r}}function je(i,n,o){return function(e){var t=i.gltf,r=i._loadResources;--r.pendingTextureLoads,r.texturesToCreate.enqueue({id:n,image:e,bufferView:e.bufferView,width:e.width,height:e.height,internalFormat:e.internalFormat}),t.images[o].extras._pipeline.source=e}}var Ye=/(^data:image\/ktx)|(\.ktx$)/i,Xe=/(^data:image\/crn)|(\.crn$)/i;var X=function(){this.id=void 0,this.model=void 0,this.context=void 0};function Q(e,t,r){var i=t._loadResources,n=t.gltf.bufferViews[e],o=_.createVertexBuffer({context:r,typedArray:i.getBuffer(n),usage:v.STATIC_DRAW});o.vertexArrayDestroyable=!1,t._rendererResources.buffers[e]=o,t._geometryByteLength+=o.sizeInBytes}X.prototype.set=function(e,t,r){this.id=e,this.model=t,this.context=r},X.prototype.execute=function(){Q(this.id,this.model,this.context)};var Z=function(){this.id=void 0,this.componentType=void 0,this.model=void 0,this.context=void 0};function K(e,t,r,i){var n=r._loadResources,o=r.gltf.bufferViews[e],a=_.createIndexBuffer({context:i,typedArray:n.getBuffer(o),usage:v.STATIC_DRAW,indexDatatype:t});a.vertexArrayDestroyable=!1,r._rendererResources.buffers[e]=a,r._geometryByteLength+=a.sizeInBytes}Z.prototype.set=function(e,t,r,i){this.id=e,this.componentType=t,this.model=r,this.context=i},Z.prototype.execute=function(){K(this.id,this.componentType,this.model,this.context)};var J=new X,$=new Z;function Qe(e,t){var r=e.gltf,i=t.material,n=r.materials[i].technique;return r.techniques[n].program}function ee(e){var t=e.gltf;return!!ge(t.asset)&&me(t.asset.premultipliedAlpha,!1)}function te(e,t,r){return ge(r)&&(e=r(e,t)),e}var re=function(){this.id=void 0,this.model=void 0,this.context=void 0};function ie(e,t,r){var i=t.gltf.programs,n=t.gltf.shaders,o=i[e],a=function(e,t){var r,i={},n=t.length;for(r=1;r<n;++r){var o=t[r];if(/pos/i.test(o)){t[r]=t[0],t[0]=o;break}}for(r=0;r<n;++r)i[t[r]]=r;return i}(0,o.attributes),s=n[o.vertexShader].extras._pipeline.source,l=n[o.fragmentShader].extras._pipeline.source,u=o.attributes.length,c=t._precreatedAttributes;if(ge(c))for(var d in c)c.hasOwnProperty(d)&&(a[d]=u++);t.extensionsUsed.WEB3D_quantized_attributes&&(s=function(e,t,r){for(var i,n=r._programPrimitives[t],o=0;o<n.length&&Qe(r,i=n[o])!==t;o++);var a=Be.modifyShaderForQuantizedAttributes(r.gltf,i,e);return r._quantizedUniforms[t]=a.uniforms,r._programPrimitives[t]=void 0,a.shader}(s,e,t));var h,p,f,m=ee(t),g=(h=l,p=m,h=E.replaceMain(h,"gltf_blend_main"),h+="uniform vec4 gltf_color; \nuniform float gltf_colorBlend; \nvoid main() \n{ \n    gltf_blend_main(); \n",p&&(h+="    float alpha = 1.0 - ceil(gl_FragColor.a) + gl_FragColor.a; \n    gl_FragColor.rgb /= alpha; \n"),h+="    gl_FragColor.rgb = mix(gl_FragColor.rgb, gltf_color.rgb, gltf_colorBlend); \n    float highlight = ceil(gltf_colorBlend); \n    gl_FragColor.rgb *= mix(gltf_color.rgb, vec3(1.0), highlight); \n    gl_FragColor.a *= gltf_color.a; \n} \n");C.isSupported()&&(f=g,f=E.replaceMain(f,"gltf_clip_main"),g=f+="uniform int gltf_clippingPlanesLength; \nuniform bool gltf_clippingPlanesUnionRegions; \nuniform vec4 gltf_clippingPlanes[czm_maxClippingPlanes]; \nuniform vec4 gltf_clippingPlanesEdgeStyle; \nvoid main() \n{ \n    gltf_clip_main(); \n    if (gltf_clippingPlanesLength > 0) \n    { \n        float clipDistance; \n        if (gltf_clippingPlanesUnionRegions) \n        { \n            clipDistance = czm_discardIfClippedWithUnion(gltf_clippingPlanes, gltf_clippingPlanesLength); \n        } \n        else \n        { \n            clipDistance = czm_discardIfClippedWithIntersect(gltf_clippingPlanes, gltf_clippingPlanesLength); \n        } \n        \n        vec4 clippingPlanesEdgeColor = vec4(1.0); \n        clippingPlanesEdgeColor.rgb = gltf_clippingPlanesEdgeStyle.rgb; \n        float clippingPlanesEdgeWidth = gltf_clippingPlanesEdgeStyle.a; \n        if (clipDistance > 0.0 && clipDistance < clippingPlanesEdgeWidth) \n        { \n            gl_FragColor = clippingPlanesEdgeColor; \n        } \n    } \n} \n");var _=te(s,e,t._vertexShaderLoaded),v=te(g,e,t._fragmentShaderLoaded);if(t._rendererResources.programs[e]=T.fromCache({context:r,vertexShaderSource:_,fragmentShaderSource:v,attributeLocations:a}),t.allowPicking){var y=te(s,e,t._pickVertexShaderLoaded),b=te(l,e,t._pickFragmentShaderLoaded);t._pickFragmentShaderLoaded||(b=E.createPickFragmentShaderSource(l,"uniform")),t._rendererResources.pickPrograms[e]=T.fromCache({context:r,vertexShaderSource:y,fragmentShaderSource:b,attributeLocations:a})}}re.prototype.set=function(e,t,r){this.id=e,this.model=t,this.context=r},re.prototype.execute=function(){ie(this.id,this.model,this.context)};var le=new re;function ue(t,r){return function(e){t.texturesToCreate.enqueue({id:r.id,image:e,bufferView:void 0}),--t.pendingBufferViewToImage}}var ce=function(){this.gltfTexture=void 0,this.model=void 0,this.context=void 0};function Ze(e,t,r){var i=t.gltf.textures[e.id],n=t._rendererResources.samplers[i.sampler];n=me(n,new y({wrapS:P.REPEAT,wrapT:P.REPEAT}));var o,a=e.internalFormat,s=!(ge(a)&&h.isCompressedFormat(a)||n.minificationFilter!==A.NEAREST_MIPMAP_NEAREST&&n.minificationFilter!==A.NEAREST_MIPMAP_LINEAR&&n.minificationFilter!==A.LINEAR_MIPMAP_NEAREST&&n.minificationFilter!==A.LINEAR_MIPMAP_LINEAR),l=s||n.wrapS===P.REPEAT||n.wrapS===P.MIRRORED_REPEAT||n.wrapT===P.REPEAT||n.wrapT===P.MIRRORED_REPEAT,u=e.image;if(ge(a)&&i.target===Ee.TEXTURE_2D)o=new b({context:r,source:{arrayBufferView:e.bufferView},width:e.width,height:e.height,pixelFormat:a,sampler:n});else if(ge(u)){var c=!Ce.isPowerOfTwo(u.width)||!Ce.isPowerOfTwo(u.height);if(l&&c){var d=document.createElement("canvas");d.width=Ce.nextPowerOfTwo(u.width),d.height=Ce.nextPowerOfTwo(u.height),d.getContext("2d").drawImage(u,0,0,u.width,u.height,0,0,d.width,d.height),u=d}i.target===Ee.TEXTURE_2D&&(o=new b({context:r,source:u,pixelFormat:i.internalFormat,pixelDatatype:i.type,sampler:n,flipY:!1}),s&&o.generateMipmap())}ge(o)&&(t._rendererResources.textures[e.id]=o,t._texturesByteLength+=o.sizeInBytes)}ce.prototype.set=function(e,t,r){this.gltfTexture=e,this.model=t,this.context=r},ce.prototype.execute=function(){Ze(this.gltfTexture,this.model,this.context)};var Ke=new ce;function Je(e,t){var r,i,n=e.gltf,o={},a=n.techniques[n.materials[t.material].technique],s=a.parameters,l=a.attributes,u=e._rendererResources.programs[a.program],c=u.vertexAttributes,d=u._attributeLocations;for(r in c)if(c.hasOwnProperty(r)){var h=l[r];if(i=c[r].index,ge(h))o[s[h].semantic]=i}var p=e._precreatedAttributes;if(ge(p))for(r in p)p.hasOwnProperty(r)&&(i=d[r],o[r]=i);return o}function $e(e,t){for(var r=e.length,i={},n=0;n<r;++n)for(var o=[e[n]];0<o.length;){var a=o.pop(),s=t[a];ge(s)&&(i[a]=a);for(var l=s.children,u=l.length,c=0;c<u;++c)o.push(l[c])}return i}function et(n){var e=n._loadResources;if(0===e.pendingBufferLoads&&e.createSkins){e.createSkins=!1;var t=n.gltf,o=t.accessors,a={};Pe.skin(t,function(e,t){var r,i=o[e.inverseBindMatrices];we.equals(e.bindShapeMatrix,we.IDENTITY)||(r=we.clone(e.bindShapeMatrix)),a[t]={inverseBindMatrices:U.getSkinInverseBindMatrices(n,i),bindShapeMatrix:r}}),function(e,t){for(var r=e.gltf,i=r.skins,n=r.nodes,o=e._runtime.nodes,a=e._loadResources.skinnedNodesIds,s=a.length,l=0;l<s;++l){var u=a[l],c=o[u],d=n[u],h=t[d.skin];c.inverseBindMatrices=h.inverseBindMatrices,c.bindShapeMatrix=h.bindShapeMatrix;var p=[],f=i[d.skin];ge(f.skeleton)&&p.push(f.skeleton);for(var m=$e(p,n),g=i[d.skin].joints,_=g.length,v=0;v<_;++v){var y=o[m[g[v]]];c.joints.push(y)}}}(n,a)}}function tt(t,r,i,n){return function(e){ge(n)&&(e=t.clampAnimations?n.clampTime(e):n.wrapTime(e),r[i]=n.evaluate(e,r[i]),r.dirtyNumber=t._maxDirtyNumber)}}function rt(e,t){var r=e._loadResources;if(r.finishedBuffersCreation()&&r.finishedProgramCreation()&&r.createVertexArrays){r.createVertexArrays=!1;var i=e._rendererResources.buffers,n=e._rendererResources.vertexArrays,o=e.gltf,a=o.accessors,s=o.meshes;for(var l in s)if(s.hasOwnProperty(l))for(var u=s[l].primitives,c=u.length,d=0;d<c;++d){var h,p,f,m=u[d],g=Je(e,m),_=[],v=m.attributes;for(h in v)if(v.hasOwnProperty(h)&&(p=g[h],ge(p))){var y=a[v[h]],b=!1;ge(y.normalized)&&y.normalized&&(b=!0),_.push({index:p,vertexBuffer:i[y.bufferView],componentsPerAttribute:I(y.type),componentDatatype:y.componentType,normalize:b,offsetInBytes:y.byteOffset,strideInBytes:O(o,y)})}var C,w=e._precreatedAttributes;if(ge(w))for(h in w)w.hasOwnProperty(h)&&(p=g[h],ge(p)&&((f=w[h]).index=p,_.push(f)));if(ge(m.indices))C=i[a[m.indices].bufferView];n[l+".primitive."+d]=new D({context:t,attributes:_,indexBuffer:C})}}}function it(e,t,r){var i=e._rendererResources.renderStates,n=e.gltf.techniques[t].states,o=function(e){var t={};t[Ee.BLEND]=!1,t[Ee.CULL_FACE]=!1,t[Ee.DEPTH_TEST]=!1,t[Ee.POLYGON_OFFSET_FILL]=!1;var r,i=e.enable,n=i.length;for(r=0;r<n;++r)t[i[r]]=!0;return t}(n),a=me(n.functions,me.EMPTY_OBJECT),s=me(a.blendColor,[0,0,0,0]),l=me(a.blendEquationSeparate,[Ee.FUNC_ADD,Ee.FUNC_ADD]),u=me(a.blendFuncSeparate,[Ee.ONE,Ee.ZERO,Ee.ONE,Ee.ZERO]),c=me(a.colorMask,[!0,!0,!0,!0]),d=me(a.depthRange,[0,1]),h=me(a.polygonOffset,[0,0]);o[Ee.BLEND]&&ee(e)&&u[0]===Ee.ONE&&u[1]===Ee.ONE_MINUS_SRC_ALPHA&&(u[0]=Ee.SRC_ALPHA,u[1]=Ee.ONE_MINUS_SRC_ALPHA,u[2]=Ee.SRC_ALPHA,u[3]=Ee.ONE_MINUS_SRC_ALPHA),i[t]=S.fromCache({frontFace:ge(a.frontFace)?a.frontFace[0]:Ee.CCW,cull:{enabled:o[Ee.CULL_FACE],face:ge(a.cullFace)?a.cullFace[0]:Ee.BACK},lineWidth:ge(a.lineWidth)?a.lineWidth[0]:1,polygonOffset:{enabled:o[Ee.POLYGON_OFFSET_FILL],factor:h[0],units:h[1]},depthRange:{near:d[0],far:d[1]},depthTest:{enabled:o[Ee.DEPTH_TEST],func:ge(a.depthFunc)?a.depthFunc[0]:Ee.LESS},colorMask:{red:c[0],green:c[1],blue:c[2],alpha:c[3]},depthMask:!ge(a.depthMask)||a.depthMask[0],blending:{enabled:o[Ee.BLEND],color:{red:s[0],green:s[1],blue:s[2],alpha:s[3]},equationRgb:l[0],equationAlpha:l[1],functionSourceRgb:u[0],functionDestinationRgb:u[1],functionSourceAlpha:u[2],functionDestinationAlpha:u[3]}})}var nt={MODEL:function(e,t,r){return function(){return r.computedMatrix}},VIEW:function(e,t,r){return function(){return e.view}},PROJECTION:function(e,t,r){return function(){return e.projection}},MODELVIEW:function(e,t,r){var i=new we;return function(){return we.multiplyTransformation(e.view,r.computedMatrix,i)}},CESIUM_RTC_MODELVIEW:function(e,t,r){var i=new we;return function(){return we.multiplyTransformation(e.view,r.computedMatrix,i),we.setTranslation(i,t._rtcCenterEye,i)}},MODELVIEWPROJECTION:function(e,t,r){var i=new we;return function(){return we.multiplyTransformation(e.view,r.computedMatrix,i),we.multiply(e._projection,i,i)}},MODELINVERSE:function(e,t,r){var i=new we;return function(){return we.inverse(r.computedMatrix,i)}},VIEWINVERSE:function(e,t){return function(){return e.inverseView}},PROJECTIONINVERSE:function(e,t,r){return function(){return e.inverseProjection}},MODELVIEWINVERSE:function(e,t,r){var i=new we,n=new we;return function(){return we.multiplyTransformation(e.view,r.computedMatrix,i),we.inverse(i,n)}},MODELVIEWPROJECTIONINVERSE:function(e,t,r){var i=new we,n=new we;return function(){return we.multiplyTransformation(e.view,r.computedMatrix,i),we.multiply(e._projection,i,i),we.inverse(i,n)}},MODELINVERSETRANSPOSE:function(e,t,r){var i=new we,n=new s;return function(){return we.inverse(r.computedMatrix,i),we.getRotation(i,n),s.transpose(n,n)}},MODELVIEWINVERSETRANSPOSE:function(e,t,r){var i=new we,n=new we,o=new s;return function(){return we.multiplyTransformation(e.view,r.computedMatrix,i),we.inverse(i,n),we.getRotation(n,o),s.transpose(o,o)}},VIEWPORT:function(e,t,r){return function(){return e.viewportCartesian4}}};function ot(e){return function(){return e}}function at(e){return function(){return e.computedJointMatrices}}function st(e){return function(){return e.weights}}function lt(e){return function(){return e.silhouetteColor}}function ut(e){return function(){return e.silhouetteSize}}function ct(e){return function(){return e.color}}function dt(e){return function(){return e._packedClippingPlanes.length}}function ht(t){return function(){var e=t.clippingPlanes;return!!ge(e)&&e.unionClippingRegions}}function pt(r){return function(){var e=r.clippingPlanes,t=r._packedClippingPlanes;return ge(e)&&e.enabled&&e.transformAndPackPlanes(r._modelViewMatrix,t),t}}function ft(r){return function(){var e=r.clippingPlanes;if(!ge(e))return a.WHITE.withAlpha(0);var t=a.clone(e.edgeColor);return t.alpha=e.edgeWidth,t}}function mt(e){return function(){return F.getColorBlend(e.colorBlendMode,e.colorBlendAmount)}}function gt(e,t){switch(e.mode){case Se.TRIANGLES:return t/3;case Se.TRIANGLE_STRIP:case Se.TRIANGLE_FAN:return Math.max(t-2,0);default:return 0}}function _t(e,t,r,i,n){for(var o,a,s,l,u=e._nodeCommands,c=e._pickIds,d=e.allowPicking,h=e._runtime.meshesByName,p=e._rendererResources,f=p.vertexArrays,m=p.programs,g=p.pickPrograms,_=p.renderStates,v=e._uniformMaps,y=e.gltf,b=y.accessors,C=y.meshes,w=y.techniques,S=y.materials,T=t.mesh,E=C[T],A=E.primitives,x=A.length,P=0;P<x;++P){var D,O=A[P],I=b[O.indices],M=S[O.material],R=w[M.technique],L=R.program,N=O.attributes.POSITION;if(ge(N)){var k=Be.getAccessorMinMax(y,N);D=de.fromCornerPoints(he.fromArray(k.min),he.fromArray(k.max))}var F,B,U=f[T+".primitive."+P];if(ge(I))B=I.count,F=I.byteOffset/oe.getSizeInBytes(I.componentType);else B=b[O.attributes.POSITION].count,F=0;e._trianglesLength+=gt(O,B);var V=v[O.material],z=V.uniformMap;if(ge(V.jointMatrixUniformName)){var q={};q[V.jointMatrixUniformName]=at(r),z=ne(z,q)}if(ge(V.morphWeightsUniformName)){var G={};G[V.morphWeightsUniformName]=st(r),z=ne(z,G)}if(z=ne(z,{gltf_color:ct(e),gltf_colorBlend:mt(e),gltf_clippingPlanesLength:dt(e),gltf_clippingPlanesUnionRegions:ht(e),gltf_clippingPlanes:pt(e),gltf_clippingPlanesEdgeStyle:ft(e)}),ge(e._uniformMapLoaded)&&(z=e._uniformMapLoaded(z,L,r)),e.extensionsUsed.WEB3D_quantized_attributes){var W=(void 0,s=Qe(o=e,a=O),l=o._quantizedUniforms[s],Be.createUniformsForQuantizedAttributes(o.gltf,a,l));z=ne(z,W)}var H=_[M.technique],j=H.blending.enabled,Y=e._pickObject;ge(Y)||(Y={primitive:e,id:e.id,node:r.publicNode,mesh:h[E.name]});var X,Q,Z,K=Ve.castShadows(e._shadows),J=Ve.receiveShadows(e._shadows),$=new ae({boundingVolume:new de,cull:e.cull,modelMatrix:new we,primitiveType:O.mode,vertexArray:U,count:B,offset:F,shaderProgram:m[R.program],castShadows:K,receiveShadows:J,uniformMap:z,renderState:H,owner:Y,pass:j?se.TRANSLUCENT:e.opaquePass});if(d){var ee;if(ge(e._pickFragmentShaderLoaded))ee=ge(e._pickUniformMapLoaded)?e._pickUniformMapLoaded(z):ne(z);else{var te=i.createPickId(Y);c.push(te);var re={czm_pickColor:ot(te.color)};ee=ne(z,re)}X=new ae({boundingVolume:new de,cull:e.cull,modelMatrix:new we,primitiveType:O.mode,vertexArray:U,count:B,offset:F,shaderProgram:g[R.program],uniformMap:ee,renderState:H,owner:Y,pass:j?se.TRANSLUCENT:e.opaquePass})}n||((Q=ae.shallowClone($)).boundingVolume=new de,Q.modelMatrix=new we,d&&((Z=ae.shallowClone(X)).boundingVolume=new de,Z.modelMatrix=new we));var ie={show:!0,boundingSphere:D,command:$,pickCommand:X,command2D:Q,pickCommand2D:Z,silhouetteModelCommand:void 0,silhouetteModelCommand2D:void 0,silhouetteColorCommand:void 0,silhouetteColorCommand2D:void 0,translucentCommand:void 0,translucentCommand2D:void 0};r.commands.push(ie),u.push(ie)}}function vt(e,t){var r=t.context,i=t.scene3DOnly;if(Be.checkSupportedGlExtensions(e.gltf.glExtensionsUsed,r),e._loadRendererResourcesFromCache){var n=e._rendererResources,o=e._cachedRendererResources;n.buffers=o.buffers,n.vertexArrays=o.vertexArrays,n.programs=o.programs,n.pickPrograms=o.pickPrograms,n.silhouettePrograms=o.silhouettePrograms,n.textures=o.textures,n.samplers=o.samplers,n.renderStates=o.renderStates,ge(e._precreatedAttributes)&&rt(e,r),e._cachedGeometryByteLength+=function(e){var t=0;for(var r in e)e.hasOwnProperty(r)&&(t+=e[r].sizeInBytes);return t}(o.buffers),e._cachedTexturesByteLength+=function(e){var t=0;for(var r in e)e.hasOwnProperty(r)&&(t+=e[r].sizeInBytes);return t}(o.textures)}else!function(e,t){var r=e._loadResources;if(0===r.pendingBufferLoads){var i,n=t.context,o=r.vertexBuffersToCreate,a=r.indexBuffersToCreate;if(e.asynchronous){for(;0<o.length&&(J.set(o.peek(),e,n),t.jobScheduler.execute(J,B.BUFFER));)o.dequeue();for(;0<a.length&&(i=a.peek(),$.set(i.id,i.componentType,e,n),t.jobScheduler.execute($,B.BUFFER));)a.dequeue()}else{for(;0<o.length;)Q(o.dequeue(),e,n);for(;0<a.length;)K((i=a.dequeue()).id,i.componentType,e,n)}}}(e,t),function(e,t){var r=e._loadResources,i=r.programsToCreate;if(0===r.pendingShaderLoads&&0===r.pendingBufferLoads){var n=t.context;if(e.asynchronous)for(;0<i.length&&(le.set(i.peek(),e,n),t.jobScheduler.execute(le,B.PROGRAM));)i.dequeue();else for(;0<i.length;)ie(i.dequeue(),e,n)}}(e,t),function(e,t){var r=e._loadResources;if(r.createSamplers){r.createSamplers=!1;var i=e._rendererResources.samplers,n=e.gltf.samplers;for(var o in n)if(n.hasOwnProperty(o)){var a=n[o];i[o]=new y({wrapS:a.wrapS,wrapT:a.wrapT,minificationFilter:a.minFilter,magnificationFilter:a.magFilter})}}}(e),function(e){var t=e._loadResources;if(0===t.pendingBufferLoads)for(;0<t.texturesToCreateFromBufferView.length;){var r=t.texturesToCreateFromBufferView.dequeue(),i=e.gltf,n=i.bufferViews[r.bufferView],o=i.textures[r.id].source,a=We(e,"image","id: "+r.id+", bufferView: "+r.bufferView);if("image/ktx"===r.mimeType)be(t.getBuffer(n)).then(je(e,r.id,o)).otherwise(a),++e._loadResources.pendingTextureLoads;else if("image/crn"===r.mimeType)ye(t.getBuffer(n)).then(je(e,r.id,o)).otherwise(a),++e._loadResources.pendingTextureLoads;else{var s=ue(t,r);d(t.getBuffer(n),r.mimeType).then(s).otherwise(a),++t.pendingBufferViewToImage}}}(e),function(e,t){var r=t.context,i=e._loadResources.texturesToCreate;if(e.asynchronous)for(;0<i.length&&(Ke.set(i.peek(),e,r),t.jobScheduler.execute(Ke,B.TEXTURE));)i.dequeue();else for(;0<i.length;)Ze(i.dequeue(),e,r)}(e,t);et(e),function(e){var t=e._loadResources;if(t.finishedPendingBufferLoads()&&t.createRuntimeAnimations){t.createRuntimeAnimations=!1,e._runtime.animations=[];for(var r=e._runtime.nodes,i=e.gltf.animations,n=e.gltf.accessors,o=i.length,a=0;a<o;++a){for(var s=i[a],l=s.channels,u=s.samplers,c=Number.MAX_VALUE,d=-Number.MAX_VALUE,h=l.length,p=new Array(h),f=0;f<h;++f){var m=l[f],g=m.target,_=g.path,v=u[m.sampler],y=U.getAnimationParameterValues(e,n[v.input]),b=U.getAnimationParameterValues(e,n[v.output]);c=Math.min(c,y[0]),d=Math.max(d,y[y.length-1]);var C=U.getAnimationSpline(e,a,s,m.sampler,v,y,_,b);p[f]=tt(e,r[g.node],g.path,C)}e._runtime.animations[a]={name:s.name,startTime:c,stopTime:d,channelEvaluators:p}}}}(e),e._loadRendererResourcesFromCache||(rt(e,r),function(e,t){var r=e._loadResources,i=e.gltf.techniques;if(r.createRenderStates)for(var n in r.createRenderStates=!1,i)i.hasOwnProperty(n)&&it(e,n)}(e)),function(e,t){var r=e._loadResources;if(r.finishedProgramCreation()&&r.createUniformMaps){r.createUniformMaps=!1;var i,n,o,a,s,l=e.gltf,u=l.materials,c=l.techniques,d=e._uniformMaps,h=e._rendererResources.textures,p=e._defaultTexture;for(var f in u)if(u.hasOwnProperty(f)){var m,g=u[f];m=g.values;var _,v,y=c[g.technique],b=y.parameters,C=y.uniforms,w={},S={};for(var T in C)if(C.hasOwnProperty(T)&&"extras"!==T){var E=C[T],A=b[E];if(ge(m[E])){var x=Be.createUniformFunction(A.type,m[E],h,p);w[T]=x.func,S[E]=x}else if(ge(A.node))w[T]=(i=A.node,n=e,o=A.semantic,a=t.uniformState,s=n._runtime.nodes[i],nt[o](a,n,s));else if(ge(A.semantic))"JOINTMATRIX"===A.semantic?_=T:"MORPHWEIGHTS"===A.semantic?v=T:w[T]=Be.getGltfSemanticUniforms()[A.semantic](t.uniformState,e);else if(ge(A.value)){var P=Be.createUniformFunction(A.type,A.value,h,p);w[T]=P.func,S[E]=P}}var D=d[f];D.uniformMap=w,D.values=S,D.jointMatrixUniformName=_,D.morphWeightsUniformName=v}}}(e,r),function(e,t,r){var i=e._loadResources;if(i.finishedEverythingButTextureCreation()&&i.createRuntimeNodes){i.createRuntimeNodes=!1;for(var n=[],o=e._runtime.nodes,a=e.gltf,s=a.nodes,l=a.skins,u=a.scenes[a.scene].nodes,c=u.length,d=[],h={},p=0;p<c;++p){d.push({parentRuntimeNode:void 0,gltfNode:s[u[p]],id:u[p]});for(var f=[];0<d.length;){var m=d.pop();h[m.id]=!0;var g=m.parentRuntimeNode,_=m.gltfNode,v=o[m.id];if(0===v.parents.length)if(ge(_.matrix))v.matrix=we.fromColumnMajorArray(_.matrix);else{var y=_.rotation;v.translation=he.fromArray(_.translation),v.rotation=x.unpack(y),v.scale=he.fromArray(_.scale)}ge(g)?(g.children.push(v),v.parents.push(g)):n.push(v),ge(_.mesh)&&_t(e,_,v,t,r);for(var b=_.children,C=b.length,w=0;w<C;w++){var S=b[w];h[S]||d.push({parentRuntimeNode:v,gltfNode:s[S],id:b[w]})}var T=_.skin;if(ge(T)&&f.push(l[T].skeleton),0===d.length)for(var E=0;E<f.length;E++){var A=f[E];h[A]||d.push({parentRuntimeNode:void 0,gltfNode:s[A],id:A})}}}e._runtime.rootNodes=n,e._runtime.nodes=o}}(e,r,i)}function yt(e,t){var r=e.publicNode,i=r.matrix;r.useMatrix&&ge(i)?we.clone(i,t):ge(e.matrix)?we.clone(e.matrix,t):(we.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t),r.setMatrix(t))}var bt=[],Ct=new pe,wt=new we;var St=new we;function Tt(e){var t,r,i=ae.shallowClone(e);return i.pass=se.TRANSLUCENT,i.renderState=(t=e.renderState,(r=w(t,!0)).cull.enabled=!1,r.depthTest.enabled=!0,r.depthMask=!1,r.blending=k.ALPHA_BLEND,S.fromCache(r)),i}function Et(e,t){var r=e._rendererResources.programs;for(var i in r)if(r.hasOwnProperty(i)&&r[i]===t)return i}function At(e,t,r){var i=t.vertexShaderSource.sources[0],n=t._attributeLocations,o=e._normalAttributeName;i=E.replaceMain(i,"gltf_silhouette_main"),i+="uniform float gltf_silhouetteSize; \nvoid main() \n{ \n    gltf_silhouette_main(); \n    vec3 n = normalize(czm_normal3D * "+o+"); \n    n.x *= czm_projection[0][0]; \n    n.y *= czm_projection[1][1]; \n    vec4 clip = gl_Position; \n    clip.xy += n.xy * clip.w * gltf_silhouetteSize / czm_viewport.z; \n    gl_Position = clip; \n}";return T.fromCache({context:r.context,vertexShaderSource:i,fragmentShaderSource:"uniform vec4 gltf_silhouetteColor; \nvoid main() \n{ \n    gl_FragColor = gltf_silhouetteColor; \n}",attributeLocations:n})}function xt(e,t){return j(t.context)&&0<e.silhouetteSize&&0<e.silhouetteColor.alpha&&ge(e._normalAttributeName)}function Pt(e){return 0<e.color.alpha&&e.color.alpha<1}function Dt(e){return 0===e.color.alpha}function Ot(e,t){return Math.floor(e)!==Math.floor(t)||Math.ceil(e)!==Math.ceil(t)}var It=0;function Mt(e,t){for(var r=++It%255,i=function(e){for(var t=e._nodeCommands,r=t.length,i=0;i<r;++i)if(t[i].command.pass===se.TRANSLUCENT)return!0;return!1}(e)||Pt(e)||e.silhouetteColor.alpha<1,n=e._rendererResources.silhouettePrograms,o=t.scene3DOnly,a=e._nodeCommands,s=a.length,l=0;l<s;++l){var u=a[l],c=u.command,d=Pt(e)?u.translucentCommand:c,h=ae.shallowClone(d),p=w(d.renderState);p.stencilTest={enabled:!0,frontFunction:Ee.ALWAYS,backFunction:Ee.ALWAYS,reference:r,mask:-1,frontOperation:{fail:Ee.KEEP,zFail:Ee.KEEP,zPass:Ee.REPLACE},backOperation:{fail:Ee.KEEP,zFail:Ee.KEEP,zPass:Ee.REPLACE}},Dt(e)&&(p.colorMask={red:!1,green:!1,blue:!1,alpha:!1},p.depthMask=!1),p=S.fromCache(p),h.renderState=p,u.silhouetteModelCommand=h;var f=ae.shallowClone(c);(p=w(c.renderState,!0)).depthTest.enabled=!0,p.cull.enabled=!1,i&&(f.pass=se.TRANSLUCENT,p.depthMask=!1,p.blending=k.ALPHA_BLEND),p.stencilTest={enabled:!0,frontFunction:Ee.NOTEQUAL,backFunction:Ee.NOTEQUAL,reference:r,mask:-1,frontOperation:{fail:Ee.KEEP,zFail:Ee.KEEP,zPass:Ee.KEEP},backOperation:{fail:Ee.KEEP,zFail:Ee.KEEP,zPass:Ee.KEEP}},p=S.fromCache(p);var m=c.shaderProgram,g=Et(e,m),_=n[g];ge(_)||(_=At(e,m,t),n[g]=_);var v=ne(c.uniformMap,{gltf_silhouetteColor:lt(e),gltf_silhouetteSize:ut(e)});if(f.renderState=p,f.shaderProgram=_,f.uniformMap=v,f.castShadows=!1,f.receiveShadows=!1,u.silhouetteColorCommand=f,!o){var y=u.command2D,b=ae.shallowClone(h);b.boundingVolume=y.boundingVolume,b.modelMatrix=y.modelMatrix,u.silhouetteModelCommand2D=b;var C=ae.shallowClone(f);b.boundingVolume=y.boundingVolume,b.modelMatrix=y.modelMatrix,u.silhouetteColorCommand2D=C}}}var Rt=new de;var Lt=new he,Nt=new fe;function kt(e,t){var r,i,n,o=e.scale;if(0!==e.minimumPixelSize){var a=t.context,s=Math.max(a.drawingBufferWidth,a.drawingBufferHeight),l=ge(e._clampedModelMatrix)?e._clampedModelMatrix:e.modelMatrix;if(Lt.x=l[12],Lt.y=l[13],Lt.z=l[14],ge(e._rtcCenter)&&he.add(e._rtcCenter,Lt,Lt),e._mode!==Ue.SCENE3D){var u=t.mapProjection,c=u.ellipsoid.cartesianToCartographic(Lt,Nt);u.project(c,Lt),he.fromElements(Lt.z,Lt.x,Lt.y,Lt)}var d=e.boundingSphere.radius,h=(r=Lt,i=d,n=t,Rt.center=r,Rt.radius=i,n.camera.getPixelSize(Rt,n.context.drawingBufferWidth,n.context.drawingBufferHeight)),p=1/h;Math.min(p*(2*d),s)<e.minimumPixelSize&&(o=e.minimumPixelSize*h/(2*e._initialRadius))}return ge(e.maximumScale)?Math.min(e.maximumScale,o):o}function Ft(e){ge(e._cacheKey)&&ge(e._cachedGltf)&&0==--e._cachedGltf.count&&delete W[e._cacheKey],e._cachedGltf=void 0}function Bt(e,t){this.buffers=void 0,this.vertexArrays=void 0,this.programs=void 0,this.pickPrograms=void 0,this.silhouettePrograms=void 0,this.textures=void 0,this.samplers=void 0,this.renderStates=void 0,this.ready=!1,this.context=e,this.cacheKey=t,this.count=0}function Ut(e){for(var t in e)e.hasOwnProperty(t)&&e[t].destroy()}function Vt(i,n,o){return function(e){if(i.heightReference===Re.RELATIVE_TO_GROUND){var t=n.cartesianToCartographic(e,Nt);t.height+=o.height,n.cartographicToCartesian(t,e)}var r=i._clampedModelMatrix;we.clone(i.modelMatrix,r),r[12]=e.x,r[13]=e.y,r[14]=e.z,i._heightChanged=!0}}Bt.prototype.release=function(){if(0==--this.count)return ge(this.cacheKey)&&delete this.context.cache.modelRendererResourceCache[this.cacheKey],Ut((e=this).buffers),Ut(e.vertexArrays),Ut(e.programs),Ut(e.pickPrograms),Ut(e.silhouettePrograms),Ut(e.textures),i(this);var e};var zt=new he,qt=new fe;return H.prototype.update=function(e){if(e.mode!==Ue.MORPHING){var t=e.context;if(this._defaultTexture=t.defaultTexture,this._state===ze.NEEDS_LOAD&&ge(this.gltf)){var r,i=this.cacheKey;if(ge(i)){t.cache.modelRendererResourceCache=me(t.cache.modelRendererResourceCache,{});var n=t.cache.modelRendererResourceCache;if(r=n[this.cacheKey],ge(r)){if(!r.ready)return;++r.count,this._loadRendererResourcesFromCache=!0}else(r=new Bt(t,i)).count=1,n[this.cacheKey]=r;this._cachedRendererResources=r}else(r=new Bt(t)).count=1,this._cachedRendererResources=r;if(this._state=ze.LOADING,this._state!==ze.FAILED){var o=this.gltf.extensions;if(ge(o)&&ge(o.CESIUM_RTC)){var a=he.fromArray(o.CESIUM_RTC.center);if(!he.equals(a,he.ZERO)){this._rtcCenter3D=a;var s=e.mapProjection,l=s.ellipsoid.cartesianToCartographic(this._rtcCenter3D),u=s.project(l);he.fromElements(u.z,u.x,u.y,u),this._rtcCenter2D=u,this._rtcCenterEye=new he,this._rtcCenter=this._rtcCenter3D}}this._loadResources=new Le,this._loadRendererResourcesFromCache||function(e){var t=e._loadResources,r=e.gltf.buffers;for(var i in r)if(r.hasOwnProperty(i)){var n=r[i];if(n.extras=me(n.extras,{}),n.extras._pipeline=me(n.extras._pipeline,{}),ge(n.extras._pipeline.source))t.buffers[i]=n.extras._pipeline.source;else{var o=e._resource.getDerivedResource({url:n.uri});++t.pendingBufferLoads,o.fetchArrayBuffer().then(He(e,i)).otherwise(We(e,"buffer",o.url))}}}(this)}}var c,d,h,p,f,m,g,_,v,y,b,C,w,S,T,E,A,x,P,D,O,I,M,R,L,N=this._loadResources,k=this._incrementallyLoadTextures,F=!1;if(this._state===ze.LOADING){if(0===N.pendingBufferLoads){if(!this._updatedGltfVersion){var B={optimizeForCesium:!0,addBatchIdToGeneratedShaders:this._addBatchIdToGeneratedShaders};e.brdfLutGenerator.update(e),Ie(this.gltf),Be.checkSupportedExtensions(this.extensionsRequired),xe(this.gltf),Ae(this.gltf),De(this.gltf,B),Oe(this.gltf,B),R=(M=this).gltf,L=M._loadResources,Pe.buffer(R,function(e,t){L.buffers[t]=e.extras._pipeline.source}),this._loadRendererResourcesFromCache||(!function(e){var r=e.gltf.bufferViews,i=e._loadResources.vertexBuffersToCreate;Pe.bufferView(e.gltf,function(e,t){e.target===Ee.ARRAY_BUFFER&&i.enqueue(t)});var n=e._loadResources.indexBuffersToCreate,o={};Pe.accessor(e.gltf,function(e){var t=e.bufferView;r[t].target!==Ee.ELEMENT_ARRAY_BUFFER||ge(o[t])||(o[t]=!0,n.enqueue({id:t,componentType:e.componentType}))})}(this),D=(P=this).gltf,O=D.buffers,I=D.bufferViews,Pe.shader(D,function(e,t){if(ge(e.bufferView)){var r=e.bufferView,i=I[r],n=i.buffer,o=O[n],a=ve(o.extras._pipeline.source,i.byteOffset,i.byteLength);P._loadResources.shaders[t]={source:a,bufferView:void 0},e.extras._pipeline.source=a}else if(ge(e.extras._pipeline.source))P._loadResources.shaders[t]={source:e.extras._pipeline.source,bufferView:void 0};else{++P._loadResources.pendingShaderLoads;var s=P._resource.getDerivedResource({url:e.uri});s.fetchText().then((l=P,u=e.type,c=t,function(e){var t=l._loadResources;t.shaders[c]={source:e,type:u,bufferView:void 0},--t.pendingShaderLoads,l.gltf.shaders[c].extras._pipeline.source=e})).otherwise(We(P,"shader",s.url))}var l,u,c}),x=this,Pe.program(x.gltf,function(e,t){x._loadResources.programsToCreate.enqueue(t)}),S=t,E=(w=this).gltf,A=E.images,Pe.texture(E,function(e,t){var r=e.source,i=A[r],n=i.extras,o=i.bufferView,a=i.mimeType;if(T=i.uri,ge(n)&&ge(n.compressedImage3DTiles)){var s=n.compressedImage3DTiles.crunch,l=n.compressedImage3DTiles.s3tc,u=n.compressedImage3DTiles.pvrtc1,c=n.compressedImage3DTiles.etc1;S.s3tc&&ge(s)?(a=s.mimeType,ge(s.bufferView)?o=s.bufferView:T=s.uri):S.s3tc&&ge(l)?(a=l.mimeType,ge(l.bufferView)?o=l.bufferView:T=l.uri):S.pvrtc&&ge(u)?(a=u.mimeType,ge(u.bufferView)?o=u.bufferView:T=u.uri):S.etc1&&ge(c)&&(a=c.mimeType,ge(c.bufferView)?o=c.bufferView:T=c.uri)}if(ge(o))w._loadResources.texturesToCreateFromBufferView.enqueue({id:t,image:void 0,bufferView:o,mimeType:a});else{++w._loadResources.pendingTextureLoads;var d=w._resource.getDerivedResource({url:T});(Ye.test(T)?be(d):Xe.test(T)?ye(d):d.fetchImage()).then(je(w,t,r)).otherwise(We(w,"image",d.url))}})),y={},b={},C=(v=this)._uniformMaps,Pe.material(v.gltf,function(e,t){C[t]={uniformMap:void 0,values:void 0,jointMatrixUniformName:void 0,morphWeightsUniformName:void 0};var r=new Ne(v,e,t);y[e.name]=r,b[t]=r}),v._runtime.materialsByName=y,v._runtime.materialsById=b,g={},_=(m=this)._runtime.materialsById,Pe.mesh(m.gltf,function(e,t){if(g[e.name]=new ke(e,_,t),ge(m.extensionsUsed.WEB3D_quantized_attributes))for(var r=e.primitives,i=r.length,n=0;n<i;n++){var o=r[n],a=Qe(m,o),s=m._programPrimitives[a];ge(s)||(s=[],m._programPrimitives[a]=s),s.push(o)}}),m._runtime.meshesByName=g,d={},h={},p=[],f=(c=this)._loadResources.skinnedNodesIds,Pe.node(c.gltf,function(e,t){var r={matrix:void 0,translation:void 0,rotation:void 0,scale:void 0,computedShow:!0,transformToRoot:new we,computedMatrix:new we,dirtyNumber:0,commands:[],inverseBindMatrices:void 0,bindShapeMatrix:void 0,joints:[],computedJointMatrices:[],jointName:e.jointName,weights:[],children:[],parents:[],publicNode:void 0};r.publicNode=new Fe(c,e,r,t,Be.getTransform(e)),d[t]=r,h[e.name]=r,ge(e.skin)&&(f.push(t),p.push(r))}),c._runtime.nodes=d,c._runtime.nodesByName=h,c._runtime.skinnedNodes=p,this._boundingSphere=function(e){for(var t=e.gltf,r=t.nodes,i=t.meshes,n=t.scenes[t.scene].nodes,o=n.length,a=[],s=new he(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),l=new he(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),u=0;u<o;++u){var c=r[n[u]];for(c._transformToRoot=Be.getTransform(c),a.push(c);0<a.length;){var d=(c=a.pop())._transformToRoot,h=c.mesh;if(ge(h))for(var p=i[h].primitives,f=p.length,m=0;m<f;++m){var g=p[m].attributes.POSITION;if(ge(g)){var _=Be.getAccessorMinMax(t,g),v=he.fromArray(_.min,0,qe),y=he.fromArray(_.max,0,Ge);ge(s)&&ge(l)&&(we.multiplyByPoint(d,v,v),we.multiplyByPoint(d,y,y),he.minimumByComponent(s,v,s),he.maximumByComponent(l,y,l))}}for(var b=c.children,C=b.length,w=0;w<C;++w){var S=r[b[w]];S._transformToRoot=Be.getTransform(S),we.multiplyTransformation(d,S._transformToRoot,S._transformToRoot),a.push(S)}delete c._transformToRoot}}var T=de.fromCornerPoints(s,l);return e._upAxis===Me.Y?de.transformWithoutScale(T,Me.Y_UP_TO_Z_UP,T):e._upAxis===Me.X&&de.transformWithoutScale(T,Me.X_UP_TO_Z_UP,T),T}(this),this._initialRadius=this._boundingSphere.radius,this._updatedGltfVersion=!0}this._updatedGltfVersion&&0===N.pendingShaderLoads&&vt(this,e)}(N.finished()||k&&N.finishedEverythingButTextureCreation())&&(this._state=ze.LOADED,F=!0)}if(ge(N)&&this._state===ze.LOADED&&(k&&!F&&vt(this,e),N.finished())){this._loadResources=void 0;var U=this._rendererResources,V=this._cachedRendererResources;V.buffers=U.buffers,V.vertexArrays=U.vertexArrays,V.programs=U.programs,V.pickPrograms=U.pickPrograms,V.silhouettePrograms=U.silhouettePrograms,V.textures=U.textures,V.samplers=U.samplers,V.renderStates=U.renderStates,V.ready=!0,this._normalAttributeName=Be.getAttributeOrUniformBySemantic(this.gltf,"NORMAL"),ge(this._precreatedAttributes)&&(V.vertexArrays={}),this.releaseGltfJson&&Ft(this)}var z=xt(this,e),q=Pt(this),G=Dt(this),W=!ge(this.distanceDisplayCondition)||function(e,t){var r,i=e.distanceDisplayCondition,n=i.near*i.near,o=i.far*i.far;if(t.mode===Ue.SCENE2D)r=.5*(t.camera.frustum.right-t.camera.frustum.left),r*=r;else{var a=we.getTranslation(e.modelMatrix,zt);if(t.mode===Ue.COLUMBUS_VIEW){var s=t.mapProjection,l=s.ellipsoid.cartesianToCartographic(a,qt);a=s.project(l,a),he.fromElements(a.z,a.x,a.y,a)}r=he.distanceSquared(a,t.camera.positionWC)}return n<=r&&r<=o}(this,e),H=this.show&&W&&0!==this.scale&&(!G||z);if(H&&this._state===ze.LOADED||F){var j=this.activeAnimations.update(e)||this._cesiumAnimationsDirty;this._cesiumAnimationsDirty=!1,this._dirty=!1;var Y=this.modelMatrix,X=e.mode!==this._mode;this._mode=e.mode;var Q=!we.equals(this._modelMatrix,Y)||this._scale!==this.scale||this._minimumPixelSize!==this.minimumPixelSize||0!==this.minimumPixelSize||this._maximumScale!==this.maximumScale||this._heightReference!==this.heightReference||this._heightChanged||X;if(Q||F){we.clone(Y,this._modelMatrix),function(e){ge(e._removeUpdateHeightCallback)&&(e._removeUpdateHeightCallback(),e._removeUpdateHeightCallback=void 0);var t=e._scene;if(ge(t)&&ge(t.globe)&&e.heightReference!==Re.NONE){var r=t.globe,i=r.ellipsoid,n=e.modelMatrix;Lt.x=n[12],Lt.y=n[13],Lt.z=n[14];var o=i.cartesianToCartographic(Lt);ge(e._clampedModelMatrix)||(e._clampedModelMatrix=we.clone(n,new we));var a=r._surface;e._removeUpdateHeightCallback=a.updateHeight(o,Vt(e,i,o));var s=r.getHeight(o);if(ge(s)){var l=Vt(e,i,o);fe.clone(o,Nt),Nt.height=s,i.cartographicToCartesian(Nt,Lt),l(Lt)}}else{if(e.heightReference!==Re.NONE)throw new _e("Height reference is not supported without a scene and globe.");e._clampedModelMatrix=void 0}}(this),ge(this._clampedModelMatrix)&&(Y=this._clampedModelMatrix),this._scale=this.scale,this._minimumPixelSize=this.minimumPixelSize,this._maximumScale=this.maximumScale,this._heightReference=this.heightReference,this._heightChanged=!1;var Z=kt(this,e),K=this._computedModelMatrix;we.multiplyByUniformScale(Y,Z,K),this._upAxis===Me.Y?we.multiplyTransformation(K,Me.Y_UP_TO_Z_UP,K):this._upAxis===Me.X&&we.multiplyTransformation(K,Me.X_UP_TO_Z_UP,K)}var J=this.clippingPlanes;ge(J)&&J.enabled&&we.multiply(t.uniformState.view3D,Y,this._modelViewMatrix),(j||Q||F)&&(function(e,t,r,i){var n=e._maxDirtyNumber,o=e.allowPicking,a=e._runtime.rootNodes,s=a.length,l=bt,u=e._computedModelMatrix;if(e._mode!==Ue.SCENE3D&&!e._ignoreCommands){var c=we.getColumn(u,3,Ct);if(pe.equals(c,pe.UNIT_W)){var d=e.boundingSphere.center,h=Te.wgs84To2DModelMatrix(i,d,wt);u=we.multiply(h,u,wt),ge(e._rtcCenter)&&(we.setTranslation(u,pe.UNIT_W,u),e._rtcCenter=e._rtcCenter2D)}else u=Te.basisTo2D(i,u,wt),e._rtcCenter=e._rtcCenter3D}for(var p=0;p<s;++p){var f=a[p];for(yt(f,f.transformToRoot),l.push(f);0<l.length;){var m=(f=l.pop()).transformToRoot,g=f.commands;if(f.dirtyNumber===n||t||r){var _=we.multiplyTransformation(u,m,f.computedMatrix),v=g.length;if(0<v)for(var y=0;y<v;++y){var b=g[y],C=b.command;if(we.clone(_,C.modelMatrix),de.transform(b.boundingSphere,C.modelMatrix,C.boundingVolume),ge(e._rtcCenter)&&he.add(e._rtcCenter,C.boundingVolume.center,C.boundingVolume.center),o){var w=b.pickCommand;we.clone(C.modelMatrix,w.modelMatrix),de.clone(C.boundingVolume,w.boundingVolume)}if(C=b.command2D,ge(C)&&e._mode===Ue.SCENE2D&&(we.clone(_,C.modelMatrix),C.modelMatrix[13]-=2*Ce.sign(C.modelMatrix[13])*Ce.PI*i.ellipsoid.maximumRadius,de.transform(b.boundingSphere,C.modelMatrix,C.boundingVolume),o)){var S=b.pickCommand2D;we.clone(C.modelMatrix,S.modelMatrix),de.clone(C.boundingVolume,S.boundingVolume)}}}for(var T=f.children,E=T.length,A=0;A<E;++A){var x=T[A];x.dirtyNumber=Math.max(x.dirtyNumber,f.dirtyNumber),(x.dirtyNumber===n||r)&&(yt(x,x.transformToRoot),we.multiplyTransformation(m,x.transformToRoot,x.transformToRoot)),l.push(x)}}}++e._maxDirtyNumber}(this,Q,F,e.mapProjection),this._dirty=!0,(j||F)&&function(e){for(var t=e._runtime.skinnedNodes,r=t.length,i=0;i<r;++i){var n=t[i];St=we.inverseTransformation(n.transformToRoot,St);for(var o=n.computedJointMatrices,a=n.joints,s=n.bindShapeMatrix,l=n.inverseBindMatrices,u=l.length,c=0;c<u;++c)ge(o[c])||(o[c]=new we),o[c]=we.multiplyTransformation(St,a[c].transformToRoot,o[c]),o[c]=we.multiplyTransformation(o[c],l[c],o[c]),ge(s)&&(o[c]=we.multiplyTransformation(o[c],s,o[c]))}}(this)),this._perNodeShowDirty&&(this._perNodeShowDirty=!1,function(e){for(var t=e._runtime.rootNodes,r=t.length,i=bt,n=0;n<r;++n){var o=t[n];for(o.computedShow=o.publicNode.show,i.push(o);0<i.length;){for(var a=(o=i.pop()).computedShow,s=o.commands,l=s.length,u=0;u<l;++u)s[u].show=a;for(var c=o.children,d=c.length,h=0;h<d;++h){var p=c[h];p.computedShow=a&&p.publicNode.show,i.push(p)}}}}(this)),function(e,t){var r=e.id;if(e._id!==r){e._id=r;for(var i=e._pickIds,n=i.length,o=0;o<n;++o)i[o].object.id=r}}(this),function(e){if(e._debugWireframe!==e.debugWireframe){e._debugWireframe=e.debugWireframe;for(var t=e.debugWireframe?Se.LINES:Se.TRIANGLES,r=e._nodeCommands,i=r.length,n=0;n<i;++n)r[n].command.primitiveType=t}}(this),function(e){if(e.debugShowBoundingVolume!==e._debugShowBoundingVolume){e._debugShowBoundingVolume=e.debugShowBoundingVolume;for(var t=e.debugShowBoundingVolume,r=e._nodeCommands,i=r.length,n=0;n<i;++n)r[n].command.debugShowBoundingVolume=t}}(this),function(e){if(e.shadows!==e._shadows){e._shadows=e.shadows;for(var t=Ve.castShadows(e.shadows),r=Ve.receiveShadows(e.shadows),i=e._nodeCommands,n=i.length,o=0;o<n;o++){var a=i[o];a.command.castShadows=t,a.command.receiveShadows=r}}}(this),function(e,t){var r=t.scene3DOnly,i=e.color.alpha;if(0<i&&i<1){var n=e._nodeCommands,o=n.length;if(!ge(n[0].translucentCommand))for(var a=0;a<o;++a){var s=n[a],l=s.command;if(s.translucentCommand=Tt(l),!r){var u=s.command2D;s.translucentCommand2D=Tt(u)}}}}(this,e),function(e,t){if(xt(e,t)){var r=e._nodeCommands,i=Ot(e.color.alpha,e._colorPreviousAlpha)||Ot(e.silhouetteColor.alpha,e._silhouetteColorPreviousAlpha)||!ge(r[0].silhouetteModelCommand);e._colorPreviousAlpha=e.color.alpha,e._silhouetteColorPreviousAlpha=e.silhouetteColor.alpha,i&&Mt(e,t)}}(this,e),function(e){var t=e.clippingPlanes,r=0;ge(t)&&t.enabled&&(r=t.length);var i=e._packedClippingPlanes,n=i.length;if(n!==r){i.length=r;for(var o=n;o<r;++o)i[o]=new pe}}(this)}if(F){var $=this;e.afterRender.push(function(){$._ready=!0,$._readyPromise.resolve($)})}else if(H&&!this._ignoreCommands){var ee,te,re,ie=e.commandList,ne=e.passes,oe=this._nodeCommands,ae=oe.length,se=e.mapProjection.ellipsoid.maximumRadius*Ce.PI;if(ne.render){for(ee=0;ee<ae;++ee)if((te=oe[ee]).show){var le=q?te.translucentCommand:te.command;if(le=z?te.silhouetteModelCommand:le,ie.push(le),re=te.command.boundingVolume,e.mode===Ue.SCENE2D&&(re.center.y+re.radius>se||re.center.y-re.radius<se)){var ue=q?te.translucentCommand2D:te.command2D;ue=z?te.silhouetteModelCommand2D:ue,ie.push(ue)}}if(z)for(ee=0;ee<ae;++ee)(te=oe[ee]).show&&(ie.push(te.silhouetteColorCommand),re=te.command.boundingVolume,e.mode===Ue.SCENE2D&&(re.center.y+re.radius>se||re.center.y-re.radius<se)&&ie.push(te.silhouetteColorCommand2D))}if(ne.pick&&this.allowPicking)for(ee=0;ee<ae;++ee)if((te=oe[ee]).show){var ce=te.pickCommand;ie.push(ce),re=ce.boundingVolume,e.mode===Ue.SCENE2D&&(re.center.y+re.radius>se||re.center.y-re.radius<se)&&ie.push(te.pickCommand2D)}}}},H.prototype.isDestroyed=function(){return!1},H.prototype.destroy=function(){ge(this._precreatedAttributes)&&Ut(this._rendererResources.vertexArrays),ge(this._removeUpdateHeightCallback)&&(this._removeUpdateHeightCallback(),this._removeUpdateHeightCallback=void 0),ge(this._terrainProviderChangedCallback)&&(this._terrainProviderChangedCallback(),this._terrainProviderChangedCallback=void 0),this._rendererResources=void 0,this._cachedRendererResources=this._cachedRendererResources&&this._cachedRendererResources.release();for(var e=this._pickIds,t=e.length,r=0;r<t;++r)e[r].destroy();return Ft(this),i(this)},H}),define("DataSources/ModelVisualizer",["../Core/AssociativeArray","../Core/BoundingSphere","../Core/Color","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Matrix4","../Core/Resource","../Scene/ColorBlendMode","../Scene/HeightReference","../Scene/Model","../Scene/ModelAnimationLoop","../Scene/ShadowMode","./BoundingSphereState","./Property"],function(r,n,e,T,o,E,A,x,t,a,P,D,i,s,O){"use strict";var I=i.ENABLED,M=a.NONE,R=e.RED,L=e.WHITE,N=t.HIGHLIGHT,k=new A,F=new A;function l(e,t){if(!T(e))throw new E("scene is required.");if(!T(t))throw new E("entityCollection is required.");t.collectionChanged.addEventListener(l.prototype._onCollectionChanged,this),this._scene=e,this._primitives=e.primitives,this._entityCollection=t,this._modelHash={},this._entitiesToVisualize=new r,this._onCollectionChanged(t,t.values,[],[])}function u(e,t,r,i){var n=r[t.id];T(n)&&(i.removeAndDestroy(n.modelPrimitive),delete r[t.id])}function c(e,t){var r=t[e.id];T(r)&&(r.nodeTransformationsScratch={})}function B(e){console.error(e)}return l.prototype.update=function(e){if(!T(e))throw new E("time is required.");for(var t=this._entitiesToVisualize.values,r=this._modelHash,i=this._primitives,n=0,o=t.length;n<o;n++){var a,s,l=t[n],u=l._model,c=r[l.id],d=l.isShowing&&l.isAvailable(e)&&O.getValueOrDefault(u._show,e,!0);if(d&&(s=l.computeModelMatrix(e,k),a=x.createIfNeeded(O.getValueOrUndefined(u._uri,e)),d=T(s)&&T(a)),d){var h=T(c)?c.modelPrimitive:void 0;if(T(h)&&a.url===c.url||(T(h)&&(i.removeAndDestroy(h),delete r[l.id]),(h=P.fromGltf({url:a,incrementallyLoadTextures:O.getValueOrDefault(u._incrementallyLoadTextures,e,!0),scene:this._scene})).readyPromise.otherwise(B),h.id=l,i.add(h),c={modelPrimitive:h,url:a.url,animationsRunning:!1,nodeTransformationsScratch:{},originalNodeMatrixHash:{}},r[l.id]=c),h.show=!0,h.scale=O.getValueOrDefault(u._scale,e,1),h.minimumPixelSize=O.getValueOrDefault(u._minimumPixelSize,e,0),h.maximumScale=O.getValueOrUndefined(u._maximumScale,e),h.modelMatrix=A.clone(s,h.modelMatrix),h.shadows=O.getValueOrDefault(u._shadows,e,I),h.heightReference=O.getValueOrDefault(u._heightReference,e,M),h.distanceDisplayCondition=O.getValueOrUndefined(u._distanceDisplayCondition,e),h.silhouetteColor=O.getValueOrDefault(u._silhouetteColor,e,R,h._silhouetteColor),h.silhouetteSize=O.getValueOrDefault(u._silhouetteSize,e,0),h.color=O.getValueOrDefault(u._color,e,L,h._color),h.colorBlendMode=O.getValueOrDefault(u._colorBlendMode,e,N),h.colorBlendAmount=O.getValueOrDefault(u._colorBlendAmount,e,.5),h.clippingPlanes=O.getValueOrUndefined(u._clippingPlanes,e),h.clampAnimations=O.getValueOrDefault(u._clampAnimations,e,!0),h.ready){var p=O.getValueOrDefault(u._runAnimations,e,!0);c.animationsRunning!==p&&(p?h.activeAnimations.addAll({loop:D.REPEAT}):h.activeAnimations.removeAll(),c.animationsRunning=p);var f=O.getValueOrUndefined(u._nodeTransformations,e,c.nodeTransformationsScratch);if(T(f))for(var m=c.originalNodeMatrixHash,g=Object.keys(f),_=0,v=g.length;_<v;++_){var y=g[_],b=f[y];if(T(b)){var C=h.getNode(y);if(T(C)){var w=m[y];T(w)||(w=C.matrix.clone(),m[y]=w);var S=A.fromTranslationRotationScale(b,F);C.matrix=A.multiply(w,S,S)}}}}}else T(c)&&(c.modelPrimitive.show=!1)}return!0},l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(l.prototype._onCollectionChanged,this);for(var e=this._entitiesToVisualize.values,t=this._modelHash,r=this._primitives,i=e.length-1;-1<i;i--)u(this,e[i],t,r);return o(this)},l.prototype.getBoundingSphere=function(e,t){if(!T(e))throw new E("entity is required.");if(!T(t))throw new E("result is required.");var r=this._modelHash[e.id];if(!T(r))return s.FAILED;var i=r.modelPrimitive;if(!T(i)||!i.show)return s.FAILED;if(!i.ready)return s.PENDING;if(i.heightReference===a.NONE)n.transform(i.boundingSphere,i.modelMatrix,t);else{if(!T(i._clampedModelMatrix))return s.PENDING;n.transform(i.boundingSphere,i._clampedModelMatrix,t)}return s.DONE},l.prototype._onCollectionChanged=function(e,t,r,i){var n,o,a=this._entitiesToVisualize,s=this._modelHash,l=this._primitives;for(n=t.length-1;-1<n;n--)o=t[n],T(o._model)&&T(o._position)&&a.set(o.id,o);for(n=i.length-1;-1<n;n--)o=i[n],T(o._model)&&T(o._position)?(c(o,s),a.set(o.id,o)):(u(this,o,s,l),a.remove(o.id));for(n=r.length-1;-1<n;n--)u(this,o=r[n],s,l),a.remove(o.id)},l}),define("Shaders/PolylineCommon",[],function(){"use strict";return"void clipLineSegmentToNearPlane(\nvec3 p0,\nvec3 p1,\nout vec4 positionWC,\nout bool clipped,\nout bool culledByNearPlane)\n{\nculledByNearPlane = false;\nclipped = false;\nvec3 p1ToP0 = p1 - p0;\nfloat magnitude = length(p1ToP0);\nvec3 direction = normalize(p1ToP0);\nfloat endPoint0Distance =  -(czm_currentFrustum.x + p0.z);\nfloat denominator = -direction.z;\nif (endPoint0Distance < 0.0 && abs(denominator) < czm_epsilon7)\n{\nculledByNearPlane = true;\n}\nelse if (endPoint0Distance < 0.0 && abs(denominator) > czm_epsilon7)\n{\nfloat t = (czm_currentFrustum.x + p0.z) / denominator;\nif (t < 0.0 || t > magnitude)\n{\nculledByNearPlane = true;\n}\nelse\n{\np0 = p0 + t * direction;\nclipped = true;\n}\n}\npositionWC = czm_eyeToWindowCoordinates(vec4(p0, 1.0));\n}\nvec4 getPolylineWindowCoordinatesEC(vec4 positionEC, vec4 prevEC, vec4 nextEC, float expandDirection, float width, bool usePrevious, out float angle)\n{\nvec4 endPointWC, p0, p1;\nbool culledByNearPlane, clipped;\n#ifdef POLYLINE_DASH\nvec4 positionWindow = czm_eyeToWindowCoordinates(positionEC);\nvec4 previousWindow = czm_eyeToWindowCoordinates(prevEC);\nvec4 nextWindow = czm_eyeToWindowCoordinates(nextEC);\nvec2 lineDir;\nif (usePrevious) {\nlineDir = normalize(positionWindow.xy - previousWindow.xy);\n}\nelse {\nlineDir = normalize(nextWindow.xy - positionWindow.xy);\n}\nangle = atan(lineDir.x, lineDir.y) - 1.570796327;\nangle = floor(angle / czm_piOverFour + 0.5) * czm_piOverFour;\n#endif\nclipLineSegmentToNearPlane(prevEC.xyz, positionEC.xyz, p0, clipped, culledByNearPlane);\nclipLineSegmentToNearPlane(nextEC.xyz, positionEC.xyz, p1, clipped, culledByNearPlane);\nclipLineSegmentToNearPlane(positionEC.xyz, usePrevious ? prevEC.xyz : nextEC.xyz, endPointWC, clipped, culledByNearPlane);\nif (culledByNearPlane)\n{\nreturn vec4(0.0, 0.0, 0.0, 1.0);\n}\nvec2 prevWC = normalize(p0.xy - endPointWC.xy);\nvec2 nextWC = normalize(p1.xy - endPointWC.xy);\nfloat expandWidth = width * 0.5;\nvec2 direction;\nif (czm_equalsEpsilon(prevEC.xyz - positionEC.xyz, vec3(0.0), czm_epsilon1) || czm_equalsEpsilon(prevWC, -nextWC, czm_epsilon1))\n{\ndirection = vec2(-nextWC.y, nextWC.x);\n}\nelse if (czm_equalsEpsilon(nextEC.xyz - positionEC.xyz, vec3(0.0), czm_epsilon1) || clipped)\n{\ndirection = vec2(prevWC.y, -prevWC.x);\n}\nelse\n{\nvec2 normal = vec2(-nextWC.y, nextWC.x);\ndirection = normalize((nextWC + prevWC) * 0.5);\nif (dot(direction, normal) < 0.0)\n{\ndirection = -direction;\n}\nfloat sinAngle = abs(direction.x * nextWC.y - direction.y * nextWC.x);\nexpandWidth = clamp(expandWidth / sinAngle, 0.0, width * 2.0);\n}\nvec2 offset = direction * expandDirection * expandWidth * czm_resolutionScale;\nreturn vec4(endPointWC.xy + offset, -endPointWC.z, 1.0);\n}\nvec4 getPolylineWindowCoordinates(vec4 position, vec4 previous, vec4 next, float expandDirection, float width, bool usePrevious, out float angle)\n{\nvec4 positionEC = czm_modelViewRelativeToEye * position;\nvec4 prevEC = czm_modelViewRelativeToEye * previous;\nvec4 nextEC = czm_modelViewRelativeToEye * next;\nreturn getPolylineWindowCoordinatesEC(positionEC, prevEC, nextEC, expandDirection, width, usePrevious, angle);\n}\n"}),define("Shaders/PolylineFS",[],function(){"use strict";return"#ifdef VECTOR_TILE\nuniform vec4 u_highlightColor;\n#endif\nvarying vec2 v_st;\nvoid main()\n{\nczm_materialInput materialInput;\nmaterialInput.s = v_st.s;\nmaterialInput.st = v_st;\nmaterialInput.str = vec3(v_st, 0.0);\nczm_material material = czm_getMaterial(materialInput);\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#ifdef VECTOR_TILE\ngl_FragColor *= u_highlightColor;\n#endif\n}\n"}),define("Shaders/PolylineVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 position2DHigh;\nattribute vec3 position2DLow;\nattribute vec3 prevPosition3DHigh;\nattribute vec3 prevPosition3DLow;\nattribute vec3 prevPosition2DHigh;\nattribute vec3 prevPosition2DLow;\nattribute vec3 nextPosition3DHigh;\nattribute vec3 nextPosition3DLow;\nattribute vec3 nextPosition2DHigh;\nattribute vec3 nextPosition2DLow;\nattribute vec4 texCoordExpandAndBatchIndex;\nvarying vec2  v_st;\nvarying float v_width;\nvarying vec4  czm_pickColor;\nvarying float v_polylineAngle;\nvoid main()\n{\nfloat texCoord = texCoordExpandAndBatchIndex.x;\nfloat expandDir = texCoordExpandAndBatchIndex.y;\nbool usePrev = texCoordExpandAndBatchIndex.z < 0.0;\nfloat batchTableIndex = texCoordExpandAndBatchIndex.w;\nvec2 widthAndShow = batchTable_getWidthAndShow(batchTableIndex);\nfloat width = widthAndShow.x + 0.5;\nfloat show = widthAndShow.y;\nif (width < 1.0)\n{\nshow = 0.0;\n}\nvec4 pickColor = batchTable_getPickColor(batchTableIndex);\nvec4 p, prev, next;\nif (czm_morphTime == 1.0)\n{\np = czm_translateRelativeToEye(position3DHigh.xyz, position3DLow.xyz);\nprev = czm_translateRelativeToEye(prevPosition3DHigh.xyz, prevPosition3DLow.xyz);\nnext = czm_translateRelativeToEye(nextPosition3DHigh.xyz, nextPosition3DLow.xyz);\n}\nelse if (czm_morphTime == 0.0)\n{\np = czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy);\nprev = czm_translateRelativeToEye(prevPosition2DHigh.zxy, prevPosition2DLow.zxy);\nnext = czm_translateRelativeToEye(nextPosition2DHigh.zxy, nextPosition2DLow.zxy);\n}\nelse\n{\np = czm_columbusViewMorph(\nczm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy),\nczm_translateRelativeToEye(position3DHigh.xyz, position3DLow.xyz),\nczm_morphTime);\nprev = czm_columbusViewMorph(\nczm_translateRelativeToEye(prevPosition2DHigh.zxy, prevPosition2DLow.zxy),\nczm_translateRelativeToEye(prevPosition3DHigh.xyz, prevPosition3DLow.xyz),\nczm_morphTime);\nnext = czm_columbusViewMorph(\nczm_translateRelativeToEye(nextPosition2DHigh.zxy, nextPosition2DLow.zxy),\nczm_translateRelativeToEye(nextPosition3DHigh.xyz, nextPosition3DLow.xyz),\nczm_morphTime);\n}\n#ifdef DISTANCE_DISPLAY_CONDITION\nvec3 centerHigh = batchTable_getCenterHigh(batchTableIndex);\nvec4 centerLowAndRadius = batchTable_getCenterLowAndRadius(batchTableIndex);\nvec3 centerLow = centerLowAndRadius.xyz;\nfloat radius = centerLowAndRadius.w;\nvec2 distanceDisplayCondition = batchTable_getDistanceDisplayCondition(batchTableIndex);\nfloat lengthSq;\nif (czm_sceneMode == czm_sceneMode2D)\n{\nlengthSq = czm_eyeHeight2D.y;\n}\nelse\n{\nvec4 center = czm_translateRelativeToEye(centerHigh.xyz, centerLow.xyz);\nlengthSq = max(0.0, dot(center.xyz, center.xyz) - radius * radius);\n}\nfloat nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x;\nfloat farSq = distanceDisplayCondition.y * distanceDisplayCondition.y;\nif (lengthSq < nearSq || lengthSq > farSq)\n{\nshow = 0.0;\n}\n#endif\nvec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, v_polylineAngle);\ngl_Position = czm_viewportOrthographic * positionWC * show;\nv_st = vec2(texCoord, clamp(expandDir, 0.0, 1.0));\nv_width = width;\nczm_pickColor = pickColor;\n}\n"}),define("Scene/Polyline",["../Core/arrayRemoveDuplicates","../Core/BoundingSphere","../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/Matrix4","../Core/PolylinePipeline","./Material"],function(n,a,o,s,l,u,e,r,t,c,d,h){"use strict";function i(e,t){e=l(e,l.EMPTY_OBJECT),this._show=l(e.show,!0),this._width=l(e.width,1),this._loop=l(e.loop,!1),this._distanceDisplayCondition=e.distanceDisplayCondition,this._material=e.material,u(this._material)||(this._material=h.fromType(h.ColorType,{color:new s(1,1,1,1)}));var r,i=e.positions;u(i)||(i=[]),this._positions=i,this._actualPositions=n(i,o.equalsEpsilon),this._loop&&2<this._actualPositions.length&&(this._actualPositions===this._positions&&(this._actualPositions=i.slice()),this._actualPositions.push(o.clone(this._actualPositions[0]))),this._length=this._actualPositions.length,this._id=e.id,u(t)&&(r=c.clone(t.modelMatrix)),this._modelMatrix=r,this._segments=d.wrapLongitude(this._actualPositions,r),this._actualLength=void 0,this._propertiesChanged=new Uint32Array(y),this._polylineCollection=t,this._dirty=!1,this._pickId=void 0,this._boundingVolume=a.fromPoints(this._actualPositions),this._boundingVolumeWC=a.transform(this._boundingVolume,this._modelMatrix),this._boundingVolume2D=new a}var p=i.POSITION_INDEX=0,f=i.SHOW_INDEX=1,m=i.WIDTH_INDEX=2,g=i.MATERIAL_INDEX=3,_=i.POSITION_SIZE_INDEX=4,v=i.DISTANCE_DISPLAY_CONDITION=5,y=i.NUMBER_OF_PROPERTIES=6;function b(e,t){++e._propertiesChanged[t];var r=e._polylineCollection;u(r)&&(r._updatePolyline(e,t),e._dirty=!0)}return e(i.prototype,{show:{get:function(){return this._show},set:function(e){if(!u(e))throw new r("value is required.");e!==this._show&&(this._show=e,b(this,f))}},positions:{get:function(){return this._positions},set:function(e){if(!u(e))throw new r("value is required.");var t=n(e,o.equalsEpsilon);this._loop&&2<t.length&&(t===e&&(t=e.slice()),t.push(o.clone(t[0]))),this._actualPositions.length===t.length&&this._actualPositions.length===this._length||b(this,_),this._positions=e,this._actualPositions=t,this._length=t.length,this._boundingVolume=a.fromPoints(this._actualPositions,this._boundingVolume),this._boundingVolumeWC=a.transform(this._boundingVolume,this._modelMatrix,this._boundingVolumeWC),b(this,p),this.update()}},material:{get:function(){return this._material},set:function(e){if(!u(e))throw new r("material is required.");this._material!==e&&(this._material=e,b(this,g))}},width:{get:function(){return this._width},set:function(e){if(!u(e))throw new r("value is required.");e!==this._width&&(this._width=e,b(this,m))}},loop:{get:function(){return this._loop},set:function(e){if(!u(e))throw new r("value is required.");if(e!==this._loop){var t=this._actualPositions;e?2<t.length&&!o.equals(t[0],t[t.length-1])&&(t.length===this._positions.length&&(this._actualPositions=t=this._positions.slice()),t.push(o.clone(t[0]))):2<t.length&&o.equals(t[0],t[t.length-1])&&(t.length-1===this._positions.length?this._actualPositions=this._positions:t.pop()),this._loop=e,b(this,_)}}},id:{get:function(){return this._id},set:function(e){this._id=e,u(this._pickId)&&(this._pickId.object.id=e)}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(u(e)&&e.far<=e.near)throw new r("far distance must be greater than near distance.");t.equals(e,this._distanceDisplayCondition)||(this._distanceDisplayCondition=t.clone(e,this._distanceDisplayCondition),b(this,v))}}}),i.prototype.update=function(){var e=c.IDENTITY;u(this._polylineCollection)&&(e=this._polylineCollection.modelMatrix);var t=this._segments.positions.length,r=this._segments.lengths,i=0<this._propertiesChanged[p]||0<this._propertiesChanged[_];if(c.equals(e,this._modelMatrix)&&!i||(this._segments=d.wrapLongitude(this._actualPositions,e),this._boundingVolumeWC=a.transform(this._boundingVolume,e,this._boundingVolumeWC)),this._modelMatrix=c.clone(e,this._modelMatrix),this._segments.positions.length!==t)b(this,_);else for(var n=r.length,o=0;o<n;++o)if(r[o]!==this._segments.lengths[o]){b(this,_);break}},i.prototype.getPickId=function(e){return u(this._pickId)||(this._pickId=e.createPickId({primitive:this,collection:this._polylineCollection,id:this._id})),this._pickId},i.prototype._clean=function(){this._dirty=!1;for(var e=this._propertiesChanged,t=0;t<y-1;++t)e[t]=0},i.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._material=this._material&&this._material.destroy(),this._polylineCollection=void 0},i}),define("Scene/PolylineCollection",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/Color","../Core/combine","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EncodedCartesian3","../Core/IndexDatatype","../Core/Intersect","../Core/Math","../Core/Matrix4","../Core/Plane","../Core/RuntimeError","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/Texture","../Renderer/VertexArray","../Shaders/PolylineCommon","../Shaders/PolylineFS","../Shaders/PolylineVS","./BatchTable","./BlendingState","./Material","./Polyline","./SceneMode"],function(B,E,V,z,e,q,U,H,r,j,t,i,n,G,Y,o,X,A,a,x,Q,Z,P,W,K,D,l,u,s,J,c,d,h,O,I,p,f,$){"use strict";var M=f.SHOW_INDEX,R=f.WIDTH_INDEX,L=f.POSITION_INDEX,N=f.MATERIAL_INDEX,k=f.POSITION_SIZE_INDEX,F=f.DISTANCE_DISPLAY_CONDITION,ee=f.NUMBER_OF_PROPERTIES,te={texCoordExpandAndBatchIndex:0,position3DHigh:1,position3DLow:2,position2DHigh:3,position2DLow:4,prevPosition3DHigh:5,prevPosition3DLow:6,prevPosition2DHigh:7,prevPosition2DLow:8,nextPosition3DHigh:9,nextPosition3DLow:10,nextPosition2DHigh:11,nextPosition2DLow:12};function m(e){e=r(e,r.EMPTY_OBJECT),this.modelMatrix=A.clone(r(e.modelMatrix,A.IDENTITY)),this._modelMatrix=A.clone(A.IDENTITY),this.debugShowBoundingVolume=r(e.debugShowBoundingVolume,!1),this._opaqueRS=void 0,this._translucentRS=void 0,this._colorCommands=[],this._pickCommands=[],this._polylinesUpdated=!1,this._polylinesRemoved=!1,this._createVertexArray=!1,this._propertiesChanged=new Uint32Array(ee),this._polylines=[],this._polylineBuckets={},this._positionBufferUsage={bufferUsage:Z.STATIC_DRAW,frameCount:0},this._mode=void 0,this._polylinesToUpdate=[],this._vertexArrays=[],this._positionBuffer=void 0,this._texCoordExpandAndBatchIndexBuffer=void 0,this._batchTable=void 0,this._createBatchTable=!1,this._useHighlightColor=!1,this._highlightColor=q.clone(q.WHITE);var t=this;this._uniformMap={u_highlightColor:function(){return t._highlightColor}}}t(m.prototype,{length:{get:function(){return de(this),this._polylines.length}}}),m.prototype.add=function(e){var t=new f(e,this);return t._index=this._polylines.length,this._polylines.push(t),this._createVertexArray=!0,this._createBatchTable=!0,t},m.prototype.remove=function(e){if(this.contains(e)){if(this._polylines[e._index]=void 0,this._polylinesRemoved=!0,this._createVertexArray=!0,this._createBatchTable=!0,j(e._bucket)){var t=e._bucket;t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy(),t.pickShaderProgram=t.pickShaderProgram&&t.pickShaderProgram.destroy()}return e._destroy(),!0}return!1},m.prototype.removeAll=function(){he(this),v(this),this._polylineBuckets={},this._polylinesRemoved=!1,this._polylines.length=0,this._polylinesToUpdate.length=0,this._createVertexArray=!0},m.prototype.contains=function(e){return j(e)&&e._polylineCollection===this},m.prototype.get=function(e){if(!j(e))throw new n("index is required.");return de(this),this._polylines[e]};var re=new G,ie=new z,ne=new E;m.prototype.update=function(e){if(de(this),0!==this._polylines.length){var t,r;t=this,r=e.mode,t._mode===r&&A.equals(t._modelMatrix,t.modelMatrix)||(t._mode=r,t._modelMatrix=A.clone(t.modelMatrix),t._createVertexArray=!0);var i,n=e.context,o=e.mapProjection,a=this._propertiesChanged;if(this._createBatchTable){if(0===P.maximumVertexTextureImageUnits)throw new x("Vertex texture fetch support is required to render polylines. The maximum number of vertex texture image units must be greater than zero.");!function(e,t){j(e._batchTable)&&e._batchTable.destroy();var r=[{functionName:"batchTable_getWidthAndShow",componentDatatype:H.UNSIGNED_BYTE,componentsPerAttribute:2},{functionName:"batchTable_getPickColor",componentDatatype:H.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0},{functionName:"batchTable_getCenterHigh",componentDatatype:H.FLOAT,componentsPerAttribute:3},{functionName:"batchTable_getCenterLowAndRadius",componentDatatype:H.FLOAT,componentsPerAttribute:4},{functionName:"batchTable_getDistanceDisplayCondition",componentDatatype:H.FLOAT,componentsPerAttribute:2}];e._batchTable=new O(t,r,e._polylines.length)}(this,n),this._createBatchTable=!1}if(this._createVertexArray||function(e){var t=!1,r=e._propertiesChanged,i=e._positionBufferUsage;r[L]?(i.bufferUsage!==Z.STREAM_DRAW&&(t=!0,i.bufferUsage=Z.STREAM_DRAW),i.frameCount=100):i.bufferUsage!==Z.STATIC_DRAW&&(0===i.frameCount?(t=!0,i.bufferUsage=Z.STATIC_DRAW):i.frameCount--);return t}(this))ue(this,n,o);else if(this._polylinesUpdated){var s=this._polylinesToUpdate;if(this._mode!==$.SCENE3D)for(var l=s.length,u=0;u<l;++u)(i=s[u]).update();if(a[k]||a[N])ue(this,n,o);else for(var c=s.length,d=this._polylineBuckets,h=0;h<c;++h){a=(i=s[h])._propertiesChanged;var p=i._bucket,f=0;for(var m in d)if(d.hasOwnProperty(m)){if(d[m]===p){a[L]&&p.writeUpdate(f,i,this._positionBuffer,o);break}f+=d[m].lengthOfPositions}if((a[M]||a[R])&&this._batchTable.setBatchedAttribute(i._index,0,new E(i._width,i._show)),2<this._batchTable.attributes.length){if(a[L]||a[k]){var g=e.mode===$.SCENE2D?i._boundingVolume2D:i._boundingVolumeWC,_=G.fromCartesian(g.center,re),v=z.fromElements(_.low.x,_.low.y,_.low.z,g.radius,ie);this._batchTable.setBatchedAttribute(i._index,2,_.high),this._batchTable.setBatchedAttribute(i._index,3,v)}if(a[F]){var y=ne;y.x=0,y.y=Number.MAX_VALUE;var b=i.distanceDisplayCondition;j(b)&&(y.x=b.near,y.y=b.far),this._batchTable.setBatchedAttribute(i._index,4,y)}}i._clean()}s.length=0,this._polylinesUpdated=!1}a=this._propertiesChanged;for(var C=0;C<ee;++C)a[C]=0;var w=A.IDENTITY;e.mode===$.SCENE3D&&(w=this.modelMatrix);var S=e.passes,T=0!==e.morphTime;if(j(this._opaqueRS)&&this._opaqueRS.depthTest.enabled===T||(this._opaqueRS=D.fromCache({depthMask:T,depthTest:{enabled:T}})),j(this._translucentRS)&&this._translucentRS.depthTest.enabled===T||(this._translucentRS=D.fromCache({blending:I.ALPHA_BLEND,depthMask:!T,depthTest:{enabled:T}})),this._batchTable.update(e),S.render)se(this,e,this._colorCommands,w,!0);if(S.pick)se(this,e,this._pickCommands,w,!1)}};var oe=new B,ae=new B;function se(e,t,r,i,n){for(var o=t.context,a=t.commandList,s=r.length,l=0,u=!0,c=e._vertexArrays,d=e.debugShowBoundingVolume,h=e._batchTable.getUniformMapCallback(),p=c.length,f=0;f<p;++f)for(var m=c[f],g=m.buckets,_=g.length,v=0;v<_;++v){for(var y,b,C,w,S=g[v],T=S.offset,E=n?S.bucket.shaderProgram:S.bucket.pickShaderProgram,A=S.bucket.polylines,x=A.length,P=0,D=0;D<x;++D){var O=A[D],I=ce(O._material);if(I!==y){if(j(y)&&0<P){var M=b.isTranslucent();s<=l?(C=new W({owner:e}),r.push(C)):C=r[l],++l,w=U(h(b._uniforms),e._uniformMap),C.boundingVolume=B.clone(oe,C.boundingVolume),C.modelMatrix=i,C.shaderProgram=E,C.vertexArray=m.va,C.renderState=M?e._translucentRS:e._opaqueRS,C.pass=M?K.TRANSLUCENT:K.OPAQUE,C.debugShowBoundingVolume=!!n&&d,C.uniformMap=w,C.count=P,C.offset=T,T+=P,u=!(P=0),a.push(C)}(b=O._material).update(o),y=I}for(var R,L=O._locatorBuckets,N=L.length,k=0;k<N;++k){var F=L[k];F.locator===S&&(P+=F.count)}t.mode===$.SCENE3D?R=O._boundingVolumeWC:t.mode===$.COLUMBUS_VIEW?R=O._boundingVolume2D:t.mode===$.SCENE2D?j(O._boundingVolume2D)&&((R=B.clone(O._boundingVolume2D,ae)).center.x=0):j(O._boundingVolumeWC)&&j(O._boundingVolume2D)&&(R=B.union(O._boundingVolumeWC,O._boundingVolume2D,ae)),u?(u=!1,B.clone(R,oe)):B.union(R,oe,oe)}j(y)&&0<P&&(s<=l?(C=new W({owner:e}),r.push(C)):C=r[l],++l,w=U(h(b._uniforms),e._uniformMap),C.boundingVolume=B.clone(oe,C.boundingVolume),C.modelMatrix=i,C.shaderProgram=E,C.vertexArray=m.va,C.renderState=b.isTranslucent()?e._translucentRS:e._opaqueRS,C.pass=b.isTranslucent()?K.TRANSLUCENT:K.OPAQUE,C.debugShowBoundingVolume=!!n&&d,C.uniformMap=w,C.count=P,C.offset=T,u=!0,a.push(C)),y=void 0}r.length=l}m.prototype.isDestroyed=function(){return!1},m.prototype.destroy=function(){return pe(this),he(this),v(this),this._batchTable=this._batchTable&&this._batchTable.destroy(),i(this)};var le=[0,0,0];function ue(e,t,r){e._createVertexArray=!1,he(e),pe(e),function(e){for(var t=e._mode,r=e._modelMatrix,i=e._polylineBuckets={},n=e._polylines,o=n.length,a=0;a<o;++a){var s=n[a];if(1<s._actualPositions.length){s.update();var l=s.material,u=i[l.type];j(u)||(u=i[l.type]=new fe(l,t,r)),u.addPolyline(s)}}}(e);var i,n,o=[[]],a=o[0],s=e._batchTable,l=e._useHighlightColor,u=[0],c=0,d=[[]],h=0,p=e._polylineBuckets;for(i in p)p.hasOwnProperty(i)&&((n=p[i]).updateShader(t,s,l),h+=n.lengthOfPositions);if(0<h){var f,m=e._mode,g=new Float32Array(6*h*3),_=new Float32Array(4*h),v=0,y=0,b=0;for(i in p)if(p.hasOwnProperty(i)){(n=p[i]).write(g,_,v,y,b,s,t,r),m===$.MORPHING&&(j(f)||(f=new Float32Array(6*h*3)),n.writeForMorph(f,v));var C=n.lengthOfPositions;v+=6*C*3,y+=4*C,b+=4*C,c=n.updateIndices(o,u,d,c)}var w,S=e._positionBufferUsage.bufferUsage,T=Z.STATIC_DRAW;e._positionBuffer=Q.createVertexBuffer({context:t,typedArray:g,usage:S}),j(f)&&(w=Q.createVertexBuffer({context:t,typedArray:f,usage:S})),e._texCoordExpandAndBatchIndexBuffer=Q.createVertexBuffer({context:t,typedArray:_,usage:T});for(var E=3*Float32Array.BYTES_PER_ELEMENT,A=4*Float32Array.BYTES_PER_ELEMENT,x=0,P=o.length,D=0;D<P;++D)if(0<(a=o[D]).length){var O=new Uint16Array(a),I=Q.createIndexBuffer({context:t,typedArray:O,usage:Z.STATIC_DRAW,indexDatatype:Y.UNSIGNED_SHORT});x+=u[D];var M,R,L,N,k=6*(D*(E*X.SIXTY_FOUR_KILOBYTES)-x*E),F=E+k,B=E+F,U=E+B,V=E+U,z=E+V,q=D*(A*X.SIXTY_FOUR_KILOBYTES)-x*A,G=[{index:te.position3DHigh,componentsPerAttribute:3,componentDatatype:H.FLOAT,offsetInBytes:k,strideInBytes:6*E},{index:te.position3DLow,componentsPerAttribute:3,componentDatatype:H.FLOAT,offsetInBytes:F,strideInBytes:6*E},{index:te.position2DHigh,componentsPerAttribute:3,componentDatatype:H.FLOAT,offsetInBytes:k,strideInBytes:6*E},{index:te.position2DLow,componentsPerAttribute:3,componentDatatype:H.FLOAT,offsetInBytes:F,strideInBytes:6*E},{index:te.prevPosition3DHigh,componentsPerAttribute:3,componentDatatype:H.FLOAT,offsetInBytes:B,strideInBytes:6*E},{index:te.prevPosition3DLow,componentsPerAttribute:3,componentDatatype:H.FLOAT,offsetInBytes:U,strideInBytes:6*E},{index:te.prevPosition2DHigh,componentsPerAttribute:3,componentDatatype:H.FLOAT,offsetInBytes:B,strideInBytes:6*E},{index:te.prevPosition2DLow,componentsPerAttribute:3,componentDatatype:H.FLOAT,offsetInBytes:U,strideInBytes:6*E},{index:te.nextPosition3DHigh,componentsPerAttribute:3,componentDatatype:H.FLOAT,offsetInBytes:V,strideInBytes:6*E},{index:te.nextPosition3DLow,componentsPerAttribute:3,componentDatatype:H.FLOAT,offsetInBytes:z,strideInBytes:6*E},{index:te.nextPosition2DHigh,componentsPerAttribute:3,componentDatatype:H.FLOAT,offsetInBytes:V,strideInBytes:6*E},{index:te.nextPosition2DLow,componentsPerAttribute:3,componentDatatype:H.FLOAT,offsetInBytes:z,strideInBytes:6*E},{index:te.texCoordExpandAndBatchIndex,componentsPerAttribute:4,componentDatatype:H.FLOAT,vertexBuffer:e._texCoordExpandAndBatchIndexBuffer,offsetInBytes:q}];N=m===$.SCENE3D?(M=e._positionBuffer,R="vertexBuffer",L=le,"value"):(L=(R=m===$.SCENE2D||m===$.COLUMBUS_VIEW?(M=le,"value"):(M=w,"vertexBuffer"),e._positionBuffer),"vertexBuffer"),G[0][R]=M,G[1][R]=M,G[2][N]=L,G[3][N]=L,G[4][R]=M,G[5][R]=M,G[6][N]=L,G[7][N]=L,G[8][R]=M,G[9][R]=M,G[10][N]=L,G[11][N]=L;var W=new J({context:t,attributes:G,indexBuffer:I});e._vertexArrays.push({va:W,buckets:d[D]})}}}function g(e,t){return t instanceof s?t.id:t}var _=[];function ce(e){var t=p._uniformList[e.type],r=t.length;_.length=2*r;for(var i=0,n=0;n<r;++n){var o=t[n];_[i]=o,_[i+1]=e._uniforms[o](),i+=2}return e.type+":"+JSON.stringify(_,g)}function de(e){if(e._polylinesRemoved){e._polylinesRemoved=!1;for(var t=[],r=e._polylines.length,i=0,n=0;i<r;++i){var o=e._polylines[i];j(o)&&(o._index=n++,t.push(o))}e._polylines=t}}function he(e){for(var t=e._polylines,r=t.length,i=0;i<r;++i)if(j(t[i])){var n=t[i]._bucket;j(n)&&(n.shaderProgram=n.shaderProgram&&n.shaderProgram.destroy())}}function pe(e){for(var t=e._vertexArrays.length,r=0;r<t;++r)e._vertexArrays[r].va.destroy();e._vertexArrays.length=0}function v(e){for(var t=e._polylines,r=t.length,i=0;i<r;++i)j(t[i])&&t[i]._destroy()}function b(e,t,r){this.count=e,this.offset=t,this.bucket=r}function fe(e,t,r){this.polylines=[],this.lengthOfPositions=0,this.material=e,this.shaderProgram=void 0,this.pickShaderProgram=void 0,this.mode=t,this.modelMatrix=r}function y(e){return V.dot(V.UNIT_X,e._boundingVolume.center)<0||e._boundingVolume.intersectPlane(a.ORIGIN_ZX_PLANE)===o.INTERSECTING}m.prototype._updatePolyline=function(e,t){this._polylinesUpdated=!0,this._polylinesToUpdate.push(e),++this._propertiesChanged[t]},fe.prototype.addPolyline=function(e){this.polylines.push(e),e._actualLength=this.getPolylinePositionsLength(e),this.lengthOfPositions+=e._actualLength,e._bucket=this},fe.prototype.updateShader=function(e,t,r){if(!j(this.shaderProgram)){var i=["DISTANCE_DISPLAY_CONDITION"];r&&i.push("VECTOR_TILE"),-1!==this.material.shaderSource.search(/varying\s+float\s+v_polylineAngle;/g)&&i.push("POLYLINE_DASH");var n=new u({defines:i,sources:[this.material.shaderSource,d]}),o=t.getVertexShaderCallback()(h),a=new u({defines:i,sources:[c,o]}),s=new u({sources:n.sources,pickColorQualifier:"varying"});this.shaderProgram=l.fromCache({context:e,vertexShaderSource:a,fragmentShaderSource:n,attributeLocations:te}),this.pickShaderProgram=l.fromCache({context:e,vertexShaderSource:a,fragmentShaderSource:s,attributeLocations:te})}},fe.prototype.getPolylinePositionsLength=function(e){var t;if(this.mode===$.SCENE3D||!y(e))return 4*(t=e._actualPositions.length)-4;var r=0,i=e._segments.lengths;t=i.length;for(var n=0;n<t;++n)r+=4*i[n]-4;return r};var me=new V,ge=new V,_e=new V,ve=new V,ye=new z,be=new E;fe.prototype.write=function(e,t,r,i,n,o,a,s){for(var l=this.mode,u=s.ellipsoid.maximumRadius*X.PI,c=this.polylines,d=c.length,h=0;h<d;++h){for(var p,f=c[h],m=f.width,g=f.show&&0<m,_=f._index,v=this.getSegments(f,s),y=v.positions,b=v.lengths,C=y.length,w=f.getPickId(a).color,S=0,T=0,E=0;E<C;++E){0===E?f._loop?p=y[C-2]:(p=ve,V.subtract(y[0],y[1],p),V.add(y[0],p,p)):p=y[E-1],V.clone(p,ge),V.clone(y[E],me),E===C-1?f._loop?p=y[1]:(p=ve,V.subtract(y[C-1],y[C-2],p),V.add(y[C-1],p,p)):p=y[E+1],V.clone(p,_e);var A=b[S];E===T+A&&(T+=A,++S);var x=E-T==0,P=E===T+b[S]-1;l===$.SCENE2D&&(ge.z=0,me.z=0,_e.z=0),l!==$.SCENE2D&&l!==$.MORPHING||(x||P)&&u-Math.abs(me.x)<1&&((me.x<0&&0<ge.x||0<me.x&&ge.x<0)&&V.clone(me,ge),(me.x<0&&0<_e.x||0<me.x&&_e.x<0)&&V.clone(me,_e));for(var D=P?2:4,O=x?2:0;O<D;++O){G.writeElements(me,e,r),G.writeElements(ge,e,r+6),G.writeElements(_e,e,r+12);var I=O-2<0?-1:1;t[n]=E/(C-1),t[n+1]=O%2*2-1,t[n+2]=I,t[n+3]=_,r+=18,n+=4}}var M=ye;M.x=q.floatToByte(w.red),M.y=q.floatToByte(w.green),M.z=q.floatToByte(w.blue),M.w=q.floatToByte(w.alpha);var R=be;R.x=m,R.y=g?1:0;var L=l===$.SCENE2D?f._boundingVolume2D:f._boundingVolumeWC,N=G.fromCartesian(L.center,re),k=N.high,F=z.fromElements(N.low.x,N.low.y,N.low.z,L.radius,ie),B=ne;B.x=0,B.y=Number.MAX_VALUE;var U=f.distanceDisplayCondition;j(U)&&(B.x=U.near,B.y=U.far),o.setBatchedAttribute(_,0,R),o.setBatchedAttribute(_,1,M),2<o.attributes.length&&(o.setBatchedAttribute(_,2,k),o.setBatchedAttribute(_,3,F),o.setBatchedAttribute(_,4,B))}};var C=new V,w=new V,S=new V,T=new V;fe.prototype.writeForMorph=function(e,t){for(var r=this.modelMatrix,i=this.polylines,n=i.length,o=0;o<n;++o)for(var a=i[o],s=a._segments.positions,l=a._segments.lengths,u=s.length,c=0,d=0,h=0;h<u;++h){var p;0===h?a._loop?p=s[u-2]:(p=T,V.subtract(s[0],s[1],p),V.add(s[0],p,p)):p=s[h-1],p=A.multiplyByPoint(r,p,w);var f,m=A.multiplyByPoint(r,s[h],C);h===u-1?a._loop?f=s[1]:(f=T,V.subtract(s[u-1],s[u-2],f),V.add(s[u-1],f,f)):f=s[h+1],f=A.multiplyByPoint(r,f,S);var g=l[c];h===d+g&&(d+=g,++c);for(var _=h-d==0,v=h===d+l[c]-1?2:4,y=_?2:0;y<v;++y)G.writeElements(m,e,t),G.writeElements(p,e,t+6),G.writeElements(f,e,t+12),t+=18}};var Ce=new Array(1);fe.prototype.updateIndices=function(e,t,r,i){var n=r.length-1,o=new b(0,i,this);r[n].push(o);var a=0,s=e[e.length-1],l=0;0<s.length&&(l=s[s.length-1]+1);for(var u=this.polylines,c=u.length,d=0;d<c;++d){var h,p=u[d];if(p._locatorBuckets=[],this.mode===$.SCENE3D){h=Ce;var f=p._actualPositions.length;if(!(0<f))continue;h[0]=f}else h=p._segments.lengths;var m=h.length;if(0<m){for(var g=0,_=0;_<m;++_)for(var v=h[_]-1,y=0;y<v;++y)l+4>X.SIXTY_FOUR_KILOBYTES&&(p._locatorBuckets.push({locator:o,count:g}),g=0,t.push(4),s=[],e.push(s),l=0,o.count=a,o=new b(i=a=0,0,this),r[++n]=[o]),s.push(l,l+2,l+1),s.push(l+1,l+2,l+3),g+=6,a+=6,i+=6,l+=4;p._locatorBuckets.push({locator:o,count:g}),l+4>X.SIXTY_FOUR_KILOBYTES&&(t.push(0),s=[],e.push(s),l=0,o.count=a,o=new b(a=i=0,0,this),r[++n]=[o])}p._clean()}return o.count=a,i},fe.prototype.getPolylineStartIndex=function(e){for(var t=this.polylines,r=0,i=t.length,n=0;n<i;++n){var o=t[n];if(o===e)break;r+=o._actualLength}return r};var we,Se={positions:void 0,lengths:void 0},Te=new Array(1),Ee=new V,Ae=new e;return fe.prototype.getSegments=function(e,t){var r=e._actualPositions;if(this.mode===$.SCENE3D)return Te[0]=r.length,Se.positions=r,Se.lengths=Te,Se;y(e)&&(r=e._segments.positions);for(var i,n=t.ellipsoid,o=[],a=this.modelMatrix,s=r.length,l=Ee,u=0;u<s;++u)i=r[u],l=A.multiplyByPoint(a,i,l),o.push(t.project(n.cartesianToCartographic(l,Ae)));if(0<o.length){e._boundingVolume2D=B.fromPoints(o,e._boundingVolume2D);var c=e._boundingVolume2D.center;e._boundingVolume2D.center=new V(c.z,c.x,c.y)}return Se.positions=o,Se.lengths=e._segments.lengths,Se},fe.prototype.writeUpdate=function(e,t,r,i){var n=this.mode,o=i.ellipsoid.maximumRadius*X.PI,a=t._actualLength;if(a){e+=this.getPolylineStartIndex(t);var s=we,l=6*a*3;!j(s)||s.length<l?s=we=new Float32Array(l):s.length>l&&(s=new Float32Array(s.buffer,0,l));var u,c=this.getSegments(t,i),d=c.positions,h=c.lengths,p=0,f=0,m=0;a=d.length;for(var g=0;g<a;++g){0===g?t._loop?u=d[a-2]:(u=ve,V.subtract(d[0],d[1],u),V.add(d[0],u,u)):u=d[g-1],V.clone(u,ge),V.clone(d[g],me),g===a-1?t._loop?u=d[1]:(u=ve,V.subtract(d[a-1],d[a-2],u),V.add(d[a-1],u,u)):u=d[g+1],V.clone(u,_e);var _=h[f];g===m+_&&(m+=_,++f);var v=g-m==0,y=g===m+h[f]-1;n===$.SCENE2D&&(ge.z=0,me.z=0,_e.z=0),n!==$.SCENE2D&&n!==$.MORPHING||(v||y)&&o-Math.abs(me.x)<1&&((me.x<0&&0<ge.x||0<me.x&&ge.x<0)&&V.clone(me,ge),(me.x<0&&0<_e.x||0<me.x&&_e.x<0)&&V.clone(me,_e));for(var b=y?2:4,C=v?2:0;C<b;++C)G.writeElements(me,s,p),G.writeElements(ge,s,p+6),G.writeElements(_e,s,p+12),p+=18}r.copyFromArrayView(s,18*Float32Array.BYTES_PER_ELEMENT*e)}},m}),define("DataSources/ScaledPositionProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Ellipsoid","../Core/Event","../Core/ReferenceFrame","./Property"],function(i,e,n,o,t,r,a){"use strict";function s(e){this._definitionChanged=new t,this._value=void 0,this._removeSubscription=void 0,this.setValue(e)}return e(s.prototype,{isConstant:{get:function(){return a.isConstant(this._value)}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return i(this._value)?this._value.referenceFrame:r.FIXED}}}),s.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,r.FIXED,t)},s.prototype.setValue=function(e){this._value!==e&&(this._value=e,i(this._removeSubscription)&&(this._removeSubscription(),this._removeSubscription=void 0),i(e)&&(this._removeSubscription=e.definitionChanged.addEventListener(this._raiseDefinitionChanged,this)),this._definitionChanged.raiseEvent(this))},s.prototype.getValueInReferenceFrame=function(e,t,r){if(!i(e))throw new n("time is required.");if(!i(t))throw new n("referenceFrame is required.");if(i(this._value))return r=this._value.getValueInReferenceFrame(e,t,r),i(r)?o.WGS84.scaleToGeodeticSurface(r,r):void 0},s.prototype.equals=function(e){return this===e||e instanceof s&&this._value===e._value},s.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)},s}),define("DataSources/PathVisualizer",["../Core/AssociativeArray","../Core/Cartesian3","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/JulianDate","../Core/Matrix3","../Core/Matrix4","../Core/ReferenceFrame","../Core/TimeInterval","../Core/Transforms","../Scene/PolylineCollection","../Scene/SceneMode","./CompositePositionProperty","./ConstantPositionProperty","./MaterialProperty","./Property","./ReferenceProperty","./SampledPositionProperty","./ScaledPositionProperty","./TimeIntervalCollectionPositionProperty"],function(r,i,w,n,d,S,e,o,h,g,a,s,p,f,m,C,T,_,v,y,b){"use strict";var E=new g,A=new g,x=new g;function l(e){this.entity=e,this.polyline=void 0,this.index=void 0,this.updater=void 0}function P(e,t,r,i,n,o,a,s){for(;e instanceof _;)e=e.resolvedProperty;var l,u,c,d,h;e instanceof v?a=function(e,t,r,i,n,o,a,s,l){var u,c=s;u=e.getValueInReferenceFrame(t,o,l[c]),w(u)&&(l[c++]=u);for(var d,h,p,f=!w(n)||S.lessThanOrEquals(n,t)||S.greaterThanOrEquals(n,r),m=0,g=i.length,_=i[m],v=r,y=!1;m<g;){if(!f&&S.greaterThanOrEquals(_,n)&&(u=e.getValueInReferenceFrame(n,o,l[c]),w(u)&&(l[c++]=u),f=!0),S.greaterThan(_,t)&&S.lessThan(_,v)&&!_.equals(n)&&(u=e.getValueInReferenceFrame(_,o,l[c]),w(u)&&(l[c++]=u)),m<g-1){if(0<a&&!y){var b=i[m+1],C=S.secondsDifference(b,_);(y=a<C)&&(d=Math.ceil(C/a),h=0,p=C/Math.max(d,2),d=Math.max(d-1,1))}if(y&&h<d){_=S.addSeconds(_,p,new S),h++;continue}}y=!1,_=i[++m]}return u=e.getValueInReferenceFrame(r,o,l[c]),w(u)&&(l[c++]=u),c}(e,t,r,e._property._times,i,n,o,a,s):a=e instanceof f?function(e,t,r,i,n,o,a,s){A.start=t,A.stop=r;for(var l=a,u=e.intervals,c=0;c<u.length;c++){var d=u.get(c);if(!g.intersect(d,A,E).isEmpty){var h=d.start,p=d.stop,f=t;S.greaterThan(h,f)&&(f=h);var m=r;S.lessThan(p,m)&&(m=p),l=P(d.data,f,m,i,n,o,l,s)}}return l}(e,t,r,i,n,o,a,s):e instanceof b?function(e,t,r,i,n,o,a,s){x.start=t,x.stop=r;for(var l=a,u=e.intervals,c=0;c<u.length;c++){var d=u.get(c);if(!g.intersect(d,x,E).isEmpty){var h=d.start;d.isStartIncluded||(h=d.isStopIncluded?d.stop:S.addSeconds(d.start,S.secondsDifference(d.stop,d.start)/2,new S));var p=e.getValueInReferenceFrame(h,n,s[l]);w(p)&&(s[l]=p,l++)}}return l}(e,t,r,0,n,0,a,s):e instanceof m||e instanceof y&&T.isConstant(e)?(l=t,u=n,c=a,d=s,h=e.getValueInReferenceFrame(l,u,d[c]),w(h)&&(d[c++]=h),c):function(e,t,r,i,n,o,a,s){for(var l,u=0,c=a,d=t,h=Math.max(o,60),p=!w(i)||S.lessThanOrEquals(i,t)||S.greaterThanOrEquals(i,r);S.lessThan(d,r);)!p&&S.greaterThanOrEquals(d,i)&&(p=!0,l=e.getValueInReferenceFrame(i,n,s[c]),w(l)&&(s[c]=l,c++)),l=e.getValueInReferenceFrame(d,n,s[c]),w(l)&&(s[c]=l,c++),u++,d=S.addSeconds(t,h*u,new S);return l=e.getValueInReferenceFrame(r,n,s[c]),w(l)&&(s[c]=l,c++),c}(e,t,r,i,n,o,a,s);return a}function D(e,t,r,i,n,o,a){w(a)||(a=[]);var s=P(e,t,r,i,n,o,0,a);return a.length=s,a}var u=new e;function O(e,t){this._unusedIndexes=[],this._polylineCollection=new s,this._scene=e,this._referenceFrame=t,e.primitives.add(this._polylineCollection)}function c(e,t){if(!w(e))throw new d("scene is required.");if(!w(t))throw new d("entityCollection is required.");t.collectionChanged.addEventListener(c.prototype._onCollectionChanged,this),this._scene=e,this._updaters={},this._entityCollection=t,this._items=new r,this._onCollectionChanged(t,t.values,[],[])}return O.prototype.update=function(e){if(this._referenceFrame===h.INERTIAL){var t=a.computeIcrfToFixedMatrix(e,u);w(t)||(t=a.computeTemeToPseudoFixedMatrix(e,u)),o.fromRotationTranslation(t,i.ZERO,this._polylineCollection.modelMatrix)}},O.prototype.updateObject=function(e,t){var r,i,n=t.entity,o=n._path,a=n._position,s=o._show,l=t.polyline,u=n.isShowing&&(!w(s)||s.getValue(e));if(u){var c=T.getValueOrUndefined(o._leadTime,e),d=T.getValueOrUndefined(o._trailTime,e),h=n._availability,p=w(h),f=w(c),m=w(d);if(u=p||f&&m){if(m&&(r=S.addSeconds(e,-d,new S)),f&&(i=S.addSeconds(e,c,new S)),p){var g=h.start,_=h.stop;m&&!S.greaterThan(g,r)||(r=g),f&&!S.lessThan(_,i)||(i=_)}u=S.lessThan(r,i)}}if(u){if(!w(l)){var v=this._unusedIndexes;if(0<v.length){var y=v.pop();l=this._polylineCollection.get(y),t.index=y}else t.index=this._polylineCollection.length,l=this._polylineCollection.add();l.id=n,t.polyline=l}var b=T.getValueOrDefault(o._resolution,e,60);l.show=!0,l.positions=D(a,r,i,e,this._referenceFrame,b,l.positions.slice()),l.material=C.getValue(e,o._material,l.material),l.width=T.getValueOrDefault(o._width,e,1),l.distanceDisplayCondition=T.getValueOrUndefined(o._distanceDisplayCondition,e,l.distanceDisplayCondition)}else w(l)&&(this._unusedIndexes.push(t.index),t.polyline=void 0,l.show=!1,t.index=void 0)},O.prototype.removeObject=function(e){var t=e.polyline;w(t)&&(this._unusedIndexes.push(e.index),e.polyline=void 0,t.show=!1,t.id=void 0,e.index=void 0)},O.prototype.destroy=function(){return this._scene.primitives.remove(this._polylineCollection),n(this)},c.prototype.update=function(e){if(!w(e))throw new d("time is required.");var t=this._updaters;for(var r in t)t.hasOwnProperty(r)&&t[r].update(e);for(var i=this._items.values,n=0,o=i.length;n<o;n++){var a=i[n],s=a.entity._position,l=a.updater,u=h.FIXED;this._scene.mode===p.SCENE3D&&(u=s.referenceFrame);var c=this._updaters[u];l===c&&w(c)?c.updateObject(e,a):(w(l)&&l.removeObject(a),w(c)||((c=new O(this._scene,u)).update(e),this._updaters[u]=c),a.updater=c,w(c)&&c.updateObject(e,a))}return!0},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(c.prototype._onCollectionChanged,this);var e=this._updaters;for(var t in e)e.hasOwnProperty(t)&&e[t].destroy();return n(this)},c.prototype._onCollectionChanged=function(e,t,r,i){var n,o,a,s=this._items;for(n=t.length-1;-1<n;n--)o=t[n],w(o._path)&&w(o._position)&&s.set(o.id,new l(o));for(n=i.length-1;-1<n;n--)o=i[n],w(o._path)&&w(o._position)?s.contains(o.id)||s.set(o.id,new l(o)):(a=s.get(o.id),w(a)&&(a.updater.removeObject(a),s.remove(o.id)));for(n=r.length-1;-1<n;n--)o=r[n],a=s.get(o.id),w(a)&&(w(a.updater)&&a.updater.removeObject(a),s.remove(o.id))},c._subSample=D,c}),define("DataSources/PlaneGeometryUpdater",["../Core/PlaneGeometry","../Core/PlaneOutlineGeometry","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/Matrix4","../Core/ShowGeometryInstanceAttribute","../Core/Quaternion","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(_,v,c,d,y,b,C,w,e,t,S,r,T,i,E,A,h,p,f,x,P,D,n,O,o,a,I,M){"use strict";var R=new O(y.WHITE),L=new o(!0),N=new o(!0),k=new o(!1),F=new o(y.BLACK),B=new o(n.DISABLED),U=new o(new r),V=new y;function s(e){this.id=e,this.vertexFormat=void 0,this.plane=void 0,this.dimensions=void 0}function l(e,t){if(!w(e))throw new S("entity is required");if(!w(t))throw new S("scene is required");this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(l.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new i,this._showProperty=void 0,this._materialProperty=void 0,this._hasConstantOutline=!0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._options=new s(e),this._onEntityPropertyChanged(e,"plane",e.plane,void 0)}function u(e,t){this._primitives=e,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=t,this._options=new s(t._entity)}e(l,{perInstanceColorAppearanceType:{value:P},materialAppearanceType:{value:x}}),e(l.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!w(this._entity.availability)&&M.isConstant(this._showProperty)&&M.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!w(this._entity.availability)&&M.isConstant(this._showProperty)&&M.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:!1},geometryChanged:{get:function(){return this._geometryChanged}}}),l.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)},l.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)},l.prototype.createFillGeometryInstance=function(e){if(!w(e))throw new S("time is required.");if(!this._fillEnabled)throw new S("This instance does not represent a filled geometry.");var t,r=this._entity,i=r.isAvailable(e),n=new p(i&&r.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),a=T.fromDistanceDisplayCondition(o);if(this._materialProperty instanceof O){var s=y.WHITE;w(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(s=this._materialProperty.color.getValue(e)),t={show:n,distanceDisplayCondition:a,color:b.fromColor(s)}}else t={show:n,distanceDisplayCondition:a};var l=r.plane,u=this._options,c=r.computeModelMatrix(e),d=M.getValueOrDefault(l.plane,e,u.plane),h=M.getValueOrUndefined(l.dimensions,e,u.dimensions);if(w(c)&&w(d)&&w(h))return c=q(u.plane=d,u.dimensions=h,c,c),new E({id:r,geometry:new _(this._options),modelMatrix:c,attributes:t})},l.prototype.createOutlineGeometryInstance=function(e){if(!w(e))throw new S("time is required.");if(!this._outlineEnabled)throw new S("This instance does not represent an outlined geometry.");var t=this._entity,r=t.isAvailable(e),i=M.getValueOrDefault(this._outlineColorProperty,e,y.BLACK),n=this._distanceDisplayConditionProperty.getValue(e),o=t.plane,a=this._options,s=t.computeModelMatrix(e),l=M.getValueOrDefault(o.plane,e,a.plane),u=M.getValueOrUndefined(o.dimensions,e,a.dimensions);if(w(s)&&w(l)&&w(u))return s=q(a.plane=l,a.dimensions=u,s,s),new E({id:t,geometry:new v,modelMatrix:s,attributes:{show:new p(r&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:b.fromColor(i),distanceDisplayCondition:T.fromDistanceDisplayCondition(n)}})},l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){this._entitySubscription(),t(this)},l.prototype._onEntityPropertyChanged=function(e,t,r,i){if("availability"===t||"position"===t||"orientation"===t||"plane"===t){var n=this._entity.plane;if(w(n)){var o=n.fill,a=!w(o)||!o.isConstant||o.getValue(A.MINIMUM_VALUE),s=n.outline,l=w(s);if(l&&s.isConstant&&(l=s.getValue(A.MINIMUM_VALUE)),a||l){var u=n.plane,c=n.dimensions,d=e.position,h=n.show;if(w(u)&&w(c)&&w(d)&&(!w(h)||!h.isConstant||h.getValue(A.MINIMUM_VALUE))){var p=C(n.material,R),f=p instanceof O;this._materialProperty=p,this._fillProperty=C(o,N),this._showProperty=C(h,L),this._showOutlineProperty=C(n.outline,k),this._outlineColorProperty=l?C(n.outlineColor,F):void 0,this._shadowsProperty=C(n.shadows,B),this._distanceDisplayConditionProperty=C(n.distanceDisplayCondition,U);var m=n.outlineWidth;if(this._fillEnabled=a,this._outlineEnabled=l,d.isConstant&&M.isConstant(e.orientation)&&u.isConstant&&c.isConstant&&M.isConstant(m)){var g=this._options;g.vertexFormat=f?P.VERTEX_FORMAT:x.MaterialSupport.TEXTURED.vertexFormat,g.plane=u.getValue(A.MINIMUM_VALUE,g.plane),g.dimensions=c.getValue(A.MINIMUM_VALUE,g.dimensions),this._outlineWidth=w(m)?m.getValue(A.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}},l.prototype.createDynamicUpdater=function(e){if(!this._dynamic)throw new S("This instance does not represent dynamic geometry.");if(!w(e))throw new S("primitives is required.");return new u(e,this)},u.prototype.update=function(e){if(!w(e))throw new S("time is required.");var t=this._primitives;t.removeAndDestroy(this._primitive),t.removeAndDestroy(this._outlinePrimitive),this._primitive=void 0,this._outlinePrimitive=void 0;var r=this._geometryUpdater,i=r._entity,n=i.plane;if(i.isShowing&&i.isAvailable(e)&&M.getValueOrDefault(n.show,e,!0)){var o=this._options,a=i.computeModelMatrix(e),s=M.getValueOrDefault(n.plane,e,o.plane),l=M.getValueOrUndefined(n.dimensions,e,o.dimensions);if(w(a)&&w(s)&&w(l)){a=q(o.plane=s,o.dimensions=l,a,a);var u=this._geometryUpdater.shadowsProperty.getValue(e),c=this._geometryUpdater.distanceDisplayConditionProperty.getValue(e),d=T.fromDistanceDisplayCondition(c);if(M.getValueOrDefault(n.fill,e,!0)){var h=I.getValue(e,r.fillMaterialProperty,this._material);this._material=h;var p=new x({material:h,translucent:h.isTranslucent(),closed:!0});o.vertexFormat=p.vertexFormat,this._primitive=t.add(new D({geometryInstances:new E({id:i,geometry:new _,modelMatrix:a,attributes:{distanceDisplayCondition:d}}),appearance:p,asynchronous:!1,shadows:u}))}if(M.getValueOrDefault(n.outline,e,!1)){o.vertexFormat=P.VERTEX_FORMAT;var f=M.getValueOrClonedDefault(n.outlineColor,e,y.BLACK,V),m=M.getValueOrDefault(n.outlineWidth,e,1),g=1!==f.alpha;this._outlinePrimitive=t.add(new D({geometryInstances:new E({id:i,geometry:new v,modelMatrix:a,attributes:{color:b.fromColor(f),distanceDisplayCondition:d}}),appearance:new P({flat:!0,translucent:g,renderState:{lineWidth:r._scene.clampLineWidth(m)}}),asynchronous:!1,shadows:u}))}}}};var m=new d,g=new d,z=new d;function q(e,t,r,i){var n,o;o=w(e)?(n=e.normal,e.distance):(n=d.clone(d.UNIT_X,g),0),w(t)||(t=new c(1,1));var a=d.multiplyByScalar(n,-o,m);a=h.multiplyByPoint(r,a,a);var s=h.multiplyByPointAsVector(r,n,g);d.normalize(s,s);var l=function(e,t){var r=d.angleBetween(e,t);if(0===r)return f.clone(f.IDENTITY,W);var i=d.cross(t,e,G);return f.fromAxisAngle(i,r,W)}(s,d.UNIT_Z),u=c.clone(t,z);return u.z=1,h.fromTranslationQuaternionRotationScale(a,l,u,i)}var G=new d,W=new f;return u.prototype.getBoundingSphere=function(e,t){return a(e,this._primitive,this._outlinePrimitive,t)},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),t(this)},l}),define("Scene/createBillboardPointCallback",[],function(){"use strict";return function(i,n,o,a,s){return function(){var e=document.createElement("canvas"),t=s+2*a;e.height=e.width=t;var r=e.getContext("2d");return r.clearRect(0,0,t,t),0!==a&&(r.beginPath(),r.arc(t/2,t/2,t/2,0,2*Math.PI,!0),r.closePath(),r.fillStyle=o,r.fill(),i<1&&(r.save(),r.globalCompositeOperation="destination-out",r.beginPath(),r.arc(t/2,t/2,s/2,0,2*Math.PI,!0),r.closePath(),r.fillStyle="black",r.fill(),r.restore())),r.beginPath(),r.arc(t/2,t/2,s/2,0,2*Math.PI,!0),r.closePath(),r.fillStyle=n,r.fill(),e}}}),define("DataSources/PointVisualizer",["../Core/AssociativeArray","../Core/Cartesian3","../Core/Color","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/NearFarScalar","../Scene/createBillboardPointCallback","../Scene/HeightReference","./BoundingSphereState","./Property"],function(r,n,C,w,i,S,e,t,T,E,o,A){"use strict";var x=C.WHITE,P=C.BLACK,D=new C,O=new n,I=new C,M=new t,R=new t,L=new e;function l(e){this.entity=e,this.pointPrimitive=void 0,this.billboard=void 0,this.color=void 0,this.outlineColor=void 0,this.pixelSize=void 0,this.outlineWidth=void 0}function a(e,t){if(!w(e))throw new S("entityCluster is required.");if(!w(t))throw new S("entityCollection is required.");t.collectionChanged.addEventListener(a.prototype._onCollectionChanged,this),this._cluster=e,this._entityCollection=t,this._items=new r,this._onCollectionChanged(t,t.values,[],[])}function N(e,t,r){if(w(e)){var i=e.pointPrimitive;if(w(i))return e.pointPrimitive=void 0,void r.removePoint(t);var n=e.billboard;w(n)&&(e.billboard=void 0,r.removeBillboard(t))}}return a.prototype.update=function(e){if(!w(e))throw new S("time is required.");for(var t=this._items.values,r=this._cluster,i=0,n=t.length;i<n;i++){var o=t[i],a=o.entity,s=a._point,l=o.pointPrimitive,u=o.billboard,c=A.getValueOrDefault(s._heightReference,e,E.NONE),d=a.isShowing&&a.isAvailable(e)&&A.getValueOrDefault(s._show,e,!0);if(d&&(O=A.getValueOrUndefined(a._position,e,O),d=w(O)),d){A.isConstant(a._position)||(r._clusterDirty=!0);var h=!1;if(c===E.NONE||w(u)?c!==E.NONE||w(l)||(w(u)&&(N(o,a,r),u=void 0),(l=r.getPoint(a)).id=a,o.pointPrimitive=l):(w(l)&&(N(o,a,r),l=void 0),(u=r.getBillboard(a)).id=a,u.image=void 0,o.billboard=u,h=!0),w(l))l.show=!0,l.position=O,l.scaleByDistance=A.getValueOrUndefined(s._scaleByDistance,e,M),l.translucencyByDistance=A.getValueOrUndefined(s._translucencyByDistance,e,R),l.color=A.getValueOrDefault(s._color,e,x,D),l.outlineColor=A.getValueOrDefault(s._outlineColor,e,P,I),l.outlineWidth=A.getValueOrDefault(s._outlineWidth,e,0),l.pixelSize=A.getValueOrDefault(s._pixelSize,e,1),l.distanceDisplayCondition=A.getValueOrUndefined(s._distanceDisplayCondition,e,L),l.disableDepthTestDistance=A.getValueOrDefault(s._disableDepthTestDistance,e,0);else if(w(u)){u.show=!0,u.position=O,u.scaleByDistance=A.getValueOrUndefined(s._scaleByDistance,e,M),u.translucencyByDistance=A.getValueOrUndefined(s._translucencyByDistance,e,R),u.distanceDisplayCondition=A.getValueOrUndefined(s._distanceDisplayCondition,e,L),u.disableDepthTestDistance=A.getValueOrDefault(s._disableDepthTestDistance,e,0),u.heightReference=c;var p=A.getValueOrDefault(s._color,e,x,D),f=A.getValueOrDefault(s._outlineColor,e,P,I),m=Math.round(A.getValueOrDefault(s._outlineWidth,e,0)),g=Math.max(1,Math.round(A.getValueOrDefault(s._pixelSize,e,1)));if(h=0<m?(u.scale=1,h||m!==o.outlineWidth||g!==o.pixelSize||!C.equals(p,o.color)||!C.equals(f,o.outlineColor)):(u.scale=g/50,g=50,h||m!==o.outlineWidth||!C.equals(p,o.color)||!C.equals(f,o.outlineColor))){o.color=C.clone(p,o.color),o.outlineColor=C.clone(f,o.outlineColor),o.pixelSize=g,o.outlineWidth=m;var _=p.alpha,v=p.toCssColorString(),y=f.toCssColorString(),b=JSON.stringify([v,g,y,m]);u.setImage(b,T(_,v,y,m,g))}}}else N(o,a,r)}return!0},a.prototype.getBoundingSphere=function(e,t){if(!w(e))throw new S("entity is required.");if(!w(t))throw new S("result is required.");var r=this._items.get(e.id);if(!w(r)||!w(r.pointPrimitive)&&!w(r.billboard))return o.FAILED;if(w(r.pointPrimitive))t.center=n.clone(r.pointPrimitive.position,t.center);else{var i=r.billboard;if(!w(i._clampedPosition))return o.PENDING;t.center=n.clone(i._clampedPosition,t.center)}return t.radius=0,o.DONE},a.prototype.isDestroyed=function(){return!1},a.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(a.prototype._onCollectionChanged,this);for(var e=this._entityCollection.values,t=0;t<e.length;t++)this._cluster.removePoint(e[t]);return i(this)},a.prototype._onCollectionChanged=function(e,t,r,i){var n,o,a=this._items,s=this._cluster;for(n=t.length-1;-1<n;n--)o=t[n],w(o._point)&&w(o._position)&&a.set(o.id,new l(o));for(n=i.length-1;-1<n;n--)o=i[n],w(o._point)&&w(o._position)?a.contains(o.id)||a.set(o.id,new l(o)):(N(a.get(o.id),o,s),a.remove(o.id));for(n=r.length-1;-1<n;n--)o=r[n],N(a.get(o.id),o,s),a.remove(o.id)},a}),define("DataSources/PolygonGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/isArray","../Core/Iso8601","../Core/oneTimeWarning","../Core/PolygonGeometry","../Core/PolygonHierarchy","../Core/PolygonOutlineGeometry","../Core/ShowGeometryInstanceAttribute","../Scene/GroundPrimitive","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(y,b,O,I,e,r,C,t,l,i,w,M,R,L,S,N,T,u,k,F,B,E,n,U,o,a,A,V){"use strict";var z=new U(y.WHITE),q=new o(!0),G=new o(!0),W=new o(!1),H=new o(y.BLACK),j=new o(n.DISABLED),Y=new o(new t),x=new y;function s(e){this.id=e,this.vertexFormat=void 0,this.polygonHierarchy=void 0,this.perPositionHeight=void 0,this.closeTop=void 0,this.closeBottom=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0}function c(e,t){if(!I(e))throw new C("entity is required");if(!I(t))throw new C("scene is required");this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(c.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._isClosed=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new i,this._showProperty=void 0,this._materialProperty=void 0,this._hasConstantOutline=!0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._onTerrain=!1,this._options=new s(e),this._onEntityPropertyChanged(e,"polygon",e.polygon,void 0)}function d(e,t,r){this._primitives=e,this._groundPrimitives=t,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=r,this._options=new s(r._entity)}return e(c,{perInstanceColorAppearanceType:{value:B},materialAppearanceType:{value:F}}),e(c.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!I(this._entity.availability)&&V.isConstant(this._showProperty)&&V.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!I(this._entity.availability)&&V.isConstant(this._showProperty)&&V.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}}),c.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)},c.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)},c.prototype.createFillGeometryInstance=function(e){if(!I(e))throw new C("time is required.");if(!this._fillEnabled)throw new C("This instance does not represent a filled geometry.");var t,r=this._entity,i=r.isAvailable(e),n=new u(i&&r.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),a=l.fromDistanceDisplayCondition(o);if(this._materialProperty instanceof U){var s=y.WHITE;I(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(s=this._materialProperty.color.getValue(e)),t={show:n,distanceDisplayCondition:a,color:b.fromColor(s)}}else t={show:n,distanceDisplayCondition:a};return new w({id:r,geometry:new S(this._options),attributes:t})},c.prototype.createOutlineGeometryInstance=function(e){if(!I(e))throw new C("time is required.");if(!this._outlineEnabled)throw new C("This instance does not represent an outlined geometry.");var t=this._entity,r=t.isAvailable(e),i=V.getValueOrDefault(this._outlineColorProperty,e,y.BLACK),n=this._distanceDisplayConditionProperty.getValue(e);return new w({id:t,geometry:new T(this._options),attributes:{show:new u(r&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:b.fromColor(i),distanceDisplayCondition:l.fromDistanceDisplayCondition(n)}})},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){this._entitySubscription(),r(this)},c.prototype._onEntityPropertyChanged=function(e,t,r,i){if("availability"===t||"polygon"===t){var n=this._entity.polygon;if(I(n)){var o=n.fill,a=!I(o)||!o.isConstant||o.getValue(R.MINIMUM_VALUE),s=n.perPositionHeight,l=I(s)&&(!s.isConstant||s.getValue(R.MINIMUM_VALUE)),u=n.outline,c=I(u);if(c&&u.isConstant&&(c=u.getValue(R.MINIMUM_VALUE)),a||c){var d=n.hierarchy,h=n.show;if(I(h)&&h.isConstant&&!h.getValue(R.MINIMUM_VALUE)||!I(d))(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this));else{var p=O(n.material,z),f=p instanceof U;this._materialProperty=p,this._fillProperty=O(o,G),this._showProperty=O(h,q),this._showOutlineProperty=O(n.outline,W),this._outlineColorProperty=c?O(n.outlineColor,H):void 0,this._shadowsProperty=O(n.shadows,j),this._distanceDisplayConditionProperty=O(n.distanceDisplayCondition,Y);var m=n.height,g=n.extrudedHeight,_=n.granularity,v=n.stRotation,y=n.outlineWidth,b=a&&!I(m)&&!I(g)&&f&&!l&&k.isSupported(this._scene);c&&b&&(L(L.geometryOutlines),c=!1);var C=n.perPositionHeight,w=n.closeTop,S=n.closeBottom;if(this._fillEnabled=a,this._onTerrain=b,this._outlineEnabled=c,d.isConstant&&V.isConstant(m)&&V.isConstant(g)&&V.isConstant(_)&&V.isConstant(v)&&V.isConstant(y)&&V.isConstant(s)&&V.isConstant(C)&&V.isConstant(w)&&V.isConstant(S)&&(!b||V.isConstant(p))){var T=this._options;T.vertexFormat=f?B.VERTEX_FORMAT:F.MaterialSupport.TEXTURED.vertexFormat;var E=d.getValue(R.MINIMUM_VALUE);M(E)&&(E=new N(E));var A=V.getValueOrUndefined(m,R.MINIMUM_VALUE),x=V.getValueOrDefault(w,R.MINIMUM_VALUE,!0),P=V.getValueOrDefault(S,R.MINIMUM_VALUE,!0),D=V.getValueOrUndefined(g,R.MINIMUM_VALUE);T.polygonHierarchy=E,T.height=A,T.extrudedHeight=D,T.granularity=V.getValueOrUndefined(_,R.MINIMUM_VALUE),T.stRotation=V.getValueOrUndefined(v,R.MINIMUM_VALUE),T.perPositionHeight=V.getValueOrUndefined(C,R.MINIMUM_VALUE),T.closeTop=x,T.closeBottom=P,this._outlineWidth=V.getValueOrDefault(y,R.MINIMUM_VALUE,1),this._isClosed=I(D)&&D!==A&&x&&P,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}},c.prototype.createDynamicUpdater=function(e,t){if(!this._dynamic)throw new C("This instance does not represent dynamic geometry.");if(!I(e))throw new C("primitives is required.");return new d(e,t,this)},d.prototype.update=function(e){if(!I(e))throw new C("time is required.");var t=this._geometryUpdater,r=t._onTerrain,i=this._primitives,n=this._groundPrimitives;r?n.removeAndDestroy(this._primitive):(i.removeAndDestroy(this._primitive),i.removeAndDestroy(this._outlinePrimitive),this._outlinePrimitive=void 0),this._primitive=void 0;var o=t._entity,a=o.polygon;if(o.isShowing&&o.isAvailable(e)&&V.getValueOrDefault(a.show,e,!0)){var s=this._options,l=V.getValueOrUndefined(a.hierarchy,e);if(I(l)){M(l)?s.polygonHierarchy=new N(l):s.polygonHierarchy=l;var u=V.getValueOrDefault(a.closeTop,e,!0),c=V.getValueOrDefault(a.closeBottom,e,!0);s.height=V.getValueOrUndefined(a.height,e),s.extrudedHeight=V.getValueOrUndefined(a.extrudedHeight,e),s.granularity=V.getValueOrUndefined(a.granularity,e),s.stRotation=V.getValueOrUndefined(a.stRotation,e),s.perPositionHeight=V.getValueOrUndefined(a.perPositionHeight,e),s.closeTop=u,s.closeBottom=c;var d=this._geometryUpdater.shadowsProperty.getValue(e);if(V.getValueOrDefault(a.fill,e,!0)){var h=t.fillMaterialProperty,p=A.getValue(e,h,this._material);if(this._material=p,r){var f=y.WHITE;I(h.color)&&(f=h.color.getValue(e)),this._primitive=n.add(new k({geometryInstances:new w({id:o,geometry:new S(s),attributes:{color:b.fromColor(f)}}),asynchronous:!1,shadows:d}))}else{var m=new F({material:p,translucent:p.isTranslucent(),closed:I(s.extrudedHeight)&&s.extrudedHeight!==s.height&&u&&c});s.vertexFormat=m.vertexFormat,this._primitive=i.add(new E({geometryInstances:new w({id:o,geometry:new S(s)}),appearance:m,asynchronous:!1,shadows:d}))}}if(!r&&V.getValueOrDefault(a.outline,e,!1)){s.vertexFormat=B.VERTEX_FORMAT;var g=V.getValueOrClonedDefault(a.outlineColor,e,y.BLACK,x),_=V.getValueOrDefault(a.outlineWidth,e,1),v=1!==g.alpha;this._outlinePrimitive=i.add(new E({geometryInstances:new w({id:o,geometry:new T(s),attributes:{color:b.fromColor(g)}}),appearance:new B({flat:!0,translucent:v,renderState:{lineWidth:t._scene.clampLineWidth(_)}}),asynchronous:!1,shadows:d}))}}}},d.prototype.getBoundingSphere=function(e,t){return a(e,this._primitive,this._outlinePrimitive,t)},d.prototype.isDestroyed=function(){return!1},d.prototype.destroy=function(){var e=this._primitives,t=this._groundPrimitives;this._geometryUpdater._onTerrain?t.removeAndDestroy(this._primitive):e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),r(this)},c}),define("Shaders/Appearances/PolylineColorAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 prevPosition3DHigh;\nattribute vec3 prevPosition3DLow;\nattribute vec3 nextPosition3DHigh;\nattribute vec3 nextPosition3DLow;\nattribute vec2 expandAndWidth;\nattribute vec4 color;\nattribute float batchId;\nvarying vec4 v_color;\nvoid main()\n{\nfloat expandDir = expandAndWidth.x;\nfloat width = abs(expandAndWidth.y) + 0.5;\nbool usePrev = expandAndWidth.y < 0.0;\nvec4 p = czm_computePosition();\nvec4 prev = czm_computePrevPosition();\nvec4 next = czm_computeNextPosition();\nv_color = color;\nfloat angle;\nvec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, angle);\ngl_Position = czm_viewportOrthographic * positionWC;\n}\n"}),define("Scene/PolylineColorAppearance",["../Core/defaultValue","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/PerInstanceFlatColorAppearanceFS","../Shaders/Appearances/PolylineColorAppearanceVS","../Shaders/PolylineCommon","./Appearance"],function(i,e,t,r,n,o,a){"use strict";var s=o+"\n"+n,l=r;function u(e){e=i(e,i.EMPTY_OBJECT);var t=i(e.translucent,!0),r=u.VERTEX_FORMAT;this.material=void 0,this.translucent=t,this._vertexShaderSource=i(e.vertexShaderSource,s),this._fragmentShaderSource=i(e.fragmentShaderSource,l),this._renderState=a.getDefaultRenderState(t,!1,e.renderState),this._closed=!1,this._vertexFormat=r}return e(u.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}}),u.VERTEX_FORMAT=t.POSITION_ONLY,u.prototype.getFragmentShaderSource=a.prototype.getFragmentShaderSource,u.prototype.isTranslucent=a.prototype.isTranslucent,u.prototype.getRenderState=a.prototype.getRenderState,u}),define("Shaders/Appearances/PolylineMaterialAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 prevPosition3DHigh;\nattribute vec3 prevPosition3DLow;\nattribute vec3 nextPosition3DHigh;\nattribute vec3 nextPosition3DLow;\nattribute vec2 expandAndWidth;\nattribute vec2 st;\nattribute float batchId;\nvarying float v_width;\nvarying vec2 v_st;\nvarying float v_polylineAngle;\nvoid main()\n{\nfloat expandDir = expandAndWidth.x;\nfloat width = abs(expandAndWidth.y) + 0.5;\nbool usePrev = expandAndWidth.y < 0.0;\nvec4 p = czm_computePosition();\nvec4 prev = czm_computePrevPosition();\nvec4 next = czm_computeNextPosition();\nv_width = width;\nv_st = st;\nvec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, v_polylineAngle);\ngl_Position = czm_viewportOrthographic * positionWC;\n}\n"}),define("Scene/PolylineMaterialAppearance",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/PolylineMaterialAppearanceVS","../Shaders/PolylineCommon","../Shaders/PolylineFS","./Appearance","./Material"],function(i,n,e,t,r,o,a,s,l){"use strict";var u=o+"\n"+r,c=a;function d(e){e=i(e,i.EMPTY_OBJECT);var t=i(e.translucent,!0),r=d.VERTEX_FORMAT;this.material=n(e.material)?e.material:l.fromType(l.ColorType),this.translucent=t,this._vertexShaderSource=i(e.vertexShaderSource,u),this._fragmentShaderSource=i(e.fragmentShaderSource,c),this._renderState=s.getDefaultRenderState(t,!1,e.renderState),this._closed=!1,this._vertexFormat=r}return e(d.prototype,{vertexShaderSource:{get:function(){var e=this._vertexShaderSource;return-1!==this.material.shaderSource.search(/varying\s+float\s+v_polylineAngle;/g)&&(e="#define POLYLINE_DASH\n"+e),e}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}}),d.VERTEX_FORMAT=t.POSITION_AND_ST,d.prototype.getFragmentShaderSource=s.prototype.getFragmentShaderSource,d.prototype.isTranslucent=s.prototype.isTranslucent,d.prototype.getRenderState=s.prototype.getRenderState,d}),define("DataSources/PolylineGeometryUpdater",["../Core/BoundingSphere","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/PolylineGeometry","../Core/PolylinePipeline","../Core/ShowGeometryInstanceAttribute","../Scene/PolylineCollection","../Scene/PolylineColorAppearance","../Scene/PolylineMaterialAppearance","../Scene/ShadowMode","./BoundingSphereState","./ColorMaterialProperty","./ConstantProperty","./MaterialProperty","./Property"],function(i,s,l,m,g,e,r,u,t,c,n,d,_,h,p,f,o,v,y,a,b,C,w,S,T){"use strict";var E={},A=new C(s.WHITE),x=new w(!0),P=new w(a.DISABLED),D=new w(new t);function O(e){this.id=e,this.vertexFormat=void 0,this.positions=void 0,this.width=void 0,this.followSurface=void 0,this.granularity=void 0}function I(e,t){if(!g(e))throw new u("entity is required");if(!g(t))throw new u("scene is required");this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(I.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._dynamic=!1,this._geometryChanged=new n,this._showProperty=void 0,this._materialProperty=void 0,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._depthFailMaterialProperty=void 0,this._options=new O(e),this._onEntityPropertyChanged(e,"polyline",e.polyline,void 0)}e(I,{perInstanceColorAppearanceType:{value:v},materialAppearanceType:{value:y}}),e(I.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!g(this._entity.availability)&&T.isConstant(this._showProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},depthFailMaterialProperty:{get:function(){return this._depthFailMaterialProperty}},outlineEnabled:{value:!1},hasConstantOutline:{value:!0},outlineColorProperty:{value:void 0},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:!1},geometryChanged:{get:function(){return this._geometryChanged}}}),I.prototype.isOutlineVisible=function(e){return!1},I.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)},I.prototype.createFillGeometryInstance=function(e){if(!g(e))throw new u("time is required.");if(!this._fillEnabled)throw new u("This instance does not represent a filled geometry.");var t,r=this._entity,i=r.isAvailable(e),n=new f(i&&r.isShowing&&this._showProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),a={show:n,distanceDisplayCondition:c.fromDistanceDisplayCondition(o)};return this._materialProperty instanceof C&&(t=s.WHITE,g(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(t=this._materialProperty.color.getValue(e)),a.color=l.fromColor(t)),g(this._depthFailMaterialProperty)&&this._depthFailMaterialProperty instanceof C&&(t=s.WHITE,g(this._depthFailMaterialProperty.color)&&(this._depthFailMaterialProperty.color.isConstant||i)&&(t=this._depthFailMaterialProperty.color.getValue(e)),a.depthFailColor=l.fromColor(t)),new d({id:r,geometry:new h(this._options),attributes:a})},I.prototype.createOutlineGeometryInstance=function(e){throw new u("This instance does not represent an outlined geometry.")},I.prototype.isDestroyed=function(){return!1},I.prototype.destroy=function(){this._entitySubscription(),r(this)},I.prototype._onEntityPropertyChanged=function(e,t,r,i){if("availability"===t||"polyline"===t){var n=this._entity.polyline;if(g(n)){var o=n.positions,a=n.show;if(g(a)&&a.isConstant&&!a.getValue(_.MINIMUM_VALUE)||!g(o))this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this));else{var s=m(n.material,A),l=s instanceof C;this._materialProperty=s,this._depthFailMaterialProperty=n.depthFailMaterial,this._showProperty=m(a,x),this._shadowsProperty=m(n.shadows,P),this._distanceDisplayConditionProperty=m(n.distanceDisplayCondition,D),this._fillEnabled=!0;var u=n.width,c=n.followSurface,d=n.granularity;if(o.isConstant&&T.isConstant(u)&&T.isConstant(c)&&T.isConstant(d)){var h,p=this._options,f=o.getValue(_.MINIMUM_VALUE,p.positions);if(!g(f)||f.length<2)return void(this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this)));h=l&&(!g(this._depthFailMaterialProperty)||this._depthFailMaterialProperty instanceof C)?v.VERTEX_FORMAT:y.VERTEX_FORMAT,p.vertexFormat=h,p.positions=f,p.width=g(u)?u.getValue(_.MINIMUM_VALUE):void 0,p.followSurface=g(c)?c.getValue(_.MINIMUM_VALUE):void 0,p.granularity=g(d)?d.getValue(_.MINIMUM_VALUE):void 0,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}}else this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this))}},I.prototype.createDynamicUpdater=function(e){if(!this._dynamic)throw new u("This instance does not represent dynamic geometry.");if(!g(e))throw new u("primitives is required.");return new R(e,this)};var M={positions:void 0,granularity:void 0,height:void 0,ellipsoid:void 0};function R(e,t){var r=t._scene.id,i=E[r];!g(i)||i.isDestroyed()?(i=new o,E[r]=i,e.add(i)):e.contains(i)||e.add(i);var n=i.add();n.id=t._entity,this._line=n,this._primitives=e,this._geometryUpdater=t,this._positions=[]}return R.prototype.update=function(e){var t=this._geometryUpdater,r=t._entity,i=r.polyline,n=this._line;if(r.isShowing&&r.isAvailable(e)&&T.getValueOrDefault(i._show,e,!0)){var o=i.positions,a=T.getValueOrUndefined(o,e,this._positions);if(!g(a)||a.length<2)n.show=!1;else{var s=T.getValueOrDefault(i._followSurface,e,!0),l=t._scene.globe;s&&g(l)&&(M.ellipsoid=l.ellipsoid,M.positions=a,M.granularity=T.getValueOrUndefined(i._granularity,e),M.height=p.extractHeights(a,l.ellipsoid),a=p.generateCartesianArc(M)),n.show=!0,n.positions=a.slice(),n.material=S.getValue(e,t.fillMaterialProperty,n.material),n.width=T.getValueOrDefault(i._width,e,1),n.distanceDisplayCondition=T.getValueOrUndefined(i._distanceDisplayCondition,e,n.distanceDisplayCondition)}}else n.show=!1},R.prototype.getBoundingSphere=function(e,t){if(!g(e))throw new u("entity is required.");if(!g(t))throw new u("result is required.");var r=this._line;return r.show&&0<r.positions.length?(i.fromPoints(r.positions,t),b.DONE):b.FAILED},R.prototype.isDestroyed=function(){return!1},R.prototype.destroy=function(){var e=this._geometryUpdater._scene.id,t=E[e];t.remove(this._line),0===t.length&&(this._primitives.removeAndDestroy(t),delete E[e]),r(this)},I}),define("DataSources/PolylineVolumeGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/PolylineVolumeGeometry","../Core/PolylineVolumeOutlineGeometry","../Core/ShowGeometryInstanceAttribute","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(f,m,v,y,e,t,g,r,l,i,_,b,C,w,u,S,T,E,n,A,o,a,x,P){"use strict";var D=new A(f.WHITE),O=new o(!0),I=new o(!0),M=new o(!1),R=new o(f.BLACK),L=new o(n.DISABLED),N=new o(new r),k=new f;function s(e){this.id=e,this.vertexFormat=void 0,this.polylinePositions=void 0,this.shapePositions=void 0,this.cornerType=void 0,this.granularity=void 0}function c(e,t){if(!y(e))throw new g("entity is required");if(!y(t))throw new g("scene is required");this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(c.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new i,this._showProperty=void 0,this._materialProperty=void 0,this._hasConstantOutline=!0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._options=new s(e),this._onEntityPropertyChanged(e,"polylineVolume",e.polylineVolume,void 0)}function d(e,t){this._primitives=e,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=t,this._options=new s(t._entity)}return e(c,{perInstanceColorAppearanceType:{value:T},materialAppearanceType:{value:S}}),e(c.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!y(this._entity.availability)&&P.isConstant(this._showProperty)&&P.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!y(this._entity.availability)&&P.isConstant(this._showProperty)&&P.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:!0},geometryChanged:{get:function(){return this._geometryChanged}}}),c.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)},c.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)},c.prototype.createFillGeometryInstance=function(e){if(!y(e))throw new g("time is required.");if(!this._fillEnabled)throw new g("This instance does not represent a filled geometry.");var t,r=this._entity,i=r.isAvailable(e),n=new u(i&&r.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),a=l.fromDistanceDisplayCondition(o);if(this._materialProperty instanceof A){var s=f.WHITE;y(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(s=this._materialProperty.color.getValue(e)),t={show:n,distanceDisplayCondition:a,color:m.fromColor(s)}}else t={show:n,distanceDisplayCondition:a};return new _({id:r,geometry:new C(this._options),attributes:t})},c.prototype.createOutlineGeometryInstance=function(e){if(!y(e))throw new g("time is required.");if(!this._outlineEnabled)throw new g("This instance does not represent an outlined geometry.");var t=this._entity,r=t.isAvailable(e),i=P.getValueOrDefault(this._outlineColorProperty,e,f.BLACK),n=this._distanceDisplayConditionProperty.getValue(e);return new _({id:t,geometry:new w(this._options),attributes:{show:new u(r&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:m.fromColor(i),distanceDisplayCondition:l.fromDistanceDisplayCondition(n)}})},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){this._entitySubscription(),t(this)},c.prototype._onEntityPropertyChanged=function(e,t,r,i){if("availability"===t||"polylineVolume"===t){var n=this._entity.polylineVolume;if(y(n)){var o=n.fill,a=!y(o)||!o.isConstant||o.getValue(b.MINIMUM_VALUE),s=n.outline,l=y(s);if(l&&s.isConstant&&(l=s.getValue(b.MINIMUM_VALUE)),a||l){var u=n.positions,c=n.shape,d=n.show;if(!y(u)||!y(c)||y(d)&&d.isConstant&&!d.getValue(b.MINIMUM_VALUE))(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this));else{var h=v(n.material,D),p=h instanceof A;this._materialProperty=h,this._fillProperty=v(o,I),this._showProperty=v(d,O),this._showOutlineProperty=v(n.outline,M),this._outlineColorProperty=l?v(n.outlineColor,R):void 0,this._shadowsProperty=v(n.shadows,L),this._distanceDisplayConditionProperty=v(n.distanceDisplayCondition,N);var f=n.granularity,m=n.outlineWidth,g=n.cornerType;if(this._fillEnabled=a,this._outlineEnabled=l,u.isConstant&&c.isConstant&&P.isConstant(f)&&P.isConstant(m)&&P.isConstant(g)){var _=this._options;_.vertexFormat=p?T.VERTEX_FORMAT:S.MaterialSupport.TEXTURED.vertexFormat,_.polylinePositions=u.getValue(b.MINIMUM_VALUE,_.polylinePositions),_.shapePositions=c.getValue(b.MINIMUM_VALUE,_.shape),_.granularity=y(f)?f.getValue(b.MINIMUM_VALUE):void 0,_.cornerType=y(g)?g.getValue(b.MINIMUM_VALUE):void 0,this._outlineWidth=y(m)?m.getValue(b.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}},c.prototype.createDynamicUpdater=function(e){if(!this._dynamic)throw new g("This instance does not represent dynamic geometry.");if(!y(e))throw new g("primitives is required.");return new d(e,this)},d.prototype.update=function(e){if(!y(e))throw new g("time is required.");var t=this._primitives;t.removeAndDestroy(this._primitive),t.removeAndDestroy(this._outlinePrimitive),this._primitive=void 0,this._outlinePrimitive=void 0;var r=this._geometryUpdater,i=r._entity,n=i.polylineVolume;if(i.isShowing&&i.isAvailable(e)&&P.getValueOrDefault(n.show,e,!0)){var o=this._options,a=P.getValueOrUndefined(n.positions,e,o.polylinePositions),s=P.getValueOrUndefined(n.shape,e);if(y(a)&&y(s)){o.polylinePositions=a,o.shapePositions=s,o.granularity=P.getValueOrUndefined(n.granularity,e),o.cornerType=P.getValueOrUndefined(n.cornerType,e);var l=this._geometryUpdater.shadowsProperty.getValue(e);if(!y(n.fill)||n.fill.getValue(e)){var u=x.getValue(e,r.fillMaterialProperty,this._material);this._material=u;var c=new S({material:u,translucent:u.isTranslucent(),closed:!0});o.vertexFormat=c.vertexFormat,this._primitive=t.add(new E({geometryInstances:new _({id:i,geometry:new C(o)}),appearance:c,asynchronous:!1,shadows:l}))}if(y(n.outline)&&n.outline.getValue(e)){o.vertexFormat=T.VERTEX_FORMAT;var d=P.getValueOrClonedDefault(n.outlineColor,e,f.BLACK,k),h=P.getValueOrDefault(n.outlineWidth,e,1),p=1!==d.alpha;this._outlinePrimitive=t.add(new E({geometryInstances:new _({id:i,geometry:new w(o),attributes:{color:m.fromColor(d)}}),appearance:new T({flat:!0,translucent:p,renderState:{lineWidth:r._scene.clampLineWidth(h)}}),asynchronous:!1,shadows:l}))}}}},d.prototype.getBoundingSphere=function(e,t){return a(e,this._primitive,this._outlinePrimitive,t)},d.prototype.isDestroyed=function(){return!1},d.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),t(this)},c}),define("DataSources/RectangleGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/oneTimeWarning","../Core/RectangleGeometry","../Core/RectangleOutlineGeometry","../Core/ShowGeometryInstanceAttribute","../Scene/GroundPrimitive","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(_,v,S,T,e,r,y,t,l,i,b,E,A,C,w,u,x,P,D,O,n,I,o,a,M,R){"use strict";var L=new I(_.WHITE),N=new o(!0),k=new o(!0),F=new o(!1),B=new o(_.BLACK),U=new o(n.DISABLED),V=new o(new t),z=new _;function s(e){this.id=e,this.vertexFormat=void 0,this.rectangle=void 0,this.closeBottom=void 0,this.closeTop=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.rotation=void 0}function c(e,t){if(!T(e))throw new y("entity is required");if(!T(t))throw new y("scene is required");this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(c.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._isClosed=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new i,this._showProperty=void 0,this._materialProperty=void 0,this._hasConstantOutline=!0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._onTerrain=!1,this._options=new s(e),this._onEntityPropertyChanged(e,"rectangle",e.rectangle,void 0)}function d(e,t,r){this._primitives=e,this._groundPrimitives=t,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=r,this._options=new s(r._entity)}return e(c,{perInstanceColorAppearanceType:{value:D},materialAppearanceType:{value:P}}),e(c.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!T(this._entity.availability)&&R.isConstant(this._showProperty)&&R.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!T(this._entity.availability)&&R.isConstant(this._showProperty)&&R.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}}),c.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)},c.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)},c.prototype.createFillGeometryInstance=function(e){if(!T(e))throw new y("time is required.");if(!this._fillEnabled)throw new y("This instance does not represent a filled geometry.");var t,r=this._entity,i=r.isAvailable(e),n=new u(i&&r.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),a=l.fromDistanceDisplayCondition(o);if(this._materialProperty instanceof I){var s=_.WHITE;T(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(s=this._materialProperty.color.getValue(e)),t={show:n,distanceDisplayCondition:a,color:v.fromColor(s)}}else t={show:n,distanceDisplayCondition:a};return new b({id:r,geometry:new C(this._options),attributes:t})},c.prototype.createOutlineGeometryInstance=function(e){if(!T(e))throw new y("time is required.");if(!this._outlineEnabled)throw new y("This instance does not represent an outlined geometry.");var t=this._entity,r=t.isAvailable(e),i=R.getValueOrDefault(this._outlineColorProperty,e,_.BLACK),n=this._distanceDisplayConditionProperty.getValue(e);return new b({id:t,geometry:new w(this._options),attributes:{show:new u(r&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:v.fromColor(i),distanceDisplayCondition:l.fromDistanceDisplayCondition(n)}})},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){this._entitySubscription(),r(this)},c.prototype._onEntityPropertyChanged=function(e,t,r,i){if("availability"===t||"rectangle"===t){var n=this._entity.rectangle;if(T(n)){var o=n.fill,a=!T(o)||!o.isConstant||o.getValue(E.MINIMUM_VALUE),s=n.outline,l=T(s);if(l&&s.isConstant&&(l=s.getValue(E.MINIMUM_VALUE)),a||l){var u=n.coordinates,c=n.show;if(T(c)&&c.isConstant&&!c.getValue(E.MINIMUM_VALUE)||!T(u))(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this));else{var d=S(n.material,L),h=d instanceof I;this._materialProperty=d,this._fillProperty=S(o,k),this._showProperty=S(c,N),this._showOutlineProperty=S(n.outline,F),this._outlineColorProperty=l?S(n.outlineColor,B):void 0,this._shadowsProperty=S(n.shadows,U),this._distanceDisplayConditionProperty=S(n.distanceDisplayCondition,V);var p=n.height,f=n.extrudedHeight,m=n.granularity,g=n.stRotation,_=n.rotation,v=n.outlineWidth,y=n.closeBottom,b=n.closeTop,C=a&&!T(p)&&!T(f)&&h&&x.isSupported(this._scene);if(l&&C&&(A(A.geometryOutlines),l=!1),this._fillEnabled=a,this._onTerrain=C,this._outlineEnabled=l,u.isConstant&&R.isConstant(p)&&R.isConstant(f)&&R.isConstant(m)&&R.isConstant(g)&&R.isConstant(_)&&R.isConstant(v)&&R.isConstant(y)&&R.isConstant(b)&&(!C||R.isConstant(d))){var w=this._options;w.vertexFormat=h?D.VERTEX_FORMAT:P.MaterialSupport.TEXTURED.vertexFormat,w.rectangle=u.getValue(E.MINIMUM_VALUE,w.rectangle),w.height=T(p)?p.getValue(E.MINIMUM_VALUE):void 0,w.extrudedHeight=T(f)?f.getValue(E.MINIMUM_VALUE):void 0,w.granularity=T(m)?m.getValue(E.MINIMUM_VALUE):void 0,w.stRotation=T(g)?g.getValue(E.MINIMUM_VALUE):void 0,w.rotation=T(_)?_.getValue(E.MINIMUM_VALUE):void 0,w.closeBottom=T(y)?y.getValue(E.MINIMUM_VALUE):void 0,w.closeTop=T(b)?b.getValue(E.MINIMUM_VALUE):void 0,this._isClosed=T(f)&&T(w.closeTop)&&T(w.closeBottom)&&w.closeTop&&w.closeBottom,this._outlineWidth=T(v)?v.getValue(E.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}},c.prototype.createDynamicUpdater=function(e,t){if(!this._dynamic)throw new y("This instance does not represent dynamic geometry.");if(!T(e))throw new y("primitives is required.");return new d(e,t,this)},d.prototype.update=function(e){if(!T(e))throw new y("time is required.");var t=this._geometryUpdater,r=t._onTerrain,i=this._primitives,n=this._groundPrimitives;r?n.removeAndDestroy(this._primitive):(i.removeAndDestroy(this._primitive),i.removeAndDestroy(this._outlinePrimitive),this._outlinePrimitive=void 0),this._primitive=void 0;var o=t._entity,a=o.rectangle;if(o.isShowing&&o.isAvailable(e)&&R.getValueOrDefault(a.show,e,!0)){var s=this._options,l=R.getValueOrUndefined(a.coordinates,e,s.rectangle);if(T(l)){s.rectangle=l,s.height=R.getValueOrUndefined(a.height,e),s.extrudedHeight=R.getValueOrUndefined(a.extrudedHeight,e),s.granularity=R.getValueOrUndefined(a.granularity,e),s.stRotation=R.getValueOrUndefined(a.stRotation,e),s.rotation=R.getValueOrUndefined(a.rotation,e),s.closeBottom=R.getValueOrUndefined(a.closeBottom,e),s.closeTop=R.getValueOrUndefined(a.closeTop,e);var u=this._geometryUpdater.shadowsProperty.getValue(e);if(R.getValueOrDefault(a.fill,e,!0)){var c=t.fillMaterialProperty,d=M.getValue(e,c,this._material);if(this._material=d,r){var h=_.WHITE;T(c.color)&&(h=c.color.getValue(e)),this._primitive=n.add(new x({geometryInstances:new b({id:o,geometry:new C(s),attributes:{color:v.fromColor(h)}}),asynchronous:!1,shadows:u}))}else{var p=new P({material:d,translucent:d.isTranslucent(),closed:T(s.extrudedHeight)});s.vertexFormat=p.vertexFormat,this._primitive=i.add(new O({geometryInstances:new b({id:o,geometry:new C(s)}),appearance:p,asynchronous:!1,shadows:u}))}}if(!r&&R.getValueOrDefault(a.outline,e,!1)){s.vertexFormat=D.VERTEX_FORMAT;var f=R.getValueOrClonedDefault(a.outlineColor,e,_.BLACK,z),m=R.getValueOrDefault(a.outlineWidth,e,1),g=1!==f.alpha;this._outlinePrimitive=i.add(new O({geometryInstances:new b({id:o,geometry:new w(s),attributes:{color:v.fromColor(f)}}),appearance:new D({flat:!0,translucent:g,renderState:{lineWidth:t._scene.clampLineWidth(m)}}),asynchronous:!1,shadows:u}))}}}},d.prototype.getBoundingSphere=function(e,t){return a(e,this._primitive,this._outlinePrimitive,t)},d.prototype.isDestroyed=function(){return!1},d.prototype.destroy=function(){var e=this._primitives,t=this._groundPrimitives;this._geometryUpdater._onTerrain?t.removeAndDestroy(this._primitive):e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),r(this)},c}),define("DataSources/WallGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/ShowGeometryInstanceAttribute","../Core/WallGeometry","../Core/WallOutlineGeometry","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(p,f,v,y,e,t,m,r,l,i,g,b,u,_,C,w,S,T,n,E,o,a,A,x){"use strict";var P=new E(p.WHITE),D=new o(!0),O=new o(!0),I=new o(!1),M=new o(p.BLACK),R=new o(n.DISABLED),L=new o(new r),N=new p;function s(e){this.id=e,this.vertexFormat=void 0,this.positions=void 0,this.minimumHeights=void 0,this.maximumHeights=void 0,this.granularity=void 0}function c(e,t){if(!y(e))throw new m("entity is required");if(!y(t))throw new m("scene is required");this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(c.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new i,this._showProperty=void 0,this._materialProperty=void 0,this._hasConstantOutline=!0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._options=new s(e),this._onEntityPropertyChanged(e,"wall",e.wall,void 0)}function d(e,t){this._primitives=e,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=t,this._options=new s(t._entity)}return e(c,{perInstanceColorAppearanceType:{value:S},materialAppearanceType:{value:w}}),e(c.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!y(this._entity.availability)&&x.isConstant(this._showProperty)&&x.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!y(this._entity.availability)&&x.isConstant(this._showProperty)&&x.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return!1}},geometryChanged:{get:function(){return this._geometryChanged}}}),c.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)},c.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)},c.prototype.createFillGeometryInstance=function(e){if(!y(e))throw new m("time is required.");if(!this._fillEnabled)throw new m("This instance does not represent a filled geometry.");var t,r=this._entity,i=r.isAvailable(e),n=new u(i&&r.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),a=l.fromDistanceDisplayCondition(o);if(this._materialProperty instanceof E){var s=p.WHITE;y(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(s=this._materialProperty.color.getValue(e)),t={show:n,distanceDisplayCondition:a,color:f.fromColor(s)}}else t={show:n,distanceDisplayCondition:a};return new g({id:r,geometry:new _(this._options),attributes:t})},c.prototype.createOutlineGeometryInstance=function(e){if(!y(e))throw new m("time is required.");if(!this._outlineEnabled)throw new m("This instance does not represent an outlined geometry.");var t=this._entity,r=t.isAvailable(e),i=x.getValueOrDefault(this._outlineColorProperty,e,p.BLACK),n=this._distanceDisplayConditionProperty.getValue(e);return new g({id:t,geometry:new C(this._options),attributes:{show:new u(r&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:f.fromColor(i),distanceDisplayCondition:l.fromDistanceDisplayCondition(n)}})},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){this._entitySubscription(),t(this)},c.prototype._onEntityPropertyChanged=function(e,t,r,i){if("availability"===t||"wall"===t){var n=this._entity.wall;if(y(n)){var o=n.fill,a=!y(o)||!o.isConstant||o.getValue(b.MINIMUM_VALUE),s=n.outline,l=y(s);if(l&&s.isConstant&&(l=s.getValue(b.MINIMUM_VALUE)),a||l){var u=n.positions,c=n.show;if(y(c)&&c.isConstant&&!c.getValue(b.MINIMUM_VALUE)||!y(u))(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this));else{var d=v(n.material,P),h=d instanceof E;this._materialProperty=d,this._fillProperty=v(o,O),this._showProperty=v(c,D),this._showOutlineProperty=v(n.outline,I),this._outlineColorProperty=l?v(n.outlineColor,M):void 0,this._shadowsProperty=v(n.shadows,R),this._distanceDisplayConditionProperty=v(n.distanceDisplayCondition,L);var p=n.minimumHeights,f=n.maximumHeights,m=n.outlineWidth,g=n.granularity;if(this._fillEnabled=a,this._outlineEnabled=l,u.isConstant&&x.isConstant(p)&&x.isConstant(f)&&x.isConstant(m)&&x.isConstant(g)){var _=this._options;_.vertexFormat=h?S.VERTEX_FORMAT:w.MaterialSupport.TEXTURED.vertexFormat,_.positions=u.getValue(b.MINIMUM_VALUE,_.positions),_.minimumHeights=y(p)?p.getValue(b.MINIMUM_VALUE,_.minimumHeights):void 0,_.maximumHeights=y(f)?f.getValue(b.MINIMUM_VALUE,_.maximumHeights):void 0,_.granularity=y(g)?g.getValue(b.MINIMUM_VALUE):void 0,this._outlineWidth=y(m)?m.getValue(b.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}},c.prototype.createDynamicUpdater=function(e){if(!this._dynamic)throw new m("This instance does not represent dynamic geometry.");if(!y(e))throw new m("primitives is required.");return new d(e,this)},d.prototype.update=function(e){if(!y(e))throw new m("time is required.");var t=this._primitives;t.removeAndDestroy(this._primitive),t.removeAndDestroy(this._outlinePrimitive),this._primitive=void 0,this._outlinePrimitive=void 0;var r=this._geometryUpdater,i=r._entity,n=i.wall;if(i.isShowing&&i.isAvailable(e)&&x.getValueOrDefault(n.show,e,!0)){var o=this._options,a=x.getValueOrUndefined(n.positions,e,o.positions);if(y(a)){o.positions=a,o.minimumHeights=x.getValueOrUndefined(n.minimumHeights,e,o.minimumHeights),o.maximumHeights=x.getValueOrUndefined(n.maximumHeights,e,o.maximumHeights),o.granularity=x.getValueOrUndefined(n.granularity,e);var s=this._geometryUpdater.shadowsProperty.getValue(e);if(x.getValueOrDefault(n.fill,e,!0)){var l=A.getValue(e,r.fillMaterialProperty,this._material);this._material=l;var u=new w({material:l,translucent:l.isTranslucent(),closed:y(o.extrudedHeight)});o.vertexFormat=u.vertexFormat,this._primitive=t.add(new T({geometryInstances:new g({id:i,geometry:new _(o)}),appearance:u,asynchronous:!1,shadows:s}))}if(x.getValueOrDefault(n.outline,e,!1)){o.vertexFormat=S.VERTEX_FORMAT;var c=x.getValueOrClonedDefault(n.outlineColor,e,p.BLACK,N),d=x.getValueOrDefault(n.outlineWidth,e,1),h=1!==c.alpha;this._outlinePrimitive=t.add(new T({geometryInstances:new g({id:i,geometry:new C(o),attributes:{color:f.fromColor(c)}}),appearance:new S({flat:!0,translucent:h,renderState:{lineWidth:r._scene.clampLineWidth(d)}}),asynchronous:!1,shadows:s}))}}}},d.prototype.getBoundingSphere=function(e,t){return a(e,this._primitive,this._outlinePrimitive,t)},d.prototype.isDestroyed=function(){return!1},d.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),t(this)},c}),define("DataSources/DataSourceDisplay",["../Core/BoundingSphere","../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EventHelper","../Scene/GroundPrimitive","./BillboardVisualizer","./BoundingSphereState","./BoxGeometryUpdater","./CorridorGeometryUpdater","./CustomDataSource","./CylinderGeometryUpdater","./EllipseGeometryUpdater","./EllipsoidGeometryUpdater","./GeometryVisualizer","./LabelVisualizer","./ModelVisualizer","./PathVisualizer","./PlaneGeometryUpdater","./PointVisualizer","./PolygonGeometryUpdater","./PolylineGeometryUpdater","./PolylineVolumeGeometryUpdater","./RectangleGeometryUpdater","./WallGeometryUpdater"],function(m,a,s,g,e,i,_,l,u,n,v,o,c,d,h,p,f,y,b,C,w,S,T,E,A,x,P,D){"use strict";function O(e){a.typeOf.object("options",e),a.typeOf.object("options.scene",e.scene),a.typeOf.object("options.dataSourceCollection",e.dataSourceCollection),u.initializeTerrainHeights();var t=e.scene,r=e.dataSourceCollection;this._eventHelper=new l,this._eventHelper.add(r.dataSourceAdded,this._onDataSourceAdded,this),this._eventHelper.add(r.dataSourceRemoved,this._onDataSourceRemoved,this),this._dataSourceCollection=r,this._scene=t,this._visualizersCallback=s(e.visualizersCallback,O.defaultVisualizersCallback);for(var i=0,n=r.length;i<n;i++)this._onDataSourceAdded(r,r.get(i));var o=new d;this._onDataSourceAdded(void 0,o),this._defaultDataSource=o,this._ready=!1}O.defaultVisualizersCallback=function(e,t,r){var i=r.entities;return[new n(t,i),new y(o,e,i),new y(h,e,i),new y(c,e,i),new y(p,e,i),new y(f,e,i),new y(S,e,i),new y(E,e,i),new y(A,e,i),new y(x,e,i),new y(P,e,i),new y(D,e,i),new b(t,i),new C(e,i),new T(t,i),new w(e,i)]},e(O.prototype,{scene:{get:function(){return this._scene}},dataSources:{get:function(){return this._dataSourceCollection}},defaultDataSource:{get:function(){return this._defaultDataSource}},ready:{get:function(){return this._ready}}}),O.prototype.isDestroyed=function(){return!1},O.prototype.destroy=function(){this._eventHelper.removeAll();for(var e=this._dataSourceCollection,t=0,r=e.length;t<r;++t)this._onDataSourceRemoved(this._dataSourceCollection,e.get(t));return this._onDataSourceRemoved(void 0,this._defaultDataSource),i(this)},O.prototype.update=function(e){if(!g(e))throw new _("time is required.");if(!u._initialized)return this._ready=!1;var t,r,i,n,o=!0,a=this._dataSourceCollection,s=a.length;for(t=0;t<s;t++){var l=a.get(t);for(g(l.update)&&(o=l.update(e)&&o),n=(i=l._visualizers).length,r=0;r<n;r++)o=i[r].update(e)&&o}for(n=(i=this._defaultDataSource._visualizers).length,r=0;r<n;r++)o=i[r].update(e)&&o;return this._ready=o};var I=[],M=new m;return O.prototype.getBoundingSphere=function(e,t,r){if(!g(e))throw new _("entity is required.");if(!g(t))throw new _("allowPartial is required.");if(!g(r))throw new _("result is required.");if(!this._ready)return v.PENDING;var i,n,o=this._defaultDataSource;if(!o.entities.contains(e)){o=void 0;var a=this._dataSourceCollection;for(n=a.length,i=0;i<n;i++){var s=a.get(i);if(s.entities.contains(e)){o=s;break}}}if(!g(o))return v.FAILED;var l=I,u=M,c=0,d=v.DONE,h=o._visualizers,p=h.length;for(i=0;i<p;i++){var f=h[i];if(g(f.getBoundingSphere)){if(d=h[i].getBoundingSphere(e,u),!t&&d===v.PENDING)return v.PENDING;d===v.DONE&&(l[c]=m.clone(u,l[c]),c++)}}return 0===c?v.FAILED:(l.length=c,m.fromBoundingSpheres(l,r),v.DONE)},O.prototype._onDataSourceAdded=function(e,t){var r=this._scene,i=t.clustering;i._initialize(r),r.primitives.add(i),t._visualizers=this._visualizersCallback(r,i,t)},O.prototype._onDataSourceRemoved=function(e,t){var r=this._scene,i=t.clustering;r.primitives.remove(i);for(var n=t._visualizers,o=n.length,a=0;a<o;a++)n[a].destroy();t._visualizers=void 0},O}),define("DataSources/DynamicGeometryUpdater",["../Core/DeveloperError"],function(e){"use strict";function t(){e.throwInstantiationError()}return t.prototype.update=e.throwInstantiationError,t.prototype.getBoundingSphere=e.throwInstantiationError,t.prototype.isDestroyed=e.throwInstantiationError,t.prototype.destroy=e.throwInstantiationError,t}),define("DataSources/EntityView",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Ellipsoid","../Core/HeadingPitchRange","../Core/JulianDate","../Core/Math","../Core/Matrix3","../Core/Matrix4","../Core/Transforms","../Scene/SceneMode"],function(P,i,D,e,_,n,t,O,I,M,r,R,L){"use strict";var N=new M,k=new M,F=new M,B=new r,U=new P,V=new P,z=new P,q=new P,G=new P,W=new P,H=new O;function v(e,t,r){this.entity=e,this.scene=t,this.ellipsoid=i(r,n.WGS84),this.boundingSphere=void 0,this._lastEntity=void 0,this._mode=void 0,this._lastCartesian=new P,this._defaultOffset3D=void 0,this._offset3D=new P}e(v,{defaultOffset3D:{get:function(){return this._defaultOffset3D},set:function(e){this._defaultOffset3D=P.clone(e,new P)}}}),v.defaultOffset3D=new P(-14e3,3500,3500);var y=new t,b=new P;return v.prototype.update=function(e,t){var r=this.scene,i=this.entity,n=this.ellipsoid;if(!D(e))throw new _("time is required.");if(!D(r))throw new _("EntityView.scene is required.");if(!D(i))throw new _("EntityView.entity is required.");if(!D(n))throw new _("EntityView.ellipsoid is required.");if(!D(i.position))throw new _("entity.position is required.");var o=r.mode;if(o!==L.MORPHING){var a=i.position,s=i!==this._lastEntity,l=o!==this._mode,u=this._offset3D,c=r.camera,d=s||l,h=!0;if(s){var p=i.viewFrom,f=D(p);if(!f&&D(t)){y.pitch=-I.PI_OVER_FOUR,y.range=0;var m=a.getValue(e,b);if(D(m)){var g=2-1/Math.max(1,P.magnitude(m)/n.maximumRadius);y.pitch*=g}c.viewBoundingSphere(t,y),this.boundingSphere=t,h=d=!1}else f&&D(p.getValue(e,u))||P.clone(v._defaultOffset3D,u)}else l||r.mode===L.MORPHING||this._mode===L.SCENE2D||P.clone(c.position,u);this._lastEntity=i,this._mode=r.mode!==L.MORPHING?r.mode:this._mode,r.mode!==L.MORPHING&&function(e,t,r,i,n,o,a){var s=e.scene.mode,l=n.getValue(o,e._lastCartesian);if(D(l)){var u,c,d,h,p,f,m=!1,g=!1;if(s===L.SCENE3D){O.addSeconds(o,.001,H);var _=n.getValue(H,U);if(D(_)||(O.addSeconds(o,-.001,H),_=n.getValue(H,U),g=!0),D(_)){var v,y=R.computeFixedToIcrfMatrix(o,N),b=R.computeFixedToIcrfMatrix(H,k);D(y)&&D(b)?v=M.transpose(y,F):(v=R.computeTemeToPseudoFixedMatrix(o,F),y=M.transpose(v,N),b=R.computeTemeToPseudoFixedMatrix(H,k),M.transpose(b,b));var C=M.multiplyByVector(y,l,G),w=M.multiplyByVector(b,_,W);P.subtract(C,w,q);var S=1e3*P.magnitude(q),T=3986004418e5,E=-T/(S*S-2*T/P.magnitude(C));E<0||E>1.25*a.maximumRadius?(u=V,P.normalize(l,u),P.negate(u,u),d=P.clone(P.UNIT_Z,z),c=P.cross(d,u,U),P.magnitude(c)>I.EPSILON7&&(P.normalize(u,u),P.normalize(c,c),d=P.cross(u,c,z),P.normalize(d,d),m=!0)):P.equalsEpsilon(l,_,I.EPSILON7)||(d=V,P.normalize(C,d),P.normalize(w,w),c=P.cross(d,w,z),g&&(c=P.multiplyByScalar(c,-1,c)),P.equalsEpsilon(c,P.ZERO,I.EPSILON7)||(u=P.cross(c,d,U),M.multiplyByVector(v,u,u),M.multiplyByVector(v,c,c),M.multiplyByVector(v,d,d),P.normalize(u,u),P.normalize(c,c),P.normalize(d,d),m=!0))}}D(e.boundingSphere)&&(l=e.boundingSphere.center),i&&(h=P.clone(t.position,q),p=P.clone(t.direction,G),f=P.clone(t.up,W));var A=B;m?(A[0]=u.x,A[1]=u.y,A[2]=u.z,A[3]=0,A[4]=c.x,A[5]=c.y,A[6]=c.z,A[7]=0,A[8]=d.x,A[9]=d.y,A[10]=d.z,A[11]=0,A[12]=l.x,A[13]=l.y,A[14]=l.z,A[15]=0):R.eastNorthUpToFixedFrame(l,a,A),t._setTransform(A),i&&(P.clone(h,t.position),P.clone(p,t.direction),P.clone(f,t.up),P.cross(p,f,t.right))}if(r){var x=s===L.SCENE2D||P.equals(e._offset3D,P.ZERO)?void 0:e._offset3D;t.lookAtTransform(t.transform,x)}}(this,c,d,h,a,e,n)}},v}),function(){var e={version:"1.6.18",mesh:function(e){return o(e,t.apply(this,arguments))},meshArcs:t,merge:function(e){return o(e,r.apply(this,arguments))},mergeArcs:r,feature:function(t,e){return"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map(function(e){return i(t,e)})}:i(t,e)},neighbors:function(e){var i={},t=e.map(function(){return[]});function r(e,r){e.forEach(function(e){e<0&&(e=~e);var t=i[e];t?t.push(r):i[e]=[r]})}function n(e,t){e.forEach(function(e){r(e,t)})}var o={LineString:r,MultiLineString:n,Polygon:n,MultiPolygon:function(e,t){e.forEach(function(e){n(e,t)})}};for(var a in e.forEach(function t(e,r){"GeometryCollection"===e.type?e.geometries.forEach(function(e){t(e,r)}):e.type in o&&o[e.type](e.arcs,r)}),i)for(var s=i[a],l=s.length,u=0;u<l;++u)for(var c=u+1;c<l;++c){var d,h=s[u],p=s[c];(d=t[h])[a=f(d,p)]!==p&&d.splice(a,0,p),(d=t[p])[a=f(d,h)]!==h&&d.splice(a,0,h)}return t},presimplify:function(e,u){var c=m(e.transform),d=function(e){if(!e)return g;var n,o,a=e.scale[0],s=e.scale[1],l=e.translate[0],u=e.translate[1];return function(e,t){t||(n=o=0);var r=(e[0]-l)/a|0,i=(e[1]-u)/s|0;e[0]=r-n,e[1]=i-o,n=r,o=i}}(e.transform),h=function(){var e={},a=[],s=0;function i(e,t){for(;0<t;){var r=(t+1>>1)-1,i=a[r];if(0<=l(e,i))break;a[i._=t]=i,a[e._=t=r]=e}}function n(e,t){for(;;){var r=t+1<<1,i=r-1,n=t,o=a[n];if(i<s&&l(a[i],o)<0&&(o=a[n=i]),r<s&&l(a[r],o)<0&&(o=a[n=r]),n===t)break;a[o._=t]=o,a[e._=t=n]=e}}return e.push=function(e){return i(a[e._=s]=e,s++),s},e.pop=function(){if(!(s<=0)){var e,t=a[0];return 0<--s&&(e=a[s],n(a[e._=0]=e,0)),t}},e.remove=function(e){var t,r=e._;if(a[r]===e)return r!==--s&&(l(t=a[s],e)<0?i:n)(a[t._=r]=t,r),r},e}();u||(u=a);function p(e){h.remove(e),e[1][2]=u(e),h.push(e)}return e.arcs.forEach(function(e){for(var t,r,i=[],n=0,o=0,a=e.length;o<a;++o)r=e[o],c(e[o]=[r[0],r[1],1/0],o);for(o=1,a=e.length-1;o<a;++o)(t=e.slice(o-1,o+2))[1][2]=u(t),i.push(t),h.push(t);for(o=0,a=i.length;o<a;++o)(t=i[o]).previous=i[o-1],t.next=i[o+1];for(;t=h.pop();){var s=t.previous,l=t.next;t[1][2]<n?t[1][2]=n:n=t[1][2],s&&(s.next=l,s[2]=t[2],p(s)),l&&(l.previous=s,l[0]=t[0],p(l))}e.forEach(d)}),e}};function h(l,n){var o={},u={},c={},a=[],s=-1;function e(e,t){for(var r in e){var i=e[r];delete t[i.start],delete i.start,delete i.end,i.forEach(function(e){o[e<0?~e:e]=1}),a.push(i)}}return n.forEach(function(e,t){var r,i=l.arcs[e<0?~e:e];i.length<3&&!i[1][0]&&!i[1][1]&&(r=n[++s],n[s]=e,n[t]=r)}),n.forEach(function(e){var t,r,i=function(e){var t,r=l.arcs[e<0?~e:e],i=r[0];l.transform?(t=[0,0],r.forEach(function(e){t[0]+=e[0],t[1]+=e[1]})):t=r[r.length-1];return e<0?[t,i]:[i,t]}(e),n=i[0],o=i[1];if(t=c[n])if(delete c[t.end],t.push(e),t.end=o,r=u[o]){delete u[r.start];var a=r===t?t:t.concat(r);u[a.start=t.start]=c[a.end=r.end]=a}else u[t.start]=c[t.end]=t;else if(t=u[o])if(delete u[t.start],t.unshift(e),t.start=n,r=c[n]){delete c[r.end];var s=r===t?t:r.concat(t);u[s.start=r.start]=c[s.end=t.end]=s}else u[t.start]=c[t.end]=t;else u[(t=[e]).start=n]=c[t.end=o]=t}),e(c,u),e(u,c),n.forEach(function(e){o[e<0?~e:e]||a.push([e])}),a}function t(e,t,r){var i=[];if(1<arguments.length){var n,o=[];function a(e){var t=e<0?~e:e;(o[t]||(o[t]=[])).push({i:e,g:n})}function s(e){e.forEach(a)}function l(e){e.forEach(s)}var u={LineString:s,MultiLineString:l,Polygon:l,MultiPolygon:function(e){e.forEach(l)}};!function e(t){"GeometryCollection"===t.type?t.geometries.forEach(e):t.type in u&&u[(n=t).type](t.arcs)}(t),o.forEach(arguments.length<3?function(e){i.push(e[0].i)}:function(e){r(e[0].g,e[e.length-1].g)&&i.push(e[0].i)})}else for(var c=0,d=e.arcs.length;c<d;++c)i.push(c);return{type:"MultiLineString",arcs:h(e,i)}}function r(a,e){var s={},r=[],i=[];function t(t){t.forEach(function(e){e.forEach(function(e){(s[e=e<0?~e:e]||(s[e]=[])).push(t)})}),r.push(t)}function l(e){return 0<function(e){var t,r=-1,i=e.length,n=e[i-1],o=0;for(;++r<i;)t=n,n=e[r],o+=t[0]*n[1]-t[1]*n[0];return.5*o}(o(a,{type:"Polygon",arcs:[e]}).coordinates[0])}return e.forEach(function(e){"Polygon"===e.type?t(e.arcs):"MultiPolygon"===e.type&&e.arcs.forEach(t)}),r.forEach(function(e){if(!e._){var t=[],r=[e];for(e._=1,i.push(t);e=r.pop();)t.push(e),e.forEach(function(e){e.forEach(function(e){s[e<0?~e:e].forEach(function(e){e._||(e._=1,r.push(e))})})})}}),r.forEach(function(e){delete e._}),{type:"MultiPolygon",arcs:i.map(function(e){var t=[];if(e.forEach(function(e){e.forEach(function(e){e.forEach(function(e){s[e<0?~e:e].length<2&&t.push(e)})})}),t=h(a,t),1<(n=t.length))for(var r,i=l(e[0][0]),o=0;o<n;++o)if(i===l(t[o])){r=t[0],t[0]=t[o],t[o]=r;break}return t})}}function i(e,t){var r={type:"Feature",id:t.id,properties:t.properties||{},geometry:o(e,t)};return null==t.id&&delete r.id,r}function o(e,t){var a=m(e.transform),s=e.arcs;function n(e,t){t.length&&t.pop();for(var r,i=s[e<0?~e:e],n=0,o=i.length;n<o;++n)t.push(r=i[n].slice()),a(r,n);e<0&&function(e,t){var r,i=e.length,n=i-t;for(;n<--i;)r=e[n],e[n++]=e[i],e[i]=r}(t,o)}function r(e){return e=e.slice(),a(e,0),e}function i(e){for(var t=[],r=0,i=e.length;r<i;++r)n(e[r],t);return t.length<2&&t.push(t[0].slice()),t}function o(e){for(var t=i(e);t.length<4;)t.push(t[0].slice());return t}function l(e){return e.map(o)}var u={Point:function(e){return r(e.coordinates)},MultiPoint:function(e){return e.coordinates.map(r)},LineString:function(e){return i(e.arcs)},MultiLineString:function(e){return e.arcs.map(i)},Polygon:function(e){return l(e.arcs)},MultiPolygon:function(e){return e.arcs.map(l)}};return function e(t){var r=t.type;return"GeometryCollection"===r?{type:r,geometries:t.geometries.map(e)}:r in u?{type:r,coordinates:u[r](t)}:null}(t)}function f(e,t){for(var r=0,i=e.length;r<i;){var n=r+i>>>1;e[n]<t?r=n+1:i=n}return r}function a(e){var t=e[0],r=e[1],i=e[2];return Math.abs((t[0]-i[0])*(r[1]-t[1])-(t[0]-r[0])*(i[1]-t[1]))}function l(e,t){return e[1][2]-t[1][2]}function m(e){if(!e)return g;var r,i,n=e.scale[0],o=e.scale[1],a=e.translate[0],s=e.translate[1];return function(e,t){t||(r=i=0),e[0]=(r+=e[0])*n+a,e[1]=(i+=e[1])*o+s}}function g(){}"function"==typeof define&&define.amd?define("ThirdParty/topojson",e):"object"==typeof module&&module.exports?module.exports=e:this.topojson=e}(),define("DataSources/GeoJsonDataSource",["../Core/Cartesian3","../Core/Color","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/getFilenameFromUri","../Core/PinBuilder","../Core/PolygonHierarchy","../Core/Resource","../Core/RuntimeError","../Scene/HeightReference","../Scene/VerticalOrigin","../ThirdParty/topojson","../ThirdParty/when","./BillboardGraphics","./CallbackProperty","./ColorMaterialProperty","./ConstantPositionProperty","./ConstantProperty","./CorridorGraphics","./DataSource","./EntityCluster","./EntityCollection","./PolygonGraphics","./PolylineGraphics"],function(t,b,f,m,C,e,o,r,c,i,w,a,d,g,_,s,v,y,l,S,T,E,A,h,n,u,x,P){"use strict";function p(e){return t.fromDegrees(e[0],e[1],e[2])}var D,O={"urn:ogc:def:crs:OGC:1.3:CRS84":p,"EPSG:4326":p,"urn:ogc:def:crs:EPSG::4326":p},I={},M={},R=48,L=b.ROYALBLUE,N=b.YELLOW,k=2,F=b.fromBytes(255,255,0,100),B=!1,U={small:24,medium:48,large:64},V=["title","description","marker-size","marker-symbol","marker-color","stroke","stroke-opacity","stroke-width","fill","fill-opacity"];function z(e,t){var r="";for(var i in e)if(e.hasOwnProperty(i)){if(i===t||-1!==V.indexOf(i))continue;var n=e[i];C(n)&&(r+="object"==typeof n?"<tr><th>"+i+"</th><td>"+z(n)+"</td></tr>":"<tr><th>"+i+"</th><td>"+n+"</td></tr>")}return 0<r.length&&(r='<table class="cesium-infoBox-defaultTable"><tbody>'+r+"</tbody></table>"),r}function q(e,t){return new l((r=z,i=e,n=t,function(e,t){return C(o)||(o=r(i,n)),o}),!0);var r,i,n,o}function G(e,t,r){var i=e.id;if(C(i)&&"Feature"===e.type){for(var n=2,o=i;C(t.getById(o));)o=i+"_"+n,n++;i=o}else i=f();var a=t.getOrCreateEntity(i),s=e.properties;if(C(s)){var l,u=(a.properties=s).title;if(C(u))a.name=u,l="title";else{var c=Number.MAX_VALUE;for(var d in s)if(s.hasOwnProperty(d)&&s[d]){var h=d.toLowerCase();if(1<c&&"title"===h){c=1,l=d;break}2<c&&"name"===h?(c=2,l=d):3<c&&/title/i.test(d)?(c=3,l=d):4<c&&/name/i.test(d)&&(c=4,l=d)}C(l)&&(a.name=s[l])}var p=s.description;null!==p&&(a.description=C(p)?new E(p):r(s,l))}return a}function W(e,t){for(var r=new Array(e.length),i=0;i<e.length;i++)r[i]=t(e[i]);return r}var H={Feature:Y,FeatureCollection:function(e,t,r,i,n){for(var o=t.features,a=0,s=o.length;a<s;a++)Y(e,o[a],void 0,i,n)},GeometryCollection:X,LineString:$,MultiLineString:ee,MultiPoint:K,MultiPolygon:ie,Point:Z,Polygon:re,Topology:ne},j={GeometryCollection:X,LineString:$,MultiLineString:ee,MultiPoint:K,MultiPolygon:ie,Point:Z,Polygon:re,Topology:ne};function Y(e,t,r,i,n){if(null!==t.geometry){if(!C(t.geometry))throw new d("feature.geometry is required.");var o=t.geometry.type,a=j[o];if(!C(a))throw new d("Unknown geometry type: "+o);a(e,t,t.geometry,i,n)}else G(t,e._entityCollection,n.describe)}function X(e,t,r,i,n){for(var o=r.geometries,a=0,s=o.length;a<s;a++){var l=o[a],u=l.type,c=j[u];if(!C(c))throw new d("Unknown geometry type: "+u);c(e,t,l,i,n)}}function Q(e,t,r,i,n){var o,a=n.markerSymbol,s=n.markerColor,l=n.markerSize,u=t.properties;if(C(u)){var c=u["marker-color"];C(c)&&(s=b.fromCssColorString(c)),l=m(U[u["marker-size"]],l);var d=u["marker-symbol"];C(d)&&(a=d)}o=C(a)?1===a.length?e._pinBuilder.fromText(a.toUpperCase(),s,l):e._pinBuilder.fromMakiIconId(a,s,l):e._pinBuilder.fromColor(s,l);var h=new y;h.verticalOrigin=new E(_.BOTTOM),2===i.length&&n.clampToGround&&(h.heightReference=g.CLAMP_TO_GROUND);var p=G(t,e._entityCollection,n.describe);p.billboard=h,p.position=new T(r(i));var f=v(o).then(function(e){h.image=new E(e)}).otherwise(function(){h.image=new E(e._pinBuilder.fromColor(s,l))});e._promises.push(f)}function Z(e,t,r,i,n){Q(e,t,i,r.coordinates,n)}function K(e,t,r,i,n){for(var o=r.coordinates,a=0;a<o.length;a++)Q(e,t,i,o[a],n)}function J(e,t,r,i,n){var o=n.strokeMaterialProperty,a=n.strokeWidthProperty,s=t.properties;if(C(s)){var l,u=s["stroke-width"];C(u)&&(a=new E(u));var c=s.stroke;C(c)&&(l=b.fromCssColorString(c));var d=s["stroke-opacity"];C(d)&&1!==d&&(C(l)||(l=o.color.clone()),l.alpha=d),C(l)&&(o=new S(l))}var h,p=G(t,e._entityCollection,n.describe);n.clampToGround?(h=new A,p.corridor=h):(h=new P,p.polyline=h),h.material=o,h.width=a,h.positions=new E(W(i,r))}function $(e,t,r,i,n){J(e,t,i,r.coordinates,n)}function ee(e,t,r,i,n){for(var o=r.coordinates,a=0;a<o.length;a++)J(e,t,i,o[a],n)}function te(e,t,r,i,n){if(0!==i.length&&0!==i[0].length){var o=n.strokeMaterialProperty.color,a=n.fillMaterialProperty,s=n.strokeWidthProperty,l=t.properties;if(C(l)){var u,c=l["stroke-width"];C(c)&&(s=new E(c));var d=l.stroke;C(d)&&(u=b.fromCssColorString(d));var h,p=l["stroke-opacity"];C(p)&&1!==p&&(C(u)||(u=n.strokeMaterialProperty.color.clone()),u.alpha=p),C(u)&&(o=new E(u));var f=l.fill;C(f)&&((h=b.fromCssColorString(f)).alpha=a.color.alpha),p=l["fill-opacity"],C(p)&&p!==a.color.alpha&&(C(h)||(h=a.color.clone()),h.alpha=p),C(h)&&(a=new S(h))}var m=new x;m.outline=new E(!0),m.outlineColor=o,m.outlineWidth=s,m.material=a;for(var g=[],_=1,v=i.length;_<v;_++)g.push(new w(W(i[_],r)));var y=i[0];m.hierarchy=new E(new w(W(y,r),g)),2<y[0].length?m.perPositionHeight=new E(!0):n.clampToGround||(m.height=0),G(t,e._entityCollection,n.describe).polygon=m}}function re(e,t,r,i,n){te(e,t,i,r.coordinates,n)}function ie(e,t,r,i,n){for(var o=r.coordinates,a=0;a<o.length;a++)te(e,t,i,o[a],n)}function ne(e,t,r,i,n){for(var o in r.objects)if(r.objects.hasOwnProperty(o)){var a=s.feature(r,r.objects[o]);(0,H[a.type])(e,a,a,i,n)}}function oe(e){this._name=e,this._changed=new r,this._error=new r,this._isLoading=!1,this._loading=new r,this._entityCollection=new u(this),this._promises=[],this._pinBuilder=new i,this._entityCluster=new n}return oe.load=function(e,t){return(new oe).load(e,t)},e(oe,{markerSize:{get:function(){return R},set:function(e){R=e}},markerSymbol:{get:function(){return D},set:function(e){D=e}},markerColor:{get:function(){return L},set:function(e){L=e}},stroke:{get:function(){return N},set:function(e){N=e}},strokeWidth:{get:function(){return k},set:function(e){k=e}},fill:{get:function(){return F},set:function(e){F=e}},clampToGround:{get:function(){return B},set:function(e){B=e}},crsNames:{get:function(){return O}},crsLinkHrefs:{get:function(){return I}},crsLinkTypes:{get:function(){return M}}}),e(oe.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{value:void 0,writable:!1},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!C(e))throw new o("value must be defined.");this._entityCluster=e}}}),oe.prototype.load=function(e,t){if(!C(e))throw new o("data is required.");h.setLoading(this,!0);var r=e,i=(t=m(t,m.EMPTY_OBJECT)).sourceUri;("string"==typeof e||e instanceof a)&&(r=(e=a.createIfNeeded(e)).fetchJson(),i=m(i,e.getUrlComponent())),t={describe:m(t.describe,q),markerSize:m(t.markerSize,R),markerSymbol:m(t.markerSymbol,D),markerColor:m(t.markerColor,L),strokeWidthProperty:new E(m(t.strokeWidth,k)),strokeMaterialProperty:new S(m(t.stroke,N)),fillMaterialProperty:new S(m(t.fill,F)),clampToGround:m(t.clampToGround,B)};var n=this;return v(r,function(e){return function(t,r,i,e){var n;C(e)&&(n=c(e));C(n)&&t._name!==n&&(t._name=n,t._changed.raiseEvent(t));var o=H[r.type];if(!C(o))throw new d("Unsupported GeoJSON object type: "+r.type);var a=r.crs,s=null!==a?p:null;if(C(a)){if(!C(a.properties))throw new d("crs.properties is undefined.");var l=a.properties;if("name"===a.type){if(s=O[l.name],!C(s))throw new d("Unknown crs name: "+l.name)}else if("link"===a.type){var u=I[l.href];if(C(u)||(u=M[l.type]),!C(u))throw new d("Unable to resolve crs link: "+JSON.stringify(l));s=u(l)}else{if("EPSG"!==a.type)throw new d("Unknown crs type: "+a.type);if(s=O["EPSG:"+l.code],!C(s))throw new d("Unknown crs EPSG code: "+l.code)}}return v(s,function(e){return t._entityCollection.removeAll(),null!==e&&o(t,r,r,e,i),v.all(t._promises,function(){return t._promises.length=0,h.setLoading(t,!1),t})})}(n,e,t,i)}).otherwise(function(e){return h.setLoading(n,!1),n._error.raiseEvent(n,e),console.log(e),v.reject(e)})},oe}),define("DataSources/GeometryUpdater",["../Core/defineProperties","../Core/DeveloperError"],function(e,r){"use strict";function t(e,t){r.throwInstantiationError()}return e(t,{perInstanceColorAppearanceType:{get:r.throwInstantiationError},materialAppearanceType:{get:r.throwInstantiationError}}),e(t.prototype,{entity:{get:r.throwInstantiationError},fillEnabled:{get:r.throwInstantiationError},hasConstantFill:{get:r.throwInstantiationError},fillMaterialProperty:{get:r.throwInstantiationError},outlineEnabled:{get:r.throwInstantiationError},hasConstantOutline:{get:r.throwInstantiationError},outlineColorProperty:{get:r.throwInstantiationError},outlineWidth:{get:r.throwInstantiationError},isDynamic:{get:r.throwInstantiationError},isClosed:{get:r.throwInstantiationError},geometryChanged:{get:r.throwInstantiationError}}),t.prototype.isOutlineVisible=r.throwInstantiationError,t.prototype.isFilled=r.throwInstantiationError,t.prototype.createFillGeometryInstance=r.throwInstantiationError,t.prototype.createOutlineGeometryInstance=r.throwInstantiationError,t.prototype.isDestroyed=r.throwInstantiationError,t.prototype.destroy=r.throwInstantiationError,t.prototype.createDynamicUpdater=r.throwInstantiationError,t}),define("DataSources/KmlCamera",[],function(){"use strict";return function(e,t){this.position=e,this.headingPitchRoll=t}}),PVg=this,QVg=function(){var e,t,r,i,y=function(e){y.Util.assign(this,e);var t=this.hashtag;if(!1!==t&&"twitter"!==t&&"facebook"!==t)throw new Error("invalid `hashtag` cfg - see docs")};return y.prototype={constructor:y,urls:!0,email:!0,twitter:!0,phone:!0,hashtag:!1,newWindow:!0,stripPrefix:!0,truncate:void 0,className:"",htmlParser:void 0,matchParser:void 0,tagBuilder:void 0,link:function(e){for(var t=this.getHtmlParser().parse(e),r=0,i=[],n=0,o=t.length;n<o;n++){var a=t[n],s=a.getType(),l=a.getText();if("element"===s)"a"===a.getTagName()&&(a.isClosing()?r=Math.max(r-1,0):r++),i.push(l);else if("entity"===s||"comment"===s)i.push(l);else if(0===r){var u=this.linkifyStr(l);i.push(u)}else i.push(l)}return i.join("")},linkifyStr:function(e){return this.getMatchParser().replace(e,this.createMatchReturnVal,this)},createMatchReturnVal:function(e){var t;return this.replaceFn&&(t=this.replaceFn.call(this,this,e)),"string"==typeof t?t:!1===t?e.getMatchedText():t instanceof y.HtmlTag?t.toAnchorString():this.getTagBuilder().build(e).toAnchorString()},getHtmlParser:function(){var e=this.htmlParser;return e||(e=this.htmlParser=new y.htmlParser.HtmlParser),e},getMatchParser:function(){var e=this.matchParser;return e||(e=this.matchParser=new y.matchParser.MatchParser({urls:this.urls,email:this.email,twitter:this.twitter,phone:this.phone,hashtag:this.hashtag,stripPrefix:this.stripPrefix})),e},getTagBuilder:function(){var e=this.tagBuilder;return e||(e=this.tagBuilder=new y.AnchorTagBuilder({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),e}},y.link=function(e,t){return new y(t).link(e)},y.match={},y.htmlParser={},y.matchParser={},y.Util={abstractMethod:function(){throw"abstract"},trimRegex:/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,assign:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},extend:function(e,t){var r,i=e.prototype,n=function(){};n.prototype=i;var o=(r=t.hasOwnProperty("constructor")?t.constructor:function(){i.constructor.apply(this,arguments)}).prototype=new n;return o.constructor=r,o.superclass=i,delete t.constructor,y.Util.assign(o,t),r},ellipsis:function(e,t,r){return e.length>t&&(r=null==r?"..":r,e=e.substring(0,t-r.length)+r),e},indexOf:function(e,t){if(Array.prototype.indexOf)return e.indexOf(t);for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1},splitAndCapture:function(e,t){if(!t.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var r,i=[],n=0;r=t.exec(e);)i.push(e.substring(n,r.index)),i.push(r[0]),n=r.index+r[0].length;return i.push(e.substring(n)),i},trim:function(e){return e.replace(this.trimRegex,"")}},y.HtmlTag=y.Util.extend(Object,{whitespaceRegex:/\s+/,constructor:function(e){y.Util.assign(this,e),this.innerHtml=this.innerHtml||this.innerHTML},setTagName:function(e){return this.tagName=e,this},getTagName:function(){return this.tagName||""},setAttr:function(e,t){return this.getAttrs()[e]=t,this},getAttr:function(e){return this.getAttrs()[e]},setAttrs:function(e){var t=this.getAttrs();return y.Util.assign(t,e),this},getAttrs:function(){return this.attrs||(this.attrs={})},setClass:function(e){return this.setAttr("class",e)},addClass:function(e){for(var t,r=this.getClass(),i=this.whitespaceRegex,n=y.Util.indexOf,o=r?r.split(i):[],a=e.split(i);t=a.shift();)-1===n(o,t)&&o.push(t);return this.getAttrs().class=o.join(" "),this},removeClass:function(e){for(var t,r=this.getClass(),i=this.whitespaceRegex,n=y.Util.indexOf,o=r?r.split(i):[],a=e.split(i);o.length&&(t=a.shift());){var s=n(o,t);-1!==s&&o.splice(s,1)}return this.getAttrs().class=o.join(" "),this},getClass:function(){return this.getAttrs().class||""},hasClass:function(e){return-1!==(" "+this.getClass()+" ").indexOf(" "+e+" ")},setInnerHtml:function(e){return this.innerHtml=e,this},getInnerHtml:function(){return this.innerHtml||""},toAnchorString:function(){var e=this.getTagName(),t=this.buildAttrsStr();return["<",e,t=t?" "+t:"",">",this.getInnerHtml(),"</",e,">"].join("")},buildAttrsStr:function(){if(!this.attrs)return"";var e=this.getAttrs(),t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r+'="'+e[r]+'"');return t.join(" ")}}),y.AnchorTagBuilder=y.Util.extend(Object,{constructor:function(e){y.Util.assign(this,e)},build:function(e){return new y.HtmlTag({tagName:"a",attrs:this.createAttrs(e.getType(),e.getAnchorHref()),innerHtml:this.processAnchorText(e.getAnchorText())})},createAttrs:function(e,t){var r={href:t},i=this.createCssClass(e);return i&&(r.class=i),this.newWindow&&(r.target="_blank"),r},createCssClass:function(e){var t=this.className;return t?t+" "+t+"-"+e:""},processAnchorText:function(e){return e=this.doTruncate(e)},doTruncate:function(e){return y.Util.ellipsis(e,this.truncate||Number.POSITIVE_INFINITY)}}),y.htmlParser.HtmlParser=y.Util.extend(Object,{htmlRegex:(e=/(?:"[^"]*?"|'[^']*?'|[^'"=<>`\s]+)/,t=/[^\s\0"'>\/=\x01-\x1F\x7F]+/.source+"(?:\\s*=\\s*"+e.source+")?",new RegExp(["(?:","<(!DOCTYPE)","(?:","\\s+","(?:",t,"|",e.source+")",")*",">",")","|","(?:","<(/)?","(?:",/!--([\s\S]+?)--/.source,"|","(?:","("+/[0-9a-zA-Z][0-9a-zA-Z:]*/.source+")","(?:","\\s+",t,")*","\\s*/?",")",")",">",")"].join(""),"gi")),htmlCharacterEntitiesRegex:/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi,parse:function(e){for(var t,r,i=this.htmlRegex,n=0,o=[];null!==(t=i.exec(e));){var a=t[0],s=t[3],l=t[1]||t[4],u=!!t[2],c=e.substring(n,t.index);c&&(r=this.parseTextAndEntityNodes(c),o.push.apply(o,r)),s?o.push(this.createCommentNode(a,s)):o.push(this.createElementNode(a,l,u)),n=t.index+a.length}if(n<e.length){var d=e.substring(n);d&&(r=this.parseTextAndEntityNodes(d),o.push.apply(o,r))}return o},parseTextAndEntityNodes:function(e){for(var t=[],r=y.Util.splitAndCapture(e,this.htmlCharacterEntitiesRegex),i=0,n=r.length;i<n;i+=2){var o=r[i],a=r[i+1];o&&t.push(this.createTextNode(o)),a&&t.push(this.createEntityNode(a))}return t},createCommentNode:function(e,t){return new y.htmlParser.CommentNode({text:e,comment:y.Util.trim(t)})},createElementNode:function(e,t,r){return new y.htmlParser.ElementNode({text:e,tagName:t.toLowerCase(),closing:r})},createEntityNode:function(e){return new y.htmlParser.EntityNode({text:e})},createTextNode:function(e){return new y.htmlParser.TextNode({text:e})}}),y.htmlParser.HtmlNode=y.Util.extend(Object,{text:"",constructor:function(e){y.Util.assign(this,e)},getType:y.Util.abstractMethod,getText:function(){return this.text}}),y.htmlParser.CommentNode=y.Util.extend(y.htmlParser.HtmlNode,{comment:"",getType:function(){return"comment"},getComment:function(){return this.comment}}),y.htmlParser.ElementNode=y.Util.extend(y.htmlParser.HtmlNode,{tagName:"",closing:!1,getType:function(){return"element"},getTagName:function(){return this.tagName},isClosing:function(){return this.closing}}),y.htmlParser.EntityNode=y.Util.extend(y.htmlParser.HtmlNode,{getType:function(){return"entity"}}),y.htmlParser.TextNode=y.Util.extend(y.htmlParser.HtmlNode,{getType:function(){return"text"}}),y.matchParser.MatchParser=y.Util.extend(Object,{urls:!0,email:!0,twitter:!0,phone:!0,hashtag:!1,stripPrefix:!0,matcherRegex:(r=/[A-Za-z0-9\.\-]*[A-Za-z0-9\-]/,i=/\.(?:international|construction|contractors|enterprises|photography|productions|foundation|immobilien|industries|management|properties|technology|christmas|community|directory|education|equipment|institute|marketing|solutions|vacations|bargains|boutique|builders|catering|cleaning|clothing|computer|democrat|diamonds|graphics|holdings|lighting|partners|plumbing|supplies|training|ventures|academy|careers|company|cruises|domains|exposed|flights|florist|gallery|guitars|holiday|kitchen|neustar|okinawa|recipes|rentals|reviews|shiksha|singles|support|systems|agency|berlin|camera|center|coffee|condos|dating|estate|events|expert|futbol|kaufen|luxury|maison|monash|museum|nagoya|photos|repair|report|social|supply|tattoo|tienda|travel|viajes|villas|vision|voting|voyage|actor|build|cards|cheap|codes|dance|email|glass|house|mango|ninja|parts|photo|shoes|solar|today|tokyo|tools|watch|works|aero|arpa|asia|best|bike|blue|buzz|camp|club|cool|coop|farm|fish|gift|guru|info|jobs|kiwi|kred|land|limo|link|menu|mobi|moda|name|pics|pink|post|qpon|rich|ruhr|sexy|tips|vote|voto|wang|wien|wiki|zone|bar|bid|biz|cab|cat|ceo|com|edu|gov|int|kim|mil|net|onl|org|pro|pub|red|tel|uno|wed|xxx|xyz|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)\b/,new RegExp(["(",/(^|[^\w])@(\w{1,15})/.source,")","|","(",/(?:[\-;:&=\+\$,\w\.]+@)/.source,r.source,i.source,")","|","(","(?:","(",/(?:[A-Za-z][-.+A-Za-z0-9]+:(?![A-Za-z][-.+A-Za-z0-9]+:\/\/)(?!\d+\/?)(?:\/\/)?)/.source,r.source,")","|","(?:","(.?//)?",/(?:www\.)/.source,r.source,")","|","(?:","(.?//)?",r.source,i.source,")",")","(?:"+/[\-A-Za-z0-9+&@#\/%=~_()|'$*\[\]?!:,.;]*[\-A-Za-z0-9+&@#\/%=~_()|'$*\[\]]/.source+")?",")","|","(",/(?:\+?\d{1,3}[-\s.])?\(?\d{3}\)?[-\s.]?\d{3}[-\s.]\d{4}/.source,")","|","(",/(^|[^\w])#(\w{1,15})/.source,")"].join(""),"gi")),charBeforeProtocolRelMatchRegex:/^(.)?\/\//,constructor:function(e){y.Util.assign(this,e),this.matchValidator=new y.MatchValidator},replace:function(e,m,g){var _=this;return e.replace(this.matcherRegex,function(e,t,r,i,n,o,a,s,l,u,c,d,h){var p=_.processCandidateMatch(e,t,r,i,n,o,a,s,l,u,c,d,h);if(p){var f=m.call(g,p.match);return p.prefixStr+f+p.suffixStr}return e})},processCandidateMatch:function(e,t,r,i,n,o,a,s,l,u,c,d,h){var p,f=s||l,m="",g="";if(o&&!this.urls||n&&!this.email||u&&!this.phone||t&&!this.twitter||c&&!this.hashtag||!this.matchValidator.isValidMatch(o,a,f))return null;if(this.matchHasUnbalancedClosingParen(e)&&(e=e.substr(0,e.length-1),g=")"),n)p=new y.match.Email({matchedText:e,email:n});else if(t)r&&(m=r,e=e.slice(1)),p=new y.match.Twitter({matchedText:e,twitterHandle:i});else if(u){var _=e.replace(/\D/g,"");p=new y.match.Phone({matchedText:e,number:_})}else if(c)d&&(m=d,e=e.slice(1)),p=new y.match.Hashtag({matchedText:e,serviceName:this.hashtag,hashtag:h});else{if(f){var v=f.match(this.charBeforeProtocolRelMatchRegex)[1]||"";v&&(m=v,e=e.slice(1))}p=new y.match.Url({matchedText:e,url:e,protocolUrlMatch:!!a,protocolRelativeMatch:!!f,stripPrefix:this.stripPrefix})}return{prefixStr:m,suffixStr:g,match:p}},matchHasUnbalancedClosingParen:function(e){if(")"===e.charAt(e.length-1)){var t=e.match(/\(/g),r=e.match(/\)/g);if((t&&t.length||0)<(r&&r.length||0))return!0}return!1}}),y.MatchValidator=y.Util.extend(Object,{invalidProtocolRelMatchRegex:/^[\w]\/\//,hasFullProtocolRegex:/^[A-Za-z][-.+A-Za-z0-9]+:\/\//,uriSchemeRegex:/^[A-Za-z][-.+A-Za-z0-9]+:/,hasWordCharAfterProtocolRegex:/:[^\s]*?[A-Za-z]/,isValidMatch:function(e,t,r){return!(t&&!this.isValidUriScheme(t)||this.urlMatchDoesNotHaveProtocolOrDot(e,t)||this.urlMatchDoesNotHaveAtLeastOneWordChar(e,t)||this.isInvalidProtocolRelativeMatch(r))},isValidUriScheme:function(e){var t=e.match(this.uriSchemeRegex)[0].toLowerCase();return"javascript:"!==t&&"vbscript:"!==t},urlMatchDoesNotHaveProtocolOrDot:function(e,t){return!(!e||t&&this.hasFullProtocolRegex.test(t)||-1!==e.indexOf("."))},urlMatchDoesNotHaveAtLeastOneWordChar:function(e,t){return!(!e||!t)&&!this.hasWordCharAfterProtocolRegex.test(e)},isInvalidProtocolRelativeMatch:function(e){return!!e&&this.invalidProtocolRelMatchRegex.test(e)}}),y.match.Match=y.Util.extend(Object,{constructor:function(e){y.Util.assign(this,e)},getType:y.Util.abstractMethod,getMatchedText:function(){return this.matchedText},getAnchorHref:y.Util.abstractMethod,getAnchorText:y.Util.abstractMethod}),y.match.Email=y.Util.extend(y.match.Match,{getType:function(){return"email"},getEmail:function(){return this.email},getAnchorHref:function(){return"mailto:"+this.email},getAnchorText:function(){return this.email}}),y.match.Hashtag=y.Util.extend(y.match.Match,{getType:function(){return"hashtag"},getHashtag:function(){return this.hashtag},getAnchorHref:function(){var e=this.serviceName,t=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+t;case"facebook":return"https://www.facebook.com/hashtag/"+t;default:throw new Error("Unknown service name to point hashtag to: ",e)}},getAnchorText:function(){return"#"+this.hashtag}}),y.match.Phone=y.Util.extend(y.match.Match,{getType:function(){return"phone"},getNumber:function(){return this.number},getAnchorHref:function(){return"tel:"+this.number},getAnchorText:function(){return this.matchedText}}),y.match.Twitter=y.Util.extend(y.match.Match,{getType:function(){return"twitter"},getTwitterHandle:function(){return this.twitterHandle},getAnchorHref:function(){return"https://twitter.com/"+this.twitterHandle},getAnchorText:function(){return"@"+this.twitterHandle}}),y.match.Url=y.Util.extend(y.match.Match,{urlPrefixRegex:/^(https?:\/\/)?(www\.)?/i,protocolRelativeRegex:/^\/\//,protocolPrepended:!1,getType:function(){return"url"},getUrl:function(){var e=this.url;return this.protocolRelativeMatch||this.protocolUrlMatch||this.protocolPrepended||(e=this.url="http://"+e,this.protocolPrepended=!0),e},getAnchorHref:function(){return this.getUrl().replace(/&amp;/g,"&")},getAnchorText:function(){var e=this.getUrl();return this.protocolRelativeMatch&&(e=this.stripProtocolRelativePrefix(e)),this.stripPrefix&&(e=this.stripUrlPrefix(e)),e=this.removeTrailingSlash(e)},stripUrlPrefix:function(e){return e.replace(this.urlPrefixRegex,"")},stripProtocolRelativePrefix:function(e){return e.replace(this.protocolRelativeRegex,"")},removeTrailingSlash:function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e}}),y},"function"==typeof define&&define.amd?define("ThirdParty/Autolinker",[],function(){return PVg.Autolinker=QVg()}):"object"==typeof exports?module.exports=QVg():PVg.Autolinker=QVg(),define("ThirdParty/zip",["../Core/buildModuleUrl","../Core/defineProperties"],function(L,N){var e={};return function(C){var o,e,m="File format is not recognized.",a="File contains encrypted entry.",s="File is using Zip64 (4gb+ file size).",d="Error while reading zip file.",t="Error while reading file data.",g=524288,_="inflate.js",w="deflate.js",l="text/plain",S="message";try{o=0===new Blob([new DataView(new ArrayBuffer(0))]).size}catch(e){}function T(){var i=-1,n=this;n.append=function(e){var t,r=n.table;for(t=0;t<e.length;t++)i=i>>>8^r[255&(i^e[t])]},n.get=function(){return~i}}function E(e,t){var r,i;return r=new ArrayBuffer(e),i=new Uint8Array(r),t&&i.set(t,0),{buffer:r,array:i,view:new DataView(r)}}function r(){}function i(i){var n,o=this;o.size=0,o.init=function(e,t){var r=new Blob([i],{type:l});(n=new u(r)).init(function(){o.size=n.size,e()},t)},o.readUint8Array=function(e,t,r,i){n.readUint8Array(e,t,r,i)}}function n(u){var c,r=this;r.size=0,r.init=function(e){for(var t=u.length;"="==u.charAt(t-1);)t--;c=u.indexOf(",")+1,r.size=Math.floor(.75*(t-c)),e()},r.readUint8Array=function(e,t,r){var i,n=E(t),o=4*Math.floor(e/3),a=4*Math.ceil((e+t)/3),s=window.atob(u.substring(o+c,a+c)),l=e-3*Math.floor(o/4);for(i=l;i<l+t;i++)n.array[i-l]=s.charCodeAt(i);r(n.array)}}function u(l){this.size=0,this.init=function(e){this.size=l.size,e()},this.readUint8Array=function(e,t,r,i){var n,o,a,s=new FileReader;s.onload=function(e){r(new Uint8Array(e.target.result))},s.onerror=i,s.readAsArrayBuffer((o=e,a=t,(n=l).slice?n.slice(o,o+a):n.webkitSlice?n.webkitSlice(o,o+a):n.mozSlice?n.mozSlice(o,o+a):n.msSlice?n.msSlice(o,o+a):void 0))}}function c(){}function h(i){var n;this.init=function(e){n=new Blob([],{type:l}),e()},this.writeUint8Array=function(e,t){n=new Blob([n,o?e:e.buffer],{type:l}),t()},this.getData=function(t,e){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=e,r.readAsText(n,i)}}function p(t){var o="",a="";this.init=function(e){o+="data:"+(t||"")+";base64,",e()},this.writeUint8Array=function(e,t){var r,i=a.length,n=a;for(a="",r=0;r<3*Math.floor((i+e.length)/3)-i;r++)n+=String.fromCharCode(e[r]);for(;r<e.length;r++)a+=String.fromCharCode(e[r]);2<n.length?o+=window.btoa(n):a=n,t()},this.getData=function(e){e(o+window.btoa(a))}}function f(r){var i;this.init=function(e){i=new Blob([],{type:r}),e()},this.writeUint8Array=function(e,t){i=new Blob([i,o?e:e.buffer],{type:r}),t()},this.getData=function(e){e(i)}}function A(t,e,i,r,n,o,a,s,l,u){var c,d,h=0;function p(){t.removeEventListener(S,f,!1),s(d)}function f(e){var t=e.data,r=t.data;t.onappend&&(d+=r.length,i.writeUint8Array(r,function(){o(!1,r),m()},u)),t.onflush&&(r?(d+=r.length,i.writeUint8Array(r,function(){o(!1,r),p()},u)):p()),t.progress&&a&&a(c+t.current,n)}function m(){(c=h*g)<n?e.readUint8Array(r+c,Math.min(g,n-c),function(e){t.postMessage({append:!0,data:e}),h++,a&&a(c,n),o(!0,e)},l):t.postMessage({flush:!0})}d=0,t.addEventListener(S,f,!1),m()}function x(i,t,n,o,a,s,l,u,c,d){var h,p=0,f=0;!function r(){var e;(h=p*g)<a?t.readUint8Array(o+h,Math.min(g,a-h),function(e){var t=i.append(e,function(){l&&l(o+h,a)});f+=t.length,s(!0,e),n.writeUint8Array(t,function(){s(!1,t),p++,setTimeout(r,1)},d),l&&l(h,a)},c):(e=i.flush())?(f+=e.length,n.writeUint8Array(e,function(){s(!1,e),u(f)},d)):u(f)}()}function P(e,i,n,o,a,s,l,u,c){var d=0,h=new T;!function t(){var r=d*g;r<o?e.readUint8Array(n+r,Math.min(g,o-r),function(e){a&&h.append(e),l&&l(r,o,e),i.writeUint8Array(e,function(){d++,t()},c)},u):s(o,h.get())}()}function v(e){var t,r,i="",n=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","_","_","_","","","","","","","","","+","+","","","+","+","-","-","+","-","+","","","+","+","-","-","","-","+","","","","","","","i","","","","+","+","_","_","","","_","","","","","","","","","","","","","","","","","","","_","","","","","","","","","","","","_"," "];for(t=0;t<e.length;t++)i+=127<(r=255&e.charCodeAt(t))?n[r-128]:String.fromCharCode(r);return i}function y(e){return decodeURIComponent(escape(e))}function b(e){var t,r="";for(t=0;t<e.length;t++)r+=String.fromCharCode(e[t]);return r}function D(e,t,r,i,n){e.version=t.view.getUint16(r,!0),e.bitFlag=t.view.getUint16(r+2,!0),e.compressionMethod=t.view.getUint16(r+4,!0),e.lastModDateRaw=t.view.getUint32(r+6,!0),e.lastModDate=function(e){var t=(4294901760&e)>>16,r=65535&e;try{return new Date(1980+((65024&t)>>9),((480&t)>>5)-1,31&t,(63488&r)>>11,(2016&r)>>5,2*(31&r),0)}catch(e){}}(e.lastModDateRaw),1!=(1&e.bitFlag)?((i||8!=(8&e.bitFlag))&&(e.crc32=t.view.getUint32(r+10,!0),e.compressedSize=t.view.getUint32(r+14,!0),e.uncompressedSize=t.view.getUint32(r+18,!0)),4294967295!==e.compressedSize&&4294967295!==e.uncompressedSize?(e.filenameLength=t.view.getUint16(r+22,!0),e.extraFieldLength=t.view.getUint16(r+24,!0)):n(s)):n(a)}function O(p,f){function c(){}return c.prototype.getData=function(n,o,i,a){var s,l=this;function u(e,t){s&&s.terminate(),s=null,e&&e(t)}function c(e,t){var r,i;a&&(r=t,(i=E(4)).view.setUint32(0,r),l.crc32!=i.view.getUint32(0))?d():n.getData(function(e){u(o,e)})}function d(){u(f,t)}function h(){u(f,"Error while writing file data.")}p.readUint8Array(l.offset,30,function(e){var t,r=E(e.length,e);1347093252==r.view.getUint32(0)?(D(l,r,4,!1,f),t=l.offset+30+l.filenameLength+l.extraFieldLength,n.init(function(){0===l.compressionMethod?P(p,n,t,l.compressedSize,a,c,i,d,h):s=function(e,t,r,i,n,o,a,s,l){var u,c=new T;function d(e,t){n&&!e&&c.append(t)}function h(e){o(e,c.get())}return C.zip.useWebWorkers?A(u=new Worker(C.zip.workerScriptsPath+_),e,t,r,i,d,a,h,s,l):x(new C.zip.Inflater,e,t,r,i,d,a,h,s,l),u}(p,n,t,l.compressedSize,a,c,i,d,h)},h)):f(m)},d)},{getEntries:function(u){p.size<22?f(m):function r(i,n){p.readUint8Array(p.size-i,i,function(e){var t=E(e.length,e).view;1347093766!=t.getUint32(0)?r(i+1,n):n(t)},function(){f(d)})}(22,function(e){var t,l;t=e.getUint32(16,!0),l=e.getUint16(8,!0),p.readUint8Array(t,p.size-t,function(e){var t,r,i,n,o=0,a=[],s=E(e.length,e);for(t=0;t<l;t++){if(r=new c,1347092738!=s.view.getUint32(o))return void f(m);D(r,s,o+6,!0,f),r.commentLength=s.view.getUint16(o+32,!0),r.directory=16==(16&s.view.getUint8(o+38)),r.offset=s.view.getUint32(o+42,!0),i=b(s.array.subarray(o+46,o+46+r.filenameLength)),r.filename=2048==(2048&r.bitFlag)?y(i):v(i),r.directory||"/"!=r.filename.charAt(r.filename.length-1)||(r.directory=!0),n=b(s.array.subarray(o+46+r.filenameLength+r.extraFieldLength,o+46+r.filenameLength+r.extraFieldLength+r.commentLength)),r.comment=2048==(2048&r.bitFlag)?y(n):v(n),a.push(r),o+=46+r.filenameLength+r.extraFieldLength+r.commentLength}u(a)},function(){f(d)})})},close:function(e){e&&e()}}}function I(e){return unescape(encodeURIComponent(e))}function M(e){var t,r=[];for(t=0;t<e.length;t++)r.push(e.charCodeAt(t));return r}function R(d,h,p){var f,m={},g=[],_=0;function v(e,t){f&&f.terminate(),f=null,e&&e(t)}function y(){v(h,"Error while writing zip file.")}function b(){v(h,t)}return{add:function(r,i,n,o,a){var s,l,u;function c(e,t){var r=E(16);_+=e||0,r.view.setUint32(0,1347094280),void 0!==t&&(s.view.setUint32(10,t,!0),r.view.setUint32(4,t,!0)),i&&(r.view.setUint32(8,e,!0),s.view.setUint32(14,e,!0),r.view.setUint32(12,i.size,!0),s.view.setUint32(18,i.size,!0)),d.writeUint8Array(r.array,function(){_+=16,v(n)},y)}function e(){var e,t;(a=a||{},r=r.trim(),a.directory&&"/"!=r.charAt(r.length-1)&&(r+="/"),m.hasOwnProperty(r))?h("File already exists."):(l=M(I(r)),g.push(r),e=function(){i?p||0===a.level?P(i,d,0,i.size,!0,c,o,b,y):f=function(t,r,e,i,n,o,a){var s,l=new T;function u(e,t){e&&l.append(t)}function c(e){i(e,l.get())}return C.zip.useWebWorkers?((s=new Worker(C.zip.workerScriptsPath+w)).addEventListener(S,function e(){s.removeEventListener(S,e,!1),A(s,t,r,0,t.size,u,n,c,o,a)},!1),s.postMessage({init:!0,level:e})):x(new C.zip.Deflater,t,r,0,t.size,u,n,c,o,a),s}(i,d,a.level,c,o,b,y):c()},u=a.lastModDate||new Date,s=E(26),m[r]={headerArray:s.array,directory:a.directory,filename:l,offset:_,comment:M(I(a.comment||""))},s.view.setUint32(0,335546376),a.version&&s.view.setUint8(0,a.version),p||0===a.level||a.directory||s.view.setUint16(4,2048),s.view.setUint16(6,(u.getHours()<<6|u.getMinutes())<<5|u.getSeconds()/2,!0),s.view.setUint16(8,(u.getFullYear()-1980<<4|u.getMonth()+1)<<5|u.getDate(),!0),s.view.setUint16(22,l.length,!0),(t=E(30+l.length)).view.setUint32(0,1347093252),t.array.set(s.array,4),t.array.set(l,30),_+=t.array.length,d.writeUint8Array(t.array,e,y))}i?i.init(e,b):e()},close:function(e){var t,r,i,n=0,o=0;for(r=0;r<g.length;r++)n+=46+(i=m[g[r]]).filename.length+i.comment.length;for(t=E(n+22),r=0;r<g.length;r++)i=m[g[r]],t.view.setUint32(o,1347092738),t.view.setUint16(o+4,5120),t.array.set(i.headerArray,o+6),t.view.setUint16(o+32,i.comment.length,!0),i.directory&&t.view.setUint8(o+38,16),t.view.setUint32(o+42,i.offset,!0),t.array.set(i.filename,o+46),t.array.set(i.comment,o+46+i.filename.length),o+=46+i.filename.length+i.comment.length;t.view.setUint32(o,1347093766),t.view.setUint16(o+8,g.length,!0),t.view.setUint16(o+10,g.length,!0),t.view.setUint32(o+12,n,!0),t.view.setUint32(o+16,_,!0),d.writeUint8Array(t.array,function(){v(function(){d.getData(e)})},y)}}}T.prototype.table=function(){var e,t,r,i=[];for(e=0;e<256;e++){for(r=e,t=0;t<8;t++)1&r?r=r>>>1^3988292384:r>>>=1;i[e]=r}return i}(),(i.prototype=new r).constructor=i,(n.prototype=new r).constructor=n,(u.prototype=new r).constructor=u,c.prototype.getData=function(e){e(this.data)},(h.prototype=new c).constructor=h,(p.prototype=new c).constructor=p,(f.prototype=new c).constructor=f,C.zip={Reader:r,Writer:c,BlobReader:u,Data64URIReader:n,TextReader:i,BlobWriter:f,Data64URIWriter:p,TextWriter:h,createReader:function(e,t,r){e.init(function(){t(O(e,r))},r)},createWriter:function(e,t,r,i){e.init(function(){t(R(e,r,i))},r)},useWebWorkers:!0},N(C.zip,{workerScriptsPath:{get:function(){return void 0===e&&(e=L("ThirdParty/Workers/")),e}}})}(e),e.zip}),define("DataSources/KmlLookAt",[],function(){"use strict";return function(e,t){this.position=e,this.headingPitchRange=t}}),define("DataSources/KmlTour",["../Core/Event","../Core/defined"],function(r,a){"use strict";function e(e,t){this.id=t,this.name=e,this.playlistIndex=0,this.playlist=[],this.tourStart=new r,this.tourEnd=new r,this.entryStart=new r,this.entryEnd=new r,this._activeEntries=[]}function i(e){for(var t=e.pop();void 0!==t;t=e.pop())t.stop()}function s(e,t,r){var i=this.playlist[this.playlistIndex];if(i){var n=function(e,t,r,i){var n=this.playlist[this.playlistIndex];if(this.entryEnd.raiseEvent(n,i),i)r(i);else{var o=this._activeEntries.indexOf(n);0<=o&&this._activeEntries.splice(o,1),this.playlistIndex++,s.call(this,e,t,r)}}.bind(this,e,t,r);if(this._activeEntries.push(i),this.entryStart.raiseEvent(i),i.blocking)i.play(n,e.scene.camera,t);else{var o=this;i.play(function(){o.entryEnd.raiseEvent(i);var e=o._activeEntries.indexOf(i);0<=e&&o._activeEntries.splice(e,1)}),n(e,t,r)}}else a(r)&&r(!1)}return e.prototype.addPlaylistEntry=function(e){this.playlist.push(e)},e.prototype.play=function(e,t){this.tourStart.raiseEvent();var r=this;s.call(this,e,t,function(e){r.playlistIndex=0,e||i(r._activeEntries),r.tourEnd.raiseEvent(e)})},e.prototype.stop=function(){i(this._activeEntries)},e}),define("DataSources/KmlTourFlyTo",["../Core/defined","../Core/combine","../Core/BoundingSphere","../Core/EasingFunction"],function(a,r,s,i){"use strict";function e(e,t,r){this.type="KmlTourFlyTo",this.blocking=!0,this.activeCamera=null,this.activeCallback=null,this.duration=e,this.view=r,this.flyToMode=t}return e.prototype.play=function(t,e,r){if(this.activeCamera=e,a(t)&&null!==t){var i=this;this.activeCallback=function(e){delete i.activeCallback,delete i.activeCamera,t(!a(e)&&e)}}var n=this.getCameraOptions(r);if(this.view.headingPitchRoll)e.flyTo(n);else if(this.view.headingPitchRange){var o=new s(this.view.position);e.flyToBoundingSphere(o,n)}},e.prototype.stop=function(){a(this.activeCamera)&&this.activeCamera.cancelFlight(),a(this.activeCallback)&&this.activeCallback(!0)},e.prototype.getCameraOptions=function(e){var t={duration:this.duration};return a(this.activeCallback)&&(t.complete=this.activeCallback),"smooth"===this.flyToMode&&(t.easingFunction=i.LINEAR_NONE),this.view.headingPitchRoll?(t.destination=this.view.position,t.orientation=this.view.headingPitchRoll):this.view.headingPitchRange&&(t.offset=this.view.headingPitchRange),a(e)&&(t=r(t,e)),t},e}),define("DataSources/KmlTourWait",["../Core/defined"],function(e){"use strict";function t(e){this.type="KmlTourWait",this.blocking=!0,this.duration=e,this.timeout=null}return t.prototype.play=function(e){var t=this;this.activeCallback=e,this.timeout=setTimeout(function(){delete t.activeCallback,e(!1)},1e3*this.duration)},t.prototype.stop=function(){clearTimeout(this.timeout),e(this.activeCallback)&&this.activeCallback(!0)},t}),define("DataSources/KmlDataSource",["../Core/AssociativeArray","../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/ClockRange","../Core/ClockStep","../Core/Color","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/DeveloperError","../Core/Ellipsoid","../Core/Event","../Core/getExtensionFromUri","../Core/getFilenameFromUri","../Core/Iso8601","../Core/JulianDate","../Core/Math","../Core/NearFarScalar","../Core/objectToQuery","../Core/oneTimeWarning","../Core/PinBuilder","../Core/PolygonHierarchy","../Core/queryToObject","../Core/Rectangle","../Core/Resource","../Core/RuntimeError","../Core/TimeInterval","../Core/TimeIntervalCollection","../Core/HeadingPitchRoll","../Core/HeadingPitchRange","../Scene/HeightReference","../Scene/HorizontalOrigin","../Scene/LabelStyle","../Scene/SceneMode","../ThirdParty/Autolinker","../ThirdParty/Uri","../ThirdParty/when","../ThirdParty/zip","./BillboardGraphics","./CompositePositionProperty","./CorridorGraphics","./DataSource","./DataSourceClock","./Entity","./EntityCluster","./EntityCollection","./LabelGraphics","./PathGraphics","./PolygonGraphics","./PolylineGraphics","./PositionPropertyArray","./RectangleGraphics","./ReferenceProperty","./SampledPositionProperty","./ScaledPositionProperty","./TimeIntervalCollectionProperty","./WallGraphics","./KmlLookAt","./KmlCamera","./KmlTour","./KmlTourFlyTo","./KmlTourWait"],function(i,w,S,T,e,c,d,E,A,P,D,t,n,o,b,a,r,s,O,I,x,l,C,M,u,R,L,N,h,m,y,k,p,f,g,_,v,F,B,U,V,z,q,G,W,H,j,Y,X,Q,Z,K,J,$,ee,te,re,ie,ne,oe,ae,se,le,ue,ce,de){"use strict";if("undefined"==typeof DOMParser)return{};var he={avi:"video/x-msvideo",bmp:"image/bmp",bz2:"application/x-bzip2",chm:"application/vnd.ms-htmlhelp",css:"text/css",csv:"text/csv",doc:"application/msword",dvi:"application/x-dvi",eps:"application/postscript",flv:"video/x-flv",gif:"image/gif",gz:"application/x-gzip",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",jnlp:"application/x-java-jnlp-file",jpeg:"image/jpeg",jpg:"image/jpeg",m3u:"audio/x-mpegurl",m4v:"video/mp4",mathml:"application/mathml+xml",mid:"audio/midi",midi:"audio/midi",mov:"video/quicktime",mp3:"audio/mpeg",mp4:"video/mp4",mp4v:"video/mp4",mpeg:"video/mpeg",mpg:"video/mpeg",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",ogg:"application/ogg",pdf:"application/pdf",png:"image/png",pps:"application/vnd.ms-powerpoint",ppt:"application/vnd.ms-powerpoint",ps:"application/postscript",qt:"video/quicktime",rdf:"application/rdf+xml",rss:"application/rss+xml",rtf:"application/rtf",svg:"image/svg+xml",swf:"application/x-shockwave-flash",text:"text/plain",tif:"image/tiff",tiff:"image/tiff",txt:"text/plain",wav:"audio/x-wav",wma:"audio/x-ms-wma",wmv:"video/x-ms-wmv",xml:"application/xml",zip:"application/zip",detectFromFilename:function(e){var t=e.toLowerCase();return t=r(t),he[t]}},pe=new DOMParser,fe=new B({stripPrefix:!1,twitter:!1,email:!1,replaceFn:function(e,t){if(!t.protocolUrlMatch)return!1}}),me=32,ge=2414016,_e=1,ve=16093e3,ye=.1;function be(e){var t,r,i,n={xsi:"http://www.w3.org/2001/XMLSchema-instance"};for(var o in n)n.hasOwnProperty(o)&&(i="xmlns:"+o+"=",RegExp("[< ]"+o+":").test(e)&&-1===e.indexOf(i)&&(D(t)||(t=e.substr(0,e.indexOf("<kml")+4),r=e.substr(t.length)),t+=" "+i+'"'+n[o]+'"'));return D(t)&&(e=t+r),e}function Ce(e){for(var t,r,i,n=e.indexOf("xmlns:"),o=e.indexOf(">",n);-1!==n&&n<o;)t=e.slice(n,e.indexOf('"',n)),r=n,n=-1!==(n=e.indexOf(t,n+1))?(i=e.indexOf('"',e.indexOf('"',n)+1),(e=e.slice(0,n-1)+e.slice(i+1,e.length)).indexOf("xmlns:",r-1)):e.indexOf("xmlns:",r+1);return e}function we(t,r,i){var e=P(he.detectFromFilename(t.filename),"application/octet-stream");t.getData(new z.Data64URIWriter(e),function(e){r[t.filename]=e,i.resolve()})}function Se(e,t,r,i){for(var n=i.keys,o=new U("."),a=e.querySelectorAll(t),s=0;s<a.length;s++){var l=a[s],u=l.getAttribute(r),c=new U(u).resolve(o).toString(),d=n.indexOf(c);if(-1!==d){var h=n[d];l.setAttribute(r,i[h]),"a"===t&&null===l.getAttribute("download")&&l.setAttribute("download",h)}}}function Te(e,t,r,i){for(var n=e.querySelectorAll(t),o=0;o<n.length;o++){var a=n[o],s=Ve(a.getAttribute(r),i);a.setAttribute(r,s.url)}}function Ee(e,t,r){var i=Re(e,"id");i=D(i)&&0!==i.length?i:A(),D(r)&&(i=r+i);var n=t.getById(i);return D(n)&&(i=A(),D(r)&&(i=r+i)),n=t.add(new Y({id:i})),D(n.kml)||(n.addProperty("kml"),n.kml=new xt),n}function Ae(e,t){return"absolute"===e||"relativeToGround"===e||"relativeToSeaFloor"===t}function xe(e){if(!D(e))return T.fromDegrees(0,0,0);var t=e.match(/[^\s,\n]+/g);if(!D(t))return T.fromDegrees(0,0,0);var r=parseFloat(t[0]),i=parseFloat(t[1]),n=parseFloat(t[2]);return r=isNaN(r)?0:r,i=isNaN(i)?0:i,n=isNaN(n)?0:n,T.fromDegrees(r,i,n)}function Pe(e){if(D(e)){var t=e.textContent.match(/[^\s\n]+/g);if(D(t)){for(var r=t.length,i=new Array(r),n=0,o=0;o<r;o++)i[n++]=xe(t[o]);return i}}}var De=[null,void 0,"http://www.opengis.net/kml/2.2","http://earth.google.com/kml/2.2","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.0"],Oe=["http://www.google.com/kml/ext/2.2"],Ie={kml:De,gx:Oe,atom:["http://www.w3.org/2005/Atom"],kmlgx:De.concat(Oe)};function Me(e,t){if(D(e)){var r=e.getAttribute(t);if(null!==r){var i=parseFloat(r);return isNaN(i)?void 0:i}}}function Re(e,t){if(D(e)){var r=e.getAttribute(t);return null!==r?r:void 0}}function Le(e,t,r){if(D(e))for(var i=e.childNodes,n=i.length,o=0;o<n;o++){var a=i[o];if(a.localName===t&&-1!==r.indexOf(a.namespaceURI))return a}}function Ne(e,t,r){if(D(e)){for(var i=[],n=e.getElementsByTagNameNS("*",t),o=n.length,a=0;a<o;a++){var s=n[a];s.localName===t&&-1!==r.indexOf(s.namespaceURI)&&i.push(s)}return i}}function ke(e,t,r){if(!D(e))return[];for(var i=[],n=e.childNodes,o=n.length,a=0;a<o;a++){var s=n[a];s.localName===t&&-1!==r.indexOf(s.namespaceURI)&&i.push(s)}return i}function Fe(e,t,r){var i=Le(e,t,r);if(D(i)){var n=parseFloat(i.textContent);return isNaN(n)?void 0:n}}function Be(e,t,r){var i=Le(e,t,r);if(D(i))return i.textContent.trim()}function Ue(e,t,r){var i=Le(e,t,r);if(D(i)){var n=i.textContent.trim();return"1"===n||/^true$/i.test(n)}}function Ve(e,t,r){if(D(e)){var i;if(D(r)){var n=r[e];if(D(n))i=new h({url:n});else{var o=new U(t.getUrlComponent());n=r[new U(e).resolve(o)],D(n)&&(i=new h({url:n}))}}return D(i)||(i=t.getDerivedResource({url:e})),i}}var ze={};function qe(e,t){if(D(e)&&!/^\s*$/gm.test(e)){"#"===e[0]&&(e=e.substring(1));var r=parseInt(e.substring(0,2),16)/255,i=parseInt(e.substring(2,4),16)/255,n=parseInt(e.substring(4,6),16)/255,o=parseInt(e.substring(6,8),16)/255;return t?(0<o?ze.maximumRed=o:ze.red=0,0<n?ze.maximumGreen=n:ze.green=0,0<i?ze.maximumBlue=i:ze.blue=0,ze.alpha=r,E.fromRandom(ze)):new E(o,n,i,r)}}function Ge(e,t,r){var i=Be(e,t,r);if(D(i))return qe(i,"random"===Be(e,"colorMode",r))}function We(){var e=new q;return e.width=me,e.height=me,e.scaleByDistance=new l(ge,_e,ve,ye),e.pixelOffsetScaleByDistance=new l(ge,_e,ve,ye),e}function He(){var e=new J;return e.outline=!0,e.outlineColor=E.WHITE,e}function je(){var e=new Z;return e.translucencyByDistance=new l(3e6,1,5e6,0),e.pixelOffset=new S(17,0),e.horizontalOrigin=_.LEFT,e.font="16px sans-serif",e.style=v.FILL_AND_OUTLINE,e}function Ye(e,t,r,i,n){var o=Be(e,"href",Ie.kml);if(D(o)&&0!==o.length){if(0===o.indexOf("root://icons/palette-")){var a=o.charAt(21),s=P(Fe(e,"x",Ie.gx),0),l=P(Fe(e,"y",Ie.gx),0);s=Math.min(s/32,7),o="https://maps.google.com/mapfiles/kml/pal"+a+"/icon"+(8*(l=7-Math.min(l/32,7))+s)+".png"}var u=Ve(o,r,i);if(n){var c=Be(e,"refreshMode",Ie.kml),d=Be(e,"viewRefreshMode",Ie.kml);"onInterval"===c||"onExpire"===c?M("kml-refreshMode-"+c,"KML - Unsupported Icon refreshMode: "+c):"onStop"!==d&&"onRegion"!==d||M("kml-refreshMode-"+d,"KML - Unsupported Icon viewRefreshMode: "+d);var h=P(Be(e,"viewBoundScale",Ie.kml),1),p="onStop"===d?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"",f=P(Be(e,"viewFormat",Ie.kml),p),m=Be(e,"httpQuery",Ie.kml);return D(f)&&u.addQueryParameters(L(mt(f))),D(m)&&u.addQueryParameters(L(mt(m))),bt(u,t._camera,t._canvas,h,t._lastCameraView.bbox),u}return u}}function Xe(e,t,r,i,n){var o=Fe(t,"scale",Ie.kml),a=Fe(t,"heading",Ie.kml),s=Ge(t,"color",Ie.kml),l=Le(t,"Icon",Ie.kml),u=Ye(l,e,i,n,!1);D(l)&&!D(u)&&(u=!1);var c,d,h=Fe(l,"x",Ie.gx),p=Fe(l,"y",Ie.gx),f=Fe(l,"w",Ie.gx),m=Fe(l,"h",Ie.gx),g=Le(t,"hotSpot",Ie.kml),_=Me(g,"x"),v=Me(g,"y"),y=Re(g,"xunits"),b=Re(g,"yunits"),C=r.billboard;D(C)||(C=We(),r.billboard=C),C.image=u,C.scale=o,C.color=s,(D(h)||D(p)||D(f)||D(m))&&(C.imageSubRegion=new w(h,p,f,m)),D(a)&&0!==a&&(C.rotation=x.toRadians(-a),C.alignedAxis=T.UNIT_Z),o=P(o,1),D(_)&&("pixels"===y?c=-_*o:"insetPixels"===y?c=(_-me)*o:"fraction"===y&&(c=-_*me*o),c+=.5*me*o),D(v)&&("pixels"===b?d=v*o:"insetPixels"===b?d=(-v+me)*o:"fraction"===b&&(d=v*me*o),d-=.5*me*o),(D(c)||D(d))&&(C.pixelOffset=new S(c,d))}function Qe(e,t,r,i,n){for(var o=0,a=t.childNodes.length;o<a;o++){var s=t.childNodes.item(o);if("IconStyle"===s.localName)Xe(e,s,r,i,n);else if("LabelStyle"===s.localName){var l=r.label;D(l)||(l=je(),r.label=l),l.scale=P(Fe(s,"scale",Ie.kml),l.scale),l.fillColor=P(Ge(s,"color",Ie.kml),l.fillColor),l.text=r.name}else if("LineStyle"===s.localName){var u=r.polyline;D(u)||(u=new $,r.polyline=u),u.width=Fe(s,"width",Ie.kml),u.material=Ge(s,"color",Ie.kml),D(Ge(s,"outerColor",Ie.gx))&&M("kml-gx:outerColor","KML - gx:outerColor is not supported in a LineStyle"),D(Fe(s,"outerWidth",Ie.gx))&&M("kml-gx:outerWidth","KML - gx:outerWidth is not supported in a LineStyle"),D(Fe(s,"physicalWidth",Ie.gx))&&M("kml-gx:physicalWidth","KML - gx:physicalWidth is not supported in a LineStyle"),D(Ue(s,"labelVisibility",Ie.gx))&&M("kml-gx:labelVisibility","KML - gx:labelVisibility is not supported in a LineStyle")}else if("PolyStyle"===s.localName){var c=r.polygon;D(c)||(c=He(),r.polygon=c),c.material=P(Ge(s,"color",Ie.kml),c.material),c.fill=P(Ue(s,"fill",Ie.kml),c.fill),c.outline=P(Ue(s,"outline",Ie.kml),c.outline)}else if("BalloonStyle"===s.localName){var d=P(qe(Be(s,"bgColor",Ie.kml)),E.WHITE),h=P(qe(Be(s,"textColor",Ie.kml)),E.BLACK),p=Be(s,"text",Ie.kml);r.addProperty("balloonStyle"),r.balloonStyle={bgColor:d,textColor:h,text:p}}else if("ListStyle"===s.localName){var f=Be(s,"listItemType",Ie.kml);"radioFolder"!==f&&"checkOffOnly"!==f||M("kml-listStyle-"+f,"KML - Unsupported ListStyle with listItemType: "+f)}}}function Ze(t,r,i){return r.fetchXML().then(function(e){return Ke(t,e,i,r,!0)})}function Ke(e,t,r,i,n,o){var a,s,l,u,c=Ne(t,"Style",Ie.kml);if(D(c)){var d=c.length;for(a=0;a<d;a++)s=Re(u=c[a],"id"),D(s)&&(s="#"+s,n&&D(i)&&(s=i.getUrlComponent()+s),D(r.getById(s))||(l=new Y({id:s}),r.add(l),Qe(e,u,l,i,o)))}var h=Ne(t,"StyleMap",Ie.kml);if(D(h)){var p=h.length;for(a=0;a<p;a++){var f=h[a];if(s=Re(f,"id"),D(s))for(var m=ke(f,"Pair",Ie.kml),g=0;g<m.length;g++){var _=m[g],v=Be(_,"key",Ie.kml);if("normal"===v){if(s="#"+s,n&&D(i)&&(s=i.getUrlComponent()+s),!D(r.getById(s))){l=r.getOrCreateEntity(s);var y=Be(_,"styleUrl",Ie.kml);if(D(y)){"#"!==y[0]&&(y="#"+y),n&&D(i)&&(y=i.getUrlComponent()+y);var b=r.getById(y);D(b)&&l.merge(b)}else Qe(e,u=Le(_,"Style",Ie.kml),l,i,o)}}else M("kml-styleMap-"+v,"KML - Unsupported StyleMap key: "+v)}}}var C=[],w=t.getElementsByTagName("styleUrl"),S=w.length;for(a=0;a<S;a++){var T=w[a].textContent;if("#"!==T[0]){var E=T.split("#");if(2===E.length){var A=E[0],x=i.getDerivedResource({url:A});C.push(Ze(e,x,r))}}}return C}function Je(e,t,r){var i=new re(e,t.id,["position"]),n=new ne(t.position);t.polyline=D(r.polyline)?r.polyline.clone():new $,t.polyline.positions=new ee([i,n])}function $e(e,t){return!D(e)&&!D(t)||"clampToGround"===e?g.CLAMP_TO_GROUND:"relativeToGround"===e?g.RELATIVE_TO_GROUND:"absolute"===e?g.NONE:"clampToSeaFloor"===t?(M("kml-gx:altitudeMode-clampToSeaFloor","KML - <gx:altitudeMode>:clampToSeaFloor is currently not supported, using <kml:altitudeMode>:clampToGround."),g.CLAMP_TO_GROUND):"relativeToSeaFloor"===t?(M("kml-gx:altitudeMode-relativeToSeaFloor","KML - <gx:altitudeMode>:relativeToSeaFloor is currently not supported, using <kml:altitudeMode>:relativeToGround."),g.RELATIVE_TO_GROUND):(D(e)?M("kml-altitudeMode-unknown","KML - Unknown <kml:altitudeMode>:"+e+", using <kml:altitudeMode>:CLAMP_TO_GROUND."):M("kml-gx:altitudeMode-unknown","KML - Unknown <gx:altitudeMode>:"+t+", using <kml:altitudeMode>:CLAMP_TO_GROUND."),g.CLAMP_TO_GROUND)}function et(e,t,r,i){var n=t.label;D(n)||(n=D(r.label)?r.label.clone():je(),t.label=n),n.text=t.name;var o=t.billboard;D(o)||(o=D(r.billboard)?r.billboard.clone():We(),t.billboard=o),D(o.image)?o.image.getValue()||(o.image=void 0):o.image=e._pinBuilder.fromColor(E.YELLOW,64);var a=1;D(o.scale)&&(0!==(a=o.scale.getValue())?n.pixelOffset=new S(16*a+1,0):(n.pixelOffset=void 0,n.horizontalOrigin=void 0)),D(i)&&e._clampToGround&&(o.heightReference=i,n.heightReference=i)}function tt(e,t){var r=e.path;D(r)||((r=new K).leadTime=0,e.path=r);var i=t.polyline;D(i)&&(r.material=i.material,r.width=i.width)}function rt(e,t,r,i,n){var o=Le(r,"coordinates",Ie.kml),a=Be(r,"altitudeMode",Ie.kml),s=Be(r,"altitudeMode",Ie.gx),l=Ue(r,"extrude",Ie.kml),u=Ue(r,"tessellate",Ie.kml),c=Ae(a,s);D(Fe(r,"drawOrder",Ie.gx))&&M("kml-gx:drawOrder","KML - gx:drawOrder is not supported in LineStrings");var d=Pe(o),h=n.polyline;if(c&&l){var p=new ae;(i.wall=p).positions=d;var f=n.polygon;D(f)&&(p.fill=f.fill,p.material=f.material),p.outline=!0,D(h)?(p.outlineColor=D(h.material)?h.material.color:E.WHITE,p.outlineWidth=h.width):D(f)&&(p.outlineColor=D(f.material)?f.material.color:E.WHITE)}else if(e._clampToGround&&!c&&u){var m=new W;(i.corridor=m).positions=d,D(h)?(m.material=D(h.material)?h.material.color.getValue(O.MINIMUM_VALUE):E.WHITE,m.width=P(h.width,1)):(m.material=E.WHITE,m.width=1)}else h=D(h)?h.clone():new $,(i.polyline=h).positions=function(e,t,r){if(D(e)){if("relativeToSeaFloor"===r||"absolute"===t||"relativeToGround"===t)return e;(D(t)&&"clampToGround"!==t||D(r)&&"clampToSeaFloor"!==r)&&M("kml-altitudeMode-unknown","KML - Unknown altitudeMode: "+P(t,r));for(var i=e.length,n=0;n<i;n++){var o=e[n];b.WGS84.scaleToGeodeticSurface(o,o)}return e}}(d,a,s),u&&!c||(h.followSurface=!1);return!0}function it(e,t,r,i,n,o,a,s,l){var u,c,d,h=e[0],p=e[e.length-1],f=new ie;f.addSamples(e,t),r.intervals.addInterval(new y({start:h,stop:p,isStartIncluded:l,isStopIncluded:l,data:(u=f,c=a,d=s,"relativeToSeaFloor"===d||"absolute"===c||"relativeToGround"===c?u:((D(c)&&"clampToGround"!==c||D(d)&&"clampToSeaFloor"!==d)&&M("kml-altitudeMode-unknown","KML - Unknown altitudeMode: "+P(c,d)),new ne(u)))})),i.addInterval(new y({start:h,stop:p,isStartIncluded:l,isStopIncluded:l})),n.intervals.addInterval(new y({start:h,stop:p,isStartIncluded:l,isStopIncluded:l,data:o}))}var nt={Point:function(e,t,r,i,n){var o=Be(r,"coordinates",Ie.kml),a=Be(r,"altitudeMode",Ie.kml),s=Be(r,"altitudeMode",Ie.gx),l=Ue(r,"extrude",Ie.kml),u=xe(o);return i.position=u,et(e,i,n,$e(a,s)),l&&Ae(a,s)&&Je(t,i,n),!0},LineString:rt,LinearRing:rt,Polygon:function(e,t,r,i,n){var o=Le(Le(r,"outerBoundaryIs",Ie.kml),"LinearRing",Ie.kml),a=Le(o,"coordinates",Ie.kml),s=Pe(a),l=Ue(r,"extrude",Ie.kml),u=Ae(Be(r,"altitudeMode",Ie.kml),Be(r,"altitudeMode",Ie.gx)),c=D(n.polygon)?n.polygon.clone():He(),d=n.polyline;if(D(d)&&(c.outlineColor=D(d.material)?d.material.color:E.WHITE,c.outlineWidth=d.width),i.polygon=c,u?(c.perPositionHeight=!0,c.extrudedHeight=l?0:void 0):e._clampToGround||(c.height=0),D(s)){for(var h=new R(s),p=ke(r,"innerBoundaryIs",Ie.kml),f=0;f<p.length;f++){o=ke(p[f],"LinearRing",Ie.kml);for(var m=0;m<o.length;m++)s=Pe(a=Le(o[m],"coordinates",Ie.kml)),D(s)&&h.holes.push(new R(s))}c.hierarchy=h}return!0},Track:function(e,t,r,i,n){var o=Be(r,"altitudeMode",Ie.kml),a=Be(r,"altitudeMode",Ie.gx),s=ke(r,"coord",Ie.gx),l=ke(r,"angles",Ie.gx),u=ke(r,"when",Ie.kml),c=Ue(r,"extrude",Ie.kml),d=Ae(o,a);0<l.length&&M("kml-gx:angles","KML - gx:angles are not supported in gx:Tracks");for(var h=Math.min(s.length,u.length),p=[],f=[],m=0;m<h;m++){var g=xe(s[m].textContent);p.push(g),f.push(I.fromIso8601(u[m].textContent))}var _=new ie;return _.addSamples(f,p),i.position=_,et(e,i,n,$e(o,a)),tt(i,n),i.availability=new k,0<u.length&&i.availability.addInterval(new y({start:f[0],stop:f[f.length-1]})),d&&c&&Je(t,i,n),!0},MultiTrack:function(e,t,r,i,n){for(var o,a,s,l=Ue(r,"interpolate",Ie.gx),u=ke(r,"Track",Ie.gx),c=!1,d=new oe,h=new k,p=new G,f=0,m=u.length;f<m;f++){var g=u[f],_=ke(g,"when",Ie.kml),v=ke(g,"coord",Ie.gx),y=Be(g,"altitudeMode",Ie.kml),b=Be(g,"altitudeMode",Ie.gx),C=Ae(y,b),w=Ue(g,"extrude",Ie.kml),S=Math.min(v.length,_.length),T=[];o=[];for(var E=0;E<S;E++){var A=xe(v[E].textContent);T.push(A),o.push(I.fromIso8601(_[E].textContent))}l&&(D(a)&&it([a,o[0]],[s,T[0]],p,h,d,!1,"absolute",void 0,!1),a=o[S-1],s=T[T.length-1]),it(o,T,p,h,d,C&&w,y,b,!0),c=c||C&&w}return i.availability=h,i.position=p,et(e,i,n),tt(i,n),c&&(Je(t,i,n),i.polyline.show=d),!0},MultiGeometry:function(e,t,r,i,n,o){for(var a=r.childNodes,s=!1,l=0,u=a.length;l<u;l++){var c=a.item(l),d=nt[c.localName];if(D(d)){var h=Ee(c,t,o);h.parent=i,h.name=i.name,h.availability=i.availability,h.description=i.description,h.kml=i.kml,d(e,t,c,h,n)&&(s=!0)}}return s},Model:function(e,t,r,i,n){return M("kml-unsupportedGeometry","KML - Unsupported geometry: "+r.localName),!1}};var ot=document.createElement("div");function at(e,t,r,i,n,o,a,s,l){var u=Ee(r,i,l),c=u.kml,d=function(e,t,r,i,n){for(var o,a=new Y,s=-1,l=t.childNodes,u=l.length,c=0;c<u;c++){var d=l[c];"Style"!==d.localName&&"StyleMap"!==d.localName||(s=c)}if(-1!==s){var h=l[s];if("Style"===h.localName)Qe(e,h,a,i,n);else for(var p=ke(h,"Pair",Ie.kml),f=0;f<p.length;f++){var m=p[f],g=Be(m,"key",Ie.kml);if("normal"===g){var _=Be(m,"styleUrl",Ie.kml);D(_)?(o=r.getById(_),D(o)||(o=r.getById("#"+_)),D(o)&&a.merge(o)):Qe(e,Le(m,"Style",Ie.kml),a,i,n)}else M("kml-styleMap-"+g,"KML - Unsupported StyleMap key: "+g)}}var v=Be(t,"styleUrl",Ie.kml);if(D(v)){var y=v;if("#"!==v[0]&&-1!==v.indexOf("#")){var b=v.split("#"),C=b[0];y=i.getDerivedResource({url:C}).getUrlComponent()+"#"+b[1]}o=r.getById(y),D(o)||(o=r.getById("#"+y)),D(o)&&a.merge(o)}return a}(e,r,n,o,a),h=Be(r,"name",Ie.kml);u.name=h,u.parent=t;var p=function(e){var t=Le(e,"TimeSpan",Ie.kmlgx);if(D(t)){var r,i=Le(t,"begin",Ie.kmlgx),n=D(i)?I.fromIso8601(i.textContent):void 0,o=Le(t,"end",Ie.kmlgx),a=D(o)?I.fromIso8601(o.textContent):void 0;if(D(n)&&D(a)){if(I.lessThan(a,n)){var s=n;n=a,a=s}(r=new k).addInterval(new y({start:n,stop:a}))}else D(n)?(r=new k).addInterval(new y({start:n,stop:O.MAXIMUM_VALUE})):D(a)&&(r=new k).addInterval(new y({start:O.MINIMUM_VALUE,stop:a}));return r}}(r);D(p)||(p=function(e){var t=Le(e,"TimeStamp",Ie.kmlgx),r=Be(t,"when",Ie.kmlgx);if(D(t)&&D(r)&&0!==r.length){var i=I.fromIso8601(r),n=new k;return n.addInterval(new y({start:i,stop:O.MAXIMUM_VALUE})),n}}(r)),u.availability=p,Et(u);var f=Ue(r,"visibility",Ie.kml);u.show=function e(t){return!t||t.show&&e(t.parent)}(t)&&P(f,!0);var m=Le(r,"author",Ie.atom),g=c.author;g.name=Be(m,"name",Ie.atom),g.uri=Be(m,"uri",Ie.atom),g.email=Be(m,"email",Ie.atom);var _=Le(r,"link",Ie.atom),v=c.link;return v.href=Re(_,"href"),v.hreflang=Re(_,"hreflang"),v.rel=Re(_,"rel"),v.type=Re(_,"type"),v.title=Re(_,"title"),v.length=Re(_,"length"),c.address=Be(r,"address",Ie.kml),c.phoneNumber=Be(r,"phoneNumber",Ie.kml),c.snippet=Be(r,"Snippet",Ie.kml),function(e,t){var r=Le(e,"ExtendedData",Ie.kml);if(D(r)){D(Le(r,"SchemaData",Ie.kml))&&M("kml-schemaData","KML - SchemaData is unsupported"),D(Re(r,"xmlns:prefix"))&&M("kml-extendedData","KML - ExtendedData with xmlns:prefix is unsupported");var i={},n=ke(r,"Data",Ie.kml);if(D(n))for(var o=n.length,a=0;a<o;a++){var s=n[a],l=Re(s,"name");D(l)&&(i[l]={displayName:Be(s,"displayName",Ie.kml),value:Be(s,"value",Ie.kml)})}t.kml.extendedData=i}}(r,u),function(e,t,r,i,n){var o,a,s,l,u=t.kml,c=u.extendedData,d=Be(e,"description",Ie.kml),h=P(t.balloonStyle,r.balloonStyle),p=E.WHITE,f=E.BLACK,m=d;if(D(h)&&(p=P(h.bgColor,E.WHITE),f=P(h.textColor,E.BLACK),m=P(h.text,d)),D(m)){if(m=(m=(m=(m=(m=(m=m.replace("$[name]",P(t.name,""))).replace("$[description]",P(d,""))).replace("$[address]",P(u.address,""))).replace("$[Snippet]",P(u.snippet,""))).replace("$[id]",t.id)).replace("$[geDirections]",""),D(c)){var g=m.match(/\$\[.+?\]/g);if(null!==g)for(o=0;o<g.length;o++){var _=g[o],v=_.substr(2,_.length-3),y=/\/displayName$/.test(v);l=c[v=v.replace(/\/displayName$/,"")],D(l)&&(l=y?l.displayName:l.value),D(l)&&(m=m.replace(_,P(l,"")))}}}else if(D(c)&&0<(s=Object.keys(c)).length){for(m='<table class="cesium-infoBox-defaultTable cesium-infoBox-defaultTable-lighter"><tbody>',o=0;o<s.length;o++)l=c[a=s[o]],m+="<tr><th>"+P(l.displayName,a)+"</th><td>"+P(l.value,"")+"</td></tr>";m+="</tbody></table>"}if(D(m)){m=fe.link(m),ot.innerHTML=m;var b=ot.querySelectorAll("a");for(o=0;o<b.length;o++)b[o].setAttribute("target","_blank");D(i)&&1<i.keys.length&&(Se(ot,"a","href",i),Se(ot,"img","src",i)),Te(ot,"a","href",n),Te(ot,"img","src",n);var C='<div class="cesium-infoBox-description-lighter" style="';C+="overflow:auto;",C+="word-wrap:break-word;",C+="background-color:"+p.toCssColorString()+";",C+="color:"+f.toCssColorString()+";",C+='">',C+=ot.innerHTML+"</div>",ot.innerHTML="",t.description=C}}(r,u,d,a,o),ht(r,u),dt(r,u),D(Le(r,"Region",Ie.kml))&&M("kml-region","KML - Placemark Regions are unsupported"),{entity:u,styleEntity:d}}var st={Document:lt,Folder:function(e,t,r,i,n,o,a,s,l){var u=at(e,t,r,i,n,o,a,0,l);lt(e,u.entity,r,i,n,o,a,s,l)},Placemark:function(e,t,r,i,n,o,a,s,l){for(var u=at(e,t,r,i,n,o,a,0,l),c=u.entity,d=u.styleEntity,h=!1,p=r.childNodes,f=0,m=p.length;f<m&&!h;f++){var g=p.item(f),_=nt[g.localName];D(_)&&(_(e,i,g,c,d,c.id),h=!0)}h||(c.merge(d),et(e,c,d))},NetworkLink:function(m,e,t,r,i,n,o,a,s){var g=at(m,e,t,r,i,n,o,0,s).entity,_=Le(t,"Link",Ie.kml);D(_)||(_=Le(t,"Url",Ie.kml));if(D(_)){var v,y,b=Be(_,"href",Ie.kml);if(D(b)){var l=b;if(b=Ve(b,n,o),/^data:/.test(b.getUrlComponent()))/\.kmz/i.test(n.getUrlComponent())||(l=n.getDerivedResource({url:l}));else{l=b.clone(),v=Be(_,"viewRefreshMode",Ie.kml),y=P(Be(_,"viewBoundScale",Ie.kml),1);var u="onStop"===v?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"",c=P(Be(_,"viewFormat",Ie.kml),u),d=Be(_,"httpQuery",Ie.kml);D(c)&&b.addQueryParameters(L(mt(c))),D(d)&&b.addQueryParameters(L(mt(d))),bt(b,m._camera,m._canvas,y,m._lastCameraView.bbox)}var h={sourceUri:l,uriResolver:o,context:g.id},C=new Q,p=St(m,C,b,h).then(function(e){var t=m._entityCollection,r=C.values;t.suspendEvents();for(var i=0;i<r.length;i++){var n=r[i];D(n.parent)||(n.parent=g,Et(n)),t.add(n)}t.resumeEvents();var o=Be(_,"refreshMode",Ie.kml),a=P(Fe(_,"refreshInterval",Ie.kml),0);if("onInterval"===o&&0<a||"onExpire"===o||"onStop"===v){var s=Le(e,"NetworkLinkControl",Ie.kml),l=D(s),u=I.now(),c={id:A(),href:b,cookie:{},lastUpdated:u,updating:!1,entity:g,viewBoundScale:y,needsUpdate:!1,cameraUpdateTime:u},d=0;if(l&&(c.cookie=L(P(Be(s,"cookie",Ie.kml),"")),d=P(Fe(s,"minRefreshPeriod",Ie.kml),0)),"onInterval"===o)l&&(a=Math.max(d,a)),c.refreshMode=ft.INTERVAL,c.time=a;else if("onExpire"===o){var h;if(l&&(h=Be(s,"expires",Ie.kml)),D(h))try{var p=I.fromIso8601(h),f=I.secondsDifference(p,u);0<f&&f<d&&I.addSeconds(u,d,p),c.refreshMode=ft.EXPIRE,c.time=p}catch(e){M("kml-refreshMode-onInterval-onExpire","KML - NetworkLinkControl expires is not a valid date")}else M("kml-refreshMode-onExpire","KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element")}else m._camera?(c.refreshMode=ft.STOP,c.time=P(Fe(_,"viewRefreshTime",Ie.kml),0)):M("kml-refrehMode-onStop-noCamera","A NetworkLink with viewRefreshMode=onStop requires a camera be passed in when creating the KmlDataSource");D(c.refreshMode)&&m._networkLinks.set(c.id,c)}else"onRegion"===v&&M("kml-refrehMode-onRegion","KML - Unsupported viewRefreshMode: onRegion")}).otherwise(function(e){M("An error occured during loading "+b.url),m._error.raiseEvent(m,e)});a.push(p)}}},GroundOverlay:function(e,t,r,i,n,o,a,s,l){var u,c=at(e,t,r,i,n,o,a,0,l).entity,d=!1,h=Pe(Le(r,"LatLonQuad",Ie.gx));if(D(h))(u=He()).hierarchy=new R(h),c.polygon=u,d=!0;else{u=new te,c.rectangle=u;var p=Le(r,"LatLonBox",Ie.kml);if(D(p)){var f=Fe(p,"west",Ie.kml),m=Fe(p,"south",Ie.kml),g=Fe(p,"east",Ie.kml),_=Fe(p,"north",Ie.kml);D(f)&&(f=x.negativePiToPi(x.toRadians(f))),D(m)&&(m=x.clampToLatitudeRange(x.toRadians(m))),D(g)&&(g=x.negativePiToPi(x.toRadians(g))),D(_)&&(_=x.clampToLatitudeRange(x.toRadians(_))),u.coordinates=new N(f,m,g,_);var v=Fe(p,"rotation",Ie.kml);if(D(v)){var y=x.toRadians(v);u.rotation=y,u.stRotation=y}}}var b=Le(r,"Icon",Ie.kml),C=Ye(b,e,o,a,!0);if(D(C)){d&&M("kml-gx:LatLonQuad","KML - gx:LatLonQuad Icon does not support texture projection.");var w=Fe(b,"x",Ie.gx),S=Fe(b,"y",Ie.gx),T=Fe(b,"w",Ie.gx),E=Fe(b,"h",Ie.gx);(D(w)||D(S)||D(T)||D(E))&&M("kml-groundOverlay-xywh","KML - gx:x, gx:y, gx:w, gx:h aren't supported for GroundOverlays"),u.material=C,u.material.color=Ge(r,"color",Ie.kml),u.material.transparent=!0}else u.material=Ge(r,"color",Ie.kml);var A=Be(r,"altitudeMode",Ie.kml);D(A)?"absolute"===A?u.height=Fe(r,"altitude",Ie.kml):"clampToGround"!==A&&M("kml-altitudeMode-unknown","KML - Unknown altitudeMode: "+A):"relativeToSeaFloor"===(A=Be(r,"altitudeMode",Ie.gx))?(M("kml-altitudeMode-relativeToSeaFloor","KML - altitudeMode relativeToSeaFloor is currently not supported, treating as absolute."),u.height=Fe(r,"altitude",Ie.kml)):"clampToSeaFloor"===A?M("kml-altitudeMode-clampToSeaFloor","KML - altitudeMode clampToSeaFloor is currently not supported, treating as clampToGround."):D(A)&&M("kml-altitudeMode-unknown","KML - Unknown altitudeMode: "+A)},PhotoOverlay:pt,ScreenOverlay:pt,Tour:function(e,t,r,i,n,o,a,s,l){var u=Be(r,"name",Ie.kml),c=Re(r,"id"),d=new ue(u,c),h=Le(r,"Playlist",Ie.gx);if(h)for(var p=h.childNodes,f=0;f<p.length;f++){var m=p[f];if(m.localName){var g=ut[m.localName];g?g(d,m):console.log("Unknown KML Tour playlist entry type "+m.localName)}}D(e.kmlTours)||(e.kmlTours=[]);e.kmlTours.push(d)}};function lt(e,t,r,i,n,o,a,s,l){for(var u=Object.keys(st),c=u.length,d=0;d<c;d++)for(var h=u[d],p=st[h],f=r.childNodes,m=f.length,g=0;g<m;g++){var _=f[g];_.localName!==h||-1===Ie.kml.indexOf(_.namespaceURI)&&-1===Ie.gx.indexOf(_.namespaceURI)||p(e,t,_,i,n,o,a,s,l)}}var ut={FlyTo:function(e,t){var r=Fe(t,"duration",Ie.gx),i=Be(t,"flyToMode",Ie.gx),n={kml:{}};ht(t,n),dt(t,n);var o=n.kml.lookAt||n.kml.camera,a=new ce(r,i,o);e.addPlaylistEntry(a)},Wait:function(e,t){var r=Fe(t,"duration",Ie.gx);e.addPlaylistEntry(new de(r))},SoundCue:ct,AnimatedUpdate:ct,TourControl:ct};function ct(e,t){M("KML Tour unsupported node "+t.localName)}function dt(e,t){var r=Le(e,"Camera",Ie.kml);if(D(r)){var i=P(Fe(r,"longitude",Ie.kml),0),n=P(Fe(r,"latitude",Ie.kml),0),o=P(Fe(r,"altitude",Ie.kml),0),a=P(Fe(r,"heading",Ie.kml),0),s=P(Fe(r,"tilt",Ie.kml),0),l=P(Fe(r,"roll",Ie.kml),0),u=T.fromDegrees(i,n,o),c=p.fromDegrees(a,s-90,l);t.kml.camera=new le(u,c)}}function ht(e,t){var r=Le(e,"LookAt",Ie.kml);if(D(r)){var i=P(Fe(r,"longitude",Ie.kml),0),n=P(Fe(r,"latitude",Ie.kml),0),o=P(Fe(r,"altitude",Ie.kml),0),a=Fe(r,"heading",Ie.kml),s=Fe(r,"tilt",Ie.kml),l=P(Fe(r,"range",Ie.kml),0);s=x.toRadians(P(s,0)),a=x.toRadians(P(a,0));var u=new f(a,s-x.PI_OVER_TWO,l),c=T.fromDegrees(i,n,o);t.kml.lookAt=new se(c,u)}}function pt(e,t,r,i,n,o,a,s,l){e._unsupportedNode.raiseEvent(e,t,r,i,n,o,a),M("kml-unsupportedFeature-"+r.nodeName,"KML - Unsupported feature: "+r.nodeName)}var ft={INTERVAL:0,EXPIRE:1,STOP:2};function mt(e){if(!D(e)||0===e.length)return"";var t=e[0];return"&"!==t&&"?"!==t||(e=e.substring(1)),e}var gt=new N,_t=new e,vt=new S,yt=new T;function bt(e,t,r,i,n){function o(e){return e<-x.PI_OVER_TWO?-x.PI_OVER_TWO:e>x.PI_OVER_TWO?x.PI_OVER_TWO:e}function a(e){return e>x.PI?e-x.TWO_PI:e<-x.PI?e+x.TWO_PI:e}var s=C(e.queryParameters);if(s=s.replace(/%5B/g,"[").replace(/%5D/g,"]"),D(t)&&t._mode!==F.MORPHING){var l,u,c=b.WGS84;if(n=P(n,gt),D(r)&&(vt.x=.5*r.clientWidth,vt.y=.5*r.clientHeight,l=t.pickEllipsoid(vt,c,yt)),D(l)?u=c.cartesianToCartographic(l,_t):(u=N.center(n,_t),l=c.cartographicToCartesian(u)),D(i)&&!x.equalsEpsilon(i,1,x.EPSILON9)){var d=n.width*i*.5,h=n.height*i*.5;n=new N(a(u.longitude-d),o(u.latitude-h),a(u.longitude+d),o(u.latitude+h))}s=(s=(s=(s=s.replace("[bboxWest]",x.toDegrees(n.west).toString())).replace("[bboxSouth]",x.toDegrees(n.south).toString())).replace("[bboxEast]",x.toDegrees(n.east).toString())).replace("[bboxNorth]",x.toDegrees(n.north).toString());var p=x.toDegrees(u.longitude).toString(),f=x.toDegrees(u.latitude).toString();s=(s=(s=(s=(s=(s=(s=(s=s.replace("[lookatLon]",p)).replace("[lookatLat]",f)).replace("[lookatTilt]",x.toDegrees(t.pitch).toString())).replace("[lookatHeading]",x.toDegrees(t.heading).toString())).replace("[lookatRange]",T.distance(t.positionWC,l))).replace("[lookatTerrainLon]",p)).replace("[lookatTerrainLat]",f)).replace("[lookatTerrainAlt]",u.height.toString()),c.cartesianToCartographic(t.positionWC,_t),s=(s=(s=s.replace("[cameraLon]",x.toDegrees(_t.longitude).toString())).replace("[cameraLat]",x.toDegrees(_t.latitude).toString())).replace("[cameraAlt]",x.toDegrees(_t.height).toString());var m=t.frustum,g=m.aspectRatio,_="",v="";if(D(g)){var y=x.toDegrees(m.fov);1<g?v=(_=y)/g:_=(v=y)*g}s=(s=s.replace("[horizFov]",_.toString())).replace("[vertFov]",v.toString())}else s=(s=(s=(s=(s=(s=(s=(s=(s=(s=(s=(s=(s=(s=(s=(s=(s=s.replace("[bboxWest]","-180")).replace("[bboxSouth]","-90")).replace("[bboxEast]","180")).replace("[bboxNorth]","90")).replace("[lookatLon]","")).replace("[lookatLat]","")).replace("[lookatRange]","")).replace("[lookatTilt]","")).replace("[lookatHeading]","")).replace("[lookatTerrainLon]","")).replace("[lookatTerrainLat]","")).replace("[lookatTerrainAlt]","")).replace("[cameraLon]","")).replace("[cameraLat]","")).replace("[cameraAlt]","")).replace("[horizFov]","")).replace("[vertFov]","");s=(s=(s=(s=(s=(s=D(r)?(s=s.replace("[horizPixels]",r.clientWidth)).replace("[vertPixels]",r.clientHeight):(s=s.replace("[horizPixels]","")).replace("[vertPixels]","")).replace("[terrainEnabled]","1")).replace("[clientVersion]","1")).replace("[kmlVersion]","2.2")).replace("[clientName]","Cesium")).replace("[language]","English"),e.addQueryParameters(L(s))}function Ct(f,m,g,_,v,y){m.removeAll();var b=[],e=g.documentElement,t=Be("Document"===e.localName?e:Le(e,"Document",Ie.kml),"name",Ie.kml);D(t)||(t=s(_.getUrlComponent())),D(f._name)||(f._name=t);var C=new Q(f);return V.all(Ke(f,g,C,_,!1,v)).then(function(){var e,t,r,i,n,o,a,s,l,u,c=g.documentElement;if("kml"===c.localName)for(var d=c.childNodes,h=0;h<d.length;h++){var p=d[h];if(D(st[p.localName])){c=p;break}}return m.suspendEvents(),e=f,r=void 0,i=m,n=C,o=_,a=v,s=b,l=y,u=st[(t=c).localName],D(u)?u(e,r,t,i,n,o,a,s,l):pt(e,r,t,i,n,o,a),m.resumeEvents(),V.all(b).then(function(){return g.documentElement})})}function wt(d,h,e,p){var f=V.defer();return z.createReader(new z.BlobReader(e),function(c){c.getEntries(function(e){for(var t,r,i,n,o=[],a={},s=0;s<e.length;s++){var l=e[s];if(!l.directory){var u=V.defer();o.push(u.promise),/\.kml$/i.test(l.filename)?D(t)&&/\//i.test(l.filename)?we(l,a,u):(D(t)&&we(t,a,r),t=l,r=u):we(l,a,u)}}D(t)&&(i=a,n=r,t.getData(new z.TextWriter,function(e){e=Ce(e=be(e)),i.kml=pe.parseFromString(e,"application/xml"),n.resolve()})),V.all(o).then(function(){if(c.close(),D(a.kml))return a.keys=Object.keys(a),Ct(d,h,a.kml,p,a);f.reject(new m("KMZ file does not contain a KML document."))}).then(f.resolve).otherwise(f.reject)})},function(e){f.reject(e)}),f.promise}function St(o,a,e,t){var s=(t=P(t,P.EMPTY_OBJECT)).sourceUri,l=t.uriResolver,u=t.context,r=t.query;D(t.query)&&n("KmlDataSource.query","The options.query parameter has been deprecated. Specify data or options.sourceUri as a Resource instance and add query parameters there."),D(o._proxy)&&n("KmlDataSource.proxy","The options.proxy parameter has been deprecated. Specify data or options.sourceUri as a Resource instance and set the proxy property there.");var i=e;return s="string"==typeof e||e instanceof h?(i=(e=h.createIfNeeded(e,{proxy:o._proxy,queryParameters:r})).fetchBlob(),P(s,e.clone())):P(s,h.DEFAULT.clone()),s=h.createIfNeeded(s),D(o._proxy)&&(s.proxy=o._proxy),D(r)&&s.addQueryParameters(r),V(i).then(function(n){return n instanceof Blob?(e=n,t=e.slice(0,Math.min(4,e.size)),r=V.defer(),i=new FileReader,i.addEventListener("load",function(){r.resolve(1347093252===new DataView(i.result).getUint32(0,!1))}),i.addEventListener("error",function(){r.reject(i.error)}),i.readAsArrayBuffer(t),r.promise).then(function(e){return e?wt(o,a,n,s):(t=n,r=V.defer(),i=new FileReader,i.addEventListener("load",function(){r.resolve(i.result)}),i.addEventListener("error",function(){r.reject(i.error)}),i.readAsText(t),r.promise).then(function(e){var t,r;e=Ce(e=be(e));try{t=pe.parseFromString(e,"application/xml")}catch(e){r=e.toString()}if(D(r)||t.body||"parsererror"===t.documentElement.tagName){var i=D(r)?r:t.documentElement.firstChild.nodeValue;throw i||(i=t.body.innerText),new m(i)}return Ct(o,a,t,s,l,u)});var t,r,i}):Ct(o,a,n,s,l,u);var e,t,r,i}).otherwise(function(e){return o._error.raiseEvent(o,e),console.log(e),V.reject(e)})}function Tt(e){var t=(e=P(e,{})).camera,r=e.canvas;if(!D(t))throw new o("options.camera is required.");if(!D(r))throw new o("options.canvas is required.");this._changed=new a,this._error=new a,this._loading=new a,this._refresh=new a,this._unsupportedNode=new a,this._clock=void 0,this._entityCollection=new Q(this),this._name=void 0,this._isLoading=!1,this._proxy=e.proxy,this._pinBuilder=new u,this._networkLinks=new i,this._entityCluster=new X,this._canvas=r,this._camera=t,this._lastCameraView={position:D(t)?T.clone(t.positionWC):void 0,direction:D(t)?T.clone(t.directionWC):void 0,up:D(t)?T.clone(t.upWC):void 0,bbox:D(t)?t.computeViewRectangle():N.clone(N.MAX_VALUE)}}function Et(e){var t=e.parent;if(D(t)){var r=t.availability;if(D(r)){var i=e.availability;D(i)?i.intersect(r):e.availability=r}}}Tt.load=function(e,t){return new Tt(t=P(t,P.EMPTY_OBJECT)).load(e,t)},t(Tt.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},refreshEvent:{get:function(){return this._refresh}},unsupportedNodeEvent:{get:function(){return this._unsupportedNode}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!D(e))throw new o("value must be defined.");this._entityCluster=e}}}),Tt.prototype.load=function(e,t){if(!D(e))throw new o("data is required.");t=P(t,{}),H.setLoading(this,!0);var l=this._name;this._name=void 0,this._clampToGround=P(t.clampToGround,!1);var u=this;return St(this,this._entityCollection,e,t).then(function(){var e,t,r=u._entityCollection.computeAvailability(),i=r.start,n=r.stop,o=I.equals(i,O.MINIMUM_VALUE),a=I.equals(n,O.MAXIMUM_VALUE);o&&a||(o&&((t=new Date).setHours(0,0,0,0),i=I.fromDate(t)),a&&((t=new Date).setHours(24,0,0,0),n=I.fromDate(t)),(e=new j).startTime=i,e.stopTime=n,e.currentTime=I.clone(i),e.clockRange=c.LOOP_STOP,e.clockStep=d.SYSTEM_CLOCK_MULTIPLIER,e.multiplier=Math.round(Math.min(Math.max(I.secondsDifference(n,i)/60,1),31556900)));var s=!1;return e!==u._clock&&(u._clock=e,s=!0),l!==u._name&&(s=!0),s&&u._changed.raiseEvent(u),H.setLoading(u,!1),u}).otherwise(function(e){return H.setLoading(u,!1),u._error.raiseEvent(u,e),console.log(e),V.reject(e)})};var At=new i;function xt(){this.author={name:void 0,uri:void 0,email:void 0},this.link={href:void 0,hreflang:void 0,rel:void 0,type:void 0,title:void 0,length:void 0},this.address=void 0,this.phoneNumber=void 0,this.snippet=void 0,this.extendedData=void 0}return Tt.prototype.update=function(e){var t=this._networkLinks;if(0===t.length)return!0;var o=I.now(),a=this;At.removeAll();var s=!1,l=this._lastCameraView,r=this._camera;!D(r)||r.positionWC.equalsEpsilon(l.position,x.EPSILON7)&&r.directionWC.equalsEpsilon(l.direction,x.EPSILON7)&&r.upWC.equalsEpsilon(l.up,x.EPSILON7)||(l.position=T.clone(r.positionWC),l.direction=T.clone(r.directionWC),l.up=T.clone(r.upWC),l.bbox=r.computeViewRectangle(),s=!0);var u=new i,c=!1;return t.values.forEach(function(r){var e=r.entity;if(!At.contains(e.id)){if(!r.updating){var t=!1;if(r.refreshMode===ft.INTERVAL?I.secondsDifference(o,r.lastUpdated)>r.time&&(t=!0):r.refreshMode===ft.EXPIRE?I.greaterThan(o,r.time)&&(t=!0):r.refreshMode===ft.STOP&&(s&&(r.needsUpdate=!0,r.cameraUpdateTime=o),r.needsUpdate&&I.secondsDifference(o,r.cameraUpdateTime)>=r.time&&(t=!0)),t){!function e(t){for(var r=t._children,i=r.length,n=0;n<i;++n){var o=r[n];At.set(o.id,o),e(o)}}(e),r.updating=!0;var i=new Q,n=r.href.clone();n.addQueryParameters(r.cookie),bt(n,a._camera,a._canvas,r.viewBoundScale,l.bbox),St(a,i,n,{context:e.id}).then((S=a,T=r,E=i,A=u,x=n,function(e){if(A.contains(T.id)){var t=!1,r=Le(e,"NetworkLinkControl",Ie.kml),i=0;if(D(r)){if(D(Le(r,"Update",Ie.kml)))return M("kml-networkLinkControl-update","KML - NetworkLinkControl updates aren't supported."),T.updating=!1,void A.remove(T.id);T.cookie=L(P(Be(r,"cookie",Ie.kml),"")),i=P(Fe(r,"minRefreshPeriod",Ie.kml),0)}var n=I.now(),o=T.refreshMode;if(o===ft.INTERVAL)D(r)&&(T.time=Math.max(i,T.time));else if(o===ft.EXPIRE){var a;if(D(r)&&(a=Be(r,"expires",Ie.kml)),D(a))try{var s=I.fromIso8601(a),l=I.secondsDifference(s,n);0<l&&l<i&&I.addSeconds(n,i,s),T.time=s}catch(e){M("kml-networkLinkControl-expires","KML - NetworkLinkControl expires is not a valid date"),t=!0}else M("kml-refreshMode-onExpire","KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element"),t=!0}var u=T.entity,c=S._entityCollection,d=E.values;c.suspendEvents();var h,p=c.values.slice();for(h=0;h<p.length;++h){var f=p[h];f.parent===u&&(f.parent=void 0,w(f))}for(c.resumeEvents(),c.suspendEvents(),h=0;h<d.length;h++){var m=d[h];D(m.parent)||(m.parent=u,Et(m)),c.add(m)}c.resumeEvents(),t?A.remove(T.id):T.lastUpdated=n;var g=c.computeAvailability(),_=g.start,v=g.stop,y=I.equals(_,O.MINIMUM_VALUE),b=I.equals(v,O.MAXIMUM_VALUE);if(!y||!b){var C=S._clock;C.startTime===_&&C.stopTime===v||(C.startTime=_,C.stopTime=v,S._changed.raiseEvent(S))}T.updating=!1,T.needsUpdate=!1,S._refresh.raiseEvent(S,x.getUrlComponent(!0))}function w(e){c.remove(e);for(var t=e._children,r=t.length,i=0;i<r;++i)w(t[i])}})).otherwise(function(e){var t="NetworkLink "+r.href+" refresh failed: "+e;console.log(t),a._error.raiseEvent(a,t)}),c=!0}}var S,T,E,A,x;u.set(r.id,r)}}),c&&(this._networkLinks=u,this._changed.raiseEvent(this)),!0},Tt}),define("DataSources/Visualizer",["../Core/DeveloperError"],function(e){"use strict";function t(){e.throwInstantiationError()}return t.prototype.update=e.throwInstantiationError,t.prototype.getBoundingSphere=e.throwInstantiationError,t.prototype.isDestroyed=e.throwInstantiationError,t.prototype.destroy=e.throwInstantiationError,t}),define("Renderer/ClearCommand",["../Core/Color","../Core/defaultValue","../Core/freezeObject"],function(e,t,r){"use strict";function i(e){e=t(e,t.EMPTY_OBJECT),this.color=e.color,this.depth=e.depth,this.stencil=e.stencil,this.renderState=e.renderState,this.framebuffer=e.framebuffer,this.owner=e.owner,this.pass=e.pass}return i.ALL=r(new i({color:new e(0,0,0,0),depth:1,stencil:0})),i.prototype.execute=function(e,t){e.clear(this,t)},i}),define("Renderer/ComputeCommand",["../Core/defaultValue","./Pass"],function(t,r){"use strict";function e(e){e=t(e,t.EMPTY_OBJECT),this.vertexArray=e.vertexArray,this.fragmentShaderSource=e.fragmentShaderSource,this.shaderProgram=e.shaderProgram,this.uniformMap=e.uniformMap,this.outputTexture=e.outputTexture,this.preExecute=e.preExecute,this.postExecute=e.postExecute,this.persists=t(e.persists,!1),this.pass=r.COMPUTE,this.owner=e.owner}return e.prototype.execute=function(e){e.execute(this)},e}),define("Shaders/ViewportQuadVS",[],function(){"use strict";return"attribute vec4 position;\nattribute vec2 textureCoordinates;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\ngl_Position = position;\nv_textureCoordinates = textureCoordinates;\n}\n"}),define("Renderer/ComputeEngine",["../Core/BoundingRectangle","../Core/Check","../Core/Color","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/PrimitiveType","../Shaders/ViewportQuadVS","./ClearCommand","./DrawCommand","./Framebuffer","./RenderState","./ShaderProgram"],function(g,_,e,v,t,y,r,b,i,n,C,w,S){"use strict";function o(e){this._context=e}var T,E=new n({primitiveType:r.TRIANGLES}),A=new i({color:new e(0,0,0,0)});return o.prototype.execute=function(e){if(_.defined("computeCommand",e),v(e.preExecute)&&e.preExecute(e),!v(e.fragmentShaderSource)&&!v(e.shaderProgram))throw new y("computeCommand.fragmentShaderSource or computeCommand.shaderProgram is required.");_.defined("computeCommand.outputTexture",e.outputTexture);var t,r,i,n,o=e.outputTexture,a=o.width,s=o.height,l=this._context,u=v(e.vertexArray)?e.vertexArray:l.getViewportQuadVertexArray(),c=v(e.shaderProgram)?e.shaderProgram:(t=l,r=e.fragmentShaderSource,S.fromCache({context:t,vertexShaderSource:b,fragmentShaderSource:r,attributeLocations:{position:0,textureCoordinates:1}})),d=new C({context:l,colorTextures:[o],destroyAttachments:!1}),h=(i=a,n=s,v(T)&&T.viewport.width===i&&T.viewport.height===n||(T=w.fromCache({viewport:new g(0,0,i,n)})),T),p=e.uniformMap,f=A;f.framebuffer=d,f.renderState=h,f.execute(l);var m=E;m.vertexArray=u,m.renderState=h,m.shaderProgram=c,m.uniformMap=p,m.framebuffer=d,m.execute(l),d.destroy(),e.persists||(c.destroy(),v(e.vertexArray)&&u.destroy()),v(e.postExecute)&&e.postExecute(o)},o.prototype.isDestroyed=function(){return!1},o.prototype.destroy=function(){return t(this)},o}),define("Renderer/PassState",[],function(){"use strict";return function(e){this.context=e,this.framebuffer=void 0,this.blendingEnabled=void 0,this.scissorTest=void 0,this.viewport=void 0}}),define("Renderer/RenderbufferFormat",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={RGBA4:t.RGBA4,RGB5_A1:t.RGB5_A1,RGB565:t.RGB565,DEPTH_COMPONENT16:t.DEPTH_COMPONENT16,STENCIL_INDEX8:t.STENCIL_INDEX8,DEPTH_STENCIL:t.DEPTH_STENCIL,validate:function(e){return e===r.RGBA4||e===r.RGB5_A1||e===r.RGB565||e===r.DEPTH_COMPONENT16||e===r.STENCIL_INDEX8||e===r.DEPTH_STENCIL}};return e(r)}),define("Renderer/Renderbuffer",["../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","./ContextLimits","./RenderbufferFormat"],function(a,s,l,e,t,u,c,d){"use strict";function r(e){e=s(e,s.EMPTY_OBJECT),a.defined("options.context",e.context);var t=e.context._gl,r=c.maximumRenderbufferSize,i=s(e.format,d.RGBA4),n=l(e.width)?e.width:t.drawingBufferWidth,o=l(e.height)?e.height:t.drawingBufferHeight;if(!d.validate(i))throw new u("Invalid format.");if(a.typeOf.number.greaterThan("width",n,0),r<n)throw new u("Width must be less than or equal to the maximum renderbuffer size ("+r+").  Check maximumRenderbufferSize.");if(a.typeOf.number.greaterThan("height",o,0),r<o)throw new u("Height must be less than or equal to the maximum renderbuffer size ("+r+").  Check maximumRenderbufferSize.");this._gl=t,this._format=i,this._width=n,this._height=o,this._renderbuffer=this._gl.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this._renderbuffer),t.renderbufferStorage(t.RENDERBUFFER,i,n,o),t.bindRenderbuffer(t.RENDERBUFFER,null)}return e(r.prototype,{format:{get:function(){return this._format}},width:{get:function(){return this._width}},height:{get:function(){return this._height}}}),r.prototype._getRenderbuffer=function(){return this._renderbuffer},r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return this._gl.deleteRenderbuffer(this._renderbuffer),t(this)},r}),define("Renderer/PickFramebuffer",["../Core/BoundingRectangle","../Core/Color","../Core/defaultValue","../Core/defined","../Core/destroyObject","./Framebuffer","./PassState","./Renderbuffer","./RenderbufferFormat","./Texture"],function(n,_,v,y,e,o,r,a,s,l){"use strict";function t(e){var t=new r(e);t.blendingEnabled=!1,t.scissorTest={enabled:!0,rectangle:new n},t.viewport=new n,this._context=e,this._fb=void 0,this._passState=t,this._width=0,this._height=0}t.prototype.begin=function(e){var t=this._context,r=t.drawingBufferWidth,i=t.drawingBufferHeight;return n.clone(e,this._passState.scissorTest.rectangle),y(this._fb)&&this._width===r&&this._height===i||(this._width=r,this._height=i,this._fb=this._fb&&this._fb.destroy(),this._fb=new o({context:t,colorTextures:[new l({context:t,width:r,height:i})],depthStencilRenderbuffer:new a({context:t,format:s.DEPTH_STENCIL})}),this._passState.framebuffer=this._fb),this._passState.viewport.width=r,this._passState.viewport.height=i,this._passState};var b=new _;return t.prototype.end=function(e){for(var t=v(e.width,1),r=v(e.height,1),i=this._context,n=i.readPixels({x:e.x,y:e.y,width:t,height:r,framebuffer:this._fb}),o=Math.max(t,r),a=o*o,s=Math.floor(.5*t),l=Math.floor(.5*r),u=0,c=0,d=0,h=-1,p=0;p<a;++p){if(-s<=u&&u<=s&&-l<=c&&c<=l){var f=4*((l-c)*t+u+s);b.red=_.byteToFloat(n[f]),b.green=_.byteToFloat(n[f+1]),b.blue=_.byteToFloat(n[f+2]),b.alpha=_.byteToFloat(n[f+3]);var m=i.getObjectByPickColor(b);if(y(m))return m}if(u===c||u<0&&-u===c||0<u&&u===1-c){var g=d;d=-h,h=g}u+=d,c+=h}},t.prototype.isDestroyed=function(){return!1},t.prototype.destroy=function(){return this._fb=this._fb&&this._fb.destroy(),e(this)},t}),define("Renderer/ShaderCache",["../Core/defined","../Core/defineProperties","../Core/destroyObject","./ShaderProgram","./ShaderSource"],function(c,e,r,p,f){"use strict";function t(e){this._context=e,this._shaders={},this._numberOfShaders=0,this._shadersToRelease={}}function a(e,t){for(var r=t.derivedKeywords,i=r.length,n=0;n<i;++n){var o=r[n]+t.keyword;a(e,e._shaders[o])}delete e._shaders[t.keyword],t.shaderProgram.finalDestroy()}return e(t.prototype,{numberOfShaders:{get:function(){return this._numberOfShaders}}}),t.prototype.replaceShaderProgram=function(e){return c(e.shaderProgram)&&e.shaderProgram.destroy(),this.getShaderProgram(e)},t.prototype.getShaderProgram=function(e){var t=e.vertexShaderSource,r=e.fragmentShaderSource,i=e.attributeLocations;"string"==typeof t&&(t=new f({sources:[t]})),"string"==typeof r&&(r=new f({sources:[r]}));var n,o=t.createCombinedVertexShader(this._context),a=r.createCombinedFragmentShader(this._context),s=o+a+JSON.stringify(i);if(c(this._shaders[s]))n=this._shaders[s],delete this._shadersToRelease[s];else{var l=this._context,u=new p({gl:l._gl,logShaderCompilation:l.logShaderCompilation,debugShaders:l.debugShaders,vertexShaderSource:t,vertexShaderText:o,fragmentShaderSource:r,fragmentShaderText:a,attributeLocations:i});n={cache:this,shaderProgram:u,keyword:s,derivedKeywords:[],count:0},u._cachedShader=n,this._shaders[s]=n,++this._numberOfShaders}return++n.count,n.shaderProgram},t.prototype.getDerivedShaderProgram=function(e,t){var r=t+e._cachedShader.keyword,i=this._shaders[r];if(c(i))return i.shaderProgram},t.prototype.createDerivedShaderProgram=function(e,t,r){var i=e._cachedShader,n=t+i.keyword,o=r.vertexShaderSource,a=r.fragmentShaderSource,s=r.attributeLocations;"string"==typeof o&&(o=new f({sources:[o]})),"string"==typeof a&&(a=new f({sources:[a]}));var l=this._context,u=o.createCombinedVertexShader(l),c=a.createCombinedFragmentShader(l),d=new p({gl:l._gl,logShaderCompilation:l.logShaderCompilation,debugShaders:l.debugShaders,vertexShaderSource:o,vertexShaderText:u,fragmentShaderSource:a,fragmentShaderText:c,attributeLocations:s}),h={cache:this,shaderProgram:d,keyword:n,derivedKeywords:[],count:0};return i.derivedKeywords.push(t),d._cachedShader=h,this._shaders[n]=h,d},t.prototype.destroyReleasedShaderPrograms=function(){var e=this._shadersToRelease;for(var t in e){if(e.hasOwnProperty(t))a(this,e[t]),--this._numberOfShaders}this._shadersToRelease={}},t.prototype.releaseShaderProgram=function(e){if(c(e)){var t=e._cachedShader;t&&0==--t.count&&(this._shadersToRelease[t.keyword]=t)}},t.prototype.isDestroyed=function(){return!1},t.prototype.destroy=function(){var e=this._shaders;for(var t in e)e.hasOwnProperty(t)&&e[t].shaderProgram.finalDestroy();return r(this)},t}),define("Renderer/UniformState",["./Sampler","../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/EncodedCartesian3","../Core/Math","../Core/Matrix3","../Core/Matrix4","../Core/OrthographicFrustum","../Core/Simon1994PlanetaryPositions","../Core/Transforms","../Scene/SceneMode"],function(e,i,t,g,r,n,l,u,_,o,a,v,c,y,s,d,b,C){"use strict";function h(){this.globeDepthTexture=void 0,this._viewport=new i,this._viewportCartesian4=new r,this._viewportDirty=!1,this._viewportOrthographicMatrix=y.clone(y.IDENTITY),this._viewportTransformation=y.clone(y.IDENTITY),this._model=y.clone(y.IDENTITY),this._view=y.clone(y.IDENTITY),this._inverseView=y.clone(y.IDENTITY),this._projection=y.clone(y.IDENTITY),this._infiniteProjection=y.clone(y.IDENTITY),this._entireFrustum=new t,this._currentFrustum=new t,this._frustumPlanes=new r,this._frameState=void 0,this._temeToPseudoFixed=c.clone(y.IDENTITY),this._view3DDirty=!0,this._view3D=new y,this._inverseView3DDirty=!0,this._inverseView3D=new y,this._inverseModelDirty=!0,this._inverseModel=new y,this._inverseTransposeModelDirty=!0,this._inverseTransposeModel=new c,this._viewRotation=new c,this._inverseViewRotation=new c,this._viewRotation3D=new c,this._inverseViewRotation3D=new c,this._inverseProjectionDirty=!0,this._inverseProjection=new y,this._modelViewDirty=!0,this._modelView=new y,this._modelView3DDirty=!0,this._modelView3D=new y,this._modelViewRelativeToEyeDirty=!0,this._modelViewRelativeToEye=new y,this._inverseModelViewDirty=!0,this._inverseModelView=new y,this._inverseModelView3DDirty=!0,this._inverseModelView3D=new y,this._viewProjectionDirty=!0,this._viewProjection=new y,this._inverseViewProjectionDirty=!0,this._inverseViewProjection=new y,this._modelViewProjectionDirty=!0,this._modelViewProjection=new y,this._inverseModelViewProjectionDirty=!0,this._inverseModelViewProjection=new y,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewProjectionRelativeToEye=new y,this._modelViewInfiniteProjectionDirty=!0,this._modelViewInfiniteProjection=new y,this._normalDirty=!0,this._normal=new c,this._normal3DDirty=!0,this._normal3D=new c,this._inverseNormalDirty=!0,this._inverseNormal=new c,this._inverseNormal3DDirty=!0,this._inverseNormal3D=new c,this._encodedCameraPositionMCDirty=!0,this._encodedCameraPositionMC=new a,this._cameraPosition=new g,this._sunPositionWC=new g,this._sunPositionColumbusView=new g,this._sunDirectionWC=new g,this._sunDirectionEC=new g,this._moonDirectionEC=new g,this._pass=void 0,this._mode=void 0,this._mapProjection=void 0,this._cameraDirection=new g,this._cameraRight=new g,this._cameraUp=new g,this._frustum2DWidth=0,this._eyeHeight2D=new t,this._resolutionScale=1,this._orthographicIn3D=!1,this._backgroundColor=new l,this._brdfLut=new e,this._environmentMap=new e,this._fogDensity=void 0,this._invertClassificationColor=void 0,this._imagerySplitPosition=0,this._pixelSizePerMeter=void 0,this._geometricToleranceOverMeter=void 0,this._minimumDisableDepthTestDistance=void 0}o(h.prototype,{frameState:{get:function(){return this._frameState}},viewport:{get:function(){return this._viewport},set:function(e){if(!i.equals(e,this._viewport)){i.clone(e,this._viewport);var t=this._viewport,r=this._viewportCartesian4;r.x=t.x,r.y=t.y,r.z=t.width,r.w=t.height,this._viewportDirty=!0}}},viewportCartesian4:{get:function(){return this._viewportCartesian4}},viewportOrthographic:{get:function(){return m(this),this._viewportOrthographicMatrix}},viewportTransformation:{get:function(){return m(this),this._viewportTransformation}},model:{get:function(){return this._model},set:function(e){y.clone(e,this._model),this._modelView3DDirty=!0,this._inverseModelView3DDirty=!0,this._inverseModelDirty=!0,this._inverseTransposeModelDirty=!0,this._modelViewDirty=!0,this._inverseModelViewDirty=!0,this._modelViewRelativeToEyeDirty=!0,this._inverseModelViewDirty=!0,this._modelViewProjectionDirty=!0,this._inverseModelViewProjectionDirty=!0,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewInfiniteProjectionDirty=!0,this._normalDirty=!0,this._inverseNormalDirty=!0,this._normal3DDirty=!0,this._inverseNormal3DDirty=!0,this._encodedCameraPositionMCDirty=!0}},inverseModel:{get:function(){return this._inverseModelDirty&&(this._inverseModelDirty=!1,y.inverse(this._model,this._inverseModel)),this._inverseModel}},inverseTransposeModel:{get:function(){var e=this._inverseTransposeModel;return this._inverseTransposeModelDirty&&(this._inverseTransposeModelDirty=!1,y.getRotation(this.inverseModel,e),c.transpose(e,e)),e}},view:{get:function(){return this._view}},view3D:{get:function(){return I(this),this._view3D}},viewRotation:{get:function(){return I(this),this._viewRotation}},viewRotation3D:{get:function(){return I(this),this._viewRotation3D}},inverseView:{get:function(){return this._inverseView}},inverseView3D:{get:function(){return M(this),this._inverseView3D}},inverseViewRotation:{get:function(){return this._inverseViewRotation}},inverseViewRotation3D:{get:function(){return M(this),this._inverseViewRotation3D}},projection:{get:function(){return this._projection}},inverseProjection:{get:function(){var e;return(e=this)._inverseProjectionDirty&&(e._inverseProjectionDirty=!1,e._mode===C.SCENE2D||e._mode===C.MORPHING||e._orthographicIn3D?y.clone(y.ZERO,e._inverseProjection):y.inverse(e._projection,e._inverseProjection)),this._inverseProjection}},infiniteProjection:{get:function(){return this._infiniteProjection}},modelView:{get:function(){var e;return(e=this)._modelViewDirty&&(e._modelViewDirty=!1,y.multiplyTransformation(e._view,e._model,e._modelView)),this._modelView}},modelView3D:{get:function(){var e;return(e=this)._modelView3DDirty&&(e._modelView3DDirty=!1,y.multiplyTransformation(e.view3D,e._model,e._modelView3D)),this._modelView3D}},modelViewRelativeToEye:{get:function(){return function(e){if(e._modelViewRelativeToEyeDirty){e._modelViewRelativeToEyeDirty=!1;var t=e.modelView,r=e._modelViewRelativeToEye;r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=0,r[13]=0,r[14]=0,r[15]=t[15]}}(this),this._modelViewRelativeToEye}},inverseModelView:{get:function(){var e;return(e=this)._inverseModelViewDirty&&(e._inverseModelViewDirty=!1,y.inverse(e.modelView,e._inverseModelView)),this._inverseModelView}},inverseModelView3D:{get:function(){var e;return(e=this)._inverseModelView3DDirty&&(e._inverseModelView3DDirty=!1,y.inverse(e.modelView3D,e._inverseModelView3D)),this._inverseModelView3D}},viewProjection:{get:function(){var e;return(e=this)._viewProjectionDirty&&(e._viewProjectionDirty=!1,y.multiply(e._projection,e._view,e._viewProjection)),this._viewProjection}},inverseViewProjection:{get:function(){var e;return(e=this)._inverseViewProjectionDirty&&(e._inverseViewProjectionDirty=!1,y.inverse(e.viewProjection,e._inverseViewProjection)),this._inverseViewProjection}},modelViewProjection:{get:function(){var e;return(e=this)._modelViewProjectionDirty&&(e._modelViewProjectionDirty=!1,y.multiply(e._projection,e.modelView,e._modelViewProjection)),this._modelViewProjection}},inverseModelViewProjection:{get:function(){var e;return(e=this)._inverseModelViewProjectionDirty&&(e._inverseModelViewProjectionDirty=!1,y.inverse(e.modelViewProjection,e._inverseModelViewProjection)),this._inverseModelViewProjection}},modelViewProjectionRelativeToEye:{get:function(){var e;return(e=this)._modelViewProjectionRelativeToEyeDirty&&(e._modelViewProjectionRelativeToEyeDirty=!1,y.multiply(e._projection,e.modelViewRelativeToEye,e._modelViewProjectionRelativeToEye)),this._modelViewProjectionRelativeToEye}},modelViewInfiniteProjection:{get:function(){var e;return(e=this)._modelViewInfiniteProjectionDirty&&(e._modelViewInfiniteProjectionDirty=!1,y.multiply(e._infiniteProjection,e.modelView,e._modelViewInfiniteProjection)),this._modelViewInfiniteProjection}},normal:{get:function(){return function(e){if(e._normalDirty){e._normalDirty=!1;var t=e._normal;y.getRotation(e.inverseModelView,t),c.transpose(t,t)}}(this),this._normal}},normal3D:{get:function(){return function(e){if(e._normal3DDirty){e._normal3DDirty=!1;var t=e._normal3D;y.getRotation(e.inverseModelView3D,t),c.transpose(t,t)}}(this),this._normal3D}},inverseNormal:{get:function(){var e;return(e=this)._inverseNormalDirty&&(e._inverseNormalDirty=!1,y.getRotation(e.inverseModelView,e._inverseNormal)),this._inverseNormal}},inverseNormal3D:{get:function(){var e;return(e=this)._inverseNormal3DDirty&&(e._inverseNormal3DDirty=!1,y.getRotation(e.inverseModelView3D,e._inverseNormal3D)),this._inverseNormal3D}},entireFrustum:{get:function(){return this._entireFrustum}},currentFrustum:{get:function(){return this._currentFrustum}},frustumPlanes:{get:function(){return this._frustumPlanes}},eyeHeight2D:{get:function(){return this._eyeHeight2D}},sunPositionWC:{get:function(){return this._sunPositionWC}},sunPositionColumbusView:{get:function(){return this._sunPositionColumbusView}},sunDirectionWC:{get:function(){return this._sunDirectionWC}},sunDirectionEC:{get:function(){return this._sunDirectionEC}},moonDirectionEC:{get:function(){return this._moonDirectionEC}},encodedCameraPositionMCHigh:{get:function(){return S(this),this._encodedCameraPositionMC.high}},encodedCameraPositionMCLow:{get:function(){return S(this),this._encodedCameraPositionMC.low}},temeToPseudoFixedMatrix:{get:function(){return this._temeToPseudoFixed}},resolutionScale:{get:function(){return this._resolutionScale}},fogDensity:{get:function(){return this._fogDensity}},geometricToleranceOverMeter:{get:function(){return this._geometricToleranceOverMeter}},pass:{get:function(){return this._pass}},backgroundColor:{get:function(){return this._backgroundColor}},brdfLut:{get:function(){return this._brdfLut}},environmentMap:{get:function(){return this._environmentMap}},imagerySplitPosition:{get:function(){return this._imagerySplitPosition}},minimumDisableDepthTestDistance:{get:function(){return this._minimumDisableDepthTestDistance}},invertClassificationColor:{get:function(){return this._invertClassificationColor}}});var p=new c,f=new n;function m(e){if(e._viewportDirty){var t=e._viewport;y.computeOrthographicOffCenter(t.x,t.x+t.width,t.y,t.y+t.height,0,1,e._viewportOrthographicMatrix),y.computeViewportTransformation(t,0,1,e._viewportTransformation),e._viewportDirty=!1}}h.prototype.updateCamera=function(e){var t,r,i,n,o,a;t=this,r=e.viewMatrix,y.clone(r,t._view),y.getRotation(r,t._viewRotation),t._view3DDirty=!0,t._inverseView3DDirty=!0,t._modelViewDirty=!0,t._modelView3DDirty=!0,t._modelViewRelativeToEyeDirty=!0,t._inverseModelViewDirty=!0,t._inverseModelView3DDirty=!0,t._viewProjectionDirty=!0,t._inverseViewProjectionDirty=!0,t._modelViewProjectionDirty=!0,t._modelViewProjectionRelativeToEyeDirty=!0,t._modelViewInfiniteProjectionDirty=!0,t._normalDirty=!0,t._inverseNormalDirty=!0,t._normal3DDirty=!0,t._inverseNormal3DDirty=!0,i=this,n=e.inverseViewMatrix,y.clone(n,i._inverseView),y.getRotation(n,i._inverseViewRotation),o=this,a=e,g.clone(a.positionWC,o._cameraPosition),g.clone(a.directionWC,o._cameraDirection),g.clone(a.rightWC,o._cameraRight),g.clone(a.upWC,o._cameraUp),o._encodedCameraPositionMCDirty=!0,this._entireFrustum.x=e.frustum.near,this._entireFrustum.y=e.frustum.far,this.updateFrustum(e.frustum),this._orthographicIn3D=this._mode!==C.SCENE2D&&e.frustum instanceof s},h.prototype.updateFrustum=function(e){var t,r,i,n;t=this,r=e.projectionMatrix,y.clone(r,t._projection),t._inverseProjectionDirty=!0,t._viewProjectionDirty=!0,t._inverseViewProjectionDirty=!0,t._modelViewProjectionDirty=!0,t._modelViewProjectionRelativeToEyeDirty=!0,_(e.infiniteProjectionMatrix)&&(i=this,n=e.infiniteProjectionMatrix,y.clone(n,i._infiniteProjection),i._modelViewInfiniteProjectionDirty=!0),this._currentFrustum.x=e.near,this._currentFrustum.y=e.far,_(e._offCenterFrustum)&&(e=e._offCenterFrustum),this._frustumPlanes.x=e.top,this._frustumPlanes.y=e.bottom,this._frustumPlanes.z=e.left,this._frustumPlanes.w=e.right},h.prototype.updatePass=function(e){this._pass=e},h.prototype.update=function(e){this._mode=e.mode,this._mapProjection=e.mapProjection;var t=e.context._canvas;this._resolutionScale=t.width/t.clientWidth;var r=e.camera;this.updateCamera(r),e.mode===C.SCENE2D?(this._frustum2DWidth=r.frustum.right-r.frustum.left,this._eyeHeight2D.x=.5*this._frustum2DWidth,this._eyeHeight2D.y=this._eyeHeight2D.x*this._eyeHeight2D.x):(this._frustum2DWidth=0,this._eyeHeight2D.x=0,this._eyeHeight2D.y=0),function(e,t){_(b.computeIcrfToFixedMatrix(t.time,p))||(p=b.computeTemeToPseudoFixedMatrix(t.time,p));var r=d.computeSunPositionInEarthInertialFrame(t.time,e._sunPositionWC);c.multiplyByVector(p,r,r),g.normalize(r,e._sunDirectionWC),r=c.multiplyByVector(e.viewRotation3D,r,e._sunDirectionEC),g.normalize(r,r),r=d.computeMoonPositionInEarthInertialFrame(t.time,e._moonDirectionEC),c.multiplyByVector(p,r,r),c.multiplyByVector(e.viewRotation3D,r,r),g.normalize(r,r);var i=t.mapProjection,n=i.ellipsoid.cartesianToCartographic(e._sunPositionWC,f);i.project(n,e._sunPositionColumbusView)}(this,e);var i=e.brdfLutGenerator,n=_(i)?i.colorTexture:void 0;this._brdfLut=n,this._environmentMap=u(e.environmentMap,e.context.defaultCubeMap),this._fogDensity=e.fog.density,this._invertClassificationColor=e.invertClassificationColor,this._frameState=e,this._temeToPseudoFixed=b.computeTemeToPseudoFixedMatrix(e.time,this._temeToPseudoFixed),this._imagerySplitPosition=e.imagerySplitPosition*e.context.drawingBufferWidth;var o,a=r.frustum.fov,s=this._viewport;o=s.height>s.width?2*Math.tan(.5*a)/s.height:2*Math.tan(.5*a)/s.width,this._geometricToleranceOverMeter=o*e.maximumScreenSpaceError,l.clone(e.backgroundColor,this._backgroundColor),this._minimumDisableDepthTestDistance=e.minimumDisableDepthTestDistance,this._minimumDisableDepthTestDistance*=this._minimumDisableDepthTestDistance,this._minimumDisableDepthTestDistance===Number.POSITIVE_INFINITY&&(this._minimumDisableDepthTestDistance=-1)};var w=new g;function S(e){e._encodedCameraPositionMCDirty&&(e._encodedCameraPositionMCDirty=!1,y.multiplyByPoint(e.inverseModel,e._cameraPosition,w),a.fromCartesian(w,e._encodedCameraPositionMC))}var T=new g,E=new g,A=new g,x=new g,P=new n,D=new g,O=new y;function I(e){e._view3DDirty&&(e._mode===C.SCENE3D?y.clone(e._view,e._view3D):function(e,t,r,i,n,o,a,s){var l=T;l.x=e.y,l.y=e.z,l.z=e.x;var u=E;u.x=r.y,u.y=r.z,u.z=r.x;var c=A;c.x=i.y,c.y=i.z,c.z=i.x;var d=x;d.x=t.y,d.y=t.z,d.z=t.x,o===C.SCENE2D&&(l.z=.5*n);var h=a.unproject(l,P);h.longitude=v.clamp(h.longitude,-Math.PI,Math.PI),h.latitude=v.clamp(h.latitude,-v.PI_OVER_TWO,v.PI_OVER_TWO);var p=a.ellipsoid,f=p.cartographicToCartesian(h,D),m=b.eastNorthUpToFixedFrame(f,p,O);y.multiplyByPointAsVector(m,u,u),y.multiplyByPointAsVector(m,c,c),y.multiplyByPointAsVector(m,d,d),_(s)||(s=new y),s[0]=u.x,s[1]=c.x,s[2]=-d.x,s[3]=0,s[4]=u.y,s[5]=c.y,s[6]=-d.y,s[7]=0,s[8]=u.z,s[9]=c.z,s[10]=-d.z,s[11]=0,s[12]=-g.dot(u,f),s[13]=-g.dot(c,f),s[14]=g.dot(d,f),s[15]=1}(e._cameraPosition,e._cameraDirection,e._cameraRight,e._cameraUp,e._frustum2DWidth,e._mode,e._mapProjection,e._view3D),y.getRotation(e._view3D,e._viewRotation3D),e._view3DDirty=!1)}function M(e){e._inverseView3DDirty&&(y.inverseTransformation(e.view3D,e._inverseView3D),y.getRotation(e._inverseView3D,e._inverseViewRotation3D),e._inverseView3DDirty=!1)}return h}),define("Renderer/Context",["../Core/Check","../Core/clone","../Core/Color","../Core/ComponentDatatype","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Geometry","../Core/GeometryAttribute","../Core/Matrix4","../Core/PrimitiveType","../Core/RuntimeError","../Core/WebGLConstants","../Shaders/ViewportQuadVS","./BufferUsage","./ClearCommand","./ContextLimits","./CubeMap","./DrawCommand","./PassState","./PickFramebuffer","./RenderState","./ShaderCache","./ShaderProgram","./Texture","./UniformState","./VertexArray"],function(D,O,I,r,M,R,L,e,i,l,n,o,u,c,N,k,a,s,t,F,d,h,B,p,U,V,f,m,z,g){"use strict";function _(e,t,r){var i=e.getError();if(i!==e.NO_ERROR)throw new N(function(e,t,r,i){for(var n=function(e,t){var r="WebGL Error:  ";switch(t){case e.INVALID_ENUM:r+="INVALID_ENUM";break;case e.INVALID_VALUE:r+="INVALID_VALUE";break;case e.INVALID_OPERATION:r+="INVALID_OPERATION";break;case e.OUT_OF_MEMORY:r+="OUT_OF_MEMORY";break;case e.CONTEXT_LOST_WEBGL:r+="CONTEXT_LOST_WEBGL lost";break;default:r+="Unknown ("+t+")"}return r}(e,i)+": "+t.name+"(",o=0;o<r.length;++o)0!==o&&(n+=", "),n+=r[o];return n+=");"}(e,t,r,i))}function v(t,r,i){return{get:function(){var e=t[r];return i(t,"get: "+r,e),t[r]},set:function(e){t[r]=e,i(t,"set: "+r,e)}}}function q(e,t){for(var r=t.length,i=0;i<r;++i){var n=e.getExtension(t[i]);if(n)return n}}function y(e,t){if("undefined"==typeof WebGLRenderingContext)throw new N("The browser does not support WebGL.  Visit http://get.webgl.org.");D.defined("canvas",e),this._canvas=e,t=O(t,!0),(t=R(t,{})).allowTextureFilterAnisotropic=R(t.allowTextureFilterAnisotropic,!0);var r=R(t.webgl,{});r.alpha=R(r.alpha,!1),r.stencil=R(r.stencil,!0);var i,n=R(t.requestWebgl2,!1)&&"undefined"!=typeof WebGL2RenderingContext,o=!1,a=t.getWebGLStub;if(L(a))i=a(e,r);else if(n&&(i=e.getContext("webgl2",r)||e.getContext("experimental-webgl2",r)||void 0,L(i)&&(o=!0)),L(i)||(i=e.getContext("webgl",r)||e.getContext("experimental-webgl",r)||void 0),!L(i))throw new N("The browser supports WebGL, but initialization failed.");this._originalGLContext=i,this._gl=i,this._webgl2=o,this._id=M(),this.validateFramebuffer=!1,this.validateShaderProgram=!1,this.logShaderCompilation=!1,this._throwOnWebGLError=!1,this._shaderCache=new V(this);var s=i;this._stencilBits=s.getParameter(s.STENCIL_BITS),F._maximumCombinedTextureImageUnits=s.getParameter(s.MAX_COMBINED_TEXTURE_IMAGE_UNITS),F._maximumCubeMapSize=s.getParameter(s.MAX_CUBE_MAP_TEXTURE_SIZE),F._maximumFragmentUniformVectors=s.getParameter(s.MAX_FRAGMENT_UNIFORM_VECTORS),F._maximumTextureImageUnits=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),F._maximumRenderbufferSize=s.getParameter(s.MAX_RENDERBUFFER_SIZE),F._maximumTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),F._maximumVaryingVectors=s.getParameter(s.MAX_VARYING_VECTORS),F._maximumVertexAttributes=s.getParameter(s.MAX_VERTEX_ATTRIBS),F._maximumVertexTextureImageUnits=s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS),F._maximumVertexUniformVectors=s.getParameter(s.MAX_VERTEX_UNIFORM_VECTORS);var l=s.getParameter(s.ALIASED_LINE_WIDTH_RANGE);F._minimumAliasedLineWidth=l[0],F._maximumAliasedLineWidth=l[1];var u=s.getParameter(s.ALIASED_POINT_SIZE_RANGE);F._minimumAliasedPointSize=u[0],F._maximumAliasedPointSize=u[1];var c=s.getParameter(s.MAX_VIEWPORT_DIMS);F._maximumViewportWidth=c[0],F._maximumViewportHeight=c[1];var d=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT);F._highpFloatSupported=0!==d.precision;var h=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_INT);F._highpIntSupported=0!==h.rangeMax,this._antialias=s.getContextAttributes().antialias,this._standardDerivatives=!!q(s,["OES_standard_derivatives"]),this._blendMinmax=!!q(s,["EXT_blend_minmax"]),this._elementIndexUint=!!q(s,["OES_element_index_uint"]),this._depthTexture=!!q(s,["WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]),this._textureFloat=!!q(s,["OES_texture_float"]),this._fragDepth=!!q(s,["EXT_frag_depth"]),this._debugShaders=q(s,["WEBGL_debug_shaders"]),this._colorBufferFloat=this._webgl2&&!!q(s,["EXT_color_buffer_float"]),this._s3tc=!!q(s,["WEBGL_compressed_texture_s3tc","MOZ_WEBGL_compressed_texture_s3tc","WEBKIT_WEBGL_compressed_texture_s3tc"]),this._pvrtc=!!q(s,["WEBGL_compressed_texture_pvrtc","WEBKIT_WEBGL_compressed_texture_pvrtc"]),this._etc1=!!q(s,["WEBGL_compressed_texture_etc1"]);var p,f,m,g,_,v,y,b,C,w,S=t.allowTextureFilterAnisotropic?q(s,["EXT_texture_filter_anisotropic","WEBKIT_EXT_texture_filter_anisotropic"]):void 0;if(this._textureFilterAnisotropic=S,F._maximumTextureFilterAnisotropy=L(S)?s.getParameter(S.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1,o){var T=this;p=function(){return T._gl.createVertexArray()},f=function(e){T._gl.bindVertexArray(e)},m=function(e){T._gl.deleteVertexArray(e)},g=function(e,t,r,i,n){s.drawElementsInstanced(e,t,r,i,n)},_=function(e,t,r,i){s.drawArraysInstanced(e,t,r,i)},v=function(e,t){s.vertexAttribDivisor(e,t)},y=function(e){s.drawBuffers(e)}}else b=q(s,["OES_vertex_array_object"]),L(b)&&(p=function(){return b.createVertexArrayOES()},f=function(e){b.bindVertexArrayOES(e)},m=function(e){b.deleteVertexArrayOES(e)}),C=q(s,["ANGLE_instanced_arrays"]),L(C)&&(g=function(e,t,r,i,n){C.drawElementsInstancedANGLE(e,t,r,i,n)},_=function(e,t,r,i){C.drawArraysInstancedANGLE(e,t,r,i)},v=function(e,t){C.vertexAttribDivisorANGLE(e,t)}),w=q(s,["WEBGL_draw_buffers"]),L(w)&&(y=function(e){w.drawBuffersWEBGL(e)});this.glCreateVertexArray=p,this.glBindVertexArray=f,this.glDeleteVertexArray=m,this.glDrawElementsInstanced=g,this.glDrawArraysInstanced=_,this.glVertexAttribDivisor=v,this.glDrawBuffers=y,this._vertexArrayObject=!!b,this._instancedArrays=!!C,this._drawBuffers=!!w,F._maximumDrawBuffers=this.drawBuffers?s.getParameter(k.MAX_DRAW_BUFFERS):1,F._maximumColorAttachments=this.drawBuffers?s.getParameter(k.MAX_COLOR_ATTACHMENTS):1,this._clearColor=new I(0,0,0,0),this._clearDepth=1,this._clearStencil=0;var E=new z,A=new B(this),x=U.fromCache();this._defaultPassState=A,this._defaultRenderState=x,this._defaultTexture=void 0,this._defaultCubeMap=void 0,this._us=E,this._currentRenderState=x,this._currentPassState=A,this._currentFramebuffer=void 0,this._maxFrameTextureUnitIndex=0,this._vertexAttribDivisors=[],this._previousDrawInstanced=!1;for(var P=0;P<F._maximumVertexAttributes;P++)this._vertexAttribDivisors.push(0);this._pickObjects={},this._nextPickColor=new Uint32Array(1),this.options=t,this.cache={},U.apply(s,x,A)}var b,C={};function w(e,t,r,i){var n=e._currentRenderState,o=e._currentPassState;e._currentRenderState=t,e._currentPassState=r,U.partialApply(e._gl,n,t,o,r,i)}function S(e,t){if(t!==e._currentFramebuffer){e._currentFramebuffer=t;var r=b;if(L(t))t._bind(),function(e){if(e.validateFramebuffer){var t=e._gl,r=t.checkFramebufferStatus(t.FRAMEBUFFER);if(r!==t.FRAMEBUFFER_COMPLETE){var i;switch(r){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:i="Framebuffer is not complete.  Incomplete attachment: at least one attachment point with a renderbuffer or texture attached has its attached object no longer in existence or has an attached image with a width or height of zero, or the color attachment point has a non-color-renderable image attached, or the depth attachment point has a non-depth-renderable image attached, or the stencil attachment point has a non-stencil-renderable image attached.  Color-renderable formats include GL_RGBA4, GL_RGB5_A1, and GL_RGB565. GL_DEPTH_COMPONENT16 is the only depth-renderable format. GL_STENCIL_INDEX8 is the only stencil-renderable format.";break;case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:i="Framebuffer is not complete.  Incomplete dimensions: not all attached images have the same width and height.";break;case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:i="Framebuffer is not complete.  Missing attachment: no images are attached to the framebuffer.";break;case t.FRAMEBUFFER_UNSUPPORTED:i="Framebuffer is not complete.  Unsupported: the combination of internal formats of the attached images violates an implementation-dependent set of restrictions."}throw new l(i)}}}(e),r=t._getActiveColorAttachments();else{var i=e._gl;i.bindFramebuffer(i.FRAMEBUFFER,null)}e.drawBuffers&&e.glDrawBuffers(r)}}e(y.prototype,{id:{get:function(){return this._id}},webgl2:{get:function(){return this._webgl2}},canvas:{get:function(){return this._canvas}},shaderCache:{get:function(){return this._shaderCache}},uniformState:{get:function(){return this._us}},stencilBits:{get:function(){return this._stencilBits}},stencilBuffer:{get:function(){return 8<=this._stencilBits}},antialias:{get:function(){return this._antialias}},standardDerivatives:{get:function(){return this._standardDerivatives||this._webgl2}},blendMinmax:{get:function(){return this._blendMinmax||this._webgl2}},elementIndexUint:{get:function(){return this._elementIndexUint||this._webgl2}},depthTexture:{get:function(){return this._depthTexture||this._webgl2}},floatingPointTexture:{get:function(){return this._textureFloat||this._colorBufferFloat}},textureFilterAnisotropic:{get:function(){return!!this._textureFilterAnisotropic}},s3tc:{get:function(){return this._s3tc}},pvrtc:{get:function(){return this._pvrtc}},etc1:{get:function(){return this._etc1}},vertexArrayObject:{get:function(){return this._vertexArrayObject||this._webgl2}},fragmentDepth:{get:function(){return this._fragDepth||this._webgl2}},instancedArrays:{get:function(){return this._instancedArrays||this._webgl2}},colorBufferFloat:{get:function(){return this._colorBufferFloat}},drawBuffers:{get:function(){return this._drawBuffers||this._webgl2}},debugShaders:{get:function(){return this._debugShaders}},throwOnWebGLError:{get:function(){return this._throwOnWebGLError},set:function(e){this._throwOnWebGLError=e,this._gl=function(r,i){if(!L(i))return r;function e(t){return function(){var e=t.apply(r,arguments);return i(r,t,arguments),e}}var t={};for(var n in r){var o=r[n];o instanceof Function?t[n]=e(o):Object.defineProperty(t,n,v(r,n,i))}return t}(this._originalGLContext,e?_:void 0)}},defaultTexture:{get:function(){return void 0===this._defaultTexture&&(this._defaultTexture=new m({context:this,source:{width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])}})),this._defaultTexture}},defaultCubeMap:{get:function(){if(void 0===this._defaultCubeMap){var e={width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])};this._defaultCubeMap=new d({context:this,source:{positiveX:e,negativeX:e,positiveY:e,negativeY:e,positiveZ:e,negativeZ:e}})}return this._defaultCubeMap}},drawingBufferHeight:{get:function(){return this._gl.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._gl.drawingBufferWidth}},defaultFramebuffer:{get:function(){return C}}}),"undefined"!=typeof WebGLRenderingContext&&(b=[k.BACK]);var T=new t;y.prototype.clear=function(e,t){e=R(e,T),t=R(t,this._defaultPassState);var r=this._gl,i=0,n=e.color,o=e.depth,a=e.stencil;L(n)&&(I.equals(this._clearColor,n)||(I.clone(n,this._clearColor),r.clearColor(n.red,n.green,n.blue,n.alpha)),i|=r.COLOR_BUFFER_BIT),L(o)&&(o!==this._clearDepth&&(this._clearDepth=o,r.clearDepth(o)),i|=r.DEPTH_BUFFER_BIT),L(a)&&(a!==this._clearStencil&&(this._clearStencil=a,r.clearStencil(a)),i|=r.STENCIL_BUFFER_BIT),w(this,R(e.renderState,this._defaultRenderState),t,!0),S(this,R(e.framebuffer,t.framebuffer)),r.clear(i)},y.prototype.draw=function(e,t){D.defined("drawCommand",e),D.defined("drawCommand.shaderProgram",e._shaderProgram),t=R(t,this._defaultPassState),function(e,t,r,i){var n=R(r._renderState,e._defaultRenderState);if(L(t)&&n.depthTest&&n.depthTest.enabled&&!t.hasDepthAttachment)throw new l("The depth test can not be enabled (drawCommand.renderState.depthTest.enabled) because the framebuffer (drawCommand.framebuffer) does not have a depth or depth-stencil renderbuffer.");S(e,t),w(e,n,i,!1);var o=r._shaderProgram;o._bind(),e._maxFrameTextureUnitIndex=Math.max(e._maxFrameTextureUnitIndex,o.maximumTextureUnitIndex)}(this,R(e._framebuffer,t.framebuffer),e,t),function(e,t){var r=t._primitiveType,i=t._vertexArray,n=t._offset,o=t._count,a=t.instanceCount;if(!c.validate(r))throw new l("drawCommand.primitiveType is required and must be valid.");if(D.defined("drawCommand.vertexArray",i),D.typeOf.number.greaterThanOrEquals("drawCommand.offset",n,0),L(o)&&D.typeOf.number.greaterThanOrEquals("drawCommand.count",o,0),D.typeOf.number.greaterThanOrEquals("drawCommand.instanceCount",a,0),0<a&&!e.instancedArrays)throw new l("Instanced arrays extension is not supported");e._us.model=R(t._modelMatrix,u.IDENTITY),t._shaderProgram._setUniforms(t._uniformMap,e._us,e.validateShaderProgram),i._bind();var s=i.indexBuffer;L(s)?(n*=s.bytesPerIndex,o=R(o,s.numberOfIndices),0===a?e._gl.drawElements(r,o,s.indexDatatype,n):e.glDrawElementsInstanced(r,o,s.indexDatatype,n,a)):(o=R(o,i.numberOfVertices),0===a?e._gl.drawArrays(r,n,o):e.glDrawArraysInstanced(r,n,o,a)),i._unBind()}(this,e)},y.prototype.endFrame=function(){var e=this._gl;e.useProgram(null),this._currentFramebuffer=void 0,e.bindFramebuffer(e.FRAMEBUFFER,null);var t=b;this.drawBuffers&&this.glDrawBuffers(t);for(var r=this._maxFrameTextureUnitIndex,i=this._maxFrameTextureUnitIndex=0;i<r;++i)e.activeTexture(e.TEXTURE0+i),e.bindTexture(e.TEXTURE_2D,null),e.bindTexture(e.TEXTURE_CUBE_MAP,null)},y.prototype.readPixels=function(e){var t=this._gl;e=e||{};var r=Math.max(e.x||0,0),i=Math.max(e.y||0,0),n=e.width||t.drawingBufferWidth,o=e.height||t.drawingBufferHeight,a=e.framebuffer;D.typeOf.number.greaterThan("readState.width",n,0),D.typeOf.number.greaterThan("readState.height",o,0);var s=new Uint8Array(4*n*o);return S(this,a),t.readPixels(r,i,n,o,t.RGBA,t.UNSIGNED_BYTE,s),s};var E={position:0,textureCoordinates:1};function A(e,t,r){this._pickObjects=e,this.key=t,this.color=r}return y.prototype.getViewportQuadVertexArray=function(){var e=this.cache.viewportQuad_vertexArray;if(!L(e)){var t=new n({attributes:{position:new o({componentDatatype:r.FLOAT,componentsPerAttribute:2,values:[-1,-1,1,-1,1,1,-1,1]}),textureCoordinates:new o({componentDatatype:r.FLOAT,componentsPerAttribute:2,values:[0,0,1,0,1,1,0,1]})},indices:new Uint16Array([0,1,2,0,2,3]),primitiveType:c.TRIANGLES});e=g.fromGeometry({context:this,geometry:t,attributeLocations:E,bufferUsage:s.STATIC_DRAW,interleave:!0}),this.cache.viewportQuad_vertexArray=e}return e},y.prototype.createViewportQuadCommand=function(e,t){return t=R(t,R.EMPTY_OBJECT),new h({vertexArray:this.getViewportQuadVertexArray(),primitiveType:c.TRIANGLES,renderState:t.renderState,shaderProgram:f.fromCache({context:this,vertexShaderSource:a,fragmentShaderSource:e,attributeLocations:E}),uniformMap:t.uniformMap,owner:t.owner,framebuffer:t.framebuffer,pass:t.pass})},y.prototype.createPickFramebuffer=function(){return new p(this)},y.prototype.getObjectByPickColor=function(e){return D.defined("pickColor",e),this._pickObjects[e.toRgba()]},e(A.prototype,{object:{get:function(){return this._pickObjects[this.key]},set:function(e){this._pickObjects[this.key]=e}}}),A.prototype.destroy=function(){delete this._pickObjects[this.key]},y.prototype.createPickId=function(e){D.defined("object",e),++this._nextPickColor[0];var t=this._nextPickColor[0];if(0===t)throw new N("Out of unique Pick IDs.");return this._pickObjects[t]=e,new A(this._pickObjects,t,I.fromRgba(t))},y.prototype.isDestroyed=function(){return!1},y.prototype.destroy=function(){var e=this.cache;for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];L(r.destroy)&&r.destroy()}return this._shaderCache=this._shaderCache.destroy(),this._defaultTexture=this._defaultTexture&&this._defaultTexture.destroy(),this._defaultCubeMap=this._defaultCubeMap&&this._defaultCubeMap.destroy(),i(this)},y}),define("Renderer/loadCubeMap",["../Core/Check","../Core/defined","../Core/DeveloperError","../Core/Resource","../ThirdParty/when","./CubeMap"],function(i,n,o,a,s,l){"use strict";return function(t,e){if(i.defined("context",t),!(n(e)&&n(e.positiveX)&&n(e.negativeX)&&n(e.positiveY)&&n(e.negativeY)&&n(e.positiveZ)&&n(e.negativeZ)))throw new o("urls is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.");var r=[a.createIfNeeded(e.positiveX).fetchImage(),a.createIfNeeded(e.negativeX).fetchImage(),a.createIfNeeded(e.positiveY).fetchImage(),a.createIfNeeded(e.negativeY).fetchImage(),a.createIfNeeded(e.positiveZ).fetchImage(),a.createIfNeeded(e.negativeZ).fetchImage()];return s.all(r,function(e){return new l({context:t,source:{positiveX:e[0],negativeX:e[1],positiveY:e[2],negativeY:e[3],positiveZ:e[4],negativeZ:e[5]}})})}}),define("Scene/DiscardMissingTileImagePolicy",["../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/getImagePixels","../Core/Resource","../ThirdParty/when"],function(t,d,h,p,r,i){"use strict";function e(l){if(l=t(l,t.EMPTY_OBJECT),!d(l.missingImageUrl))throw new h("options.missingImageUrl is required.");if(!d(l.pixelsToCheck))throw new h("options.pixelsToCheck is required.");this._pixelsToCheck=l.pixelsToCheck,this._missingImagePixels=void 0,this._missingImageByteLength=void 0,this._isReady=!1;var e=r.createIfNeeded(l.missingImageUrl),u=this;i(e.fetchImage(!0),function(e){d(e.blob)&&(u._missingImageByteLength=e.blob.size);var t=p(e);if(l.disableCheckIfAllPixelsAreTransparent){for(var r=!0,i=e.width,n=l.pixelsToCheck,o=0,a=n.length;r&&o<a;++o){var s=n[o];0<t[4*s.x+s.y*i+3]&&(r=!1)}r&&(t=void 0)}u._missingImagePixels=t,u._isReady=!0},function(){u._missingImagePixels=void 0,u._isReady=!0})}return e.prototype.isReady=function(){return this._isReady},e.prototype.shouldDiscardImage=function(e){if(!this._isReady)throw new h("shouldDiscardImage must not be called before the discard policy is ready.");var t=this._pixelsToCheck,r=this._missingImagePixels;if(!d(r))return!1;if(d(e.blob)&&e.blob.size!==this._missingImageByteLength)return!1;for(var i=p(e),n=e.width,o=0,a=t.length;o<a;++o)for(var s=t[o],l=4*s.x+s.y*n,u=0;u<4;++u){var c=l+u;if(i[c]!==r[c])return!1}return!0},e}),define("Scene/ImageryLayerFeatureInfo",["../Core/defined"],function(o){"use strict";function e(){this.name=void 0,this.description=void 0,this.position=void 0,this.data=void 0,this.imageryLayer=void 0}return e.prototype.configureNameFromProperties=function(e){var t,r=10;for(var i in e)if(e.hasOwnProperty(i)&&e[i]){var n=i.toLowerCase();1<r&&"name"===n?(r=1,t=i):2<r&&"title"===n?(r=2,t=i):3<r&&/name/i.test(i)?(r=3,t=i):4<r&&/title/i.test(i)&&(r=4,t=i)}o(t)&&(this.name=e[t])},e.prototype.configureDescriptionFromProperties=function(e){this.description=function e(t){var r='<table class="cesium-infoBox-defaultTable">';for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];o(n)&&(r+="object"==typeof n?"<tr><td>"+i+"</td><td>"+e(n)+"</td></tr>":"<tr><td>"+i+"</td><td>"+n+"</td></tr>")}return r+="</table>"}(e)},e}),define("Scene/ImageryProvider",["../Core/Check","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/DeveloperError","../Core/loadCRN","../Core/loadKTX","../Core/Resource"],function(n,o,e,a,t,s,l,u){"use strict";function r(){this.defaultAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0,t.throwInstantiationError()}e(r.prototype,{ready:{get:t.throwInstantiationError},readyPromise:{get:t.throwInstantiationError},rectangle:{get:t.throwInstantiationError},tileWidth:{get:t.throwInstantiationError},tileHeight:{get:t.throwInstantiationError},maximumLevel:{get:t.throwInstantiationError},minimumLevel:{get:t.throwInstantiationError},tilingScheme:{get:t.throwInstantiationError},tileDiscardPolicy:{get:t.throwInstantiationError},errorEvent:{get:t.throwInstantiationError},credit:{get:t.throwInstantiationError},proxy:{get:t.throwInstantiationError},hasAlphaChannel:{get:t.throwInstantiationError}}),r.prototype.getTileCredits=t.throwInstantiationError,r.prototype.requestImage=t.throwInstantiationError,r.prototype.pickFeatures=t.throwInstantiationError;var c=/\.ktx$/i,d=/\.crn$/i;return r.loadImage=function(e,t,r){n.defined("url",t),o(r)&&a("ImageryProvider.loadImage.request","The request parameter has been deprecated. Set the request property on the Resource parameter.");var i=u.createIfNeeded(t,{request:r});return c.test(i)?l(i):d.test(i)?s(i):o(e.tileDiscardPolicy)?i.fetchImage(!0):i.fetchImage()},r}),define("Scene/ArcGisMapServerImageryProvider",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/DeveloperError","../Core/Event","../Core/GeographicTilingScheme","../Core/Math","../Core/Rectangle","../Core/Resource","../Core/RuntimeError","../Core/TileProviderError","../Core/WebMercatorProjection","../Core/WebMercatorTilingScheme","../ThirdParty/when","./DiscardMissingTileImagePolicy","./ImageryLayerFeatureInfo","./ImageryProvider"],function(h,p,f,m,i,g,e,n,_,o,v,y,b,a,s,C,w,S,T,E,A,l){"use strict";function t(l){if(l=i(l,{}),!g(l.url))throw new _("options.url is required.");g(l.proxy)&&n("ArcGisMapServerImageryProvider.proxy","The options.proxy parameter has been deprecated. Specify options.url as a Resource instance and set the proxy property there.");var e=a.createIfNeeded(l.url,{proxy:l.proxy});e.appendForwardSlash(),g(l.token)&&e.addQueryParameters({token:l.token}),this._resource=e,this._tileDiscardPolicy=l.tileDiscardPolicy,this._tileWidth=i(l.tileWidth,256),this._tileHeight=i(l.tileHeight,256),this._maximumLevel=l.maximumLevel,this._tilingScheme=i(l.tilingScheme,new v({ellipsoid:l.ellipsoid})),this._credit=void 0,this._useTiles=i(l.usePreCachedTilesIfAvailable,!0),this._rectangle=i(l.rectangle,this._tilingScheme.rectangle),this._layers=l.layers,this.enablePickFeatures=i(l.enablePickFeatures,!0),this._errorEvent=new o,this._ready=!1,this._readyPromise=T.defer();var u,c=this;function t(e){var t=e.tileInfo;if(g(t)){if(c._tileWidth=t.rows,c._tileHeight=t.cols,102100===t.spatialReference.wkid||102113===t.spatialReference.wkid)c._tilingScheme=new S({ellipsoid:l.ellipsoid});else{if(4326!==e.tileInfo.spatialReference.wkid){var r="Tile spatial reference WKID "+e.tileInfo.spatialReference.wkid+" is not supported.";return void(u=C.handleError(u,c,c._errorEvent,r,void 0,void 0,void 0,d))}c._tilingScheme=new v({ellipsoid:l.ellipsoid})}if(c._maximumLevel=e.tileInfo.lods.length-1,g(e.fullExtent)){if(g(e.fullExtent.spatialReference)&&g(e.fullExtent.spatialReference.wkid))if(102100===e.fullExtent.spatialReference.wkid||102113===e.fullExtent.spatialReference.wkid){var i=new w,n=e.fullExtent,o=i.unproject(new p(Math.max(n.xmin,-c._tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.max(n.ymin,-c._tilingScheme.ellipsoid.maximumRadius*Math.PI),0)),a=i.unproject(new p(Math.min(n.xmax,c._tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.min(n.ymax,c._tilingScheme.ellipsoid.maximumRadius*Math.PI),0));c._rectangle=new b(o.longitude,o.latitude,a.longitude,a.latitude)}else{if(4326!==e.fullExtent.spatialReference.wkid){var s="fullExtent.spatialReference WKID "+e.fullExtent.spatialReference.wkid+" is not supported.";return void(u=C.handleError(u,c,c._errorEvent,s,void 0,void 0,void 0,d))}c._rectangle=b.fromDegrees(e.fullExtent.xmin,e.fullExtent.ymin,e.fullExtent.xmax,e.fullExtent.ymax)}}else c._rectangle=c._tilingScheme.rectangle;g(c._tileDiscardPolicy)||(c._tileDiscardPolicy=new E({missingImageUrl:x(c,0,0,c._maximumLevel).url,pixelsToCheck:[new h(0,0),new h(200,20),new h(20,200),new h(80,110),new h(160,130)],disableCheckIfAllPixelsAreTransparent:!0})),c._useTiles=!0}else c._useTiles=!1;g(e.copyrightText)&&0<e.copyrightText.length&&(c._credit=new m({text:e.copyrightText})),c._ready=!0,c._readyPromise.resolve(!0),C.handleSuccess(u)}function r(e){var t="An error occurred while accessing "+c._resource.url+".";u=C.handleError(u,c,c._errorEvent,t,void 0,void 0,void 0,d),c._readyPromise.reject(new s(t))}function d(){var e=c._resource.getDerivedResource({queryParameters:{f:"json"}}).fetchJsonp();T(e,t,r)}this._useTiles?d():(this._ready=!0,this._readyPromise.resolve(!0))}function x(e,t,r,i,n){var o;if(e._useTiles)o=e._resource.getDerivedResource({url:"tile/"+i+"/"+r+"/"+t,request:n});else{var a=e._tilingScheme.tileXYToNativeRectangle(t,r,i),s={bbox:a.west+","+a.south+","+a.east+","+a.north,size:e._tileWidth+","+e._tileHeight,format:"png",transparent:!0,f:"image"};e._tilingScheme instanceof v?(s.bboxSR=4326,s.imageSR=4326):(s.bboxSR=3857,s.imageSR=3857),e.layers&&(s.layers="show:"+e.layers),o=e._resource.getDerivedResource({url:"export",request:n,queryParameters:s})}return o}return e(t.prototype,{url:{get:function(){return this._resource._url}},token:{get:function(){return this._resource.queryParameters.token}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){if(!this._ready)throw new _("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth}},tileHeight:{get:function(){if(!this._ready)throw new _("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready)throw new _("maximumLevel must not be called before the imagery provider is ready.");return this._maximumLevel}},minimumLevel:{get:function(){if(!this._ready)throw new _("minimumLevel must not be called before the imagery provider is ready.");return 0}},tilingScheme:{get:function(){if(!this._ready)throw new _("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}},rectangle:{get:function(){if(!this._ready)throw new _("rectangle must not be called before the imagery provider is ready.");return this._rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready)throw new _("tileDiscardPolicy must not be called before the imagery provider is ready.");return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},usingPrecachedTiles:{get:function(){return this._useTiles}},hasAlphaChannel:{get:function(){return!0}},layers:{get:function(){return this._layers}}}),t.prototype.getTileCredits=function(e,t,r){},t.prototype.requestImage=function(e,t,r,i){if(!this._ready)throw new _("requestImage must not be called before the imagery provider is ready.");return l.loadImage(this,x(this,e,t,r,i))},t.prototype.pickFeatures=function(e,t,r,i,n){if(!this._ready)throw new _("pickFeatures must not be called before the imagery provider is ready.");if(this.enablePickFeatures){var o,a,s,l=this._tilingScheme.tileXYToNativeRectangle(e,t,r);if(this._tilingScheme instanceof v)o=y.toDegrees(i),a=y.toDegrees(n),s="4326";else{var u=this._tilingScheme.projection.project(new f(i,n,0));o=u.x,a=u.y,s="3857"}var c="visible";g(this._layers)&&(c+=":"+this._layers);var d={f:"json",tolerance:2,geometryType:"esriGeometryPoint",geometry:o+","+a,mapExtent:l.west+","+l.south+","+l.east+","+l.north,imageDisplay:this._tileWidth+","+this._tileHeight+",96",sr:s,layers:c};return this._resource.getDerivedResource({url:"identify",queryParameters:d}).fetchJson().then(function(e){var t=[],r=e.results;if(!g(r))return t;for(var i=0;i<r.length;++i){var n=r[i],o=new A;if(o.data=n,o.name=n.value,o.properties=n.attributes,o.configureDescriptionFromProperties(n.attributes),"esriGeometryPoint"===n.geometryType&&n.geometry){var a=n.geometry.spatialReference&&n.geometry.spatialReference.wkid?n.geometry.spatialReference.wkid:4326;if(4326===a||4283===a)o.position=f.fromDegrees(n.geometry.x,n.geometry.y,n.geometry.z);else if(102100===a||900913===a||3857===a){var s=new w;o.position=s.unproject(new p(n.geometry.x,n.geometry.y,n.geometry.z))}}t.push(o)}return t})}},t}),define("Scene/Cesium3DTileColorBlendMode",["../Core/freezeObject"],function(e){"use strict";return e({HIGHLIGHT:0,REPLACE:1,MIX:2})}),define("Scene/getBinaryAccessor",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/ComponentDatatype","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4"],function(e,t,r,o,i,n,a){"use strict";var s={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},l={SCALAR:void 0,VEC2:e,VEC3:t,VEC4:r,MAT2:i,MAT3:n,MAT4:a};return function(e){var i,t=e.componentType;i="string"==typeof t?o.fromName(t):t;var n=s[e.type],r=l[e.type];return{componentsPerAttribute:n,classType:r,createArrayBufferView:function(e,t,r){return o.createArrayBufferView(i,e,t,n*r)}}}}),define("Scene/Cesium3DTileBatchTable",["../Core/arrayFill","../Core/Cartesian2","../Core/Cartesian4","../Core/Check","../Core/clone","../Core/Color","../Core/combine","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Math","../Core/PixelFormat","../Core/RuntimeError","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/Sampler","../Renderer/ShaderSource","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","./AttributeType","./BlendingState","./Cesium3DTileColorBlendMode","./CullFace","./getBinaryAccessor","./StencilFunction","./StencilOperation"],function(y,m,g,d,c,h,b,C,w,S,e,i,p,n,o,f,_,a,v,s,l,u,T,E,A,x,P,D,O,I,M,R,L){"use strict";var N=h.WHITE;function k(e,t,r,i,n){var o,a,s,l;if(this.featuresLength=t,this._translucentFeaturesLength=0,this.batchTableJson=r,this.batchTableBinary=i,S(r)&&(o=r.HIERARCHY,S(o)&&(delete r.HIERARCHY,o=function(e,t){var r,i,n,o,a=e.instancesLength,s=e.classes,l=e.classIds,u=e.parentCounts,c=e.parentIds,d=a;S(l.byteOffset)&&(l.componentType=w(l.componentType,C.UNSIGNED_SHORT),l.type=P.SCALAR,n=M(l),l=n.createArrayBufferView(t.buffer,t.byteOffset+l.byteOffset,a));if(S(u))for(S(u.byteOffset)&&(u.componentType=w(u.componentType,C.UNSIGNED_SHORT),u.type=P.SCALAR,n=M(u),u=n.createArrayBufferView(t.buffer,t.byteOffset+u.byteOffset,a)),o=new Uint16Array(a),r=d=0;r<a;++r)o[r]=d,d+=u[r];S(c)&&S(c.byteOffset)&&(c.componentType=w(c.componentType,C.UNSIGNED_SHORT),c.type=P.SCALAR,n=M(c),c=n.createArrayBufferView(t.buffer,t.byteOffset+c.byteOffset,d));var h=s.length;for(r=0;r<h;++r){var p=s[r].length,f=s[r].instances,m=k.getBinaryProperties(p,f,t);s[r].instances=b(m,f)}var g=y(new Array(h),0),_=new Uint16Array(a);for(r=0;r<a;++r)i=l[r],_[r]=g[i],++g[i];var v={classes:s,classIds:l,classIndexes:_,parentCounts:u,parentIndexes:o,parentIds:c};return function(e){var t=F;t.length=0;for(var r=e.classIds.length,i=0;i<r;++i)B(e,i,t)}(v),v}(o,i)),a=k.getBinaryProperties(t,r,i)),this._batchTableHierarchy=o,this._batchTableBinaryProperties=a,this._showAlphaProperties=void 0,this._batchValues=void 0,this._batchValuesDirty=!1,this._batchTexture=void 0,this._defaultTexture=void 0,this._pickTexture=void 0,this._pickIds=[],this._content=e,this._colorChangedCallback=n,0<t){var u=Math.min(t,_.maximumTextureSize),c=Math.ceil(t/_.maximumTextureSize),d=1/u,h=.5*d,p=1/c,f=.5*p;s=new m(u,c),l=new g(d,h,p,f)}this._textureDimensions=s,this._textureStep=l}e(k.prototype,{memorySizeInBytes:{get:function(){var e=0;return S(this._pickTexture)&&(e+=this._pickTexture.sizeInBytes),S(this._batchTexture)&&(e+=this._batchTexture.sizeInBytes),e}}});var F=[];function B(e,t,r){var i=e.parentCounts,n=e.parentIds,o=e.parentIndexes,a=e.classIds.length;if(S(n)){if(a<=t)throw new p("Parent index "+t+" exceeds the total number of instances: "+a);if(-1<r.indexOf(t))throw new p("Circular dependency detected in the batch table hierarchy.");r.push(t);for(var s=S(i)?i[t]:1,l=S(i)?o[t]:t,u=0;u<s;++u){var c=n[l+u];c!==t&&B(e,c,r)}r.pop(t)}}function U(e){var t=e._textureDimensions;return t.x*t.y*4}function V(e){if(!S(e._batchValues)){var t=U(e),r=new Uint8Array(t);y(r,255),e._batchValues=r}return e._batchValues}function z(e){if(!S(e._showAlphaProperties)){var t=2*e.featuresLength,r=new Uint8Array(t);y(r,255),e._showAlphaProperties=r}return e._showAlphaProperties}function q(e,t){if(!S(e)||e<0||t<e)throw new p("batchId is required and between zero and featuresLength - 1 ("+t-NaN)}k.getBinaryProperties=function(e,t,r){var i;for(var n in t)if(t.hasOwnProperty(n)){var o=t[n],a=o.byteOffset;if(S(a)){var s=o.componentType,l=o.type;if(!S(s))throw new f("componentType is required.");if(!S(l))throw new f("type is required.");if(!S(r))throw new f("Property "+n+" requires a batch table binary.");var u=M(o),c=u.componentsPerAttribute,d=u.classType,h=u.createArrayBufferView(r.buffer,r.byteOffset+a,e);S(i)||(i={}),i[n]={typedArray:h,componentCount:c,type:d}}}return i},k.prototype.setShow=function(e,t){if(q(e,this.featuresLength),d.typeOf.bool("show",t),!t||S(this._showAlphaProperties)){var r=z(this),i=2*e,n=t?255:0;if(r[i]!==n)r[i]=n,V(this)[4*e+3]=t?r[i+1]:0,this._batchValuesDirty=!0}},k.prototype.setAllShow=function(e){d.typeOf.bool("show",e);for(var t=this.featuresLength,r=0;r<t;++r)this.setShow(r,e)},k.prototype.getShow=function(e){if(q(e,this.featuresLength),!S(this._showAlphaProperties))return!0;var t=2*e;return 255===this._showAlphaProperties[t]};var G=new Array(4);k.prototype.setColor=function(e,t){if(q(e,this.featuresLength),d.typeOf.object("color",t),!h.equals(t,N)||S(this._batchValues)){var r=t.toBytes(G),i=r[3],n=V(this),o=4*e,a=z(this),s=2*e;if(n[o]!==r[0]||n[o+1]!==r[1]||n[o+2]!==r[2]||a[s+1]!==i){n[o]=r[0],n[o+1]=r[1],n[o+2]=r[2];var l=255!==a[s+1],u=0!==a[s];n[o+3]=u?i:0;var c=255!==(a[s+1]=i);c&&!l?++this._translucentFeaturesLength:!c&&l&&--this._translucentFeaturesLength,this._batchValuesDirty=!0,S(this._colorChangedCallback)&&this._colorChangedCallback(e,t)}}},k.prototype.setAllColor=function(e){d.typeOf.object("color",e);for(var t=this.featuresLength,r=0;r<t;++r)this.setColor(r,e)},k.prototype.getColor=function(e,t){if(q(e,this.featuresLength),d.typeOf.object("result",t),!S(this._batchValues))return h.clone(N,t);var r=this._batchValues,i=4*e,n=this._showAlphaProperties,o=2*e;return h.fromBytes(r[i],r[i+1],r[i+2],n[o+1],t)};var W=new h;function H(e,t){var r=e.typedArray,i=e.componentCount;return 1===i?r[t]:e.type.unpack(r,t*i)}function j(e,t,r){var i=e.typedArray,n=e.componentCount;1===n?i[t]=r:e.type.pack(r,i,t*n)}k.prototype.applyStyle=function(e,t){if(!S(t))return this.setAllColor(N),void this.setAllShow(!0);for(var r=this._content,i=this.featuresLength,n=0;n<i;++n){var o=r.getFeature(n),a=S(t.color)?t.color.evaluateColor(e,o,W):N,s=!S(t.show)||t.show.evaluate(e,o);this.setColor(n,a),this.setShow(n,s)}};var Y=[],X=[],Q=0;function Z(e,t,r){var i=e.parentCounts,n=e.parentIds;return S(n)?S(i)?function(e,t,r){var i=e.classIds,n=e.parentCounts,o=e.parentIds,a=e.parentIndexes,s=i.length,l=Y;l.length=Math.max(l.length,s);var u=++Q,c=X;for(c.length=0,c.push(t);0<c.length;)if(l[t=c.pop()]!==u){l[t]=u;var d=r(e,t);if(S(d))return d;for(var h=n[t],p=a[t],f=0;f<h;++f){var m=o[p+f];m!==t&&c.push(m)}}}(e,t,r):function(e,t,r){for(var i=!0;i;){var n=r(e,t);if(S(n))return n;var o=e.parentIds[t];i=o!==t,t=o}}(e,t,r):r(e,t)}function K(e){return 1===e._textureDimensions.y?"uniform vec4 tile_textureStep; \nvec2 computeSt(float batchId) \n{ \n    float stepX = tile_textureStep.x; \n    float centerX = tile_textureStep.y; \n    return vec2(centerX + (batchId * stepX), 0.5); \n} \n":"uniform vec4 tile_textureStep; \nuniform vec2 tile_textureDimensions; \nvec2 computeSt(float batchId) \n{ \n    float stepX = tile_textureStep.x; \n    float centerX = tile_textureStep.y; \n    float stepY = tile_textureStep.z; \n    float centerY = tile_textureStep.w; \n    float xId = mod(batchId, tile_textureDimensions.x); \n    float yId = floor(batchId / tile_textureDimensions.x); \n    return vec2(centerX + (xId * stepX), 1.0 - (centerY + (yId * stepY))); \n} \n"}function J(e,t){return e=T.replaceMain(e,"tile_main"),t?e+"uniform float tile_colorBlend; \nvoid tile_color(vec4 tile_featureColor) \n{ \n    tile_main(); \n    gl_FragColor.a *= tile_featureColor.a; \n    float highlight = ceil(tile_colorBlend); \n    gl_FragColor.rgb *= mix(tile_featureColor.rgb, vec3(1.0), highlight); \n} \n":e+"void tile_color(vec4 tile_featureColor) \n{ \n    tile_main(); \n} \n"}function $(e,t,r){if(!S(t))return J(e,r);var i=new RegExp("(uniform|attribute|in)\\s+(vec[34]|sampler2D)\\s+"+t+";"),n=e.match(i);if(!S(n))return J(e,r);var o=n[0],a=n[2];e=(e=T.replaceMain(e,"tile_main")).replace(o,"");var s;if("vec3"===a||"vec4"===a){var l="vec3"===a?"vec4("+t+", 1.0)":t,u="vec3"===a?"tile_diffuse.xyz":"tile_diffuse";i=new RegExp(t,"g"),e=e.replace(i,u),s="    vec4 source = "+l+"; \n    tile_diffuse = tile_diffuse_final(source, tile_featureColor); \n    tile_main(); \n"}else"sampler2D"===a&&(i=new RegExp("texture2D\\("+t+".*?(\\)\\)|\\))","g"),e=e.replace(i,"tile_diffuse_final($&, tile_diffuse)"),s="    tile_diffuse = tile_featureColor; \n    tile_main(); \n");return e="uniform float tile_colorBlend; \nvec4 tile_diffuse = vec4(1.0); \nbool isWhite(vec3 color) \n{ \n    return all(greaterThan(color, vec3(1.0 - czm_epsilon3))); \n} \nvec4 tile_diffuse_final(vec4 sourceDiffuse, vec4 tileDiffuse) \n{ \n    vec4 blendDiffuse = mix(sourceDiffuse, tileDiffuse, tile_colorBlend); \n    vec4 diffuse = isWhite(tileDiffuse.rgb) ? sourceDiffuse : blendDiffuse; \n    return vec4(diffuse.rgb, sourceDiffuse.a); \n} \n"+o+"\n"+e+"\nvoid tile_color(vec4 tile_featureColor) \n{ \n"+s,r&&(e+="    gl_FragColor.a *= tile_featureColor.a; \n    float highlight = ceil(tile_colorBlend); \n    gl_FragColor.rgb *= mix(tile_featureColor.rgb, vec3(1.0), highlight); \n"),e+="} \n"}k.prototype.isClass=function(e,i){q(e,this.featuresLength),d.typeOf.string("className",i);var t=this._batchTableHierarchy;if(!S(t))return!1;var r=Z(t,e,function(e,t){var r=e.classIds[t];if(e.classes[r].name===i)return!0});return S(r)},k.prototype.isExactClass=function(e,t){return d.typeOf.string("className",t),this.getExactClassName(e)===t},k.prototype.getExactClassName=function(e){q(e,this.featuresLength);var t=this._batchTableHierarchy;if(S(t)){var r=t.classIds[e];return t.classes[r].name}},k.prototype.hasProperty=function(e,t){q(e,this.featuresLength),d.typeOf.string("name",t);var r,n,i,o=this.batchTableJson;return S(o)&&S(o[t])||S(this._batchTableHierarchy)&&(r=e,n=t,i=Z(this._batchTableHierarchy,r,function(e,t){var r=e.classIds[t],i=e.classes[r].instances;if(S(i[n]))return!0}),S(i))},k.prototype.getPropertyNames=function(e,t){q(e,this.featuresLength),(t=S(t)?t:[]).length=0;var r,o,i=this.batchTableJson;for(var n in i)i.hasOwnProperty(n)&&t.push(n);return S(this._batchTableHierarchy)&&(r=e,o=t,Z(this._batchTableHierarchy,r,function(e,t){var r=e.classIds[t],i=e.classes[r].instances;for(var n in i)i.hasOwnProperty(n)&&-1===o.indexOf(n)&&o.push(n)})),t},k.prototype.getProperty=function(e,t){if(q(e,this.featuresLength),d.typeOf.string("name",t),S(this.batchTableJson)){if(S(this._batchTableBinaryProperties)){var r=this._batchTableBinaryProperties[t];if(S(r))return H(r,e)}var i,a,n=this.batchTableJson[t];if(S(n))return c(n[e],!0);if(S(this._batchTableHierarchy)){var o=(i=e,a=t,Z(this._batchTableHierarchy,i,function(e,t){var r=e.classIds[t],i=e.classes[r],n=e.classIndexes[t],o=i.instances[a];if(S(o))return S(o.typedArray)?H(o,n):c(o[n],!0)}));if(S(o))return o}}},k.prototype.setProperty=function(e,t,r){var i=this.featuresLength;if(q(e,i),d.typeOf.string("name",t),S(this._batchTableBinaryProperties)){var n=this._batchTableBinaryProperties[t];if(S(n))return void j(n,e,r)}if(!S(this._batchTableHierarchy)||(a=e,s=t,l=r,o=Z(this._batchTableHierarchy,a,function(e,t){var r=e.classIds[t],i=e.classes[r],n=e.classIndexes[t],o=i.instances[s];if(S(o)){if(t!==a)throw new p('Inherited property "'+s+'" is read-only.');return S(o.typedArray)?j(o,n,l):o[n]=c(l,!0),!0}}),!S(o))){var a,s,l,o;S(this.batchTableJson)||(this.batchTableJson={});var u=this.batchTableJson[t];S(u)||(this.batchTableJson[t]=new Array(i),u=this.batchTableJson[t]),u[e]=c(r,!0)}},k.prototype.getVertexShaderCallback=function(i,n,o){if(0!==this.featuresLength){var a=this;return function(e){var t,r=$(e,o,!1);return 0<_.maximumVertexTextureImageUnits?(t="",i&&(t+="uniform bool tile_translucentCommand; \n"),t+="uniform sampler2D tile_batchTexture; \nvarying vec4 tile_featureColor; \nvoid main() \n{ \n    vec2 st = computeSt("+n+"); \n    vec4 featureProperties = texture2D(tile_batchTexture, st); \n    tile_color(featureProperties); \n    float show = ceil(featureProperties.a); \n    gl_Position *= show; \n",i&&(t+="    bool isStyleTranslucent = (featureProperties.a != 1.0); \n    if (czm_pass == czm_passTranslucent) \n    { \n        if (!isStyleTranslucent && !tile_translucentCommand) \n        { \n            gl_Position *= 0.0; \n        } \n    } \n    else \n    { \n        if (isStyleTranslucent) \n        { \n            gl_Position *= 0.0; \n        } \n    } \n"),t+="    tile_featureColor = featureProperties; \n}"):t="varying vec2 tile_featureSt; \nvoid main() \n{ \n    tile_color(vec4(1.0)); \n    tile_featureSt = computeSt("+n+"); \n}",r+"\n"+K(a)+t}}},k.prototype.getFragmentShaderCallback=function(t,r){if(0!==this.featuresLength)return function(e){return e=$(e,r,!0),0<_.maximumVertexTextureImageUnits?e+="varying vec4 tile_featureColor; \nvoid main() \n{ \n    tile_color(tile_featureColor); \n}":(t&&(e+="uniform bool tile_translucentCommand; \n"),e+="uniform sampler2D tile_batchTexture; \nvarying vec2 tile_featureSt; \nvoid main() \n{ \n    vec4 featureProperties = texture2D(tile_batchTexture, tile_featureSt); \n    if (featureProperties.a == 0.0) { \n        discard; \n    } \n",t&&(e+="    bool isStyleTranslucent = (featureProperties.a != 1.0); \n    if (czm_pass == czm_passTranslucent) \n    { \n        if (!isStyleTranslucent && !tile_translucentCommand) \n        { \n            discard; \n        } \n    } \n    else \n    { \n        if (isStyleTranslucent) \n        { \n            discard; \n        } \n    } \n"),e+="    tile_color(featureProperties); \n} \n"),e}},k.prototype.getClassificationFragmentShaderCallback=function(){if(0!==this.featuresLength)return function(e){return e=T.replaceMain(e,"tile_main"),0<_.maximumVertexTextureImageUnits?e+="varying vec4 tile_featureColor; \nvoid main() \n{ \n    gl_FragColor = tile_featureColor; \n}":e+="uniform sampler2D tile_batchTexture; \nvarying vec2 tile_featureSt; \nvoid main() \n{ \n    vec4 featureProperties = texture2D(tile_batchTexture, tile_featureSt); \n    if (featureProperties.a == 0.0) { \n        discard; \n    } \n    gl_FragColor = featureProperties; \n} \n",e}},k.prototype.getUniformMapCallback=function(){if(0!==this.featuresLength){var t=this;return function(e){return b(e,{tile_batchTexture:function(){return w(t._batchTexture,t._defaultTexture)},tile_textureDimensions:function(){return t._textureDimensions},tile_textureStep:function(){return t._textureStep},tile_colorBlend:function(){return function(e){var t=e._content._tileset,r=t.colorBlendMode,i=t.colorBlendAmount;if(r===O.HIGHLIGHT)return 0;if(r===O.REPLACE)return 1;if(r===O.MIX)return n.clamp(i,n.EPSILON4,1);throw new p('Invalid color blend mode "'+r+'".')}(t)}})}}},k.prototype.getPickVertexShaderCallback=function(i){if(0!==this.featuresLength){var n=this;return function(e){var t,r=T.replaceMain(e,"tile_main");return t=0<_.maximumVertexTextureImageUnits?"uniform sampler2D tile_batchTexture; \nvarying vec2 tile_featureSt; \nvoid main() \n{ \n    tile_main(); \n    vec2 st = computeSt("+i+"); \n    vec4 featureProperties = texture2D(tile_batchTexture, st); \n    float show = ceil(featureProperties.a); \n    gl_Position *= show; \n    tile_featureSt = st; \n}":"varying vec2 tile_featureSt; \nvoid main() \n{ \n    tile_main(); \n    tile_featureSt = computeSt("+i+"); \n}",r+"\n"+K(n)+t}}},k.prototype.getPickFragmentShaderCallback=function(){if(0!==this.featuresLength)return function(e){return T.replaceMain(e,"tile_main")+"\n"+(0<_.maximumVertexTextureImageUnits?"uniform sampler2D tile_pickTexture; \nvarying vec2 tile_featureSt; \nvoid main() \n{ \n    tile_main(); \n    if (gl_FragColor.a == 0.0) { \n        discard; \n    } \n    gl_FragColor = texture2D(tile_pickTexture, tile_featureSt); \n}":"uniform sampler2D tile_pickTexture; \nuniform sampler2D tile_batchTexture; \nvarying vec2 tile_featureSt; \nvoid main() \n{ \n    vec4 featureProperties = texture2D(tile_batchTexture, tile_featureSt); \n    if (featureProperties.a == 0.0) { \n        discard; \n    } \n    tile_main(); \n    if (gl_FragColor.a == 0.0) { \n        discard; \n    } \n    gl_FragColor = texture2D(tile_pickTexture, tile_featureSt); \n}")}},k.prototype.getPickVertexShaderCallbackIgnoreShow=function(i){if(0!==this.featuresLength){var n=this;return function(e){var t=T.replaceMain(e,"tile_main"),r="varying vec2 tile_featureSt; \nvoid main() \n{ \n    tile_main(); \n    tile_featureSt = computeSt("+i+"); \n}";return t+"\n"+K(n)+r}}},k.prototype.getPickFragmentShaderCallbackIgnoreShow=function(){if(0!==this.featuresLength)return function(e){return T.replaceMain(e,"tile_main")+"\nuniform sampler2D tile_pickTexture; \nvarying vec2 tile_featureSt; \nvoid main() \n{ \n    tile_main(); \n    gl_FragColor = texture2D(tile_pickTexture, tile_featureSt); \n}"}},k.prototype.getPickUniformMapCallback=function(){if(0!==this.featuresLength){var t=this;return function(e){return b({tile_batchTexture:function(){return w(t._batchTexture,t._defaultTexture)},tile_textureDimensions:function(){return t._textureDimensions},tile_textureStep:function(){return t._textureStep},tile_pickTexture:function(){return t._pickTexture}},e)}}};var ee=0,te=1,re=2;function ie(e,t){e.castShadows=t.castShadows,e.receiveShadows=t.receiveShadows,e.primitiveType=t.primitiveType}function ne(e){var t=a.shallowClone(e),r=t.pass===v.TRANSLUCENT;return t.uniformMap=S(t.uniformMap)?t.uniformMap:{},t.uniformMap.tile_translucentCommand=function(){return r},t}function oe(e){var t,r,i=a.shallowClone(e);return i.pass=v.TRANSLUCENT,i.renderState=(t=e.renderState,(r=c(t,!0)).cull.enabled=!1,r.depthTest.enabled=!0,r.depthMask=!1,r.blending=D.ALPHA_BLEND,l.fromCache(r)),i}function ae(e){var t=a.shallowClone(e),r=c(t.renderState,!0);return r.cull.enabled=!0,r.cull.face=I.FRONT,r.colorMask={red:!1,green:!1,blue:!1,alpha:!1},r.polygonOffset={enabled:!0,factor:5,units:5},t.renderState=l.fromCache(r),t.castShadows=!1,t.receiveShadows=!1,t}function se(e,t){var r=e;if(e.renderState.depthMask){r=a.shallowClone(e);var i=c(r.renderState,!0);i.stencilTest.enabled=!0,i.stencilTest.mask=240,i.stencilTest.reference=t<<4,i.stencilTest.frontFunction=R.GREATER_OR_EQUAL,i.stencilTest.frontOperation.zPass=L.REPLACE,r.renderState=l.fromCache(i)}return r}function le(e,t,r){var i=e._textureDimensions;return new E({context:t,pixelFormat:o.RGBA,pixelDatatype:s.UNSIGNED_BYTE,source:{width:i.x,height:i.y,arrayBufferView:r},sampler:new u({minificationFilter:x.NEAREST,magnificationFilter:A.NEAREST})})}return k.prototype.addDerivedCommands=function(e,t,r){for(var i=e.commandList,n=i.length,o=this._content._tile,a=o._tileset,s=a._skipLevelOfDetail&&a._hasMixedContent&&e.context.stencilBuffer,l=function(e){var t=e._translucentFeaturesLength;{if(0===t)return ee;if(t===e.featuresLength)return te}return re}(this),u=t;u<n;++u){var c=i[u],d=c.derivedCommands.tileset;S(d)||(d={},(c.derivedCommands.tileset=d).originalCommand=ne(c)),ie(d.originalCommand,c),l!==ee&&(S(d.translucent)||(d.translucent=oe(d.originalCommand)),ie(d.translucent,c)),s&&(c.pass===v.TRANSLUCENT||r||(S(d.zback)||(d.zback=ae(d.originalCommand)),a._backfaceCommands.push(d.zback)),S(d.stencil)&&o._selectionDepth===o._lastSelectionDepth||(d.stencil=se(d.originalCommand,o._selectionDepth),o._lastSelectionDepth=o._selectionDepth),ie(d.stencil,c));var h=s?d.stencil:d.originalCommand,p=d.translucent;c.pass!==v.TRANSLUCENT?(l===ee&&(i[u]=h),l===te&&(i[u]=p),l===re&&(i[u]=h,i.push(p))):i[u]=h}},k.prototype.update=function(e,t){var r,i,n=t.context;this._defaultTexture=n.defaultTexture,t.passes.pick&&function(e,t){var r=e.featuresLength;if(!S(e._pickTexture)&&0<r){for(var i=e._pickIds,n=U(e),o=new Uint8Array(n),a=e._content,s=0;s<r;++s){var l=t.createPickId(a.getFeature(s));i.push(l);var u=l.color,c=4*s;o[c]=h.floatToByte(u.red),o[c+1]=h.floatToByte(u.green),o[c+2]=h.floatToByte(u.blue),o[c+3]=h.floatToByte(u.alpha)}e._pickTexture=le(e,t,o),a._tileset._statistics.batchTableByteLength+=e._pickTexture.sizeInBytes}}(this,n),this._batchValuesDirty&&(this._batchValuesDirty=!1,S(this._batchTexture)||(this._batchTexture=le(this,n,this._batchValues),e._statistics.batchTableByteLength+=this._batchTexture.sizeInBytes),i=(r=this)._textureDimensions,r._batchTexture.copyFrom({width:i.x,height:i.y,arrayBufferView:r._batchValues}))},k.prototype.isDestroyed=function(){return!1},k.prototype.destroy=function(){this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),this._pickTexture=this._pickTexture&&this._pickTexture.destroy();for(var e=this._pickIds,t=e.length,r=0;r<t;++r)e[r].destroy();return i(this)},k}),define("Scene/Cesium3DTileFeature",["../Core/Color","../Core/defined","../Core/defineProperties"],function(e,t,r){"use strict";function i(e,t){this._content=e,this._batchId=t,this._color=void 0}return r(i.prototype,{show:{get:function(){return this._content.batchTable.getShow(this._batchId)},set:function(e){this._content.batchTable.setShow(this._batchId,e)}},color:{get:function(){return t(this._color)||(this._color=new e),this._content.batchTable.getColor(this._batchId,this._color)},set:function(e){this._content.batchTable.setColor(this._batchId,e)}},content:{get:function(){return this._content}},tileset:{get:function(){return this._content.tileset}},primitive:{get:function(){return this._content.tileset}}}),i.prototype.hasProperty=function(e){return this._content.batchTable.hasProperty(this._batchId,e)},i.prototype.getPropertyNames=function(e){return this._content.batchTable.getPropertyNames(this._batchId,e)},i.prototype.getProperty=function(e){return this._content.batchTable.getProperty(this._batchId,e)},i.prototype.setProperty=function(e,t){this._content.batchTable.setProperty(this._batchId,e,t),this._content.featurePropertiesDirty=!0},i.prototype.isExactClass=function(e){return this._content.batchTable.isExactClass(this._batchId,e)},i.prototype.isClass=function(e){return this._content.batchTable.isClass(this._batchId,e)},i.prototype.getExactClassName=function(){return this._content.batchTable.getExactClassName(this._batchId)},i}),define("Scene/Cesium3DTileFeatureTable",["../Core/ComponentDatatype","../Core/defaultValue","../Core/defined"],function(u,n,c){"use strict";function e(e,t){this.json=e,this.buffer=t,this._cachedTypedArrays={},this.featuresLength=0}function d(e,t,r,i,n,o){var a=e._cachedTypedArrays,s=a[t];return c(s)||(s=u.createArrayBufferView(r,e.buffer.buffer,e.buffer.byteOffset+o,n*i),a[t]=s),s}return e.prototype.getGlobalProperty=function(e,t,r){var i=this.json[e];if(c(i))return c(i.byteOffset)?d(this,e,t=n(t,u.UNSIGNED_INT),r=n(r,1),1,i.byteOffset):i},e.prototype.getPropertyArray=function(e,t,r){var i,n,o,a,s,l=this.json[e];if(c(l))return c(l.byteOffset)?(c(l.componentType)&&(t=u.fromName(l.componentType)),d(this,e,t,r,this.featuresLength,l.byteOffset)):(i=e,n=t,o=l,a=this._cachedTypedArrays,s=a[i],c(s)||(s=u.createTypedArray(n,o),a[i]=s),s)},e.prototype.getProperty=function(e,t,r,i,n){var o=this.json[e];if(c(o)){var a=this.getPropertyArray(e,t,r);if(1===r)return a[i];for(var s=0;s<r;++s)n[s]=a[r*i+s];return n}},e}),define("Scene/Vector3DTileBatch",[],function(){"use strict";return function(e){this.offset=e.offset,this.count=e.count,this.color=e.color,this.batchIds=e.batchIds}}),define("ThirdParty/jsep",[],function(){if(function(e){"use strict";var w="MemberExpression",S="Literal",T=function(e,t){var r=new Error(e+" at character "+t);throw r.index=t,r.description=e,r},E={"-":!0,"!":!0,"~":!0,"+":!0},A={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},t=function(e){var t,r=0;for(var i in e)(t=i.length)>r&&e.hasOwnProperty(i)&&(r=t);return r},x=t(E),P=t(A),D={true:!0,false:!1,null:null},O=function(e){return A[e]||0},I=function(e,t,r){return{type:"||"===e||"&&"===e?"LogicalExpression":"BinaryExpression",operator:e,left:t,right:r}},M=function(e){return 48<=e&&e<=57},R=function(e){return 36===e||95===e||65<=e&&e<=90||97<=e&&e<=122||128<=e&&!A[String.fromCharCode(e)]},r=function(n){for(var e,t,l=0,r=n.charAt,i=n.charCodeAt,o=function(e){return r.call(n,e)},a=function(e){return i.call(n,e)},s=n.length,u=function(){for(var e=a(l);32===e||9===e;)e=a(++l)},c=function(){var e,t,r=h();return u(),63!==a(l)?r:(l++,(e=c())||T("Expected expression",l),u(),58===a(l)?(l++,(t=c())||T("Expected expression",l),{type:"ConditionalExpression",test:r,consequent:e,alternate:t}):void T("Expected :",l))},d=function(){u();for(var e=n.substr(l,P),t=e.length;0<t;){if(A.hasOwnProperty(e))return l+=t,e;e=e.substr(0,--t)}return!1},h=function(){var e,t,r,i,n,o,a,s;if(o=p(),!(t=d()))return o;for(n={value:t,prec:O(t)},(a=p())||T("Expected expression after "+t,l),i=[o,n,a];(t=d())&&0!==(r=O(t));){for(n={value:t,prec:r};2<i.length&&r<=i[i.length-2].prec;)a=i.pop(),t=i.pop().value,o=i.pop(),e=I(t,o,a),i.push(e);(e=p())||T("Expected expression after "+t,l),i.push(n,e)}for(e=i[s=i.length-1];1<s;)e=I(i[s-1].value,i[s-2],e),s-=2;return e},p=function(){var e,t,r;if(u(),e=a(l),M(e)||46===e)return f();if(39===e||34===e)return m();if(R(e)||40===e)return v();if(91===e)return b();for(r=(t=n.substr(l,x)).length;0<r;){if(E.hasOwnProperty(t))return l+=r,{type:"UnaryExpression",operator:t,argument:p(),prefix:!0};t=t.substr(0,--r)}return!1},f=function(){for(var e,t,r="";M(a(l));)r+=o(l++);if(46===a(l))for(r+=o(l++);M(a(l));)r+=o(l++);if("e"===(e=o(l))||"E"===e){for(r+=o(l++),"+"!==(e=o(l))&&"-"!==e||(r+=o(l++));M(a(l));)r+=o(l++);M(a(l-1))||T("Expected exponent ("+r+o(l)+")",l)}return t=a(l),R(t)?T("Variable names cannot start with a number ("+r+o(l)+")",l):46===t&&T("Unexpected period",l),{type:S,value:parseFloat(r),raw:r}},m=function(){for(var e,t="",r=o(l++),i=!1;l<s;){if((e=o(l++))===r){i=!0;break}if("\\"===e)switch(e=o(l++)){case"n":t+="\n";break;case"r":t+="\r";break;case"t":t+="\t";break;case"b":t+="\b";break;case"f":t+="\f";break;case"v":t+="\v";break;default:t+="\\"+e}else t+=e}return i||T('Unclosed quote after "'+t+'"',l),{type:S,value:t,raw:r+t+r}},g=function(){var e,t,r=a(l),i=l;for(R(r)?l++:T("Unexpected "+o(l),l);l<s&&(r=a(l),36===(t=r)||95===t||65<=t&&t<=90||97<=t&&t<=122||48<=t&&t<=57||128<=t&&!A[String.fromCharCode(t)]);)l++;return e=n.slice(i,l),D.hasOwnProperty(e)?{type:S,value:D[e],raw:e}:"this"===e?{type:"ThisExpression"}:{type:"Identifier",name:e}},_=function(e){for(var t,r,i=[],n=!1;l<s;){if(u(),(t=a(l))===e){n=!0,l++;break}44===t?l++:((r=c())&&"Compound"!==r.type||T("Expected comma",l),i.push(r))}return n||T("Expected "+String.fromCharCode(e),l),i},v=function(){var e,t;for(t=40===(e=a(l))?y():g(),u(),e=a(l);46===e||91===e||40===e;)l++,46===e?(u(),t={type:w,computed:!1,object:t,property:g()}):91===e?(t={type:w,computed:!0,object:t,property:c()},u(),93!==(e=a(l))&&T("Unclosed [",l),l++):40===e&&(t={type:"CallExpression",arguments:_(41),callee:t}),u(),e=a(l);return t},y=function(){l++;var e=c();if(u(),41===a(l))return l++,e;T("Unclosed (",l)},b=function(){return l++,{type:"ArrayExpression",elements:_(93)}},C=[];l<s;)59===(e=a(l))||44===e?l++:(t=c())?C.push(t):l<s&&T('Unexpected "'+o(l)+'"',l);return 1===C.length?C[0]:{type:"Compound",body:C}};if(r.version="0.3.1",r.toString=function(){return"JavaScript Expression Parser (JSEP) v"+r.version},r.addUnaryOp=function(e){return x=Math.max(e.length,x),E[e]=!0,this},r.addBinaryOp=function(e,t){return P=Math.max(e.length,P),A[e]=t,this},r.addLiteral=function(e,t){return D[e]=t,this},r.removeUnaryOp=function(e){return delete E[e],e.length===x&&(x=t(E)),this},r.removeAllUnaryOps=function(){return E={},x=0,this},r.removeBinaryOp=function(e){return delete A[e],e.length===P&&(P=t(A)),this},r.removeAllBinaryOps=function(){return A={},P=0,this},r.removeLiteral=function(e){return delete D[e],this},r.removeAllLiterals=function(){return D={},this},"undefined"==typeof exports){var i=e.jsep;(e.jsep=r).noConflict=function(){return e.jsep===r&&(e.jsep=i),r}}else"undefined"!=typeof module&&module.exports?exports=module.exports=r:exports.parse=r}(this),"undefined"!=typeof jsep)return jsep.noConflict()}),define("Scene/ExpressionNodeType",["../Core/freezeObject"],function(e){"use strict";return e({VARIABLE:0,UNARY:1,BINARY:2,TERNARY:3,CONDITIONAL:4,MEMBER:5,FUNCTION_CALL:6,ARRAY:7,REGEX:8,VARIABLE_IN_STRING:9,LITERAL_NULL:10,LITERAL_BOOLEAN:11,LITERAL_NUMBER:12,LITERAL_STRING:13,LITERAL_COLOR:14,LITERAL_VECTOR:15,LITERAL_REGEX:16,LITERAL_UNDEFINED:17,BUILTIN_VARIABLE:18})}),define("Scene/Expression",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Check","../Core/Color","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/isArray","../Core/Math","../Core/RuntimeError","../ThirdParty/jsep","./ExpressionNodeType"],function(d,h,p,i,g,_,e,v,y,t,b,n,C){"use strict";function r(e,t){var r;i.typeOf.string("expression",e),e=function(e,t){if(!_(t))return e;for(var r in t)if(t.hasOwnProperty(r)){var i=new RegExp("\\$\\{"+r+"\\}","g"),n="("+t[r]+")";_(n)&&(e=e.replace(i,n))}return e}(this._expression=e,t),e=function(e){var t=e,r="",i=t.indexOf("${");for(;0<=i;){var n,o=t.indexOf("'"),a=t.indexOf('"');if(0<=o&&o<i)n=t.indexOf("'",o+1),r+=t.substr(0,n+1),t=t.substr(n+1),i=t.indexOf("${");else if(0<=a&&a<i)n=t.indexOf('"',a+1),r+=t.substr(0,n+1),t=t.substr(n+1),i=t.indexOf("${");else{r+=t.substr(0,i);var s=t.indexOf("}");if(s<0)throw new b("Unmatched {.");r+="czm_"+t.substr(i+2,s-(i+2)),t=t.substr(s+1),i=t.indexOf("${")}}return r+=t}(e.replace(o,a)),n.addBinaryOp("=~",0),n.addBinaryOp("!~",0);try{r=n(e)}catch(e){throw new b(e)}this._runtimeAst=R(this,r)}e(r.prototype,{expression:{get:function(){return this._expression}}});var f={arrayIndex:0,arrayArray:[[]],cartesian2Index:0,cartesian3Index:0,cartesian4Index:0,cartesian2Array:[new d],cartesian3Array:[new h],cartesian4Array:[new p],reset:function(){this.arrayIndex=0,this.cartesian2Index=0,this.cartesian3Index=0,this.cartesian4Index=0},getArray:function(){this.arrayIndex>=this.arrayArray.length&&this.arrayArray.push([]);var e=this.arrayArray[this.arrayIndex++];return e.length=0,e},getCartesian2:function(){return this.cartesian2Index>=this.cartesian2Array.length&&this.cartesian2Array.push(new d),this.cartesian2Array[this.cartesian2Index++]},getCartesian3:function(){return this.cartesian3Index>=this.cartesian3Array.length&&this.cartesian3Array.push(new h),this.cartesian3Array[this.cartesian3Index++]},getCartesian4:function(){return this.cartesian4Index>=this.cartesian4Array.length&&this.cartesian4Array.push(new p),this.cartesian4Array[this.cartesian4Index++]}};r.prototype.evaluate=function(e,t,r){f.reset();var i=this._runtimeAst.evaluate(e,t);return r instanceof g&&i instanceof p?g.fromCartesian4(i,r):i instanceof d||i instanceof h||i instanceof p?i.clone(r):i},r.prototype.evaluateColor=function(e,t,r){f.reset();var i=this._runtimeAst.evaluate(e,t);return g.fromCartesian4(i,r)},r.prototype.getShaderFunction=function(e,t,r,i){var n=this.getShaderExpression(t,r);return n=i+" "+e+"() \n{ \n    return "+n+"; \n} \n"},r.prototype.getShaderExpression=function(e,t){return this._runtimeAst.getShaderExpression(e,t)};var m=["!","-","+"],w=["+","-","*","/","%","===","!==",">",">=","<","<=","&&","||","!~","=~"],s=/\${(.*?)}/g,o=/\\/g,a="@#%",l=/@#%/g,S=new g,T={abs:u(Math.abs),sqrt:u(Math.sqrt),cos:u(Math.cos),sin:u(Math.sin),tan:u(Math.tan),acos:u(Math.acos),asin:u(Math.asin),atan:u(Math.atan),radians:u(t.toRadians),degrees:u(t.toDegrees),sign:u(t.sign),floor:u(Math.floor),ceil:u(Math.ceil),round:u(Math.round),exp:u(Math.exp),exp2:u(function(e){return Math.pow(2,e)}),log:u(Math.log),log2:u(function(e){return t.logBase(e,2)}),fract:u(function(e){return e-Math.floor(e)}),length:function(e,t){{if("number"==typeof t)return Math.abs(t);if(t instanceof d)return d.magnitude(t);if(t instanceof h)return h.magnitude(t);if(t instanceof p)return p.magnitude(t)}throw new b('Function "'+e+'" requires a vector or number argument. Argument is '+t+".")},normalize:function(e,t){{if("number"==typeof t)return 1;if(t instanceof d)return d.normalize(t,f.getCartesian2());if(t instanceof h)return h.normalize(t,f.getCartesian3());if(t instanceof p)return p.normalize(t,f.getCartesian4())}throw new b('Function "'+e+'" requires a vector or number argument. Argument is '+t+".")}},E={atan2:c(Math.atan2,!1),pow:c(Math.pow,!1),min:c(Math.min,!0),max:c(Math.max,!0),distance:function(e,t,r){{if("number"==typeof t&&"number"==typeof r)return Math.abs(t-r);if(t instanceof d&&r instanceof d)return d.distance(t,r);if(t instanceof h&&r instanceof h)return h.distance(t,r);if(t instanceof p&&r instanceof p)return p.distance(t,r)}throw new b('Function "'+e+'" requires vector or number arguments of matching types. Arguments are '+t+" and "+r+".")},dot:function(e,t,r){{if("number"==typeof t&&"number"==typeof r)return t*r;if(t instanceof d&&r instanceof d)return d.dot(t,r);if(t instanceof h&&r instanceof h)return h.dot(t,r);if(t instanceof p&&r instanceof p)return p.dot(t,r)}throw new b('Function "'+e+'" requires vector or number arguments of matching types. Arguments are '+t+" and "+r+".")},cross:function(e,t,r){if(t instanceof h&&r instanceof h)return h.cross(t,r,f.getCartesian3());throw new b('Function "'+e+'" requires vec3 arguments. Arguments are '+t+" and "+r+".")}},A={clamp:x(t.clamp,!0),mix:x(t.lerp,!0)};function u(r){return function(e,t){if("number"==typeof t)return r(t);if(t instanceof d)return d.fromElements(r(t.x),r(t.y),f.getCartesian2());if(t instanceof h)return h.fromElements(r(t.x),r(t.y),r(t.z),f.getCartesian3());if(t instanceof p)return p.fromElements(r(t.x),r(t.y),r(t.z),r(t.w),f.getCartesian4());throw new b('Function "'+e+'" requires a vector or number argument. Argument is '+t+".")}}function c(i,n){return function(e,t,r){if(n&&"number"==typeof r){if("number"==typeof t)return i(t,r);if(t instanceof d)return d.fromElements(i(t.x,r),i(t.y,r),f.getCartesian2());if(t instanceof h)return h.fromElements(i(t.x,r),i(t.y,r),i(t.z,r),f.getCartesian3());if(t instanceof p)return p.fromElements(i(t.x,r),i(t.y,r),i(t.z,r),i(t.w,r),f.getCartesian4())}if("number"==typeof t&&"number"==typeof r)return i(t,r);if(t instanceof d&&r instanceof d)return d.fromElements(i(t.x,r.x),i(t.y,r.y),f.getCartesian2());if(t instanceof h&&r instanceof h)return h.fromElements(i(t.x,r.x),i(t.y,r.y),i(t.z,r.z),f.getCartesian3());if(t instanceof p&&r instanceof p)return p.fromElements(i(t.x,r.x),i(t.y,r.y),i(t.z,r.z),i(t.w,r.w),f.getCartesian4());throw new b('Function "'+e+'" requires vector or number arguments of matching types. Arguments are '+t+" and "+r+".")}}function x(n,o){return function(e,t,r,i){if(o&&"number"==typeof i){if("number"==typeof t&&"number"==typeof r)return n(t,r,i);if(t instanceof d&&r instanceof d)return d.fromElements(n(t.x,r.x,i),n(t.y,r.y,i),f.getCartesian2());if(t instanceof h&&r instanceof h)return h.fromElements(n(t.x,r.x,i),n(t.y,r.y,i),n(t.z,r.z,i),f.getCartesian3());if(t instanceof p&&r instanceof p)return p.fromElements(n(t.x,r.x,i),n(t.y,r.y,i),n(t.z,r.z,i),n(t.w,r.w,i),f.getCartesian4())}if("number"==typeof t&&"number"==typeof r&&"number"==typeof i)return n(t,r,i);if(t instanceof d&&r instanceof d&&i instanceof d)return d.fromElements(n(t.x,r.x,i.x),n(t.y,r.y,i.y),f.getCartesian2());if(t instanceof h&&r instanceof h&&i instanceof h)return h.fromElements(n(t.x,r.x,i.x),n(t.y,r.y,i.y),n(t.z,r.z,i.z),f.getCartesian3());if(t instanceof p&&r instanceof p&&i instanceof p)return p.fromElements(n(t.x,r.x,i.x),n(t.y,r.y,i.y),n(t.z,r.z,i.z),n(t.w,r.w,i.w),f.getCartesian4());throw new b('Function "'+e+'" requires vector or number arguments of matching types. Arguments are '+t+", "+r+", and "+i+".")}}function P(e,t,r,i,n){var o,a,s,l,u,c,d;this._type=e,this._value=t,this._left=r,this._right=i,this._test=n,this.evaluate=void 0,(o=this)._type===C.CONDITIONAL?o.evaluate=o._evaluateConditional:o._type===C.FUNCTION_CALL?"test"===o._value?o.evaluate=o._evaluateRegExpTest:"exec"===o._value?o.evaluate=o._evaluateRegExpExec:"toString"===o._value&&(o.evaluate=o._evaluateToString):o._type===C.UNARY?"!"===o._value?o.evaluate=o._evaluateNot:"-"===o._value?o.evaluate=o._evaluateNegative:"+"===o._value?o.evaluate=o._evaluatePositive:"isNaN"===o._value?o.evaluate=o._evaluateNaN:"isFinite"===o._value?o.evaluate=o._evaluateIsFinite:"isExactClass"===o._value?o.evaluate=o._evaluateIsExactClass:"isClass"===o._value?o.evaluate=o._evaluateIsClass:"getExactClassName"===o._value?o.evaluate=o._evaluategetExactClassName:"Boolean"===o._value?o.evaluate=o._evaluateBooleanConversion:"Number"===o._value?o.evaluate=o._evaluateNumberConversion:"String"===o._value?o.evaluate=o._evaluateStringConversion:_(T[o._value])&&(o.evaluate=(c=o._value,d=T[c],function(e,t){var r=this._left.evaluate(e,t);return d(c,r)})):o._type===C.BINARY?"+"===o._value?o.evaluate=o._evaluatePlus:"-"===o._value?o.evaluate=o._evaluateMinus:"*"===o._value?o.evaluate=o._evaluateTimes:"/"===o._value?o.evaluate=o._evaluateDivide:"%"===o._value?o.evaluate=o._evaluateMod:"==="===o._value?o.evaluate=o._evaluateEqualsStrict:"!=="===o._value?o.evaluate=o._evaluateNotEqualsStrict:"<"===o._value?o.evaluate=o._evaluateLessThan:"<="===o._value?o.evaluate=o._evaluateLessThanOrEquals:">"===o._value?o.evaluate=o._evaluateGreaterThan:">="===o._value?o.evaluate=o._evaluateGreaterThanOrEquals:"&&"===o._value?o.evaluate=o._evaluateAnd:"||"===o._value?o.evaluate=o._evaluateOr:"=~"===o._value?o.evaluate=o._evaluateRegExpMatch:"!~"===o._value?o.evaluate=o._evaluateRegExpNotMatch:_(E[o._value])&&(o.evaluate=(l=o._value,u=E[l],function(e,t){var r=this._left.evaluate(e,t),i=this._right.evaluate(e,t);return u(l,r,i)})):o._type===C.TERNARY?o.evaluate=(a=o._value,s=A[a],function(e,t){var r=this._left.evaluate(e,t),i=this._right.evaluate(e,t),n=this._test.evaluate(e,t);return s(a,r,i,n)}):o._type===C.MEMBER?"brackets"===o._value?o.evaluate=o._evaluateMemberBrackets:o.evaluate=o._evaluateMemberDot:o._type===C.ARRAY?o.evaluate=o._evaluateArray:o._type===C.VARIABLE?o.evaluate=o._evaluateVariable:o._type===C.VARIABLE_IN_STRING?o.evaluate=o._evaluateVariableString:o._type===C.LITERAL_COLOR?o.evaluate=o._evaluateLiteralColor:o._type===C.LITERAL_VECTOR?o.evaluate=o._evaluateLiteralVector:o._type===C.LITERAL_STRING?o.evaluate=o._evaluateLiteralString:o._type===C.REGEX?o.evaluate=o._evaluateRegExp:o._type===C.BUILTIN_VARIABLE?"tiles3d_tileset_time"===o._value&&(o.evaluate=L):o.evaluate=o._evaluateLiteral}function D(e){return e.replace(l,"\\")}function O(e,t){var r,i,n,o,a=t.arguments,s=a.length;if("MemberExpression"===t.callee.type){r=t.callee.property.name;var l=t.callee.object;if("test"===r||"exec"===r){if("regExp"!==l.callee.name)throw new b(r+" is not a function.");return 0===s?"test"===r?new P(C.LITERAL_BOOLEAN,!1):new P(C.LITERAL_NULL,null):(n=R(e,l),o=R(e,a[0]),new P(C.FUNCTION_CALL,r,n,o))}if("toString"===r)return i=R(e,l),new P(C.FUNCTION_CALL,r,i);throw new b('Unexpected function call "'+r+'".')}if("color"===(r=t.callee.name)){if(0===s)return new P(C.LITERAL_COLOR,r);if(i=R(e,a[0]),_(a[1])){var u=R(e,a[1]);return new P(C.LITERAL_COLOR,r,[i,u])}return new P(C.LITERAL_COLOR,r,[i])}if("rgb"===r||"hsl"===r){if(s<3)throw new b(r+" requires three arguments.");return i=[R(e,a[0]),R(e,a[1]),R(e,a[2])],new P(C.LITERAL_COLOR,r,i)}if("rgba"===r||"hsla"===r){if(s<4)throw new b(r+" requires four arguments.");return i=[R(e,a[0]),R(e,a[1]),R(e,a[2]),R(e,a[3])],new P(C.LITERAL_COLOR,r,i)}if("vec2"===r||"vec3"===r||"vec4"===r){i=new Array(s);for(var c=0;c<s;++c)i[c]=R(e,a[c]);return new P(C.LITERAL_VECTOR,r,i)}if("isNaN"===r||"isFinite"===r)return 0===s?new P(C.LITERAL_BOOLEAN,"isNaN"===r):(i=R(e,a[0]),new P(C.UNARY,r,i));if("isExactClass"===r||"isClass"===r){if(s<1||1<s)throw new b(r+" requires exactly one argument.");return i=R(e,a[0]),new P(C.UNARY,r,i)}if("getExactClassName"===r){if(0<s)throw new b(r+" does not take any argument.");return new P(C.UNARY,r)}if(_(T[r])){if(1!==s)throw new b(r+" requires exactly one argument.");return i=R(e,a[0]),new P(C.UNARY,r,i)}if(_(E[r])){if(2!==s)throw new b(r+" requires exactly two arguments.");return n=R(e,a[0]),o=R(e,a[1]),new P(C.BINARY,r,n,o)}if(_(A[r])){if(3!==s)throw new b(r+" requires exactly three arguments.");n=R(e,a[0]),o=R(e,a[1]);var d=R(e,a[2]);return new P(C.TERNARY,r,n,o,d)}if("Boolean"===r)return 0===s?new P(C.LITERAL_BOOLEAN,!1):(i=R(e,a[0]),new P(C.UNARY,r,i));if("Number"===r)return 0===s?new P(C.LITERAL_NUMBER,0):(i=R(e,a[0]),new P(C.UNARY,r,i));if("String"===r)return 0===s?new P(C.LITERAL_STRING,""):(i=R(e,a[0]),new P(C.UNARY,r,i));if("regExp"===r)return function(e,t){var r=t.arguments;if(0===r.length)return new P(C.LITERAL_REGEX,new RegExp);var i,n=R(e,r[0]);if(1<r.length){var o=R(e,r[1]);if(M(n)&&M(o)){try{i=new RegExp(D(String(n._value)),o._value)}catch(e){throw new b(e)}return new P(C.LITERAL_REGEX,i)}return new P(C.REGEX,n,o)}if(M(n)){try{i=new RegExp(D(String(n._value)))}catch(e){throw new b(e)}return new P(C.LITERAL_REGEX,i)}return new P(C.REGEX,n)}(e,t);throw new b('Unexpected function call "'+r+'".')}function I(e,t){if("Math"===t.object.name)return"PI"===(r=t.property.name)?new P(C.LITERAL_NUMBER,Math.PI):"E"===r?new P(C.LITERAL_NUMBER,Math.E):void 0;if("Number"===t.object.name)return function(e){if("POSITIVE_INFINITY"===e.property.name)return new P(C.LITERAL_NUMBER,Number.POSITIVE_INFINITY)}(t);var r,i,n=R(e,t.object);return t.computed?(i=R(e,t.property),new P(C.MEMBER,"brackets",n,i)):(i=new P(C.LITERAL_STRING,t.property.name),new P(C.MEMBER,"dot",n,i))}function M(e){return e._type>=C.LITERAL_NULL}function R(e,t){var r,i,n,o,a,s;if("Literal"===t.type)s=typeof(a=t).value,r=null===a.value?new P(C.LITERAL_NULL,null):"boolean"===s?new P(C.LITERAL_BOOLEAN,a.value):"number"===s?new P(C.LITERAL_NUMBER,a.value):"string"===s?0<=a.value.indexOf("${")?new P(C.VARIABLE_IN_STRING,a.value):new P(C.LITERAL_STRING,D(a.value)):void 0;else if("CallExpression"===t.type)r=O(e,t);else if("Identifier"===t.type)r=function(e){if("czm_"===e.name.substr(0,4)){var t=e.name.substr(4);return"tiles3d_"===t.substr(0,8)?new P(C.BUILTIN_VARIABLE,t):new P(C.VARIABLE,t)}if("NaN"===e.name)return new P(C.LITERAL_NUMBER,NaN);if("Infinity"===e.name)return new P(C.LITERAL_NUMBER,1/0);if("undefined"===e.name)return new P(C.LITERAL_UNDEFINED,void 0);throw new b(e.name+" is not defined.")}(t);else if("UnaryExpression"===t.type){i=t.operator;var l=R(e,t.argument);if(!(-1<m.indexOf(i)))throw new b('Unexpected operator "'+i+'".');r=new P(C.UNARY,i,l)}else if("BinaryExpression"===t.type){if(i=t.operator,n=R(e,t.left),o=R(e,t.right),!(-1<w.indexOf(i)))throw new b('Unexpected operator "'+i+'".');r=new P(C.BINARY,i,n,o)}else if("LogicalExpression"===t.type)i=t.operator,n=R(e,t.left),o=R(e,t.right),-1<w.indexOf(i)&&(r=new P(C.BINARY,i,n,o));else if("ConditionalExpression"===t.type){var u=R(e,t.test);n=R(e,t.consequent),o=R(e,t.alternate),r=new P(C.CONDITIONAL,"?",n,o,u)}else if("MemberExpression"===t.type)r=I(e,t);else{if("ArrayExpression"!==t.type)throw"Compound"===t.type?new b("Provide exactly one expression."):new b("Cannot parse expression.");for(var c=[],d=0;d<t.elements.length;d++)c[d]=R(e,t.elements[d]);r=new P(C.ARRAY,c)}return r}function L(e,t){return t.content.tileset.timeSinceLoad}function N(e){return"feature"===e._value}function k(e){for(var t=e._left,r=t.length,i=0;i<r;++i)if(t[i]._type!==C.LITERAL_NUMBER)return;var n=t[0]._value,o=t[1]._value,a=t[2]._value,s=4===r?t[3]._value:1;return g.fromHsl(n,o,a,s,S)}function F(e){for(var t=e._left,r=t.length,i=0;i<r;++i)if(t[i]._type!==C.LITERAL_NUMBER)return;var n=S;return n.red=t[0]._value/255,n.green=t[1]._value/255,n.blue=t[2]._value/255,n.alpha=4===r?t[3]._value:1,n}function B(e){return e%1==0?e.toFixed(1):e.toString()}function U(e){return"vec4("+B(e.red)+", "+B(e.green)+", "+B(e.blue)+", "+B(e.alpha)+")"}function V(e,t,r,i){for(var n=e.length,o=new Array(n),a=0;a<n;++a)o[a]=e[a].getShaderExpression(t,r,i);return o}return P.prototype._evaluateLiteral=function(e,t){return this._value},P.prototype._evaluateLiteralColor=function(e,t){var r=S,i=this._left;if("color"===this._value)_(i)?1<i.length?(g.fromCssColorString(i[0].evaluate(e,t),r),r.alpha=i[1].evaluate(e,t)):g.fromCssColorString(i[0].evaluate(e,t),r):g.fromBytes(255,255,255,255,r);else if("rgb"===this._value)g.fromBytes(i[0].evaluate(e,t),i[1].evaluate(e,t),i[2].evaluate(e,t),255,r);else if("rgba"===this._value){var n=255*i[3].evaluate(e,t);g.fromBytes(i[0].evaluate(e,t),i[1].evaluate(e,t),i[2].evaluate(e,t),n,r)}else"hsl"===this._value?g.fromHsl(i[0].evaluate(e,t),i[1].evaluate(e,t),i[2].evaluate(e,t),1,r):"hsla"===this._value&&g.fromHsl(i[0].evaluate(e,t),i[1].evaluate(e,t),i[2].evaluate(e,t),i[3].evaluate(e,t),r);return p.fromColor(r,f.getCartesian4())},P.prototype._evaluateLiteralVector=function(e,t){for(var r=f.getArray(),i=this._value,n=this._left,o=n.length,a=0;a<o;++a){var s=n[a].evaluate(e,t);if("number"==typeof s)r.push(s);else if(s instanceof d)r.push(s.x,s.y);else if(s instanceof h)r.push(s.x,s.y,s.z);else{if(!(s instanceof p))throw new b(i+" argument must be a vector or number. Argument is "+s+".");r.push(s.x,s.y,s.z,s.w)}}var l=r.length,u=parseInt(i.charAt(3));if(0===l)throw new b("Invalid "+i+" constructor. No valid arguments.");if(l<u&&1<l)throw new b("Invalid "+i+" constructor. Not enough arguments.");if(u<l&&1<o)throw new b("Invalid "+i+" constructor. Too many arguments.");if(1===l){var c=r[0];r.push(c,c,c)}return"vec2"===i?d.fromArray(r,0,f.getCartesian2()):"vec3"===i?h.fromArray(r,0,f.getCartesian3()):"vec4"===i?p.fromArray(r,0,f.getCartesian4()):void 0},P.prototype._evaluateLiteralString=function(e,t){return this._value},P.prototype._evaluateVariableString=function(e,t){for(var r=this._value,i=s.exec(r);null!==i;){var n=i[0],o=i[1],a=t.getProperty(o);_(a)||(a=""),r=r.replace(n,a),i=s.exec(r)}return r},P.prototype._evaluateVariable=function(e,t){return t.getProperty(this._value)},P.prototype._evaluateMemberDot=function(e,t){if(N(this._left))return t.getProperty(this._right.evaluate(e,t));var r=this._left.evaluate(e,t);if(_(r)){var i=this._right.evaluate(e,t);if(r instanceof d||r instanceof h||r instanceof p){if("r"===i)return r.x;if("g"===i)return r.y;if("b"===i)return r.z;if("a"===i)return r.w}return r[i]}},P.prototype._evaluateMemberBrackets=function(e,t){if(N(this._left))return t.getProperty(this._right.evaluate(e,t));var r=this._left.evaluate(e,t);if(_(r)){var i=this._right.evaluate(e,t);if(r instanceof d||r instanceof h||r instanceof p){if(0===i||"r"===i)return r.x;if(1===i||"g"===i)return r.y;if(2===i||"b"===i)return r.z;if(3===i||"a"===i)return r.w}return r[i]}},P.prototype._evaluateArray=function(e,t){for(var r=[],i=0;i<this._value.length;i++)r[i]=this._value[i].evaluate(e,t);return r},P.prototype._evaluateNot=function(e,t){var r=this._left.evaluate(e,t);if("boolean"!=typeof r)throw new b('Operator "!" requires a boolean argument. Argument is '+r+".");return!r},P.prototype._evaluateNegative=function(e,t){var r=this._left.evaluate(e,t);if(r instanceof d)return d.negate(r,f.getCartesian2());if(r instanceof h)return h.negate(r,f.getCartesian3());if(r instanceof p)return p.negate(r,f.getCartesian4());if("number"==typeof r)return-r;throw new b('Operator "-" requires a vector or number argument. Argument is '+r+".")},P.prototype._evaluatePositive=function(e,t){var r=this._left.evaluate(e,t);if(!(r instanceof d||r instanceof h||r instanceof p||"number"==typeof r))throw new b('Operator "+" requires a vector or number argument. Argument is '+r+".");return r},P.prototype._evaluateLessThan=function(e,t){var r=this._left.evaluate(e,t),i=this._right.evaluate(e,t);if("number"!=typeof r||"number"!=typeof i)throw new b('Operator "<" requires number arguments. Arguments are '+r+" and "+i+".");return r<i},P.prototype._evaluateLessThanOrEquals=function(e,t){var r=this._left.evaluate(e,t),i=this._right.evaluate(e,t);if("number"!=typeof r||"number"!=typeof i)throw new b('Operator "<=" requires number arguments. Arguments are '+r+" and "+i+".");return r<=i},P.prototype._evaluateGreaterThan=function(e,t){var r=this._left.evaluate(e,t),i=this._right.evaluate(e,t);if("number"!=typeof r||"number"!=typeof i)throw new b('Operator ">" requires number arguments. Arguments are '+r+" and "+i+".");return i<r},P.prototype._evaluateGreaterThanOrEquals=function(e,t){var r=this._left.evaluate(e,t),i=this._right.evaluate(e,t);if("number"!=typeof r||"number"!=typeof i)throw new b('Operator ">=" requires number arguments. Arguments are '+r+" and "+i+".");return i<=r},P.prototype._evaluateOr=function(e,t){var r=this._left.evaluate(e,t);if("boolean"!=typeof r)throw new b('Operator "||" requires boolean arguments. First argument is '+r+".");if(r)return!0;var i=this._right.evaluate(e,t);if("boolean"!=typeof i)throw new b('Operator "||" requires boolean arguments. Second argument is '+i+".");return r||i},P.prototype._evaluateAnd=function(e,t){var r=this._left.evaluate(e,t);if("boolean"!=typeof r)throw new b('Operator "&&" requires boolean arguments. First argument is '+r+".");if(!r)return!1;var i=this._right.evaluate(e,t);if("boolean"!=typeof i)throw new b('Operator "&&" requires boolean arguments. Second argument is '+i+".");return r&&i},P.prototype._evaluatePlus=function(e,t){var r=this._left.evaluate(e,t),i=this._right.evaluate(e,t);if(i instanceof d&&r instanceof d)return d.add(r,i,f.getCartesian2());if(i instanceof h&&r instanceof h)return h.add(r,i,f.getCartesian3());if(i instanceof p&&r instanceof p)return p.add(r,i,f.getCartesian4());if("string"==typeof r||"string"==typeof i)return r+i;if("number"==typeof r&&"number"==typeof i)return r+i;throw new b('Operator "+" requires vector or number arguments of matching types, or at least one string argument. Arguments are '+r+" and "+i+".")},P.prototype._evaluateMinus=function(e,t){var r=this._left.evaluate(e,t),i=this._right.evaluate(e,t);if(i instanceof d&&r instanceof d)return d.subtract(r,i,f.getCartesian2());if(i instanceof h&&r instanceof h)return h.subtract(r,i,f.getCartesian3());if(i instanceof p&&r instanceof p)return p.subtract(r,i,f.getCartesian4());if("number"==typeof r&&"number"==typeof i)return r-i;throw new b('Operator "-" requires vector or number arguments of matching types. Arguments are '+r+" and "+i+".")},P.prototype._evaluateTimes=function(e,t){var r=this._left.evaluate(e,t),i=this._right.evaluate(e,t);if(i instanceof d&&r instanceof d)return d.multiplyComponents(r,i,f.getCartesian2());if(i instanceof d&&"number"==typeof r)return d.multiplyByScalar(i,r,f.getCartesian2());if(r instanceof d&&"number"==typeof i)return d.multiplyByScalar(r,i,f.getCartesian2());if(i instanceof h&&r instanceof h)return h.multiplyComponents(r,i,f.getCartesian3());if(i instanceof h&&"number"==typeof r)return h.multiplyByScalar(i,r,f.getCartesian3());if(r instanceof h&&"number"==typeof i)return h.multiplyByScalar(r,i,f.getCartesian3());if(i instanceof p&&r instanceof p)return p.multiplyComponents(r,i,f.getCartesian4());if(i instanceof p&&"number"==typeof r)return p.multiplyByScalar(i,r,f.getCartesian4());if(r instanceof p&&"number"==typeof i)return p.multiplyByScalar(r,i,f.getCartesian4());if("number"==typeof r&&"number"==typeof i)return r*i;throw new b('Operator "*" requires vector or number arguments. If both arguments are vectors they must be matching types. Arguments are '+r+" and "+i+".")},P.prototype._evaluateDivide=function(e,t){var r=this._left.evaluate(e,t),i=this._right.evaluate(e,t);if(i instanceof d&&r instanceof d)return d.divideComponents(r,i,f.getCartesian2());if(r instanceof d&&"number"==typeof i)return d.divideByScalar(r,i,f.getCartesian2());if(i instanceof h&&r instanceof h)return h.divideComponents(r,i,f.getCartesian3());if(r instanceof h&&"number"==typeof i)return h.divideByScalar(r,i,f.getCartesian3());if(i instanceof p&&r instanceof p)return p.divideComponents(r,i,f.getCartesian4());if(r instanceof p&&"number"==typeof i)return p.divideByScalar(r,i,f.getCartesian4());if("number"==typeof r&&"number"==typeof i)return r/i;throw new b('Operator "/" requires vector or number arguments of matching types, or a number as the second argument. Arguments are '+r+" and "+i+".")},P.prototype._evaluateMod=function(e,t){var r=this._left.evaluate(e,t),i=this._right.evaluate(e,t);if(i instanceof d&&r instanceof d)return d.fromElements(r.x%i.x,r.y%i.y,f.getCartesian2());if(i instanceof h&&r instanceof h)return h.fromElements(r.x%i.x,r.y%i.y,r.z%i.z,f.getCartesian3());if(i instanceof p&&r instanceof p)return p.fromElements(r.x%i.x,r.y%i.y,r.z%i.z,r.w%i.w,f.getCartesian4());if("number"==typeof r&&"number"==typeof i)return r%i;throw new b('Operator "%" requires vector or number arguments of matching types. Arguments are '+r+" and "+i+".")},P.prototype._evaluateEqualsStrict=function(e,t){var r=this._left.evaluate(e,t),i=this._right.evaluate(e,t);return i instanceof d&&r instanceof d||i instanceof h&&r instanceof h||i instanceof p&&r instanceof p?r.equals(i):r===i},P.prototype._evaluateNotEqualsStrict=function(e,t){var r=this._left.evaluate(e,t),i=this._right.evaluate(e,t);return i instanceof d&&r instanceof d||i instanceof h&&r instanceof h||i instanceof p&&r instanceof p?!r.equals(i):r!==i},P.prototype._evaluateConditional=function(e,t){var r=this._test.evaluate(e,t);if("boolean"!=typeof r)throw new b("Conditional argument of conditional expression must be a boolean. Argument is "+r+".");return r?this._left.evaluate(e,t):this._right.evaluate(e,t)},P.prototype._evaluateNaN=function(e,t){return isNaN(this._left.evaluate(e,t))},P.prototype._evaluateIsFinite=function(e,t){return isFinite(this._left.evaluate(e,t))},P.prototype._evaluateIsExactClass=function(e,t){return t.isExactClass(this._left.evaluate(e,t))},P.prototype._evaluateIsClass=function(e,t){return t.isClass(this._left.evaluate(e,t))},P.prototype._evaluategetExactClassName=function(e,t){return t.getExactClassName()},P.prototype._evaluateBooleanConversion=function(e,t){return Boolean(this._left.evaluate(e,t))},P.prototype._evaluateNumberConversion=function(e,t){return Number(this._left.evaluate(e,t))},P.prototype._evaluateStringConversion=function(e,t){return String(this._left.evaluate(e,t))},P.prototype._evaluateRegExp=function(e,t){var r,i=this._value.evaluate(e,t),n="";_(this._left)&&(n=this._left.evaluate(e,t));try{r=new RegExp(i,n)}catch(e){throw new b(e)}return r},P.prototype._evaluateRegExpTest=function(e,t){var r=this._left.evaluate(e,t),i=this._right.evaluate(e,t);if(!(r instanceof RegExp&&"string"==typeof i))throw new b("RegExp.test requires the first argument to be a RegExp and the second argument to be a string. Arguments are "+r+" and "+i+".");return r.test(i)},P.prototype._evaluateRegExpMatch=function(e,t){var r=this._left.evaluate(e,t),i=this._right.evaluate(e,t);if(r instanceof RegExp&&"string"==typeof i)return r.test(i);if(i instanceof RegExp&&"string"==typeof r)return i.test(r);throw new b('Operator "=~" requires one RegExp argument and one string argument. Arguments are '+r+" and "+i+".")},P.prototype._evaluateRegExpNotMatch=function(e,t){var r=this._left.evaluate(e,t),i=this._right.evaluate(e,t);if(r instanceof RegExp&&"string"==typeof i)return!r.test(i);if(i instanceof RegExp&&"string"==typeof r)return!i.test(r);throw new b('Operator "!~" requires one RegExp argument and one string argument. Arguments are '+r+" and "+i+".")},P.prototype._evaluateRegExpExec=function(e,t){var r=this._left.evaluate(e,t),i=this._right.evaluate(e,t);if(!(r instanceof RegExp&&"string"==typeof i))throw new b("RegExp.exec requires the first argument to be a RegExp and the second argument to be a string. Arguments are "+r+" and "+i+".");var n=r.exec(i);return _(n)?n[1]:null},P.prototype._evaluateToString=function(e,t){var r=this._left.evaluate(e,t);if(r instanceof RegExp||r instanceof d||r instanceof h||r instanceof p)return String(r);throw new b('Unexpected function call "'+this._value+'".')},P.prototype.getShaderExpression=function(e,t,r){var i,n,o,a,s,l=this._type,u=this._value;switch(_(this._left)&&(n=y(this._left)?V(this._left,e,t,this):this._left.getShaderExpression(e,t,this)),_(this._right)&&(o=this._right.getShaderExpression(e,t,this)),_(this._test)&&(a=this._test.getShaderExpression(e,t,this)),y(this._value)&&(u=V(this._value,e,t,this)),l){case C.VARIABLE:return e+u;case C.UNARY:if("Boolean"===u)return"bool("+n+")";if("Number"===u)return"float("+n+")";if("round"===u)return"floor("+n+" + 0.5)";if(_(T[u]))return u+"("+n+")";if("isNaN"===u||"isFinite"===u||"String"===u||"isExactClass"===u||"isClass"===u||"getExactClassName"===u)throw new b('Error generating style shader: "'+u+'" is not supported.');return _(T[u])?u+"("+n+")":u+n;case C.BINARY:return"%"===u?"mod("+n+", "+o+")":"==="===u?"("+n+" == "+o+")":"!=="===u?"("+n+" != "+o+")":"atan2"===u?"atan("+n+", "+o+")":_(E[u])?u+"("+n+", "+o+")":"("+n+" "+u+" "+o+")";case C.TERNARY:if(_(A[u]))return u+"("+n+", "+o+", "+a+")";break;case C.CONDITIONAL:return"("+a+" ? "+n+" : "+o+")";case C.MEMBER:return"r"===o||"x"===o||"0.0"===o?n+"[0]":"g"===o||"y"===o||"1.0"===o?n+"[1]":"b"===o||"z"===o||"2.0"===o?n+"[2]":"a"===o||"w"===o||"3.0"===o?n+"[3]":n+"[int("+o+")]";case C.FUNCTION_CALL:throw new b('Error generating style shader: "'+u+'" is not supported.');case C.ARRAY:if(4===u.length)return"vec4("+u[0]+", "+u[1]+", "+u[2]+", "+u[3]+")";if(3===u.length)return"vec3("+u[0]+", "+u[1]+", "+u[2]+")";if(2===u.length)return"vec2("+u[0]+", "+u[1]+")";throw new b("Error generating style shader: Invalid array length. Array length should be 2, 3, or 4.");case C.REGEX:throw new b("Error generating style shader: Regular expressions are not supported.");case C.VARIABLE_IN_STRING:throw new b("Error generating style shader: Converting a variable to a string is not supported.");case C.LITERAL_NULL:throw new b("Error generating style shader: null is not supported.");case C.LITERAL_BOOLEAN:return u?"true":"false";case C.LITERAL_NUMBER:return B(u);case C.LITERAL_STRING:if(_(r)&&r._type===C.MEMBER&&("r"===u||"g"===u||"b"===u||"a"===u||"x"===u||"y"===u||"z"===u||"w"===u))return u;if(i=g.fromCssColorString(u,S),_(i))return"vec3("+B((s=i).red)+", "+B(s.green)+", "+B(s.blue)+")";throw new b("Error generating style shader: String literals are not supported.");case C.LITERAL_COLOR:var c=n;if("color"===u){if(!_(c))return"vec4(1.0)";if(1<c.length){var d=c[0],h=c[1];return"1.0"!==h&&(t.translucent=!0),"vec4("+d+", "+h+")"}return"vec4("+c[0]+", 1.0)"}if("rgb"===u)return i=F(this),_(i)?U(i):"vec4("+c[0]+" / 255.0, "+c[1]+" / 255.0, "+c[2]+" / 255.0, 1.0)";if("rgba"===u)return"1.0"!==c[3]&&(t.translucent=!0),i=F(this),_(i)?U(i):"vec4("+c[0]+" / 255.0, "+c[1]+" / 255.0, "+c[2]+" / 255.0, "+c[3]+")";if("hsl"===u)return i=k(this),_(i)?U(i):"vec4(czm_HSLToRGB(vec3("+c[0]+", "+c[1]+", "+c[2]+")), 1.0)";if("hsla"===u)return i=k(this),_(i)?(1!==i.alpha&&(t.translucent=!0),U(i)):("1.0"!==c[3]&&(t.translucent=!0),"vec4(czm_HSLToRGB(vec3("+c[0]+", "+c[1]+", "+c[2]+")), "+c[3]+")");break;case C.LITERAL_VECTOR:if(!_(n))throw new v("left should always be defined for type ExpressionNodeType.LITERAL_VECTOR");for(var p=n.length,f=u+"(",m=0;m<p;++m)f+=n[m],m<p-1&&(f+=", ");return f+=")";case C.LITERAL_REGEX:throw new b("Error generating style shader: Regular expressions are not supported.");case C.LITERAL_UNDEFINED:throw new b("Error generating style shader: undefined is not supported.");case C.BUILTIN_VARIABLE:if("tiles3d_tileset_time"===u)return"u_tilesetTime"}},r}),define("Scene/Vector3DTilePrimitive",["../Core/Cartesian3","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/IndexDatatype","../Core/Matrix4","../Core/PrimitiveType","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../Shaders/ShadowVolumeFS","../Shaders/ShadowVolumeVS","./BlendingState","./Cesium3DTileFeature","./ClassificationType","./DepthFunction","./Expression","./StencilFunction","./StencilOperation","./Vector3DTileBatch"],function(n,y,a,v,b,e,t,s,C,l,u,c,w,d,h,p,f,m,g,_,r,S,T,i,E,o,A,x){"use strict";function P(e){e=v(e,v.EMPTY_OBJECT),this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._positions=e.positions,this._vertexBatchIds=e.vertexBatchIds,this._indices=e.indices,this._indexCounts=e.indexCounts,this._indexOffsets=e.indexOffsets,this._batchedIndices=e.batchedIndices,this._boundingVolume=e.boundingVolume,this._boundingVolumes=e.boundingVolumes,this._center=v(e.center,n.ZERO),this._va=void 0,this._sp=void 0,this._spStencil=void 0,this._spPick=void 0,this._uniformMap=void 0,this._vaSwap=void 0,this._rsStencilPreloadPass=void 0,this._rsStencilDepthPass=void 0,this._rsColorPass=void 0,this._rsPickPass=void 0,this._rsWireframe=void 0,this._commands=[],this._commandsIgnoreShow=[],this._pickCommands=[],this._constantColor=y.clone(y.WHITE),this._highlightColor=this._constantColor,this._batchDirty=!0,this._pickCommandsDirty=!0,this._framesSinceLastRebatch=0,this._updatingAllCommands=!1,this._trianglesLength=this._indices.length/3,this._geometryByteLength=this._indices.byteLength+this._positions.byteLength+this._vertexBatchIds.byteLength,this.debugWireframe=!1,this._debugWireframe=this.debugWireframe,this._wireframeDirty=!1,this.forceRebatch=!1,this.classificationType=v(e.classificationType,T.BOTH),this._vertexShaderSource=e._vertexShaderSource,this._fragmentShaderSource=e._fragmentShaderSource,this._attributeLocations=e._attributeLocations,this._pickVertexShaderSource=e._pickVertexShaderSource,this._pickFragmentShaderSource=e._pickFragmentShaderSource,this._uniformMap=e._uniformMap,this._pickUniformMap=e._pickUniformMap,this._modelMatrix=e._modelMatrix,this._boundingSphere=e._boundingSphere,this._batchIdLookUp={};for(var t=this._batchIds.length,r=0;r<t;++r){var i=this._batchIds[r];this._batchIdLookUp[i]=r}}e(P.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}}});var D={position:0,a_batchId:1};var O={colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:!0,frontFunction:o.ALWAYS,frontOperation:{fail:A.KEEP,zFail:A.DECREMENT_WRAP,zPass:A.DECREMENT_WRAP},backFunction:o.ALWAYS,backOperation:{fail:A.KEEP,zFail:A.INCREMENT_WRAP,zPass:A.INCREMENT_WRAP},reference:0,mask:15},depthTest:{enabled:!1},depthMask:!1},I={colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:!0,frontFunction:o.ALWAYS,frontOperation:{fail:A.KEEP,zFail:A.KEEP,zPass:A.INCREMENT_WRAP},backFunction:o.ALWAYS,backOperation:{fail:A.KEEP,zFail:A.KEEP,zPass:A.DECREMENT_WRAP},reference:0,mask:15},depthTest:{enabled:!0,func:i.LESS_OR_EQUAL},depthMask:!1},M={stencilTest:{enabled:!0,frontFunction:o.NOT_EQUAL,frontOperation:{fail:A.KEEP,zFail:A.KEEP,zPass:A.DECREMENT_WRAP},backFunction:o.NOT_EQUAL,backOperation:{fail:A.KEEP,zFail:A.KEEP,zPass:A.DECREMENT_WRAP},reference:0,mask:15},depthTest:{enabled:!1},depthMask:!1,blending:r.ALPHA_BLEND},R={stencilTest:{enabled:!0,frontFunction:o.NOT_EQUAL,frontOperation:{fail:A.KEEP,zFail:A.KEEP,zPass:A.DECREMENT_WRAP},backFunction:o.NOT_EQUAL,backOperation:{fail:A.KEEP,zFail:A.KEEP,zPass:A.DECREMENT_WRAP},reference:0,mask:15},depthTest:{enabled:!1},depthMask:!1};var L=new C,N=new n;function k(e,t,r,i,n,o,a){for(var s=e.constructor.BYTES_PER_ELEMENT,l=o.length,u=0;u<l;++u){var c=a[o[u]],d=i[c],h=n[c],p=new e.constructor(e.buffer,s*d,h);t.set(p,r),i[c]=r,r+=h}return r}function F(e,t,r,i,n,o,a){for(var s=e.bytesPerIndex,l=o.length,u=0;u<l;++u){var c=a[o[u]],d=i[c],h=n[c];t.copyFromBuffer(e,d*s,r*s,h*s),i[c]=r,r+=h}return r}function B(e,t){return t.color.toRgba()-e.color.toRgba()}function U(e,t){if(!e._batchDirty)return!1;for(var r=e._batchedIndices,i=r.length,n=!1,o={},a=0;a<i;++a){var s=r[a].color.toRgba();if(b(o[s])){n=!0;break}o[s]=!0}return n?n&&!e.forceRebatch&&e._framesSinceLastRebatch<120?void++e._framesSinceLastRebatch:(r.sort(B),t.webgl2?function(e,t){var r=e._indexOffsets,i=e._indexCounts,n=e._batchIdLookUp,o=t.pop(),a=[o],s=e._va.indexBuffer,l=e._vaSwap.indexBuffer,u=F(s,l,0,r,i,o.batchIds,n);for(o.offset=0,o.count=u;0<t.length;){var c=t.pop();if(y.equals(c.color,o.color))u=F(s,l,u,r,i,c.batchIds,n),o.batchIds=o.batchIds.concat(c.batchIds),o.count=u-o.offset;else{var d=u;u=F(s,l,u,r,i,c.batchIds,n),c.offset=d,c.count=u-d,a.push(c),o=c}}var h=e._va;e._va=e._vaSwap,e._vaSwap=h,e._batchedIndices=a}(e,r):function(e,t){var r=e._indices,i=e._indexOffsets,n=e._indexCounts,o=e._batchIdLookUp,a=new r.constructor(r.length),s=t.pop(),l=[s],u=k(r,a,0,i,n,s.batchIds,o);for(s.offset=0,s.count=u;0<t.length;){var c=t.pop();if(y.equals(c.color,s.color))u=k(r,a,u,i,n,c.batchIds,o),s.batchIds=s.batchIds.concat(c.batchIds),s.count=u-s.offset;else{var d=u;u=k(r,a,u,i,n,c.batchIds,o),c.offset=d,c.count=u-d,l.push(c),s=c}}e._va.indexBuffer.copyFromArrayView(a),e._indices=a,e._batchedIndices=l}(e,r),e._framesSinceLastRebatch=0,e._batchDirty=!1,e._pickCommandsDirty=!0,e._wireframeDirty=!0):e._batchDirty=!1}P.prototype.createFeatures=function(e,t){for(var r=this._batchIds,i=r.length,n=0;n<i;++n){var o=r[n];t[o]=new S(e,o)}},P.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:this._constantColor};var V=new y,z=y.WHITE,q=/\$/;function G(e,t,r,i){var n,o,a=e.commandList,s=r.length;for(n=0;n<s;++n)(o=r[n]).pass=t,a.push(o);if(e.invertClassification&&b(i))for(s=i.length,n=0;n<s;++n)(o=i[n]).pass=t,a.push(o)}return P.prototype.applyStyle=function(e,t,r){if(b(t)){var i=t.color,n=i instanceof E&&!q.test(i.expression);this._updatingAllCommands=n;var o,a=this._batchIds,s=a.length;for(o=0;o<s;++o){var l=r[a[o]];l.color=b(t.color)?t.color.evaluateColor(e,l,V):z,l.show=!b(t.show)||t.show.evaluate(e,l)}if(n){var u=this._batchedIndices;for(s=u.length,o=0;o<s;++o)u[o].color=y.clone(y.WHITE);this._updatingAllCommands=!1,this._batchDirty=!0}}else!function(e,t){e._updatingAllCommands=!0;var r,i=e._batchIds,n=i.length;for(r=0;r<n;++r){var o=t[i[r]];o.show=!0,o.color=y.WHITE}var a=e._batchedIndices;for(n=a.length,r=0;r<n;++r)a[r].color=y.clone(y.WHITE);e._updatingAllCommands=!1,e._batchDirty=!0}(this,r)},P.prototype.updateCommands=function(e,t){if(!this._updatingAllCommands){var r=this._batchIdLookUp,i=r[e];if(b(i)){var n,o=this._indexOffsets,a=this._indexCounts,s=o[i],l=a[i],u=this._batchedIndices,c=u.length;for(n=0;n<c;++n){var d=u[n].offset,h=u[n].count;if(d<=s&&s<d+h)break}u.push(new x({color:y.clone(t),offset:s,count:l,batchIds:[e]}));for(var p=[],f=[],m=u[n].batchIds,g=m.length,_=0;_<g;++_){var v=m[_];if(v!==e)o[r[v]]<s?p.push(v):f.push(v)}0!==f.length&&u.push(new x({color:y.clone(u[n].color),offset:s+l,count:u[n].offset+u[n].count-(s+l),batchIds:f})),0!==p.length?(u[n].count=s-u[n].offset,u[n].batchIds=p):u.splice(n,1),this._batchDirty=!0}}},P.prototype.update=function(e){var t,r,i=e.context;switch(function(e,t){if(!b(e._va)){var r=u.createVertexBuffer({context:t,typedArray:e._positions,usage:c.STATIC_DRAW}),i=u.createVertexBuffer({context:t,typedArray:e._vertexBatchIds,usage:c.STATIC_DRAW}),n=u.createIndexBuffer({context:t,typedArray:e._indices,usage:c.DYNAMIC_DRAW,indexDatatype:2===e._indices.BYTES_PER_ELEMENT?s.UNSIGNED_SHORT:s.UNSIGNED_INT}),o=[{index:0,vertexBuffer:r,componentDatatype:a.fromTypedArray(e._positions),componentsPerAttribute:3},{index:1,vertexBuffer:i,componentDatatype:a.fromTypedArray(e._vertexBatchIds),componentsPerAttribute:1}];e._va=new m({context:t,attributes:o,indexBuffer:n}),t.webgl2&&(e._vaSwap=new m({context:t,attributes:o,indexBuffer:u.createIndexBuffer({context:t,sizeInBytes:n.sizeInBytes,usage:c.DYNAMIC_DRAW,indexDatatype:n.indexDatatype})})),e._batchedPositions=void 0,e._transferrableBatchIds=void 0,e._vertexBatchIds=void 0,e._verticesPromise=void 0}}(this,i),function(e,t){if(!b(e._sp)){var r=e._batchTable,i=v(e._attributeLocations,D),n=e._vertexShaderSource;if(b(n))return e._sp=p.fromCache({context:t,vertexShaderSource:n,fragmentShaderSource:e._fragmentShaderSource,attributeLocations:i}),e._spStencil=e._sp,e._spPick=p.fromCache({context:t,vertexShaderSource:e._pickVertexShaderSource,fragmentShaderSource:e._pickFragmentShaderSource,attributeLocations:i});var o=r.getVertexShaderCallback(!1,"a_batchId",void 0)(_),a=r.getFragmentShaderCallback()(g,!1,void 0),s=new f({defines:["VECTOR_TILE"],sources:[o]}),l=new f({defines:["VECTOR_TILE"],sources:[a]});e._sp=p.fromCache({context:t,vertexShaderSource:s,fragmentShaderSource:l,attributeLocations:i}),s=new f({defines:["VECTOR_TILE"],sources:[_]}),l=new f({defines:["VECTOR_TILE"],sources:[g]}),e._spStencil=p.fromCache({context:t,vertexShaderSource:s,fragmentShaderSource:l,attributeLocations:i}),o=r.getPickVertexShaderCallbackIgnoreShow("a_batchId")(_),a=r.getPickFragmentShaderCallbackIgnoreShow()(g);var u=new f({defines:["VECTOR_TILE"],sources:[o]}),c=new f({defines:["VECTOR_TILE"],sources:[a]});e._spPick=p.fromCache({context:t,vertexShaderSource:u,fragmentShaderSource:c,attributeLocations:i})}}(this,i),b((t=this)._rsStencilPreloadPass)||(t._rsStencilPreloadPass=h.fromCache(O),t._rsStencilDepthPass=h.fromCache(I),t._rsColorPass=h.fromCache(M),t._rsPickPass=h.fromCache(R)),function(r,i){if(!b(r._uniformMap)){var e={u_modifiedModelViewProjection:function(){var e=i.uniformState.view,t=i.uniformState.projection;return C.clone(e,L),C.multiplyByPoint(L,r._center,N),C.setTranslation(L,N,L),C.multiply(t,L,L),L},u_highlightColor:function(){return r._highlightColor}};r._uniformMap=r._batchTable.getUniformMapCallback()(e),r._pickUniformMap=r._batchTable.getPickUniformMapCallback()(r._uniformMap)}}(this,i),this.classificationType){case T.TERRAIN:r=d.TERRAIN_CLASSIFICATION;break;case T.CESIUM_3D_TILE:r=d.CESIUM_3D_TILE_CLASSIFICATION;break;default:r=d.CLASSIFICATION}var n=e.passes;n.render&&(function(e,t){var r=U(e,t),i=e._commands,n=e._batchedIndices,o=n.length,a=3*o;if(!b(i)||r||i.length!==a){i.length=a;for(var s=e._va,l=e._sp,u=v(e._modelMatrix,C.IDENTITY),c=e._uniformMap,d=e._boundingVolume,h=0;h<o;++h){var p=n[h].offset,f=n[h].count,m=i[3*h];b(m)||(m=i[3*h]=new w({owner:e})),m.vertexArray=s,m.modelMatrix=u,m.offset=p,m.count=f,m.renderState=e._rsStencilPreloadPass,m.shaderProgram=l,m.uniformMap=c,m.boundingVolume=d,m.cull=!1;var g=i[3*h+1];b(g)||(g=i[3*h+1]=new w({owner:e})),g.vertexArray=s,g.modelMatrix=u,g.offset=p,g.count=f,g.renderState=e._rsStencilDepthPass,g.shaderProgram=l,g.uniformMap=c,g.boundingVolume=d,g.cull=!1;var _=i[3*h+2];b(_)||(_=i[3*h+2]=new w({owner:e})),_.vertexArray=s,_.modelMatrix=u,_.offset=p,_.count=f,_.renderState=e._rsColorPass,_.shaderProgram=l,_.uniformMap=c,_.boundingVolume=d,_.cull=!1}e._commandsDirty=!0}}(this,i),function(e,t){if(e.classificationType!==T.TERRAIN&&t.invertClassification&&(!b(e._commandsIgnoreShow)||e._commandsDirty)){for(var r=e._commands,i=e._commandsIgnoreShow,n=e._spStencil,o=r.length,a=i.length=o/3*2,s=0,l=0;l<a;l+=2){var u=i[l]=w.shallowClone(r[s],i[l]);u.shaderProgram=n,u.pass=d.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,(u=i[l+1]=w.shallowClone(r[s+1],i[l+1])).shaderProgram=n,u.pass=d.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,s+=3}e._commandsDirty=!1}}(this,e),function(e){var t=e.debugWireframe===e._debugWireframe;if(!(t=t&&!(e.debugWireframe&&e._wireframeDirty))){var r,i;b(e._rsWireframe)||(e._rsWireframe=h.fromCache({})),i=e.debugWireframe?(r=e._rsWireframe,l.LINES):(r=e._rsColorPass,l.TRIANGLES);for(var n=e._commands,o=n.length,a=0;a<o;a+=3){var s=n[a+2];s.renderState=r,s.primitiveType=i}e._debugWireframe=e.debugWireframe,e._wireframeDirty=!1}}(this),this._debugWireframe?function(e,t){for(var r=e.commandList,i=t.length,n=0;n<i;n+=3){var o=t[n+2];o.pass=d.OPAQUE,r.push(o)}}(e,this._commands):G(e,r,this._commands,this._commandsIgnoreShow)),n.pick&&(!function(e){if(e._pickCommandsDirty){var t=e._indexOffsets.length,r=e._pickCommands;r.length=3*t;for(var i=e._va,n=e._spStencil,o=e._spPick,a=v(e._modelMatrix,C.IDENTITY),s=e._pickUniformMap,l=0;l<t;++l){var u=e._indexOffsets[l],c=e._indexCounts[l],d=b(e._boundingVolumes)?e._boundingVolumes[l]:e.boundingVolume,h=r[3*l];b(h)||(h=r[3*l]=new w({owner:e})),h.vertexArray=i,h.modelMatrix=a,h.offset=u,h.count=c,h.renderState=e._rsStencilPreloadPass,h.shaderProgram=n,h.uniformMap=s,h.boundingVolume=d;var p=r[3*l+1];b(p)||(p=r[3*l+1]=new w({owner:e})),p.vertexArray=i,p.modelMatrix=a,p.offset=u,p.count=c,p.renderState=e._rsStencilDepthPass,p.shaderProgram=n,p.uniformMap=s,p.boundingVolume=d;var f=r[3*l+2];b(f)||(f=r[3*l+2]=new w({owner:e})),f.vertexArray=i,f.modelMatrix=a,f.offset=u,f.count=c,f.renderState=e._rsPickPass,f.shaderProgram=o,f.uniformMap=s,f.boundingVolume=d}e._pickCommandsDirty=!1}}(this),G(e,r,this._pickCommands))},P.prototype.isDestroyed=function(){return!1},P.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._vaSwap=this._vaSwap&&this._vaSwap.destroy(),t(this)},P}),define("Scene/ClassificationModel",["../Core/arraySlice","../Core/BoundingSphere","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/Color","../Core/combine","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/FeatureDetection","../Core/IndexDatatype","../Core/Matrix4","../Core/PrimitiveType","../Core/Quaternion","../Core/Resource","../Core/RuntimeError","../Core/Transforms","../Core/WebGLConstants","../ThirdParty/GltfPipeline/ForEach","../ThirdParty/GltfPipeline/getAccessorByteStride","../ThirdParty/GltfPipeline/numberOfComponentsForType","../ThirdParty/GltfPipeline/parseBinaryGltf","../ThirdParty/when","./Axis","./ClassificationType","./ModelLoadResources","./ModelUtility","./SceneMode","./Vector3DTileBatch","./Vector3DTilePrimitive"],function(G,W,H,_,e,j,Y,X,v,Q,t,r,i,n,Z,K,J,o,u,c,y,b,C,h,p,d,f,w,a,S,$,T,ee,te){"use strict";if(!n.supportsTypedArrays())return{};var s=new H,E={NEEDS_LOAD:0,LOADING:1,LOADED:2,FAILED:3};function l(e){var t=(e=v(e,v.EMPTY_OBJECT)).gltf;if(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),!(t instanceof Uint8Array))throw new c("Only binary glTF is supported as a classifier.");var r=(t=d(t)).nodes,i=t.meshes,n=r[0].mesh;if(1!==r.length||!Q(n))throw new c("Only one node is supported for classification and it must have a mesh.");if(1!==i.length)throw new c("Only one mesh is supported when using b3dm for classification.");var o=i[0].primitives;if(1!==o.length)throw new c("Only one primitive per mesh is supported when using b3dm for classification.");var a=o[0].attributes.POSITION;if(!Q(a))throw new c("The mesh must have a position attribute.");var s=o[0].attributes._BATCHID;if(!Q(s))throw new c("The mesh must have a batch id attribute.");this._gltf=t;var l=v(e.basePath,"");this._resource=u.createIfNeeded(l),this.show=v(e.show,!0),this.modelMatrix=K.clone(v(e.modelMatrix,K.IDENTITY)),this._modelMatrix=K.clone(this.modelMatrix),this._ready=!1,this._readyPromise=f.defer(),this.debugShowBoundingVolume=v(e.debugShowBoundingVolume,!1),this._debugShowBoundingVolume=!1,this.debugWireframe=v(e.debugWireframe,!1),this._debugWireframe=!1,this._classificationType=e.classificationType,this._vertexShaderLoaded=e.vertexShaderLoaded,this._classificationShaderLoaded=e.classificationShaderLoaded,this._uniformMapLoaded=e.uniformMapLoaded,this._pickVertexShaderLoaded=e.pickVertexShaderLoaded,this._pickFragmentShaderLoaded=e.pickFragmentShaderLoaded,this._pickUniformMapLoaded=e.pickUniformMapLoaded,this._ignoreCommands=v(e.ignoreCommands,!1),this._upAxis=v(e.upAxis,w.Y),this._batchTable=e.batchTable,this._computedModelMatrix=new K,this._initialRadius=void 0,this._boundingSphere=void 0,this._scaledBoundingSphere=new W,this._state=E.NEEDS_LOAD,this._loadResources=void 0,this._mode=void 0,this._dirty=!1,this._nodeMatrix=new K,this._primitive=void 0,this._extensionsUsed=void 0,this._extensionsRequired=void 0,this._quantizedUniforms=void 0,this._buffers={},this._vertexArray=void 0,this._shaderProgram=void 0,this._pickShaderProgram=void 0,this._uniformMap=void 0,this._geometryByteLength=0,this._trianglesLength=0,this._rtcCenter=void 0,this._rtcCenterEye=void 0,this._rtcCenter3D=void 0,this._rtcCenter2D=void 0}t(l.prototype,{gltf:{get:function(){return this._gltf}},basePath:{get:function(){return this._resource.url}},boundingSphere:{get:function(){if(this._state!==E.LOADED)throw new i("The model is not loaded.  Use ClassificationModel.readyPromise or wait for ClassificationModel.ready to be true.");var e=this.modelMatrix,t=K.getScale(e,s),r=this._scaledBoundingSphere;return r.center=H.multiplyComponents(this._boundingSphere.center,t,r.center),r.radius=H.maximumComponent(t)*this._initialRadius,Q(this._rtcCenter)&&H.add(this._rtcCenter,r.center,r.center),r}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},dirty:{get:function(){return this._dirty}},extensionsUsed:{get:function(){return Q(this._extensionsUsed)||(this._extensionsUsed=$.getUsedExtensions(this.gltf)),this._extensionsUsed}},extensionsRequired:{get:function(){return Q(this._extensionsRequired)||(this._extensionsRequired=$.getRequiredExtensions(this.gltf)),this._extensionsRequired}},upAxis:{get:function(){return this._upAxis}},trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},texturesByteLength:{get:function(){return 0}},classificationType:{get:function(){return this._classificationType}}});var A=new H,x=new H;function P(e,t,r){return function(){e._state=E.FAILED,e._readyPromise.reject(new c("Failed to load "+t+": "+r))}}function D(i,n){return function(e){var t=i._loadResources,r=new Uint8Array(e);--t.pendingBufferLoads,i.gltf.buffers[n].extras._pipeline.source=r}}function O(e,t){return Q(t)&&(e=t(e)),e}function m(e){var t=$.getAttributeOrUniformBySemantic(e.gltf,"POSITION"),r=$.getAttributeOrUniformBySemantic(e.gltf,"_BATCHID"),i={};i[t]=0,i[r]=1;var n,o,a=$.getAttributeOrUniformBySemantic(e.gltf,"MODELVIEWPROJECTION");if(Q(a))n="uniform mat4 "+a+";\n",o="    vec4 positionInClipCoords = "+a+" * vec4("+t+", 1.0);\n";else{var s=$.getAttributeOrUniformBySemantic(e.gltf,"PROJECTION"),l=$.getAttributeOrUniformBySemantic(e.gltf,"MODELVIEW");Q(l)||(l=$.getAttributeOrUniformBySemantic(e.gltf,"CESIUM_RTC_MODELVIEW")),n="uniform mat4 "+l+";\nuniform mat4 "+s+";\n",o="    vec4 positionInClipCoords = "+s+" * "+l+" * vec4("+t+", 1.0);\n"}var u,c,d,h,p="attribute vec3 "+t+";\nattribute float "+r+";\n"+n+"void main() {\n"+o+"    gl_Position = czm_depthClampFarPlane(positionInClipCoords);\n}\n",f="#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\nvoid main() \n{ \n    gl_FragColor = vec4(1.0); \n    czm_writeDepthClampedToFarPlane();\n}\n";e.extensionsUsed.WEB3D_quantized_attributes&&(u=p,d=(c=e).gltf.meshes[0].primitives[0],h=$.modifyShaderForQuantizedAttributes(c.gltf,d,u),c._quantizedUniforms=h.uniforms,p=h.shader);var m=O(p,e._vertexShaderLoaded),g=O(f,e._classificationShaderLoaded);e._shaderProgram={vertexShaderSource:m,fragmentShaderSource:g,attributeLocations:i};var _=O(p,e._pickVertexShaderLoaded),v=O(f,e._pickFragmentShaderLoaded);e._pickShaderProgram={vertexShaderSource:_,fragmentShaderSource:v,attributeLocations:i}}var g={PROJECTION:function(e,t){return $.getGltfSemanticUniforms().PROJECTION(e,t)},MODELVIEW:function(e,t){return $.getGltfSemanticUniforms().MODELVIEW(e,t)},CESIUM_RTC_MODELVIEW:function(e,t){return $.getGltfSemanticUniforms().CESIUM_RTC_MODELVIEW(e,t)},MODELVIEWPROJECTION:function(e,t){return $.getGltfSemanticUniforms().MODELVIEWPROJECTION(e,t)}};function I(e){var t,r,i,n,o=e._batchTable,a=e._uniformMap,s=e._vertexArray,l=e.gltf,u=l.accessors,c=l.meshes[0].primitives[0],d=u[c.indices],h=c.attributes.POSITION,p=$.getAccessorMinMax(l,h),f=W.fromCornerPoints(H.fromArray(p.min),H.fromArray(p.max));Q(d)?(r=d.count,t=d.byteOffset/Z.getSizeInBytes(d.componentType)):(r=u[c.attributes.POSITION].count,t=0);if(e._trianglesLength+=function(e,t){switch(e.mode){case J.TRIANGLES:return t/3;case J.TRIANGLE_STRIP:case J.TRIANGLE_FAN:return Math.max(t-2,0);default:return 0}}(c,r),Q(e._uniformMapLoaded)&&(a=e._uniformMapLoaded(a)),e.extensionsUsed.WEB3D_quantized_attributes){var m=(i=e,n=c,$.createUniformsForQuantizedAttributes(i.gltf,n,i._quantizedUniforms));a=Y(a,m)}var g=s.attributes.POSITION,_=g.componentDatatype,v=g.vertexBuffer,y=v.byteOffset,b=v.byteLength/X.getSizeInBytes(_),C=X.createArrayBufferView(_,v.buffer,y,b);_=(g=s.attributes._BATCHID).componentDatatype,y=(v=g.vertexBuffer).byteOffset,b=v.byteLength/X.getSizeInBytes(_);var w,S=X.createArrayBufferView(_,v.buffer,y,b),T=s.indexBuffer.typedArray;w=s.indexBuffer.indexDatatype===Z.UNSIGNED_SHORT?new Uint16Array(T.buffer,T.byteOffset,T.byteLength/Uint16Array.BYTES_PER_ELEMENT):new Uint32Array(T.buffer,T.byteOffset,T.byteLength/Uint32Array.BYTES_PER_ELEMENT),C=G(C);var E,A,x,P=[],D=[],O=[],I=[],M=(S=G(S))[(w=G(w,t,t+r))[0]];P.push(M),O.push(0);for(var R=w.length,L=1;L<R;++L)(E=S[w[L]])!==M&&(x=L-(A=O[O.length-1]),P.push(E),D.push(x),O.push(L),I.push(new ee({offset:A,count:x,batchIds:[M],color:j.WHITE})),M=E);x=R-(A=O[O.length-1]),D.push(x),I.push(new ee({offset:A,count:x,batchIds:[M],color:j.WHITE}));var N,k=e._shaderProgram,F=k.vertexShaderSource,B=k.fragmentShaderSource,U=k.attributeLocations,V=e._pickShaderProgram,z=V.vertexShaderSource,q=V.fragmentShaderSource;N=Q(e._pickUniformMapLoaded)?e._pickUniformMapLoaded(a):Y(a),e._primitive=new te({classificationType:e._classificationType,positions:C,indices:w,indexOffsets:O,indexCounts:D,batchIds:P,vertexBatchIds:S,batchedIndices:I,batchTable:o,boundingVolume:new W,_vertexShaderSource:F,_fragmentShaderSource:B,_attributeLocations:U,_pickVertexShaderSource:z,_pickFragmentShaderSource:q,_uniformMap:a,_pickUniformMap:N,_modelMatrix:new K,_boundingSphere:f}),e._buffers=void 0,e._vertexArray=void 0,e._shaderProgram=void 0,e._pickShaderProgram=void 0,e._uniformMap=void 0}function M(e,t){var r=t.context;$.checkSupportedGlExtensions(e.gltf.glExtensionsUsed,r),function(e){var t=e._loadResources;if(0===t.pendingBufferLoads){for(var r,i,n,o,a,s,l,u,c,d,h,p=t.vertexBuffersToCreate,f=t.indexBuffersToCreate;0<p.length;)r=p.dequeue(),n=void 0,n=(i=e)._loadResources,o=i.gltf.bufferViews[r],a=n.getBuffer(o),i._buffers[r]=a,i._geometryByteLength+=a.byteLength;for(;0<f.length;){var m=f.dequeue();s=m.id,l=m.componentType,c=void 0,c=(u=e)._loadResources,d=u.gltf.bufferViews[s],h={typedArray:c.getBuffer(d),indexDatatype:l},u._buffers[s]=h,u._geometryByteLength+=h.typedArray.byteLength}}}(e),m(e),function(e){if(e._loadResources.finishedBuffersCreation()&&!Q(e._vertexArray)){var t,r=e._buffers,i=e.gltf,n=i.accessors,o=i.meshes[0].primitives[0],a={POSITION:0,_BATCHID:1},s={},l=o.attributes;for(var u in l)if(l.hasOwnProperty(u)){var c=a[u];if(Q(c)){var d=n[l[u]];s[u]={index:c,vertexBuffer:r[d.bufferView],componentsPerAttribute:p(d.type),componentDatatype:d.componentType,offsetInBytes:d.byteOffset,strideInBytes:h(i,d)}}}Q(o.indices)&&(t=r[n[o.indices].bufferView]),e._vertexArray={attributes:s,indexBuffer:t}}}(e),function(e,t){if(!Q(e._uniformMap)){var r=e.gltf.techniques[0],i=r.parameters,n=r.uniforms,o={};for(var a in n)if(n.hasOwnProperty(a)&&"extras"!==a){var s=i[n[a]];if(!Q(s.semantic)||!Q(g[s.semantic]))continue;o[a]=g[s.semantic](t.uniformState,e)}e._uniformMap=o}}(e,r),function(e){if(e._loadResources.finished()&&!Q(e._primitive)){var t=e.gltf.nodes[0];e._nodeMatrix=$.getTransform(t,e._nodeMatrix),I(e)}}(e)}var R=new _,L=new K;return l.prototype.updateCommands=function(e,t){this._primitive.updateCommands(e,t)},l.prototype.update=function(e){if(e.mode!==T.MORPHING){if(this._state===E.NEEDS_LOAD&&Q(this.gltf)&&(this._state=E.LOADING,this._state!==E.FAILED)){var t=this.gltf.extensions;if(Q(t)&&Q(t.CESIUM_RTC)){var r=H.fromArray(t.CESIUM_RTC.center);if(!H.equals(r,H.ZERO)){this._rtcCenter3D=r;var i=e.mapProjection,n=i.ellipsoid.cartesianToCartographic(this._rtcCenter3D),o=i.project(n);H.fromElements(o.z,o.x,o.y,o),this._rtcCenter2D=o,this._rtcCenterEye=new H,this._rtcCenter=this._rtcCenter3D}}this._loadResources=new S,function(e){for(var t=e._loadResources,r=e.gltf.buffers,i=r.length,n=0;n<i;++n){var o=r[n];if(o.extras=v(o.extras,{}),o.extras._pipeline=v(o.extras._pipeline,{}),Q(o.extras._pipeline.source))t.buffers[n]=o.extras._pipeline.source;else{var a=e._resource.getDerivedResource({url:o.uri});++t.pendingBufferLoads,a.fetchArrayBuffer().then(D(e,n)).otherwise(P(e,"buffer",a.uri))}}}(this)}var a,s,l,u=this._loadResources,c=!1;this._state===E.LOADING&&(0===u.pendingBufferLoads&&($.checkSupportedExtensions(this.extensionsRequired),s=(a=this).gltf,l=a._loadResources,C.buffer(s,function(e,t){l.buffers[t]=e.extras._pipeline.source}),function(e){var r=e.gltf.bufferViews,i=e._loadResources.vertexBuffersToCreate;C.bufferView(e.gltf,function(e,t){e.target===b.ARRAY_BUFFER&&i.enqueue(t)});var n=e._loadResources.indexBuffersToCreate,o={};C.accessor(e.gltf,function(e){var t=e.bufferView;r[t].target!==b.ELEMENT_ARRAY_BUFFER||Q(o[t])||(o[t]=!0,n.enqueue({id:t,componentType:e.componentType}))})}(this),this._boundingSphere=function(e){var t=e.gltf,r=t.nodes,i=t.meshes,n=new H(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),o=new H(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),a=r[0],s=a.mesh,l=$.getTransform(a),u=i[s].primitives[0].attributes.POSITION,c=$.getAccessorMinMax(t,u),d=H.fromArray(c.min,0,A),h=H.fromArray(c.max,0,x);Q(n)&&Q(o)&&(K.multiplyByPoint(l,d,d),K.multiplyByPoint(l,h,h),H.minimumByComponent(n,d,n),H.maximumByComponent(o,h,o));var p=W.fromCornerPoints(n,o);return e._upAxis===w.Y?W.transformWithoutScale(p,w.Y_UP_TO_Z_UP,p):e._upAxis===w.X&&W.transformWithoutScale(p,w.X_UP_TO_Z_UP,p),p}(this),this._initialRadius=this._boundingSphere.radius,M(this,e)),u.finished()&&(this._state=E.LOADED,c=!0)),Q(u)&&this._state===E.LOADED&&(c||M(this,e),u.finished()&&(this._loadResources=void 0));var d=this.show;if(d&&this._state===E.LOADED||c){this._dirty=!1;var h=this.modelMatrix,p=e.mode!==this._mode;this._mode=e.mode;var f=!K.equals(this._modelMatrix,h)||p;if(f||c){K.clone(h,this._modelMatrix);var m=this._computedModelMatrix;K.clone(h,m),this._upAxis===w.Y?K.multiplyTransformation(m,w.Y_UP_TO_Z_UP,m):this._upAxis===w.X&&K.multiplyTransformation(m,w.X_UP_TO_Z_UP,m)}(f||c)&&(!function(e,t,r,i){var n=e._computedModelMatrix;if(e._mode!==T.SCENE3D&&!e._ignoreCommands){var o=K.getColumn(n,3,R);if(_.equals(o,_.UNIT_W)){var a=e.boundingSphere.center,s=y.wgs84To2DModelMatrix(i,a,L);n=K.multiply(s,n,L),Q(e._rtcCenter)&&(K.setTranslation(n,_.UNIT_W,n),e._rtcCenter=e._rtcCenter2D)}else n=y.basisTo2D(i,n,L),e._rtcCenter=e._rtcCenter3D}var l=e._primitive;(t||r)&&(K.multiplyTransformation(n,e._nodeMatrix,l._modelMatrix),W.transform(l._boundingSphere,l._modelMatrix,l._boundingVolume),Q(e._rtcCenter)&&H.add(e._rtcCenter,l._boundingVolume.center,l._boundingVolume.center))}(this,f,c,e.mapProjection),this._dirty=!0)}if(c){var g=this;e.afterRender.push(function(){g._ready=!0,g._readyPromise.resolve(g)})}else d&&!this._ignoreCommands&&(this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.debugWireframe=this.debugWireframe,this._primitive.update(e))}},l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),r(this)},l}),define("Scene/Batched3DModel3DTileContent",["../Core/ClippingPlaneCollection","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/destroyObject","../Core/DeveloperError","../Core/FeatureDetection","../Core/getBaseUri","../Core/getStringFromTypedArray","../Core/RequestType","../Core/RuntimeError","../Renderer/Pass","./Cesium3DTileBatchTable","./Cesium3DTileFeature","./Cesium3DTileFeatureTable","./ClassificationModel","./Model","./ModelUtility"],function(M,r,R,L,e,t,i,n,o,a,N,k,F,B,U,s,V,z,q,G){"use strict";if(!o.supportsTypedArrays())return{};function W(e,t,r,i,n){this._tileset=e,this._tile=t,this._resource=r,this._model=void 0,this._batchTable=void 0,this._features=void 0,this.featurePropertiesDirty=!1,function(e,t,r){var i=e._tileset,n=e._tile,o=e._resource,a=R(r,0);r=a;var s=new Uint8Array(t),l=new DataView(t);r+=H;var u=l.getUint32(r,!0);if(1!==u)throw new F("Only Batched 3D Model version 1 is supported.  Version "+u+" is not.");r+=H;var c=l.getUint32(r,!0);r+=H;var d=l.getUint32(r,!0);r+=H;var h=l.getUint32(r,!0);r+=H;var p=l.getUint32(r,!0);r+=H;var f,m,g=l.getUint32(r,!0);r+=H,570425344<=p?(r-=2*H,f=d,p=h,h=d=g=0,W._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchLength] [batchTableByteLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/AnalyticalGraphicsInc/3d-tiles/blob/master/TileFormats/Batched3DModel/README.md.")):570425344<=g&&(r-=H,f=p,p=d,g=h,h=d=0,W._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchTableJsonByteLength] [batchTableBinaryByteLength] [batchLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/AnalyticalGraphicsInc/3d-tiles/blob/master/TileFormats/Batched3DModel/README.md."));if(0===d)m={BATCH_LENGTH:R(f,0)};else{var _=N(s,r,d);m=JSON.parse(_),r+=d}var v=new Uint8Array(t,r,h);r+=h;var y,b,C,w=new V(m,v);if(f=w.getGlobalProperty("BATCH_LENGTH"),w.featuresLength=f,0<p){var S=N(s,r,p);y=JSON.parse(S),r+=p,0<g&&(b=new Uint8Array(t,r,g),b=new Uint8Array(b),r+=g)}L(i.classificationType)&&(T=e,C=function(e,t){T._model.updateCommands(e,t)});var T;var E=new U(e,f,y,b,C);e._batchTable=E;var A,x=a+c-r;if(0===x)throw new F("glTF byte length must be greater than 0.");A=r%4==0?new Uint8Array(t,r,x):(W._deprecationWarning("b3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary."),new Uint8Array(s.subarray(r,r+x)));var P={content:e,primitive:i};if(L(i.classificationType))e._model=new z({gltf:A,cull:!1,basePath:o,requestType:k.TILES3D,modelMatrix:n.computedTransform,upAxis:i._gltfUpAxis,debugWireframe:i.debugWireframe,vertexShaderLoaded:j(e),classificationShaderLoaded:(O=e,function(e){var t=O._batchTable,r=t.getClassificationFragmentShaderCallback();return L(r)?r(e):e}),uniformMapLoaded:E.getUniformMapCallback(),pickVertexShaderLoaded:Y(e),pickFragmentShaderLoaded:E.getPickFragmentShaderCallback(),pickUniformMapLoaded:E.getPickUniformMapCallback(),classificationType:i._classificationType,batchTable:E});else{var D;D=L(i.clippingPlanes)?i.clippingPlanes.clone():new M({enabled:!1}),e._model=new q({gltf:A,cull:!1,releaseGltfJson:!0,opaquePass:B.CESIUM_3D_TILE,basePath:o,requestType:k.TILES3D,modelMatrix:n.computedTransform,upAxis:i._gltfUpAxis,shadows:i.shadows,debugWireframe:i.debugWireframe,incrementallyLoadTextures:!1,vertexShaderLoaded:j(e),fragmentShaderLoaded:(I=e,function(e,t){var r=I._batchTable,i=I._model.gltf,n=!L(I._tileset.classificationType),o=G.getDiffuseAttributeOrUniform(i,t),a=r.getFragmentShaderCallback(n,o);return L(a)?a(e):e}),uniformMapLoaded:E.getUniformMapCallback(),pickVertexShaderLoaded:Y(e),pickFragmentShaderLoaded:E.getPickFragmentShaderCallback(),pickUniformMapLoaded:E.getPickUniformMapCallback(),addBatchIdToGeneratedShaders:0<f,pickObject:P,clippingPlanes:D})}var O;var I}(this,i,n)}W._deprecationWarning=t,e(W.prototype,{featuresLength:{get:function(){return this._batchTable.featuresLength}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return this._model.trianglesLength}},geometryByteLength:{get:function(){return this._model.geometryByteLength}},texturesByteLength:{get:function(){return this._model.texturesByteLength}},batchTableByteLength:{get:function(){return this._batchTable.memorySizeInBytes}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._model.readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){return this._batchTable}}});var H=Uint32Array.BYTES_PER_ELEMENT;function u(e){var t=G.getAttributeOrUniformBySemantic(e,"_BATCHID");return L(t)||(t=G.getAttributeOrUniformBySemantic(e,"BATCHID"),L(t)&&W._deprecationWarning("b3dm-legacy-batchid","The glTF in this b3dm uses the semantic `BATCHID`. Application-specific semantics should be prefixed with an underscore: `_BATCHID`.")),t}function j(l){return function(e,t){var r=l._batchTable,i=l._model.gltf,n=!L(l._tileset.classificationType),o=u(i),a=G.getDiffuseAttributeOrUniform(i,t),s=r.getVertexShaderCallback(n,o,a);return L(s)?s(e):e}}function Y(n){return function(e){var t=n._batchTable,r=u(n._model.gltf),i=t.getPickVertexShaderCallback(r);return L(i)?i(e):e}}return W.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},W.prototype.getFeature=function(e){var t=this.featuresLength;if(!L(e)||e<0||t<=e)throw new n("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").");return function(e){var t=e.featuresLength;if(!L(e._features)&&0<t){for(var r=new Array(t),i=0;i<t;++i)r[i]=new s(e,i);e._features=r}}(this),this._features[e]},W.prototype.applyDebugSettings=function(e,t){t=e?t:r.WHITE,0===this.featuresLength?this._model.color=t:this._batchTable.setAllColor(t)},W.prototype.applyStyle=function(e,t){this._batchTable.applyStyle(e,t)},W.prototype.update=function(e,t){var r=t.commandList.length;this._batchTable.update(e,t),this._model.modelMatrix=this._tile.computedTransform,this._model.shadows=this._tileset.shadows,this._model.debugWireframe=this._tileset.debugWireframe;var i=this._tileset.clippingPlanes,n=this._model.clippingPlanes;if(L(i)?(i.clone(n),n.enabled=i.enabled&&this._tile._isClipped):L(n)&&n.enabled&&(n.enabled=!1),this._model.update(t),r<t.commandList.length&&t.passes.render&&!L(e.classificationType)){var o=this._tile._finalResolution;this._batchTable.addDerivedCommands(t,r,o)}},W.prototype.isDestroyed=function(){return!1},W.prototype.destroy=function(){return this._model=this._model&&this._model.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),i(this)},W}),define("Scene/BingMapsStyle",["../Core/freezeObject"],function(e){"use strict";return e({AERIAL:"Aerial",AERIAL_WITH_LABELS:"AerialWithLabels",ROAD:"Road",CANVAS_DARK:"CanvasDark",CANVAS_LIGHT:"CanvasLight",CANVAS_GRAY:"CanvasGray",ORDNANCE_SURVEY:"OrdnanceSurvey",COLLINS_BART:"CollinsBart"})}),define("Scene/BingMapsImageryProvider",["../Core/BingMapsApi","../Core/Cartesian2","../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/DeveloperError","../Core/Event","../Core/Math","../Core/Rectangle","../Core/Resource","../Core/RuntimeError","../Core/TileProviderError","../Core/WebMercatorTilingScheme","../ThirdParty/when","./BingMapsStyle","./DiscardMissingTileImagePolicy","./ImageryProvider"],function(o,g,_,a,v,e,s,l,u,y,b,c,d,C,h,w,S,T,n){"use strict";function E(e){if(e=a(e,{}),!v(e.url))throw new l("options.url is required.");v(e.proxy)&&s("BingMapsImageryProvider.proxy","The options.proxy parameter has been deprecated. Specify options.url as a Resource instance and set the proxy property there."),this._key=o.getKey(e.key),this._keyErrorCredit=o.getErrorCredit(e.key);var t=c.createIfNeeded(e.url,{proxy:e.proxy});t.addQueryParameters({key:this._key}),this._resource=t,this._tileProtocol=e.tileProtocol,this._mapStyle=a(e.mapStyle,S.AERIAL),this._culture=a(e.culture,""),this._tileDiscardPolicy=e.tileDiscardPolicy,this._proxy=e.proxy,this._credit=new _({text:"Bing Imagery",imageUrl:E._logoData,link:"http://www.bing.com"}),this.defaultGamma=1,this._tilingScheme=new h({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:e.ellipsoid}),this._tileWidth=void 0,this._tileHeight=void 0,this._maximumLevel=void 0,this._imageUrlTemplate=void 0,this._imageUrlSubdomains=void 0,this._errorEvent=new u,this._ready=!1,this._readyPromise=w.defer();var p,r=t.getDerivedResource({url:"/REST/v1/Imagery/Metadata/"+this._mapStyle,queryParameters:{incl:"ImageryProviders"}}),f=this;function i(e){if(1===e.resourceSets.length){var t=e.resourceSets[0].resources[0];f._tileWidth=t.imageWidth,f._tileHeight=t.imageHeight,f._maximumLevel=t.zoomMax-1,f._imageUrlSubdomains=t.imageUrlSubdomains,f._imageUrlTemplate=t.imageUrl;var r=f._tileProtocol;if(!v(r)){var i=document.location.protocol;r=/^http/.test(i)?i:"http:"}f._imageUrlTemplate=f._imageUrlTemplate.replace(/^http:/,r),v(f._tileDiscardPolicy)||(f._tileDiscardPolicy=new T({missingImageUrl:A(f,0,0,f._maximumLevel).url,pixelsToCheck:[new g(0,0),new g(120,140),new g(130,160),new g(200,50),new g(200,200)],disableCheckIfAllPixelsAreTransparent:!0}));var n=f._attributionList=t.imageryProviders;n||(n=f._attributionList=[]);for(var o=0,a=n.length;o<a;++o){var s=n[o];s.credit=new _({text:s.attribution});for(var l=s.coverageAreas,u=0,c=s.coverageAreas.length;u<c;++u){var d=l[u],h=d.bbox;d.bbox=new b(y.toRadians(h[1]),y.toRadians(h[0]),y.toRadians(h[3]),y.toRadians(h[2]))}}f._ready=!0,f._readyPromise.resolve(!0),C.handleSuccess(p)}else m()}function m(e){var t="An error occurred while accessing "+r.url+".";p=C.handleError(p,f,f._errorEvent,t,void 0,void 0,void 0,n),f._readyPromise.reject(new d(t))}function n(){var e=r.fetchJsonp("jsonp");w(e,i,m)}n()}e(E.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},key:{get:function(){return this._key}},mapStyle:{get:function(){return this._mapStyle}},culture:{get:function(){return this._culture}},tileWidth:{get:function(){if(!this._ready)throw new l("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth}},tileHeight:{get:function(){if(!this._ready)throw new l("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready)throw new l("maximumLevel must not be called before the imagery provider is ready.");return this._maximumLevel}},minimumLevel:{get:function(){if(!this._ready)throw new l("minimumLevel must not be called before the imagery provider is ready.");return 0}},tilingScheme:{get:function(){if(!this._ready)throw new l("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}},rectangle:{get:function(){if(!this._ready)throw new l("rectangle must not be called before the imagery provider is ready.");return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready)throw new l("tileDiscardPolicy must not be called before the imagery provider is ready.");return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!1}}});var p=new b;function A(e,t,r,i,n){var o=e._imageUrlTemplate,a=e._imageUrlSubdomains,s=(t+r+i)%a.length;return e._resource.getDerivedResource({url:o,request:n,templateValues:{quadkey:E.tileXYToQuadKey(t,r,i),subdomain:a[s],culture:e._culture}})}E.prototype.getTileCredits=function(e,t,r){if(!this._ready)throw new l("getTileCredits must not be called before the imagery provider is ready.");var i=this._tilingScheme.tileXYToRectangle(e,t,r,p),n=function(e,t,r){++t;for(var i=[],n=0,o=e.length;n<o;++n){for(var a=e[n],s=a.coverageAreas,l=!1,u=0,c=a.coverageAreas.length;!l&&u<c;++u){var d=s[u];if(t>=d.zoomMin&&t<=d.zoomMax){var h=b.intersection(r,d.bbox,f);v(h)&&(l=!0)}}l&&i.push(a.credit)}return i}(this._attributionList,r,i);return v(this._keyErrorCredit)&&n.push(this._keyErrorCredit),n},E.prototype.requestImage=function(e,t,r,i){if(!this._ready)throw new l("requestImage must not be called before the imagery provider is ready.");return n.loadImage(this,A(this,e,t,r,i))},E.prototype.pickFeatures=function(e,t,r,i,n){},E._logoData="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAAaCAYAAAAEy1RnAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH3gIDEgcPTMnXOQAAClZJREFUWMPdWGtsFNcV/u689uH1+sXaONhlWQzBENtxiUFBpBSLd60IpXHSNig4URtSYQUkRJNSi0igViVVVBJBaBsiAgKRQJSG8AgEHCCWU4iBCprY2MSgXfOI16y9D3s9Mzsztz9yB12WNU2i9Ecy0tHOzN4793zn3POdcy7BnRfJ8I7iB3SRDPeEExswLz8Y0DZIAYDIRGAgLQAm+7Xle31J3L3Anp1MZPY+BUBjorN332vgYhpgV1FRUd6TTz45ubq6OtDV1SXpuu5g//Oept9wNwlMyAi8IXDjyF245TsDTdivDMATCATGNDU1/WbhwoWPTZs2bWx1dXWhx+Oxrl+/PqTrus5t9W8KWEzjinTAYhro/xuBStwiIgBnJBLxKIoy1u/3V/r9/krDMMz3339/Z3t7e38ikUgCMDLEt8W+Q0cAI3McYTDDmZxh7DESG5Ni43jg9Gsa+X+OsxWxPSJTSj3JZFK5ZRVJErOzs8e6XC4fgGwALhbzDgAKU1hK28KEA6PMmTMn56233qpevnz5PQDcbJ7EzVUAuMrLy3MBeABkcWOEDELSyFe4y7iMoHkriZZlKYZh8ASHZDKpJJPJHAC5APIA5APIAeBlCjo5TwlpXnbOmTPHP3fu3KZVq1atZKBcDJQ9x7V48WJfc3Pzhp6enj+tXLnyR8w4MjdG4gyVDk7KICMClzKlLUrpbQMNw5AkScppbGz8cWdn57WjR4/2caw+DEBlYjO8wX1foZQWuN3uKZIklQD4G+fhlG0Yl8uVm5WVVW6app6dne0D0G8vnxbjJntHubCUOK/badZICyWanrJuAaeUknTQpmlKkUhEWbx48U8LCwtHhUKha+fPn+85fPhwV0tLyzUACSZx9jvMFhIByNFoVDEMw/qKB5HPvJfkUqBr9+7deklJyZ/j8bi5ffv2OAslieMLsG+m2DybT2QuzEQOsF5SUqJfvXo1yc2l6Xn6rgSRSCSEc+fOhVeuXLmwoqJixvTp0wcWLFgQ7unpudHR0dF97ty5z/fu3XseQJh5adjeerquy5ZlCalUivh8Pt8HH3ywzOPxyD09PZ81NjZ+2NnZaQEQx40b54vFYqaqquEVK1b4a2tr/WvWrDn18ssv144fP36SqqoD69ev371nz57rDLwAwHHkyJGfjRs3rtowDOv06dOnu7q6rs6bN2/s7Nmz9zIjDKenWoFZKg/AlMLCwl82Nzf/m3LX22+/fXb06NF/ALC8u7u7m6ZdkUhksL29/UpLS0vzunXrVgAoBzAaQBGAiY2NjUui0ei1RCLRFwwG/9PX19cVi8WCqqoOdHd3HysrK6sDMCccDl8IBoOtiqIsOnbs2D+i0eiV3t7ez8Ph8GeRSKRT07TB/v7+i1OnTp0HYBqABzs7O/+paVo0Fot1RyKRi/F4/Gp/f39XIpHoZnoUMn6wU+ZtRDaymwmxZFk2AWjvvvvuJ/F4PMn/n5+fn1VeXu6fOXNmbU1NzUOM4Bz8QqIoyg6HwxuLxfq3bdu2a+vWrW/09/dfKy0tffDVV199BEC20+n0ud3uQgBup9Pp83g8JYqieE+ePPnxxo0bt33xxRen8/Ly7n3hhRcWASh47bXX5pWVldWFw+GuXbt27XjzzTd3BoPBDq/XG1AUZRRHmAKPVfqaoKkgCCkA+oYNG84Eg0FHTU1N5ezZs8eWlJQ4CSF8/LvZYhJPQoQQpFKpwcrKyo1su9HBwUF99erVv588eXINgOOmacIwDEopdaZSKUIpxYkTJz6sr68/BMBav379RcMwZk2aNOl+AP+qq6t7xDTNVEVFxR+j0WgSAJk4ceKlTz/9tNzpdHpZvIvpjVW6pykhhBJCbkvwgiAQQogEQL558ybdtGlTsLm5OWJZdxZmlmWll5OUEEJN0zSGhob6GcOrALSzZ8/2apqWcLlc2axGACNRkRAimqaph0Kh68xIwwB0y7IMSZKcABz5+fkl8Xj8y2g0apOb5na7rYGBgS/JV54Q0qpAAoBKaS0jBWClg1ZVFeFw2AlgVF1dXeDpp5+eWVFRUVpcXOzgvQwAbrcbDJhdudlGpKZpGtx6JCcnRxIEQbQsS2PjbjM+AMvlchnMSBaXkr7ymCCIhmEYfMoVRVESBEHI0CaTTNubssUsQRBuubCtra33pZdeCk6YMCGwZs2aipqaGn9paWmuJEl3JP0bN258eeTIkRMABrm0YomiaImiKGVlZeWxLecAgBkzZvgdDkfWjRs3ggA0bpfpoiiahBCqKEqKAy2yULMA6MlkMp6Xl3cP1x2SWCwmFhQU+CmlFhfHNFOevpX4LcvSJUkyAeDQoUOh119//fpTTz01Zf78+UWBQCBHUZQ7yE/TNGPfvn0n33vvvSP79+//BECMeZsCMGRZNgRBgNPpHHXx4sVVDQ0Nf1+wYMGYJ554YikAevDgwUMA4oIgQJZlSggZdDqdBiGEZGdn6ww0tQlJURTT4/EMHz9+/MCjjz7622AwuHbZsmVbiouLvWvXrm1wOp3ZqVRqaKQTIInf1gAMl8ulU0q1CxcuBGOxmL5u3bryQCDgycrKEjORXGtra8eOHTsOHz169OyVK1cuA+hlRYrGlNRkWR7UNO2mYRiaz+cb3dLS8gYhhOi6Hj116tSOVatWHQNALcsaME0zLghClBDSZ9+zQsZ2SoJS2udwOKLPPffcvsrKyrJAIPDQ/v37txiGofX19V3r7e29UlBQMHqEVpjwnrYA6PF4PK6q6s2qqqqpZWVlitvtljOB7enpiWzbtu3wgQMHTre1tV0E0MeKkkGuIhMAqHv37u30er3Px+NxlyiKygMPPOAnhFiXLl0Kbd68uYPNsXbu3Lk6mUwaqqr2btmyZUdtbe3hd955pwvAEFNcO3jw4K/b2tqiqqpGIpGI4/HHH/9rQ0PDCa/XOyoSidDLly8PNTU1PcZ4QuNK1ju6NYHFRAGASXPnzv1Fa2vrxzTDpapqateuXR/Nnz+/SVGUhwFMBzCBFSLZLF75DsrJGpXRAH4EIABgPIBxAEoBFAPwARjFif1sNzZ25+VlOhaxufcCqAFQC+BhAPVLliz5XSqVUkOhUAuAKWnFyR3dlsw+fg+A+8eMGfPzTZs2bY9GozEb8JkzZ9qXLl36l+Li4l8B+AmAyQDGsGrOzfXNPGPawG2l85jksmcPm+vihH+2W1iF3bvZPN+sWbPuGx4eDrW3t+85fvz41o6OjmZN04Y0TYvV19cvYIbN5QqUjG2mwj5YAqDK4XDMe+aZZ55vbW09+sorr2yuqqpqYFatAuBn3uB7XzJCY297XeaUd2RoGzOJmHb6IjFj5D777LP3DQwMfDw8PBxSVbUvkUj0hEKhj1588cXH2O7zMSPdplumoxveMx5Zlj3jx4/39vb26gMDA4MsvgYZo+p8Pr7LqQX5Ds/U7d0jFxUVZS1atKg4Nzc317Isp67rZldXV6y5ufkmI78hFtcmrx8ZweMit6XsUs4+6kmlgbW+peLf9gyMZNCR374G0y/FxEzX8b/8+bkXEBxKFwAAAABJRU5ErkJggg==",E.tileXYToQuadKey=function(e,t,r){for(var i="",n=r;0<=n;--n){var o=1<<n,a=0;0!=(e&o)&&(a|=1),0!=(t&o)&&(a|=2),i+=a}return i},E.quadKeyToTileXY=function(e){for(var t=0,r=0,i=e.length-1,n=i;0<=n;--n){var o=1<<n,a=+e[i-n];0!=(1&a)&&(t|=o),0!=(2&a)&&(r|=o)}return{x:t,y:r,level:i}};var f=new b;return E}),define("Scene/BoxEmitter",["../Core/Cartesian3","../Core/Check","../Core/defaultValue","../Core/defineProperties","../Core/Math"],function(a,t,r,e,s){"use strict";var i=new a(1,1,1);function n(e){e=r(e,i),t.defined("dimensions",e),t.typeOf.number.greaterThanOrEquals("dimensions.x",e.x,0),t.typeOf.number.greaterThanOrEquals("dimensions.y",e.y,0),t.typeOf.number.greaterThanOrEquals("dimensions.z",e.z,0),this._dimensions=a.clone(e)}e(n.prototype,{dimensions:{get:function(){return this._dimensions},set:function(e){t.defined("value",e),t.typeOf.number.greaterThanOrEquals("value.x",e.x,0),t.typeOf.number.greaterThanOrEquals("value.y",e.y,0),t.typeOf.number.greaterThanOrEquals("value.z",e.z,0),a.clone(e,this._dimensions)}}});var l=new a;return n.prototype.emit=function(e){var t=this._dimensions,r=a.multiplyByScalar(t,.5,l),i=s.randomBetween(-r.x,r.x),n=s.randomBetween(-r.y,r.y),o=s.randomBetween(-r.z,r.z);e.position=a.fromElements(i,n,o,e.position),e.velocity=a.normalize(e.position,e.velocity)},n}),define("Shaders/BrdfLutGeneratorFS",[],function(){"use strict";return"varying vec2 v_textureCoordinates;\nconst float M_PI = 3.141592653589793;\nfloat vdcRadicalInverse(int i)\n{\nfloat r;\nfloat base = 2.0;\nfloat value = 0.0;\nfloat invBase = 1.0 / base;\nfloat invBi = invBase;\nfor (int x = 0; x < 100; x++)\n{\nif (i <= 0)\n{\nbreak;\n}\nr = mod(float(i), base);\nvalue += r * invBi;\ninvBi *= invBase;\ni = int(float(i) * invBase);\n}\nreturn value;\n}\nvec2 hammersley2D(int i, int N)\n{\nreturn vec2(float(i) / float(N), vdcRadicalInverse(i));\n}\nvec3 importanceSampleGGX(vec2 xi, float roughness, vec3 N)\n{\nfloat a = roughness * roughness;\nfloat phi = 2.0 * M_PI * xi.x;\nfloat cosTheta = sqrt((1.0 - xi.y) / (1.0 + (a * a - 1.0) * xi.y));\nfloat sinTheta = sqrt(1.0 - cosTheta * cosTheta);\nvec3 H = vec3(sinTheta * cos(phi), sinTheta * sin(phi), cosTheta);\nvec3 upVector = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\nvec3 tangentX = normalize(cross(upVector, N));\nvec3 tangentY = cross(N, tangentX);\nreturn tangentX * H.x + tangentY * H.y + N * H.z;\n}\nfloat G1_Smith(float NdotV, float k)\n{\nreturn NdotV / (NdotV * (1.0 - k) + k);\n}\nfloat G_Smith(float roughness, float NdotV, float NdotL)\n{\nfloat k = roughness * roughness / 2.0;\nreturn G1_Smith(NdotV, k) * G1_Smith(NdotL, k);\n}\nvec2 integrateBrdf(float roughness, float NdotV)\n{\nvec3 V = vec3(sqrt(1.0 - NdotV * NdotV), 0.0, NdotV);\nfloat A = 0.0;\nfloat B = 0.0;\nconst int NumSamples = 1024;\nfor (int i = 0; i < NumSamples; i++)\n{\nvec2 xi = hammersley2D(i, NumSamples);\nvec3 H = importanceSampleGGX(xi, roughness, vec3(0.0, 0.0, 1.0));\nvec3 L = 2.0 * dot(V, H) * H - V;\nfloat NdotL = clamp(L.z, 0.0, 1.0);\nfloat NdotH = clamp(H.z, 0.0, 1.0);\nfloat VdotH = clamp(dot(V, H), 0.0, 1.0);\nif (NdotL > 0.0)\n{\nfloat G = G_Smith(roughness, NdotV, NdotL);\nfloat G_Vis = G * VdotH / (NdotH * NdotV);\nfloat Fc = pow(1.0 - VdotH, 5.0);\nA += (1.0 - Fc) * G_Vis;\nB += Fc * G_Vis;\n}\n}\nreturn vec2(A, B) / float(NumSamples);\n}\nvoid main()\n{\ngl_FragColor = vec4(integrateBrdf(1.0 - v_textureCoordinates.y, v_textureCoordinates.x), 0.0, 1.0);\n}\n"}),define("Scene/BrdfLutGenerator",["../Core/BoundingRectangle","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/PixelFormat","../Renderer/Framebuffer","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/Sampler","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","../Shaders/BrdfLutGeneratorFS"],function(a,s,e,t,l,u,c,d,h,p,f,m,g,_){"use strict";function r(){this._framebuffer=void 0,this._colorTexture=void 0,this._drawCommand=void 0}return e(r.prototype,{colorTexture:{get:function(){return this._colorTexture}}}),r.prototype.update=function(e){if(!s(this._colorTexture)){var t=e.context;!function(e,t){var r=new p({context:t,width:256,height:256,pixelFormat:l.RGBA,pixelDatatype:c.UNSIGNED_BYTE,sampler:new h({wrapS:g.CLAMP_TO_EDGE,wrapT:g.CLAMP_TO_EDGE,minificationFilter:m.NEAREST,magnificationFilter:f.NEAREST})});e._colorTexture=r;var i=new u({context:t,colorTextures:[r],destroyAttachments:!1});e._framebuffer=i}(this,t),i=t,n=(r=this)._framebuffer,o=i.createViewportQuadCommand(_,{framebuffer:n,renderState:d.fromCache({viewport:new a(0,0,256,256)})}),r._drawCommand=o,this._drawCommand.execute(t),this._framebuffer=this._framebuffer&&this._framebuffer.destroy(),this._drawCommand.shaderProgram=this._drawCommand.shaderProgram&&this._drawCommand.shaderProgram.destroy()}var r,i,n,o},r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return this._colorTexture=this._colorTexture&&this._colorTexture.destroy(),t(this)},r}),define("Scene/CameraFlightPath",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/EasingFunction","../Core/Math","../Core/PerspectiveFrustum","../Core/PerspectiveOffCenterFrustum","./SceneMode"],function(A,N,k,x,F,P,D,B,_,v,O){"use strict";var e={};var y=new N,b=new N;function U(e,t,r,i,n){var o=n,a=Math.max(r,i);if(!F(o)){var s=e.position,l=t,u=e.up,c=e.right,d=e.frustum,h=N.subtract(s,l,y),p=N.magnitude(N.multiplyByScalar(u,N.dot(h,u),b)),f=N.magnitude(N.multiplyByScalar(c,N.dot(h,c),b));o=Math.min(.2*function(e,t,r){var i,n,o;if(e instanceof _){var a=Math.tan(.5*e.fovy);return i=e.near,n=e.near*a,o=e.aspectRatio*n,Math.max(t*i/o,r*i/n)}return e instanceof v?(i=e.near,n=e.top,o=e.right,Math.max(t*i/o,r*i/n)):Math.max(t,r)}(d,p,f),1e9)}if(a<o){var m=-Math.pow(1e6*(o-r),1/8),g=Math.pow(1e6*(o-i),1/8);return function(e){var t=e*(g-m)+m;return-Math.pow(t,8)/1e6+o}}return function(e){return B.lerp(r,i,e)}}function V(e,t){return B.equalsEpsilon(e,B.TWO_PI,B.EPSILON11)&&(e=0),t>e+Math.PI?e+=B.TWO_PI:t<e-Math.PI&&(e-=B.TWO_PI),e}var p=new N;function I(e,r,i,n,o,a,t){var s=e.camera,l=N.clone(s.position,p),u=s.pitch,c=V(s.heading,n),d=V(s.roll,a),h=U(s,i,l.z,i.z,t);return function(e){var t=e.time/r;s.setView({orientation:{heading:B.lerp(c,n,t),pitch:B.lerp(u,o,t),roll:B.lerp(d,a,t)}}),A.lerp(l,i,t,s.position),s.position.z=h(t)}}var z=new k,q=new k;function M(e,i,t,n,r,o,a,s,l,u){var c=e.camera,d=e.mapProjection.ellipsoid,h=k.clone(c.positionCartographic,z),p=c.pitch,f=V(c.heading,n),m=V(c.roll,o),g=d.cartesianToCartographic(t,q);h.longitude=B.zeroToTwoPi(h.longitude),g.longitude=B.zeroToTwoPi(g.longitude);var _,v,y,b,C,w=!1;if(F(s)){var S=B.zeroToTwoPi(s),T=Math.min(h.longitude,g.longitude),E=Math.max(h.longitude,g.longitude),A=T<=S&&S<=E;if(F(l)){var x=Math.abs(h.longitude-g.longitude),P=B.TWO_PI-x;(A?x:P)<(A?P:x)*l&&!A&&(w=!0)}else A||(w=!0)}w?(C=g,(b=h).longitude<C.longitude?b.longitude+=B.TWO_PI:C.longitude+=B.TWO_PI):(v=g,(y=(_=h).longitude-v.longitude)<-B.PI?_.longitude+=B.TWO_PI:y>B.PI&&(v.longitude+=B.TWO_PI));var D,O,I,M,R=U(c,t,h.height,g.height,a),L=function(n,o,a,e){if(F(e)&&a(.5)>e){var s=a(0),l=a(1),t=a(.5),u=t-s,c=t-l;return function(e){var t=a(e);if(e<=.5){var r=(t-s)/u;return B.lerp(n,-B.PI_OVER_TWO,r)}var i=(t-l)/c;return B.lerp(-B.PI_OVER_TWO,o,1-i)}}return function(e){return B.lerp(n,o,e)}}(p,r,R,u);return D=h.longitude,O=g.longitude,I=h.latitude,M=g.latitude,function(e){var t=e.time/i,r=N.fromRadians(B.lerp(D,O,t),B.lerp(I,M,t),R(t));c.setView({destination:r,orientation:{heading:B.lerp(f,n,t),pitch:L(t),roll:B.lerp(m,o,t)}})}}function R(e,a,s,l,t,r,i){var u=e.camera,c=N.clone(u.position,p),d=V(u.heading,l),n=u.frustum.right-u.frustum.left,h=U(u,s,n,s.z,i);return function(e){var t=e.time/a;u.setView({orientation:{heading:B.lerp(d,l,t)}}),A.lerp(c,s,t,u.position);var r=h(t),i=u.frustum,n=i.top/i.right,o=.5*(r-(i.right-i.left));i.right+=o,i.left-=o,i.top=n*i.right,i.bottom=-i.top}}var L=new k,G=new N;function W(e,t){return{startObject:{},stopObject:{},duration:0,complete:e,cancel:t}}function H(e,t){return function(){"function"==typeof t&&t(),e.enableInputs=!0}}return e.createTween=function(e,t){var r=(t=x(t,x.EMPTY_OBJECT)).destination;if(!F(e))throw new P("scene is required.");if(!F(r))throw new P("destination is required.");var i=e.mode;if(i===O.MORPHING)return W();var n=x(t.convert,!0),o=e.mapProjection,a=o.ellipsoid,s=t.maximumHeight,l=t.flyOverLongitude,u=t.flyOverLongitudeWeight,c=t.pitchAdjustHeight,d=t.easingFunction;n&&i!==O.SCENE3D&&(a.cartesianToCartographic(r,L),r=o.project(L,G));var h=e.camera,p=t.endTransform;F(p)&&h._setTransform(p);var f=t.duration;F(f)||(f=Math.ceil(N.distance(h.position,r)/1e6)+2,f=Math.min(f,3));var m=x(t.heading,0),g=x(t.pitch,-B.PI_OVER_TWO),_=x(t.roll,0),v=e.screenSpaceCameraController;v.enableInputs=!1;var y=H(v,t.complete),b=H(v,t.cancel),C=h.frustum,w=e.mode===O.SCENE2D;if(w=(w=(w=(w=w&&A.equalsEpsilon(h.position,r,B.EPSILON6))&&B.equalsEpsilon(Math.max(C.right-C.left,C.top-C.bottom),r.z,B.EPSILON6))||e.mode!==O.SCENE2D&&N.equalsEpsilon(r,h.position,B.EPSILON10))&&B.equalsEpsilon(B.negativePiToPi(m),B.negativePiToPi(h.heading),B.EPSILON10)&&B.equalsEpsilon(B.negativePiToPi(g),B.negativePiToPi(h.pitch),B.EPSILON10)&&B.equalsEpsilon(B.negativePiToPi(_),B.negativePiToPi(h.roll),B.EPSILON10))return W(y,b);var S=new Array(4);if(S[O.SCENE2D]=R,S[O.SCENE3D]=M,S[O.COLUMBUS_VIEW]=I,f<=0){return W(function(){S[i](e,1,r,m,g,_,s,l,u,c)({time:1}),"function"==typeof y&&y()},b)}var T=S[i](e,f,r,m,g,_,s,l,u,c);if(!F(d)){var E=h.positionCartographic.height;d=(i===O.SCENE3D?a.cartesianToCartographic(r).height:r.z)<E&&11500<E?D.CUBIC_OUT:D.QUINTIC_IN_OUT}return{duration:f,easingFunction:d,startObject:{time:0},stopObject:{time:f},update:T,complete:y,cancel:b}},e}),define("Scene/MapMode2D",["../Core/freezeObject"],function(e){"use strict";return e({ROTATE:0,INFINITE_SCROLL:1})}),define("Scene/Camera",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/EasingFunction","../Core/Ellipsoid","../Core/EllipsoidGeodesic","../Core/Event","../Core/HeadingPitchRange","../Core/HeadingPitchRoll","../Core/Intersect","../Core/IntersectionTests","../Core/Math","../Core/Matrix3","../Core/Matrix4","../Core/OrthographicFrustum","../Core/OrthographicOffCenterFrustum","../Core/PerspectiveFrustum","../Core/Quaternion","../Core/Ray","../Core/Rectangle","../Core/Transforms","./CameraFlightPath","./MapMode2D","./SceneMode"],function(f,p,B,b,i,m,U,e,d,E,g,V,n,h,t,_,s,z,v,C,q,c,a,y,l,w,S,u,T,A){"use strict";function x(e){if(!U(e))throw new d("scene is required.");this._scene=e,this._transform=C.clone(C.IDENTITY),this._invTransform=C.clone(C.IDENTITY),this._actualTransform=C.clone(C.IDENTITY),this._actualInvTransform=C.clone(C.IDENTITY),this._transformChanged=!1,this.position=new B,this._position=new B,this._positionWC=new B,this._positionCartographic=new i,this.direction=new B,this._direction=new B,this._directionWC=new B,this.up=new B,this._up=new B,this._upWC=new B,this.right=new B,this._right=new B,this._rightWC=new B,this.frustum=new a,this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight,this.frustum.fov=z.toRadians(60),this.defaultMoveAmount=1e5,this.defaultLookAmount=Math.PI/60,this.defaultRotateAmount=Math.PI/3600,this.defaultZoomAmount=1e5,this.constrainedAxis=void 0,this.maximumZoomFactor=1.5,this._moveStart=new n,this._moveEnd=new n,this._changed=new n,this._changedPosition=void 0,this._changedDirection=void 0,this._changedFrustum=void 0,this.percentageChanged=.5,this._viewMatrix=new C,this._invViewMatrix=new C,P(this),this._mode=A.SCENE3D,this._modeChanged=!0;var t=e.mapProjection;this._projection=t,this._maxCoord=t.project(new i(Math.PI,z.PI_OVER_TWO)),this._max2Dfrustum=void 0,this._suspendTerrainAdjustment=!1,Xe(this,x.DEFAULT_VIEW_RECTANGLE,this.position,!0);var r=B.magnitude(this.position);r+=r*x.DEFAULT_VIEW_FACTOR,B.normalize(this.position,this.position),B.multiplyByScalar(this.position,r,this.position)}function P(e){C.computeView(e._position,e._direction,e._up,e._right,e._viewMatrix),C.multiply(e._viewMatrix,e._actualInvTransform,e._viewMatrix),C.inverseTransformation(e._viewMatrix,e._invViewMatrix)}x.TRANSFORM_2D=new C(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),x.TRANSFORM_2D_INVERSE=C.inverseTransformation(x.TRANSFORM_2D,new C),x.DEFAULT_VIEW_RECTANGLE=w.fromDegrees(-95,-20,-70,90),x.DEFAULT_VIEW_FACTOR=.5,x.DEFAULT_OFFSET=new h(0,-z.PI_OVER_FOUR,0),x.prototype._updateCameraChanged=function(){var e=this;if(0!==e._changed.numberOfListeners){var t=e.percentageChanged;if(e._mode!==A.SCENE2D){if(!U(e._changedDirection))return e._changedPosition=B.clone(e.positionWC,e._changedPosition),void(e._changedDirection=B.clone(e.directionWC,e._changedDirection));var r,i=z.acosClamped(B.dot(e.directionWC,e._changedDirection));r=U(e.frustum.fovy)?i/(.5*e.frustum.fovy):i;var n=B.distance(e.positionWC,e._changedPosition)/e.positionCartographic.height;(t<r||t<n)&&(e._changed.raiseEvent(Math.max(r,n)),e._changedPosition=B.clone(e.positionWC,e._changedPosition),e._changedDirection=B.clone(e.directionWC,e._changedDirection))}else{if(!U(e._changedFrustum))return e._changedPosition=B.clone(e.position,e._changedPosition),void(e._changedFrustum=e.frustum.clone());var o,a=e.position,s=e._changedPosition,l=e.frustum,u=e._changedFrustum,c=a.x+l.left,d=a.x+l.right,h=s.x+u.left,p=s.x+u.right,f=a.y+l.bottom,m=a.y+l.top,g=s.y+u.bottom,_=s.y+u.top,v=Math.max(c,h),y=Math.min(d,p),b=Math.max(f,g),C=Math.min(m,_);if(y<=v||m<=b)o=1;else{var w=u;c<h&&p<d&&f<g&&_<m&&(w=l),o=1-(y-v)*(C-b)/((w.right-w.left)*(w.top-w.bottom))}t<o&&(e._changed.raiseEvent(o),e._changedPosition=B.clone(e.position,e._changedPosition),e._changedFrustum=e.frustum.clone(e._changedFrustum))}}};var D=new C,O=new i;x.prototype._adjustHeightForTerrain=function(){var e=this._scene,t=e.screenSpaceCameraController,r=t.enableCollisionDetection,i=t.minimumCollisionTerrainHeight,n=t.minimumZoomDistance;if(!this._suspendTerrainAdjustment&&r){var o=this._mode,a=e.globe;if(U(a)&&o!==A.SCENE2D&&o!==A.MORPHING){var s,l,u=a.ellipsoid,c=e.mapProjection;C.equals(this.transform,C.IDENTITY)||(s=C.clone(this.transform,D),l=B.magnitude(this.position),this._setTransform(C.IDENTITY));var d=O;o===A.SCENE3D?u.cartesianToCartographic(this.position,d):c.unproject(this.position,d);var h=!1;if(d.height<i){var p=a.getHeight(d);U(p)&&(p+=n,d.height<p&&(d.height=p,o===A.SCENE3D?u.cartographicToCartesian(d,this.position):c.project(d,this.position),h=!0))}U(s)&&(this._setTransform(s),h&&(B.normalize(this.position,this.position),B.negate(this.position,this.direction),B.multiplyByScalar(this.position,Math.max(l,n),this.position),B.normalize(this.direction,this.direction),B.cross(this.direction,this.up,this.right),B.cross(this.right,this.direction,this.up)))}}};var I=new i,M=new B,R=new B,L=new b,N=new b,k=new b,F=new b,G=new b;var W=new B;function o(e){var t=e._mode,r=!1,i=0;t===A.SCENE2D&&(r=(i=e.frustum.right-e.frustum.left)!==e._positionCartographic.height);var n=e._position,o=!B.equals(n,e.position)||r;o&&(n=B.clone(e.position,e._position));var a=e._direction,s=!B.equals(a,e.direction);s&&(B.normalize(e.direction,e.direction),a=B.clone(e.direction,e._direction));var l=e._up,u=!B.equals(l,e.up);u&&(B.normalize(e.up,e.up),l=B.clone(e.up,e._up));var c=e._right,d=!B.equals(c,e.right);d&&(B.normalize(e.right,e.right),c=B.clone(e.right,e._right));var h,p=e._transformChanged||e._modeChanged;e._transformChanged=!1,p&&(C.inverseTransformation(e._transform,e._invTransform),e._mode===A.COLUMBUS_VIEW||e._mode===A.SCENE2D?C.equals(C.IDENTITY,e._transform)?C.clone(x.TRANSFORM_2D,e._actualTransform):e._mode===A.COLUMBUS_VIEW?(h=e,S.basisTo2D(h._projection,h._transform,h._actualTransform)):function(e){var t=e._projection,r=t.ellipsoid,i=C.getColumn(e._transform,3,L),n=r.cartesianToCartographic(i,I),o=t.project(n,M),a=N;a.x=o.z,a.y=o.x,a.z=o.y,a.w=1;var s=b.clone(b.UNIT_X,G),l=b.add(C.getColumn(e._transform,0,R),i,R);r.cartesianToCartographic(l,n),t.project(n,o);var u=k;u.x=o.z,u.y=o.x,u.z=o.y,u.w=0,B.subtract(u,a,u),u.x=0;var c=F;if(B.magnitudeSquared(u)>z.EPSILON10)B.cross(s,u,c);else{var d=b.add(C.getColumn(e._transform,1,R),i,R);r.cartesianToCartographic(d,n),t.project(n,o),c.x=o.z,c.y=o.x,c.z=o.y,c.w=0,B.subtract(c,a,c),c.x=0,B.magnitudeSquared(c)<z.EPSILON10&&(b.clone(b.UNIT_Y,u),b.clone(b.UNIT_Z,c))}B.cross(c,s,u),B.normalize(u,u),B.cross(s,u,c),B.normalize(c,c),C.setColumn(e._actualTransform,0,u,e._actualTransform),C.setColumn(e._actualTransform,1,c,e._actualTransform),C.setColumn(e._actualTransform,2,s,e._actualTransform),C.setColumn(e._actualTransform,3,a,e._actualTransform)}(e):C.clone(e._transform,e._actualTransform),C.inverseTransformation(e._actualTransform,e._actualInvTransform),e._modeChanged=!1);var f=e._actualTransform;if(o||p)if(e._positionWC=C.multiplyByPoint(f,n,e._positionWC),t===A.SCENE3D||t===A.MORPHING)e._positionCartographic=e._projection.ellipsoid.cartesianToCartographic(e._positionWC,e._positionCartographic);else{var m=W;m.x=e._positionWC.y,m.y=e._positionWC.z,m.z=e._positionWC.x,t===A.SCENE2D&&(m.z=i),e._projection.unproject(m,e._positionCartographic)}if(s||u||d){var g=B.dot(a,B.cross(l,c,W));if(Math.abs(1-g)>z.EPSILON2){var _=1/B.magnitudeSquared(l),v=B.dot(l,a)*_,y=B.multiplyByScalar(a,v,W);l=B.normalize(B.subtract(l,y,e._up),e._up),B.clone(l,e.up),c=B.cross(a,l,e._right),B.clone(c,e.right)}}(s||p)&&(e._directionWC=C.multiplyByPointAsVector(f,a,e._directionWC),B.normalize(e._directionWC,e._directionWC)),(u||p)&&(e._upWC=C.multiplyByPointAsVector(f,l,e._upWC),B.normalize(e._upWC,e._upWC)),(d||p)&&(e._rightWC=C.multiplyByPointAsVector(f,c,e._rightWC),B.normalize(e._rightWC,e._rightWC)),(o||s||u||d||p)&&P(e)}function H(e,t){var r;return r=z.equalsEpsilon(Math.abs(e.z),1,z.EPSILON3)?Math.atan2(t.y,t.x)-z.PI_OVER_TWO:Math.atan2(e.y,e.x)-z.PI_OVER_TWO,z.TWO_PI-z.zeroToTwoPi(r)}function j(e){return z.PI_OVER_TWO-z.acosClamped(e.z)}function Y(e,t,r){var i=0;return z.equalsEpsilon(Math.abs(e.z),1,z.EPSILON3)||(i=Math.atan2(-r.z,t.z),i=z.zeroToTwoPi(i+z.TWO_PI)),i}var X=new C,Q=new C;e(x.prototype,{transform:{get:function(){return this._transform}},inverseTransform:{get:function(){return o(this),this._invTransform}},viewMatrix:{get:function(){return o(this),this._viewMatrix}},inverseViewMatrix:{get:function(){return o(this),this._invViewMatrix}},positionCartographic:{get:function(){return o(this),this._positionCartographic}},positionWC:{get:function(){return o(this),this._positionWC}},directionWC:{get:function(){return o(this),this._directionWC}},upWC:{get:function(){return o(this),this._upWC}},rightWC:{get:function(){return o(this),this._rightWC}},heading:{get:function(){if(this._mode!==A.MORPHING){var e=this._projection.ellipsoid,t=C.clone(this._transform,X),r=S.eastNorthUpToFixedFrame(this.positionWC,e,Q);this._setTransform(r);var i=H(this.direction,this.up);return this._setTransform(t),i}}},pitch:{get:function(){if(this._mode!==A.MORPHING){var e=this._projection.ellipsoid,t=C.clone(this._transform,X),r=S.eastNorthUpToFixedFrame(this.positionWC,e,Q);this._setTransform(r);var i=j(this.direction);return this._setTransform(t),i}}},roll:{get:function(){if(this._mode!==A.MORPHING){var e=this._projection.ellipsoid,t=C.clone(this._transform,X),r=S.eastNorthUpToFixedFrame(this.positionWC,e,Q);this._setTransform(r);var i=Y(this.direction,this.up,this.right);return this._setTransform(t),i}}},moveStart:{get:function(){return this._moveStart}},moveEnd:{get:function(){return this._moveEnd}},changed:{get:function(){return this._changed}}}),x.prototype.update=function(e){if(!U(e))throw new d("mode is required.");if(e===A.SCENE2D&&!(this.frustum instanceof c))throw new d("An OrthographicOffCenterFrustum is required in 2D.");if(!(e!==A.SCENE3D&&e!==A.COLUMBUS_VIEW||this.frustum instanceof a||this.frustum instanceof q))throw new d("A PerspectiveFrustum or OrthographicFrustum is required in 3D and Columbus view");var t=!1;if(e!==this._mode&&(this._mode=e,this._modeChanged=e!==A.MORPHING,t=this._mode===A.SCENE2D),t){var r=this._max2Dfrustum=this.frustum.clone();if(!(r instanceof c))throw new d("The camera frustum is expected to be orthographic for 2D camera control.");var i=r.top/r.right;r.right=2*this._maxCoord.x,r.left=-r.right,r.top=i*r.right,r.bottom=-r.top}this._mode===A.SCENE2D&&ge(this,this.position);var n=this._scene.globe,o=!U(n)||n._surface.tileProvider.ready&&0===n._surface._tileLoadQueueHigh.length&&0===n._surface._tileLoadQueueMedium.length&&0===n._surface._tileLoadQueueLow.length&&0===n._surface._debug.tilesWaitingForChildren;this._suspendTerrainAdjustment&&(this._suspendTerrainAdjustment=!o),this._adjustHeightForTerrain()};var Z=new B,K=new B,J=new B;x.prototype._setTransform=function(e){var t=B.clone(this.positionWC,Z),r=B.clone(this.upWC,K),i=B.clone(this.directionWC,J);C.clone(e,this._transform),this._transformChanged=!0,o(this);var n=this._actualInvTransform;C.multiplyByPoint(n,t,this.position),C.multiplyByPointAsVector(n,i,this.direction),C.multiplyByPointAsVector(n,r,this.up),B.cross(this.direction,this.up,this.right),o(this)};var $=new p,ee=new l,te=new B,re=new B;x.prototype._adjustOrthographicFrustum=function(e){if(this.frustum instanceof q&&(e||!(this._positionCartographic.height<15e4)))if(C.equals(C.IDENTITY,this.transform)){var t,r,i=this._scene,n=i._globe;if(U(n)){var o=$;o.x=i.drawingBufferWidth/2,o.y=i.drawingBufferHeight/2;var a=this.getPickRay(o,ee);if(t=n.pick(a,i,te),i.pickPositionSupported&&(r=i.pickPositionWorldCoordinates(o,re)),U(t)&&U(r)){var s=U(r)?B.distance(r,this.positionWC):Number.POSITIVE_INFINITY,l=U(t)?B.distance(t,this.positionWC):Number.POSITIVE_INFINITY;this.frustum.width=Math.min(s,l)}else U(r)?this.frustum.width=B.distance(r,this.positionWC):U(t)&&(this.frustum.width=B.distance(t,this.positionWC))}if(!U(n)||!U(t)&&!U(r)){var u=Math.max(this.positionCartographic.height,0);this.frustum.width=u}}else this.frustum.width=B.magnitude(this.position)};var ie=new B,ne=new C,oe=new C,ae=new y,se=new v,le=new i;var ue=new B,ce=new B,de=new B;function he(e,t,r,i){var n=B.clone(r.direction,ue),o=B.clone(r.up,ce);if(e._scene.mode===A.SCENE3D){var a=e._projection.ellipsoid,s=S.eastNorthUpToFixedFrame(t,a,X),l=C.inverseTransformation(s,Q);C.multiplyByPointAsVector(l,n,n),C.multiplyByPointAsVector(l,o,o)}var u=B.cross(n,o,de);return i.heading=H(n,o),i.pitch=j(n),i.roll=Y(n,o,u),i}var pe={destination:void 0,orientation:{direction:void 0,up:void 0,heading:void 0,pitch:void 0,roll:void 0},convert:void 0,endTransform:void 0},fe=new t;x.prototype.setView=function(e){e=m(e,m.EMPTY_OBJECT);var t=m(e.orientation,m.EMPTY_OBJECT),r=this._mode;if(r!==A.MORPHING){U(e.endTransform)&&this._setTransform(e.endTransform);var i=m(e.convert,!0),n=m(e.destination,B.clone(this.positionWC,ie));U(n)&&U(n.west)&&(n=this.getRectangleCameraCoordinates(n,ie),i=!1),U(t.direction)&&(t=he(this,n,t,pe.orientation)),fe.heading=m(t.heading,0),fe.pitch=m(t.pitch,-z.PI_OVER_TWO),fe.roll=m(t.roll,0),this._suspendTerrainAdjustment=!0,r===A.SCENE3D?function(e,t,r){var i=C.clone(e.transform,ne),n=S.eastNorthUpToFixedFrame(t,e._projection.ellipsoid,oe);e._setTransform(n),B.clone(B.ZERO,e.position),r.heading=r.heading-z.PI_OVER_TWO;var o=y.fromHeadingPitchRoll(r,ae),a=v.fromQuaternion(o,se);v.getColumn(a,0,e.direction),v.getColumn(a,2,e.up),B.cross(e.direction,e.up,e.right),e._setTransform(i),e._adjustOrthographicFrustum(!0)}(this,n,fe):r===A.SCENE2D?function(e,t,r,i){var n=C.clone(e.transform,ne);if(e._setTransform(C.IDENTITY),!B.equals(t,e.positionWC)){if(i){var o=e._projection,a=o.ellipsoid.cartesianToCartographic(t,le);t=o.project(a,ie)}p.clone(t,e.position);var s=.5*-t.z,l=-s,u=e.frustum;if(s<l){var c=u.top/u.right;u.right=l,u.left=s,u.top=u.right*c,u.bottom=-u.top}}if(e._scene.mapMode2D===T.ROTATE){r.heading=r.heading-z.PI_OVER_TWO,r.pitch=-z.PI_OVER_TWO,r.roll=0;var d=y.fromHeadingPitchRoll(r,ae),h=v.fromQuaternion(d,se);v.getColumn(h,2,e.up),B.cross(e.direction,e.up,e.right)}e._setTransform(n)}(this,n,fe,i):function(e,t,r,i){var n=C.clone(e.transform,ne);if(e._setTransform(C.IDENTITY),!B.equals(t,e.positionWC)){if(i){var o=e._projection,a=o.ellipsoid.cartesianToCartographic(t,le);t=o.project(a,ie)}B.clone(t,e.position)}r.heading=r.heading-z.PI_OVER_TWO;var s=y.fromHeadingPitchRoll(r,ae),l=v.fromQuaternion(s,se);v.getColumn(l,0,e.direction),v.getColumn(l,2,e.up),B.cross(e.direction,e.up,e.right),e._setTransform(n),e._adjustOrthographicFrustum(!0)}(this,n,fe,i)}};var me=new B;function ge(e,t){var r,i,n=e._scene.mapMode2D===T.ROTATE,o=e._maxCoord.x,a=e._maxCoord.y;r=n?-(i=o):(i=t.x-2*o,t.x+2*o),t.x>o&&(t.x=i),t.x<-o&&(t.x=r),t.y>a&&(t.y=a),t.y<-a&&(t.y=-a)}x.prototype.flyHome=function(e){var t=this._mode;if(t===A.MORPHING&&this._scene.completeMorph(),t===A.SCENE2D)this.flyTo({destination:x.DEFAULT_VIEW_RECTANGLE,duration:e,endTransform:C.IDENTITY});else if(t===A.SCENE3D){var r=this.getRectangleCameraCoordinates(x.DEFAULT_VIEW_RECTANGLE),i=B.magnitude(r);i+=i*x.DEFAULT_VIEW_FACTOR,B.normalize(r,r),B.multiplyByScalar(r,i,r),this.flyTo({destination:r,duration:e,endTransform:C.IDENTITY})}else if(t===A.COLUMBUS_VIEW){var n=this._projection.ellipsoid.maximumRadius,o=new B(0,-1,1);o=B.multiplyByScalar(B.normalize(o,o),5*n,o),this.flyTo({destination:o,duration:e,orientation:{heading:0,pitch:-Math.acos(B.normalize(o,me).z),roll:0},endTransform:C.IDENTITY,convert:!1})}},x.prototype.worldToCameraCoordinates=function(e,t){if(!U(e))throw new d("cartesian is required.");return U(t)||(t=new b),o(this),C.multiplyByVector(this._actualInvTransform,e,t)},x.prototype.worldToCameraCoordinatesPoint=function(e,t){if(!U(e))throw new d("cartesian is required.");return U(t)||(t=new B),o(this),C.multiplyByPoint(this._actualInvTransform,e,t)},x.prototype.worldToCameraCoordinatesVector=function(e,t){if(!U(e))throw new d("cartesian is required.");return U(t)||(t=new B),o(this),C.multiplyByPointAsVector(this._actualInvTransform,e,t)},x.prototype.cameraToWorldCoordinates=function(e,t){if(!U(e))throw new d("cartesian is required.");return U(t)||(t=new b),o(this),C.multiplyByVector(this._actualTransform,e,t)},x.prototype.cameraToWorldCoordinatesPoint=function(e,t){if(!U(e))throw new d("cartesian is required.");return U(t)||(t=new B),o(this),C.multiplyByPoint(this._actualTransform,e,t)},x.prototype.cameraToWorldCoordinatesVector=function(e,t){if(!U(e))throw new d("cartesian is required.");return U(t)||(t=new B),o(this),C.multiplyByPointAsVector(this._actualTransform,e,t)};var _e=new B;x.prototype.move=function(e,t){if(!U(e))throw new d("direction is required.");var r=this.position;B.multiplyByScalar(e,t,_e),B.add(r,_e,r),this._mode===A.SCENE2D&&ge(this,r),this._adjustOrthographicFrustum(!0)},x.prototype.moveForward=function(e){e=m(e,this.defaultMoveAmount),this._mode===A.SCENE2D?xe(this,e):this.move(this.direction,e)},x.prototype.moveBackward=function(e){e=m(e,this.defaultMoveAmount),this._mode===A.SCENE2D?xe(this,-e):this.move(this.direction,-e)},x.prototype.moveUp=function(e){e=m(e,this.defaultMoveAmount),this.move(this.up,e)},x.prototype.moveDown=function(e){e=m(e,this.defaultMoveAmount),this.move(this.up,-e)},x.prototype.moveRight=function(e){e=m(e,this.defaultMoveAmount),this.move(this.right,e)},x.prototype.moveLeft=function(e){e=m(e,this.defaultMoveAmount),this.move(this.right,-e)},x.prototype.lookLeft=function(e){e=m(e,this.defaultLookAmount),this._mode!==A.SCENE2D&&this.look(this.up,-e)},x.prototype.lookRight=function(e){e=m(e,this.defaultLookAmount),this._mode!==A.SCENE2D&&this.look(this.up,e)},x.prototype.lookUp=function(e){e=m(e,this.defaultLookAmount),this._mode!==A.SCENE2D&&this.look(this.right,-e)},x.prototype.lookDown=function(e){e=m(e,this.defaultLookAmount),this._mode!==A.SCENE2D&&this.look(this.right,e)};var ve=new y,ye=new v;x.prototype.look=function(e,t){if(!U(e))throw new d("axis is required.");var r=m(t,this.defaultLookAmount),i=y.fromAxisAngle(e,-r,ve),n=v.fromQuaternion(i,ye),o=this.direction,a=this.up,s=this.right;v.multiplyByVector(n,o,o),v.multiplyByVector(n,a,a),v.multiplyByVector(n,s,s)},x.prototype.twistLeft=function(e){e=m(e,this.defaultLookAmount),this.look(this.direction,e)},x.prototype.twistRight=function(e){e=m(e,this.defaultLookAmount),this.look(this.direction,-e)};var be=new y,Ce=new v;x.prototype.rotate=function(e,t){if(!U(e))throw new d("axis is required.");var r=m(t,this.defaultRotateAmount),i=y.fromAxisAngle(e,-r,be),n=v.fromQuaternion(i,Ce);v.multiplyByVector(n,this.position,this.position),v.multiplyByVector(n,this.direction,this.direction),v.multiplyByVector(n,this.up,this.up),B.cross(this.direction,this.up,this.right),B.cross(this.right,this.direction,this.up),this._adjustOrthographicFrustum(!1)},x.prototype.rotateDown=function(e){r(this,e=m(e,this.defaultRotateAmount))},x.prototype.rotateUp=function(e){r(this,-(e=m(e,this.defaultRotateAmount)))};var we=new B,Se=new B,Te=new B,Ee=new B;function r(e,t){var r=e.position,i=B.normalize(r,we);if(U(e.constrainedAxis)){var n=B.equalsEpsilon(i,e.constrainedAxis,z.EPSILON2),o=B.equalsEpsilon(i,B.negate(e.constrainedAxis,Ee),z.EPSILON2);if(n||o)(n&&t<0||o&&0<t)&&e.rotate(e.right,t);else{var a=B.normalize(e.constrainedAxis,Se),s=B.dot(i,a),l=z.acosClamped(s);0<t&&l<t&&(t=l-z.EPSILON4),s=B.dot(i,B.negate(a,Ee)),l=z.acosClamped(s),t<0&&l<-t&&(t=-l+z.EPSILON4);var u=B.cross(a,i,Te);e.rotate(u,t)}}else e.rotate(e.right,t)}function Ae(e,t){U(e.constrainedAxis)?e.rotate(e.constrainedAxis,t):e.rotate(e.up,t)}function xe(e,t){var r,i=e.frustum;if(!(i instanceof c&&U(i.left)&&U(i.right)&&U(i.bottom)&&U(i.top)))throw new d("The camera frustum is expected to be orthographic for 2D camera control.");if(t*=.5,Math.abs(i.top)+Math.abs(i.bottom)>Math.abs(i.left)+Math.abs(i.right)){var n=i.top-t,o=i.bottom+t,a=e._maxCoord.y;e._scene.mapMode2D===T.ROTATE&&(a*=e.maximumZoomFactor),a<o&&(n=-(o=a)),n<=o&&(o=-(n=1)),r=i.right/i.top,i.top=n,i.bottom=o,i.right=i.top*r,i.left=-i.right}else{var s=i.right-t,l=i.left+t,u=e._maxCoord.x;e._scene.mapMode2D===T.ROTATE&&(u*=e.maximumZoomFactor),u<s&&(l=-(s=u)),s<=l&&(l=-(s=1)),r=i.top/i.right,i.right=s,i.left=l,i.top=i.right*r,i.bottom=-i.top}}function Pe(e,t){e.move(e.direction,t)}x.prototype.rotateRight=function(e){Ae(this,-(e=m(e,this.defaultRotateAmount)))},x.prototype.rotateLeft=function(e){Ae(this,e=m(e,this.defaultRotateAmount))},x.prototype.zoomIn=function(e){e=m(e,this.defaultZoomAmount),this._mode===A.SCENE2D?xe(this,e):Pe(this,e)},x.prototype.zoomOut=function(e){e=m(e,this.defaultZoomAmount),this._mode===A.SCENE2D?xe(this,-e):Pe(this,-e)},x.prototype.getMagnitude=function(){return this._mode===A.SCENE3D?B.magnitude(this.position):this._mode===A.COLUMBUS_VIEW?Math.abs(this.position.z):this._mode===A.SCENE2D?Math.max(this.frustum.right-this.frustum.left,this.frustum.top-this.frustum.bottom):void 0};var De=new C;x.prototype.lookAt=function(e,t){if(!U(e))throw new d("target is required");if(!U(t))throw new d("offset is required");if(this._mode===A.MORPHING)throw new d("lookAt is not supported while morphing.");var r=S.eastNorthUpToFixedFrame(e,g.WGS84,De);this.lookAtTransform(r,t)};var Oe=new B,Ie=new y,Me=new y,Re=new v;function Le(e,t,r){t=z.clamp(t,-z.PI_OVER_TWO,z.PI_OVER_TWO),e=z.zeroToTwoPi(e)-z.PI_OVER_TWO;var i=y.fromAxisAngle(B.UNIT_Y,-t,Ie),n=y.fromAxisAngle(B.UNIT_Z,-e,Me),o=y.multiply(n,i,n),a=v.fromQuaternion(o,Re),s=B.clone(B.UNIT_X,Oe);return v.multiplyByVector(a,s,s),B.negate(s,s),B.multiplyByScalar(s,r,s),s}x.prototype.lookAtTransform=function(e,t){if(!U(e))throw new d("transform is required");if(this._mode===A.MORPHING)throw new d("lookAtTransform is not supported while morphing.");if(this._setTransform(e),U(t)){var r;if(r=U(t.heading)?Le(t.heading,t.pitch,t.range):t,this._mode===A.SCENE2D){p.clone(p.ZERO,this.position),B.negate(r,this.up),this.up.z=0,B.magnitudeSquared(this.up)<z.EPSILON10&&B.clone(B.UNIT_Y,this.up),B.normalize(this.up,this.up),this._setTransform(C.IDENTITY),B.negate(B.UNIT_Z,this.direction),B.cross(this.direction,this.up,this.right),B.normalize(this.right,this.right);var i=this.frustum,n=i.top/i.right;return i.right=.5*B.magnitude(r),i.left=-i.right,i.top=n*i.right,i.bottom=-i.top,void this._setTransform(e)}B.clone(r,this.position),B.negate(this.position,this.direction),B.normalize(this.direction,this.direction),B.cross(this.direction,B.UNIT_Z,this.right),B.magnitudeSquared(this.right)<z.EPSILON10&&B.clone(B.UNIT_X,this.right),B.normalize(this.right,this.right),B.cross(this.right,this.direction,this.up),B.normalize(this.up,this.up),this._adjustOrthographicFrustum(!0)}};var Ne,ke=new i,Fe=new i,Be=new B,Ue=new B,Ve=new B,ze=new B,qe=new B,Ge=new B,We=new B,He=new B,je={direction:new B,right:new B,up:new B};function Ye(e,t,r,i){return Math.abs(B.dot(t,r))/i-B.dot(e,r)}function Xe(e,t,r,i){var n=e._projection.ellipsoid,o=i?e:je,a=t.north,s=t.south,l=t.east,u=t.west;l<u&&(l+=z.TWO_PI);var c,d=.5*(u+l);if(s<-z.PI_OVER_TWO+z.RADIANS_PER_DEGREE&&a>z.PI_OVER_TWO-z.RADIANS_PER_DEGREE)c=0;else{var h=ke;h.longitude=d,h.latitude=a,h.height=0;var p=Fe;p.longitude=d,p.latitude=s,p.height=0;var f=Ne;U(f)&&f.ellipsoid===n||(Ne=f=new V(void 0,void 0,n)),f.setEndPoints(h,p),c=f.interpolateUsingFraction(.5,ke).latitude}var m=ke;m.longitude=d,m.latitude=c,m.height=0;var g=n.cartographicToCartesian(m,We),_=ke;_.longitude=l,_.latitude=a;var v=n.cartographicToCartesian(_,Be);_.longitude=u;var y=n.cartographicToCartesian(_,Ve);_.longitude=d;var b=n.cartographicToCartesian(_,qe);_.latitude=s;var C=n.cartographicToCartesian(_,Ge);_.longitude=l;var w=n.cartographicToCartesian(_,ze);_.longitude=u;var S=n.cartographicToCartesian(_,Ue);B.subtract(y,g,y),B.subtract(w,g,w),B.subtract(v,g,v),B.subtract(S,g,S),B.subtract(b,g,b),B.subtract(C,g,C);var T=n.geodeticSurfaceNormal(g,o.direction);B.negate(T,T);var E=B.cross(T,B.UNIT_Z,o.right);B.normalize(E,E);var A,x=B.cross(E,T,o.up);if(e.frustum instanceof q){var P,D,O=Math.max(B.distance(v,y),B.distance(w,S)),I=Math.max(B.distance(v,w),B.distance(y,S)),M=e.frustum._offCenterFrustum.right/e.frustum._offCenterFrustum.top,R=I*M;R<O?D=(P=O)/M:(D=I,P=R),A=Math.max(P,D)}else{var L=Math.tan(.5*e.frustum.fovy),N=e.frustum.aspectRatio*L;if(A=Math.max(Ye(T,x,y,L),Ye(T,x,w,L),Ye(T,x,v,L),Ye(T,x,S,L),Ye(T,x,b,L),Ye(T,x,C,L),Ye(T,E,y,N),Ye(T,E,w,N),Ye(T,E,v,N),Ye(T,E,S,N),Ye(T,E,b,N),Ye(T,E,C,N)),s<0&&0<a){var k=ke;k.longitude=u,k.latitude=0,k.height=0;var F=n.cartographicToCartesian(k,He);B.subtract(F,g,F),A=Math.max(A,Ye(T,x,F,L),Ye(T,E,F,N)),k.longitude=l,F=n.cartographicToCartesian(k,He),B.subtract(F,g,F),A=Math.max(A,Ye(T,x,F,L),Ye(T,E,F,N))}}return B.add(g,B.multiplyByScalar(T,-A,He),r)}var Qe=new i,Ze=new B,Ke=new B;var Je=new i,$e=new B,et=new B;x.prototype.getRectangleCameraCoordinates=function(e,t){if(!U(e))throw new d("rectangle is required");var r=this._mode;return U(t)||(t=new B),r===A.SCENE3D?Xe(this,e,t):r===A.COLUMBUS_VIEW?function(e,t,r){var i=e._projection;t.west>t.east&&(t=w.MAX_VALUE);var n=e._actualTransform,o=e._actualInvTransform,a=Qe;a.longitude=t.east,a.latitude=t.north;var s=i.project(a,Ze);C.multiplyByPoint(n,s,s),C.multiplyByPoint(o,s,s),a.longitude=t.west,a.latitude=t.south;var l=i.project(a,Ke);if(C.multiplyByPoint(n,l,l),C.multiplyByPoint(o,l,l),r.x=.5*(s.x-l.x)+l.x,r.y=.5*(s.y-l.y)+l.y,U(e.frustum.fovy)){var u=Math.tan(.5*e.frustum.fovy),c=e.frustum.aspectRatio*u;r.z=.5*Math.max((s.x-l.x)/c,(s.y-l.y)/u)}else{var d=s.x-l.x,h=s.y-l.y;r.z=Math.max(d,h)}return r}(this,e,t):r===A.SCENE2D?function(e,t,r){var i=e._projection;t.west>t.east&&(t=w.MAX_VALUE);var n=Je;n.longitude=t.east,n.latitude=t.north;var o=i.project(n,$e);n.longitude=t.west,n.latitude=t.south;var a,s,l=i.project(n,et),u=.5*Math.abs(o.x-l.x),c=.5*Math.abs(o.y-l.y),d=e.frustum.right/e.frustum.top,h=c*d;return h<u?s=(a=u)/d:(s=c,a=h),c=Math.max(2*a,2*s),r.x=.5*(o.x-l.x)+l.x,r.y=.5*(o.y-l.y)+l.y,(n=i.unproject(r,n)).height=c,r=i.project(n,r)}(this,e,t):void 0};var tt=new l;var rt=new l;var it=new l;x.prototype.pickEllipsoid=function(e,t,r){if(!U(e))throw new d("windowPosition is required.");var i=this._scene.canvas;if(0!==i.clientWidth&&0!==i.clientHeight){if(U(r)||(r=new B),t=m(t,g.WGS84),this._mode===A.SCENE3D)r=function(e,t,r,i){r=m(r,g.WGS84);var n=e.getPickRay(t,tt),o=s.rayEllipsoid(n,r);if(o){var a=0<o.start?o.start:o.stop;return l.getPoint(n,a,i)}}(this,e,t,r);else if(this._mode===A.SCENE2D)r=function(e,t,r,i){var n=e.getPickRay(t,rt).origin;n.z=0;var o=r.unproject(n);if(!(o.latitude<-z.PI_OVER_TWO||o.latitude>z.PI_OVER_TWO))return r.ellipsoid.cartographicToCartesian(o,i)}(this,e,this._projection,r);else{if(this._mode!==A.COLUMBUS_VIEW)return;r=function(e,t,r,i){var n=e.getPickRay(t,it),o=-n.origin.x/n.direction.x;l.getPoint(n,o,i);var a=r.unproject(new B(i.y,i.z,0));if(!(a.latitude<-z.PI_OVER_TWO||a.latitude>z.PI_OVER_TWO||a.longitude<-Math.PI||a.longitude>Math.PI))return r.ellipsoid.cartographicToCartesian(a,i)}(this,e,this._projection,r)}return r}};var nt=new B,ot=new B,at=new B;var st=new B;x.prototype.getPickRay=function(e,t){if(!U(e))throw new d("windowPosition is required.");U(t)||(t=new l);var r=this.frustum;return U(r.aspectRatio)&&U(r.fov)&&U(r.near)?function(e,t,r){var i=e._scene.canvas,n=i.clientWidth,o=i.clientHeight,a=Math.tan(.5*e.frustum.fovy),s=e.frustum.aspectRatio*a,l=e.frustum.near,u=2/n*t.x-1,c=2/o*(o-t.y)-1,d=e.positionWC;B.clone(d,r.origin);var h=B.multiplyByScalar(e.directionWC,l,nt);B.add(d,h,h);var p=B.multiplyByScalar(e.rightWC,u*l*s,ot),f=B.multiplyByScalar(e.upWC,c*l*a,at),m=B.add(h,p,r.direction);return B.add(m,f,m),B.subtract(m,d,m),B.normalize(m,m),r}(this,e,t):function(e,t,r){var i=e._scene.canvas,n=i.clientWidth,o=i.clientHeight,a=e.frustum;U(a._offCenterFrustum)&&(a=a._offCenterFrustum);var s=2/n*t.x-1;s*=.5*(a.right-a.left);var l=2/o*(o-t.y)-1;l*=.5*(a.top-a.bottom);var u=r.origin;return B.clone(e.position,u),B.multiplyByScalar(e.right,s,st),B.add(st,u,u),B.multiplyByScalar(e.up,l,st),B.add(st,u,u),B.clone(e.directionWC,r.direction),e._mode===A.COLUMBUS_VIEW&&B.fromElements(r.origin.z,r.origin.x,r.origin.y,r.origin),r}(this,e,t)};var lt=new B,ut=new B;x.prototype.distanceToBoundingSphere=function(e){if(!U(e))throw new d("boundingSphere is required.");var t=B.subtract(this.positionWC,e.center,lt),r=B.multiplyByScalar(this.directionWC,B.dot(t,this.directionWC),ut);return Math.max(0,B.magnitude(r)-e.radius)};var ct=new p;x.prototype.getPixelSize=function(e,t,r){if(!U(e))throw new d("boundingSphere is required.");if(!U(t))throw new d("drawingBufferWidth is required.");if(!U(r))throw new d("drawingBufferHeight is required.");var i=this.distanceToBoundingSphere(e),n=this.frustum.getPixelDimensions(t,r,i,ct);return Math.max(n.x,n.y)};var dt=new B,ht=new B,pt=new B,ft=new B;function mt(e,t){var r=e.position,i=e.direction,n=e.worldToCameraCoordinatesVector(B.UNIT_X,dt),o=-B.dot(n,r)/B.dot(n,i),a=B.add(r,B.multiplyByScalar(i,o,ht),ht);e.cameraToWorldCoordinatesPoint(a,a),r=e.cameraToWorldCoordinatesPoint(e.position,pt);var s,l,u,c,d,h,p,f=Math.tan(.5*e.frustum.fovy),m=e.frustum.aspectRatio*f,g=B.magnitude(B.subtract(r,a,ft)),_=m*g,v=f*g,y=e._maxCoord.x,b=e._maxCoord.y,C=Math.max(_-y,y),w=Math.max(v-b,b);if(r.z<-C||r.z>C||r.y<-w||r.y>w){var S=a.y<-C||a.y>C,T=a.z<-w||a.z>w;if(S||T)return s=e,l=r,u=a,c=C,d=w,h=t,p=B.clone(l),u.y>c?p.y-=u.y-c:u.y<-c&&(p.y+=-c-u.y),u.z>d?p.z-=u.z-d:u.z<-d&&(p.z+=-d-u.z),{easingFunction:E.EXPONENTIAL_OUT,startObject:{time:0},stopObject:{time:1},duration:h,update:function(e){var t=B.lerp(l,p,e.time,new B);s.worldToCameraCoordinatesPoint(t,s.position)}}}}x.prototype.createCorrectPositionTween=function(e){if(!U(e))throw new d("duration is required.");if(this._mode===A.COLUMBUS_VIEW)return mt(this,e)};var gt=new B,_t={destination:void 0,heading:void 0,pitch:void 0,roll:void 0,duration:void 0,complete:void 0,cancel:void 0,endTransform:void 0,maximumHeight:void 0,easingFunction:void 0};x.prototype.cancelFlight=function(){U(this._currentFlight)&&(this._currentFlight.cancelTween(),this._currentFlight=void 0)},x.prototype.flyTo=function(e){var t=(e=m(e,m.EMPTY_OBJECT)).destination;if(!U(t))throw new d("destination is required.");if(this._mode!==A.MORPHING){this.cancelFlight();var r=m(e.orientation,m.EMPTY_OBJECT);if(U(r.direction)&&(r=he(this,t,r,pe.orientation)),U(e.duration)&&e.duration<=0){var i=pe;return i.destination=e.destination,i.orientation.heading=r.heading,i.orientation.pitch=r.pitch,i.orientation.roll=r.roll,i.convert=e.convert,i.endTransform=e.endTransform,this.setView(i),void("function"==typeof e.complete&&e.complete())}var n=U(t.west);n&&(t=this.getRectangleCameraCoordinates(t,gt));var o,a=this;_t.destination=t,_t.heading=r.heading,_t.pitch=r.pitch,_t.roll=r.roll,_t.duration=e.duration,_t.complete=function(){o===a._currentFlight&&(a._currentFlight=void 0),U(e.complete)&&e.complete()},_t.cancel=e.cancel,_t.endTransform=e.endTransform,_t.convert=!n&&e.convert,_t.maximumHeight=e.maximumHeight,_t.pitchAdjustHeight=e.pitchAdjustHeight,_t.flyOverLongitude=e.flyOverLongitude,_t.flyOverLongitudeWeight=e.flyOverLongitudeWeight,_t.easingFunction=e.easingFunction;var s=this._scene;o=s.tweens.add(u.createTween(s,_t)),this._currentFlight=o}};function vt(e,t,r){U(r)||(r=h.clone(x.DEFAULT_OFFSET));var i,n,o,a,s=e._scene.screenSpaceCameraController.minimumZoomDistance,l=e._scene.screenSpaceCameraController.maximumZoomDistance,u=r.range;if(!U(u)||0===u){var c=t.radius;0===c?r.range=100:e.frustum instanceof q||e._mode===A.SCENE2D?r.range=function(e,t){var r,i,n=e.frustum;U(n._offCenterFrustum)&&(n=n._offCenterFrustum);var o=n.right/n.top,a=t*o;return a<t?i=(r=t)/o:(i=t,r=a),1.5*Math.max(r,i)}(e,c):r.range=(i=c,n=e.frustum,o=Math.tan(.5*n.fovy),a=n.aspectRatio*o,Math.max(i/a,i/o)),r.range=z.clamp(r.range,s,l)}return r}x.prototype.viewBoundingSphere=function(e,t){if(!U(e))throw new d("boundingSphere is required.");if(this._mode===A.MORPHING)throw new d("viewBoundingSphere is not supported while morphing.");t=vt(this,e,t),this.lookAt(e.center,t)};var yt=new C,bt=new B,Ct=new B,wt=new B,St=new B,Tt=new b,Et=new y,At=new v;x.prototype.flyToBoundingSphere=function(e,t){if(!U(e))throw new d("boundingSphere is required.");t=m(t,m.EMPTY_OBJECT);var r=this._mode===A.SCENE2D||this._mode===A.COLUMBUS_VIEW;this._setTransform(C.IDENTITY);var i,n=vt(this,e,t.offset);i=r?B.multiplyByScalar(B.UNIT_Z,n.range,bt):Le(n.heading,n.pitch,n.range);var o,a,s=S.eastNorthUpToFixedFrame(e.center,g.WGS84,yt);if(C.multiplyByPoint(s,i,i),!r){if(o=B.subtract(e.center,i,Ct),B.normalize(o,o),a=C.multiplyByPointAsVector(s,B.UNIT_Z,wt),1-Math.abs(B.dot(o,a))<z.EPSILON6){var l=y.fromAxisAngle(o,n.heading,Et),u=v.fromQuaternion(l,At);B.fromCartesian4(C.getColumn(s,1,Tt),a),v.multiplyByVector(u,a,a)}var c=B.cross(o,a,St);B.cross(c,o,a),B.normalize(a,a)}this.flyTo({destination:i,orientation:{direction:o,up:a},duration:t.duration,complete:t.complete,cancel:t.cancel,endTransform:t.endTransform,maximumHeight:t.maximumHeight,easingFunction:t.easingFunction,flyOverLongitude:t.flyOverLongitude,flyOverLongitudeWeight:t.flyOverLongitudeWeight,pitchAdjustHeight:t.pitchAdjustHeight})};var xt=new B,Pt=new B,Dt=new B,Ot=new B,It=[new B,new B,new B,new B];var Mt=new p,Rt=new B,Lt=[new i,new i,new i,new i];function Nt(e,t,r,i,n,o){Mt.x=e,Mt.y=t;var a=i.pickEllipsoid(Mt,n,Rt);return U(a)?(Lt[r]=n.cartesianToCartographic(a,Lt[r]),1):(Lt[r]=n.cartesianToCartographic(o[r],Lt[r]),0)}return x.prototype.computeViewRectangle=function(e,t){e=m(e,g.WGS84);var r=this.frustum.computeCullingVolume(this.positionWC,this.directionWC,this.upWC),i=new f(B.ZERO,e.maximumRadius);if(r.computeVisibility(i)!==_.OUTSIDE){var n=this._scene.canvas,o=n.clientWidth,a=n.clientHeight,s=0,l=function(e,t){var r,i,n=t.radii,o=e.positionWC,a=B.multiplyComponents(t.oneOverRadii,o,xt),s=B.magnitude(a),l=B.normalize(a,Pt);i=B.equalsEpsilon(l,B.UNIT_Z,z.EPSILON10)?(r=new B(0,1,0),new B(0,0,1)):(r=B.normalize(B.cross(B.UNIT_Z,l,Dt),Dt),B.normalize(B.cross(l,r,Ot),Ot));var u=Math.sqrt(B.magnitudeSquared(a)-1),c=B.multiplyByScalar(l,1/s,xt),d=u/s,h=B.multiplyByScalar(r,d,Pt),p=B.multiplyByScalar(i,d,Dt),f=B.add(c,p,It[0]);B.subtract(f,h,f),B.multiplyComponents(n,f,f);var m=B.subtract(c,p,It[1]);B.subtract(m,h,m),B.multiplyComponents(n,m,m);var g=B.subtract(c,p,It[2]);B.add(g,h,g),B.multiplyComponents(n,g,g);var _=B.add(c,p,It[3]);return B.add(_,h,_),B.multiplyComponents(n,_,_),It}(this,e);if(s+=Nt(0,0,0,this,e,l),s+=Nt(0,a,1,this,e,l),s+=Nt(o,a,2,this,e,l),(s+=Nt(o,0,3,this,e,l))<2)return w.MAX_VALUE;t=w.fromCartographicArray(Lt,t);for(var u=0,c=Lt[3].longitude,d=0;d<4;++d){var h=Lt[d].longitude,p=Math.abs(h-c);p>z.PI?u+=z.TWO_PI-p:u+=p,c=h}return z.equalsEpsilon(Math.abs(u),z.TWO_PI,z.EPSILON9)&&(t.west=-z.PI,t.east=z.PI,0<=Lt[0].latitude?t.north=z.PI_OVER_TWO:t.south=-z.PI_OVER_TWO),t}},x.prototype.switchToPerspectiveFrustum=function(){if(!(this._mode===A.SCENE2D||this.frustum instanceof a)){var e=this._scene;this.frustum=new a,this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight,this.frustum.fov=z.toRadians(60)}},x.prototype.switchToOrthographicFrustum=function(){if(!(this._mode===A.SCENE2D||this.frustum instanceof q)){var e=this._scene;this.frustum=new q,this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight,this.frustum.width=B.magnitude(this.position);var t=this.frustum.projectionMatrix;U(t)&&this._adjustOrthographicFrustum(!0)}},x.clone=function(e,t){return U(t)||(t=new x(e._scene)),B.clone(e.position,t.position),B.clone(e.direction,t.direction),B.clone(e.up,t.up),B.clone(e.right,t.right),C.clone(e._transform,t.transform),t._transformChanged=!0,t},x}),define("Scene/CameraEventType",["../Core/freezeObject"],function(e){"use strict";return e({LEFT_DRAG:0,RIGHT_DRAG:1,MIDDLE_DRAG:2,WHEEL:3,PINCH:4})}),define("Scene/CameraEventAggregator",["../Core/Cartesian2","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/KeyboardEventModifier","../Core/Math","../Core/ScreenSpaceEventHandler","../Core/ScreenSpaceEventType","./CameraEventType"],function(d,h,e,t,n,i,o,a,p,f){"use strict";function m(e,t){var r=e;return h(t)&&(r+="+"+t),r}function s(t,e,a){var s=m(f.PINCH,e),l=t._update,u=t._isDown,r=t._eventStartPosition,i=t._pressTime,n=t._releaseTime;l[s]=!0,u[s]=!1,r[s]=new d;var c=t._movement[s];h(c)||(c=t._movement[s]={}),c.distance={startPosition:new d,endPosition:new d},c.angleAndHeight={startPosition:new d,endPosition:new d},c.prevAngle=0,t._eventHandler.setInputAction(function(e){t._buttonsDown++,u[s]=!0,i[s]=new Date,d.lerp(e.position1,e.position2,.5,r[s])},p.PINCH_START,e),t._eventHandler.setInputAction(function(){t._buttonsDown=Math.max(t._buttonsDown-1,0),u[s]=!1,n[s]=new Date},p.PINCH_END,e),t._eventHandler.setInputAction(function(e){if(u[s]){l[s]?(n=e,o=c,d.clone(n.distance.startPosition,o.distance.startPosition),d.clone(n.distance.endPosition,o.distance.endPosition),d.clone(n.angleAndHeight.startPosition,o.angleAndHeight.startPosition),d.clone(n.angleAndHeight.endPosition,o.angleAndHeight.endPosition),l[s]=!1,c.prevAngle=c.angleAndHeight.startPosition.x):(d.clone(e.distance.endPosition,c.distance.endPosition),d.clone(e.angleAndHeight.endPosition,c.angleAndHeight.endPosition));for(var t=c.angleAndHeight.endPosition.x,r=c.prevAngle,i=2*Math.PI;t>=r+Math.PI;)t-=i;for(;t<r-Math.PI;)t+=i;c.angleAndHeight.endPosition.x=-t*a.clientWidth/12,c.angleAndHeight.startPosition.x=-r*a.clientWidth/12}var n,o},p.PINCH_MOVE,e)}function l(e,t){var r=m(f.WHEEL,t),i=e._update;i[r]=!0;var n=e._movement[r];h(n)||(n=e._movement[r]={}),n.startPosition=new d,n.endPosition=new d,e._eventHandler.setInputAction(function(e){var t=15*o.toRadians(e);i[r]?(d.clone(d.ZERO,n.startPosition),n.endPosition.x=0,n.endPosition.y=t,i[r]=!1):n.endPosition.y=n.endPosition.y+t},p.WHEEL,t)}function u(t,e,r){var i=m(r,e),n=t._isDown,o=t._eventStartPosition,a=t._pressTime,s=t._releaseTime;n[i]=!1,o[i]=new d;var l,u,c=t._lastMovement[i];h(c)||(c=t._lastMovement[i]={startPosition:new d,endPosition:new d,valid:!1}),r===f.LEFT_DRAG?(l=p.LEFT_DOWN,u=p.LEFT_UP):r===f.RIGHT_DRAG?(l=p.RIGHT_DOWN,u=p.RIGHT_UP):r===f.MIDDLE_DRAG&&(l=p.MIDDLE_DOWN,u=p.MIDDLE_UP),t._eventHandler.setInputAction(function(e){t._buttonsDown++,c.valid=!1,n[i]=!0,a[i]=new Date,d.clone(e.position,o[i])},l,e),t._eventHandler.setInputAction(function(){t._buttonsDown=Math.max(t._buttonsDown-1,0),n[i]=!1,s[i]=new Date},u,e)}function c(e,t){d.clone(e.startPosition,t.startPosition),d.clone(e.endPosition,t.endPosition)}function g(n,o){var a=n._update,s=n._movement,l=n._lastMovement,u=n._isDown;for(var e in f)if(f.hasOwnProperty(e)){var t=f[e];if(h(t)){var r=m(t,o);a[r]=!0,h(n._lastMovement[r])||(n._lastMovement[r]={startPosition:new d,endPosition:new d,valid:!1}),h(n._movement[r])||(n._movement[r]={startPosition:new d,endPosition:new d})}}n._eventHandler.setInputAction(function(e){for(var t in f)if(f.hasOwnProperty(t)){var r=f[t];if(h(r)){var i=m(r,o);u[i]&&(a[i]?(c(s[i],l[i]),l[i].valid=!0,c(e,s[i]),a[i]=!1):d.clone(e.endPosition,s[i].endPosition))}}d.clone(e.endPosition,n._currentMousePosition)},p.MOUSE_MOVE,o)}function r(e){if(!h(e))throw new n("canvas is required.");for(var t in this._eventHandler=new a(e,!0),this._update={},this._movement={},this._lastMovement={},this._isDown={},this._eventStartPosition={},this._pressTime={},this._releaseTime={},this._buttonsDown=0,this._currentMousePosition=new d,l(this,void 0),s(this,void 0,e),u(this,void 0,f.LEFT_DRAG),u(this,void 0,f.RIGHT_DRAG),u(this,void 0,f.MIDDLE_DRAG),g(this,void 0),i)if(i.hasOwnProperty(t)){var r=i[t];h(r)&&(l(this,r),s(this,r,e),u(this,r,f.LEFT_DRAG),u(this,r,f.RIGHT_DRAG),u(this,r,f.MIDDLE_DRAG),g(this,r))}}return e(r.prototype,{currentMousePosition:{get:function(){return this._currentMousePosition}},anyButtonDown:{get:function(){var e=!(this._update[m(f.WHEEL)]&&this._update[m(f.WHEEL,i.SHIFT)]&&this._update[m(f.WHEEL,i.CTRL)]&&this._update[m(f.WHEEL,i.ALT)]);return 0<this._buttonsDown||e}}}),r.prototype.isMoving=function(e,t){if(!h(e))throw new n("type is required.");var r=m(e,t);return!this._update[r]},r.prototype.getMovement=function(e,t){if(!h(e))throw new n("type is required.");var r=m(e,t);return this._movement[r]},r.prototype.getLastMovement=function(e,t){if(!h(e))throw new n("type is required.");var r=m(e,t),i=this._lastMovement[r];if(i.valid)return i},r.prototype.isButtonDown=function(e,t){if(!h(e))throw new n("type is required.");var r=m(e,t);return this._isDown[r]},r.prototype.getStartMousePosition=function(e,t){if(!h(e))throw new n("type is required.");if(e===f.WHEEL)return this._currentMousePosition;var r=m(e,t);return this._eventStartPosition[r]},r.prototype.getButtonPressTime=function(e,t){if(!h(e))throw new n("type is required.");var r=m(e,t);return this._pressTime[r]},r.prototype.getButtonReleaseTime=function(e,t){if(!h(e))throw new n("type is required.");var r=m(e,t);return this._releaseTime[r]},r.prototype.reset=function(){for(var e in this._update)this._update.hasOwnProperty(e)&&(this._update[e]=!0)},r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return this._eventHandler=this._eventHandler&&this._eventHandler.destroy(),t(this)},r}),define("Scene/Cesium3DTileChildrenVisibility",["../Core/freezeObject"],function(e){"use strict";return e({NONE:0,VISIBLE:1,IN_REQUEST_VOLUME:2,VISIBLE_IN_REQUEST_VOLUME:4,VISIBLE_NOT_IN_REQUEST_VOLUME:8})}),define("Scene/Composite3DTileContent",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/FeatureDetection","../Core/getMagic","../Core/RuntimeError","../ThirdParty/when"],function(f,m,e,i,t,g,_,v){"use strict";if(!t.supportsTypedArrays())return{};function r(e,t,r,i,n,o){this._tileset=e,this._tile=t,this._resource=r,this._contents=[],this._readyPromise=v.defer(),function(t,e,r,i){r=f(r,0);var n=new Uint8Array(e),o=new DataView(e);r+=y;var a=o.getUint32(r,!0);if(1!==a)throw new _("Only Composite Tile version 1 is supported. Version "+a+" is not.");r+=y,r+=y;var s=o.getUint32(r,!0);r+=y;for(var l=[],u=0;u<s;++u){var c=g(n,r),d=o.getUint32(r+2*y,!0),h=i[c];if(!m(h))throw new _("Unknown tile content type, "+c+", inside Composite tile");var p=h(t._tileset,t._tile,t._resource,e,r);t._contents.push(p),l.push(p.readyPromise),r+=d}v.all(l).then(function(){t._readyPromise.resolve(t)}).otherwise(function(e){t._readyPromise.reject(e)})}(this,i,n,o)}e(r.prototype,{featurePropertiesDirty:{get:function(){for(var e=this._contents,t=e.length,r=0;r<t;++r)if(e[r].featurePropertiesDirty)return!0;return!1},set:function(e){for(var t=this._contents,r=t.length,i=0;i<r;++i)t[i].featurePropertiesDirty=e}},featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){return this._contents}},readyPromise:{get:function(){return this._readyPromise.promise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){}}});var y=Uint32Array.BYTES_PER_ELEMENT;return r.prototype.hasProperty=function(e,t){return!1},r.prototype.getFeature=function(e){},r.prototype.applyDebugSettings=function(e,t){for(var r=this._contents,i=r.length,n=0;n<i;++n)r[n].applyDebugSettings(e,t)},r.prototype.applyStyle=function(e,t){for(var r=this._contents,i=r.length,n=0;n<i;++n)r[n].applyStyle(e,t)},r.prototype.update=function(e,t){for(var r=this._contents,i=r.length,n=0;n<i;++n)r[n].update(e,t)},r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){for(var e=this._contents,t=e.length,r=0;r<t;++r)e[r].destroy();return i(this)},r}),define("Scene/Vector3DTileGeometry",["../Core/arraySlice","../Core/BoundingSphere","../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/Matrix4","../Core/TaskProcessor","../ThirdParty/when","./ClassificationType","./Vector3DTileBatch","./Vector3DTilePrimitive"],function(C,w,S,T,E,A,e,t,x,r,i,n,P,D){"use strict";function o(e){this._boxes=e.boxes,this._boxBatchIds=e.boxBatchIds,this._cylinders=e.cylinders,this._cylinderBatchIds=e.cylinderBatchIds,this._ellipsoids=e.ellipsoids,this._ellipsoidBatchIds=e.ellipsoidBatchIds,this._spheres=e.spheres,this._sphereBatchIds=e.sphereBatchIds,this._modelMatrix=e.modelMatrix,this._batchTable=e.batchTable,this._boundingVolume=e.boundingVolume,this._center=e.center,A(this._center)||(A(this._boundingVolume)?this._center=S.clone(this._boundingVolume.center):this._center=S.clone(S.ZERO)),this._boundingVolumes=void 0,this._batchedIndices=void 0,this._indices=void 0,this._indexOffsets=void 0,this._indexCounts=void 0,this._positions=void 0,this._vertexBatchIds=void 0,this._batchIds=void 0,this._batchTableColors=void 0,this._packedBuffer=void 0,this._ready=!1,this._readyPromise=i.defer(),this._verticesPromise=void 0,this._primitive=void 0,this.debugWireframe=!1,this.forceRebatch=!1,this.classificationType=n.CESIUM_3D_TILE}e(o.prototype,{trianglesLength:{get:function(){return A(this._primitive)?this._primitive.trianglesLength:0}},geometryByteLength:{get:function(){return A(this._primitive)?this._primitive.geometryByteLength:0}},readyPromise:{get:function(){return this._readyPromise.promise}}}),o.packedBoxLength=x.packedLength+S.packedLength,o.packedCylinderLength=x.packedLength+2,o.packedEllipsoidLength=x.packedLength+S.packedLength,o.packedSphereLength=S.packedLength+1;var O=new r("createVectorTileGeometries"),I=new T;function a(i){if(!A(i._primitive)){if(!A(i._verticesPromise)){var e=i._boxes,t=i._boxBatchIds,r=i._cylinders,n=i._cylinderBatchIds,o=i._ellipsoids,a=i._ellipsoidBatchIds,s=i._spheres,l=i._sphereBatchIds,u=i._batchTableColors,c=i._packedBuffer;if(!A(u)){var d=0;A(i._boxes)&&(e=i._boxes=C(e),d+=(t=i._boxBatchIds=C(t)).length),A(i._cylinders)&&(r=i._cylinders=C(r),d+=(n=i._cylinderBatchIds=C(n)).length),A(i._ellipsoids)&&(o=i._ellipsoids=C(o),d+=(a=i._ellipsoidBatchIds=C(a)).length),A(i._spheres)&&(s=i._sphere=C(s),d+=(l=i._sphereBatchIds=C(l)).length),u=i._batchTableColors=new Uint32Array(d);for(var h=i._batchTable,p=0;p<d;++p){var f=h.getColor(p,I);u[p]=f.toRgba()}c=i._packedBuffer=(v=i,y=new Float64Array(x.packedLength+S.packedLength),b=0,S.pack(v._center,y,b),b+=S.packedLength,x.pack(v._modelMatrix,y,b),y)}var m=[];A(e)&&m.push(e.buffer,t.buffer),A(r)&&m.push(r.buffer,n.buffer),A(o)&&m.push(o.buffer,a.buffer),A(s)&&m.push(s.buffer,l.buffer),m.push(u.buffer,c.buffer);var g={boxes:A(e)?e.buffer:void 0,boxBatchIds:A(e)?t.buffer:void 0,cylinders:A(r)?r.buffer:void 0,cylinderBatchIds:A(r)?n.buffer:void 0,ellipsoids:A(o)?o.buffer:void 0,ellipsoidBatchIds:A(o)?a.buffer:void 0,spheres:A(s)?s.buffer:void 0,sphereBatchIds:A(s)?l.buffer:void 0,batchTableColors:u.buffer,packedBuffer:c.buffer},_=i._verticesPromise=O.scheduleTask(g,m);if(!A(_))return;_.then(function(e){var t=new Float64Array(e.packedBuffer),r=function(e,t){for(var r=0,i=t[r++],n=t[r++],o=e._boundingVolumes=new Array(n),a=0;a<n;++a)o[a]=w.unpack(t,r),r+=w.packedLength;for(var s=t[r++],l=e._batchedIndices=new Array(s),u=0;u<s;++u){var c=T.unpack(t,r);r+=T.packedLength;for(var d=t[r++],h=t[r++],p=t[r++],f=new Array(p),m=0;m<p;++m)f[m]=t[r++];l[u]=new P({color:c,offset:d,count:h,batchIds:f})}return i}(i,t);i._indices=2===r?new Uint16Array(e.indices):new Uint32Array(e.indices),i._indexOffsets=new Uint32Array(e.indexOffsets),i._indexCounts=new Uint32Array(e.indexCounts),i._positions=new Float32Array(e.positions),i._vertexBatchIds=new Uint16Array(e.vertexBatchIds),i._batchIds=new Uint16Array(e.batchIds),i._ready=!0})}var v,y,b;i._ready&&!A(i._primitive)&&(i._primitive=new D({batchTable:i._batchTable,positions:i._positions,batchIds:i._batchIds,vertexBatchIds:i._vertexBatchIds,indices:i._indices,indexOffsets:i._indexOffsets,indexCounts:i._indexCounts,batchedIndices:i._batchedIndices,boundingVolume:i._boundingVolume,boundingVolumes:i._boundingVolumes,center:i._center,pickObject:E(i._pickObject,i)}),i._boxes=void 0,i._boxBatchIds=void 0,i._cylinders=void 0,i._cylinderBatchIds=void 0,i._ellipsoids=void 0,i._ellipsoidBatchIds=void 0,i._spheres=void 0,i._sphereBatchIds=void 0,i._center=void 0,i._modelMatrix=void 0,i._batchTable=void 0,i._boundingVolume=void 0,i._boundingVolumes=void 0,i._batchedIndices=void 0,i._indices=void 0,i._indexOffsets=void 0,i._indexCounts=void 0,i._positions=void 0,i._vertexBatchIds=void 0,i._batchIds=void 0,i._batchTableColors=void 0,i._packedBuffer=void 0,i._verticesPromise=void 0,i._readyPromise.resolve())}}return o.prototype.createFeatures=function(e,t){this._primitive.createFeatures(e,t)},o.prototype.applyDebugSettings=function(e,t){this._primitive.applyDebugSettings(e,t)},o.prototype.applyStyle=function(e,t,r){this._primitive.applyStyle(e,t,r)},o.prototype.updateCommands=function(e,t){this._primitive.updateCommands(e,t)},o.prototype.update=function(e){a(this),this._ready&&(this._primitive.debugWireframe=this.debugWireframe,this._primitive.forceRebatch=this.forceRebatch,this._primitive.classificationType=this.classificationType,this._primitive.update(e))},o.prototype.isDestroyed=function(){return!1},o.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),t(this)},o}),define("Scene/Geometry3DTileContent",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Ellipsoid","../Core/FeatureDetection","../Core/getMagic","../Core/getStringFromTypedArray","../Core/Math","../Core/Matrix4","../Core/Rectangle","../Core/RuntimeError","../ThirdParty/when","./Cesium3DTileBatchTable","./Vector3DTileGeometry"],function(N,k,F,e,t,r,i,n,o,B,a,U,s,V,l,z,q){"use strict";if(!n.supportsTypedArrays())return{};function u(e,t,r,i,n){this._tileset=e,this._tile=t,this._resource=r,this._geometries=void 0,this._contentReadyPromise=void 0,this._readyPromise=l.defer(),this._batchTable=void 0,this._features=void 0,this.featurePropertiesDirty=!1,function(e,t,r){r=k(r,0);var i=new Uint8Array(t),n=new DataView(t);r+=G;var o=n.getUint32(r,!0);if(1!==o)throw new V("Only Geometry tile version 1 is supported.  Version "+o+" is not.");r+=G;var a=n.getUint32(r,!0);if(r+=G,0===a)return e._readyPromise.resolve(e);var s=n.getUint32(r,!0);if(r+=G,0===s)throw new V("Feature table must have a byte length greater than zero");var l=n.getUint32(r,!0);r+=G;var u=n.getUint32(r,!0);r+=G;var c=n.getUint32(r,!0),d=B(i,r+=G,s),h=JSON.parse(d);r+=s;var p,f,m=new Uint8Array(t,r,l);if(r+=l,0<u){var g=B(i,r,u);p=JSON.parse(g),r+=u,0<c&&(f=new Uint8Array(t,r,c),f=new Uint8Array(f))}var _=k(h.BOXES_LENGTH,0),v=k(h.CYLINDERS_LENGTH,0),y=k(h.ELLIPSOIDS_LENGTH,0),b=k(h.SPHERES_LENGTH,0),C=_+v+y+b,w=new z(e,C,p,f,(S=e,function(e,t){F(S._geometries)&&S._geometries.updateCommands(e,t)}));var S;if(e._batchTable=w,0===C)return;var T,E=e._tile.computedTransform;F(h.RTC_CENTER)&&(T=N.unpack(h.RTC_CENTER),U.multiplyByPoint(E,T,T));var A=function(e,t){var r,i,n,o,a,s=k(e.BOXES_LENGTH,0),l=k(e.CYLINDERS_LENGTH,0),u=k(e.ELLIPSOIDS_LENGTH,0),c=k(e.SPHERES_LENGTH,0);if(0<s&&F(e.BOX_BATCH_IDS)){var d=t.byteOffset+e.BOX_BATCH_IDS.byteOffset;r=new Uint16Array(t.buffer,d,s)}if(0<l&&F(e.CYLINDER_BATCH_IDS)){var h=t.byteOffset+e.CYLINDER_BATCH_IDS.byteOffset;i=new Uint16Array(t.buffer,h,l)}if(0<u&&F(e.ELLIPSOID_BATCH_IDS)){var p=t.byteOffset+e.ELLIPSOID_BATCH_IDS.byteOffset;n=new Uint16Array(t.buffer,p,u)}if(0<c&&F(e.SPHERE_BATCH_IDS)){var f=t.byteOffset+e.SPHERE_BATCH_IDS.byteOffset;o=new Uint16Array(t.buffer,f,c)}var m=F(r)||F(i)||F(n)||F(o),g=0<s&&!F(r)||0<l&&!F(i)||0<u&&!F(n)||0<c&&!F(o);if(m&&g)throw new V("If one group of batch ids is defined, then all batch ids must be defined.");if(!(F(r)||F(i)||F(n)||F(o))){var _=0;if(!F(r)&&0<s)for(r=new Uint16Array(s),a=0;a<s;++a)r[a]=_++;if(!F(i)&&0<l)for(i=new Uint16Array(l),a=0;a<l;++a)i[a]=_++;if(!F(n)&&0<u)for(n=new Uint16Array(u),a=0;a<u;++a)n[a]=_++;if(!F(o)&&0<c)for(o=new Uint16Array(c),a=0;a<c;++a)o[a]=_++}return{boxes:r,cylinders:i,ellipsoids:n,spheres:o}}(h,m);if(0<_||0<v||0<y||0<b){var x,P,D,O;if(0<_){var I=m.byteOffset+h.BOXES.byteOffset;x=new Float32Array(m.buffer,I,q.packedBoxLength*_)}if(0<v){var M=m.byteOffset+h.CYLINDERS.byteOffset;P=new Float32Array(m.buffer,M,q.packedCylinderLength*v)}if(0<y){var R=m.byteOffset+h.ELLIPSOIDS.byteOffset;D=new Float32Array(m.buffer,R,q.packedEllipsoidLength*y)}if(0<b){var L=m.byteOffset+h.SPHERES.byteOffset;O=new Float32Array(m.buffer,L,q.packedSphereLength*b)}e._geometries=new q({boxes:x,boxBatchIds:A.boxes,cylinders:P,cylinderBatchIds:A.cylinders,ellipsoids:D,ellipsoidBatchIds:A.ellipsoids,spheres:O,sphereBatchIds:A.spheres,center:T,modelMatrix:E,batchTable:w,boundingVolume:e._tile._boundingVolume.boundingVolume})}}(this,i,n)}e(u.prototype,{featuresLength:{get:function(){return F(this._batchTable)?this._batchTable.featuresLength:0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return F(this._geometries)?this._geometries.trianglesLength:0}},geometryByteLength:{get:function(){return F(this._geometries)?this._geometries.geometryByteLength:0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return F(this._batchTable)?this._batchTable.memorySizeInBytes:0}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._readyPromise.promise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){return this._batchTable}}});var G=Uint32Array.BYTES_PER_ELEMENT;function c(e){var t=e.featuresLength;if(!F(e._features)&&0<t){var r=new Array(t);F(e._geometries)&&e._geometries.createFeatures(e,r),e._features=r}}return u.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},u.prototype.getFeature=function(e){var t=this.featuresLength;if(!F(e)||e<0||t<=e)throw new r("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").");return c(this),this._features[e]},u.prototype.applyDebugSettings=function(e,t){F(this._geometries)&&this._geometries.applyDebugSettings(e,t)},u.prototype.applyStyle=function(e,t){c(this),F(this._geometries)&&this._geometries.applyStyle(e,t,this._features)},u.prototype.update=function(e,t){if(F(this._batchTable)&&this._batchTable.update(e,t),F(this._geometries)&&(this._geometries.classificationType=this._tileset.classificationType,this._geometries.debugWireframe=this._tileset.debugWireframe,this._geometries.update(t)),!F(this._contentReadyPromise)){var r=this;this._contentReadyPromise=this._geometries.readyPromise.then(function(){r._readyPromise.resolve(r)})}},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){return this._geometries=this._geometries&&this._geometries.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),t(this)},u}),define("Scene/ModelInstance",["../Core/defineProperties","../Core/Matrix4"],function(e,i){"use strict";function t(e,t,r){this.primitive=e,this._modelMatrix=i.clone(t),this._instanceId=r}return e(t.prototype,{instanceId:{get:function(){return this._instanceId}},model:{get:function(){return this.primitive._model}},modelMatrix:{get:function(){return i.clone(this._modelMatrix)},set:function(e){i.clone(e,this._modelMatrix),this.primitive.expandBoundingSphere(this._modelMatrix),this.primitive._dirty=!0}}}),t}),define("Scene/ModelInstanceCollection",["../Core/BoundingSphere","../Core/Cartesian3","../Core/clone","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/destroyObject","../Core/DeveloperError","../Core/Matrix4","../Core/PrimitiveType","../Core/Resource","../Core/RuntimeError","../Core/Transforms","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/ShaderSource","../ThirdParty/when","./Model","./ModelInstance","./ModelUtility","./SceneMode","./ShadowMode"],function(v,y,b,m,g,l,C,e,t,i,r,w,S,n,_,T,E,A,x,o,P,a,D,u,O,I,M){"use strict";var R=0,L=1,N=2,k=3;function s(e){if(e=l(e,l.EMPTY_OBJECT),!C(e.gltf)&&!C(e.url))throw new r("Either options.gltf or options.url is required.");if(C(e.gltf)&&C(e.url))throw new r("Cannot pass in both options.gltf and options.url.");this.show=l(e.show,!0),this._instancingSupported=!1,this._dynamic=l(e.dynamic,!1),this._allowPicking=l(e.allowPicking,!0),this._ready=!1,this._readyPromise=a.defer(),this._state=R,this._dirty=!1,this._cull=l(e.cull,!0),this._opaquePass=l(e.opaquePass,o.OPAQUE),this._instances=function(e,t){for(var r=(t=l(t,[])).length,i=new Array(r),n=0;n<r;++n){var o=t[n],a=o.modelMatrix,s=l(o.batchId,n);i[n]=new u(e,a,s)}return i}(this,e.instances),this._batchTable=e.batchTable,this._model=void 0,this._vertexBufferTypedArray=void 0,this._vertexBuffer=void 0,this._batchIdBuffer=void 0,this._instancedUniformsByProgram=void 0,this._drawCommands=[],this._pickCommands=[],this._modelCommands=void 0,this._boundingSphere=function(e){for(var t=e.length,r=new Array(t),i=0;i<t;++i)r[i]=w.getTranslation(e._instances[i]._modelMatrix,new y);return v.fromPoints(r)}(this),this._center=y.clone(this._boundingSphere.center),this._rtcTransform=new w,this._rtcModelView=new w,this._mode=void 0,this.modelMatrix=w.clone(w.IDENTITY),this._modelMatrix=w.clone(this.modelMatrix),this._url=n.createIfNeeded(e.url),this._requestType=e.requestType,this._gltf=e.gltf,this._basePath=n.createIfNeeded(e.basePath),this._asynchronous=e.asynchronous,this._incrementallyLoadTextures=e.incrementallyLoadTextures,this._upAxis=e.upAxis,this.shadows=l(e.shadows,M.ENABLED),this._shadows=this.shadows,this.debugShowBoundingVolume=l(e.debugShowBoundingVolume,!1),this._debugShowBoundingVolume=!1,this.debugWireframe=l(e.debugWireframe,!1),this._debugWireframe=!1}e(s.prototype,{allowPicking:{get:function(){return this._allowPicking}},length:{get:function(){return this._instances.length}},activeAnimations:{get:function(){return this._model.activeAnimations}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}});var F,c=new y,B=new w;function U(e,t){if(C(e._instancedUniformsByProgram))return e._instancedUniformsByProgram[t];var r={};e._instancedUniformsByProgram=r;var i=["MODEL","MODELVIEW","CESIUM_RTC_MODELVIEW","MODELVIEWPROJECTION","MODELINVERSE","MODELVIEWINVERSE","MODELVIEWPROJECTIONINVERSE","MODELINVERSETRANSPOSE","MODELVIEWINVERSETRANSPOSE"],n=["MODELVIEW","CESIUM_RTC_MODELVIEW","MODELVIEWPROJECTION","MODELVIEWINVERSETRANSPOSE"],o=e._model.gltf.techniques;for(var a in o)if(o.hasOwnProperty(a)){var s=o[a],l=s.parameters,u=s.uniforms,c=s.program;if(!C(r[c])){var d={};for(var h in r[c]=d,u)if(u.hasOwnProperty(h)){var p=l[u[h]],f=p.semantic;if(C(f)&&-1<i.indexOf(f)){if(!(-1<n.indexOf(f)))throw new _('Shader program cannot be optimized for instancing. Parameter "'+p+'" in program "'+t+'" uses unsupported semantic "'+f+'"');d[h]=f}}}}return r[t]}function V(o){return function(e,t){var r=o._batchTable;if(C(r)){var i=o._model.gltf,n=O.getDiffuseAttributeOrUniform(i,t);e=r.getFragmentShaderCallback(!0,n)(e)}return e}}function z(l,u){return function(e,t,r){var i,n,o;(e=b(e)).czm_instanced_modifiedModelView=(i=l,n=u,function(){return w.multiply(n.uniformState.view,i._rtcTransform,i._rtcModelView)}),e.czm_instanced_nodeTransform=(o=r,function(){return o.computedMatrix});var a=U(l,t);for(var s in a)a.hasOwnProperty(s)&&delete e[s];return C(l._batchTable)&&(e=l._batchTable.getUniformMapCallback()(e)),e}}function q(t){return function(e){return C(t._batchTable)&&(e=t._batchTable.getPickUniformMapCallback()(e)),e}}function G(e){var t=e._instances,r=e.length,i=e._center,n=e._vertexBufferTypedArray;C(n)||(n=new Float32Array(12*r)),e._dynamic&&(e._vertexBufferTypedArray=n);for(var o=0;o<r;++o){var a=t[o]._modelMatrix,s=w.clone(a,B);s[12]-=i.x,s[13]-=i.y,s[14]-=i.z;var l=12*o;n[l+0]=s[0],n[l+1]=s[4],n[l+2]=s[8],n[l+3]=s[12],n[l+4]=s[1],n[l+5]=s[5],n[l+6]=s[9],n[l+7]=s[13],n[l+8]=s[2],n[l+9]=s[6],n[l+10]=s[10],n[l+11]=s[14]}return n}function W(e,t){var i,r,n,o,a,s,f,l=e._instancingSupported,u=C(e._batchTable),c=e._allowPicking,d={url:e._url,requestType:e._requestType,gltf:e._gltf,basePath:e._basePath,shadows:e._shadows,cacheKey:void 0,asynchronous:e._asynchronous,allowPicking:c,incrementallyLoadTextures:e._incrementallyLoadTextures,upAxis:e._upAxis,precreatedAttributes:void 0,vertexShaderLoaded:void 0,fragmentShaderLoaded:void 0,uniformMapLoaded:void 0,pickVertexShaderLoaded:void 0,pickFragmentShaderLoaded:void 0,pickUniformMapLoaded:void 0,ignoreCommands:!0,opaquePass:e._opaquePass};if(c&&!u&&(e._pickIds=function(e,t){for(var r=e._instances,i=r.length,n=new Array(i),o=0;o<i;++o)n[o]=t.createPickId(r[o]);return n}(e,t)),l){!function(e,t){var r,i=e._instances,n=e.length,o=e._dynamic,a=C(e._batchTable),s=e._allowPicking;if(a){var l=new Uint16Array(n);for(r=0;r<n;++r)l[r]=i[r]._instanceId;e._batchIdBuffer=E.createVertexBuffer({context:t,typedArray:l,usage:A.STATIC_DRAW})}if(s&&!a){var u=new Uint8Array(4*n);for(r=0;r<n;++r){var c=e._pickIds[r].color,d=4*r;u[d]=m.floatToByte(c.red),u[d+1]=m.floatToByte(c.green),u[d+2]=m.floatToByte(c.blue),u[d+3]=m.floatToByte(c.alpha)}e._pickIdBuffer=E.createVertexBuffer({context:t,typedArray:u,usage:A.STATIC_DRAW})}var h=G(e);e._vertexBuffer=E.createVertexBuffer({context:t,typedArray:h,usage:o?A.STREAM_DRAW:A.STATIC_DRAW})}(e,t);var h=g.getSizeInBytes(g.FLOAT),p={czm_modelMatrixRow0:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:g.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:12*h,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:g.FLOAT,normalize:!1,offsetInBytes:4*h,strideInBytes:12*h,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:g.FLOAT,normalize:!1,offsetInBytes:8*h,strideInBytes:12*h,instanceDivisor:1}};u&&(p.a_batchId={index:0,vertexBuffer:e._batchIdBuffer,componentsPerAttribute:1,componentDatatype:g.UNSIGNED_SHORT,normalize:!1,offsetInBytes:0,strideInBytes:0,instanceDivisor:1}),c&&!u&&(p.pickColor={index:0,vertexBuffer:e._pickIdBuffer,componentsPerAttribute:4,componentDatatype:g.UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0,instanceDivisor:1}),d.precreatedAttributes=p,d.vertexShaderLoaded=(f=e,function(e,t){var r=U(f,t),i=C(f._batchTable),n=P.replaceMain(e,"czm_instancing_main"),o="",a="";for(var s in r)if(r.hasOwnProperty(s)){var l,u=r[s];"MODELVIEW"===u||"CESIUM_RTC_MODELVIEW"===u?l="czm_instanced_modelView":"MODELVIEWPROJECTION"===u?(l="czm_instanced_modelViewProjection",o+="mat4 czm_instanced_modelViewProjection;\n",a+="czm_instanced_modelViewProjection = czm_projection * czm_instanced_modelView;\n"):"MODELVIEWINVERSETRANSPOSE"===u&&(l="czm_instanced_modelViewInverseTranspose",o+="mat3 czm_instanced_modelViewInverseTranspose;\n",a+="czm_instanced_modelViewInverseTranspose = mat3(czm_instanced_modelView);\n");var c=new RegExp("uniform.*"+s+".*");n=n.replace(c,""),c=new RegExp(s+"\\b","g"),n=n.replace(c,l)}var d="uniform mat4 czm_instanced_modifiedModelView;\nuniform mat4 czm_instanced_nodeTransform;\n"+o+"mat4 czm_instanced_modelView;\nattribute vec4 czm_modelMatrixRow0;\nattribute vec4 czm_modelMatrixRow1;\nattribute vec4 czm_modelMatrixRow2;\n"+(i?"attribute float a_batchId;\n":"")+n+"void main()\n{\n    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0, czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0);\n    czm_instanced_modelView = czm_instanced_modifiedModelView * czm_instanced_model * czm_instanced_nodeTransform;\n"+a+"    czm_instancing_main();\n}";if(F=d,i){var h=f._model.gltf,p=O.getDiffuseAttributeOrUniform(h,t);d=f._batchTable.getVertexShaderCallback(!0,"a_batchId",p)(d)}return d}),d.fragmentShaderLoaded=V(e),d.uniformMapLoaded=z(e,t),d.pickVertexShaderLoaded=(s=e,function(e){e=F;var t=C(s._batchTable),r=s._allowPicking;return t?e=s._batchTable.getPickVertexShaderCallback("a_batchId")(e):r&&(e=P.createPickVertexShaderSource(e)),e}),d.pickFragmentShaderLoaded=(a=e,function(e){var t=C(a._batchTable),r=a._allowPicking;return t?e=a._batchTable.getPickFragmentShaderCallback()(e):r&&(e=P.createPickFragmentShaderSource(e,"varying")),e}),d.pickUniformMapLoaded=q(e),C(e._url)&&(d.cacheKey=e._url.getUrlComponent()+"#instanced")}else d.vertexShaderLoaded=(o=e,function(e,t){if(C(o._batchTable)){var r=o._model.gltf,i=O.getDiffuseAttributeOrUniform(r,t);e="uniform float a_batchId\n;"+(e=o._batchTable.getVertexShaderCallback(!0,"a_batchId",i)(e))}return e}),d.fragmentShaderLoaded=V(e),d.uniformMapLoaded=(n=e,function(e){return C(n._batchTable)&&(e=n._batchTable.getUniformMapCallback()(e)),e}),d.pickVertexShaderLoaded=(r=e,function(e){return C(r._batchTable)&&(e="uniform float a_batchId\n;"+(e=r._batchTable.getPickVertexShaderCallback("a_batchId")(e))),e}),d.pickFragmentShaderLoaded=(i=e,function(e){var t=C(i._batchTable),r=i._allowPicking;return t?e=i._batchTable.getPickFragmentShaderCallback()(e):r&&(e=P.createPickFragmentShaderSource(e,"uniform")),e}),d.pickUniformMapLoaded=q(e);C(e._url)?e._model=D.fromGltf(d):e._model=new D(d)}function H(e){return function(){return e}}function j(e){return function(){return e}}function Y(e){for(var t=e._modelCommands,r=t.length,i=e.length,n=e.allowPicking,o=e._rtcTransform,a=e._center,s=0;s<r;++s)for(var l=t[s],u=0;u<i;++u){var c=s*i+u,d=e._drawCommands[c],h=w.clone(e._instances[u]._modelMatrix,B);h[12]-=a.x,h[13]-=a.y,h[14]-=a.z,h=w.multiply(o,h,B);var p=l.modelMatrix,f=d.modelMatrix;w.multiply(h,p,f);var m=l.boundingVolume,g=d.boundingVolume;if(v.transform(m,h,g),n){var _=e._pickCommands[c];w.clone(f,_.modelMatrix),v.clone(g,_.boundingVolume)}}}return s.prototype.expandBoundingSphere=function(e){var t=w.getTranslation(e,c);v.expand(this._boundingSphere,t,this._boundingSphere)},s.prototype.update=function(e){if(e.mode!==I.MORPHING&&this.show&&0!==this.length){var t=e.context;if(this._state===R){this._state=L,this._instancingSupported=t.instancedArrays,W(this,t);var r=this;this._model.readyPromise.otherwise(function(e){r._state=k,r._readyPromise.reject(e)})}var i=this._instancingSupported,n=this._model;if(n.update(e),n.ready&&this._state===L){this._state=N,this._ready=!0;var o=n.boundingSphere.radius+y.magnitude(n.boundingSphere.center);this._boundingSphere.radius+=o;var a=function(e){for(var t=e._nodeCommands,r=t.length,i=[],n=[],o=0;o<r;++o){var a=t[o];a.show&&(i.push(a.command),n.push(a.pickCommand))}return{draw:i,pick:n}}(n);return this._modelCommands=a.draw,i?function(e,t,r){for(var i=t.length,n=e.length,o=e.allowPicking,a=e._boundingSphere,s=e._cull,l=0;l<i;++l){var u=x.shallowClone(t[l]);if(u.instanceCount=n,u.boundingVolume=a,u.cull=s,e._drawCommands.push(u),o){var c=x.shallowClone(r[l]);c.instanceCount=n,c.boundingVolume=a,c.cull=s,e._pickCommands.push(c)}}}(this,a.draw,a.pick):(!function(e,t,r){for(var i=e._instances,n=t.length,o=e.length,a=e.allowPicking,s=C(e._batchTable),l=e._cull,u=0;u<n;++u)for(var c=0;c<o;++c){var d=x.shallowClone(t[u]);if(d.modelMatrix=new w,d.boundingVolume=new v,d.cull=l,d.uniformMap=b(d.uniformMap),s&&(d.uniformMap.a_batchId=H(i[c]._instanceId)),e._drawCommands.push(d),a){var h=x.shallowClone(r[u]);if(h.modelMatrix=new w,h.boundingVolume=new v,h.cull=l,h.uniformMap=b(h.uniformMap),s)h.uniformMap.a_batchId=H(i[c]._instanceId);else if(a){var p=e._pickIds[c];h.uniformMap.czm_pickColor=j(p.color)}e._pickCommands.push(h)}}}(this,a.draw,a.pick),Y(this)),void this._readyPromise.resolve(this)}if(this._state===N){var s,l,u=e.mode!==this._mode,c=this.modelMatrix,d=!w.equals(this._modelMatrix,c);if(u||d){this._mode=e.mode,w.clone(c,this._modelMatrix);var h=w.multiplyByTranslation(this._modelMatrix,this._center,this._rtcTransform);this._mode!==I.SCENE3D&&(h=T.basisTo2D(e.mapProjection,h,h)),w.getTranslation(h,this._boundingSphere.center)}i&&this._dirty&&(this._dynamic=!0,this._dirty=!1,l=G(s=this),s._vertexBuffer.copyFromArrayView(l)),!i&&(n.dirty||this._dirty||u||d)&&Y(this),function(e){if(e.shadows!==e._shadows){e._shadows=e.shadows;for(var t=M.castShadows(e.shadows),r=M.receiveShadows(e.shadows),i=e._drawCommands,n=i.length,o=0;o<n;++o){var a=i[o];a.castShadows=t,a.receiveShadows=r}}}(this),function(e){if(e._debugWireframe!==e.debugWireframe){e._debugWireframe=e.debugWireframe;for(var t=e.debugWireframe?S.LINES:S.TRIANGLES,r=e._drawCommands,i=r.length,n=0;n<i;++n)r[n].primitiveType=t}}(this),function(e){if(e.debugShowBoundingVolume!==e._debugShowBoundingVolume){e._debugShowBoundingVolume=e.debugShowBoundingVolume;for(var t=e._drawCommands,r=t.length,i=0;i<r;++i)t[i].debugShowBoundingVolume=e.debugShowBoundingVolume}}(this);for(var p=e.passes,f=e.commandList,m=p.render?this._drawCommands:this._pickCommands,g=m.length,_=0;_<g;++_)f.push(m[_])}}},s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){this._model=this._model&&this._model.destroy();var e=this._pickIds;if(C(e))for(var t=e.length,r=0;r<t;++r)e[r].destroy();return i(this)},s}),define("Scene/Instanced3DModel3DTileContent",["../Core/AttributeCompression","../Core/Cartesian3","../Core/ClippingPlaneCollection","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/destroyObject","../Core/DeveloperError","../Core/Ellipsoid","../Core/FeatureDetection","../Core/getBaseUri","../Core/getStringFromTypedArray","../Core/Matrix3","../Core/Matrix4","../Core/Quaternion","../Core/RequestType","../Core/RuntimeError","../Core/Transforms","../Core/TranslationRotationScale","../Renderer/Pass","./Cesium3DTileBatchTable","./Cesium3DTileFeature","./Cesium3DTileFeatureTable","./ModelInstanceCollection"],function(ee,te,a,r,re,ie,ne,e,t,i,n,oe,o,s,ae,se,le,ue,ce,de,he,pe,fe,me,l,ge,_e){"use strict";if(!o.supportsTypedArrays())return{};function ve(e,t,r,i,n){this._tileset=e,this._tile=t,this._resource=r,this._modelInstanceCollection=void 0,this._batchTable=void 0,this._features=void 0,this.featurePropertiesDirty=!1,function(e,t,r){var i=ie(r,0);r=i;var n=new Uint8Array(t),o=new DataView(t);r+=ye;var a=o.getUint32(r,!0);if(1!==a)throw new de("Only Instanced 3D Model version 1 is supported. Version "+a+" is not.");r+=ye;var s=o.getUint32(r,!0);r+=ye;var l=o.getUint32(r,!0);if(0===l)throw new de("featureTableJsonByteLength is zero, the feature table must be defined.");r+=ye;var u=o.getUint32(r,!0);r+=ye;var c=o.getUint32(r,!0);r+=ye;var d=o.getUint32(r,!0);r+=ye;var h=o.getUint32(r,!0);if(1!==h&&0!==h)throw new de("Only glTF format 0 (uri) or 1 (embedded) are supported. Format "+h+" is not.");var p=ae(n,r+=ye,l),f=JSON.parse(p);r+=l;var m=new Uint8Array(t,r,u);r+=u;var g,_,v=new ge(f,m),y=v.getGlobalProperty("INSTANCES_LENGTH");if(v.featuresLength=y,!ne(y))throw new de("Feature table global property: INSTANCES_LENGTH must be defined");if(0<c){var b=ae(n,r,c);g=JSON.parse(b),r+=c,0<d&&(_=new Uint8Array(t,r,d),_=new Uint8Array(_),r+=d)}e._batchTable=new me(e,y,g,_);var C,w=i+s-r;if(0===w)throw new de("glTF byte length is zero, i3dm must have a glTF to instance.");C=r%4==0?new Uint8Array(t,r,w):(ve._deprecationWarning("i3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary."),new Uint8Array(n.subarray(r,r+w)));var S={instances:new Array(y),batchTable:e._batchTable,cull:!1,url:void 0,requestType:ce.TILES3D,gltf:void 0,basePath:void 0,incrementallyLoadTextures:!1,upAxis:e._tileset._gltfUpAxis,opaquePass:fe.CESIUM_3D_TILE};if(0===h){var T=ae(C);T=T.replace(/[\s\0]+$/,""),S.url=e._resource.getDerivedResource({url:T})}else S.gltf=C,S.basePath=e._resource.clone();var E,A=v.getGlobalProperty("EAST_NORTH_UP"),x=v.getGlobalProperty("RTC_CENTER",re.FLOAT,3);ne(x)&&(E=te.unpack(x));for(var P=S.instances,D=new te,O=new Array(3),I=new te,M=new te,R=new te,L=new se,N=new ue,k=new te,F=new pe,B=new le,U=0;U<y;U++){var V=v.getProperty("POSITION",re.FLOAT,3,U,be);if(!ne(V)){V=O;var z=v.getProperty("POSITION_QUANTIZED",re.UNSIGNED_SHORT,3,U,be);if(!ne(z))throw new de("Either POSITION or POSITION_QUANTIZED must be defined for each instance.");var q=v.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",re.FLOAT,3);if(!ne(q))throw new de("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");var G=v.getGlobalProperty("QUANTIZED_VOLUME_SCALE",re.FLOAT,3);if(!ne(G))throw new de("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");for(var W=0;W<3;W++)V[W]=z[W]/65535*G[W]+q[W]}te.unpack(V,0,D),ne(E)&&te.add(D,E,D),F.translation=D;var H=v.getProperty("NORMAL_UP",re.FLOAT,3,U,be),j=v.getProperty("NORMAL_RIGHT",re.FLOAT,3,U,Ce),Y=!1;if(ne(H)){if(!ne(j))throw new de("To define a custom orientation, both NORMAL_UP and NORMAL_RIGHT must be defined.");te.unpack(H,0,M),te.unpack(j,0,I),Y=!0}else{var X=v.getProperty("NORMAL_UP_OCT32P",re.UNSIGNED_SHORT,2,U,be),Q=v.getProperty("NORMAL_RIGHT_OCT32P",re.UNSIGNED_SHORT,2,U,Ce);if(ne(X)){if(!ne(Q))throw new de("To define a custom orientation with oct-encoded vectors, both NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P must be defined.");ee.octDecodeInRange(X[0],X[1],65535,M),ee.octDecodeInRange(Q[0],Q[1],65535,I),Y=!0}else A?(he.eastNorthUpToFixedFrame(D,oe.WGS84,B),le.getRotation(B,L)):se.clone(se.IDENTITY,L)}Y&&(te.cross(I,M,R),te.normalize(R,R),se.setColumn(L,0,I,L),se.setColumn(L,1,M,L),se.setColumn(L,2,R,L)),ue.fromRotationMatrix(L,N),F.rotation=N,k=te.fromElements(1,1,1,k);var Z=v.getProperty("SCALE",re.FLOAT,1,U);ne(Z)&&te.multiplyByScalar(k,Z,k);var K=v.getProperty("SCALE_NON_UNIFORM",re.FLOAT,3,U,be);ne(K)&&(k.x*=K[0],k.y*=K[1],k.z*=K[2]),F.scale=k;var J=v.getProperty("BATCH_ID",re.UNSIGNED_SHORT,1,U);ne(J)||(J=U),le.fromTranslationRotationScale(F,B);var $=B.clone();P[U]={modelMatrix:$,batchId:J}}e._modelInstanceCollection=new _e(S)}(this,i,n)}ve._deprecationWarning=t,e(ve.prototype,{featuresLength:{get:function(){return this._batchTable.featuresLength}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){var e=this._modelInstanceCollection._model;return ne(e)?e.trianglesLength:0}},geometryByteLength:{get:function(){var e=this._modelInstanceCollection._model;return ne(e)?e.geometryByteLength:0}},texturesByteLength:{get:function(){var e=this._modelInstanceCollection._model;return ne(e)?e.texturesByteLength:0}},batchTableByteLength:{get:function(){return this._batchTable.memorySizeInBytes}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._modelInstanceCollection.readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){return this._batchTable}}});var ye=Uint32Array.BYTES_PER_ELEMENT,be=new Array(4),Ce=new Array(4);return ve.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},ve.prototype.getFeature=function(e){var t=this.featuresLength;if(!ne(e)||e<0||t<=e)throw new n("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").");return function(e){var t=e.featuresLength;if(!ne(e._features)&&0<t){for(var r=new Array(t),i=0;i<t;++i)r[i]=new l(e,i);e._features=r}}(this),this._features[e]},ve.prototype.applyDebugSettings=function(e,t){t=e?t:r.WHITE,this._batchTable.setAllColor(t)},ve.prototype.applyStyle=function(e,t){this._batchTable.applyStyle(e,t)},ve.prototype.update=function(e,t){var r=t.commandList.length;this._batchTable.update(e,t),this._modelInstanceCollection.modelMatrix=this._tile.computedTransform,this._modelInstanceCollection.shadows=this._tileset.shadows,this._modelInstanceCollection.debugWireframe=this._tileset.debugWireframe,this._modelInstanceCollection.update(t);var i=this._tileset.clippingPlanes,n=this._modelInstanceCollection._model,o=n.clippingPlanes;ne(i)?(ne(o)||(n.clippingPlanes=new a,o=n.clippingPlanes),i.clone(o),o.enabled=i.enabled&&this._tile._isClipped):ne(o)&&o.enabled&&(o.enabled=!1),r<t.commandList.length&&t.passes.render&&this._batchTable.addDerivedCommands(t,r,!1)},ve.prototype.isDestroyed=function(){return!1},ve.prototype.destroy=function(){return this._modelInstanceCollection=this._modelInstanceCollection&&this._modelInstanceCollection.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),i(this)},ve}),define("Scene/PointCloud3DTileContent",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/ClippingPlaneCollection","../Core/Color","../Core/combine","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/FeatureDetection","../Core/getStringFromTypedArray","../Core/Matrix3","../Core/Matrix4","../Core/oneTimeWarning","../Core/OrthographicFrustum","../Core/Plane","../Core/PrimitiveType","../Core/RuntimeError","../Core/Transforms","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../ThirdParty/when","./BlendingState","./Cesium3DTileBatchTable","./Cesium3DTileFeature","./Cesium3DTileFeatureTable","./SceneMode","./ShadowMode"],function(e,F,C,Z,V,z,q,B,K,t,r,i,n,U,o,G,W,H,a,j,J,w,Y,X,Q,$,ee,te,re,ie,s,ne,oe,l,ae,se,S){"use strict";if(!n.supportsTypedArrays())return{};function u(e,t,r,i,n){this._tileset=e,this._tile=t,this._resource=r,this._parsedContent=void 0,this._drawCommand=void 0,this._pickCommand=void 0,this._pickId=void 0,this._isTranslucent=!1,this._styleTranslucent=!1,this._constantColor=V.clone(V.WHITE),this._rtcCenter=void 0,this._batchTable=void 0,this._styleableShaderAttributes=void 0,this._isQuantized=!1,this._isOctEncoded16P=!1,this._isRGB565=!1,this._hasColors=!1,this._hasNormals=!1,this._hasBatchIds=!1,this._isClipped=!1,this._unionClippingRegions=!1,this.backFaceCulling=!1,this._backFaceCulling=!1,this._opaqueRenderState=void 0,this._translucentRenderState=void 0,this._highlightColor=V.clone(V.WHITE),this._pointSize=1,this._quantizedVolumeScale=void 0,this._quantizedVolumeOffset=void 0,this._modelMatrix=G.clone(G.IDENTITY),this._mode=void 0,this._readyPromise=s.defer(),this._pointsLength=0,this._geometryByteLength=0,this._features=void 0,this._packedClippingPlanes=[],this._modelViewMatrix=G.clone(G.IDENTITY),this.featurePropertiesDirty=!1,this._attenuation=!1,this._geometricErrorScale=void 0,this._maximumAttenuation=void 0,this._baseResolution=void 0,this._baseResolutionApproximation=void 0,function(e,t,r){r=B(r,0);var i=new Uint8Array(t),n=new DataView(t);r+=le;var o=n.getUint32(r,!0);if(1!==o)throw new J("Only Point Cloud tile version 1 is supported.  Version "+o+" is not.");r+=le,r+=le;var a=n.getUint32(r,!0);if(0===a)throw new J("Feature table must have a byte length greater than zero");r+=le;var s=n.getUint32(r,!0);r+=le;var l=n.getUint32(r,!0);r+=le;var u=n.getUint32(r,!0),c=U(i,r+=le,a),d=JSON.parse(c);r+=a;var h,p,f=new Uint8Array(t,r,s);if(r+=s,0<l){var m=U(i,r,l);h=JSON.parse(m),r+=l,0<u&&(p=new Uint8Array(t,r,u),r+=u)}var g,_=new ae(d,f),v=_.getGlobalProperty("POINTS_LENGTH");if(_.featuresLength=v,!K(v))throw new J("Feature table global property: POINTS_LENGTH must be defined");var y,b=!1;if(K(d.POSITION)){g=_.getPropertyArray("POSITION",q.FLOAT,3);var C=_.getGlobalProperty("RTC_CENTER",q.FLOAT,3);K(C)&&(e._rtcCenter=F.unpack(C))}else if(K(d.POSITION_QUANTIZED)){g=_.getPropertyArray("POSITION_QUANTIZED",q.UNSIGNED_SHORT,3),b=!0;var w=_.getGlobalProperty("QUANTIZED_VOLUME_SCALE",q.FLOAT,3);if(!K(w))throw new J("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");e._quantizedVolumeScale=F.unpack(w);var S=_.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",q.FLOAT,3);if(!K(S))throw new J("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");e._quantizedVolumeOffset=F.unpack(S)}if(!K(g))throw new J("Either POSITION or POSITION_QUANTIZED must be defined.");var T,E=!1,A=!1;if(K(d.RGBA))y=_.getPropertyArray("RGBA",q.UNSIGNED_BYTE,4),E=!0;else if(K(d.RGB))y=_.getPropertyArray("RGB",q.UNSIGNED_BYTE,3);else if(K(d.RGB565))y=_.getPropertyArray("RGB565",q.UNSIGNED_SHORT,1),A=!0;else if(K(d.CONSTANT_RGBA)){var x=_.getGlobalProperty("CONSTANT_RGBA",q.UNSIGNED_BYTE,4);e._constantColor=V.fromBytes(x[0],x[1],x[2],x[3],e._constantColor)}else e._constantColor=V.clone(V.DARKGRAY,e._constantColor);e._isTranslucent=E;var P,D,O=!1;K(d.NORMAL)?T=_.getPropertyArray("NORMAL",q.FLOAT,3):K(d.NORMAL_OCT16P)&&(T=_.getPropertyArray("NORMAL_OCT16P",q.UNSIGNED_BYTE,2),O=!0);if(K(d.BATCH_ID)){P=_.getPropertyArray("BATCH_ID",q.UNSIGNED_SHORT,1);var I=_.getGlobalProperty("BATCH_LENGTH");if(!K(I))throw new J("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");K(p)&&(p=new Uint8Array(p)),e._batchTable=new oe(e,I,h,p)}if(!K(P)&&K(p))for(var M in D=oe.getBinaryProperties(v,h,p))if(D.hasOwnProperty(M)){var R=D[M],L=R.typedArray,N=q.fromTypedArray(L);N!==q.INT&&N!==q.UNSIGNED_INT&&N!==q.DOUBLE||(W("Cast pnts property to floats",'Point cloud property "'+M+'" will be casted to a float array because INT, UNSIGNED_INT, and DOUBLE are not valid WebGL vertex attribute types. Some precision may be lost.'),R.typedArray=new Float32Array(L))}e._parsedContent={positions:g,colors:y,normals:T,batchIds:P,styleableProperties:D},e._pointsLength=v,e._isQuantized=b,e._isOctEncoded16P=O,e._isRGB565=A,e._hasColors=K(y),e._hasNormals=K(T),e._hasBatchIds=K(P);var k=e._tile.contentBoundingVolume.boundingSphere.volume();e._baseResolutionApproximation=Math.cbrt(k/v)}(this,i,n)}t(u.prototype,{featuresLength:{get:function(){return K(this._batchTable)?this._batchTable.featuresLength:0}},pointsLength:{get:function(){return this._pointsLength}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return this._geometryByteLength}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return K(this._batchTable)?this._batchTable.memorySizeInBytes:0}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._readyPromise.promise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){return this._batchTable}}});var le=Uint32Array.BYTES_PER_ELEMENT;var ue=new C;var ce=["POSITION","COLOR","NORMAL","POSITION_ABSOLUTE"];function de(e,t){for(var r=/czm_tiles3d_style_(\w+)/g,i=r.exec(e);null!==i;){var n=i[1];-1===t.indexOf(n)&&t.push(n),i=r.exec(e)}}function he(e,t){for(var r=e.numberOfAttributes,i=0;i<r;++i){var n=e.getAttribute(i);if(n.index===t)return n}}function pe(e){for(var t=ce.length,r=0;r<t;++r){var i=ce[r],n="czm_tiles3d_style_"+i,o=i.toLowerCase();e=e.replace(new RegExp(n+"(\\W)","g"),o+"$1")}return e.replace("()","(vec3 position, vec3 position_absolute, vec4 color, vec3 normal)")}function T(e,t,r){var i,n,o,a,s,l,u=t.context,c=e._batchTable,d=K(c),h=K(r),p=e._isQuantized,f=e._isOctEncoded16P,m=e._isRGB565,g=e._isTranslucent,_=e._hasColors,v=e._hasNormals,y=e._hasBatchIds,b=e._backFaceCulling,C=e._drawCommand.vertexArray,w=e._tileset.clippingPlanes,S=e._attenuation,T=g;if(d&&(h=!1),h){var E={translucent:!1};a=r.getColorShaderFunction("getColorFromStyle","czm_tiles3d_style_",E),s=r.getShowShaderFunction("getShowFromStyle","czm_tiles3d_style_",E),l=r.getPointSizeShaderFunction("getPointSizeFromStyle","czm_tiles3d_style_",E),K(a)&&E.translucent&&(T=!0)}e._styleTranslucent=T;var A=K(a),x=K(s),P=K(l),D=K(w)&&w.enabled&&e._tile._isClipped&&Z.isSupported(),O=[];A&&(de(a,O),a=pe(a)),x&&(de(s,O),s=pe(s)),P&&(de(l,O),l=pe(l));var I=0<=O.indexOf("COLOR"),M=0<=O.indexOf("NORMAL"),R=O.filter(function(e){return-1===ce.indexOf(e)});if(M&&!v)throw new J("Style references the NORMAL semantic but the point cloud does not have normals");var L=e._styleableShaderAttributes;for(n in L)if(L.hasOwnProperty(n)){o=L[n];var N=0<=R.indexOf(n);he(C,o.location).enabled=N}var k=_&&(!A||I);_&&(he(C,1).enabled=k);var F={a_position:0};k&&(F.a_color=1),v&&(F.a_normal=2),y&&(F.a_batchId=3);var B="",U=R.length;for(i=0;i<U;++i){if(o=L[n=R[i]],!K(o))throw new J('Style references a property "'+n+'" that does not exist or is not styleable.');var V=o.componentCount,z="czm_tiles3d_style_"+n;B+="attribute "+(1===V?"float":"vec"+V)+" "+z+"; \n",F[z]=o.location}var q="attribute vec3 a_position; \nvarying vec4 v_color; \nuniform vec4 u_pointSizeAndTilesetTimeAndGeometricErrorAndDepthMultiplier; \nuniform vec4 u_constantColor; \nuniform vec4 u_highlightColor; \n";q+="float u_pointSize; \nfloat u_tilesetTime; \n",S&&(q+="float u_geometricError; \nfloat u_depthMultiplier; \n"),q+=B,k&&(q+=g?"attribute vec4 a_color; \n":m?"attribute float a_color; \nconst float SHIFT_RIGHT_11 = 1.0 / 2048.0; \nconst float SHIFT_RIGHT_5 = 1.0 / 32.0; \nconst float SHIFT_LEFT_11 = 2048.0; \nconst float SHIFT_LEFT_5 = 32.0; \nconst float NORMALIZE_6 = 1.0 / 64.0; \nconst float NORMALIZE_5 = 1.0 / 32.0; \n":"attribute vec3 a_color; \n"),v&&(q+=f?"attribute vec2 a_normal; \n":"attribute vec3 a_normal; \n"),y&&(q+="attribute float a_batchId; \n"),p&&(q+="uniform vec3 u_quantizedVolumeScale; \n"),A&&(q+=a),x&&(q+=s),P&&(q+=l),q+="void main() \n{ \n    u_pointSize = u_pointSizeAndTilesetTimeAndGeometricErrorAndDepthMultiplier.x; \n    u_tilesetTime = u_pointSizeAndTilesetTimeAndGeometricErrorAndDepthMultiplier.y; \n",S&&(q+="    u_geometricError = u_pointSizeAndTilesetTimeAndGeometricErrorAndDepthMultiplier.z; \n    u_depthMultiplier = u_pointSizeAndTilesetTimeAndGeometricErrorAndDepthMultiplier.w; \n"),q+=k?g?"    vec4 color = a_color; \n":m?"    float compressed = a_color; \n    float r = floor(compressed * SHIFT_RIGHT_11); \n    compressed -= r * SHIFT_LEFT_11; \n    float g = floor(compressed * SHIFT_RIGHT_5); \n    compressed -= g * SHIFT_LEFT_5; \n    float b = compressed; \n    vec3 rgb = vec3(r * NORMALIZE_5, g * NORMALIZE_6, b * NORMALIZE_5); \n    vec4 color = vec4(rgb, 1.0); \n":"    vec4 color = vec4(a_color, 1.0); \n":"    vec4 color = u_constantColor; \n",q+=p?"    vec3 position = a_position * u_quantizedVolumeScale; \n":"    vec3 position = a_position; \n",q+="    vec3 position_absolute = vec3(czm_model * vec4(position, 1.0)); \n",q+=v?f?"    vec3 normal = czm_octDecode(a_normal); \n":"    vec3 normal = a_normal; \n":"    vec3 normal = vec3(1.0); \n",A&&(q+="    color = getColorFromStyle(position, position_absolute, color, normal); \n"),x&&(q+="    float show = float(getShowFromStyle(position, position_absolute, color, normal)); \n"),q+=P?"    gl_PointSize = getPointSizeFromStyle(position, position_absolute, color, normal); \n":S?"    vec4 positionEC = czm_modelView * vec4(position, 1.0); \n    float depth = -positionEC.z; \n    gl_PointSize = min((u_geometricError / depth) * u_depthMultiplier, u_pointSize); \n":"    gl_PointSize = u_pointSize; \n",q+="    color = color * u_highlightColor; \n",v&&(q+="    normal = czm_normal * normal; \n    float diffuseStrength = czm_getLambertDiffuse(czm_sunDirectionEC, normal); \n    diffuseStrength = max(diffuseStrength, 0.4); \n    color.xyz *= diffuseStrength; \n"),q+="    v_color = color; \n    gl_Position = czm_modelViewProjection * vec4(position, 1.0); \n",v&&b&&(q+="    float visible = step(-normal.z, 0.0); \n    gl_Position *= visible; \n    gl_PointSize *= visible; \n"),x&&(q+="    gl_Position *= show; \n    gl_PointSize *= show; \n"),q+="} \n";var G="varying vec4 v_color; \n";(D&&(G+="uniform int u_clippingPlanesLength;uniform vec4 u_clippingPlanes[czm_maxClippingPlanes]; \nuniform vec4 u_clippingPlanesEdgeStyle; \n"),G+="void main() \n{ \n    gl_FragColor = v_color; \n",D)&&(G+="    float clipDistance = "+(w.unionClippingRegions?"czm_discardIfClippedWithUnion":"czm_discardIfClippedWithIntersect")+"(u_clippingPlanes, u_clippingPlanesLength); \n    vec4 clippingPlanesEdgeColor = vec4(1.0); \n    clippingPlanesEdgeColor.rgb = u_clippingPlanesEdgeStyle.rgb; \n    float clippingPlanesEdgeWidth = u_clippingPlanesEdgeStyle.a; \n    if (clipDistance > 0.0 && clipDistance < clippingPlanesEdgeWidth) \n    { \n        gl_FragColor = clippingPlanesEdgeColor; \n    } \n");var W=q,H=G+="} \n";d&&(W=c.getVertexShaderCallback(!1,"a_batchId",void 0)(W),H=c.getFragmentShaderCallback(!1,void 0)(H));var j=q,Y=G;Y=d?(j=c.getPickVertexShaderCallback("a_batchId")(j),c.getPickFragmentShaderCallback()(Y)):re.createPickFragmentShaderSource(Y,"uniform");var X=e._drawCommand;K(X.shaderProgram)&&X.shaderProgram.destroy(),X.shaderProgram=te.fromCache({context:u,vertexShaderSource:W,fragmentShaderSource:H,attributeLocations:F});var Q=e._pickCommand;K(Q.shaderProgram)&&Q.shaderProgram.destroy(),Q.shaderProgram=te.fromCache({context:u,vertexShaderSource:j,fragmentShaderSource:Y,attributeLocations:F});try{X.shaderProgram._bind()}catch(e){throw new J("Error generating style shader: this may be caused by a type mismatch, index out-of-bounds, or other syntax error.")}}u.prototype.hasProperty=function(e,t){return!!K(this._batchTable)&&this._batchTable.hasProperty(e,t)},u.prototype.getFeature=function(e){if(K(this._batchTable)){var t=this.featuresLength;if(!K(e)||e<0||t<=e)throw new i("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").");return function(e){var t=e.featuresLength;if(!K(e._features)&&0<t){for(var r=new Array(t),i=0;i<t;++i)r[i]=new l(e,i);e._features=r}}(this),this._features[e]}},u.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:V.WHITE},u.prototype.applyStyle=function(e,t){K(this._batchTable)?this._batchTable.applyStyle(e,t):T(this,e,t)};var E=new C,A=new G;return u.prototype.update=function(e,t){var r=this._tile.computedTransform,i=!G.equals(this._modelMatrix,r)||this._mode!==t.mode;this._mode=t.mode;var n=t.context,o=this._tileset.clippingPlanes,a=K(o)&&o.enabled&&this._tile._isClipped,s=!1,l=0;a&&(s=o.unionClippingRegions,l=o.length);var u=this._packedClippingPlanes;if(u.length!==l){u.length=l;for(var c=0;c<l;++c)u[c]=new C}K(this._drawCommand)||(!function(n,o){var a=o.context,e=n._parsedContent,t=n._pointsLength,r=e.positions,i=e.colors,s=e.normals,l=e.batchIds,u=e.styleableProperties,c=K(u),d=n._isQuantized,h=n._isOctEncoded16P,p=n._isRGB565,f=n._isTranslucent,m=n._hasColors,g=n._hasNormals,_=n._hasBatchIds,v=n._batchTable,y=K(v),b=[],C={};if(n._styleableShaderAttributes=C,c){var w=4;for(var S in u)if(u.hasOwnProperty(S)){var T=u[S],E=T.typedArray,A=T.componentCount,x=q.fromTypedArray(E),P=Y.createVertexBuffer({context:a,typedArray:T.typedArray,usage:X.STATIC_DRAW});n._geometryByteLength+=P.sizeInBytes;var D={index:w,vertexBuffer:P,componentsPerAttribute:A,componentDatatype:x,normalize:!1,offsetInBytes:0,strideInBytes:0};b.push(D),C[S]={location:w,componentCount:A},++w}}var O={u_pointSizeAndTilesetTimeAndGeometricErrorAndDepthMultiplier:function(){var e=ue;if(e.x=n._attenuation?n._maximumAttenuation:n._pointSize,e.y=n._tileset.timeSinceLoad,n._attenuation){var t=n.tile.geometricError;0===t&&(t=K(n._baseResolution)?n._baseResolution:n._baseResolutionApproximation);var r,i=o.camera.frustum;r=o.mode===se.SCENE2D||i instanceof H?Number.POSITIVE_INFINITY:a.drawingBufferHeight/o.camera.frustum.sseDenominator,e.z=t*n._geometricErrorScale,e.w=r}return e},u_highlightColor:function(){return n._highlightColor},u_constantColor:function(){return n._constantColor},u_clippingPlanesLength:function(){return n._packedClippingPlanes.length},u_clippingPlanes:function(){return n._packedClippingPlanes},u_clippingPlanesEdgeStyle:function(){var e=n._tileset.clippingPlanes;if(!K(e))return V.WHITE.withAlpha(0);var t=V.clone(e.edgeColor);return t.alpha=e.edgeWidth,t}};d&&(O=z(O,{u_quantizedVolumeScale:function(){return n._quantizedVolumeScale}}));var I,M,R,L=Y.createVertexBuffer({context:a,typedArray:r,usage:X.STATIC_DRAW});n._geometryByteLength+=L.sizeInBytes,m&&(I=Y.createVertexBuffer({context:a,typedArray:i,usage:X.STATIC_DRAW}),n._geometryByteLength+=I.sizeInBytes),g&&(M=Y.createVertexBuffer({context:a,typedArray:s,usage:X.STATIC_DRAW}),n._geometryByteLength+=M.sizeInBytes),_&&(R=Y.createVertexBuffer({context:a,typedArray:l,usage:X.STATIC_DRAW}),n._geometryByteLength+=R.sizeInBytes);var N=[];if(d?N.push({index:0,vertexBuffer:L,componentsPerAttribute:3,componentDatatype:q.UNSIGNED_SHORT,normalize:!0,offsetInBytes:0,strideInBytes:0}):N.push({index:0,vertexBuffer:L,componentsPerAttribute:3,componentDatatype:q.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:0}),m)if(p)N.push({index:1,vertexBuffer:I,componentsPerAttribute:1,componentDatatype:q.UNSIGNED_SHORT,normalize:!1,offsetInBytes:0,strideInBytes:0});else{var k=f?4:3;N.push({index:1,vertexBuffer:I,componentsPerAttribute:k,componentDatatype:q.UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0})}g&&(h?N.push({index:2,vertexBuffer:M,componentsPerAttribute:2,componentDatatype:q.UNSIGNED_BYTE,normalize:!1,offsetInBytes:0,strideInBytes:0}):N.push({index:2,vertexBuffer:M,componentsPerAttribute:3,componentDatatype:q.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:0})),_&&N.push({index:3,vertexBuffer:R,componentsPerAttribute:1,componentDatatype:q.fromTypedArray(l),normalize:!1,offsetInBytes:0,strideInBytes:0}),c&&(N=N.concat(b));var F,B=new ie({context:a,attributes:N}),U=O;y&&(U=v.getUniformMapCallback()(O)),F=y?v.getPickUniformMapCallback()(O):(n._pickId=a.createPickId({primitive:n._tileset,content:n}),z(O,{czm_pickColor:function(){return n._pickId.color}})),n._opaqueRenderState=ee.fromCache({depthTest:{enabled:!0}}),n._translucentRenderState=ee.fromCache({depthTest:{enabled:!0},depthMask:!1,blending:ne.ALPHA_BLEND}),n._drawCommand=new Q({boundingVolume:void 0,cull:!1,modelMatrix:new G,primitiveType:j.POINTS,vertexArray:B,count:t,shaderProgram:void 0,uniformMap:U,renderState:f?n._translucentRenderState:n._opaqueRenderState,pass:f?$.TRANSLUCENT:$.CESIUM_3D_TILE,owner:n,castShadows:!1,receiveShadows:!1}),n._pickCommand=new Q({boundingVolume:void 0,cull:!1,modelMatrix:new G,primitiveType:j.POINTS,vertexArray:B,count:t,shaderProgram:void 0,uniformMap:F,renderState:f?n._translucentRenderState:n._opaqueRenderState,pass:f?$.TRANSLUCENT:$.CESIUM_3D_TILE,owner:n})}(this,t),T(this,t,e.style),i=!0,this._readyPromise.resolve(this),this._parsedContent=void 0),this._isClipped===a&&this._unionClippingRegions===s||(this._isClipped=a,this._unionClippingRegions=s,T(this,t,e.style));var d=this._tileset.pointCloudShading;if(K(d)){var h=this._attenuation;this._attenuation=d.attenuation,this._geometricErrorScale=d.geometricErrorScale,this._maximumAttenuation=K(d.maximumAttenuation)?d.maximumAttenuation:e.maximumScreenSpaceError,this._baseResolution=d.baseResolution,this._attenuation!==h&&T(this,t,e.style)}if(i){if(G.clone(r,this._modelMatrix),K(this._rtcCenter)?G.multiplyByTranslation(r,this._rtcCenter,this._drawCommand.modelMatrix):K(this._quantizedVolumeOffset)?G.multiplyByTranslation(r,this._quantizedVolumeOffset,this._drawCommand.modelMatrix):G.clone(r,this._drawCommand.modelMatrix),t.mode!==se.SCENE3D){var p=t.mapProjection;r=this._drawCommand.modelMatrix;var f=G.getColumn(r,3,E);if(C.equals(f,C.UNIT_W)){var m=this._tile.boundingSphere.center,g=w.wgs84To2DModelMatrix(p,m,A);G.multiply(g,r,r)}else w.basisTo2D(p,r,r)}var _;G.clone(this._drawCommand.modelMatrix,this._pickCommand.modelMatrix),_=K(this._tile._contentBoundingVolume)?this._mode===se.SCENE3D?this._tile._contentBoundingVolume.boundingSphere:this._tile._contentBoundingVolume2D.boundingSphere:this._mode===se.SCENE3D?this._tile._boundingVolume.boundingSphere:this._tile._boundingVolume2D.boundingSphere,this._drawCommand.boundingVolume=_,this._pickCommand.boundingVolume=_}a&&(G.multiply(n.uniformState.view3D,r,this._modelViewMatrix),o.transformAndPackPlanes(this._modelViewMatrix,u)),this._drawCommand.castShadows=S.castShadows(e.shadows),this._drawCommand.receiveShadows=S.receiveShadows(e.shadows),this.backFaceCulling!==this._backFaceCulling&&(this._backFaceCulling=this.backFaceCulling,T(this,t,e.style));var v=this._highlightColor.alpha<1||this._constantColor.alpha<1||this._styleTranslucent;this._drawCommand.renderState=v?this._translucentRenderState:this._opaqueRenderState,this._drawCommand.pass=v?$.TRANSLUCENT:$.CESIUM_3D_TILE,K(this._batchTable)&&this._batchTable.update(e,t);var y=t.commandList,b=t.passes;b.render&&y.push(this._drawCommand),b.pick&&y.push(this._pickCommand)},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){var e=this._drawCommand,t=this._pickCommand;return K(e)&&(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy()),this._batchTable=this._batchTable&&this._batchTable.destroy(),r(this)},u}),define("Scene/Tileset3DTileContent",["../Core/defaultValue","../Core/defineProperties","../Core/destroyObject","../Core/getStringFromTypedArray","../Core/RuntimeError","../ThirdParty/when"],function(a,e,t,s,l,o){"use strict";function r(e,t,r,i,n){this._tileset=e,this._tile=t,this._resource=r,this._readyPromise=o.defer(),this.featurePropertiesDirty=!1,function(t,e,r){r=a(r,0);var i,n=new Uint8Array(e),o=s(n,r);try{i=JSON.parse(o)}catch(e){return t._readyPromise.reject(new l("Invalid tile content."))}t._tileset.loadTileset(t._resource,i,t._tile),t._readyPromise.resolve(t)}(this,i,n)}return e(r.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._readyPromise.promise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){}}}),r.prototype.hasProperty=function(e,t){return!1},r.prototype.getFeature=function(e){},r.prototype.applyDebugSettings=function(e,t){},r.prototype.applyStyle=function(e,t){},r.prototype.update=function(e,t){},r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return t(this)},r}),define("Scene/Cesium3DTilePointFeature",["../Core/Cartesian3","../Core/Cartographic","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Ellipsoid","./createBillboardPointCallback"],function(e,t,f,m,g,r,i,_){"use strict";function v(e,t,r,i,n){this._content=e,this._billboard=r,this._label=i,this._polyline=n,this._batchId=t,this._billboardImage=void 0,this._billboardColor=void 0,this._billboardOutlineColor=void 0,this._billboardOutlineWidth=void 0,this._billboardSize=void 0,this._pointSize=void 0,this._color=void 0,this._pointSize=void 0,this._pointOutlineColor=void 0,this._pointOutlineWidth=void 0,this._heightOffset=void 0,a(this)}var o=new t;function a(e){var t=e._billboard;if(g(e._billboardImage)&&e._billboardImage!==t.image)t.image=e._billboardImage;else if(!g(e._billboardImage)){var r=m(e._color,v.defaultColor),i=m(e._pointOutlineColor,v.defaultPointOutlineColor),n=m(e._pointOutlineWidth,v.defaultPointOutlineWidth),o=m(e._pointSize,v.defaultPointSize),a=e._billboardColor,s=e._billboardOutlineColor,l=e._billboardOutlineWidth,u=e._billboardSize;if(!f.equals(r,a)||!f.equals(i,s)||n!==l||o!==u){e._billboardColor=f.clone(r,e._billboardColor),e._billboardOutlineColor=f.clone(i,e._billboardOutlineColor),e._billboardOutlineWidth=n,e._billboardSize=o;var c=r.alpha,d=r.toCssColorString(),h=i.toCssColorString(),p=JSON.stringify([d,o,h,n]);t.setImage(p,_(c,d,h,n,o))}}}return r(v.prototype,{show:{get:function(){return this._label.show},set:function(e){this._label.show=e,this._billboard.show=e,this._polyline.show=e}},color:{get:function(){return this._color},set:function(e){this._color=f.clone(e,this._color),a(this)}},pointSize:{get:function(){return this._pointSize},set:function(e){this._pointSize=e,a(this)}},pointOutlineColor:{get:function(){return this._pointOutlineColor},set:function(e){this._pointOutlineColor=f.clone(e,this._pointOutlineColor),a(this)}},pointOutlineWidth:{get:function(){return this._pointOutlineWidth},set:function(e){this._pointOutlineWidth=e,a(this)}},labelColor:{get:function(){return this._label.fillColor},set:function(e){this._label.fillColor=e,this._polyline.show=this._label.show&&0<e.alpha}},labelOutlineColor:{get:function(){return this._label.outlineColor},set:function(e){this._label.outlineColor=e}},labelOutlineWidth:{get:function(){return this._label.outlineWidth},set:function(e){this._label.outlineWidth=e}},font:{get:function(){return this._label.font},set:function(e){this._label.font=e}},labelStyle:{get:function(){return this._label.style},set:function(e){this._label.style=e}},labelText:{get:function(){return this._label.text},set:function(e){g(e)||(e=""),this._label.text=e}},backgroundColor:{get:function(){return this._label.backgroundColor},set:function(e){this._label.backgroundColor=e}},backgroundPadding:{get:function(){return this._label.backgroundPadding},set:function(e){this._label.backgroundPadding=e}},backgroundEnabled:{get:function(){return this._label.showBackground},set:function(e){this._label.showBackground=e}},scaleByDistance:{get:function(){return this._label.scaleByDistance},set:function(e){this._label.scaleByDistance=e,this._billboard.scaleByDistance=e}},translucencyByDistance:{get:function(){return this._label.translucencyByDistance},set:function(e){this._label.translucencyByDistance=e,this._billboard.translucencyByDistance=e}},distanceDisplayCondition:{get:function(){return this._label.distanceDisplayCondition},set:function(e){this._label.distanceDisplayCondition=e,this._polyline.distanceDisplayCondition=e,this._billboard.distanceDisplayCondition=e}},heightOffset:{get:function(){return this._heightOffset},set:function(e){var t=m(this._heightOffset,0),r=this._content.tileset.ellipsoid,i=r.cartesianToCartographic(this._billboard.position,o);i.height=i.height-t+e;var n=r.cartographicToCartesian(i);this._billboard.position=n,this._label.position=this._billboard.position,this._polyline.positions=[this._polyline.positions[0],n],this._heightOffset=e}},anchorLineEnabled:{get:function(){return this._polyline.show},set:function(e){this._polyline.show=e}},anchorLineColor:{get:function(){return this._polyline.material.uniforms.color},set:function(e){this._polyline.material.uniforms.color=e}},image:{get:function(){return this._billboardImage},set:function(e){var t=this._billboardImage!==e;this._billboardImage=e,t&&a(this)}},disableDepthTestDistance:{get:function(){return this._label.disableDepthTestDistance},set:function(e){this._label.disableDepthTestDistance=e,this._billboard.disableDepthTestDistance=e}},horizontalOrigin:{get:function(){return this._billboard.horizontalOrigin},set:function(e){this._billboard.horizontalOrigin=e}},verticalOrigin:{get:function(){return this._billboard.verticalOrigin},set:function(e){this._billboard.verticalOrigin=e}},labelHorizontalOrigin:{get:function(){return this._label.horizontalOrigin},set:function(e){this._label.horizontalOrigin=e}},labelVerticalOrigin:{get:function(){return this._label.verticalOrigin},set:function(e){this._label.verticalOrigin=e}},content:{get:function(){return this._content}},tileset:{get:function(){return this._content.tileset}},primitive:{get:function(){return this._content.tileset}}}),v.defaultColor=f.WHITE,v.defaultPointOutlineColor=f.BLACK,v.defaultPointOutlineWidth=0,v.defaultPointSize=8,v.prototype.hasProperty=function(e){return this._content.batchTable.hasProperty(this._batchId,e)},v.prototype.getPropertyNames=function(e){return this._content.batchTable.getPropertyNames(this._batchId,e)},v.prototype.getProperty=function(e){return this._content.batchTable.getProperty(this._batchId,e)},v.prototype.setProperty=function(e,t){this._content.batchTable.setProperty(this._batchId,e,t),this._content.featurePropertiesDirty=!0},v.prototype.isExactClass=function(e){return this._content.batchTable.isExactClass(this._batchId,e)},v.prototype.isClass=function(e){return this._content.batchTable.isClass(this._batchId,e)},v.prototype.getExactClassName=function(){return this._content.batchTable.getExactClassName(this._batchId)},v}),define("Scene/Vector3DTilePoints",["../Core/arraySlice","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DistanceDisplayCondition","../Core/Ellipsoid","../Core/NearFarScalar","../Core/Rectangle","../Core/TaskProcessor","../ThirdParty/when","./BillboardCollection","./Cesium3DTilePointFeature","./HorizontalOrigin","./LabelCollection","./LabelStyle","./PolylineCollection","./VerticalOrigin"],function(A,c,x,d,P,e,t,r,D,i,O,n,o,I,h,p,M,f,R,m){"use strict";function a(e){this._positions=e.positions,this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._rectangle=e.rectangle,this._minHeight=e.minimumHeight,this._maxHeight=e.maximumHeight,this._billboardCollection=void 0,this._labelCollection=void 0,this._polylineCollection=void 0,this._verticesPromise=void 0,this._packedBuffer=void 0,this._ready=!1,this._readyPromise=o.defer(),this._resolvedPromise=!1}e(a.prototype,{pointsLength:{get:function(){return this._billboardCollection.length}},texturesByteLength:{get:function(){return this._billboardCollection.textureAtlas.texture.sizeInBytes+this._labelCollection._textureAtlas.texture.sizeInBytes}},readyPromise:{get:function(){return this._readyPromise.promise}}});var L=new n("createVectorTilePoints"),N=new x;function s(t,e){if(!P(t._billboardCollection)){var r,i,n,o,a,s,l,u,c;if(!P(t._verticesPromise)){r=t._positions;var d=t._packedBuffer;P(d)||(r=t._positions=A(r),t._batchIds=A(t._batchIds),d=t._packedBuffer=(n=e,o=(i=t)._rectangle,a=i._minHeight,s=i._maxHeight,l=2+O.packedLength+D.packedLength,u=new Float64Array(l),c=0,u[c++]=a,u[c++]=s,O.pack(o,u,c),c+=O.packedLength,D.pack(n,u,c),u));var h=[r.buffer,d.buffer],p={positions:r.buffer,packedBuffer:d.buffer},f=t._verticesPromise=L.scheduleTask(p,h);if(!P(f))return;f.then(function(e){t._positions=new Float64Array(e.positions),t._ready=!0})}if(t._ready&&!P(t._billboardCollection)){r=t._positions;var m=t._batchTable,g=t._batchIds,_=t._billboardCollection=new I({batchTable:m}),v=t._labelCollection=new M({batchTable:m}),y=t._polylineCollection=new R;y._useHighlightColor=!0;for(var b=r.length/3,C=0;C<b;++C){var w=g[C],S=x.unpack(r,3*C,N),T=_.add();T.position=S,T._batchIndex=w;var E=v.add();E.text=" ",E.position=S,E._batchIndex=w,y.add().positions=[x.clone(S),x.clone(S)]}t._positions=void 0,t._packedBuffer=void 0}}}a.prototype.createFeatures=function(e,t){for(var r=this._billboardCollection,i=this._labelCollection,n=this._polylineCollection,o=this._batchIds,a=o.length,s=0;s<a;++s){var l=o[s],u=r.get(s),c=i.get(s),d=n.get(s);t[l]=new h(e,l,u,c,d)}},a.prototype.applyDebugSettings=function(e,t){e?(d.clone(t,this._billboardCollection._highlightColor),d.clone(t,this._labelCollection._highlightColor),d.clone(t,this._polylineCollection._highlightColor)):(d.clone(d.WHITE,this._billboardCollection._highlightColor),d.clone(d.WHITE,this._labelCollection._highlightColor),d.clone(d.WHITE,this._polylineCollection._highlightColor))};var g=new d,_=new d,v=new d,y=new d,b=new d,C=new d,w=new i,S=new i,T=new r;return a.prototype.applyStyle=function(e,t,r){if(P(t))for(var i=this._batchIds,n=i.length,o=0;o<n;++o){var a=r[i[o]];if(P(t.show)&&(a.show=t.show.evaluate(e,a)),P(t.pointSize)&&(a.pointSize=t.pointSize.evaluate(e,a)),P(t.color)&&(a.color=t.color.evaluateColor(e,a,g)),P(t.pointOutlineColor)&&(a.pointOutlineColor=t.pointOutlineColor.evaluateColor(e,a,_)),P(t.pointOutlineWidth)&&(a.pointOutlineWidth=t.pointOutlineWidth.evaluate(e,a)),P(t.labelColor)&&(a.labelColor=t.labelColor.evaluateColor(e,a,v)),P(t.labelOutlineColor)&&(a.labelOutlineColor=t.labelOutlineColor.evaluateColor(e,a,y)),P(t.labelOutlineWidth)&&(a.labelOutlineWidth=t.labelOutlineWidth.evaluate(e,a)),P(t.font)&&(a.font=t.font.evaluate(e,a)),P(t.labelStyle)&&(a.labelStyle=t.labelStyle.evaluate(e,a)),P(t.labelText)?a.labelText=t.labelText.evaluate(e,a):a.labelText=void 0,P(t.backgroundColor)&&(a.backgroundColor=t.backgroundColor.evaluateColor(e,a,b)),P(t.backgroundPadding)&&(a.backgroundPadding=t.backgroundPadding.evaluate(e,a)),P(t.backgroundEnabled)&&(a.backgroundEnabled=t.backgroundEnabled.evaluate(e,a)),P(t.scaleByDistance)){var s=t.scaleByDistance.evaluate(e,a);w.near=s.x,w.nearValue=s.y,w.far=s.z,w.farValue=s.w,a.scaleByDistance=w}else a.scaleByDistance=void 0;if(P(t.translucencyByDistance)){var l=t.translucencyByDistance.evaluate(e,a);S.near=l.x,S.nearValue=l.y,S.far=l.z,S.farValue=l.w,a.translucencyByDistance=S}else a.translucencyByDistance=void 0;if(P(t.distanceDisplayCondition)){var u=t.distanceDisplayCondition.evaluate(e,a);T.near=u.x,T.far=u.y,a.distanceDisplayCondition=T}else a.distanceDisplayCondition=void 0;P(t.heightOffset)&&(a.heightOffset=t.heightOffset.evaluate(e,a)),P(t.anchorLineEnabled)&&(a.anchorLineEnabled=t.anchorLineEnabled.evaluate(e,a)),P(t.anchorLineColor)&&(a.anchorLineColor=t.anchorLineColor.evaluateColor(e,a,C)),P(t.image)?a.image=t.image.evaluate(e,a):a.image=void 0,P(t.disableDepthTestDistance)&&(a.disableDepthTestDistance=t.disableDepthTestDistance.evaluate(e,a)),P(t.horizontalOrigin)&&(a.horizontalOrigin=t.horizontalOrigin.evaluate(e,a)),P(t.verticalOrigin)&&(a.verticalOrigin=t.verticalOrigin.evaluate(e,a)),P(t.labelHorizontalOrigin)&&(a.labelHorizontalOrigin=t.labelHorizontalOrigin.evaluate(e,a)),P(t.labelVerticalOrigin)&&(a.labelVerticalOrigin=t.labelVerticalOrigin.evaluate(e,a))}else!function(e,t){for(var r=e._batchIds,i=r.length,n=0;n<i;++n){var o=t[r[n]];o.show=!0,o.pointSize=h.defaultPointSize,o.color=h.defaultColor,o.pointOutlineColor=h.defaultPointOutlineColor,o.pointOutlineWidth=h.defaultPointOutlineWidth,o.labelColor=d.WHITE,o.labelOutlineColor=d.WHITE,o.labelOutlineWidth=1,o.font="30px sans-serif",o.labelStyle=f.FILL,o.labelText=void 0,o.backgroundColor=new d(.165,.165,.165,.8),o.backgroundPadding=new c(7,5),o.backgroundEnabled=!1,o.scaleByDistance=void 0,o.translucencyByDistance=void 0,o.distanceDisplayCondition=void 0,o.heightOffset=0,o.anchorLineEnabled=!1,o.anchorLineColor=d.WHITE,o.image=void 0,o.disableDepthTestDistance=0,o.horizontalOrigin=p.CENTER,o.verticalOrigin=m.CENTER,o.labelHorizontalOrigin=p.RIGHT,o.labelVerticalOrigin=m.BASELINE}}(this,r)},a.prototype.update=function(e){s(this,e.mapProjection.ellipsoid),this._ready&&(this._polylineCollection.update(e),this._billboardCollection.update(e),this._labelCollection.update(e),this._resolvedPromise||(this._readyPromise.resolve(),this._resolvedPromise=!0))},a.prototype.isDestroyed=function(){return!1},a.prototype.destroy=function(){return this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),this._labelCollection=this._labelCollection&&this._labelCollection.destroy(),this._polylineCollection=this._polylineCollection&&this._polylineCollection.destroy(),t(this)},a}),define("Scene/Vector3DTilePolygons",["../Core/arraySlice","../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/Ellipsoid","../Core/IndexDatatype","../Core/Matrix4","../Core/OrientedBoundingBox","../Core/Rectangle","../Core/TaskProcessor","../ThirdParty/when","./ClassificationType","./Vector3DTileBatch","./Vector3DTilePrimitive"],function(b,C,w,t,S,e,r,T,E,i,A,x,n,P,o,D,O){"use strict";function a(e){this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._positions=e.positions,this._counts=e.counts,this._indices=e.indices,this._indexCounts=e.indexCounts,this._indexOffsets=void 0,this._batchTableColors=void 0,this._packedBuffer=void 0,this._batchedPositions=void 0,this._transferrableBatchIds=void 0,this._vertexBatchIds=void 0,this._ellipsoid=t(e.ellipsoid,T.WGS84),this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._polygonMinimumHeights=e.polygonMinimumHeights,this._polygonMaximumHeights=e.polygonMaximumHeights,this._center=t(e.center,C.ZERO),this._rectangle=e.rectangle,this._center=void 0,this._boundingVolume=e.boundingVolume,this._boundingVolumes=void 0,this._batchedIndices=void 0,this._ready=!1,this._readyPromise=P.defer(),this._verticesPromise=void 0,this._primitive=void 0,this.debugWireframe=!1,this.forceRebatch=!1,this.classificationType=o.CESIUM_3D_TILE}e(a.prototype,{trianglesLength:{get:function(){return S(this._primitive)?this._primitive.trianglesLength:0}},geometryByteLength:{get:function(){return S(this._primitive)?this._primitive.geometryByteLength:0}},readyPromise:{get:function(){return this._readyPromise.promise}}});var I=new n("createVectorTilePolygons"),M=new w;function s(i){if(!S(i._primitive)){if(!S(i._verticesPromise)){var e=i._positions,t=i._counts,r=i._indexCounts,n=i._indices,o=i._transferrableBatchIds,a=i._batchTableColors,s=i._packedBuffer;if(!S(a)){e=i._positions=b(i._positions),t=i._counts=b(i._counts),r=i._indexCounts=b(i._indexCounts),n=i._indices=b(i._indices),i._center=i._ellipsoid.cartographicToCartesian(x.center(i._rectangle)),o=i._transferrableBatchIds=new Uint32Array(i._batchIds),a=i._batchTableColors=new Uint32Array(o.length);for(var l=i._batchTable,u=a.length,c=0;c<u;++c){var d=l.getColor(c,M);a[c]=d.toRgba()}s=i._packedBuffer=(_=i,v=new Float64Array(3+C.packedLength+T.packedLength+x.packedLength),y=0,v[y++]=_._indices.BYTES_PER_ELEMENT,v[y++]=_._minimumHeight,v[y++]=_._maximumHeight,C.pack(_._center,v,y),y+=C.packedLength,T.pack(_._ellipsoid,v,y),y+=T.packedLength,x.pack(_._rectangle,v,y),v)}var h=[e.buffer,t.buffer,r.buffer,n.buffer,o.buffer,a.buffer,s.buffer],p={packedBuffer:s.buffer,positions:e.buffer,counts:t.buffer,indexCounts:r.buffer,indices:n.buffer,batchIds:o.buffer,batchTableColors:a.buffer},f=i._polygonMinimumHeights,m=i._polygonMaximumHeights;S(f)&&S(m)&&(h.push(f.buffer,m.buffer),p.minimumHeights=f,p.maximumHeights=m);var g=i._verticesPromise=I.scheduleTask(p,h);if(!S(g))return;P(g,function(e){i._positions=void 0,i._counts=void 0,i._polygonMinimumHeights=void 0,i._polygonMaximumHeights=void 0;var t=new Float64Array(e.packedBuffer),r=t[0];!function(e,t){for(var r=1,i=t[r++],n=e._boundingVolumes=new Array(i),o=0;o<i;++o)n[o]=A.unpack(t,r),r+=A.packedLength;for(var a=t[r++],s=e._batchedIndices=new Array(a),l=0;l<a;++l){var u=w.unpack(t,r);r+=w.packedLength;for(var c=t[r++],d=t[r++],h=t[r++],p=new Array(h),f=0;f<h;++f)p[f]=t[r++];s[l]=new D({color:u,offset:c,count:d,batchIds:p})}}(i,t),i._indices=2===E.getSizeInBytes(r)?new Uint16Array(e.indices):new Uint32Array(e.indices),i._indexOffsets=new Uint32Array(e.indexOffsets),i._indexCounts=new Uint32Array(e.indexCounts),i._batchedPositions=new Float32Array(e.positions),i._vertexBatchIds=new Uint16Array(e.batchIds),i._ready=!0})}var _,v,y;i._ready&&!S(i._primitive)&&(i._primitive=new O({batchTable:i._batchTable,positions:i._batchedPositions,batchIds:i._batchIds,vertexBatchIds:i._vertexBatchIds,indices:i._indices,indexOffsets:i._indexOffsets,indexCounts:i._indexCounts,batchedIndices:i._batchedIndices,boundingVolume:i._boundingVolume,boundingVolumes:i._boundingVolumes,center:i._center}),i._batchTable=void 0,i._batchIds=void 0,i._positions=void 0,i._counts=void 0,i._indices=void 0,i._indexCounts=void 0,i._indexOffsets=void 0,i._batchTableColors=void 0,i._packedBuffer=void 0,i._batchedPositions=void 0,i._transferrableBatchIds=void 0,i._vertexBatchIds=void 0,i._ellipsoid=void 0,i._minimumHeight=void 0,i._maximumHeight=void 0,i._polygonMinimumHeights=void 0,i._polygonMaximumHeights=void 0,i._center=void 0,i._rectangle=void 0,i._boundingVolume=void 0,i._boundingVolumes=void 0,i._batchedIndices=void 0,i._verticesPromise=void 0,i._readyPromise.resolve())}}return a.prototype.createFeatures=function(e,t){this._primitive.createFeatures(e,t)},a.prototype.applyDebugSettings=function(e,t){this._primitive.applyDebugSettings(e,t)},a.prototype.applyStyle=function(e,t,r){this._primitive.applyStyle(e,t,r)},a.prototype.updateCommands=function(e,t){this._primitive.updateCommands(e,t)},a.prototype.update=function(e){s(this),this._ready&&(this._primitive.debugWireframe=this.debugWireframe,this._primitive.forceRebatch=this.forceRebatch,this._primitive.classificationType=this.classificationType,this._primitive.update(e))},a.prototype.isDestroyed=function(){return!1},a.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),r(this)},a}),define("Shaders/Vector3DTilePolylinesVS",[],function(){"use strict";return"attribute vec4 currentPosition;\nattribute vec4 previousPosition;\nattribute vec4 nextPosition;\nattribute vec2 expandAndWidth;\nattribute float a_batchId;\nuniform mat4 u_modifiedModelView;\nvoid main()\n{\nfloat expandDir = expandAndWidth.x;\nfloat width = abs(expandAndWidth.y) + 0.5;\nbool usePrev = expandAndWidth.y < 0.0;\nvec4 p = u_modifiedModelView * currentPosition;\nvec4 prev = u_modifiedModelView * previousPosition;\nvec4 next = u_modifiedModelView * nextPosition;\nfloat angle;\nvec4 positionWC = getPolylineWindowCoordinatesEC(p, prev, next, expandDir, width, usePrev, angle);\ngl_Position = czm_viewportOrthographic * positionWC;\n}\n"}),define("Scene/Vector3DTilePolylines",["../Core/arraySlice","../Core/Cartesian3","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/Ellipsoid","../Core/IndexDatatype","../Core/Matrix4","../Core/Rectangle","../Core/TaskProcessor","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../Shaders/PolylineCommon","../Shaders/Vector3DTilePolylinesVS","../ThirdParty/when","./BlendingState","./Cesium3DTileFeature"],function(R,L,s,N,t,k,e,r,F,B,o,U,i,V,z,a,l,u,c,d,q,h,p,G,f,m){"use strict";function n(e){this._positions=e.positions,this._widths=e.widths,this._counts=e.counts,this._batchIds=e.batchIds,this._ellipsoid=t(e.ellipsoid,F.WGS84),this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._center=e.center,this._rectangle=e.rectangle,this._boundingVolume=e.boundingVolume,this._batchTable=e.batchTable,this._va=void 0,this._sp=void 0,this._rs=void 0,this._uniformMap=void 0,this._command=void 0,this._spPick=void 0,this._rsPick=void 0,this._pickCommand=void 0,this._transferrableBatchIds=void 0,this._packedBuffer=void 0,this._currentPositions=void 0,this._previousPositions=void 0,this._nextPositions=void 0,this._expandAndWidth=void 0,this._vertexBatchIds=void 0,this._indices=void 0,this._constantColor=s.clone(s.WHITE),this._highlightColor=this._constantColor,this._trianglesLength=0,this._geometryByteLength=0,this._ready=!1,this._readyPromise=G.defer(),this._verticesPromise=void 0}e(n.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},readyPromise:{get:function(){return this._readyPromise.promise}}});var W=new i("createVectorTilePolylines"),H={previousPosition:0,currentPosition:1,nextPosition:2,expandAndWidth:3,a_batchId:4};function g(r,e){if(!k(r._va)){if(!k(r._verticesPromise)){var t=r._positions,i=r._widths,n=r._counts,o=r._transferrableBatchIds,a=r._packedBuffer;k(a)||(t=r._positions=R(t),i=r._widths=R(i),n=r._counts=R(n),o=r._transferrableBatchIds=R(r._batchIds),a=r._packedBuffer=(d=(c=r)._rectangle,h=c._minimumHeight,p=c._maximumHeight,f=c._ellipsoid,m=c._center,g=2+U.packedLength+F.packedLength+L.packedLength,_=new Float64Array(g),v=0,_[v++]=h,_[v++]=p,U.pack(d,_,v),v+=U.packedLength,F.pack(f,_,v),v+=F.packedLength,L.pack(m,_,v),_));var s=[t.buffer,i.buffer,n.buffer,o.buffer,a.buffer],l={positions:t.buffer,widths:i.buffer,counts:n.buffer,batchIds:o.buffer,packedBuffer:a.buffer},u=r._verticesPromise=W.scheduleTask(l,s);if(!k(u))return;G(u,function(e){r._currentPositions=new Float32Array(e.currentPositions),r._previousPositions=new Float32Array(e.previousPositions),r._nextPositions=new Float32Array(e.nextPositions),r._expandAndWidth=new Float32Array(e.expandAndWidth),r._vertexBatchIds=new Uint16Array(e.batchIds);var t=e.indexDatatype;r._indices=t===B.UNSIGNED_SHORT?new Uint16Array(e.indices):new Uint32Array(e.indices),r._ready=!0})}var c,d,h,p,f,m,g,_,v;if(r._ready&&!k(r._va)){var y=r._currentPositions,b=r._previousPositions,C=r._nextPositions,w=r._expandAndWidth,S=r._vertexBatchIds,T=r._indices,E=b.byteLength+y.byteLength+C.byteLength;E+=w.byteLength+S.byteLength+T.byteLength,r._trianglesLength=T.length/3,r._geometryByteLength=E;var A=V.createVertexBuffer({context:e,typedArray:b,usage:z.STATIC_DRAW}),x=V.createVertexBuffer({context:e,typedArray:y,usage:z.STATIC_DRAW}),P=V.createVertexBuffer({context:e,typedArray:C,usage:z.STATIC_DRAW}),D=V.createVertexBuffer({context:e,typedArray:w,usage:z.STATIC_DRAW}),O=V.createVertexBuffer({context:e,typedArray:S,usage:z.STATIC_DRAW}),I=V.createIndexBuffer({context:e,typedArray:T,usage:z.STATIC_DRAW,indexDatatype:2===T.BYTES_PER_ELEMENT?B.UNSIGNED_SHORT:B.UNSIGNED_INT}),M=[{index:H.previousPosition,vertexBuffer:A,componentDatatype:N.FLOAT,componentsPerAttribute:3},{index:H.currentPosition,vertexBuffer:x,componentDatatype:N.FLOAT,componentsPerAttribute:3},{index:H.nextPosition,vertexBuffer:P,componentDatatype:N.FLOAT,componentsPerAttribute:3},{index:H.expandAndWidth,vertexBuffer:D,componentDatatype:N.FLOAT,componentsPerAttribute:2},{index:H.a_batchId,vertexBuffer:O,componentDatatype:N.UNSIGNED_SHORT,componentsPerAttribute:1}];r._va=new q({context:e,attributes:M,indexBuffer:I}),r._positions=void 0,r._widths=void 0,r._counts=void 0,r._ellipsoid=void 0,r._minimumHeight=void 0,r._maximumHeight=void 0,r._rectangle=void 0,r._transferrableBatchIds=void 0,r._packedBuffer=void 0,r._currentPositions=void 0,r._previousPositions=void 0,r._nextPositions=void 0,r._expandAndWidth=void 0,r._vertexBatchIds=void 0,r._indices=void 0,r._readyPromise.resolve()}}}var _=new o,v=new L;var y="uniform vec4 u_highlightColor; \nvoid main()\n{\n    gl_FragColor = u_highlightColor;\n}\n";n.prototype.createFeatures=function(e,t){for(var r=this._batchIds,i=r.length,n=0;n<i;++n){var o=r[n];t[o]=new m(e,o)}},n.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:this._constantColor};var b=new s,C=s.WHITE;return n.prototype.applyStyle=function(e,t,r){if(k(t))for(var i=this._batchIds,n=i.length,o=0;o<n;++o){var a=r[i[o]];a.color=k(t.color)?t.color.evaluateColor(e,a,b):C,a.show=!k(t.show)||t.show.evaluate(e,a)}else!function(e,t){for(var r=e._batchIds,i=r.length,n=0;n<i;++n){var o=t[r[n]];o.show=!0,o.color=s.WHITE}}(this,r)},n.prototype.update=function(e){var t,r,i=e.context;if(g(this,i),r=i,k((t=this)._uniformMap)||(t._uniformMap={u_modifiedModelView:function(){var e=r.uniformState.view;return o.clone(e,_),o.multiplyByPoint(_,t._center,v),o.setTranslation(_,v,_),_},u_highlightColor:function(){return t._highlightColor}}),function(e,t){if(!k(e._sp)){var r=e._batchTable,i=r.getVertexShaderCallback(!1,"a_batchId",void 0)(p),n=r.getFragmentShaderCallback()(y,!1,void 0),o=new d({defines:["VECTOR_TILE"],sources:[h,i]}),a=new d({defines:["VECTOR_TILE"],sources:[n]});e._sp=c.fromCache({context:t,vertexShaderSource:o,fragmentShaderSource:a,attributeLocations:H}),i=r.getPickVertexShaderCallback("a_batchId")(p),n=r.getPickFragmentShaderCallback()(y,!1,void 0);var s=new d({defines:["VECTOR_TILE"],sources:[h,i]}),l=new d({defines:["VECTOR_TILE"],sources:[n]});e._spPick=c.fromCache({context:t,vertexShaderSource:s,fragmentShaderSource:l,attributeLocations:H})}}(this,i),function(e){if(!k(e._rs)){var t={enabled:!0,factor:-5,units:-5};e._rs=u.fromCache({blending:f.ALPHA_BLEND,depthMask:!1,depthTest:{enabled:!0},polygonOffset:t}),e._rsPick=u.fromCache({depthMask:!1,depthTest:{enabled:!0},polygonOffset:t})}}(this),this._ready){var n=e.passes;n.render&&function(e,t){if(!k(e._command)){var r=e._batchTable.getUniformMapCallback()(e._uniformMap);e._command=new a({owner:e,vertexArray:e._va,renderState:e._rs,shaderProgram:e._sp,uniformMap:r,boundingVolume:e._boundingVolume,pass:l.TRANSLUCENT})}t.commandList.push(e._command)}(this,e),n.pick&&function(e,t){if(!k(e._pickCommand)){var r=e._batchTable.getPickUniformMapCallback()(e._uniformMap);e._pickCommand=new a({owner:e,vertexArray:e._va,renderState:e._rsPick,shaderProgram:e._spPick,uniformMap:r,boundingVolume:e._boundingVolume,pass:l.TRANSLUCENT})}t.commandList.push(e._pickCommand)}(this,e)}},n.prototype.isDestroyed=function(){return!1},n.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),r(this)},n}),define("Scene/Vector3DTileContent",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Ellipsoid","../Core/FeatureDetection","../Core/getMagic","../Core/getStringFromTypedArray","../Core/Math","../Core/Matrix4","../Core/Rectangle","../Core/RuntimeError","../ThirdParty/when","./Cesium3DTileBatchTable","./Vector3DTilePoints","./Vector3DTilePolygons","./Vector3DTilePolylines"],function(K,J,$,e,t,r,ee,i,n,te,re,ie,ne,oe,a,ae,se,le,ue){"use strict";if(!i.supportsTypedArrays())return{};function o(e,t,r,i,n){this._tileset=e,this._tile=t,this._resource=r,this._polygons=void 0,this._polylines=void 0,this._points=void 0,this._contentReadyPromise=void 0,this._readyPromise=a.defer(),this._batchTable=void 0,this._features=void 0,this.featurePropertiesDirty=!1,function(e,t,r){r=J(r,0);var i=new Uint8Array(t),n=new DataView(t);r+=de;var o=n.getUint32(r,!0);if(1!==o)throw new oe("Only Vector tile version 1 is supported.  Version "+o+" is not.");r+=de;var a=n.getUint32(r,!0);if(r+=de,0===a)return e._readyPromise.resolve(e);var s=n.getUint32(r,!0);if(r+=de,0===s)throw new oe("Feature table must have a byte length greater than zero");var l=n.getUint32(r,!0);r+=de;var u=n.getUint32(r,!0);r+=de;var c=n.getUint32(r,!0);r+=de;var d=n.getUint32(r,!0);r+=de;var h=n.getUint32(r,!0);r+=de;var p=n.getUint32(r,!0);r+=de;var f=n.getUint32(r,!0),m=te(i,r+=de,s),g=JSON.parse(m);r+=s;var _,v,y=new Uint8Array(t,r,l);if(r+=l,0<u){var b=te(i,r,u);_=JSON.parse(b),r+=u,0<c&&(v=new Uint8Array(t,r,c),v=new Uint8Array(v),r+=c)}var C,w,S,T=J(g.POLYGONS_LENGTH,0),E=J(g.POLYLINES_LENGTH,0),A=J(g.POINTS_LENGTH,0),x=T+E+A,P=new ae(e,x,_,v,(D=e,function(e,t){$(D._polygons)&&D._polygons.updateCommands(e,t)}));var D;if(e._batchTable=P,0===x)return;{if(!$(g.REGION))throw new oe("REGION is required in the feature table.");var O=g.REGION;C=ne.unpack(O),w=O[4],S=O[5]}var I,M=e._tile.computedTransform;$(g.RTC_CENTER)?(I=K.unpack(g.RTC_CENTER),ie.multiplyByPoint(M,I,I)):((I=ne.center(C)).height=re.lerp(w,S,.5),I=ee.WGS84.cartographicToCartesian(I));var R=function(e,t){var r,i,n,o,a=J(e.POLYGONS_LENGTH,0),s=J(e.POLYLINES_LENGTH,0),l=J(e.POINTS_LENGTH,0);if(0<a&&$(e.POLYGON_BATCH_IDS)){var u=t.byteOffset+e.POLYGON_BATCH_IDS.byteOffset;r=new Uint16Array(t.buffer,u,a)}if(0<s&&$(e.POLYLINE_BATCH_IDS)){var c=t.byteOffset+e.POLYLINE_BATCH_IDS.byteOffset;i=new Uint16Array(t.buffer,c,s)}if(0<l&&$(e.POINT_BATCH_IDS)){var d=t.byteOffset+e.POINT_BATCH_IDS.byteOffset;n=new Uint16Array(t.buffer,d,l)}var h=$(r)||$(i)||$(n),p=0<a&&!$(r)||0<s&&!$(i)||0<l&&!$(n);if(h&&p)throw new oe("If one group of batch ids is defined, then all batch ids must be defined.");if(!$(r)&&!$(i)&&!$(n)){var f=0;if(!$(r)&&0<a)for(r=new Uint16Array(a),o=0;o<a;++o)r[o]=f++;if(!$(i)&&0<s)for(i=new Uint16Array(s),o=0;o<s;++o)i[o]=f++;if(!$(n)&&0<l)for(n=new Uint16Array(l),o=0;o<l;++o)n[o]=f++}return{polygons:r,polylines:i,points:n}}(g,y);if(r+=r%4,0<T){var L=new Uint32Array(t,r,d/de);r+=d;var N=new Uint16Array(t,r,h/ce);r+=h;var k,F,B=y.byteOffset+g.POLYGON_COUNT.byteOffset,U=new Uint32Array(y.buffer,B,T),V=y.byteOffset+g.POLYGON_INDEX_COUNT.byteOffset,z=new Uint32Array(y.buffer,V,T);if($(g.POLYGON_MINIMUM_HEIGHTS)&&$(g.POLYGON_MAXIMUM_HEIGHTS)){var q=y.byteOffset+g.POLYGON_MINIMUM_HEIGHTS.byteOffset;k=new Float32Array(y.buffer,q,T);var G=y.byteOffset+g.POLYGON_MAXIMUM_HEIGHTS.byteOffset;F=new Float32Array(y.buffer,G,T)}e._polygons=new le({positions:N,counts:U,indexCounts:z,indices:L,minimumHeight:w,maximumHeight:S,polygonMinimumHeights:k,polygonMaximumHeights:F,center:I,rectangle:C,boundingVolume:e._tile._boundingVolume.boundingVolume,batchTable:P,batchIds:R.polygons,modelMatrix:M})}if(0<E){var W=new Uint16Array(t,r,p/ce);r+=p;var H,j=y.byteOffset+g.POLYLINE_COUNT.byteOffset,Y=new Uint32Array(y.buffer,j,E);if($(g.POLYLINE_WIDTHS)){var X=y.byteOffset+g.POLYLINE_WIDTHS.byteOffset;H=new Uint16Array(y.buffer,X,E)}else{H=new Uint16Array(E);for(var Q=0;Q<E;++Q)H[Q]=2}e._polylines=new ue({positions:W,widths:H,counts:Y,batchIds:R.polylines,minimumHeight:w,maximumHeight:S,center:I,rectangle:C,boundingVolume:e._tile._boundingVolume.boundingVolume,batchTable:P})}if(0<A){var Z=new Uint16Array(t,r,f/ce);e._points=new se({positions:Z,batchIds:R.points,minimumHeight:w,maximumHeight:S,rectangle:C,batchTable:P})}}(this,i,n)}e(o.prototype,{featuresLength:{get:function(){return $(this._batchTable)?this._batchTable.featuresLength:0}},pointsLength:{get:function(){return $(this._points)?this._points.pointsLength:0}},trianglesLength:{get:function(){var e=0;return $(this._polygons)&&(e+=this._polygons.trianglesLength),$(this._polylines)&&(e+=this._polylines.trianglesLength),e}},geometryByteLength:{get:function(){var e=0;return $(this._polygons)&&(e+=this._polygons.geometryByteLength),$(this._polylines)&&(e+=this._polylines.geometryByteLength),e}},texturesByteLength:{get:function(){return $(this._points)?this._points.texturesByteLength:0}},batchTableByteLength:{get:function(){return $(this._batchTable)?this._batchTable.memorySizeInBytes:0}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._readyPromise.promise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){return this._batchTable}}});var ce=Uint16Array.BYTES_PER_ELEMENT,de=Uint32Array.BYTES_PER_ELEMENT;function s(e){var t=e.featuresLength;if(!$(e._features)&&0<t){var r=new Array(t);$(e._polygons)&&e._polygons.createFeatures(e,r),$(e._polylines)&&e._polylines.createFeatures(e,r),$(e._points)&&e._points.createFeatures(e,r),e._features=r}}return o.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},o.prototype.getFeature=function(e){var t=this.featuresLength;if(!$(e)||e<0||t<=e)throw new r("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").");return s(this),this._features[e]},o.prototype.applyDebugSettings=function(e,t){$(this._polygons)&&this._polygons.applyDebugSettings(e,t),$(this._polylines)&&this._polylines.applyDebugSettings(e,t),$(this._points)&&this._points.applyDebugSettings(e,t)},o.prototype.applyStyle=function(e,t){s(this),$(this._polygons)&&this._polygons.applyStyle(e,t,this._features),$(this._polylines)&&this._polylines.applyStyle(e,t,this._features),$(this._points)&&this._points.applyStyle(e,t,this._features)},o.prototype.update=function(e,t){if($(this._batchTable)&&this._batchTable.update(e,t),$(this._polygons)&&(this._polygons.classificationType=this._tileset.classificationType,this._polygons.update(t)),$(this._polylines)&&this._polylines.update(t),$(this._points)&&this._points.update(t),!$(this._contentReadyPromise)){var r=$(this._points)?this._points.readyPromise:void 0,i=$(this._polygons)?this._polygons.readyPromise:void 0,n=$(this._polylines)?this._polylines.readyPromise:void 0,o=this;this._contentReadyPromise=a.all([r,i,n]).then(function(){o._readyPromise.resolve(o)})}},o.prototype.isDestroyed=function(){return!1},o.prototype.destroy=function(){return this._polygons=this._polygons&&this._polygons.destroy(),this._polylines=this._polylines&&this._polylines.destroy(),this._points=this._points&&this._points.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),t(this)},o}),define("Scene/Cesium3DTileContentFactory",["./Batched3DModel3DTileContent","./Composite3DTileContent","./Geometry3DTileContent","./Instanced3DModel3DTileContent","./PointCloud3DTileContent","./Tileset3DTileContent","./Vector3DTileContent"],function(o,a,s,l,u,c,d){"use strict";var h={b3dm:function(e,t,r,i,n){return new o(e,t,r,i,n)},pnts:function(e,t,r,i,n){return new u(e,t,r,i,n)},i3dm:function(e,t,r,i,n){return new l(e,t,r,i,n)},cmpt:function(e,t,r,i,n){return new a(e,t,r,i,n,h)},json:function(e,t,r,i,n){return new c(e,t,r,i,n)},geom:function(e,t,r,i,n){return new s(e,t,r,i,n)},vctr:function(e,t,r,i,n){return new d(e,t,r,i,n)}};return h}),define("Scene/Cesium3DTileContentState",["../Core/freezeObject"],function(e){"use strict";return e({UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5})}),define("Scene/Cesium3DTileOptimizationHint",["../Core/freezeObject"],function(e){"use strict";return e({NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0})}),define("Scene/Cesium3DTileRefine",["../Core/freezeObject"],function(e){"use strict";return e({ADD:0,REPLACE:1})}),define("Scene/Empty3DTileContent",["../Core/defineProperties","../Core/destroyObject"],function(e,t){"use strict";function r(e,t){this._tileset=e,this._tile=t,this.featurePropertiesDirty=!1}return e(r.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){}},readyPromise:{get:function(){}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){}},batchTable:{get:function(){}}}),r.prototype.hasProperty=function(e,t){return!1},r.prototype.getFeature=function(e){},r.prototype.applyDebugSettings=function(e,t){},r.prototype.applyStyle=function(e,t){},r.prototype.update=function(e,t){},r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return t(this)},r}),define("Scene/TileBoundingRegion",["../Core/BoundingSphere","../Core/Cartesian3","../Core/Cartographic","../Core/Check","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defineProperties","../Core/Ellipsoid","../Core/GeometryInstance","../Core/IntersectionTests","../Core/Matrix4","../Core/OrientedBoundingBox","../Core/Plane","../Core/Ray","../Core/Rectangle","../Core/RectangleOutlineGeometry","./PerInstanceColorAppearance","./Primitive","./SceneMode"],function(r,y,e,v,n,i,t,o,a,b,s,l,C,u,w,c,d,h,S){"use strict";function p(e){v.typeOf.object("options",e),v.typeOf.object("options.rectangle",e.rectangle),this.rectangle=w.clone(e.rectangle),this.minimumHeight=i(e.minimumHeight,0),this.maximumHeight=i(e.maximumHeight,0),this.southwestCornerCartesian=new y,this.northeastCornerCartesian=new y,this.westNormal=new y,this.southNormal=new y,this.eastNormal=new y,this.northNormal=new y;var t=i(e.ellipsoid,o.WGS84);!function(e,t,r){r.cartographicToCartesian(w.southwest(t),e.southwestCornerCartesian),r.cartographicToCartesian(w.northeast(t),e.northeastCornerCartesian),O.longitude=t.west,O.latitude=.5*(t.south+t.north),O.height=0;var i=r.cartographicToCartesian(O,P),n=y.cross(i,y.UNIT_Z,T);y.normalize(n,e.westNormal),O.longitude=t.east;var o=r.cartographicToCartesian(O,D),a=y.cross(y.UNIT_Z,o,T);y.normalize(a,e.eastNormal);var s,l=y.subtract(i,o,T),u=y.normalize(l,x),c=t.south;if(0<c){O.longitude=.5*(t.west+t.east),O.latitude=c;var d=r.cartographicToCartesian(O,M.origin);y.clone(u,M.direction);var h=C.fromPointNormal(e.southwestCornerCartesian,e.westNormal,I);b.rayPlane(M,h,e.southwestCornerCartesian),s=r.geodeticSurfaceNormal(d,E)}else s=r.geodeticSurfaceNormalCartographic(w.southeast(t),E);var p=y.cross(s,l,A);y.normalize(p,e.southNormal);var f,m=t.north;if(m<0){O.longitude=.5*(t.west+t.east),O.latitude=m;var g=r.cartographicToCartesian(O,M.origin);y.negate(u,M.direction);var _=C.fromPointNormal(e.northeastCornerCartesian,e.eastNormal,I);b.rayPlane(M,_,e.northeastCornerCartesian),f=r.geodeticSurfaceNormal(g,E)}else f=r.geodeticSurfaceNormalCartographic(w.northwest(t),E);var v=y.cross(l,f,A);y.normalize(v,e.northNormal)}(this,e.rectangle,t),this._orientedBoundingBox=l.fromRectangle(this.rectangle,this.minimumHeight,this.maximumHeight,t),this._boundingSphere=r.fromOrientedBoundingBox(this._orientedBoundingBox)}t(p.prototype,{boundingVolume:{get:function(){return this._orientedBoundingBox}},boundingSphere:{get:function(){return this._boundingSphere}}});var T=new y,E=new y,A=new y,x=new y,P=new y,D=new y,O=new e,I=new C(y.UNIT_X,0),M=new u;var R=new y,L=new y,N=new y(0,-1,0),k=new y(0,0,-1),F=new y;return p.prototype.distanceToCamera=function(e){v.defined("frameState",e);var t=e.camera,r=t.positionWC,i=t.positionCartographic,n=0;if(!w.contains(this.rectangle,i)){var o=this.southwestCornerCartesian,a=this.northeastCornerCartesian,s=this.westNormal,l=this.southNormal,u=this.eastNormal,c=this.northNormal;e.mode!==S.SCENE3D&&((o=e.mapProjection.project(w.southwest(this.rectangle),R)).z=o.y,o.y=o.x,o.x=0,(a=e.mapProjection.project(w.northeast(this.rectangle),L)).z=a.y,a.y=a.x,a.x=0,s=N,u=y.UNIT_Y,l=k,c=y.UNIT_Z);var d=y.subtract(r,o,F),h=y.dot(d,s),p=y.dot(d,l),f=y.subtract(r,a,F),m=y.dot(f,u),g=y.dot(f,c);0<h?n+=h*h:0<m&&(n+=m*m),0<p?n+=p*p:0<g&&(n+=g*g)}var _=(e.mode===S.SCENE3D?i.height:r.x)-(e.mode===S.SCENE3D?this.maximumHeight:0);return 0<_&&(n+=_*_),Math.sqrt(n)},p.prototype.intersectPlane=function(e){return v.defined("plane",e),this._orientedBoundingBox.intersectPlane(e)},p.prototype.createDebugVolume=function(e){v.defined("color",e);var t=new s.clone(s.IDENTITY),r=new c({rectangle:this.rectangle,height:this.minimumHeight,extrudedHeight:this.maximumHeight}),i=new a({geometry:r,modelMatrix:t,attributes:{color:n.fromColor(e)}});return new h({geometryInstances:i,appearance:new d({translucent:!1,flat:!0}),asynchronous:!1})},p}),define("Scene/TileBoundingSphere",["../Core/BoundingSphere","../Core/Cartesian3","../Core/Check","../Core/ColorGeometryInstanceAttribute","../Core/defineProperties","../Core/GeometryInstance","../Core/Matrix4","../Core/SphereOutlineGeometry","./PerInstanceColorAppearance","./Primitive"],function(r,i,n,o,e,a,s,l,u,c){"use strict";function t(e,t){this._boundingSphere=new r(e,t)}return e(t.prototype,{center:{get:function(){return this._boundingSphere.center}},radius:{get:function(){return this._boundingSphere.radius}},boundingVolume:{get:function(){return this._boundingSphere}},boundingSphere:{get:function(){return this._boundingSphere}}}),t.prototype.distanceToCamera=function(e){n.defined("frameState",e);var t=this._boundingSphere;return Math.max(0,i.distance(t.center,e.camera.positionWC)-t.radius)},t.prototype.intersectPlane=function(e){return n.defined("plane",e),r.intersectPlane(this._boundingSphere,e)},t.prototype.update=function(e,t){i.clone(e,this._boundingSphere.center),this._boundingSphere.radius=t},t.prototype.createDebugVolume=function(e){n.defined("color",e);var t=new l({radius:this.radius}),r=s.fromTranslation(this.center,new s.clone(s.IDENTITY)),i=new a({geometry:t,modelMatrix:r,attributes:{color:o.fromColor(e)}});return new c({geometryInstances:i,appearance:new u({translucent:!1,flat:!0}),asynchronous:!1})},t}),define("Scene/TileOrientedBoundingBox",["../Core/BoundingSphere","../Core/BoxOutlineGeometry","../Core/Cartesian3","../Core/Check","../Core/ColorGeometryInstanceAttribute","../Core/defineProperties","../Core/GeometryInstance","../Core/Matrix3","../Core/Matrix4","../Core/OrientedBoundingBox","./PerInstanceColorAppearance","./Primitive"],function(r,n,o,a,s,e,l,i,u,c,d,h){"use strict";function t(e,t){this._orientedBoundingBox=new c(e,t),this._boundingSphere=r.fromOrientedBoundingBox(this._orientedBoundingBox)}return e(t.prototype,{boundingVolume:{get:function(){return this._orientedBoundingBox}},boundingSphere:{get:function(){return this._boundingSphere}}}),t.prototype.distanceToCamera=function(e){return a.defined("frameState",e),Math.sqrt(this._orientedBoundingBox.distanceSquaredTo(e.camera.positionWC))},t.prototype.intersectPlane=function(e){return a.defined("plane",e),this._orientedBoundingBox.intersectPlane(e)},t.prototype.update=function(e,t){o.clone(e,this._orientedBoundingBox.center),i.clone(t,this._orientedBoundingBox.halfAxes),r.fromOrientedBoundingBox(this._orientedBoundingBox,this._boundingSphere)},t.prototype.createDebugVolume=function(e){a.defined("color",e);var t=new n({minimum:new o(-1,-1,-1),maximum:new o(1,1,1)}),r=u.fromRotationTranslation(this.boundingVolume.halfAxes,this.boundingVolume.center),i=new l({geometry:t,modelMatrix:r,attributes:{color:s.fromColor(e)}});return new h({geometryInstances:i,appearance:new d({translucent:!1,flat:!0}),asynchronous:!1})},t}),define("Scene/Cesium3DTile",["../Core/BoundingSphere","../Core/Cartesian3","../Core/Color","../Core/CullingVolume","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/destroyObject","../Core/getMagic","../Core/Intersect","../Core/JulianDate","../Core/Matrix3","../Core/Matrix4","../Core/Plane","../Core/Rectangle","../Core/Request","../Core/RequestScheduler","../Core/RequestState","../Core/RequestType","../Core/Resource","../Core/RuntimeError","../ThirdParty/when","./Cesium3DTileChildrenVisibility","./Cesium3DTileContentFactory","./Cesium3DTileContentState","./Cesium3DTileOptimizationHint","./Cesium3DTileRefine","./Empty3DTileContent","./SceneMode","./TileBoundingRegion","./TileBoundingSphere","./TileOrientedBoundingBox"],function(s,a,y,l,n,b,e,t,r,c,u,C,d,w,i,h,p,S,f,m,T,g,_,E,v,A,x,P,D,O,I,M,R){"use strict";function L(e,t,r,i){this._tileset=e;var n=(this._header=r).content;this.transform=b(r.transform)?w.unpack(r.transform):w.clone(w.IDENTITY);var o,a,s,l,u,c,d,h,p=b(i)?i.computedTransform:e.modelMatrix,f=w.multiply(p,this.transform,new w);if(this.computedTransform=f,this._boundingVolume=this.createBoundingVolume(r.boundingVolume,f),this._boundingVolume2D=void 0,b(n)&&b(n.boundingVolume)&&(o=this.createBoundingVolume(n.boundingVolume,f)),this._contentBoundingVolume=o,this._contentBoundingVolume2D=void 0,b(r.viewerRequestVolume)&&(a=this.createBoundingVolume(r.viewerRequestVolume,f)),this._viewerRequestVolume=a,this.geometricError=r.geometricError,b(this.geometricError)||(this.geometricError=b(i)?i.geometricError:e._geometricError,L._deprecationWarning("geometricErrorUndefined","Required property geometricError is undefined for this tile. Using parent's geometric error instead.")),s=b(r.refine)?("replace"!==r.refine&&"add"!==r.refine||L._deprecationWarning("lowercase-refine",'This tile uses a lowercase refine "'+r.refine+'". Instead use "'+r.refine.toUpperCase()+'".'),"REPLACE"===r.refine.toUpperCase()?P.REPLACE:P.ADD):b(i)?i.refine:P.REPLACE,this.refine=s,this.children=[],this.parent=i,t=T.createIfNeeded(t),b(n)){var m=n.url;e._brokenUrlWorkaround&&0<m.length&&"/"===m[0]&&(m=n.url=m.substring(1)),u=!1,c=A.UNLOADED,d=t.getDerivedResource({url:m}),h=S.getServerKey(d.getUrlComponent())}else l=new D(e,this),u=!0,c=A.READY;this._content=l,this._contentResource=d,this._contentState=c,this._contentReadyToProcessPromise=void 0,this._contentReadyPromise=void 0,this._expiredContent=void 0,this._serverKey=h,this.hasEmptyContent=u,this.hasRenderableContent=!1,this.hasTilesetContent=!1,this.replacementNode=void 0;var g,_,v=r.expire;b(v)&&(g=v.duration,b(v.date)&&(_=C.fromIso8601(v.date))),this.expireDuration=g,this.expireDate=_,this.selected=!1,this.lastStyleTime=0,this._optimChildrenWithinParent=x.NOT_COMPUTED,this._distanceToCamera=0,this._visibilityPlaneMask=0,this._childrenVisibility=E.VISIBLE,this._lastSelectedFrameNumber=-1,this._screenSpaceError=0,this._screenSpaceErrorComputedFrame=-1,this._finalResolution=!0,this._depth=0,this._centerZDepth=0,this._stackLength=0,this._selectedFrame=-1,this._selectionDepth=0,this._lastSelectionDepth=void 0,this._requestedFrame=void 0,this._lastVisitedFrame=void 0,this._ancestorWithContent=void 0,this._ancestorWithLoadedContent=void 0,this._isClipped=!0,this._debugBoundingVolume=void 0,this._debugContentBoundingVolume=void 0,this._debugViewerRequestVolume=void 0,this._debugColor=y.fromRandom({alpha:1}),this._debugColorizeTiles=!1,this._commandsLength=0,this._color=void 0,this._colorDirty=!1}L._deprecationWarning=t,e(L.prototype,{tileset:{get:function(){return this._tileset}},content:{get:function(){return this._content}},contentBoundingVolume:{get:function(){return n(this._contentBoundingVolume,this._boundingVolume)}},boundingSphere:{get:function(){return this._boundingVolume.boundingSphere}},color:{get:function(){return b(this._color)||(this._color=new y),y.clone(this._color)},set:function(e){this._color=y.clone(e,this._color),this._colorDirty=!0}},contentAvailable:{get:function(){return this.contentReady||b(this._expiredContent)&&this._contentState!==A.FAILED}},contentReady:{get:function(){return this._contentState===A.READY}},contentUnloaded:{get:function(){return this._contentState===A.UNLOADED}},contentExpired:{get:function(){return this._contentState===A.EXPIRED}},contentReadyToProcessPromise:{get:function(){if(b(this._contentReadyToProcessPromise))return this._contentReadyToProcessPromise.promise}},contentReadyPromise:{get:function(){if(b(this._contentReadyPromise))return this._contentReadyPromise.promise}},commandsLength:{get:function(){return this._commandsLength}}});var N=new C;L.prototype.updateExpiration=function(){if(b(this.expireDate)&&this.contentReady&&!this.hasEmptyContent){var e=C.now(N);C.lessThan(this.expireDate,e)&&(this._contentState=A.EXPIRED,this._expiredContent=this._content)}},L.prototype.requestContent=function(){var o=this,a=this._tileset;if(this.hasEmptyContent)return!1;var e=this._contentResource.clone(),t=this.contentExpired;t&&e.addQueryParameters({expired:this.expireDate.toString()});var r,i=new p({throttle:!0,throttleByServer:!0,type:m.TILES3D,priorityFunction:(r=this,function(){return r._distanceToCamera}),serverKey:this._serverKey});e.request=i;var n=e.fetchArrayBuffer();if(!b(n))return!1;var s=this._contentState;this._contentState=A.LOADING,this._contentReadyToProcessPromise=_.defer(),this._contentReadyPromise=_.defer(),t&&(this.expireDate=void 0);var l,u=(l=this,function(e){l._contentState=A.FAILED,l._contentReadyPromise.reject(e),l._contentReadyToProcessPromise.reject(e)});return n.then(function(e){if(!o.isDestroyed()){var t,r=new Uint8Array(e),i=c(r),n=v[i];return a._disableSkipLevelOfDetail=a._disableSkipLevelOfDetail||"vctr"===i||"geom"===i,b(n)?(t=n(a,o,o._contentResource,e,0),o.hasRenderableContent=!0):(t=v.json(a,o,o._contentResource,e,0),o.hasTilesetContent=!0),o._content=t,o._contentState=A.PROCESSING,o._contentReadyToProcessPromise.resolve(t),t.readyPromise.then(function(e){o.isDestroyed()?u():(!function(e){if(b(e.expireDuration)){var t=C.now(N);C.addSeconds(t,e.expireDuration,t),b(e.expireDate)?C.lessThan(e.expireDate,t)&&C.clone(t,e.expireDate):e.expireDate=C.clone(t)}}(o),o.lastStyleTime=0,o._contentState=A.READY,o._contentReadyPromise.resolve(e))})}u()}).otherwise(function(e){if(i.state===f.CANCELLED)return o._contentState=s,--a.statistics.numberOfPendingRequests,void++a.statistics.numberOfAttemptedRequests;u(e)}),!0},L.prototype.unloadContent=function(){this.hasRenderableContent&&(this._content=this._content&&this._content.destroy(),this._contentState=A.UNLOADED,this._contentReadyToProcessPromise=void 0,this._contentReadyPromise=void 0,this.replacementNode=void 0,this.lastStyleTime=0,this._debugColorizeTiles=!1,this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy(),this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy(),this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy())};var k=new s;function F(e,t){if(t.mode!==O.SCENE3D&&!b(e._boundingVolume2D)){var r=e._boundingVolume.boundingSphere,i=s.projectTo2D(r,t.mapProjection,k);e._boundingVolume2D=new M(i.center,i.radius)}return t.mode!==O.SCENE3D?e._boundingVolume2D:e._boundingVolume}L.prototype.visibility=function(e,t){var r=e.cullingVolume,i=F(this,e),n=this._tileset,o=n.clippingPlanes;if(b(o)&&o.enabled){var a=n._root.computedTransform,s=o.computeIntersectionWithBoundingVolume(i,a);if(this._isClipped=s!==u.INSIDE,s===u.OUTSIDE)return l.MASK_OUTSIDE}return r.computeVisibilityWithPlaneMask(i,t)},L.prototype.contentVisibility=function(e){if(!b(this._contentBoundingVolume))return u.INSIDE;var t=e.cullingVolume,r=function(e,t){if(t.mode!==O.SCENE3D&&!b(e._contentBoundingVolume2D)){var r=e._contentBoundingVolume.boundingSphere,i=s.projectTo2D(r,t.mapProjection,k);e._contentBoundingVolume2D=new M(i.center,i.radius)}return t.mode!==O.SCENE3D?e._contentBoundingVolume2D:e._contentBoundingVolume}(this,e),i=this._tileset,n=i.clippingPlanes;if(b(n)&&n.enabled){var o=i._root.computedTransform,a=n.computeIntersectionWithBoundingVolume(r,o);if(this._isClipped=a!==u.INSIDE,a===u.OUTSIDE)return u.OUTSIDE}return t.computeVisibility(r)},L.prototype.distanceToTile=function(e){return F(this,e).distanceToCamera(e)};var o=new a;L.prototype.distanceToTileCenter=function(e){var t=F(this,e).boundingVolume,r=a.subtract(t.center,e.camera.positionWC,o),i=a.magnitude(r);return a.divideByScalar(r,i,r),i*a.dot(e.camera.directionWC,r)},L.prototype.insideViewerRequestVolume=function(e){var t=this._viewerRequestVolume;return!b(t)||0===t.distanceToCamera(e)};var B=new d,U=new a,V=new d,z=new a,q=new h;L.prototype.createBoundingVolume=function(e,t,r){if(!b(e))throw new g("boundingVolume must be defined");if(b(e.box))return function(e,t,r){var i=a.fromElements(e[0],e[1],e[2],z),n=d.fromArray(e,3,V);i=w.multiplyByPoint(t,i,i);var o=w.getRotation(t,B);return n=d.multiply(o,n,n),b(r)?(r.update(i,n),r):new R(i,n)}(e.box,t,r);if(b(e.region))return i=e.region,n=r,o=h.unpack(i,0,q),b(n)?n:new I({rectangle:o,minimumHeight:i[4],maximumHeight:i[5]});var i,n,o;if(b(e.sphere))return function(e,t,r){var i=a.fromElements(e[0],e[1],e[2],z),n=e[3];i=w.multiplyByPoint(t,i,i);var o=w.getScale(t,U);return n*=a.maximumComponent(o),b(r)?(r.update(i,n),r):new M(i,n)}(e.sphere,t,r);throw new g("boundingVolume must contain a sphere, region, or box")};var G=new w;L.prototype.updateTransform=function(e){e=n(e,w.IDENTITY);var t=w.multiply(e,this.transform,G);if(!w.equals(t,this.computedTransform)){w.clone(t,this.computedTransform);var r=this._header,i=this._header.content;this._boundingVolume=this.createBoundingVolume(r.boundingVolume,t,this._boundingVolume),b(this._contentBoundingVolume)&&(this._contentBoundingVolume=this.createBoundingVolume(i.boundingVolume,t,this._contentBoundingVolume)),b(this._viewerRequestVolume)&&(this._viewerRequestVolume=this.createBoundingVolume(r.viewerRequestVolume,t,this._viewerRequestVolume)),this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy(),this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy(),this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy()}},L.prototype.update=function(e,t){var r=t.commandList.length;!function(e,t,r){var i=b(e._header.content)&&b(e._header.content.boundingVolume),n=t.debugShowBoundingVolume||t.debugShowContentBoundingVolume&&!i;if(n){if(!b(e._debugBoundingVolume)){var o=e._finalResolution?i?y.WHITE:y.RED:y.YELLOW;e._debugBoundingVolume=e._boundingVolume.createDebugVolume(o)}e._debugBoundingVolume.update(r)}else!n&&b(e._debugBoundingVolume)&&(e._debugBoundingVolume=e._debugBoundingVolume.destroy());t.debugShowContentBoundingVolume&&i?(b(e._debugContentBoundingVolume)||(e._debugContentBoundingVolume=e._contentBoundingVolume.createDebugVolume(y.BLUE)),e._debugContentBoundingVolume.update(r)):!t.debugShowContentBoundingVolume&&b(e._debugContentBoundingVolume)&&(e._debugContentBoundingVolume=e._debugContentBoundingVolume.destroy()),t.debugShowViewerRequestVolume&&b(e._viewerRequestVolume)?(b(e._debugViewerRequestVolume)||(e._debugViewerRequestVolume=e._viewerRequestVolume.createDebugVolume(y.YELLOW)),e._debugViewerRequestVolume.update(r)):!t.debugShowViewerRequestVolume&&b(e._debugViewerRequestVolume)&&(e._debugViewerRequestVolume=e._debugViewerRequestVolume.destroy());var a=t.debugColorizeTiles&&!e._debugColorizeTiles,s=!t.debugColorizeTiles&&e._debugColorizeTiles;a?(e._debugColorizeTiles=!0,e.color=e._debugColor):s&&(e._debugColorizeTiles=!1,e.color=y.WHITE),e._colorDirty&&(e._colorDirty=!1,e._content.applyDebugSettings(!0,e._color)),s&&t.makeStyleDirty()}(this,e,t),function(e,t,r){var i=e._content,n=e._expiredContent;if(b(n)){if(!e.contentReady)return n.update(t,r);e._expiredContent.destroy(),e._expiredContent=void 0}i.update(t,r)}(this,e,t),this._commandsLength=t.commandList.length-r};var W=[];return L.prototype.process=function(e,t){var r=t.commandList;t.commandList=W,this._content.update(e,t),W.length=0,t.commandList=r},L.prototype.isDestroyed=function(){return!1},L.prototype.destroy=function(){return this._content=this._content&&this._content.destroy(),this._expiredContent=this._expiredContent&&!this._expiredContent.isDestroyed()&&this._expiredContent.destroy(),this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy(),this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy(),this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy(),r(this)},L}),define("Scene/Cesium3DTileContent",["../Core/defineProperties","../Core/DeveloperError"],function(e,r){"use strict";function t(e,t,r,i,n){this.featurePropertiesDirty=!1}return e(t.prototype,{featuresLength:{get:function(){r.throwInstantiationError()}},pointsLength:{get:function(){r.throwInstantiationError()}},trianglesLength:{get:function(){r.throwInstantiationError()}},geometryByteLength:{get:function(){r.throwInstantiationError()}},texturesByteLength:{get:function(){r.throwInstantiationError()}},batchTableByteLength:{get:function(){r.throwInstantiationError()}},innerContents:{get:function(){r.throwInstantiationError()}},readyPromise:{get:function(){r.throwInstantiationError()}},tileset:{get:function(){r.throwInstantiationError()}},tile:{get:function(){r.throwInstantiationError()}},url:{get:function(){r.throwInstantiationError()}},batchTable:{get:function(){r.throwInstantiationError()}}}),t.prototype.hasProperty=function(e,t){r.throwInstantiationError()},t.prototype.getFeature=function(e){r.throwInstantiationError()},t.prototype.applyDebugSettings=function(e,t){r.throwInstantiationError()},t.prototype.applyStyle=function(e,t){r.throwInstantiationError()},t.prototype.update=function(e,t){r.throwInstantiationError()},t.prototype.isDestroyed=function(){r.throwInstantiationError()},t.prototype.destroy=function(){r.throwInstantiationError()},t}),define("Scene/Cesium3DTileOptimizations",["../Core/Cartesian3","../Core/Check","./Cesium3DTileOptimizationHint","./TileBoundingRegion","./TileOrientedBoundingBox"],function(c,d,h,p,f){"use strict";var e={},m=new c;return e.checkChildrenWithinParent=function(e){d.typeOf.object("tile",e);var t=e.children,r=t.length,i=e._boundingVolume;if(i instanceof f||i instanceof p){var n=i._orientedBoundingBox;e._optimChildrenWithinParent=h.USE_OPTIMIZATION;for(var o=0;o<r;++o){var a=t[o]._boundingVolume;if(!(a instanceof f||a instanceof p)){e._optimChildrenWithinParent=h.SKIP_OPTIMIZATION;break}var s=a._orientedBoundingBox,l=c.subtract(s.center,n.center,m),u=c.magnitude(l);if(c.divideByScalar(l,u,l),Math.abs(n.halfAxes[0]*l.x)+Math.abs(n.halfAxes[1]*l.y)+Math.abs(n.halfAxes[2]*l.z)+Math.abs(n.halfAxes[3]*l.x)+Math.abs(n.halfAxes[4]*l.y)+Math.abs(n.halfAxes[5]*l.z)+Math.abs(n.halfAxes[6]*l.x)+Math.abs(n.halfAxes[7]*l.y)+Math.abs(n.halfAxes[8]*l.z)<=Math.abs(s.halfAxes[0]*l.x)+Math.abs(s.halfAxes[1]*l.y)+Math.abs(s.halfAxes[2]*l.z)+Math.abs(s.halfAxes[3]*l.x)+Math.abs(s.halfAxes[4]*l.y)+Math.abs(s.halfAxes[5]*l.z)+Math.abs(s.halfAxes[6]*l.x)+Math.abs(s.halfAxes[7]*l.y)+Math.abs(s.halfAxes[8]*l.z)+u){e._optimChildrenWithinParent=h.SKIP_OPTIMIZATION;break}}}return e._optimChildrenWithinParent===h.USE_OPTIMIZATION},e}),define("Scene/Cesium3DTilesetStatistics",["../Core/defined"],function(p){"use strict";function e(){this.selected=0,this.visited=0,this.numberOfCommands=0,this.numberOfAttemptedRequests=0,this.numberOfPendingRequests=0,this.numberOfTilesProcessing=0,this.numberOfTilesWithContentReady=0,this.numberOfTilesTotal=0,this.numberOfFeaturesSelected=0,this.numberOfFeaturesLoaded=0,this.numberOfPointsSelected=0,this.numberOfPointsLoaded=0,this.numberOfTrianglesSelected=0,this.numberOfTilesStyled=0,this.numberOfFeaturesStyled=0,this.numberOfTilesCulledWithChildrenUnion=0,this.geometryByteLength=0,this.texturesByteLength=0,this.batchTableByteLength=0}function f(e,t,r,i){var n=t.innerContents,o=t.pointsLength,a=t.trianglesLength,s=t.featuresLength,l=t.geometryByteLength,u=t.texturesByteLength,c=t.batchTableByteLength;if(i?(e.numberOfFeaturesLoaded+=r?-s:s,e.numberOfPointsLoaded+=r?-o:o,e.geometryByteLength+=r?-l:l,e.texturesByteLength+=r?-u:u,e.batchTableByteLength+=r?-c:c):(e.numberOfFeaturesSelected+=r?-s:s,e.numberOfPointsSelected+=r?-o:o,e.numberOfTrianglesSelected+=r?-a:a),p(n))for(var d=n.length,h=0;h<d;++h)f(e,n[h],r,i)}return e.prototype.clear=function(){this.selected=0,this.visited=0,this.numberOfCommands=0,this.numberOfAttemptedRequests=0,this.numberOfFeaturesSelected=0,this.numberOfPointsSelected=0,this.numberOfTrianglesSelected=0,this.numberOfTilesStyled=0,this.numberOfFeaturesStyled=0,this.numberOfTilesCulledWithChildrenUnion=0},e.prototype.incrementSelectionCounts=function(e){f(this,e,!1,!1)},e.prototype.incrementLoadCounts=function(e){f(this,e,!1,!0)},e.prototype.decrementLoadCounts=function(e){f(this,e,!0,!0)},e.clone=function(e,t){t.selected=e.selected,t.visited=e.visited,t.numberOfCommands=e.numberOfCommands,t.selected=e.selected,t.numberOfAttemptedRequests=e.numberOfAttemptedRequests,t.numberOfPendingRequests=e.numberOfPendingRequests,t.numberOfTilesProcessing=e.numberOfTilesProcessing,t.numberOfTilesWithContentReady=e.numberOfTilesWithContentReady,t.numberOfTilesTotal=e.numberOfTilesTotal,t.numberOfFeaturesSelected=e.numberOfFeaturesSelected,t.numberOfFeaturesLoaded=e.numberOfFeaturesLoaded,t.numberOfPointsSelected=e.numberOfPointsSelected,t.numberOfPointsLoaded=e.numberOfPointsLoaded,t.numberOfTrianglesSelected=e.numberOfTrianglesSelected,t.numberOfTilesStyled=e.numberOfTilesStyled,t.numberOfFeaturesStyled=e.numberOfFeaturesStyled,t.numberOfTilesCulledWithChildrenUnion=e.numberOfTilesCulledWithChildrenUnion,t.geometryByteLength=e.geometryByteLength,t.texturesByteLength=e.texturesByteLength,t.batchTableByteLength=e.batchTableByteLength},e}),define("Scene/Cesium3DTilesetTraversal",["../Core/CullingVolume","../Core/defined","../Core/freezeObject","../Core/Intersect","../Core/ManagedArray","../Core/Math","../Core/OrthographicFrustum","./Cesium3DTileChildrenVisibility","./Cesium3DTileRefine","./SceneMode"],function(u,f,e,n,t,p,m,c,g,_){"use strict";var r={};var v=[];var y=[],b=[];function C(e,t,r){if(t.contentAvailable&&(t._visibilityPlaneMask===u.MASK_INSIDE||t.contentVisibility(r)!==n.OUTSIDE)){e._selectedTiles.push(t);var i=t.content;i.featurePropertiesDirty?(i.featurePropertiesDirty=!1,t.lastStyleTime=0,e._selectedTilesToStyle.push(t)):t._lastSelectedFrameNumber===r.frameNumber-1&&0!==t.lastStyleTime||e._selectedTilesToStyle.push(t),t._lastSelectedFrameNumber=r.frameNumber}}function w(e,t){return 0===t._distanceToCamera&&0===e._distanceToCamera?t._centerZDepth-e._centerZDepth:t._distanceToCamera-e._distanceToCamera}var d=e([]);function i(){this.tileset=void 0,this.frameState=void 0,this.outOfCore=void 0,this.stack=new t,this.leaves=new t,this.baseScreenSpaceError=void 0,this.internalDFS=new o}function h(e,t,r,i){if(I(t)&&e._desiredTiles.push(t),t.hasTilesetContent&&t.contentExpired)return!1;if(t._screenSpaceError<=r&&!t.hasTilesetContent)return S(t,i),!1;var n=S(t,i),o=t.refine===g.ADD,a=t.refine===g.REPLACE&&0!=(n&c.VISIBLE_IN_REQUEST_VOLUME);return o||a||t.hasTilesetContent||!f(t._ancestorWithContent)}function o(){this.tileset=void 0,this.frameState=void 0,this.outOfCore=void 0,this.baseScreenSpaceError=void 0,this.stack=new t,this.allLoaded=void 0}function a(e){this.tileset=void 0,this.frameState=void 0,this.outOfCore=void 0,this.queue1=new t,this.queue2=new t,this.internalDFS=new s(e.selectionHeuristic),this.maxChildrenLength=0,this.scratchQueue=new t}function s(e){this.selectionHeuristic=e,this.tileset=void 0,this.frameState=void 0,this.outOfCore=void 0,this.root=void 0,this.queue=void 0,this.stack=new t}function S(e,t){if(T(e,t))return e._childrenVisibility;var r=e.children;return function(e,t){for(var r=e.length,i=0;i<r;++i){var n=e[i];n.updateTransform(t)}}(r,e.computedTransform),function(e,t){for(var r=e.length,i=0;i<r;++i){var n=e[i];n._distanceToCamera=n.distanceToTile(t),n._centerZDepth=n.distanceToTileCenter(t)}}(r,t),function(e,t){for(var r=c.NONE,i=e.children,n=i.length,o=e._visibilityPlaneMask,a=0;a<n;++a){var s=i[a],l=s.visibility(t,o);P(l)&&(r|=c.VISIBLE),s.insideViewerRequestVolume(t)?(r|=c.IN_REQUEST_VOLUME,P(l)&&(r|=c.VISIBLE_IN_REQUEST_VOLUME)):(P(l)&&(r|=c.VISIBLE_NOT_IN_REQUEST_VOLUME),l=u.MASK_OUTSIDE),s._visibilityPlaneMask=l}return e._childrenVisibility=r}(e,t)}function T(e,t){return e._lastVisitedFrame===t.frameNumber}function l(e,t,r,i){var n,o;++e._statistics.visited,t.selected=!1,t._finalResolution=!1,o=r,(n=t)._screenSpaceErrorComputedFrame!==o.frameNumber&&(n._screenSpaceErrorComputedFrame=o.frameNumber,n._screenSpaceError=x(n._tileset,n.geometricError,n,o)),E(e,t,i),t.updateExpiration(),t._ancestorWithContent=void 0,t._ancestorWithLoadedContent=void 0;var a=t.parent;if(f(a)){var s=a.refine===g.REPLACE;t._ancestorWithContent=s&&a.hasRenderableContent?a:a._ancestorWithContent,t._ancestorWithLoadedContent=s&&a.hasRenderableContent&&a.contentAvailable?a:a._ancestorWithLoadedContent}}function E(e,t,r){if(r){var i=t.replacementNode;f(i)&&e._replacementList.splice(e._replacementSentinel,i)}}function A(e,t,r,i){var n,o,a;(t.contentUnloaded||t.contentExpired)&&t._requestedFrame!==r.frameNumber&&(i&&(n=e,a=r,f((o=t).parent)&&o.parent.refine===g.ADD&&!D(n,o,a))||(t._requestedFrame=r.frameNumber,e._requestedTiles.push(t)))}function x(e,t,r,i){if(0===t)return 0;var n,o=i.camera,a=o.frustum,s=i.context,l=s.drawingBufferHeight;if(i.mode===_.SCENE2D||a instanceof m){f(a._offCenterFrustum)&&(a=a._offCenterFrustum);var u=s.drawingBufferWidth;n=t/(Math.max(a.top-a.bottom,a.right-a.left)/Math.max(u,l))}else{var c=Math.max(r._distanceToCamera,p.EPSILON7);if(n=t*l/(c*o.frustum.sseDenominator),e.dynamicScreenSpaceError){var d=e._dynamicScreenSpaceErrorComputedDensity,h=e.dynamicScreenSpaceErrorFactor;n-=p.fog(c,d)*h}}return n}function P(e){return e!==u.MASK_OUTSIDE}function D(e,t,r){var i=e._maximumScreenSpaceError,n=t.parent;if(!f(n))return P(t._visibilityPlaneMask);var o=n.refine===g.ADD&&n._screenSpaceError>i;return P(t._visibilityPlaneMask)&&(!o||x(e,n.geometricError,t,r)>i)}function O(e){return e.refine===g.ADD||0===e.children.length||e._childrenVisibility&0!==c.VISIBLE}function I(e){return e.refine===g.ADD&&e.hasRenderableContent}function M(e,t){var r=t.stack;!f(e)||f(t.shouldVisit)&&!t.shouldVisit(e)||r.push(e);for(var i=0;0<r.length;){i=Math.max(i,r.length);var n=r.pop();t.visitStart(n);for(var o=t.getChildren(n),a=!f(o.get),s=o.length,l=0;l<s;++l){var u=a?o[l]:o.get(l);f(t.shouldVisit)&&!t.shouldVisit(u)||r.push(u)}0===s&&f(t.leafHandler)&&t.leafHandler(n),t.visitEnd(n)}r.trim(i)}return i.prototype.execute=function(e,t,r,i,n){this.tileset=e,this.frameState=i,this.outOfCore=n,this.leaves.length=0,this.baseScreenSpaceError=Math.max(r,this.tileset._maximumScreenSpaceError),this.internalDFS.tileset=this.tileset,this.internalDFS.frameState=this.frameState,this.internalDFS.outOfCore=this.outOfCore,this.internalDFS.baseScreenSpaceError=this.baseScreenSpaceError,M(t,this)},i.prototype.visitStart=function(e){T(e,this.frameState)||l(this.tileset,e,this.frameState,this.outOfCore)},i.prototype.visitEnd=function(e){e._lastVisitedFrame=this.frameState.frameNumber},i.prototype.getChildren=function(e){var t=this.tileset,r=this.outOfCore,i=this.frameState;if(!h(t,e,this.baseScreenSpaceError,i))return d;for(var n=e.children,o=n.length,a=!0,s=e.refine===g.REPLACE&&e.hasRenderableContent,l=0;l<o;++l){var u=n[l];A(t,u,i,!0),E(t,u,r),s&&(a=u.hasEmptyContent?a&&this.internalDFS.execute(u):a&&u.contentAvailable)}return a?n:d},i.prototype.shouldVisit=function(e){return P(e._visibilityPlaneMask)},i.prototype.leafHandler=function(e){if(this.tileset._skipLevelOfDetail||!I(e)){if(e.refine===g.REPLACE&&!O(e))return void++this.tileset._statistics.numberOfTilesCulledWithChildrenUnion;this.leaves.push(e)}},o.prototype.execute=function(e){return this.allLoaded=!0,M(e,this),this.allLoaded},o.prototype.visitStart=function(e){T(e,this.frameState)||l(this.tileset,e,this.frameState,this.outOfCore)},o.prototype.visitEnd=i.prototype.visitEnd,o.prototype.shouldVisit=function(e){return!e.hasRenderableContent&&P(e._visibilityPlaneMask)},o.prototype.getChildren=function(e){var t=this.tileset,r=this.frameState,i=this.outOfCore;if(!h(t,e,this.baseScreenSpaceError,r))return d;for(var n=e.children,o=n.length,a=0;a<o;++a){var s=n[a];A(t,s,r,!0),E(t,s,i),e.contentAvailable||(this.allLoaded=!1)}return n},o.prototype.updateAndCheckChildren=i.prototype.updateAndCheckChildren,a.prototype.execute=function(e,t,r,i){this.tileset=e,this.frameState=r,this.outOfCore=i,this.internalDFS.frameState=r,this.internalDFS.outOfCore=i,this.maxChildrenLength=0,function(e,t){var r=t.queue1,i=t.queue2;!f(e)||f(t.shouldVisit)&&!t.shouldVisit(e)||r.push(e);var n=0;for(;0<r.length;){var o=r.length;n=Math.max(n,o);for(var a=0;a<o;++a){var s=r.get(a);t.visitStart(s);for(var l=t.getChildren(s),u=!f(l.get),c=l.length,d=0;d<c;++d){var h=u?l[d]:l.get(d);f(t.shouldVisit)&&!t.shouldVisit(h)||i.push(h)}0===c&&f(t.leafHandler)&&t.leafHandler(s),t.visitEnd(s)}r.length=0;var p=r;r=i,i=p,t.queue1=r,t.queue2=i}r.length=0,i.length=0,r.trim(n),i.trim(n)}(t,this),this.queue1.length=0,this.queue2.length=0,this.scratchQueue.length=0,this.scratchQueue.trim(this.maxChildrenLength)},a.prototype.visitStart=function(e){T(e,this.frameState)||l(this.tileset,e,this.frameState,this.outOfCore)},a.prototype.visitEnd=i.prototype.visitEnd,a.prototype.getChildren=function(e){return this.scratchQueue.length=0,this.internalDFS.execute(e,this.scratchQueue),this.maxChildrenLength=Math.max(this.maxChildrenLength,this.scratchQueue.length),this.scratchQueue},a.prototype.leafHandler=function(e){I(e)||T(e,this.frameState)||this.tileset._desiredTiles.push(e)},s.prototype.execute=function(e,t){this.tileset=e._tileset,this.root=e,this.queue=t,M(e,this)},s.prototype.visitStart=function(e){T(e,this.frameState)||l(this.tileset,e,this.frameState,this.outOfCore)},s.prototype.visitEnd=i.prototype.visitEnd,s.prototype.getChildren=function(e){var t=this.tileset,r=t._maximumScreenSpaceError;if(e.hasTilesetContent&&e.contentExpired)return d;if(!e.hasTilesetContent){if(e.refine===g.ADD&&(A(t,e,this.frameState,!0),I(e)&&t._desiredTiles.push(e)),e._screenSpaceError<=r)return S(e,this.frameState),d;if(!e.hasEmptyContent&&e.contentUnloaded&&f(e._ancestorWithLoadedContent)&&this.selectionHeuristic(t,e._ancestorWithLoadedContent,e))return S(e,this.frameState),d}var i=S(e,this.frameState),n=e.refine===g.ADD&&e._screenSpaceError>r,o=e.refine===g.REPLACE&&0!=(i&c.VISIBLE_IN_REQUEST_VOLUME);if(i&c.VISIBLE_NOT_IN_REQUEST_VOLUME&&e.refine===g.REPLACE&&this.tileset._desiredTiles.push(e),n||o||e.hasTilesetContent){for(var a=e.children,s=a.length,l=0;l<s;++l)E(t,a[l],this.outOfCore);return a}return d},s.prototype.shouldVisit=function(e){return D(this.tileset,e,this.frameState)},s.prototype.leafHandler=function(e){if(e!==this.root){if(e.refine===g.REPLACE&&!O(e))return void++this.tileset._statistics.numberOfTilesCulledWithChildrenUnion;if(!e.hasEmptyContent)if(this.tileset.loadSiblings)for(var t=e.parent.children,r=t.length,i=0;i<r;++i)A(this.tileset,t[i],this.frameState,!1),E(this.tileset,t[i],this.outOfCore);else A(this.tileset,e,this.frameState,!0),E(this.tileset,e,this.outOfCore);this.queue.push(e)}else I(e)||this.tileset._desiredTiles.push(e)},r.selectTiles=function(e,t,r){if(!e.debugFreezeFrame){var i=e._maximumScreenSpaceError;e._desiredTiles.length=0,e._selectedTiles.length=0,e._requestedTiles.length=0,e._selectedTilesToStyle.length=0,e._hasMixedContent=!1;var n=e._replacementList;n.splice(n.tail,e._replacementSentinel);var o=e._root;if(o.updateTransform(e._modelMatrix),o.insideViewerRequestVolume(t)&&(o._distanceToCamera=o.distanceToTile(t),!(x(e,e._geometricError,o,t)<=i)&&(o._visibilityPlaneMask=o.visibility(t,u.MASK_INDETERMINATE),o._visibilityPlaneMask!==u.MASK_OUTSIDE))){if(A(e,o,t,!0),e._skipLevelOfDetail)e.immediatelyLoadDesiredLevelOfDetail?e._skipTraversal.execute(e,o,t,r):(e._baseTraversal.leaves=e._skipTraversal.queue1,e._baseTraversal.execute(e,o,e.baseScreenSpaceError,t,r),e._skipTraversal.execute(e,void 0,t,r));else{e._baseTraversal.execute(e,o,i,t,r);for(var a=e._baseTraversal.leaves,s=a.length,l=0;l<s;++l)e._desiredTiles.push(a.get(l))}!function(e,t,r){for(var i=e._desiredTiles,n=i.length,o=0;o<n;++o){var a=i.get(o);if(I(a))a.selected=!0,a._selectedFrame=t.frameNumber;else{var s=a._ancestorWithLoadedContent;if(a.hasRenderableContent&&a.contentAvailable&&(s=a),f(s))s.selected=!0,s._selectedFrame=t.frameNumber;else for(v.push(a);0<v.length;)for(var l=v.pop(),u=l.children,c=u.length,d=0;d<c;++d){var h=u[d];E(e,h,r),h.contentAvailable&&(h.selected=!0,h._finalResolution=!0,h._selectedFrame=t.frameNumber),h._depth-a._depth<2&&(h.contentAvailable&&h.refine!==g.ADD||v.push(h))}}}}(e,t,r),function(e,t,r){var i,n=y,o=b;for(n.push(t);0<n.length||0<o.length;){if(0<o.length){var a=o[o.length-1];if(a._stackLength===n.length){o.pop(),a===i&&(a._finalResolution=!0),C(e,a,r);continue}}var s=n.pop();if(f(s)&&T(s,r)){var l=s.selected&&s._selectedFrame===r.frameNumber&&s.hasRenderableContent,u=s.children,c=u.length;if(u.sort(w),l)if(s.refine===g.ADD)s._finalResolution=!0,C(e,s,r);else{if(s._selectionDepth=o.length,0<s._selectionDepth&&(e._hasMixedContent=!0),i=s,0===c){s._finalResolution=!0,C(e,s,r);continue}o.push(s),s._stackLength=n.length}for(var d=0;d<c;++d){var h=u[d];n.push(h)}}}}(e,o,t),e._desiredTiles.trim()}}},r.BaseTraversal=i,r.SkipTraversal=a,r}),define("Scene/Cesium3DTileStyleEngine",["../Core/defined","../Core/defineProperties"],function(c,e){"use strict";function t(){this._style=void 0,this._styleDirty=!1,this._lastStyleTime=0}return e(t.prototype,{style:{get:function(){return this._style},set:function(e){this._style=e,this._styleDirty=!0}}}),t.prototype.makeDirty=function(){this._styleDirty=!0},t.prototype.applyStyle=function(e,t){if(e.ready&&(!c(this._style)||this._style.ready)){var r=this._styleDirty;t.passes.render&&(this._styleDirty=!1),r&&++this._lastStyleTime;for(var i=this._lastStyleTime,n=e._statistics,o=r?e._selectedTiles:e._selectedTilesToStyle,a=o.length,s=0;s<a;++s){var l=o[s];if(l.selected&&l.lastStyleTime!==i){var u=l.content;l.lastStyleTime=i,u.applyStyle(t,this._style),n.numberOfFeaturesStyled+=u.featuresLength,++n.numberOfTilesStyled}}}},t}),define("Shaders/PostProcessFilters/PointCloudEyeDomeLighting",[],function(){"use strict";return"#extension GL_EXT_frag_depth : enable\nuniform sampler2D u_pointCloud_colorTexture;\nuniform sampler2D u_pointCloud_ecAndLogDepthTexture;\nuniform vec3 u_distancesAndEdlStrength;\nvarying vec2 v_textureCoordinates;\nvec2 neighborContribution(float log2Depth, vec2 padding)\n{\nvec2 depthAndLog2Depth = texture2D(u_pointCloud_ecAndLogDepthTexture, v_textureCoordinates + padding).zw;\nif (depthAndLog2Depth.x == 0.0)\n{\nreturn vec2(0.0);\n}\nelse\n{\nreturn vec2(max(0.0, log2Depth - depthAndLog2Depth.y), 1.0);\n}\n}\nvoid main()\n{\nvec4 ecAlphaDepth = texture2D(u_pointCloud_ecAndLogDepthTexture, v_textureCoordinates);\nif (length(ecAlphaDepth.xyz) < czm_epsilon7)\n{\ndiscard;\n}\nelse\n{\nvec4 color = texture2D(u_pointCloud_colorTexture, v_textureCoordinates);\nfloat distX = u_distancesAndEdlStrength.x;\nfloat distY = u_distancesAndEdlStrength.y;\nvec2 responseAndCount = vec2(0.0);\nresponseAndCount += neighborContribution(ecAlphaDepth.a, vec2(0, distY));\nresponseAndCount += neighborContribution(ecAlphaDepth.a, vec2(distX, 0));\nresponseAndCount += neighborContribution(ecAlphaDepth.a, vec2(0, -distY));\nresponseAndCount += neighborContribution(ecAlphaDepth.a, vec2(-distX, 0));\nfloat response = responseAndCount.x / responseAndCount.y;\nfloat shade = exp(-response * 300.0 * u_distancesAndEdlStrength.z);\ncolor.rgb *= shade;\ngl_FragColor = vec4(color);\ngl_FragDepthEXT = czm_eyeToWindowCoordinates(vec4(ecAlphaDepth.xyz, 1.0)).z;\n}\n}\n"}),define("Scene/PointCloudEyeDomeLighting",["../Core/Cartesian3","../Core/clone","../Core/Color","../Core/combine","../Core/ComponentDatatype","../Core/defined","../Core/destroyObject","../Core/FeatureDetection","../Core/Geometry","../Core/GeometryAttribute","../Core/PixelFormat","../Core/PrimitiveType","../Renderer/BufferUsage","../Renderer/ClearCommand","../Renderer/DrawCommand","../Renderer/Framebuffer","../Renderer/Pass","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/Sampler","../Renderer/ShaderSource","../Renderer/ShaderProgram","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","../Renderer/VertexArray","../Scene/BlendEquation","../Scene/BlendFunction","../Scene/BlendingState","../Scene/StencilFunction","../Scene/StencilOperation","../Shaders/PostProcessFilters/PointCloudEyeDomeLighting"],function(e,t,y,r,i,b,n,C,o,a,w,p,s,S,f,T,E,A,x,l,u,c,P,d,h,m,g,_,v,D,O,I,M){"use strict";function R(){this._framebuffer=void 0,this._colorTexture=void 0,this._ecAndLogDepthTexture=void 0,this._depthTexture=void 0,this._drawCommand=void 0,this._clearCommand=void 0,this._strength=1,this._radius=1}function L(){return new l({wrapS:m.CLAMP_TO_EDGE,wrapT:m.CLAMP_TO_EDGE,minificationFilter:h.NEAREST,magnificationFilter:d.NEAREST})}function N(e){var t=e._framebuffer;b(t)&&(e._colorTexture.destroy(),e._ecAndLogDepthTexture.destroy(),e._depthTexture.destroy(),t.destroy(),e._framebuffer=void 0,e._colorTexture=void 0,e._ecAndLogDepthTexture=void 0,e._depthTexture=void 0,e._drawCommand=void 0,e._clearCommand=void 0)}var k=new e;function F(e,t){var r,i,n,o,a,s,l,u,c,d,h,p,f=t.drawingBufferWidth,m=t.drawingBufferHeight,g=e._colorTexture,_=!1,v=b(g)&&(g.width!==f||g.height!==m);return b(g)&&!v||(N(e),s=e,u=(l=t).drawingBufferWidth,c=l.drawingBufferHeight,d=new P({context:l,width:u,height:c,pixelFormat:w.RGBA,pixelDatatype:C.isFirefox()?A.FLOAT:A.UNSIGNED_BYTE,sampler:L()}),h=new P({context:l,width:u,height:c,pixelFormat:w.RGBA,pixelDatatype:A.FLOAT,sampler:L()}),p=new P({context:l,width:u,height:c,pixelFormat:w.DEPTH_COMPONENT,pixelDatatype:A.UNSIGNED_INT,sampler:L()}),s._framebuffer=new T({context:l,colorTextures:[d,h],depthTexture:p,destroyAttachments:!1}),s._colorTexture=d,s._ecAndLogDepthTexture=h,s._depthTexture=p,r=e,i=t,n=M,o={u_pointCloud_colorTexture:function(){return r._colorTexture},u_pointCloud_ecAndLogDepthTexture:function(){return r._ecAndLogDepthTexture},u_distancesAndEdlStrength:function(){return k.x=r._radius/i.drawingBufferWidth,k.y=r._radius/i.drawingBufferHeight,k.z=r._strength,k}},a=x.fromCache({blending:D.ALPHA_BLEND,depthMask:!0,depthTest:{enabled:!0}}),r._drawCommand=i.createViewportQuadCommand(n,{uniformMap:o,renderState:a,pass:E.CESIUM_3D_TILE,owner:r}),r._clearCommand=new S({framebuffer:r._framebuffer,color:new y(0,0,0,0),depth:1,renderState:x.fromCache(),pass:E.CESIUM_3D_TILE,owner:r}),_=!0),_}function B(e){return e.floatingPointTexture&&e.drawBuffers&&e.fragmentDepth}function U(e,t){var r=e.shaderCache.getDerivedShaderProgram(t,"EC");if(!b(r)){var i=t._attributeLocations,n=t.vertexShaderSource.clone(),o=t.fragmentShaderSource.clone();n.sources=n.sources.map(function(e){return e=u.replaceMain(e,"czm_point_cloud_post_process_main")}),o.sources=o.sources.map(function(e){return e=(e=u.replaceMain(e,"czm_point_cloud_post_process_main")).replace(/gl_FragColor/g,"gl_FragData[0]")}),n.sources.push("varying vec3 v_positionEC; \nvoid main() \n{ \n    czm_point_cloud_post_process_main(); \n    v_positionEC = (czm_inverseProjection * gl_Position).xyz; \n}"),o.sources.unshift("#extension GL_EXT_draw_buffers : enable \n"),o.sources.push("varying vec3 v_positionEC; \nvoid main() \n{ \n    czm_point_cloud_post_process_main(); \n    gl_FragData[1] = vec4(v_positionEC, log2(-v_positionEC.z)); \n}"),r=e.shaderCache.createDerivedShaderProgram(t,"EC",{vertexShaderSource:n,fragmentShaderSource:o,attributeLocations:i})}return r}return R.isSupported=B,R.prototype.update=function(e,t,r){var i=e.passes,n=i.pick&&!i.render;if(B(e.context)&&!n){this._strength=r.pointCloudShading.eyeDomeLightingStrength,this._radius=r.pointCloudShading.eyeDomeLightingRadius;var o,a=F(this,e.context),s=e.commandList,l=s.length;for(o=t;o<l;++o){var u=s[o];if(u.primitiveType===p.POINTS&&u.pass!==E.TRANSLUCENT){var c=u.derivedCommands.pointCloudProcessor;(!b(c)||u.dirty||a||c.framebuffer!==this._framebuffer)&&(c=f.shallowClone(u),(u.derivedCommands.pointCloudProcessor=c).framebuffer=this._framebuffer,c.shaderProgram=U(e.context,u.shaderProgram),c.castShadows=!1,c.receiveShadows=!1),s[o]=c}}var d=this._clearCommand,h=this._drawCommand;s.push(h),s.push(d)}},R.prototype.isDestroyed=function(){return!1},R.prototype.destroy=function(){return N(this),n(this)},R}),define("Scene/PointCloudShading",["../Core/defaultValue","./PointCloudEyeDomeLighting"],function(r,t){"use strict";function e(e){var t=r(e,{});this.attenuation=r(t.attenuation,!1),this.geometricErrorScale=r(t.geometricErrorScale,1),this.maximumAttenuation=t.maximumAttenuation,this.baseResolution=t.baseResolution,this.eyeDomeLighting=r(t.eyeDomeLighting,!0),this.eyeDomeLightingStrength=r(t.eyeDomeLightingStrength,1),this.eyeDomeLightingRadius=r(t.eyeDomeLightingRadius,1)}return e.isSupported=function(e){return t.isSupported(e.context)},e}),define("Scene/Cesium3DTileset",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/destroyObject","../Core/DeveloperError","../Core/DoublyLinkedList","../Core/Ellipsoid","../Core/Event","../Core/getBaseUri","../Core/getExtensionFromUri","../Core/getMagic","../Core/isDataUri","../Core/JulianDate","../Core/ManagedArray","../Core/Math","../Core/Matrix4","../Core/Resource","../Core/RuntimeError","../Renderer/ClearCommand","../Renderer/Pass","../ThirdParty/when","./Axis","./Cesium3DTile","./Cesium3DTileColorBlendMode","./Cesium3DTileOptimizations","./Cesium3DTilesetStatistics","./Cesium3DTilesetTraversal","./Cesium3DTileStyleEngine","./ClassificationType","./LabelCollection","./PointCloudShading","./PointCloudEyeDomeLighting","./SceneMode","./ShadowMode","./TileBoundingRegion","./TileBoundingSphere","./TileOrientedBoundingBox"],function(m,S,T,n,g,_,e,s,o,t,l,u,c,r,i,d,a,v,h,E,A,p,y,f,b,C,w,x,P,D,O,I,M,R,L,N,k,F,B,U,V,z){"use strict";function q(e){e=g(e,g.EMPTY_OBJECT),n.defined("options.url",e.url);var t,r=p.createIfNeeded(e.url),o=r;t="json"===r.extension?r.getBaseUri(!0):r.isDataUri?"":(r.appendForwardSlash(),o=r.getDerivedResource({url:"tileset.json"}),r.url),this._url=r.url,this._tilesetUrl=o.url,this._basePath=t,this._root=void 0,this._asset=void 0,this._properties=void 0,this._geometricError=void 0,this._gltfUpAxis=void 0,this._processingQueue=[],this._selectedTiles=[],this._requestedTiles=[],this._desiredTiles=new h,this._selectedTilesToStyle=[],this._loadTimestamp=void 0,this._timeSinceLoad=0;var i=new l;this._replacementList=i,this._replacementSentinel=i.add(),this._trimTiles=!1,this._cullWithChildrenBounds=g(e.cullWithChildrenBounds,!0),this._hasMixedContent=!1,this._baseTraversal=new I.BaseTraversal,this._skipTraversal=new I.SkipTraversal({selectionHeuristic:Z}),this._backfaceCommands=new h,this._maximumScreenSpaceError=g(e.maximumScreenSpaceError,16),this._maximumMemoryUsage=g(e.maximumMemoryUsage,512),this._styleEngine=new M,this._modelMatrix=_(e.modelMatrix)?A.clone(e.modelMatrix):A.clone(A.IDENTITY),this._statistics=new O,this._statisticsLastColor=new O,this._statisticsLastPick=new O,this._tilesLoaded=!1,this._tileDebugLabels=void 0,this._readyPromise=C.defer(),this._classificationType=e.classificationType,this._ellipsoid=g(e.ellipsoid,u.WGS84),this.dynamicScreenSpaceError=g(e.dynamicScreenSpaceError,!1),this.dynamicScreenSpaceErrorDensity=.00278,this.dynamicScreenSpaceErrorFactor=4,this.dynamicScreenSpaceErrorHeightFalloff=.25,this._dynamicScreenSpaceErrorComputedDensity=0,this.shadows=g(e.shadows,B.ENABLED),this.show=g(e.show,!0),this.colorBlendMode=P.HIGHLIGHT,this.colorBlendAmount=.5,this.pointCloudShading=new N(e.pointCloudShading),this._pointCloudEyeDomeLighting=new k,this.loadProgress=new c,this.allTilesLoaded=new c,this.tileLoad=new c,this.tileUnload=new c,this.tileFailed=new c,this.tileVisible=new c,this.skipLevelOfDetail=g(e.skipLevelOfDetail,!0),this._skipLevelOfDetail=this.skipLevelOfDetail,this._disableSkipLevelOfDetail=!1,this.baseScreenSpaceError=g(e.baseScreenSpaceError,1024),this.skipScreenSpaceErrorFactor=g(e.skipScreenSpaceErrorFactor,16),this.skipLevels=g(e.skipLevels,1),this.immediatelyLoadDesiredLevelOfDetail=g(e.immediatelyLoadDesiredLevelOfDetail,!1),this.loadSiblings=g(e.loadSiblings,!1),this.clippingPlanes=e.clippingPlanes,this.debugFreezeFrame=g(e.debugFreezeFrame,!1),this.debugColorizeTiles=g(e.debugColorizeTiles,!1),this.debugWireframe=g(e.debugWireframe,!1),this.debugShowBoundingVolume=g(e.debugShowBoundingVolume,!1),this.debugShowContentBoundingVolume=g(e.debugShowContentBoundingVolume,!1),this.debugShowViewerRequestVolume=g(e.debugShowViewerRequestVolume,!1),this._tileDebugLabels=void 0,this.debugPickedTileLabelOnly=!1,this.debugPickedTile=void 0,this.debugPickPosition=void 0,this.debugShowGeometricError=g(e.debugShowGeometricError,!1),this.debugShowRenderingStatistics=g(e.debugShowRenderingStatistics,!1),this.debugShowMemoryUsage=g(e.debugShowMemoryUsage,!1),this.debugShowUrl=g(e.debugShowUrl,!1),this._brokenUrlWorkaround=!1;var a=this;q.loadJson(o).then(function(e){return i=a,t=o,r=function e(t){var r=t.content;if(_(r)&&_(r.url))return G.test(r.url)?r.url:"";var i=t.children;if(_(i))for(var n=i.length,o=0;o<n;++o){var a=e(i[o]);if(_(a))return a}}((n=e).root),_(r)&&0!==r.length?t.getDerivedResource({url:r}).fetchArrayBuffer().then(function(e){var t=new Uint8Array(e),r=d(t);return i._brokenUrlWorkaround="b3dm"!==r,n}).otherwise(function(){return i._brokenUrlWorkaround=!0,n}):n;var i,t,n,r}).then(function(e){a._brokenUrlWorkaround&&s("Cesium3DTileset.leadingSlash","Having a leading slash in a tile URL that is actually relative to the tileset.json is deprecated."),a._root=a.loadTileset(o,e);var t=_(e.asset.gltfUpAxis)?w.fromName(e.asset.gltfUpAxis):w.Y;a._asset=e.asset,a._properties=e.properties,a._geometricError=e.geometricError,a._gltfUpAxis=t,a._readyPromise.resolve(a)}).otherwise(function(e){a._readyPromise.reject(e)})}var G=/^\/.+\.b3dm$/;e(q.prototype,{asset:{get:function(){if(!this.ready)throw new t("The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.");return this._asset}},properties:{get:function(){if(!this.ready)throw new t("The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.");return this._properties}},ready:{get:function(){return _(this._root)}},readyPromise:{get:function(){return this._readyPromise.promise}},tilesLoaded:{get:function(){return this._tilesLoaded}},url:{get:function(){return this._url}},basePath:{get:function(){return s("Cesium3DTileset.basePath","Cesium3DTileset.basePath has been deprecated. All tiles are relative to the url of the tileset.json that contains them. Use the url property instead."),this._basePath}},style:{get:function(){return this._styleEngine.style},set:function(e){this._styleEngine.style=e}},maximumScreenSpaceError:{get:function(){return this._maximumScreenSpaceError},set:function(e){n.typeOf.number.greaterThanOrEquals("maximumScreenSpaceError",e,0),this._maximumScreenSpaceError=e}},maximumMemoryUsage:{get:function(){return this._maximumMemoryUsage},set:function(e){n.typeOf.number.greaterThanOrEquals("value",e,0),this._maximumMemoryUsage=e}},boundingSphere:{get:function(){if(!this.ready)throw new t("The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.");return this._root.boundingSphere}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix=A.clone(e,this._modelMatrix),_(this._root)&&this._root.updateTransform(this._modelMatrix)}},timeSinceLoad:{get:function(){return this._timeSinceLoad}},totalMemoryUsageInBytes:{get:function(){var e=this._statistics;return e.texturesByteLength+e.geometryByteLength+e.batchTableByteLength}},styleEngine:{get:function(){return this._styleEngine}},statistics:{get:function(){return this._statistics}},classificationType:{get:function(){return this._classificationType}},ellipsoid:{get:function(){return this._ellipsoid}}}),q.loadJson=function(e){return p.createIfNeeded(e).fetchJson()},q.prototype.makeStyleDirty=function(){this._styleEngine.makeDirty()},q.prototype.loadTileset=function(e,t,r){var i=t.asset;if(!_(i))throw new y("Tileset must have an asset property.");if("0.0"!==i.version&&"1.0"!==i.version)throw new y("The tileset must be 3D Tiles version 0.0 or 1.0.  See https://github.com/AnalyticalGraphicsInc/3d-tiles#spec-status");var n=this._statistics;if(!_(e.queryParameters.v)){var o={v:g(i.tilesetVersion,"0.0")};this._basePath+="?v="+o.v,e.addQueryParameters(o)}var a=new x(this,e,t.root,r);_(r)&&(r.children.push(a),a._depth=r._depth+1),++n.numberOfTilesTotal;var s=[];for(s.push({header:t.root,tile3D:a});0<s.length;){var l=s.pop(),u=l.tile3D,c=l.header.children;if(_(c))for(var d=c.length,h=0;h<d;++h){var p=c[h],f=new x(this,e,p,u);u.children.push(f),f._depth=u._depth+1,++n.numberOfTilesTotal,s.push({header:p,tile3D:f})}this._cullWithChildrenBounds&&D.checkChildrenWithinParent(u)}return a};var W=new S,H=new T,j=new A,Y=new S,X=new S,Q=new S;function Z(e,t,r){var i=e._skipLevelOfDetail?e.skipLevels:0,n=e._skipLevelOfDetail?e.skipScreenSpaceErrorFactor:1;return t!==r&&!r.hasEmptyContent&&!e.immediatelyLoadDesiredLevelOfDetail&&r._screenSpaceError<t._screenSpaceError/n&&r._depth>t._depth+i}function K(i,n){if(!n.hasEmptyContent){var e=i._statistics,t=n.contentExpired;if(n.requestContent()){t&&(n.hasRenderableContent?(e.decrementLoadCounts(n.content),--i._statistics.numberOfTilesWithContentReady):n.hasTilesetContent&&function(e,t){var r=t,i=e._statistics,n=oe;n.push(t);for(;0<n.length;){for(var o=(t=n.pop()).children,a=o.length,s=0;s<a;++s)n.push(o[s]);t!==r&&(ae(e,t),t.destroy(),--i.numberOfTilesTotal)}r.children=[]}(i,n)),++e.numberOfPendingRequests;var r,o,a,s,l=(r=i,o=n,function(){var e=r._processingQueue.indexOf(o);-1!==e?(r._processingQueue.splice(e,1),--r._statistics.numberOfTilesProcessing,o.hasRenderableContent&&(r._statistics.incrementLoadCounts(o.content),++r._statistics.numberOfTilesWithContentReady,_(o.replacementNode)||(o.replacementNode=r._replacementList.add(o)))):--r._statistics.numberOfPendingRequests});n.contentReadyToProcessPromise.then((a=i,s=n,function(){a._processingQueue.push(s),--a._statistics.numberOfPendingRequests,++a._statistics.numberOfTilesProcessing})),n.contentReadyPromise.then(function(){l(),i.tileLoad.raiseEvent(n)}).otherwise(function(e){l();var t=n._contentResource.url,r=_(e.message)?e.message:e.toString();0<i.tileFailed.numberOfListeners?i.tileFailed.raiseEvent({url:t,message:r}):(console.log("A 3D tile failed to load: "+t),console.log("Error: "+r))})}else++e.numberOfAttemptedRequests}}var J=new S,$={maximumFractionDigits:3};function ee(e){var t=e/1048576;return t<1?t.toLocaleString(void 0,$):Math.round(t).toLocaleString()}function te(e){var t=e._boundingVolume.boundingVolume,r=t.halfAxes,i=t.radius,n=S.clone(t.center,J);if(_(r))n.x+=.75*(r[0]+r[3]+r[6]),n.y+=.75*(r[1]+r[4]+r[7]),n.z+=.75*(r[2]+r[5]+r[8]);else if(_(i)){var o=S.normalize(t.center,J);o=S.multiplyByScalar(o,.75*i,J),n=S.add(o,t.center,J)}return n}function re(e,t,r){var i="",n=0;(t.debugShowGeometricError&&(i+="\nGeometric error: "+e.geometricError,n++),t.debugShowRenderingStatistics)&&(i+="\nCommands: "+e.commandsLength,n++,0<e.content.pointsLength&&(i+="\nPoints: "+e.content.pointsLength,n++),0<e.content.trianglesLength&&(i+="\nTriangles: "+e.content.trianglesLength,n++),i+="\nFeatures: "+e.content.featuresLength,n++);t.debugShowMemoryUsage&&(i+="\nTexture Memory: "+ee(e.content.texturesByteLength),i+="\nGeometry Memory: "+ee(e.content.geometryByteLength),n+=2),t.debugShowUrl&&(i+="\nUrl: "+e._header.content.url,n++);var o={text:i.substring(1),position:r,font:19-n+"px sans-serif",showBackground:!0,disableDepthTestDistance:Number.POSITIVE_INFINITY};return t._tileDebugLabels.add(o)}var ie=new f({stencil:0,pass:b.CESIUM_3D_TILE});function ne(e,t){e._styleEngine.applyStyle(e,t);var r,i=e._statistics,n=t.commandList,o=n.length,a=e._selectedTiles,s=a.length,l=e.tileVisible,u=e._skipLevelOfDetail&&e._hasMixedContent&&t.context.stencilBuffer&&0<s;e._backfaceCommands.length=0,u&&n.push(ie);var c=n.length;for(r=0;r<s;++r){var d=a[r];d.selected&&(l.raiseEvent(d),d.update(e,t),i.incrementSelectionCounts(d.content),++i.selected)}var h=n.length-c;if(e._backfaceCommands.trim(),u){var p=e._backfaceCommands.values,f=p.length;for(n.length+=f,r=h-1;0<=r;--r)n[c+f+r]=n[c+r];for(r=0;r<f;++r)n[c+r]=p[r]}i.numberOfCommands=n.length-o,e.pointCloudShading.attenuation&&e.pointCloudShading.eyeDomeLighting&&0<h&&e._pointCloudEyeDomeLighting.update(t,o,e),e.debugShowGeometricError||e.debugShowRenderingStatistics||e.debugShowMemoryUsage||e.debugShowUrl?(_(e._tileDebugLabels)||(e._tileDebugLabels=new L),function(e,t){var r=e._selectedTiles,i=r.length;if(e._tileDebugLabels.removeAll(),e.debugPickedTileLabelOnly){if(_(e.debugPickedTile)){var n=_(e.debugPickPosition)?e.debugPickPosition:te(e.debugPickedTile);re(e.debugPickedTile,e,n).pixelOffset=new m(15,-15)}}else for(var o=0;o<i;++o){var a=r[o];re(a,e,te(a))}e._tileDebugLabels.update(t)}(e,t)):e._tileDebugLabels=e._tileDebugLabels&&e._tileDebugLabels.destroy()}var oe=[];function ae(e,t){var r=t.replacementNode;if(_(r)){var i=e._statistics,n=e._replacementList;e.tileUnload.raiseEvent(t),n.remove(r),i.decrementLoadCounts(t.content),--i.numberOfTilesWithContentReady}}return q.prototype.trimLoadedTiles=function(){this._trimTiles=!0},q.prototype.update=function(e){if(e.mode!==F.MORPHING&&this.show&&this.ready){_(this._loadTimestamp)||(this._loadTimestamp=v.clone(e.time)),this._timeSinceLoad=Math.max(1e3*v.secondsDifference(e.time,this._loadTimestamp),0),this._skipLevelOfDetail=this.skipLevelOfDetail&&!_(this._classificationType)&&!this._disableSkipLevelOfDetail;var t,r,i,n,o,a,s,l,u,c=e.passes,d=c.pick&&!c.render,h=!d,p=this._statistics;p.clear(),h&&function(e,t){for(var r=e._processingQueue,i=r.length-1;0<=i;--i)r[i].process(e,t)}(this,e),this.dynamicScreenSpaceError&&function(e,t){var r,i,n,o,a,s=t.camera,l=e._root,u=l.contentBoundingVolume;if(u instanceof U)r=S.normalize(s.positionWC,W),i=s.directionWC,n=s.positionCartographic.height,o=u.minimumHeight,a=u.maximumHeight;else{var c=A.inverseTransformation(l.computedTransform,j),d=t.mapProjection.ellipsoid,h=u.boundingVolume,p=A.multiplyByPoint(c,h.center,Y);if(S.magnitude(p)>d.minimumRadius){var f=T.fromCartesian(p,d,H);r=S.normalize(s.positionWC,W),i=s.directionWC,n=s.positionCartographic.height,o=0,a=2*f.height}else{var m=A.multiplyByPoint(c,s.positionWC,X);if(r=S.UNIT_Z,i=A.multiplyByPointAsVector(c,s.directionWC,Q),i=S.normalize(i,i),n=m.z,u instanceof z){var g=l._header.boundingVolume.box[11];o=p.z-g,a=p.z+g}else if(u instanceof V){var _=h.radius;o=p.z-_,a=p.z+_}}}var v=o+(a-o)*e.dynamicScreenSpaceErrorHeightFalloff,y=a,b=E.clamp((n-v)/(y-v),0,1),C=1-Math.abs(S.dot(i,r));C*=1-b;var w=e.dynamicScreenSpaceErrorDensity;w*=C,e._dynamicScreenSpaceErrorComputedDensity=w}(this,e),I.selectTiles(this,e,h),function(e,t){if(t)for(var r=e._requestedTiles,i=r.length,n=0;n<i;++n)K(e,r[n])}(this,h),ne(this,e),h&&function(e){var t=e._trimTiles;e._trimTiles=!1;for(var r=e._replacementList,i=e.totalMemoryUsageInBytes,n=1024*e._maximumMemoryUsage*1024,o=e._replacementSentinel,a=r.head;a!==o&&(n<i||t);){var s=a.item;a=a.next,ae(e,s),s.unloadContent(),i=e.totalMemoryUsageInBytes}}(this),r=e,i=(t=this)._statistics,n=t._statisticsLastColor,o=i.numberOfPendingRequests,a=i.numberOfTilesProcessing,s=n.numberOfPendingRequests,l=n.numberOfTilesProcessing,(u=o!==s||a!==l)&&r.afterRender.push(function(){t.loadProgress.raiseEvent(o,a)}),t._tilesLoaded=0===i.numberOfPendingRequests&&0===i.numberOfTilesProcessing&&0===i.numberOfAttemptedRequests,u&&t._tilesLoaded&&r.afterRender.push(function(){t.allTilesLoaded.raiseEvent()});var f=d?this._statisticsLastPick:this._statisticsLastColor;O.clone(p,f)}},q.prototype.isDestroyed=function(){return!1},q.prototype.destroy=function(){if(this._tileDebugLabels=this._tileDebugLabels&&this._tileDebugLabels.destroy(),_(this._root)){var e=oe;for(e.push(this._root);0<e.length;){var t=e.pop();t.destroy();for(var r=t.children,i=r.length,n=0;n<i;++n)e.push(r[n])}}return this._root=void 0,o(this)},q}),define("Scene/ConditionsExpression",["../Core/clone","../Core/defined","../Core/defineProperties","./Expression"],function(r,u,e,c){"use strict";function t(e,t){this._conditionsExpression=r(e,!0),this._conditions=e.conditions,this._runtimeConditions=void 0,function(e,t){var r=[],i=e._conditions;if(!u(i))return;for(var n=i.length,o=0;o<n;++o){var a=i[o],s=String(a[0]),l=String(a[1]);r.push(new d(new c(s,t),new c(l,t)))}e._runtimeConditions=r}(this,t)}function d(e,t){this.condition=e,this.expression=t}return e(t.prototype,{conditionsExpression:{get:function(){return this._conditionsExpression}}}),t.prototype.evaluate=function(e,t,r){var i=this._runtimeConditions;if(u(i))for(var n=i.length,o=0;o<n;++o){var a=i[o];if(a.condition.evaluate(e,t))return a.expression.evaluate(e,t,r)}},t.prototype.evaluateColor=function(e,t,r){var i=this._runtimeConditions;if(u(i))for(var n=i.length,o=0;o<n;++o){var a=i[o];if(a.condition.evaluate(e,t))return a.expression.evaluateColor(e,t,r)}},t.prototype.getShaderFunction=function(e,t,r,i){var n=this._runtimeConditions;if(u(n)&&0!==n.length){for(var o="",a=n.length,s=0;s<a;++s){var l=n[s];o+="    "+(0===s?"if":"else if")+" ("+l.condition.getShaderExpression(t,r)+") \n    { \n        return "+l.expression.getShaderExpression(t,r)+"; \n    } \n"}return o=i+" "+e+"() \n{ \n"+o+"    return "+i+"(1.0); \n} \n"}},t}),define("Scene/Cesium3DTileStyle",["../Core/clone","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Resource","../ThirdParty/when","./ConditionsExpression","./Expression"],function(a,s,l,e,t,i,n,o,u){"use strict";function r(e){var t;(this._style=void 0,this._ready=!1,this._show=void 0,this._color=void 0,this._pointSize=void 0,this._pointOutlineColor=void 0,this._pointOutlineWidth=void 0,this._labelColor=void 0,this._labelOutlineColor=void 0,this._labelOutlineWidth=void 0,this._font=void 0,this._labelStyle=void 0,this._labelText=void 0,this._backgroundColor=void 0,this._backgroundPadding=void 0,this._backgroundEnabled=void 0,this._scaleByDistance=void 0,this._translucencyByDistance=void 0,this._distanceDisplayCondition=void 0,this._heightOffset=void 0,this._anchorLineEnabled=void 0,this._anchorLineColor=void 0,this._image=void 0,this._disableDepthTestDistance=void 0,this._horizontalOrigin=void 0,this._verticalOrigin=void 0,this._labelHorizontalOrigin=void 0,this._labelVerticalOrigin=void 0,this._meta=void 0,this._colorShaderFunction=void 0,this._showShaderFunction=void 0,this._pointSizeShaderFunction=void 0,this._colorShaderFunctionReady=!1,this._showShaderFunctionReady=!1,this._pointSizeShaderFunctionReady=!1,this._colorShaderTranslucent=!1,"string"==typeof e||e instanceof i)?t=i.createIfNeeded(e).fetchJson(e):t=n.resolve(e);var r=this;this._readyPromise=t.then(function(e){return function(e,t){e._style=a(t,!0),t=s(t,s.EMPTY_OBJECT),e.show=t.show,e.color=t.color,e.pointSize=t.pointSize,e.pointOutlineColor=t.pointOutlineColor,e.pointOutlineWidth=t.pointOutlineWidth,e.labelColor=t.labelColor,e.labelOutlineColor=t.labelOutlineColor,e.labelOutlineWidth=t.labelOutlineWidth,e.labelStyle=t.labelStyle,e.font=t.font,e.labelText=t.labelText,e.backgroundColor=t.backgroundColor,e.backgroundPadding=t.backgroundPadding,e.backgroundEnabled=t.backgroundEnabled,e.scaleByDistance=t.scaleByDistance,e.translucencyByDistance=t.translucencyByDistance,e.distanceDisplayCondition=t.distanceDisplayCondition,e.heightOffset=t.heightOffset,e.anchorLineEnabled=t.anchorLineEnabled,e.anchorLineColor=t.anchorLineColor,e.image=t.image,e.disableDepthTestDistance=t.disableDepthTestDistance,e.horizontalOrigin=t.horizontalOrigin,e.verticalOrigin=t.verticalOrigin,e.labelHorizontalOrigin=t.labelHorizontalOrigin,e.labelVerticalOrigin=t.labelVerticalOrigin;var r={};if(l(t.meta)){var i=t.defines,n=s(t.meta,s.EMPTY_OBJECT);for(var o in n)n.hasOwnProperty(o)&&(r[o]=new u(n[o],i))}e._meta=r,e._ready=!0}(r,e),r})}function c(e,t){var r=s(e._style,s.EMPTY_OBJECT).defines;if(l(t))return"boolean"==typeof t||"number"==typeof t?new u(String(t)):"string"==typeof t?new u(t,r):l(t.conditions)?new o(t,r):t}return e(r.prototype,{style:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._style}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},show:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._show},set:function(e){this._show=c(this,e),this._showShaderFunctionReady=!1}},color:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._color},set:function(e){this._color=c(this,e),this._colorShaderFunctionReady=!1}},pointSize:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._pointSize},set:function(e){this._pointSize=c(this,e),this._pointSizeShaderFunctionReady=!1}},pointOutlineColor:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._pointOutlineColor},set:function(e){this._pointOutlineColor=c(this,e)}},pointOutlineWidth:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._pointOutlineWidth},set:function(e){this._pointOutlineWidth=c(this,e)}},labelColor:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._labelColor},set:function(e){this._labelColor=c(this,e)}},labelOutlineColor:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._labelOutlineColor},set:function(e){this._labelOutlineColor=c(this,e)}},labelOutlineWidth:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._labelOutlineWidth},set:function(e){this._labelOutlineWidth=c(this,e)}},font:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._font},set:function(e){this._font=c(this,e)}},labelStyle:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._labelStyle},set:function(e){this._labelStyle=c(this,e)}},labelText:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._labelText},set:function(e){this._labelText=c(this,e)}},backgroundColor:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._backgroundColor},set:function(e){this._backgroundColor=c(this,e)}},backgroundPadding:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._backgroundPadding},set:function(e){this._backgroundPadding=c(this,e)}},backgroundEnabled:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._backgroundEnabled},set:function(e){this._backgroundEnabled=c(this,e)}},scaleByDistance:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._scaleByDistance},set:function(e){this._scaleByDistance=c(this,e)}},translucencyByDistance:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._translucencyByDistance},set:function(e){this._translucencyByDistance=c(this,e)}},distanceDisplayCondition:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._distanceDisplayCondition},set:function(e){this._distanceDisplayCondition=c(this,e)}},heightOffset:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._heightOffset},set:function(e){this._heightOffset=c(this,e)}},anchorLineEnabled:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._anchorLineEnabled},set:function(e){this._anchorLineEnabled=c(this,e)}},anchorLineColor:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._anchorLineColor},set:function(e){this._anchorLineColor=c(this,e)}},image:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._image},set:function(e){this._image=c(this,e)}},disableDepthTestDistance:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._disableDepthTestDistance},set:function(e){this._disableDepthTestDistance=c(this,e)}},horizontalOrigin:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._horizontalOrigin},set:function(e){this._horizontalOrigin=c(this,e)}},verticalOrigin:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._verticalOrigin},set:function(e){this._verticalOrigin=c(this,e)}},labelHorizontalOrigin:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._labelHorizontalOrigin},set:function(e){this._labelHorizontalOrigin=c(this,e)}},labelVerticalOrigin:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._labelVerticalOrigin},set:function(e){this._labelVerticalOrigin=c(this,e)}},meta:{get:function(){if(!this._ready)throw new t("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._meta},set:function(e){this._meta=e}}}),r.prototype.getColorShaderFunction=function(e,t,r){return this._colorShaderFunctionReady?r.translucent=this._colorShaderTranslucent:(this._colorShaderFunctionReady=!0,this._colorShaderFunction=l(this.color)?this.color.getShaderFunction(e,t,r,"vec4"):void 0,this._colorShaderTranslucent=r.translucent),this._colorShaderFunction},r.prototype.getShowShaderFunction=function(e,t,r){return this._showShaderFunctionReady||(this._showShaderFunctionReady=!0,this._showShaderFunction=l(this.show)?this.show.getShaderFunction(e,t,r,"bool"):void 0),this._showShaderFunction},r.prototype.getPointSizeShaderFunction=function(e,t,r){return this._pointSizeShaderFunctionReady||(this._pointSizeShaderFunctionReady=!0,this._pointSizeShaderFunction=l(this.pointSize)?this.pointSize.getShaderFunction(e,t,r,"float"):void 0),this._pointSizeShaderFunction},r}),define("Scene/UrlTemplateImageryProvider",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/clone","../Core/combine","../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/DeveloperError","../Core/Event","../Core/GeographicTilingScheme","../Core/isArray","../Core/Math","../Core/Rectangle","../Core/Resource","../Core/WebMercatorTilingScheme","../ThirdParty/when","./ImageryProvider"],function(e,t,r,i,u,c,d,h,n,p,f,o,l,m,g,_,v,y,b,a){"use strict";var C=/{[^}]+}/g,w={x:function(e,t,r,i){return I(e,"{x}",t)},y:function(e,t,r,i){return I(e,"{y}",r)},z:function(e,t,r,i){return I(e,"{z}",i)},s:function(e,t,r,i){var n=(t+r+i)%e._subdomains.length;return e._subdomains[n]},reverseX:function(e,t,r,i){var n=e.tilingScheme.getNumberOfXTilesAtLevel(i)-t-1;return I(e,"{reverseX}",n)},reverseY:function(e,t,r,i){var n=e.tilingScheme.getNumberOfYTilesAtLevel(i)-r-1;return I(e,"{reverseY}",n)},reverseZ:function(e,t,r,i){var n=e.maximumLevel,o=h(n)&&i<n?n-i-1:i;return I(e,"{reverseZ}",o)},westDegrees:function(e,t,r,i){return M(e,t,r,i),E.west},southDegrees:function(e,t,r,i){return M(e,t,r,i),E.south},eastDegrees:function(e,t,r,i){return M(e,t,r,i),E.east},northDegrees:function(e,t,r,i){return M(e,t,r,i),E.north},westProjected:function(e,t,r,i){return R(e,t,r,i),x.west},southProjected:function(e,t,r,i){return R(e,t,r,i),x.south},eastProjected:function(e,t,r,i){return R(e,t,r,i),x.east},northProjected:function(e,t,r,i){return R(e,t,r,i),x.north},width:function(e,t,r,i){return e.tileWidth},height:function(e,t,r,i){return e.tileHeight}},S=u(w,{i:function(e,t,r,i,n,o,a){return k(e,t,r,i,n,o),D.x},j:function(e,t,r,i,n,o,a){return k(e,t,r,i,n,o),D.y},reverseI:function(e,t,r,i,n,o,a){return k(e,t,r,i,n,o),e.tileWidth-D.x-1},reverseJ:function(e,t,r,i,n,o,a){return k(e,t,r,i,n,o),e.tileHeight-D.y-1},longitudeDegrees:function(e,t,r,i,n,o,a){return g.toDegrees(n)},latitudeDegrees:function(e,t,r,i,n,o,a){return g.toDegrees(o)},longitudeProjected:function(e,t,r,i,n,o,a){return B(e,t,r,i,n,o),N.x},latitudeProjected:function(e,t,r,i,n,o,a){return B(e,t,r,i,n,o),N.y},format:function(e,t,r,i,n,o,a){return a}});function s(e){if(!h(e))throw new f("options is required.");if(!b.isPromise(e)&&!h(e.url))throw new f("options is required.");this._errorEvent=new o,this._resource=void 0,this._urlSchemeZeroPadding=void 0,this._pickFeaturesResource=void 0,this._tileWidth=void 0,this._tileHeight=void 0,this._maximumLevel=void 0,this._minimumLevel=void 0,this._tilingScheme=void 0,this._rectangle=void 0,this._tileDiscardPolicy=void 0,this._credit=void 0,this._hasAlphaChannel=void 0,this._readyPromise=void 0,this._tags=void 0,this._pickFeaturesTags=void 0,this.enablePickFeatures=!0,this.reinitialize(e)}n(s.prototype,{url:{get:function(){return this._resource.url}},urlSchemeZeroPadding:{get:function(){return this._urlSchemeZeroPadding}},pickFeaturesUrl:{get:function(){return this._pickFeaturesResource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){if(!this.ready)throw new f("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth}},tileHeight:{get:function(){if(!this.ready)throw new f("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight}},maximumLevel:{get:function(){if(!this.ready)throw new f("maximumLevel must not be called before the imagery provider is ready.");return this._maximumLevel}},minimumLevel:{get:function(){if(!this.ready)throw new f("minimumLevel must not be called before the imagery provider is ready.");return this._minimumLevel}},tilingScheme:{get:function(){if(!this.ready)throw new f("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}},rectangle:{get:function(){if(!this.ready)throw new f("rectangle must not be called before the imagery provider is ready.");return this._rectangle}},tileDiscardPolicy:{get:function(){if(!this.ready)throw new f("tileDiscardPolicy must not be called before the imagery provider is ready.");return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return h(this._resource)}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){if(!this.ready)throw new f("credit must not be called before the imagery provider is ready.");return this._credit}},hasAlphaChannel:{get:function(){if(!this.ready)throw new f("hasAlphaChannel must not be called before the imagery provider is ready.");return this._hasAlphaChannel}}}),s.prototype.reinitialize=function(s){var l=this;l._readyPromise=b(s).then(function(e){if(!h(e))throw new f("options is required.");if(!h(e.url))throw new f("options.url is required.");h(s.proxy)&&p("UrlTemplateImageryProvider.proxy","The options.proxy parameter has been deprecated. Specify options.url as a Resource instance and set the proxy property there.");var t=e.customTags,r=u(w,t),i=u(S,t),n=v.createIfNeeded(e.url,{proxy:e.proxy}),o=v.createIfNeeded(e.pickFeaturesUrl,{proxy:e.proxy});l.enablePickFeatures=d(e.enablePickFeatures,l.enablePickFeatures),l._urlSchemeZeroPadding=d(e.urlSchemeZeroPadding,l.urlSchemeZeroPadding),l._tileDiscardPolicy=e.tileDiscardPolicy,l._getFeatureInfoFormats=e.getFeatureInfoFormats,l._subdomains=e.subdomains,m(l._subdomains)?l._subdomains=l._subdomains.slice():h(l._subdomains)&&0<l._subdomains.length?l._subdomains=l._subdomains.split(""):l._subdomains=["a","b","c"],l._tileWidth=d(e.tileWidth,256),l._tileHeight=d(e.tileHeight,256),l._minimumLevel=d(e.minimumLevel,0),l._maximumLevel=e.maximumLevel,l._tilingScheme=d(e.tilingScheme,new y({ellipsoid:e.ellipsoid})),l._rectangle=d(e.rectangle,l._tilingScheme.rectangle),l._rectangle=_.intersection(l._rectangle,l._tilingScheme.rectangle),l._hasAlphaChannel=d(e.hasAlphaChannel,!0);var a=e.credit;return"string"==typeof a&&(a=new c({text:a})),l._credit=a,l._resource=n,l._tags=r,l._pickFeaturesResource=o,l._pickFeaturesTags=i,!0})},s.prototype.getTileCredits=function(e,t,r){if(!this.ready)throw new f("getTileCredits must not be called before the imagery provider is ready.")},s.prototype.requestImage=function(e,t,r,i){if(!this.ready)throw new f("requestImage must not be called before the imagery provider is ready.");return a.loadImage(this,function(r,i,n,o,e){A=T=!1;var t=r._resource,a=t.getUrlComponent(!0),s=r._tags,l={},u=a.match(C);h(u)&&u.forEach(function(e){var t=e.substring(1,e.length-1);h(s[t])&&(l[t]=s[t](r,i,n,o))});return t.getDerivedResource({request:e,templateValues:l})}(this,e,t,r,i))};var T=!(s.prototype.pickFeatures=function(i,n,o,a,s){if(!this.ready)throw new f("pickFeatures must not be called before the imagery provider is ready.");if(this.enablePickFeatures&&h(this._pickFeaturesResource)&&0!==this._getFeatureInfoFormats.length){var l=0,u=this;return function e(){if(l>=u._getFeatureInfoFormats.length)return b([]);var t=u._getFeatureInfoFormats[l],r=function(r,i,n,o,a,s,l){O=P=A=T=!1;var e=r._pickFeaturesResource,t=e.getUrlComponent(!0),u=r._pickFeaturesTags,c={},d=t.match(C);return h(d)&&d.forEach(function(e){var t=e.substring(1,e.length-1);h(u[t])&&(c[t]=u[t](r,i,n,o,a,s,l))}),e.getDerivedResource({templateValues:c})}(u,i,n,o,a,s,t.format);return++l,"json"===t.type?r.fetchJson().then(t.callback).otherwise(e):"xml"===t.type?r.fetchXML().then(t.callback).otherwise(e):"text"===t.type||"html"===t.type?r.fetchText().then(t.callback).otherwise(e):r.fetch({responseType:t.format}).then(function(e,t){return e.callback(t)}.bind(void 0,t)).otherwise(e)}()}}),E=new _,A=!1,x=new _;var P=!1,D=new e,O=!1;function I(e,t,r){if(e&&e.urlSchemeZeroPadding&&e.urlSchemeZeroPadding.hasOwnProperty(t)){var i=e.urlSchemeZeroPadding[t];if("string"==typeof i){var n=i.length;1<n&&(r=r.length>=n?r:new Array(n-r.toString().length+1).join("0")+r)}}return r}function M(e,t,r,i){T||(e.tilingScheme.tileXYToRectangle(t,r,i,E),E.west=g.toDegrees(E.west),E.south=g.toDegrees(E.south),E.east=g.toDegrees(E.east),E.north=g.toDegrees(E.north),T=!0)}function R(e,t,r,i){A||(e.tilingScheme.tileXYToNativeRectangle(t,r,i,x),A=!0)}var L=new _,N=new t;function k(e,t,r,i,n,o,a){if(!P){B(e,t,r,i,n,o);var s=N,l=e.tilingScheme.tileXYToNativeRectangle(t,r,i,L);D.x=e.tileWidth*(s.x-l.west)/l.width|0,D.y=e.tileHeight*(l.north-s.y)/l.height|0,P=!0}}var F=new r;function B(e,t,r,i,n,o,a){if(!O){if(e.tilingScheme instanceof l)N.x=g.toDegrees(n),N.y=g.toDegrees(o);else{var s=F;s.longitude=n,s.latitude=o,e.tilingScheme.projection.project(s,N)}O=!0}}return s}),define("Scene/createTileMapServiceImageryProvider",["../Core/Cartesian2","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/deprecationWarning","../Core/DeveloperError","../Core/GeographicTilingScheme","../Core/Rectangle","../Core/Resource","../Core/RuntimeError","../Core/TileProviderError","../Core/WebMercatorTilingScheme","../ThirdParty/when","./UrlTemplateImageryProvider"],function(F,B,U,V,r,i,z,q,n,G,W,H,o,a){"use strict";return function(O){if(O=U(O,{}),!V(O.url))throw new i("options.url is required.");V(O.proxy)&&r("createTileMapServiceImageryProvider.proxy","The options.proxy parameter has been deprecated. Specify options.url as a Resource instance and set the proxy property there.");var I=n.createIfNeeded(O.url,{proxy:O.proxy});I.appendForwardSlash();var M,R=I.getDerivedResource({url:"tilemapresource.xml"}),L=o.defer(),N=new a(L.promise);function e(e){for(var t,r,i,n,o=/tileformat/i,a=/tileset/i,s=/tilesets/i,l=/boundingbox/i,u=[],c=e.childNodes[0].childNodes,d=0;d<c.length;d++)if(o.test(c.item(d).nodeName))t=c.item(d);else if(s.test(c.item(d).nodeName)){i=c.item(d);for(var h=c.item(d).childNodes,p=0;p<h.length;p++)a.test(h.item(p).nodeName)&&u.push(h.item(p))}else l.test(c.item(d).nodeName)&&(r=c.item(d));if(!V(i)||!V(r))return n="Unable to find expected tilesets or bbox attributes in "+R.url+".",void((M=W.handleError(M,N,N.errorEvent,n,void 0,void 0,void 0,k)).retry||L.reject(new G(n)));var f=U(O.fileExtension,t.getAttribute("extension")),m=U(O.tileWidth,parseInt(t.getAttribute("width"),10)),g=U(O.tileHeight,parseInt(t.getAttribute("height"),10)),_=U(O.minimumLevel,parseInt(u[0].getAttribute("order"),10)),v=U(O.maximumLevel,parseInt(u[u.length-1].getAttribute("order"),10)),y=i.getAttribute("profile"),b=O.tilingScheme;if(!V(b))if("geodetic"===y||"global-geodetic"===y)b=new z({ellipsoid:O.ellipsoid});else{if("mercator"!==y&&"global-mercator"!==y)return n=R.url+"specifies an unsupported profile attribute, "+y+".",void((M=W.handleError(M,N,N.errorEvent,n,void 0,void 0,void 0,k)).retry||L.reject(new G(n)));b=new H({ellipsoid:O.ellipsoid})}var C=q.clone(O.rectangle);if(!V(C)){var w,S,T,E;if(E=U(O.flipXY,!1)?(T=new F(parseFloat(r.getAttribute("miny")),parseFloat(r.getAttribute("minx"))),new F(parseFloat(r.getAttribute("maxy")),parseFloat(r.getAttribute("maxx")))):(T=new F(parseFloat(r.getAttribute("minx")),parseFloat(r.getAttribute("miny"))),new F(parseFloat(r.getAttribute("maxx")),parseFloat(r.getAttribute("maxy")))),b instanceof z||"geodetic"===y||"mercator"===y)w=B.fromDegrees(T.x,T.y),S=B.fromDegrees(E.x,E.y);else{var A=b.projection;w=A.unproject(T),S=A.unproject(E)}C=new q(w.longitude,w.latitude,S.longitude,S.latitude)}C.west<b.rectangle.west&&(C.west=b.rectangle.west),C.east>b.rectangle.east&&(C.east=b.rectangle.east),C.south<b.rectangle.south&&(C.south=b.rectangle.south),C.north>b.rectangle.north&&(C.north=b.rectangle.north);var x=b.positionToTileXY(q.southwest(C),_),P=b.positionToTileXY(q.northeast(C),_);4<(Math.abs(P.x-x.x)+1)*(Math.abs(P.y-x.y)+1)&&(_=0);var D=I.getDerivedResource({url:"{z}/{x}/{reverseY}."+f});L.resolve({url:D,tilingScheme:b,rectangle:C,tileWidth:m,tileHeight:g,minimumLevel:_,maximumLevel:v,tileDiscardPolicy:O.tileDiscardPolicy,credit:O.credit})}function t(e){var t=U(O.fileExtension,"png"),r=U(O.tileWidth,256),i=U(O.tileHeight,256),n=U(O.minimumLevel,0),o=O.maximumLevel,a=V(O.tilingScheme)?O.tilingScheme:new H({ellipsoid:O.ellipsoid}),s=U(O.rectangle,a.rectangle),l=I.getDerivedResource({url:"{z}/{x}/{reverseY}."+t});L.resolve({url:l,tilingScheme:a,rectangle:s,tileWidth:r,tileHeight:i,minimumLevel:n,maximumLevel:o,tileDiscardPolicy:O.tileDiscardPolicy,credit:O.credit})}function k(){R.fetchXML().then(e).otherwise(t)}return k(),N}}),define("Scene/GoogleEarthEnterpriseMapsProvider",["../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/DeveloperError","../Core/Event","../Core/GeographicTilingScheme","../Core/Rectangle","../Core/Resource","../Core/RuntimeError","../Core/TileProviderError","../Core/WebMercatorTilingScheme","../ThirdParty/when","./ImageryProvider"],function(c,d,h,e,p,f,m,g,_,v,y,b,C,w,o){"use strict";function S(o){if(o=d(o,{}),!h(o.url))throw new f("options.url is required.");if(!h(o.channel))throw new f("options.channel is required.");h(o.proxy)&&p("GoogleEarthEnterpriseMapsProvider.proxy","The options.proxy parameter has been deprecated. Specify options.url as a Resource instance and set the proxy property there.");var e=o.url,t=d(o.path,"/default_map"),r=v.createIfNeeded(e+t,{proxy:o.proxy});r.appendForwardSlash(),this._resource=r,this._url=e,this._path=t,this._tileDiscardPolicy=o.tileDiscardPolicy,this._channel=o.channel,this._requestType="ImageryMaps",this._credit=new c({text:"Google Imagery",imageUrl:S._logoData,link:"http://www.google.com/enterprise/mapsearth/products/earthenterprise.html"}),this.defaultGamma=1.9,this._tilingScheme=void 0,this._version=void 0,this._tileWidth=256,this._tileHeight=256,this._maximumLevel=o.maximumLevel,this._errorEvent=new m,this._ready=!1,this._readyPromise=w.defer();var a,i=r.getDerivedResource({url:"query",queryParameters:{request:"Json",vars:"geeServerDefs",is2d:"t"}}),s=this;function n(t){var r,e,i;try{r=JSON.parse(t)}catch(e){r=JSON.parse(t.replace(/([\[\{,])[\n\r ]*([A-Za-z0-9]+)[\n\r ]*:/g,'$1"$2":'))}for(var n=0;n<r.layers.length;n++)if(r.layers[n].id===s._channel){e=r.layers[n];break}if(!h(e))throw i="Could not find layer with channel (id) of "+s._channel+".",a=b.handleError(a,s,s._errorEvent,i,void 0,void 0,void 0,u),new y(i);if(!h(e.version))throw i="Could not find a version in channel (id) "+s._channel+".",a=b.handleError(a,s,s._errorEvent,i,void 0,void 0,void 0,u),new y(i);if(s._version=e.version,h(r.projection)&&"flat"===r.projection)s._tilingScheme=new g({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new _(-Math.PI,-Math.PI,Math.PI,Math.PI),ellipsoid:o.ellipsoid});else{if(h(r.projection)&&"mercator"!==r.projection)throw i="Unsupported projection "+r.projection+".",a=b.handleError(a,s,s._errorEvent,i,void 0,void 0,void 0,u),new y(i);s._tilingScheme=new C({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:o.ellipsoid})}s._ready=!0,s._readyPromise.resolve(!0),b.handleSuccess(a)}function l(e){var t="An error occurred while accessing "+i.url+".";a=b.handleError(a,s,s._errorEvent,t,void 0,void 0,void 0,u),s._readyPromise.reject(new y(t))}function u(){var e=i.fetchText();w(e,n,l)}u()}return e(S.prototype,{url:{get:function(){return this._url}},path:{get:function(){return this._path}},proxy:{get:function(){return this._resource.proxy}},channel:{get:function(){return this._channel}},tileWidth:{get:function(){if(!this._ready)throw new f("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth}},tileHeight:{get:function(){if(!this._ready)throw new f("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready)throw new f("maximumLevel must not be called before the imagery provider is ready.");return this._maximumLevel}},minimumLevel:{get:function(){if(!this._ready)throw new f("minimumLevel must not be called before the imagery provider is ready.");return 0}},tilingScheme:{get:function(){if(!this._ready)throw new f("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}},version:{get:function(){if(!this._ready)throw new f("version must not be called before the imagery provider is ready.");return this._version}},requestType:{get:function(){if(!this._ready)throw new f("requestType must not be called before the imagery provider is ready.");return this._requestType}},rectangle:{get:function(){if(!this._ready)throw new f("rectangle must not be called before the imagery provider is ready.");return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready)throw new f("tileDiscardPolicy must not be called before the imagery provider is ready.");return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}}),S.prototype.getTileCredits=function(e,t,r){},S.prototype.requestImage=function(e,t,r,i){if(!this._ready)throw new f("requestImage must not be called before the imagery provider is ready.");var n=this._resource.getDerivedResource({url:"query",request:i,queryParameters:{request:this._requestType,channel:this._channel,version:this._version,x:e,y:t,z:r+1}});return o.loadImage(this,n)},S.prototype.pickFeatures=function(e,t,r,i,n){},S._logoData="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAAnCAYAAACmP2LfAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAAHdElNRQfcDB4TJDr1mp5kAAAAGnRFWHRTb2Z0d2FyZQBQYWludC5ORVQgdjMuNS4xMDD0cqEAAB1zSURBVHhe7ZwHeFTFFsf/u+l9N70npOxuSAKEFFIhCSH0qhEQUHkgKCgWUFGBB6IoCAoo0ntooaRvEkIIBBBpoYSa3nvvfd+5u4sQUigPfMX8v2/Y3Tkzs3fv/d0z58zcgF69Ql1SY+MM1wQJem44ZeiJk8beEOqPwG6uC7ZqyElb9eo/JZEIkH2nRQkBIlNMauuPCS3uGN/kjkmNDghoskBAgzrZ2NLmf1+JwIKQpYsoxdmIV9+N07onCegzBPM9bOdmYKnazF6g/1N6UySPqSJzvCaaiLHtP8G/Phq+FRfgU5ogKWUXMLT6Mvzqr2BE40mMadqO8c3zMabBC6PqDDC8SlY60t9HByCLVTKu+ERmHr5TWI9wjVxEaOZivWo1pil8D1tZeWnLXv1l8iZ3PF2kjymiWRgvCoJv5U243IyAXcQq8A9Mg9W+4bDe6wv+kVGwCZkL+4Sf4ZR+BZ5VGQR3EkbWn8Hopm3wq54Lz2JD6ah/P21XGopQ9Qoc16jGSqVyTJWbQbUsibFXf42mihTwZpsvAtp3k0dOhFOSEH1+ngaDefrgjFCgFkxY8fCisCBvKgODzxRh9qslBFGfYmDGLbiV5mBwRRo8KtPhVBgPu8teMP7u73chD6kMRYRGBY5xqrFKqQwz5SdTbS/Qf5mmUYw8rf01CjHC4VP7AHZxO6E3qy9ZZCQNnio2rE/4o9/tkxiQUYp+KRXgx8XC5FsXcLz/hkCrDUU4pxLHuDVYpdwL9F+qqSJZKlPwenskfOoI5tN7YPCJGVme7wKYr5EBXzgYfW+mwTI0Gjrznaj2WW+I/y8dVPdDGLcKRzXrsEqlHO8oTKHaXqAZWe9hQXCi63NhHWYI3ilfWIW/YLjqL2JRiOFBJRz+LffhcPs09D+0J8vzn3zXdBnYnp8Mi6NboTWzH9X8fVc+DhDQodxqAroe36lU9AJNWr4cEAjNwI8OAC9cT1rbUfzwGeCfKiL7dGnNc+q1NiO80b4BY1oT4V6WDcsdc6j2xbyq4wMWrA9rQmeWFn36ey/jBaoPQ4hmLYI0G/AtAf22fC/QDols8ITrIYi/Bl6knbS2o3gRbxHQxQQ0k0S/gCa2v4OJovPwacqAQ1ICjL40klr+UrWoQbFBETo18jCpZsOoFODkvuCNJYoHW3QKXFEM7ETRcKfiQe8d6NVIFImXvg4skhY40mxnQYVRIIeA1qrHEc1GrFSpxFtP99AiFbDbNKDZpAzzGkVYVcvBuBJQEo/9/6C+dyjPitwLwak74D8V6Bfw0P5VShjXFoTR7TfhUZkL29M/wfATJan1lauWC3aDOgyaVDCuTgbf1bFkfmtkye1ogsK2asivLYfCglIoD8qCknI2NHuG4QSVGMgQyMbt0fioRYh9VYcRU7QX55uDcaHtFOJEsThMtmWtQgxsDodsWaC0c3ea3MzGBJEqxrfbYmzr6xjfPAeTmt5HQPO7eK1xDibUz8eY+k8xtHYJPCtXwvHOu7AXMrMTsF/TH8HajTis1YwVqpWY0TXQDKy1OpBr5EJA52Fukxx+bmKxtjWx2DuaWawNlZD5qhzyo9KhpHAbKpJO/6t65UCPbPHA2PYrGNacgkElabCJJDev/MpDhUKKnuq44LRoYEK1IiswkS1zYCfk5y+F0qjvoTwqBOof34dGeAnUL1ZCLboEnJ9zoe0QD/Nuj00UBVXRabzVLETM3S0ICfwA8yc7Y6C3ANYbZsA7aQ1W1xzEfZEQ6dT2BkG9pP4ouo7jGE1u42JS20QMrzkCr4xwuN4+AM+cYII3EaNar2J86zmMrP8DHulCON4NhU3YWuhOYy6SZENpH9cfx7WacFC7BSvUqjBDsRPQIiugURvazeqYVaqAw6dYrJ9WQy7gayj4nYDy3HtQOVQGpYRqKEWXQf2HdGha/AFdae9Xr4czz0ubISRA75ECbSut7agegO75OLxpahze8j5GtifBpzEDLiV30Dd2mNT6StWiCbVmLt5rUkBQCEt2zWzIMSA8HgrIBkLD+Sp0jhHISYXQ/KMYukfvQ3fQxq68XCTBHId/tMTg7LV1CFs4BszJ6hBarBgHlcRv8H7tbuSKQpFPYGe0BmND+nZ0npECaPKf0r4UIxsuoF/IMpitsAVnrA4s15uh3x8fwLXkLobUZGJIXTqcUzbDaJE5FAVq0t4S7dEcjqMEc6B2K5arVWN6Z6AbdOmm5mJelQKOHWSxF44Cy4CqxW0s6RwchCovFRohdGNfLgX3WiZ0N4aD++y7jfwYJUrAPCle/ZjKV+BFTSegrGAZIm3QjXhBytTWB3zhByzryMUU986jz16wD+96ijCNUIAgmkc3tS6G7GERjCbgR82B4OTbEESqIiCIcqsIYzoGGyrBEMSmgh8xBoIIAR2fAHZhj8Z9DOhl9FHeKkSDvn809fuc+iyCddRYaiOZBTvIt1YJfs0b4N+WDO+GHPLQN2Ab7S61vjJV60C9SRPvNSqzTpxlyQfS1dGUmjppK7gW16B/LhN6abnQu5cDwzO3YNhhqqK4WJY887sEdGzWFpxfOxmDpKZOOvgWFB8sx9L6nShvP4FyUQjKGg5gScpGKEqbUE7RxiGYv6QQ4zIG/r4D2m88sjEy/EIW/a6+TQ4gHe5VhXCvy4JL7gLYnesI2i6t4Tii04r92u1YKt767gB0ozrkGzmY26zEOh7Hkt+kAKhLTX9qOVVdg9aoNOjcToR+wUVKLYKgN0Zq7l7884wn9CKgr4AfWw/B6SwqKQRKOdXVghe9CpbherASSjtIpGpxRIHFjwygNreoXy0lb+lU7lHJBP9kPcGXQnBNghUB/Lh44fbUp5JA+5Hs71LbPPLCVRDEJZDNGIJgeQI6mG6KegKzldq1U7tGKjQmHR8vwl86kgRoAQN0xBw6ztn0nQ/ocxEdQ7L4d/BjG6g+m8aZTL/xsXPuW82Fb8t+DG1Ox5D6XAwqvQ67OA+p9ZWoUQPsei78mjSwNU9GLmEzVGZJTd3qFPTn3YZhXgYMMjNhlHsDxms/hNWfoUdrNPgEc2h7BG5d/Bo7Blt0BuNxXf4MVmXrkdRyEHWiY6hr2oc7mevRX2wc18gioEeI1+N9a+/CNnImVAZ0mhEoNOPAJT8MHjUF8KTiWhqHgbfMpVaJdhLQh3XasU9bJAZ6ekeg6zQwgEKuLSWysmd3QGmatLqD8qDNug3dCX/AIPk4jGr2wDB/JXTmkan70IvmZTY/rB9BdZlKLkG0lG0d5klAObKsw1+jzyFiWPnRawiaDrMYwTyMwMwh220WP2IWFVfqN4CKO8E3n0C6R/ZUej9Y2kUiMdDRFTRePH3nA3q/m7xpAEtAXl0QrkTwscnmS/3eptdzNEYevZLnZ5booqk8tuYs9tAny+n1LL1mghezlcULH0VtHamOZhvhIvoNOXQsd2EZIbluYnlWaMO75TCFG9kYXJ8H14o76H/10Z3yClSrCm6jGtbWK7LC7kIlYRfUmY2XHnUa+mbXYRSfCuNCptyE6b1jMBD/EPKwchQPLxGdxOWWI8iKXYBPqLozgI8pfA5YBWvxbfMeNLUfRmPTLjRnr8YKsdGvRQ5j2zZTSSRQ78H+7GhxfScFAINypsG9ukDspZ0LKKE+O0pqlGi71ggcIqD3dga6RhFKjSqYT+VEFkvu/E9Q+HNWKaE2VVDgVkPFqwAaay5CN3En9M59BM2vfKDs7AvljjPGE5LlharQdL+LoCmhOHU0rIUyD+NgVTOa+q2iVQiIcAKpHtbhXuJOjPqeVCRYThNE6VTvKNs3hM3cHGIxntxKyCbP7Erj1lHZJbVIJAG6iiCroZCAPGukvOyASJbvCgoaAoKoAQ1kHcGC7nmZDkmhBR2PfSQLtkcl4zCSAE2eO6qExYuYxrE4KqdvelBiM4+ncYQy1IY8d0wbhUSLJAZGbsUceNYdwJCGPAyuy4NbZToG3JoO1Qk9AvHvqF4ejo0KCKlisyl04Jw+AE1ma71HRUJP+QqM1t2HcVEyTEoSYVYQCuN3HenCt4XDhGA+KorAnYZ9KIj5ELOl3XpU/k/wrt+OmraDaG7cjpacbxFvYAAZDG5Vw/DWCxjRdp+ATsWAS6+D69H1+XDNsoVb1T06b0VwzCmBIOYdqUWibTojcFBH1CXQctBtUcA6Oh/RmVC4sBmKA5j6erC1qqE4sRpqG25A43QIOHuXgvOmP5R4ZH6m5UY2L9SSLjZ5sKjjsI/o8olH8ngjCZoSgmw9DMIl3t42Up0g+pq89/sEjLK47knZhSkSuDepJP4JOyNJyEFAR8VQKMOR1nbWM69yxNJYwh+VLE90ffPyxLE3EwL9Jq0huWQqwL1iA7zq8+FVl0+epgBO6T+gb2TH+OglqgastxtZrNNlkLt8E5oJx6HZdab7mFZBk3UZRjMewCT7HkzLfodZxREYr5sBjiIBPYiAPt8ehvSGPSg5vwjzpd16VNkmmDTswp22QDTXbkJrxhJkzHGDFoUQmvBpvo2hrZl0TnLhlLIYfUO7nt7dSg3hURcP1/JiDEgphuXBqVKLRFsfA3oJAf3mI6Cr2OjTwGYdqWGzzmZD6WoYVCfehdqsZKjuuwS1oB1Q+5piHac3oaxBzZ9vLZ4nHEeesoXg6niDPSYWP9yUgD5PHu48eKE64krHcErchHIEuRysTpAXjObQWIYEHiV4EQYEojp5aEoyY+IIpOQugKYYOnIdJXrdJ63PtWwXMQM6m6SVT4gfZkbHV0XHsVtaQ3K8yoJr0YfwoHDDq5ZiQSqDik/B4Q9taYtn18gyNia1qGJsmTrGlUjK2FJ1jCjRwOASDnkxDvN95ZD/og5yl0qgfCMJ2leDoeksHaFHXYOJVyrMkm/DrPwMzGr2wmjnLGipthyHL0W7t9pDkduwF2U3lmGFtvbTdyirt0OreT+iWwPRUrUBbSkLkT/fCUZwKVYikBMwpDlPXNzLwuAQ2rWX8KzUh2dDDJyLSmB7/S5Mf3WRWiR6CPSezkCXQs6qBnLCKsheyoXqnTCoL9oOFd9/Qtl9KJT6UJMX3/zhCz8iuCjhiviSYtMx3ZTJBN8lCE7eIRgF0p6krRRaRBDskTTGySBKws5SuUjJHYUiMQdpzCUE0Q3y5MnSDhJJQg5JUvjSgO5hHZofaioGmvc40IycMgbRtJktjgOZ5Ma9irzSg46xYHcaVEZevkgBHqUWGFK+FENKQ+BdGAq/wiMYWbwHI6h4FwTDOes0BMKFMHxPNg9qn1dANakYanfuQSs5FJoTpaP1qBswsSGgb9+EeUU0Af0LDH4dBhXlmv3wajuOpPYQFDcEojxtNQ6sn9ZzUsiofjfUWg/iYOt+tJatRtvN95DqZgxNuKTKwLV4Jdyqc8Wz1uCGTLjmDIVDQqewQ8anwpJi6GsYkF4Ey2O/QvsfXKlJIgboAwT07s5AZ0G1TylUIsuhdKMI6vcuQ3PVAqg+9UZ8JvGEywiuNoIwD4IzaV2X+HSa1otgE3+NwJImVkycG0kx8snfyUZJW+QFApeSu+hN9BpIn6n+ZBp9bqDv+C8Fum+8IpzzJNOmR3UhTaGFcC07iAHXmamuZw28C/S/aIt+CcthF7+ToN0EQdhqOFzcBu/Sm/ApvAGX3DzYXIiF9jtWTJf74L6ZC83UfGg8SId2xnloSZKxp+gWjC0J6KSrMK8KhmnlSugtInpkCzaBV78Hl5oPoaLpECrLt+Bi4jfgS7t1q+YDUGsPwj5KDFsLlqD97JuIpmpZmP+TftM1ezjlxsOllM4H3eReDWHwKrOBW84jqMeK5OBTv4Bu6HxxgqU1s/N3MkAHSoH+ioCe+gjoJHB0s8ENLID6/UJo3E+GVlwoNEwY278tXhR50RhmeexzgmM8JXjdF36MHwEoiXn70Csv6gxBm8PiRc6gJFD1HDzFpq1cP0omo5QJZAfqQzH0f6uHZjQgeR4cC/IJZCnUtSkYVPAWBiX2/CdU/S7Ql+9TgtFCTaiP0qAEXA2yRsqwuzECziWZcM4tgv2DSljF7ID+l+JNh9+hY38HuvcYmLOhk5EEnVPfQOmpW+33YGaXhj53E2BWuxvGebOh5cPUX/sWSgXrsa9mB2qaDqCK4C7I2IA3jn8u7tat2g6D034MIbWb0fZgHlr2DscXUhNNuYdkYRPrg/7JiXDMLYBrZS6GNEZgVJM/JjWY4I16G4xr/BCDq2nKjjoAvY+Zpwo7eXBskQK9Swr0lEdAn4a2wk3o/DMNWmn54KYUQIuZsebGQuXFQ42H4kfNk4QckSOkNZ1lGkGAUoInOKkAm2jJsVtH+om9Nj9ytZxNcNdhljXByo+JJXj/i4G2u2xM02YInPJLxFB7VudTPH0ZHkWu0hbPpwHpfnAszoFDVgVsb1fDMmoL9L8S7wTFQE/1AvR33oB+QSp0czKgl34B2iO9uwJCKib5SGaZjbqLPlkhMG1YDr1gQyioSs24vQTDitagsnIL6loCUVu9C2EJK9FjYtsWBNP2Q7hb9A155zdwY5mTeGexo0w32hEcy2F7JQaOqZfgk38KY6rDMKFBiGHNt+iGPgCNYd0/s/sbAb2fgN5JQC9Wq8bkR0AzioOOx3Xo30mGbnY+tNMKoJOQCm03qfnFxRf6E1yUFAqZJcyuZRWuQmB+TWHJcgJfkjPxImcSSIUsXviMx/O9DvqfALrPDjb6nhuBAWkZ5JFKKTYuIqhz4FUdAo9CGwzO7Ra2LjUg0w9OxdlwyKxAXzHQm8lDi4HeAT1WMPSHnYXR7aswKE6Gfl4K9PdfgZ6+uG8XSmMbKyXD/LsEmFduglH2NHA7rA3Hvg+Ve1/gYO4KNFRvQUPLQVRU7MG4yn1dJ4eiULAo3JhW9xsa77+Hml8GY8FQ425uAM5wRRivNoPlTjs4XhoH35oLGFZ/S/wglyDkbWmrrsUAvY+A3kHlSwJ6ihKzCvLnuQyElmIs9LdfhmHxA+jn5kI3jcrRFOjxU6DTbTx9DybsOBh0f034EeYEVyaFD0IYhnQ9y1pTIsiPvU5AnKYkUBL78yKmQhDLgDRPSWtPp/HFkFtHqFCfRBr73wX67qsD+qFsEubCnqKBAZllcCkkT12RjSHVMfApH0bJXfcH+aQGZg6FU1EWeeoK2NwgoMM3Q++zP/fq/Smf2g392ZEwzk2Acfl9GBHURmuSYPyn132oHBizH8B8wjX0SadQI2cWtOZZQbHTdEgRn8XN93EiczFayn5GU3Mg7lJMPab5SEeoCWZZ0TF4Ne/A/ZSPUbXdDz9Qdddrrk/KtcwR7jX34VXDzGCFGFT0GzyLu922x069kdiv145tOu34jlOHBWoz4arUAZQt0LYOhmFcHJ2H6zAsYnZDc2FwKhv60+m9UQrLUJ4hSYQAVhpM1O6jj30EDD33Q6frZyoY8cMVaWZZR560kuB5V9H6iVUas+Py5L1/IHsT2ZldR4nEkMdkUd8Y8tYd43mLIMhYhenDWvgjQSQiGFOkiEv0rEAzK2u8yG10M2WwBWFdb6q9NKDNd6rCOuYD9L2VI/57QMfcEniU5cCnJgG+lR9haAnz4MzT5ZjmA4e8HBqnGtYXamF+nK7bpx0uwHxoqGyE3sKD5HHjYVJ1C6Z5qTD5Ph2G1hnQEV/0LBhxU2E+4yYsbgTCJGsuNBfYQrnjA0CPxDo2CRYJ0xGesgD1ZWvQ3LQbKeSJ54uC0UcUDVVRGExFR/FB2y7cSf4C+Zv9sXSUeQ9P2z2pQdnmBHQsPKqKqFCyWJsM75o1GMw8O/iEhFZs/KK9CD9wRfhCTYTP1dqwnBOHrQYz8IuuH5ZxxI/MLQZH5kfoeu6D4cVQGNecgXHFbRgXZsD4Xg5MjqfDeE0KTBbRDLXsLiwOR8HkxCJoOs+Eavdr08ZBBGdYP7rYzAZILsH3LYUYtgSsAXlYRwLqW0r8Ksl2id4/Onaz47IE+kayUfwddYhsgwkqXRrLgOpHEuyhVF9B7ytoTAL//qNjeFagGfGEi5nvYPEifqOx/ek4p1J/8aKBWC8N6Icy2+oL6zOhECTmw46SuoHZpXBn/pK7/DK8K1bCp3Q0vAv7wqfIBD55OuS9teFVYASPfAFccseThw+E4Ho5LOMqYB6ZCeOdK6H1bleJH2sOOPZradqlC3otDqY5F2GafQmmCZdgFnMBZteEML2yCnprh0CZWVp66gbDuD5Q2uSLUacm43jSB0gq+h55JeuRX7wRqUUbkJL8DS4GTcPqCdZgduZ6XiZjgvcp9fIY3aAH/yY+3KvcMDBjLSXQBXDML4VbaQG8a9PgUxcOzyIneKY/Or6FHDO8q7INY+RiMFJaJijE4i2VeEylej/FDs99TAPH8Dvofv8bDK/vhVHxMRhX0W+vOgXTijiY5UXANGkNnYeRUGN2VrsPNx6XVaQNgRNM03sBgUjeOKJJ/Cr+LNzFsg61YB5/elyKtic0qM031CaZAG0gqJnVEuYBIoI49gy9D6DXrQR3GoU2j3YE+WE2FI9TGBG1FLywnhNbPt1Y/OhY+o5iGqsGNmdLaVxfqZUB+g0Iztwi2AOkNZ3FCzOm30bHeHK9tKYHKfPZMFhlAtM9c2EpjALv93zY3qlE/8xyOOUVUTiSBrfy83CvDIdbRZC4uJSGwzHzd0qgkmEVfRnGW/dC79vPobtkFLRmm0HDpVt43MnrzoOm/dfQeeOf0P3wB+guJogXrIDuhHfAsdOFbKdQ5GkaYQbNNYNht2c8/AOnYNKB6Ri//Q14zRwIuohdPC76pCbWKGFCkx9GNC7B0NZD8CiJh8Odi7A59zud7EuwvU4hVUYZBhUXwqsqA56V0RiUM1Dam36UoiyFuprQhc6fRZuKKhV5+rcLKD2hrPQ+NPsvgNb0j6C9eCG0v/kU2l9/BK0ZM8EdRJQ833noG8Qib6lDkA0lYD6i8GIJlffZ/IhhbJtQjW4TP164EiWWztTnH9T+a4L/MxpjAn02hWWYDAQnefSZzm7Io7zDOpiSzGh3grwPwd3zDccPZdH4phBEkXcWBrD4wlE07qObw5pmBUGsK43T/YPfgmAFWEe5U2EeCXhGcV5nQ3u2KrTf6w+jdTNhtud7mB/ZC4vg43QAwbAMDYLF0e3os+8HGP80D7oLx0F9dD+oj9AGZ4Y85K0Yj/Vs3kQiFgeybFPIySiDzdwAz9O3JzHjPNtYk8gjv948FOOatlGodR0Dk07Bau9n0F8wFBp+luBO1CXeuDD51Q3830PRP7UIzgUlcC0vhHPRSdic6eI53ecT3W0sKyjI2EFRxhzyz3sOO8voBkEUTclYhAyshCwr642PR79diwlbBOEs8vLMFjgbbuelhpeoz5rEDxsNNl/+9ON5RWJOLsXCysQdh5IhWWbzhUmoel6v/l/RxGpZTKgbh3EtEZQMp5AX2ASd2f3AVu7695ky/7nOuc2U/BZSCFIGp+I82F/rfprsVa/+Mk0sZ2F0tTvGNZ+gRO8B7C/HQ92beWine+/IDWDBbJUmbBN/hUNOGRyyStH34vfQeP3ZV4R61atXIu9Kefg1rIB/XRJciwso9nymLXmxbP+wxcCsVAxIKwfv1AZoDH96jN6rXr1SuVeowKsuFINrs+BSXATbc59JLU/XwCwdDMw7B/vUEpgHfQYZ7v9HCNar/2E55ynDpSwYrhXF4uKUeQiY0/Oy3kM555nCITcJgmvp0F30Yo8L9KpXL1X9E2XhkPoVBuYWwbmolKDOhmv+WHiXyGNkgbTRE1pOublXkRycCz+AfUoRzPdsgKJN1w/19KpXf7n6xlnCPikE/SkWdswrozDkNoZUfIWhFTYYWaPy4a6NkgSR2XAZXSOLIWUWcCv7FP1T7sH8wFZwp7ycxz971auXIm4AG+b77MFLEKLv7ULJMy0FefCsPAOv0t0YUrIMg0s+gVfxYrgVbIJLUSzsrl2F2ZZl4L7J/Pdp/956ca969UrEna0O41/HwSJ4F3in42Fz5Trsbt5Bv3u30e9uImyvnoV15GGY/LIA6kOZP1966pZ8r3r1n5eqhwZ0F/aB4ToHGK9zh/FPHjD60RE6H1tDaaA2cdy7mvFfI+BffksPNrEksu0AAAAASUVORK5CYII=",S}),define("Scene/MapboxImageryProvider",["../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/DeveloperError","../Core/MapboxApi","../Core/Resource","./UrlTemplateImageryProvider"],function(l,u,c,e,d,h,p,f,m){"use strict";var g=/\/$/,_=new l({text:" Mapbox  OpenStreetMap",link:"https://www.mapbox.com/about/maps/"}),v=[new l({text:"Improve this map",link:"https://www.mapbox.com/map-feedback/"})];function t(e){var t=(e=u(e,u.EMPTY_OBJECT)).mapId;if(!c(t))throw new h("options.mapId is required.");c(e.proxy)&&d("MapboxImageryProvider.proxy","The options.proxy parameter has been deprecated. Specify options.url as a Resource instance and set the proxy property there.");var r=e.url;c(r)||(r="https://api.mapbox.com/v4/"),this._url=r;var i=f.createIfNeeded(r,{proxy:e.proxy}),n=p.getAccessToken(e.accessToken);this._mapId=t,this._accessToken=n,this._accessTokenErrorCredit=p.getErrorCredit(e.accessToken);var o=u(e.format,"png");/\./.test(o)||(o="."+o),this._format=o;var a=i.getUrlComponent();if(g.test(a)||(a+="/"),a+=t+"/{z}/{x}/{y}"+this._format,i.url=a,i.addQueryParameters({access_token:n}),c(e.credit)){var s=e.credit;"string"==typeof s&&(s=new l({text:s})),_=s,v.length=0}this._resource=i,this._imageryProvider=new m({url:i,credit:_,ellipsoid:e.ellipsoid,minimumLevel:e.minimumLevel,maximumLevel:e.maximumLevel,rectangle:e.rectangle})}return e(t.prototype,{url:{get:function(){return this._url}},ready:{get:function(){return this._imageryProvider.ready}},readyPromise:{get:function(){return this._imageryProvider.readyPromise}},rectangle:{get:function(){return this._imageryProvider.rectangle}},tileWidth:{get:function(){return this._imageryProvider.tileWidth}},tileHeight:{get:function(){return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._imageryProvider.errorEvent}},credit:{get:function(){return this._imageryProvider.credit}},proxy:{get:function(){return this._imageryProvider.proxy}},hasAlphaChannel:{get:function(){return this._imageryProvider.hasAlphaChannel}}}),t.prototype.getTileCredits=function(e,t,r){var i=v.slice();return c(this._accessTokenErrorCredit)&&i.push(this._accessTokenErrorCredit),i},t.prototype.requestImage=function(e,t,r,i){return this._imageryProvider.requestImage(e,t,r,i)},t.prototype.pickFeatures=function(e,t,r,i,n){return this._imageryProvider.pickFeatures(e,t,r,i,n)},t}),define("Scene/SingleTileImageryProvider",["../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/DeveloperError","../Core/Event","../Core/GeographicTilingScheme","../Core/Rectangle","../Core/Resource","../Core/RuntimeError","../Core/TileProviderError","../ThirdParty/when"],function(c,d,h,e,p,f,m,g,_,v,y,b,C){"use strict";function t(e){if(e=d(e,{}),!h(e.url))throw new f("options.url is required.");h(e.proxy)&&p("SingleTileImageryProvider.proxy","The options.proxy parameter has been deprecated. Specify options.url as a Resource instance and set the proxy property there.");var r=v.createIfNeeded(e.url,{proxy:e.proxy}),t=d(e.rectangle,_.MAX_VALUE),i=new g({rectangle:t,numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1,ellipsoid:e.ellipsoid});this._tilingScheme=i,this._resource=r,this._image=void 0,this._texture=void 0,this._tileWidth=0,this._tileHeight=0,this._errorEvent=new m,this._ready=!1,this._readyPromise=C.defer();var n=e.credit;"string"==typeof n&&(n=new c({text:n})),this._credit=n;var o,a=this;function s(e){a._image=e,a._tileWidth=e.width,a._tileHeight=e.height,a._ready=!0,a._readyPromise.resolve(!0),b.handleSuccess(a._errorEvent)}function l(e){var t="Failed to load image "+r.url+".";o=b.handleError(o,a,a._errorEvent,t,0,0,0,u,e),a._readyPromise.reject(new y(t))}function u(){C(r.fetchImage(),s,l)}u()}return e(t.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){if(!this._ready)throw new f("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth}},tileHeight:{get:function(){if(!this._ready)throw new f("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready)throw new f("maximumLevel must not be called before the imagery provider is ready.");return 0}},minimumLevel:{get:function(){if(!this._ready)throw new f("minimumLevel must not be called before the imagery provider is ready.");return 0}},tilingScheme:{get:function(){if(!this._ready)throw new f("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready)throw new f("tileDiscardPolicy must not be called before the imagery provider is ready.")}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}}),t.prototype.getTileCredits=function(e,t,r){},t.prototype.requestImage=function(e,t,r,i){if(!this._ready)throw new f("requestImage must not be called before the imagery provider is ready.");return this._image},t.prototype.pickFeatures=function(e,t,r,i,n){},t}),define("Scene/GetFeatureInfoFormat",["../Core/Cartographic","../Core/defined","../Core/DeveloperError","../Core/RuntimeError","./ImageryLayerFeatureInfo"],function(l,u,i,c,h){"use strict";function n(e){for(var t=[],r=e.features,i=0;i<r.length;++i){var n=r[i],o=new h;if(o.data=n,o.properties=n.properties,o.configureNameFromProperties(n.properties),o.configureDescriptionFromProperties(n.properties),u(n.geometry)&&"Point"===n.geometry.type){var a=n.geometry.coordinates[0],s=n.geometry.coordinates[1];o.position=l.fromDegrees(a,s)}t.push(o)}return t}var p="http://www.mapinfo.com/mxp",r="http://www.esri.com/wms",o="http://www.opengis.net/wfs",a="http://www.opengis.net/gml";function s(e){var t=e.documentElement;if("MultiFeatureCollection"===t.localName&&t.namespaceURI===p)return function(e){for(var t=[],r=e.documentElement.getElementsByTagNameNS(p,"Feature"),i=0;i<r.length;++i){for(var n=r[i],o={},a=n.getElementsByTagNameNS(p,"Val"),s=0;s<a.length;++s){var l=a[s];if(l.hasAttribute("ref")){var u=l.getAttribute("ref"),c=l.textContent.trim();o[u]=c}}var d=new h;d.data=n,d.properties=o,d.configureNameFromProperties(o),d.configureDescriptionFromProperties(o),t.push(d)}return t}(e);if("FeatureInfoResponse"===t.localName&&t.namespaceURI===r)return function(e){var t,r=e.documentElement,i=[],n=r.getElementsByTagNameNS("*","FIELDS");if(0<n.length)for(var o=0;o<n.length;++o){var a=n[o];t={};for(var s=a.attributes,l=0;l<s.length;++l){var u=s[l];t[u.name]=u.value}i.push(g(a,t))}else for(var c=r.getElementsByTagNameNS("*","FeatureInfo"),d=0;d<c.length;++d){var h=c[d];t={};for(var p=h.childNodes,f=0;f<p.length;++f){var m=p[f];m.nodeType===Node.ELEMENT_NODE&&(t[m.localName]=m.textContent)}i.push(g(h,t))}return i}(e);if("FeatureCollection"===t.localName&&t.namespaceURI===o)return function(e){for(var t=[],r=e.documentElement.getElementsByTagNameNS(a,"featureMember"),i=0;i<r.length;++i){var n=r[i],o={};d(n,o),t.push(g(n,o))}return t}(e);if("ServiceExceptionReport"===t.localName)throw new c((new XMLSerializer).serializeToString(t));return"msGMLOutput"===t.localName?function(e){for(var t,r=[],i=e.documentElement.childNodes,n=0;n<i.length;n++)if(i[n].nodeType===Node.ELEMENT_NODE){t=i[n];break}if(!u(t))throw new c("Unable to find first child of the feature info xml document");for(var o=t.childNodes,a=0;a<o.length;++a){var s=o[a];if(s.nodeType===Node.ELEMENT_NODE){var l={};d(s,l),r.push(g(s,l))}}return r}(e):function(e){var t=(new XMLSerializer).serializeToString(e),r=document.createElement("div"),i=document.createElement("pre");i.textContent=t,r.appendChild(i);var n=new h;return n.data=e,n.description=r.innerHTML,[n]}(e)}function d(e,t){for(var r=!0,i=0;i<e.childNodes.length;++i){var n=e.childNodes[i];n.nodeType===Node.ELEMENT_NODE&&(r=!1),"Point"!==n.localName&&"LineString"!==n.localName&&"Polygon"!==n.localName&&"boundedBy"!==n.localName&&(n.hasChildNodes()&&d(n,t)&&(t[n.localName]=n.textContent))}return r}function g(e,t){var r=new h;return r.data=e,r.properties=t,r.configureNameFromProperties(t),r.configureDescriptionFromProperties(t),r}var f=/<body>\s*<\/body>/im,m=/<ServiceExceptionReport([\s\S]*)<\/ServiceExceptionReport>/im,_=/<title>([\s\S]*)<\/title>/im;function v(e){if(!f.test(e)&&!m.test(e)){var t,r=_.exec(e);r&&1<r.length&&(t=r[1]);var i=new h;return i.name=t,i.description=e,i.data=e,[i]}}return function(e,t,r){if(!u(e))throw new i("type is required.");if(this.type=e,!u(t))if("json"===e)t="application/json";else if("xml"===e)t="text/xml";else if("html"===e)t="text/html";else{if("text"!==e)throw new i('format is required when type is not "json", "xml", "html", or "text".');t="text/plain"}if(this.format=t,!u(r))if("json"===e)r=n;else if("xml"===e)r=s;else if("html"===e)r=v;else{if("text"!==e)throw new i('callback is required when type is not "json", "xml", "html", or "text".');r=v}this.callback=r}}),define("Scene/WebMapServiceImageryProvider",["../Core/combine","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/DeveloperError","../Core/freezeObject","../Core/GeographicTilingScheme","../Core/objectToQuery","../Core/queryToObject","../Core/Resource","../Core/WebMercatorTilingScheme","../ThirdParty/Uri","./GetFeatureInfoFormat","./UrlTemplateImageryProvider"],function(e,o,a,t,s,l,r,u,i,n,c,d,h,p,f){"use strict";function m(e){if(e=o(e,o.EMPTY_OBJECT),!a(e.url))throw new l("options.url is required.");if(!a(e.layers))throw new l("options.layers is required.");a(e.proxy)&&s("WebMapServiceImageryProvider.proxy","The options.proxy parameter has been deprecated. Specify options.url as a Resource instance and set the proxy property there.");var t=c.createIfNeeded(e.url,{proxy:e.proxy}),r=t.clone();t.addQueryParameters(m.DefaultParameters,!0),r.addQueryParameters(m.GetFeatureInfoDefaultParameters,!0),a(e.parameters)&&t.addQueryParameters(g(e.parameters)),a(e.getFeatureInfoParameters)&&r.addQueryParameters(g(e.getFeatureInfoParameters));var i={};i.layers=e.layers,i.bbox="{westProjected},{southProjected},{eastProjected},{northProjected}",i.width="{width}",i.height="{height}",1.3<=parseFloat(t.queryParameters.version)?i.crs=e.tilingScheme instanceof d?"EPSG:3857":"CRS:84":i.srs=e.tilingScheme instanceof d?"EPSG:3857":"EPSG:4326",t.addQueryParameters(i,!0),r.addQueryParameters(i,!0);var n={query_layers:e.layers,x:"{i}",y:"{j}",info_format:"{format}"};r.addQueryParameters(n,!0),this._resource=t,this._pickFeaturesResource=r,this._layers=e.layers,this._tileProvider=new f({url:t,pickFeaturesUrl:r,tilingScheme:o(e.tilingScheme,new u({ellipsoid:e.ellipsoid})),rectangle:e.rectangle,tileWidth:e.tileWidth,tileHeight:e.tileHeight,minimumLevel:e.minimumLevel,maximumLevel:e.maximumLevel,subdomains:e.subdomains,tileDiscardPolicy:e.tileDiscardPolicy,credit:e.credit,getFeatureInfoFormats:o(e.getFeatureInfoFormats,m.DefaultGetFeatureInfoFormats),enablePickFeatures:e.enablePickFeatures})}function g(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r.toLowerCase()]=e[r]);return t}return t(m.prototype,{url:{get:function(){return this._resource._url}},proxy:{get:function(){return this._resource.proxy}},layers:{get:function(){return this._layers}},tileWidth:{get:function(){return this._tileProvider.tileWidth}},tileHeight:{get:function(){return this._tileProvider.tileHeight}},maximumLevel:{get:function(){return this._tileProvider.maximumLevel}},minimumLevel:{get:function(){return this._tileProvider.minimumLevel}},tilingScheme:{get:function(){return this._tileProvider.tilingScheme}},rectangle:{get:function(){return this._tileProvider.rectangle}},tileDiscardPolicy:{get:function(){return this._tileProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._tileProvider.errorEvent}},ready:{get:function(){return this._tileProvider.ready}},readyPromise:{get:function(){return this._tileProvider.readyPromise}},credit:{get:function(){return this._tileProvider.credit}},hasAlphaChannel:{get:function(){return this._tileProvider.hasAlphaChannel}},enablePickFeatures:{get:function(){return this._tileProvider.enablePickFeatures},set:function(e){this._tileProvider.enablePickFeatures=e}}}),m.prototype.getTileCredits=function(e,t,r){return this._tileProvider.getTileCredits(e,t,r)},m.prototype.requestImage=function(e,t,r,i){return this._tileProvider.requestImage(e,t,r,i)},m.prototype.pickFeatures=function(e,t,r,i,n){return this._tileProvider.pickFeatures(e,t,r,i,n)},m.DefaultParameters=r({service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"}),m.GetFeatureInfoDefaultParameters=r({service:"WMS",version:"1.1.1",request:"GetFeatureInfo"}),m.DefaultGetFeatureInfoFormats=r([r(new p("json","application/json")),r(new p("xml","text/xml")),r(new p("text","text/html"))]),m}),define("Scene/TimeDynamicImagery",["../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/JulianDate","../Core/Request","../Core/RequestType"],function(r,i,c,e,t,u,d,h){"use strict";function n(e){e=i(e,i.EMPTY_OBJECT),r.typeOf.object("options.clock",e.clock),r.typeOf.object("options.times",e.times),r.typeOf.func("options.requestImageFunction",e.requestImageFunction),r.typeOf.func("options.reloadFunction",e.reloadFunction),this._tileCache={},this._tilesRequestedForInterval=[];var t=this._clock=e.clock;this._times=e.times,this._requestImageFunction=e.requestImageFunction,this._reloadFunction=e.reloadFunction,this._currentIntervalIndex=-1,t.onTick.addEventListener(this._clockOnTick,this),this._clockOnTick(t)}function l(e,t,r){return e+"-"+t+"-"+r}function p(e){var t=e._times;if(c(t)){var r=e._clock,i=r.currentTime,n=r.canAnimate&&r.shouldAnimate,o=r.multiplier;if(n||0===o){var a,s=t.indexOf(i);if(-1!==s){var l=t.get(s);return 0<o?(a=u.secondsDifference(l.stop,i),++s):(a=u.secondsDifference(l.start,i),--s),a/=o,0<=s&&a<=5?t.get(s):void 0}}}}function f(e,t,r){var i=e._times.indexOf(r.start),n=e._tileCache,o=n[i];c(o)||(o=n[i]={});var a=t.key;if(c(o[a]))return!0;var s=function(e){var t=e.split("-");if(3===t.length)return{x:Number(t[0]),y:Number(t[1]),level:Number(t[2])}}(a),l=new d({throttle:!0,throttleByServer:!0,type:h.IMAGERY,priorityFunction:t.priorityFunction}),u=e._requestImageFunction(s.x,s.y,s.level,l,r);return!!c(u)&&(o[a]={promise:u,request:l},!0)}return e(n.prototype,{clock:{get:function(){return this._clock},set:function(e){if(!c(e))throw new t("value is required.");this._clock!==e&&(this._clock=e,this._clockOnTick(e),this._reloadFunction())}},times:{get:function(){return this._times},set:function(e){if(!c(e))throw new t("value is required.");this._times!==e&&(this._times=e,this._clockOnTick(this._clock),this._reloadFunction())}},currentInterval:{get:function(){return this._times.get(this._currentIntervalIndex)}}}),n.prototype.getFromCache=function(e,t,r,i){var n,o=l(e,t,r),a=this._tileCache[this._currentIntervalIndex];if(c(a)&&c(a[o])){var s=a[o];n=s.promise.otherwise(function(e){throw i.state=s.request.state,e}),delete a[o]}return n},n.prototype.checkApproachingInterval=function(e,t,r,i){var n=l(e,t,r),o=this._tilesRequestedForInterval,a=p(this),s={key:n,priorityFunction:i.priorityFunction};c(a)&&f(this,s,a)||o.push(s),512<=o.length&&o.splice(0,256)},n.prototype._clockOnTick=function(e){var t=e.currentTime,r=this._times.indexOf(t),i=this._currentIntervalIndex;if(r!==i){var n=this._tileCache[i];for(var o in n)n.hasOwnProperty(o)&&n[o].request.cancel();return delete this._tileCache[i],this._tilesRequestedForInterval=[],this._currentIntervalIndex=r,void this._reloadFunction()}var a=p(this);if(c(a))for(var s=this._tilesRequestedForInterval,l=!0;l&&0!==s.length;){var u=s.pop();(l=f(this,u,a))||s.push(u)}},n}),define("Scene/WebMapTileServiceImageryProvider",["../Core/combine","../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/DeveloperError","../Core/Event","../Core/freezeObject","../Core/isArray","../Core/objectToQuery","../Core/queryToObject","../Core/Rectangle","../Core/Resource","../Core/WebMercatorTilingScheme","../ThirdParty/Uri","../ThirdParty/when","./ImageryProvider","./TimeDynamicImagery"],function(f,c,d,m,e,h,p,g,t,_,r,i,v,y,b,n,C,w,S){"use strict";var T=t({service:"WMTS",version:"1.0.0",request:"GetTile"});function o(e){if(e=d(e,d.EMPTY_OBJECT),!m(e.url))throw new p("options.url is required.");if(!m(e.layer))throw new p("options.layer is required.");if(!m(e.style))throw new p("options.style is required.");if(!m(e.tileMatrixSetID))throw new p("options.tileMatrixSetID is required.");if(m(e.times)&&!m(e.clock))throw new p("options.times was specified, so options.clock is required.");m(e.proxy)&&h("WebMapTileServiceImageryProvider.proxy","The options.proxy parameter has been deprecated. Specify options.url as a Resource instance and set the proxy property there.");var t=y.createIfNeeded(e.url,{proxy:e.proxy}),r=e.style,i=e.tileMatrixSetID;if(0<=t.url.indexOf("{")){var n={style:r,Style:r,TileMatrixSet:i};t.addTemplateValues(n),this._useKvp=!1}else t.addQueryParameters(T),this._useKvp=!0;this._resource=t,this._layer=e.layer,this._style=r,this._tileMatrixSetID=i,this._tileMatrixLabels=e.tileMatrixLabels,this._format=d(e.format,"image/jpeg"),this._tileDiscardPolicy=e.tileDiscardPolicy,this._tilingScheme=m(e.tilingScheme)?e.tilingScheme:new b({ellipsoid:e.ellipsoid}),this._tileWidth=d(e.tileWidth,256),this._tileHeight=d(e.tileHeight,256),this._minimumLevel=d(e.minimumLevel,0),this._maximumLevel=e.maximumLevel,this._rectangle=d(e.rectangle,this._tilingScheme.rectangle),this._dimensions=e.dimensions;var o=this;this._reload=void 0,m(e.times)&&(this._timeDynamicImagery=new S({clock:e.clock,times:e.times,requestImageFunction:function(e,t,r,i,n){return E(o,e,t,r,i,n)},reloadFunction:function(){m(o._reload)&&o._reload()}})),this._readyPromise=C.resolve(!0);var a=this._tilingScheme.positionToTileXY(v.southwest(this._rectangle),this._minimumLevel),s=this._tilingScheme.positionToTileXY(v.northeast(this._rectangle),this._minimumLevel),l=(Math.abs(s.x-a.x)+1)*(Math.abs(s.y-a.y)+1);if(4<l)throw new p("The imagery provider's rectangle and minimumLevel indicate that there are "+l+" tiles at the minimum level. Imagery providers with more than four tiles at the minimum level are not supported.");this._errorEvent=new g;var u=e.credit;this._credit="string"==typeof u?new c({text:u}):u,this._subdomains=e.subdomains,_(this._subdomains)?this._subdomains=this._subdomains.slice():m(this._subdomains)&&0<this._subdomains.length?this._subdomains=this._subdomains.split(""):this._subdomains=["a","b","c"]}function E(e,t,r,i,n,o){var a,s=e._tileMatrixLabels,l=m(s)?s[i]:i.toString(),u=e._subdomains,c=e._dimensions,d=m(o)?o.data:void 0;if(e._useKvp){var h={};h.tilematrix=l,h.layer=e._layer,h.style=e._style,h.tilerow=r,h.tilecol=t,h.tilematrixset=e._tileMatrixSetID,h.format=e._format,m(c)&&(h=f(h,c)),m(d)&&(h=f(h,d)),a=e._resource.getDerivedResource({queryParameters:h,request:n})}else{var p={TileMatrix:l,TileRow:r.toString(),TileCol:t.toString(),s:u[(t+r+i)%u.length]};(a=e._resource.getDerivedResource({request:n})).addTemplateValues(p),m(c)&&a.addTemplateValues(c),m(d)&&a.addTemplateValues(d)}return w.loadImage(e,a)}return e(o.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return this._minimumLevel}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},format:{get:function(){return this._format}},ready:{value:!0},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}},clock:{get:function(){return this._timeDynamicImagery.clock},set:function(e){this._timeDynamicImagery.clock=e}},times:{get:function(){return this._timeDynamicImagery.times},set:function(e){this._timeDynamicImagery.times=e}},dimensions:{get:function(){return this._dimensions},set:function(e){this._dimensions!==e&&(this._dimensions=e,m(this._reload)&&this._reload())}}}),o.prototype.getTileCredits=function(e,t,r){},o.prototype.requestImage=function(e,t,r,i){var n,o,a=this._timeDynamicImagery;return m(a)&&(o=a.currentInterval,n=a.getFromCache(e,t,r,i)),m(n)||(n=E(this,e,t,r,i,o)),m(n)&&m(a)&&a.checkApproachingInterval(e,t,r,i),n},o.prototype.pickFeatures=function(e,t,r,i,n){},o}),define("Scene/CesiumIonResource",["../Core/Check","../Core/defaultValue","../Core/defined","../Core/loadJson","../Core/Resource","../Core/RuntimeError","../ThirdParty/when","./ArcGisMapServerImageryProvider","./BingMapsImageryProvider","./createTileMapServiceImageryProvider","./GoogleEarthEnterpriseMapsProvider","./MapboxImageryProvider","./SingleTileImageryProvider","./UrlTemplateImageryProvider","./WebMapServiceImageryProvider","./WebMapTileServiceImageryProvider"],function(e,r,n,t,i,o,a,s,l,u,c,d,h,p,f,m){"use strict";function g(e,t,r){i.call(this,e),this.ionEndpoint=t,this.ionEndpointResource=r,this.ionRoot=void 0}function _(e,t){var i,r=function(r,e){return n(e)&&(401===e.statusCode||e.target instanceof Image)?(n(i)||(i=g._loadJson(t).then(function(e){var t=r.ionRoot;return n(t)&&(t.ionEndpoint=e,t.queryParameters.access_token=e.accessToken),e}).always(function(e){return i=void 0,e})),i.then(function(e){return r.ionEndpoint=e,r.queryParameters.access_token=e.accessToken,!0})):a.resolve(!1)};return r._pendingPromise=i,r}return g.create=function(e,t){return new g({url:e.url,retryAttempts:1,queryParameters:{access_token:e.accessToken},retryCallback:_(e,t)},e,t)},n(Object.create)&&((g.prototype=Object.create(i.prototype)).constructor=g),g.prototype.clone=function(e){var t=r(this.ionRoot,this);return n(e)||(e=new g({url:this._url},t.ionEndpoint,t.ionEndpointResource)),(e=i.prototype.clone.call(this,e)).ionRoot=t,e.queryParameters.access_token=t.queryParameters.access_token,e},(g._CesiumIonResource=g)._createRetryCallback=_,g._loadJson=t,g}),define("Scene/CesiumIon",["../Core/Check","../Core/clone","../Core/defaultValue","../Core/defined","../Core/loadJson","../Core/Resource","../Core/RuntimeError","../ThirdParty/when","./ArcGisMapServerImageryProvider","./BingMapsImageryProvider","./Cesium3DTileset","./CesiumIonResource","./createTileMapServiceImageryProvider","./GoogleEarthEnterpriseMapsProvider","./MapboxImageryProvider","./SingleTileImageryProvider","./UrlTemplateImageryProvider","./WebMapServiceImageryProvider","./WebMapTileServiceImageryProvider"],function(o,s,l,u,e,c,d,t,r,i,h,p,a,n,f,m,g,_,v){"use strict";var y={};function b(t){return function(e){return new t(e)}}y.defaultAccessToken=void 0,y.defaultServerUrl="https://api.cesium.com",y.createResource=function(e,t){var r=y._createEndpointResource(e,t);return y._loadJson(r).then(function(e){var t=e.externalType;if(!u(t))return p.create(e,r);if("3DTILES"===t||"STK_TERRAIN_SERVER"===t)return new c({url:e.options.url});throw new d("CesiumIon.createResource does not support external imagery assets; use CesiumIon.createImageryProvider instead.")})},y._createEndpointResource=function(e,t){o.defined("assetId",e),t=l(t,l.EMPTY_OBJECT);var r=l(t.serverUrl,y.defaultServerUrl),i=l(t.accessToken,y.defaultAccessToken),n={url:r+"/v1/assets/"+e+"/endpoint"};return u(i)&&(n.queryParameters={access_token:i}),new c(n)};var C={ARCGIS_MAPSERVER:b(r),BING:b(i),GOOGLE_EARTH:b(n),MAPBOX:b(f),SINGLE_TILE:b(m),TMS:a,URL_TEMPLATE:b(g),WMS:b(_),WMTS:b(v)};return y.createImageryProvider=function(i,e){var n=y._createEndpointResource(i,e);return y._loadJson(n).then(function(e){if("IMAGERY"!==e.type)throw new d("Cesium ion asset "+i+" is not an imagery asset.");var t=e.externalType;if(!u(t))return a({url:p.create(e,n)});var r=C[t];if(!u(r))throw new d("Unrecognized Cesium ion imagery type: "+t);return r(e.options)}).then(function(e){return e.readyPromise.then(function(){return e})})},y.create3DTileset=function(n,o){o=l(o,l.EMPTY_OBJECT);var a=y._createEndpointResource(n,o);return y._loadJson(a).then(function(e){if("3DTILES"!==e.type)throw new d("Cesium ion asset "+n+" is not a 3D Tiles asset.");var t,r=e.externalType;if(u(r)){if("3DTILES"!==r)throw new d("Unrecognized Cesium ion external 3DTILES type: "+r);t=new c({url:e.options.url})}else t=p.create(e,a);var i=o.tilesetOptions;return u(i)?(i=s(i)).url=t:i={url:t},new h(i).readyPromise})},y._loadJson=function(e){return e.fetchJson()},y}),define("Scene/CircleEmitter",["../Core/Cartesian3","../Core/Check","../Core/defaultValue","../Core/defineProperties","../Core/Math"],function(o,t,r,e,a){"use strict";function i(e){e=r(e,1),t.typeOf.number.greaterThan("radius",e,0),this._radius=r(e,1)}return e(i.prototype,{radius:{get:function(){return this._radius},set:function(e){t.typeOf.number.greaterThan("value",e,0),this._radius=e}}}),i.prototype.emit=function(e){var t=a.randomBetween(0,a.TWO_PI),r=a.randomBetween(0,this._radius),i=r*Math.cos(t),n=r*Math.sin(t);e.position=o.fromElements(i,n,0,e.position),e.velocity=o.clone(o.UNIT_Z,e.velocity)},i}),define("Scene/ConeEmitter",["../Core/Cartesian3","../Core/Check","../Core/defaultValue","../Core/defineProperties","../Core/Math"],function(a,t,r,e,s){"use strict";var i=s.toRadians(30);function n(e){this._angle=r(e,i)}return e(n.prototype,{angle:{get:function(){return this._angle},set:function(e){t.typeOf.number("value",e),this._angle=e}}}),n.prototype.emit=function(e){var t=Math.tan(this._angle),r=s.randomBetween(0,s.TWO_PI),i=s.randomBetween(0,t),n=i*Math.cos(r),o=i*Math.sin(r);e.velocity=a.fromElements(n,o,1,e.velocity),a.normalize(e.velocity,e.velocity),e.position=a.clone(a.ZERO,e.position)},n}),define("Scene/createOpenStreetMapImageryProvider",["../Core/appendForwardSlash","../Core/Credit","../Core/defaultValue","../Core/defined","../Core/deprecationWarning","../Core/DeveloperError","../Core/Rectangle","../Core/Resource","../Core/WebMercatorTilingScheme","./UrlTemplateImageryProvider"],function(d,h,p,f,m,g,_,v,y,b){"use strict";var C=new h({text:"MapQuest, Open Street Map and contributors, CC-BY-SA"});return function(e){e=p(e,{});var t=p(e.url,"https://a.tile.openstreetmap.org/");t=d(t),t+="{z}/{x}/{y}."+p(e.fileExtension,"png"),f(e.proxy)&&m("createOpenStreetMapImageryProvider.proxy","The options.proxy parameter has been deprecated. Specify options.url as a Resource instance and set the proxy property there.");var r=v.createIfNeeded(t,{proxy:e.proxy}),i=new y({ellipsoid:e.ellipsoid}),n=p(e.minimumLevel,0),o=e.maximumLevel,a=p(e.rectangle,i.rectangle),s=i.positionToTileXY(_.southwest(a),n),l=i.positionToTileXY(_.northeast(a),n),u=(Math.abs(l.x-s.x)+1)*(Math.abs(l.y-s.y)+1);if(4<u)throw new g("The rectangle and minimumLevel indicate that there are "+u+" tiles at the minimum level. Imagery providers with more than four tiles at the minimum level are not supported.");var c=p(e.credit,C);return"string"==typeof c&&(c=new h({text:c})),new b({url:r,credit:c,tilingScheme:i,tileWidth:256,tileHeight:256,minimumLevel:n,maximumLevel:o,rectangle:a})}}),define("Scene/createTangentSpaceDebugPrimitive",["../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/GeometryInstance","../Core/GeometryPipeline","../Core/Matrix4","./PerInstanceColorAppearance","./Primitive"],function(a,s,l,u,c,d,h,p,f){"use strict";return function(e){var t=[],r=(e=s(e,s.EMPTY_OBJECT)).geometry;if(!l(r))throw new u("options.geometry is required.");l(r.attributes)&&l(r.primitiveType)||(r=r.constructor.createGeometry(r));var i=r.attributes,n=h.clone(s(e.modelMatrix,h.IDENTITY)),o=s(e.length,1e4);if(l(i.normal)&&t.push(new c({geometry:d.createLineSegmentsForVectors(r,"normal",o),attributes:{color:new a(1,0,0,1)},modelMatrix:n})),l(i.tangent)&&t.push(new c({geometry:d.createLineSegmentsForVectors(r,"tangent",o),attributes:{color:new a(0,1,0,1)},modelMatrix:n})),l(i.bitangent)&&t.push(new c({geometry:d.createLineSegmentsForVectors(r,"bitangent",o),attributes:{color:new a(0,0,1,1)},modelMatrix:n})),0<t.length)return new f({asynchronous:!1,geometryInstances:t,appearance:new p({flat:!0,translucent:!1})})}}),define("Scene/CreditDisplay",["../Core/Check","../Core/Credit","../Core/defaultValue","../Core/defined","../Core/destroyObject"],function(m,o,g,u,e){"use strict";var _=100,v="#ffffff",y="#48b";function c(e,t){if(u(e.element))return e.element;var r=e.text,i=e.link;if(e.hasLink()){var n=document.createElement("a");n.textContent=r,n.href=i,n.target="_blank",t.appendChild(n)}else t.textContent=r;return t.className="cesium-credit-text",e.element=t}function l(e,t,r){if(!u(e.element)){var i=e.text,n=e.link,o=document.createElement("img");if(o.src=e.imageUrl,o.style["vertical-align"]=r?"middle":"bottom",u(i)&&(o.alt=i,o.title=i),e.hasLink()){var a=document.createElement("a");a.appendChild(o),a.href=n,a.target="_blank",t.appendChild(a)}else t.appendChild(o);t.className="cesium-credit-image",e.element=t}return e.element}function i(e,t){for(var r=e.length,i=0;i<r;i++){var n=e[i];if(o.equals(n,t))return!0}return!1}function n(e,t){var r,i,n,o=e._displayedCredits.textCredits,a=e._textContainer;for(r=0;r<t.length;r++)if(n=t[r],u(n))if(-1===(i=o.indexOf(n))){var s=c(n,document.createElement("span"));if(u(s)){if(a.hasChildNodes()){var l=document.createElement("span");l.textContent=e._delimiter,l.className="cesium-credit-delimiter",a.appendChild(l)}a.appendChild(s)}}else o.splice(i,1)}function a(e,t){var r,i,n,o=e._displayedCredits.imageCredits,a=e._imageContainer;for(r=0;r<t.length;r++)if(n=t[r],u(n))if(-1===(i=o.indexOf(n))){var s=l(n,document.createElement("span"),!1);a.appendChild(s)}else o.splice(i,1)}function s(e){var t=e.element;if(u(t)){var r=t.parentNode;if(!e.hasImage()&&e.showOnScreen){var i=t.previousSibling;null===i&&(i=t.nextSibling),null!==i&&r.removeChild(i)}r.removeChild(t)}}function b(e,t){var r=e+" {";for(var i in t)t.hasOwnProperty(i)&&(r+=i+": "+t[i]+"; ");return r+=" }\n"}function t(e,t,r){m.defined("container",e);var i=this;r=g(r,document.body);var n=document.createElement("div");n.className="cesium-credit-lightbox-overlay",r.appendChild(n);var o=document.createElement("div");o.className="cesium-credit-lightbox",n.appendChild(o),n.onclick=function(e){e.target!==o&&i.hideLightbox()};var a=document.createElement("div");a.className="cesium-credit-lightbox-title",a.textContent="Data provided by:",o.appendChild(a);var s=document.createElement("a");s.onclick=this.hideLightbox.bind(this),s.innerHTML="&times;",s.className="cesium-credit-lightbox-close",o.appendChild(s);var l=document.createElement("ul");o.appendChild(l);var u=document.createElement("span");u.className="cesium-credit-imageContainer",e.appendChild(u);var c=document.createElement("span");c.className="cesium-credit-textContainer",e.appendChild(c);var d,h,p,f=document.createElement("a");f.className="cesium-credit-expand-link",f.onclick=this.showLightbox.bind(this),f.textContent="Data attribution",e.appendChild(f),d=document.head,h=document.createElement("style"),p="",p+=b(".cesium-credit-lightbox-overlay",{display:"none","z-index":"1",position:"absolute",top:"0",left:"0",width:"100%",height:"100%","background-color":"rgba(80, 80, 80, 0.8)"}),p+=b(".cesium-credit-lightbox",{"background-color":"#303336",color:v,position:"relative","min-height":_+"px",margin:"auto"}),p+=b(".cesium-credit-lightbox > ul > li > a, .cesium-credit-lightbox > ul > li > a:visited",{color:v}),p+=b(".cesium-credit-lightbox > ul > li > a:hover",{color:y}),p+=b(".cesium-credit-lightbox.cesium-credit-lightbox-expanded",{border:"1px solid #444","border-radius":"5px","max-width":"370px"}),p+=b(".cesium-credit-lightbox.cesium-credit-lightbox-mobile",{height:"100%",width:"100%"}),p+=b(".cesium-credit-lightbox-title",{padding:"20px 20px 0 20px"}),p+=b(".cesium-credit-lightbox-close",{"font-size":"18pt",cursor:"pointer",position:"absolute",top:"0",right:"6px",color:v}),p+=b(".cesium-credit-lightbox-close:hover",{color:y}),p+=b(".cesium-credit-lightbox > ul",{margin:"0",padding:"12px 20px 12px 40px","font-size":"13px"}),p+=b(".cesium-credit-lightbox > ul > li",{"padding-bottom":"6px"}),p+=b(".cesium-credit-expand-link",{"padding-left":"5px",cursor:"pointer","text-decoration":"underline",color:v}),p+=b(".cesium-credit-expand-link:hover",{color:y}),p+=b(".cesium-credit-text",{color:v}),h.innerHTML=p,d.insertBefore(h,d.firstChild),this._delimiter=g(t,"  "),this._textContainer=c,this._imageContainer=u,this._lastViewportHeight=void 0,this._lastViewportWidth=void 0,this._lightboxCredits=o,this._creditList=l,this._lightbox=n,this._expandLink=f,this._expanded=!1,this._defaultImageCredits=[],this._defaultTextCredits=[],this._displayedCredits={imageCredits:[],textCredits:[],lightboxCredits:[]},this._currentFrameCredits={imageCredits:[],textCredits:[],lightboxCredits:[]},this.viewport=r,this.container=e}return t.prototype.addCredit=function(e){m.defined("credit",e),e.showOnScreen?e.hasImage()?this._currentFrameCredits.imageCredits[e.id]=e:this._currentFrameCredits.textCredits[e.id]=e:this._currentFrameCredits.lightboxCredits[e.id]=e},t.prototype.addDefaultCredit=function(e){if(m.defined("credit",e),e.hasImage()){var t=this._defaultImageCredits;i(t,e)||t.push(e)}else{var r=this._defaultTextCredits;i(r,e)||r.push(e)}},t.prototype.removeDefaultCredit=function(e){var t;m.defined("credit",e),e.hasImage()?-1!==(t=this._defaultImageCredits.indexOf(e))&&this._defaultImageCredits.splice(t,1):-1!==(t=this._defaultTextCredits.indexOf(e))&&this._defaultTextCredits.splice(t,1)},t.prototype.showLightbox=function(){this._lightbox.style.display="block",this._expanded=!0},t.prototype.hideLightbox=function(){this._lightbox.style.display="none",this._expanded=!1},t.prototype.update=function(){var e,t,r,i,n=[];this._expanded&&u(this._creditsToUpdate)&&(t=(e=this)._lightboxCredits,r=e.viewport.clientWidth,i=e.viewport.clientHeight,r!==e._lastViewportWidth&&(t.style.marginTop=r<576?(t.className="cesium-credit-lightbox cesium-credit-lightbox-mobile","0"):(t.className="cesium-credit-lightbox cesium-credit-lightbox-expanded",Math.floor(.5*(i-t.clientHeight))+"px"),e._lastViewportWidth=r),576<=r&&i!==e._lastViewportHeight&&(t.style.marginTop=Math.floor(.5*(i-t.clientHeight))+"px",e._lastViewportHeight=i),function(e,t){var r,i,n,o=e._displayedCredits.lightboxCredits,a=e._creditList;for(r=0;r<t.length;r++){var s;n=t[r],u(n)&&(-1===(i=o.indexOf(n))?(s=n.hasImage()?l(n,document.createElement("li"),!0):c(n,document.createElement("li")),a.appendChild(s)):o.splice(i,1))}}(this,this._creditsToUpdate),n=this._creditsToUpdate.slice()),function(e){var t,r,i=e._displayedCredits.lightboxCredits;for(t=0;t<i.length;t++)r=i[t],u(r)&&s(r)}(this),this._displayedCredits.lightboxCredits=n},t.prototype.beginFrame=function(){this._currentFrameCredits.imageCredits.length=0,this._currentFrameCredits.textCredits.length=0,this._currentFrameCredits.lightboxCredits.length=0},t.prototype.endFrame=function(){a(this,this._defaultImageCredits),n(this,this._defaultTextCredits),a(this,this._currentFrameCredits.imageCredits),n(this,this._currentFrameCredits.textCredits);var e=this._defaultTextCredits.concat(this._currentFrameCredits.textCredits),t=this._defaultImageCredits.concat(this._currentFrameCredits.imageCredits),r=0<this._currentFrameCredits.lightboxCredits.length;this._expandLink.style.display=r?"inline":"none",function(e){var t,r,i=e._displayedCredits.textCredits;for(t=0;t<i.length;t++)r=i[t],u(r)&&s(r);var n=e._displayedCredits.imageCredits;for(t=0;t<n.length;t++)r=n[t],u(r)&&s(r)}(this),this._displayedCredits.textCredits=e,this._displayedCredits.imageCredits=t,this._creditsToUpdate=this._currentFrameCredits.lightboxCredits.slice()},t.prototype.destroy=function(){return this.container.removeChild(this._textContainer),this.container.removeChild(this._imageContainer),this.container.removeChild(this._expandLink),this.viewport.removeChild(this._lightbox),e(this)},t.prototype.isDestroyed=function(){return!1},t}),define("Scene/DebugAppearance",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","./Appearance"],function(l,u,e,c,d){"use strict";function t(e){var t=(e=l(e,l.EMPTY_OBJECT)).attributeName,r=e.perInstanceAttribute;if(!u(t))throw new c("options.attributeName is required.");u(r)||(r=!1);var i,n=l(e.glslDatatype,"vec3"),o="v_"+t;if("normal"===t||"tangent"===t||"bitangent"===t)i="vec4 getColor() { return vec4(("+o+" + vec3(1.0)) * 0.5, 1.0); }\n";else switch("st"===t&&(n="vec2"),n){case"float":i="vec4 getColor() { return vec4(vec3("+o+"), 1.0); }\n";break;case"vec2":i="vec4 getColor() { return vec4("+o+", 0.0, 1.0); }\n";break;case"vec3":i="vec4 getColor() { return vec4("+o+", 1.0); }\n";break;case"vec4":i="vec4 getColor() { return "+o+"; }\n";break;default:throw new c("options.glslDatatype must be float, vec2, vec3, or vec4.")}var a="attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute float batchId;\n"+(r?"":"attribute "+n+" "+t+";\n")+"varying "+n+" "+o+";\nvoid main()\n{\nvec4 p = czm_translateRelativeToEye(position3DHigh, position3DLow);\n"+(r?o+" = czm_batchTable_"+t+"(batchId);\n":o+" = "+t+";\n")+"gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}",s="varying "+n+" "+o+";\n"+i+"\nvoid main()\n{\ngl_FragColor = getColor();\n}";this.material=void 0,this.translucent=l(e.translucent,!1),this._vertexShaderSource=l(e.vertexShaderSource,a),this._fragmentShaderSource=l(e.fragmentShaderSource,s),this._renderState=d.getDefaultRenderState(!1,!1,e.renderState),this._closed=l(e.closed,!1),this._attributeName=t,this._glslDatatype=n}return e(t.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},attributeName:{get:function(){return this._attributeName}},glslDatatype:{get:function(){return this._glslDatatype}}}),t.prototype.getFragmentShaderSource=d.prototype.getFragmentShaderSource,t.prototype.isTranslucent=d.prototype.isTranslucent,t.prototype.getRenderState=d.prototype.getRenderState,t}),define("Scene/DebugCameraPrimitive",["../Core/Cartesian3","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/FrustumGeometry","../Core/FrustumOutlineGeometry","../Core/GeometryInstance","../Core/Matrix3","../Core/OrthographicFrustum","../Core/OrthographicOffCenterFrustum","../Core/PerspectiveFrustum","../Core/PerspectiveOffCenterFrustum","../Core/Quaternion","./PerInstanceColorAppearance","./Primitive"],function(g,_,v,t,r,i,n,y,b,C,w,S,e,T,E,A,x,P){"use strict";function o(e){if(e=t(e,t.EMPTY_OBJECT),!r(e.camera))throw new n("options.camera is required.");this._camera=e.camera,this._color=t(e.color,_.CYAN),this._updateOnChange=t(e.updateOnChange,!0),this.show=t(e.show,!0),this.id=e.id,this._id=void 0,this._outlinePrimitives=[],this._planesPrimitives=[]}var D=new g,O=new w,I=new A,M=new T,R=new E,L=new S,N=new e,k=new _,F=[1,1e5];return o.prototype.update=function(e){if(this.show){var t,r,i=this._planesPrimitives,n=this._outlinePrimitives;if(this._updateOnChange){for(r=i.length,t=0;t<r;++t)n[t]=n[t]&&n[t].destroy(),i[t]=i[t]&&i[t].destroy();i.length=0,n.length=0}if(0===i.length){var o,a=this._camera,s=a.frustum;o=s instanceof T?M:s instanceof E?R:s instanceof S?L:N,o=s.clone(o);var l=e.frustumSplits,u=l.length-1;u<=0&&((l=F)[0]=this._camera.frustum.near,l[1]=this._camera.frustum.far,u=1);var c=a.positionWC,d=a.directionWC,h=a.upWC,p=a.rightWC;p=g.negate(p,D);var f=O;w.setColumn(f,0,p,f),w.setColumn(f,1,h,f),w.setColumn(f,2,d,f);var m=A.fromRotationMatrix(f,I);for(i.length=n.length=u,t=0;t<u;++t)o.near=l[t],o.far=l[t+1],i[t]=new P({geometryInstances:new C({geometry:new y({origin:c,orientation:m,frustum:o,_drawNearPlane:0===t}),attributes:{color:v.fromColor(_.fromAlpha(this._color,.1,k))},id:this.id,pickPrimitive:this}),appearance:new x({translucent:!0,flat:!0}),asynchronous:!1}),n[t]=new P({geometryInstances:new C({geometry:new b({origin:c,orientation:m,frustum:o,_drawNearPlane:0===t}),attributes:{color:v.fromColor(this._color)},id:this.id,pickPrimitive:this}),appearance:new x({translucent:!1,flat:!0}),asynchronous:!1})}for(r=i.length,t=0;t<r;++t)n[t].update(e),i[t].update(e)}},o.prototype.isDestroyed=function(){return!1},o.prototype.destroy=function(){for(var e=this._planesPrimitives.length,t=0;t<e;++t)this._outlinePrimitives[t]=this._outlinePrimitives[t]&&this._outlinePrimitives[t].destroy(),this._planesPrimitives[t]=this._planesPrimitives[t]&&this._planesPrimitives[t].destroy();return i(this)},o}),define("Scene/DebugModelMatrixPrimitive",["../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/GeometryInstance","../Core/Matrix4","../Core/PolylineGeometry","./PolylineColorAppearance","./Primitive"],function(n,o,t,a,e,s,l,u,c,d){"use strict";function r(e){e=t(e,t.EMPTY_OBJECT),this.length=t(e.length,1e7),this._length=void 0,this.width=t(e.width,2),this._width=void 0,this.show=t(e.show,!0),this.modelMatrix=l.clone(t(e.modelMatrix,l.IDENTITY)),this._modelMatrix=new l,this.id=e.id,this._id=void 0,this._primitive=void 0}return r.prototype.update=function(e){if(this.show){if(!a(this._primitive)||!l.equals(this._modelMatrix,this.modelMatrix)||this._length!==this.length||this._width!==this.width||this._id!==this.id){this._modelMatrix=l.clone(this.modelMatrix,this._modelMatrix),this._length=this.length,this._width=this.width,this._id=this.id,a(this._primitive)&&this._primitive.destroy(),0===this.modelMatrix[12]&&0===this.modelMatrix[13]&&0===this.modelMatrix[14]&&(this.modelMatrix[14]=.01);var t=new s({geometry:new u({positions:[n.ZERO,n.UNIT_X],width:this.width,vertexFormat:c.VERTEX_FORMAT,colors:[o.RED,o.RED],followSurface:!1}),modelMatrix:l.multiplyByUniformScale(this.modelMatrix,this.length,new l),id:this.id,pickPrimitive:this}),r=new s({geometry:new u({positions:[n.ZERO,n.UNIT_Y],width:this.width,vertexFormat:c.VERTEX_FORMAT,colors:[o.GREEN,o.GREEN],followSurface:!1}),modelMatrix:l.multiplyByUniformScale(this.modelMatrix,this.length,new l),id:this.id,pickPrimitive:this}),i=new s({geometry:new u({positions:[n.ZERO,n.UNIT_Z],width:this.width,vertexFormat:c.VERTEX_FORMAT,colors:[o.BLUE,o.BLUE],followSurface:!1}),modelMatrix:l.multiplyByUniformScale(this.modelMatrix,this.length,new l),id:this.id,pickPrimitive:this});this._primitive=new d({geometryInstances:[t,r,i],appearance:new c,asynchronous:!1})}this._primitive.update(e)}},r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),e(this)},r}),define("Shaders/DepthPlaneFS",[],function(){"use strict";return"varying vec4 positionEC;\nvoid main()\n{\nczm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\nvec3 direction = normalize(positionEC.xyz);\nczm_ray ray = czm_ray(vec3(0.0), direction);\nczm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid);\nif (!czm_isEmpty(intersection))\n{\ngl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n}\nelse\n{\ndiscard;\n}\n}\n"}),define("Shaders/DepthPlaneVS",[],function(){"use strict";return"attribute vec4 position;\nvarying vec4 positionEC;\nvoid main()\n{\npositionEC = czm_modelView * position;\ngl_Position = czm_projection * positionEC;\n}\n"}),define("Scene/DepthPlane",["../Core/BoundingSphere","../Core/Cartesian3","../Core/ComponentDatatype","../Core/defined","../Core/FeatureDetection","../Core/Geometry","../Core/GeometryAttribute","../Core/PrimitiveType","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/VertexArray","../Shaders/DepthPlaneFS","../Shaders/DepthPlaneVS","./SceneMode"],function(o,v,a,s,e,l,u,c,d,h,p,f,m,g,_,y,b){"use strict";function t(){this._rs=void 0,this._sp=void 0,this._va=void 0,this._command=void 0,this._mode=void 0}var C=e.supportsTypedArrays()?new Float32Array(12):[],w=new v,S=new v,T=new v,E=new v;return t.prototype.update=function(e){if(this._mode=e.mode,e.mode===b.SCENE3D){var t=e.context,r=e.mapProjection.ellipsoid;s(this._command)||(this._rs=f.fromCache({cull:{enabled:!0},depthTest:{enabled:!0},colorMask:{red:!1,green:!1,blue:!1,alpha:!1}}),this._sp=m.fromCache({context:t,vertexShaderSource:y,fragmentShaderSource:_,attributeLocations:{position:0}}),this._command=new h({renderState:this._rs,shaderProgram:this._sp,boundingVolume:new o(v.ZERO,r.maximumRadius),pass:p.OPAQUE,owner:this}));var i=function(e,t){var r=e.radii,i=t.camera.positionWC,n=v.multiplyComponents(e.oneOverRadii,i,w),o=v.magnitude(n),a=v.normalize(n,S),s=v.normalize(v.cross(v.UNIT_Z,n,T),T),l=v.normalize(v.cross(a,s,E),E),u=Math.sqrt(v.magnitudeSquared(n)-1),c=v.multiplyByScalar(a,1/o,w),d=u/o,h=v.multiplyByScalar(s,d,S),p=v.multiplyByScalar(l,d,T),f=v.add(c,p,E);v.subtract(f,h,f),v.multiplyComponents(r,f,f),v.pack(f,C,0);var m=v.subtract(c,p,E);v.subtract(m,h,m),v.multiplyComponents(r,m,m),v.pack(m,C,3);var g=v.add(c,p,E);v.add(g,h,g),v.multiplyComponents(r,g,g),v.pack(g,C,6);var _=v.subtract(c,p,E);return v.add(_,h,_),v.multiplyComponents(r,_,_),v.pack(_,C,9),C}(r,e);if(s(this._va))this._va.getAttribute(0).vertexBuffer.copyFromArrayView(i);else{var n=new l({attributes:{position:new u({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:i})},indices:[0,1,2,2,1,3],primitiveType:c.TRIANGLES});this._va=g.fromGeometry({context:t,geometry:n,attributeLocations:{position:0},bufferUsage:d.DYNAMIC_DRAW}),this._command.vertexArray=this._va}}},t.prototype.execute=function(e,t){this._mode===b.SCENE3D&&this._command.execute(e,t)},t.prototype.isDestroyed=function(){return!1},t.prototype.destroy=function(){this._sp=this._sp&&this._sp.destroy(),this._va=this._va&&this._va.destroy()},t}),define("Scene/DeviceOrientationCameraController",["../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Math","../Core/Cartesian3","../Core/Matrix3","../Core/HeadingPitchRoll","../Core/Quaternion"],function(i,e,n,o,a,s,t,g){"use strict";function l(e){if(!i(e))throw new n("scene is required.");this.firstTime=!0,this.refMtx=new s,this._scene=e,this._vrControlDisabled=!0,this._alpha=void 0,this._beta=void 0,this._gamma=void 0;var r=this;function t(e){var t=e.alpha;if(!i(t))return r._alpha=void 0,r._beta=void 0,void(r._gamma=void 0);r._alpha=o.toRadians(t),r._beta=o.toRadians(e.beta),r._gamma=o.toRadians(e.gamma)}window.addEventListener("deviceorientation",t,!1),this._removeListener=function(){window.removeEventListener("deviceorientation",t,!1)}}return l.prototype.enableVRControl=function(){this._vrControlDisabled=!1},l.prototype.update=function(){if(!this._vrControlDisabled&&i(this._alpha)){var e=l.getLandscapeValuesFromABG(this._alpha,this._beta,this._gamma);this.applyVRRotation(this._scene.camera,l.getCameraRotationMatrix(this._scene.camera),e)}},l.getLandscapeValuesFromABG=function(e,t,r){var i=l.getQuaternionFromABG(e,t,r),n=g.fromAxisAngle(a.UNIT_Z,1.5708);return g.multiply(i,n,new g)},l.getQuaternionFromABG=function(e,t,r){var i=t,n=r,o=e,a=Math.cos(i/2),s=Math.cos(n/2),l=Math.cos(o/2),u=Math.sin(i/2),c=Math.sin(n/2),d=Math.sin(o/2),h=a*s*l-u*c*d,p=u*s*l-a*c*d,f=a*c*l+u*s*d,m=a*s*d+u*c*l;return 0===p&&0===f&&0===m&&0===h?g.IDENTITY:new g(p,f,m,h)},l.getCameraRotationMatrix=function(e){var t=new s;return s.setRow(t,0,e.right,t),s.setRow(t,1,e.up,t),s.setRow(t,2,a.negate(e.direction,new a),t),t},l.setCameraRotationMatrix=function(e,t){s.getRow(e,0,t.right),s.getRow(e,1,t.up),a.negate(s.getRow(e,2,t.direction),t.direction)},l.prototype.applyVRRotation=function(e,t,r){var i=s.fromQuaternion(g.inverse(r,new s)),n=l.getCameraRotationMatrix(e);if(this.firstTime)s.inverse(i,this.refMtx),s.multiply(this.refMtx,n,this.refMtx);else{var o=new s;s.inverse(t,o),s.multiply(o,n,o),s.multiply(this.refMtx,o,this.refMtx)}s.multiply(i,this.refMtx,t),l.setCameraRotationMatrix(t,e),this.firstTime=!1},l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){return this._removeListener(),e(this)},l}),define("Shaders/EllipsoidFS",[],function(){"use strict";return"#ifdef WRITE_DEPTH\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\n#endif\nuniform vec3 u_radii;\nuniform vec3 u_oneOverEllipsoidRadiiSquared;\nvarying vec3 v_positionEC;\nvec4 computeEllipsoidColor(czm_ray ray, float intersection, float side)\n{\nvec3 positionEC = czm_pointAlongRay(ray, intersection);\nvec3 positionMC = (czm_inverseModelView * vec4(positionEC, 1.0)).xyz;\nvec3 geodeticNormal = normalize(czm_geodeticSurfaceNormal(positionMC, vec3(0.0), u_oneOverEllipsoidRadiiSquared));\nvec3 sphericalNormal = normalize(positionMC / u_radii);\nvec3 normalMC = geodeticNormal * side;\nvec3 normalEC = normalize(czm_normal * normalMC);\nvec2 st = czm_ellipsoidWgs84TextureCoordinates(sphericalNormal);\nvec3 positionToEyeEC = -positionEC;\nczm_materialInput materialInput;\nmaterialInput.s = st.s;\nmaterialInput.st = st;\nmaterialInput.str = (positionMC + u_radii) / u_radii;\nmaterialInput.normalEC = normalEC;\nmaterialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(positionMC, normalEC);\nmaterialInput.positionToEyeEC = positionToEyeEC;\nczm_material material = czm_getMaterial(materialInput);\n#ifdef ONLY_SUN_LIGHTING\nreturn czm_private_phong(normalize(positionToEyeEC), material);\n#else\nreturn czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\nvoid main()\n{\nfloat maxRadius = max(u_radii.x, max(u_radii.y, u_radii.z)) * 1.5;\nvec3 direction = normalize(v_positionEC);\nvec3 ellipsoidCenter = czm_modelView[3].xyz;\nfloat t1 = -1.0;\nfloat t2 = -1.0;\nfloat b = -2.0 * dot(direction, ellipsoidCenter);\nfloat c = dot(ellipsoidCenter, ellipsoidCenter) - maxRadius * maxRadius;\nfloat discriminant = b * b - 4.0 * c;\nif (discriminant >= 0.0) {\nt1 = (-b - sqrt(discriminant)) * 0.5;\nt2 = (-b + sqrt(discriminant)) * 0.5;\n}\nif (t1 < 0.0 && t2 < 0.0) {\ndiscard;\n}\nfloat t = min(t1, t2);\nif (t < 0.0) {\nt = 0.0;\n}\nczm_ellipsoid ellipsoid = czm_ellipsoidNew(ellipsoidCenter, u_radii);\nczm_ray ray = czm_ray(t * direction, direction);\nczm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid);\nif (czm_isEmpty(intersection))\n{\ndiscard;\n}\nvec4 outsideFaceColor = (intersection.start != 0.0) ? computeEllipsoidColor(ray, intersection.start, 1.0) : vec4(0.0);\nvec4 insideFaceColor = (outsideFaceColor.a < 1.0) ? computeEllipsoidColor(ray, intersection.stop, -1.0) : vec4(0.0);\ngl_FragColor = mix(insideFaceColor, outsideFaceColor, outsideFaceColor.a);\ngl_FragColor.a = 1.0 - (1.0 - insideFaceColor.a) * (1.0 - outsideFaceColor.a);\n#ifdef WRITE_DEPTH\n#ifdef GL_EXT_frag_depth\nt = (intersection.start != 0.0) ? intersection.start : intersection.stop;\nvec3 positionEC = czm_pointAlongRay(ray, t);\nvec4 positionCC = czm_projection * vec4(positionEC, 1.0);\nfloat z = positionCC.z / positionCC.w;\nfloat n = czm_depthRange.near;\nfloat f = czm_depthRange.far;\ngl_FragDepthEXT = (z * (f - n) + f + n) * 0.5;\n#endif\n#endif\n}\n"}),define("Shaders/EllipsoidVS",[],function(){"use strict";return"attribute vec3 position;\nuniform vec3 u_radii;\nvarying vec3 v_positionEC;\nvoid main()\n{\nvec4 p = vec4(u_radii * position, 1.0);\nv_positionEC = (czm_modelView * p).xyz;\ngl_Position = czm_modelViewProjection * p;\ngl_Position.z = clamp(gl_Position.z, czm_depthRange.near, czm_depthRange.far);\n}\n"}),define("Scene/EllipsoidPrimitive",["../Core/BoundingSphere","../Core/BoxGeometry","../Core/Cartesian3","../Core/combine","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Matrix4","../Core/VertexFormat","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../Shaders/EllipsoidFS","../Shaders/EllipsoidVS","./BlendingState","./CullFace","./Material","./SceneMode"],function(f,m,g,_,r,v,e,y,b,C,w,i,S,T,E,A,x,P,D,O,I,n,M){"use strict";var R={position:0};function t(e){e=r(e,r.EMPTY_OBJECT),this.center=g.clone(r(e.center,g.ZERO)),this._center=new g,this.radii=g.clone(e.radii),this._radii=new g,this._oneOverEllipsoidRadiiSquared=new g,this._boundingSphere=new f,this.modelMatrix=b.clone(r(e.modelMatrix,b.IDENTITY)),this._modelMatrix=new b,this._computedModelMatrix=new b,this.show=r(e.show,!0),this.material=r(e.material,n.fromType(n.ColorType)),this._material=void 0,this._translucent=void 0,this.id=e.id,this._id=void 0,this.debugShowBoundingVolume=r(e.debugShowBoundingVolume,!1),this.onlySunLighting=r(e.onlySunLighting,!1),this._onlySunLighting=!1,this._depthTestEnabled=r(e.depthTestEnabled,!0),this._sp=void 0,this._rs=void 0,this._va=void 0,this._pickSP=void 0,this._pickId=void 0,this._colorCommand=new i({owner:r(e._owner,this)}),this._pickCommand=new i({owner:r(e._owner,this)});var t=this;this._uniforms={u_radii:function(){return t.radii},u_oneOverEllipsoidRadiiSquared:function(){return t._oneOverEllipsoidRadiiSquared}},this._pickUniforms={czm_pickColor:function(){return t._pickId.color}}}return t.prototype.update=function(e){if(this.show&&e.mode===M.SCENE3D&&v(this.center)&&v(this.radii)){if(!v(this.material))throw new y("this.material must be defined.");var t=e.context,r=this.material.isTranslucent(),i=this._translucent!==r;v(this._rs)&&!i||(this._translucent=r,this._rs=T.fromCache({cull:{enabled:!0,face:I.FRONT},depthTest:{enabled:this._depthTestEnabled},depthMask:!r&&t.fragmentDepth,blending:r?O.ALPHA_BLEND:void 0})),v(this._va)||(this._va=function(e){var t=e.cache.ellipsoidPrimitive_vertexArray;if(v(t))return t;var r=m.createGeometry(m.fromDimensions({dimensions:new g(2,2,2),vertexFormat:C.POSITION_ONLY}));return t=x.fromGeometry({context:e,geometry:r,attributeLocations:R,bufferUsage:w.STATIC_DRAW,interleave:!0}),e.cache.ellipsoidPrimitive_vertexArray=t}(t));var n=!1,o=this.radii;if(!g.equals(this._radii,o)){g.clone(o,this._radii);var a=this._oneOverEllipsoidRadiiSquared;a.x=1/(o.x*o.x),a.y=1/(o.y*o.y),a.z=1/(o.z*o.z),n=!0}b.equals(this.modelMatrix,this._modelMatrix)&&g.equals(this.center,this._center)||(b.clone(this.modelMatrix,this._modelMatrix),g.clone(this.center,this._center),b.multiplyByTranslation(this.modelMatrix,this.center,this._computedModelMatrix),n=!0),n&&(g.clone(g.ZERO,this._boundingSphere.center),this._boundingSphere.radius=g.maximumComponent(o),f.transform(this._boundingSphere,this._computedModelMatrix,this._boundingSphere));var s=this._material!==this.material;this._material=this.material,this._material.update(t);var l=this.onlySunLighting!==this._onlySunLighting;this._onlySunLighting=this.onlySunLighting;var u,c=this._colorCommand;(s||l||i)&&(u=new A({sources:[this.material.shaderSource,P]}),this.onlySunLighting&&u.defines.push("ONLY_SUN_LIGHTING"),!r&&t.fragmentDepth&&u.defines.push("WRITE_DEPTH"),this._sp=E.replaceCache({context:t,shaderProgram:this._sp,vertexShaderSource:D,fragmentShaderSource:u,attributeLocations:R}),c.vertexArray=this._va,c.renderState=this._rs,c.shaderProgram=this._sp,c.uniformMap=_(this._uniforms,this.material._uniforms),c.executeInClosestFrustum=r);var d=e.commandList,h=e.passes;if(h.render&&(c.boundingVolume=this._boundingSphere,c.debugShowBoundingVolume=this.debugShowBoundingVolume,c.modelMatrix=this._computedModelMatrix,c.pass=r?S.TRANSLUCENT:S.OPAQUE,d.push(c)),h.pick){var p=this._pickCommand;v(this._pickId)&&this._id===this.id||(this._id=this.id,this._pickId=this._pickId&&this._pickId.destroy(),this._pickId=t.createPickId({primitive:this,id:this.id})),(s||l||!v(this._pickSP))&&(u=new A({sources:[this.material.shaderSource,P],pickColorQualifier:"uniform"}),this.onlySunLighting&&u.defines.push("ONLY_SUN_LIGHTING"),!r&&t.fragmentDepth&&u.defines.push("WRITE_DEPTH"),this._pickSP=E.replaceCache({context:t,shaderProgram:this._pickSP,vertexShaderSource:D,fragmentShaderSource:u,attributeLocations:R}),p.vertexArray=this._va,p.renderState=this._rs,p.shaderProgram=this._pickSP,p.uniformMap=_(_(this._uniforms,this._pickUniforms),this.material._uniforms),p.executeInClosestFrustum=r),p.boundingVolume=this._boundingSphere,p.modelMatrix=this._computedModelMatrix,p.pass=r?S.TRANSLUCENT:S.OPAQUE,d.push(p)}}},t.prototype.isDestroyed=function(){return!1},t.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._pickSP=this._pickSP&&this._pickSP.destroy(),this._pickId=this._pickId&&this._pickId.destroy(),e(this)},t}),define("Shaders/Appearances/EllipsoidSurfaceAppearanceFS",[],function(){"use strict";return"varying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec2 v_st;\nvoid main()\n{\nczm_materialInput materialInput;\nvec3 normalEC = normalize(czm_normal3D * czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0)));\n#ifdef FACE_FORWARD\nnormalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\nmaterialInput.s = v_st.s;\nmaterialInput.st = v_st;\nmaterialInput.str = vec3(v_st, 0.0);\nmaterialInput.normalEC = normalEC;\nmaterialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(v_positionMC, materialInput.normalEC);\nvec3 positionToEyeEC = -v_positionEC;\nmaterialInput.positionToEyeEC = positionToEyeEC;\nczm_material material = czm_getMaterial(materialInput);\n#ifdef FLAT\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\ngl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"}),define("Shaders/Appearances/EllipsoidSurfaceAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec2 st;\nattribute float batchId;\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec2 v_st;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_positionMC = position3DHigh + position3DLow;\nv_positionEC = (czm_modelViewRelativeToEye * p).xyz;\nv_st = st;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"}),define("Scene/EllipsoidSurfaceAppearance",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/EllipsoidSurfaceAppearanceFS","../Shaders/Appearances/EllipsoidSurfaceAppearanceVS","./Appearance","./Material"],function(i,n,e,t,o,a,s,l){"use strict";function r(e){e=i(e,i.EMPTY_OBJECT);var t=i(e.translucent,!0),r=i(e.aboveGround,!1);this.material=n(e.material)?e.material:l.fromType(l.ColorType),this.translucent=i(e.translucent,!0),this._vertexShaderSource=i(e.vertexShaderSource,a),this._fragmentShaderSource=i(e.fragmentShaderSource,o),this._renderState=s.getDefaultRenderState(t,!r,e.renderState),this._closed=!1,this._flat=i(e.flat,!1),this._faceForward=i(e.faceForward,r),this._aboveGround=r}return e(r.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return r.VERTEX_FORMAT}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}},aboveGround:{get:function(){return this._aboveGround}}}),r.VERTEX_FORMAT=t.POSITION_AND_ST,r.prototype.getFragmentShaderSource=s.prototype.getFragmentShaderSource,r.prototype.isTranslucent=s.prototype.isTranslucent,r.prototype.getRenderState=s.prototype.getRenderState,r}),define("Scene/Fog",["../Core/Cartesian3","../Core/defined","../Core/Math","./SceneMode"],function(u,c,d,h){"use strict";function e(){this.enabled=!0,this.density=2e-4,this.screenSpaceErrorFactor=2,this.minimumBrightness=.1}for(var p=[359.393,800.749,1275.6501,2151.1192,3141.7763,4777.5198,6281.2493,12364.307,15900.765,49889.0549,78026.8259,99260.7344,120036.3873,151011.0158,156091.1953,203849.3112,274866.9803,319916.3149,493552.0528,628733.5874],f=[2e-5,2e-4,1e-4,7e-5,5e-5,4e-5,3e-5,19e-6,1e-5,85e-7,62e-7,58e-7,53e-7,52e-7,51e-7,42e-7,4e-6,34e-7,26e-7,22e-7],t=0;t<f.length;++t)f[t]*=1e6;for(var m=f[1],g=f[f.length-1],r=0;r<f.length;++r)f[r]=(f[r]-g)/(m-g);var _=0;var v=new u;return e.prototype.update=function(e){if(e.fog.enabled=this.enabled){var t=e.camera,r=t.positionCartographic;if(!c(r)||8e5<r.height||e.mode!==h.SCENE3D)e.fog.enabled=!1;else{var i=r.height,n=function(e){var t,r=p,i=r.length;if(e<r[0])return _=0;if(r[i-1]<e)return _=i-2;if(r[_]<=e){if(_+1<i&&e<r[_+1])return _;if(_+2<i&&e<r[_+2])return++_}else if(0<=_-1&&r[_-1]<=e)return--_;for(t=0;t<i-2&&!(r[t]<=e&&e<r[t+1]);++t);return _=t}(i),o=d.clamp((i-p[n])/(p[n+1]-p[n]),0,1),a=d.lerp(f[n],f[n+1],o),s=1e6*this.density;a=a*(s-s/m*g)*1e-6;var l=u.normalize(t.positionWC,v);a*=1-Math.abs(u.dot(t.directionWC,l)),e.fog.density=a,e.fog.sse=this.screenSpaceErrorFactor,e.fog.minimumBrightness=this.minimumBrightness}}},e}),define("Scene/FrameRateMonitor",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Event","../Core/getTimestamp","../Core/TimeConstants"],function(n,o,e,t,a,s,l,u){"use strict";function c(e){if(!o(e)||!o(e.scene))throw new a("options.scene is required.");this._scene=e.scene,this.samplingWindow=n(e.samplingWindow,c.defaultSettings.samplingWindow),this.quietPeriod=n(e.quietPeriod,c.defaultSettings.quietPeriod),this.warmupPeriod=n(e.warmupPeriod,c.defaultSettings.warmupPeriod),this.minimumFrameRateDuringWarmup=n(e.minimumFrameRateDuringWarmup,c.defaultSettings.minimumFrameRateDuringWarmup),this.minimumFrameRateAfterWarmup=n(e.minimumFrameRateAfterWarmup,c.defaultSettings.minimumFrameRateAfterWarmup),this._lowFrameRate=new s,this._nominalFrameRate=new s,this._frameTimes=[],this._needsQuietPeriod=!0,this._quietPeriodEndTime=0,this._warmupPeriodEndTime=0,this._frameRateIsLow=!1,this._lastFramesPerSecond=void 0,this._pauseCount=0;var r=this;this._preUpdateRemoveListener=this._scene.preUpdate.addEventListener(function(e,t){!function(e,t){if(0<e._pauseCount)return;var r=l();if(e._needsQuietPeriod)e._needsQuietPeriod=!1,e._frameTimes.length=0,e._quietPeriodEndTime=r+e.quietPeriod/u.SECONDS_PER_MILLISECOND,e._warmupPeriodEndTime=e._quietPeriodEndTime+(e.warmupPeriod+e.samplingWindow)/u.SECONDS_PER_MILLISECOND;else if(r>=e._quietPeriodEndTime){e._frameTimes.push(r);var i=r-e.samplingWindow/u.SECONDS_PER_MILLISECOND;if(2<=e._frameTimes.length&&e._frameTimes[0]<=i){for(;2<=e._frameTimes.length&&e._frameTimes[1]<i;)e._frameTimes.shift();var n=(r-e._frameTimes[0])/(e._frameTimes.length-1);e._lastFramesPerSecond=1e3/n;var o=1e3/(r>e._warmupPeriodEndTime?e.minimumFrameRateAfterWarmup:e.minimumFrameRateDuringWarmup);o<n?e._frameRateIsLow||(e._frameRateIsLow=!0,e._needsQuietPeriod=!0,e.lowFrameRate.raiseEvent(e.scene,e._lastFramesPerSecond)):e._frameRateIsLow&&(e._frameRateIsLow=!1,e._needsQuietPeriod=!0,e.nominalFrameRate.raiseEvent(e.scene,e._lastFramesPerSecond))}}}(r)}),this._hiddenPropertyName=void 0!==document.hidden?"hidden":void 0!==document.mozHidden?"mozHidden":void 0!==document.msHidden?"msHidden":void 0!==document.webkitHidden?"webkitHidden":void 0;var t=void 0!==document.hidden?"visibilitychange":void 0!==document.mozHidden?"mozvisibilitychange":void 0!==document.msHidden?"msvisibilitychange":void 0!==document.webkitHidden?"webkitvisibilitychange":void 0;function i(){var e;e=r,document[e._hiddenPropertyName]?e.pause():e.unpause()}this._visibilityChangeRemoveListener=void 0,o(t)&&(document.addEventListener(t,i,!1),this._visibilityChangeRemoveListener=function(){document.removeEventListener(t,i,!1)})}return c.defaultSettings={samplingWindow:5,quietPeriod:2,warmupPeriod:5,minimumFrameRateDuringWarmup:4,minimumFrameRateAfterWarmup:8},c.fromScene=function(e){if(!o(e))throw new a("scene is required.");return o(e._frameRateMonitor)&&!e._frameRateMonitor.isDestroyed()||(e._frameRateMonitor=new c({scene:e})),e._frameRateMonitor},e(c.prototype,{scene:{get:function(){return this._scene}},lowFrameRate:{get:function(){return this._lowFrameRate}},nominalFrameRate:{get:function(){return this._nominalFrameRate}},lastFramesPerSecond:{get:function(){return this._lastFramesPerSecond}}}),c.prototype.pause=function(){++this._pauseCount,1===this._pauseCount&&(this._frameTimes.length=0,this._lastFramesPerSecond=void 0)},c.prototype.unpause=function(){--this._pauseCount,this._pauseCount<=0&&(this._pauseCount=0,this._needsQuietPeriod=!0)},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){return this._preUpdateRemoveListener(),o(this._visibilityChangeRemoveListener)&&this._visibilityChangeRemoveListener(),t(this)},c}),define("Scene/FrameState",["./SceneMode"],function(i){"use strict";return function(e,t,r){this.context=e,this.commandList=[],this.shadowMaps=[],this.brdfLutGenerator=void 0,this.environmentMap=void 0,this.mode=i.SCENE3D,this.morphTime=i.getMorphTime(i.SCENE3D),this.frameNumber=0,this.time=void 0,this.jobScheduler=r,this.mapProjection=void 0,this.camera=void 0,this.cullingVolume=void 0,this.occluder=void 0,this.maximumScreenSpaceError=void 0,this.passes={render:!1,pick:!1,depth:!1},this.creditDisplay=t,this.afterRender=[],this.scene3DOnly=!1,this.fog={enabled:!1,density:void 0,sse:void 0,minimumBrightness:void 0},this.terrainExaggeration=1,this.shadowHints={shadowsEnabled:!0,shadowMaps:[],lightShadowMaps:[],nearPlane:1,farPlane:5e3,closestObjectSize:1e3,lastDirtyTime:0,outOfView:!0},this.imagerySplitPosition=0,this.frustumSplits=[],this.backgroundColor=void 0,this.minimumDisableDepthTestDistance=void 0,this.invertClassification=!1,this.invertClassificationColor=void 0}}),define("Scene/FrustumCommands",["../Core/defaultValue","../Renderer/Pass"],function(a,s){"use strict";return function(e,t){this.near=a(e,0),this.far=a(t,0);for(var r=s.NUMBER_OF_PASSES,i=new Array(r),n=new Array(r),o=0;o<r;++o)i[o]=[],n[o]=0;this.commands=i,this.indices=n}}),define("Shaders/PostProcessFilters/FXAA",[],function(){"use strict";return"varying vec2 v_textureCoordinates;\nuniform sampler2D u_texture;\nuniform vec2 u_fxaaQualityRcpFrame;\nconst float fxaaQualitySubpix = 0.5;\nconst float fxaaQualityEdgeThreshold = 0.125;\nconst float fxaaQualityEdgeThresholdMin = 0.0833;\nvoid main()\n{\nvec4 color = FxaaPixelShader(\nv_textureCoordinates,\nu_texture,\nu_fxaaQualityRcpFrame,\nfxaaQualitySubpix,\nfxaaQualityEdgeThreshold,\nfxaaQualityEdgeThresholdMin);\nfloat alpha = texture2D(u_texture, v_textureCoordinates).a;\ngl_FragColor = vec4(color.rgb, alpha);\n}\n"}),define("ThirdParty/Shaders/FXAA3_11",[],function(){"use strict";return"#if (FXAA_QUALITY_PRESET == 10)\n#define FXAA_QUALITY_PS 3\n#define FXAA_QUALITY_P0 1.5\n#define FXAA_QUALITY_P1 3.0\n#define FXAA_QUALITY_P2 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 11)\n#define FXAA_QUALITY_PS 4\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 3.0\n#define FXAA_QUALITY_P3 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 12)\n#define FXAA_QUALITY_PS 5\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 4.0\n#define FXAA_QUALITY_P4 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 13)\n#define FXAA_QUALITY_PS 6\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 4.0\n#define FXAA_QUALITY_P5 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 14)\n#define FXAA_QUALITY_PS 7\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 2.0\n#define FXAA_QUALITY_P5 4.0\n#define FXAA_QUALITY_P6 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 15)\n#define FXAA_QUALITY_PS 8\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 2.0\n#define FXAA_QUALITY_P5 2.0\n#define FXAA_QUALITY_P6 4.0\n#define FXAA_QUALITY_P7 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 20)\n#define FXAA_QUALITY_PS 3\n#define FXAA_QUALITY_P0 1.5\n#define FXAA_QUALITY_P1 2.0\n#define FXAA_QUALITY_P2 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 21)\n#define FXAA_QUALITY_PS 4\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 22)\n#define FXAA_QUALITY_PS 5\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 23)\n#define FXAA_QUALITY_PS 6\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 2.0\n#define FXAA_QUALITY_P5 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 24)\n#define FXAA_QUALITY_PS 7\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 2.0\n#define FXAA_QUALITY_P5 3.0\n#define FXAA_QUALITY_P6 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 25)\n#define FXAA_QUALITY_PS 8\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 2.0\n#define FXAA_QUALITY_P5 2.0\n#define FXAA_QUALITY_P6 4.0\n#define FXAA_QUALITY_P7 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 26)\n#define FXAA_QUALITY_PS 9\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 2.0\n#define FXAA_QUALITY_P5 2.0\n#define FXAA_QUALITY_P6 2.0\n#define FXAA_QUALITY_P7 4.0\n#define FXAA_QUALITY_P8 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 27)\n#define FXAA_QUALITY_PS 10\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 2.0\n#define FXAA_QUALITY_P5 2.0\n#define FXAA_QUALITY_P6 2.0\n#define FXAA_QUALITY_P7 2.0\n#define FXAA_QUALITY_P8 4.0\n#define FXAA_QUALITY_P9 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 28)\n#define FXAA_QUALITY_PS 11\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 2.0\n#define FXAA_QUALITY_P5 2.0\n#define FXAA_QUALITY_P6 2.0\n#define FXAA_QUALITY_P7 2.0\n#define FXAA_QUALITY_P8 2.0\n#define FXAA_QUALITY_P9 4.0\n#define FXAA_QUALITY_P10 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 29)\n#define FXAA_QUALITY_PS 12\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 2.0\n#define FXAA_QUALITY_P5 2.0\n#define FXAA_QUALITY_P6 2.0\n#define FXAA_QUALITY_P7 2.0\n#define FXAA_QUALITY_P8 2.0\n#define FXAA_QUALITY_P9 2.0\n#define FXAA_QUALITY_P10 4.0\n#define FXAA_QUALITY_P11 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 39)\n#define FXAA_QUALITY_PS 12\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.0\n#define FXAA_QUALITY_P2 1.0\n#define FXAA_QUALITY_P3 1.0\n#define FXAA_QUALITY_P4 1.0\n#define FXAA_QUALITY_P5 1.5\n#define FXAA_QUALITY_P6 2.0\n#define FXAA_QUALITY_P7 2.0\n#define FXAA_QUALITY_P8 2.0\n#define FXAA_QUALITY_P9 2.0\n#define FXAA_QUALITY_P10 4.0\n#define FXAA_QUALITY_P11 8.0\n#endif\n#define FxaaBool bool\n#define FxaaFloat float\n#define FxaaFloat2 vec2\n#define FxaaFloat3 vec3\n#define FxaaFloat4 vec4\n#define FxaaHalf float\n#define FxaaHalf2 vec2\n#define FxaaHalf3 vec3\n#define FxaaHalf4 vec4\n#define FxaaInt2 vec2\n#define FxaaTex sampler2D\n#define FxaaSat(x) clamp(x, 0.0, 1.0)\n#define FxaaTexTop(t, p) texture2D(t, p)\n#define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r))\nFxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }\nFxaaFloat4 FxaaPixelShader(\nFxaaFloat2 pos,\nFxaaTex tex,\nFxaaFloat2 fxaaQualityRcpFrame,\nFxaaFloat fxaaQualitySubpix,\nFxaaFloat fxaaQualityEdgeThreshold,\nFxaaFloat fxaaQualityEdgeThresholdMin\n) {\nFxaaFloat2 posM;\nposM.x = pos.x;\nposM.y = pos.y;\nFxaaFloat4 rgbyM = FxaaTexTop(tex, posM);\n#define lumaM rgbyM.y\nFxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));\nFxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));\nFxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));\nFxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));\nFxaaFloat maxSM = max(lumaS, lumaM);\nFxaaFloat minSM = min(lumaS, lumaM);\nFxaaFloat maxESM = max(lumaE, maxSM);\nFxaaFloat minESM = min(lumaE, minSM);\nFxaaFloat maxWN = max(lumaN, lumaW);\nFxaaFloat minWN = min(lumaN, lumaW);\nFxaaFloat rangeMax = max(maxWN, maxESM);\nFxaaFloat rangeMin = min(minWN, minESM);\nFxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;\nFxaaFloat range = rangeMax - rangeMin;\nFxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);\nFxaaBool earlyExit = range < rangeMaxClamped;\nif(earlyExit)\nreturn rgbyM;\nFxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));\nFxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));\nFxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));\nFxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));\nFxaaFloat lumaNS = lumaN + lumaS;\nFxaaFloat lumaWE = lumaW + lumaE;\nFxaaFloat subpixRcpRange = 1.0/range;\nFxaaFloat subpixNSWE = lumaNS + lumaWE;\nFxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;\nFxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;\nFxaaFloat lumaNESE = lumaNE + lumaSE;\nFxaaFloat lumaNWNE = lumaNW + lumaNE;\nFxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;\nFxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;\nFxaaFloat lumaNWSW = lumaNW + lumaSW;\nFxaaFloat lumaSWSE = lumaSW + lumaSE;\nFxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);\nFxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);\nFxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;\nFxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;\nFxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;\nFxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;\nFxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;\nFxaaFloat lengthSign = fxaaQualityRcpFrame.x;\nFxaaBool horzSpan = edgeHorz >= edgeVert;\nFxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;\nif(!horzSpan) lumaN = lumaW;\nif(!horzSpan) lumaS = lumaE;\nif(horzSpan) lengthSign = fxaaQualityRcpFrame.y;\nFxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;\nFxaaFloat gradientN = lumaN - lumaM;\nFxaaFloat gradientS = lumaS - lumaM;\nFxaaFloat lumaNN = lumaN + lumaM;\nFxaaFloat lumaSS = lumaS + lumaM;\nFxaaBool pairN = abs(gradientN) >= abs(gradientS);\nFxaaFloat gradient = max(abs(gradientN), abs(gradientS));\nif(pairN) lengthSign = -lengthSign;\nFxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);\nFxaaFloat2 posB;\nposB.x = posM.x;\nposB.y = posM.y;\nFxaaFloat2 offNP;\noffNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;\noffNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;\nif(!horzSpan) posB.x += lengthSign * 0.5;\nif( horzSpan) posB.y += lengthSign * 0.5;\nFxaaFloat2 posN;\nposN.x = posB.x - offNP.x * FXAA_QUALITY_P0;\nposN.y = posB.y - offNP.y * FXAA_QUALITY_P0;\nFxaaFloat2 posP;\nposP.x = posB.x + offNP.x * FXAA_QUALITY_P0;\nposP.y = posB.y + offNP.y * FXAA_QUALITY_P0;\nFxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;\nFxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));\nFxaaFloat subpixE = subpixC * subpixC;\nFxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));\nif(!pairN) lumaNN = lumaSS;\nFxaaFloat gradientScaled = gradient * 1.0/4.0;\nFxaaFloat lumaMM = lumaM - lumaNN * 0.5;\nFxaaFloat subpixF = subpixD * subpixE;\nFxaaBool lumaMLTZero = lumaMM < 0.0;\nlumaEndN -= lumaNN * 0.5;\nlumaEndP -= lumaNN * 0.5;\nFxaaBool doneN = abs(lumaEndN) >= gradientScaled;\nFxaaBool doneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;\nFxaaBool doneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;\n#if (FXAA_QUALITY_PS > 3)\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;\n#if (FXAA_QUALITY_PS > 4)\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;\n#if (FXAA_QUALITY_PS > 5)\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;\n#if (FXAA_QUALITY_PS > 6)\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;\n#if (FXAA_QUALITY_PS > 7)\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;\n#if (FXAA_QUALITY_PS > 8)\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;\n#if (FXAA_QUALITY_PS > 9)\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;\n#if (FXAA_QUALITY_PS > 10)\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;\n#if (FXAA_QUALITY_PS > 11)\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;\n#if (FXAA_QUALITY_PS > 12)\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;\n}\n#endif\n}\n#endif\n}\n#endif\n}\n#endif\n}\n#endif\n}\n#endif\n}\n#endif\n}\n#endif\n}\n#endif\n}\n#endif\n}\nFxaaFloat dstN = posM.x - posN.x;\nFxaaFloat dstP = posP.x - posM.x;\nif(!horzSpan) dstN = posM.y - posN.y;\nif(!horzSpan) dstP = posP.y - posM.y;\nFxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;\nFxaaFloat spanLength = (dstP + dstN);\nFxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;\nFxaaFloat spanLengthRcp = 1.0/spanLength;\nFxaaBool directionN = dstN < dstP;\nFxaaFloat dst = min(dstN, dstP);\nFxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;\nFxaaFloat subpixG = subpixF * subpixF;\nFxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;\nFxaaFloat subpixH = subpixG * fxaaQualitySubpix;\nFxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;\nFxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);\nif(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;\nif( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;\nreturn FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);\n}\n"}),define("Scene/FXAA",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Color","../Core/defined","../Core/destroyObject","../Core/PixelFormat","../Renderer/ClearCommand","../Renderer/Framebuffer","../Renderer/PixelDatatype","../Renderer/Renderbuffer","../Renderer/RenderbufferFormat","../Renderer/RenderState","../Renderer/Sampler","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","../Shaders/PostProcessFilters/FXAA","../ThirdParty/Shaders/FXAA3_11"],function(d,h,n,p,t,f,r,m,g,_,v,y,b,C,w,S,T,E,A){"use strict";function e(){this._texture=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this._fbo=void 0,this._command=void 0,this._viewport=new d,this._rs=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0;var e=new r({color:new n(0,0,0,0),depth:1,owner:this});this._clearCommand=e,this._qualityPreset=39}return e.prototype.update=function(e,t){var r=e.drawingBufferWidth,i=e.drawingBufferHeight,n=this._texture,o=!p(n)||n.width!==r||n.height!==i;if(o&&(this._texture=this._texture&&this._texture.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy(),this._texture=new C({context:e,width:r,height:i,pixelFormat:f.RGBA,pixelDatatype:g.UNSIGNED_BYTE,sampler:new b({wrapS:T.CLAMP_TO_EDGE,wrapT:T.CLAMP_TO_EDGE,minificationFilter:S.LINEAR,magnificationFilter:w.LINEAR})}),e.depthTexture?this._depthStencilTexture=new C({context:e,width:r,height:i,pixelFormat:f.DEPTH_STENCIL,pixelDatatype:g.UNSIGNED_INT_24_8}):this._depthStencilRenderbuffer=new _({context:e,width:r,height:i,format:v.DEPTH_STENCIL})),p(this._fbo)&&!o||(this._fbo=this._fbo&&this._fbo.destroy(),this._fbo=new m({context:e,colorTextures:[this._texture],depthStencilTexture:this._depthStencilTexture,depthStencilRenderbuffer:this._depthStencilRenderbuffer,destroyAttachments:!1})),!p(this._command)){var a="#define FXAA_QUALITY_PRESET "+this._qualityPreset+"\n"+A+"\n"+E;this._command=e.createViewportQuadCommand(a,{owner:this})}this._viewport.width=r,this._viewport.height=i;var s=!d.equals(this._viewport,t.viewport),l=s!==this._useScissorTest;if(this._useScissorTest=s,d.equals(this._scissorRectangle,t.viewport)||(this._scissorRectangle=d.clone(t.viewport,this._scissorRectangle),l=!0),p(this._rs)&&d.equals(this._rs.viewport,this._viewport)&&!l||(this._rs=y.fromCache({viewport:this._viewport,scissorTest:{enabled:this._useScissorTest,rectangle:this._scissorRectangle}})),this._command.renderState=this._rs,o){var u=this,c=new h(1/this._texture.width,1/this._texture.height);this._command.uniformMap={u_texture:function(){return u._texture},u_fxaaQualityRcpFrame:function(){return c}}}},e.prototype.execute=function(e,t){this._command.execute(e,t)},e.prototype.clear=function(e,t,r){var i=t.framebuffer;t.framebuffer=this._fbo,n.clone(r,this._clearCommand.color),this._clearCommand.execute(e,t),t.framebuffer=i},e.prototype.getColorFramebuffer=function(){return this._fbo},e.prototype.isDestroyed=function(){return!1},e.prototype.destroy=function(){var e;return(e=this)._fbo=e._fbo&&e._fbo.destroy(),e._texture=e._texture&&e._texture.destroy(),e._depthStencilTexture=e._depthStencilTexture&&e._depthStencilTexture.destroy(),e._depthStencilRenderbuffer=e._depthStencilRenderbuffer&&e._depthStencilRenderbuffer.destroy(),e._fbo=void 0,e._texture=void 0,e._depthStencilTexture=void 0,e._depthStencilRenderbuffer=void 0,p(e._command)&&(e._command.shaderProgram=e._command.shaderProgram&&e._command.shaderProgram.destroy(),e._command=void 0),t(this)},e}),define("Shaders/GlobeFS",[],function(){"use strict";return"uniform vec4 u_initialColor;\n#if TEXTURE_UNITS > 0\nuniform sampler2D u_dayTextures[TEXTURE_UNITS];\nuniform vec4 u_dayTextureTranslationAndScale[TEXTURE_UNITS];\nuniform bool u_dayTextureUseWebMercatorT[TEXTURE_UNITS];\n#ifdef APPLY_ALPHA\nuniform float u_dayTextureAlpha[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_SPLIT\nuniform float u_dayTextureSplit[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_BRIGHTNESS\nuniform float u_dayTextureBrightness[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_CONTRAST\nuniform float u_dayTextureContrast[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_HUE\nuniform float u_dayTextureHue[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_SATURATION\nuniform float u_dayTextureSaturation[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_GAMMA\nuniform float u_dayTextureOneOverGamma[TEXTURE_UNITS];\n#endif\nuniform vec4 u_dayTextureTexCoordsRectangle[TEXTURE_UNITS];\n#endif\n#ifdef SHOW_REFLECTIVE_OCEAN\nuniform sampler2D u_waterMask;\nuniform vec4 u_waterMaskTranslationAndScale;\nuniform float u_zoomedOutOceanSpecularIntensity;\n#endif\n#ifdef SHOW_OCEAN_WAVES\nuniform sampler2D u_oceanNormalMap;\n#endif\n#ifdef ENABLE_DAYNIGHT_SHADING\nuniform vec2 u_lightingFadeDistance;\n#endif\n#ifdef ENABLE_CLIPPING_PLANES\nuniform int u_clippingPlanesLength;\nuniform vec4 u_clippingPlanes[czm_maxClippingPlanes];\nuniform vec4 u_clippingPlanesEdgeStyle;\n#endif\n#if defined(FOG) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))\nuniform float u_minimumBrightness;\n#endif\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec3 v_textureCoordinates;\nvarying vec3 v_normalMC;\nvarying vec3 v_normalEC;\n#ifdef APPLY_MATERIAL\nvarying float v_height;\nvarying float v_slope;\n#endif\n#ifdef FOG\nvarying float v_distance;\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\n#endif\nvec4 sampleAndBlend(\nvec4 previousColor,\nsampler2D textureToSample,\nvec2 tileTextureCoordinates,\nvec4 textureCoordinateRectangle,\nvec4 textureCoordinateTranslationAndScale,\nfloat textureAlpha,\nfloat textureBrightness,\nfloat textureContrast,\nfloat textureHue,\nfloat textureSaturation,\nfloat textureOneOverGamma,\nfloat split)\n{\nvec2 alphaMultiplier = step(textureCoordinateRectangle.st, tileTextureCoordinates);\ntextureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\nalphaMultiplier = step(vec2(0.0), textureCoordinateRectangle.pq - tileTextureCoordinates);\ntextureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\nvec2 translation = textureCoordinateTranslationAndScale.xy;\nvec2 scale = textureCoordinateTranslationAndScale.zw;\nvec2 textureCoordinates = tileTextureCoordinates * scale + translation;\nvec4 value = texture2D(textureToSample, textureCoordinates);\nvec3 color = value.rgb;\nfloat alpha = value.a;\n#ifdef APPLY_SPLIT\nfloat splitPosition = czm_imagerySplitPosition;\nif (split < 0.0 && gl_FragCoord.x > splitPosition) {\nalpha = 0.0;\n}\nelse if (split > 0.0 && gl_FragCoord.x < splitPosition) {\nalpha = 0.0;\n}\n#endif\n#ifdef APPLY_BRIGHTNESS\ncolor = mix(vec3(0.0), color, textureBrightness);\n#endif\n#ifdef APPLY_CONTRAST\ncolor = mix(vec3(0.5), color, textureContrast);\n#endif\n#ifdef APPLY_HUE\ncolor = czm_hue(color, textureHue);\n#endif\n#ifdef APPLY_SATURATION\ncolor = czm_saturation(color, textureSaturation);\n#endif\n#ifdef APPLY_GAMMA\ncolor = pow(color, vec3(textureOneOverGamma));\n#endif\nfloat sourceAlpha = alpha * textureAlpha;\nfloat outAlpha = mix(previousColor.a, 1.0, sourceAlpha);\nvec3 outColor = mix(previousColor.rgb * previousColor.a, color, sourceAlpha) / outAlpha;\nreturn vec4(outColor, outAlpha);\n}\nvec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates);\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float specularMapValue);\nvoid main()\n{\n#ifdef ENABLE_CLIPPING_PLANES\n#ifdef UNION_CLIPPING_REGIONS\nfloat clipDistance = czm_discardIfClippedWithUnion(u_clippingPlanes, u_clippingPlanesLength);\n#else\nfloat clipDistance = czm_discardIfClippedWithIntersect(u_clippingPlanes, u_clippingPlanesLength);\n#endif\n#endif\nvec4 color = computeDayColor(u_initialColor, clamp(v_textureCoordinates, 0.0, 1.0));\n#ifdef SHOW_TILE_BOUNDARIES\nif (v_textureCoordinates.x < (1.0/256.0) || v_textureCoordinates.x > (255.0/256.0) ||\nv_textureCoordinates.y < (1.0/256.0) || v_textureCoordinates.y > (255.0/256.0))\n{\ncolor = vec4(1.0, 0.0, 0.0, 1.0);\n}\n#endif\n#if defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING)\nvec3 normalMC = czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0));\nvec3 normalEC = czm_normal3D * normalMC;\n#endif\n#ifdef SHOW_REFLECTIVE_OCEAN\nvec2 waterMaskTranslation = u_waterMaskTranslationAndScale.xy;\nvec2 waterMaskScale = u_waterMaskTranslationAndScale.zw;\nvec2 waterMaskTextureCoordinates = v_textureCoordinates.xy * waterMaskScale + waterMaskTranslation;\nfloat mask = texture2D(u_waterMask, waterMaskTextureCoordinates).r;\nif (mask > 0.0)\n{\nmat3 enuToEye = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalEC);\nvec2 ellipsoidTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC);\nvec2 ellipsoidFlippedTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC.zyx);\nvec2 textureCoordinates = mix(ellipsoidTextureCoordinates, ellipsoidFlippedTextureCoordinates, czm_morphTime * smoothstep(0.9, 0.95, normalMC.z));\ncolor = computeWaterColor(v_positionEC, textureCoordinates, enuToEye, color, mask);\n}\n#endif\n#ifdef APPLY_MATERIAL\nczm_materialInput materialInput;\nmaterialInput.st = v_textureCoordinates.st;\nmaterialInput.normalEC = normalize(v_normalEC);\nmaterialInput.slope = v_slope;\nmaterialInput.height = v_height;\nczm_material material = czm_getMaterial(materialInput);\ncolor.xyz = mix(color.xyz, material.diffuse, material.alpha);\n#endif\n#ifdef ENABLE_VERTEX_LIGHTING\nfloat diffuseIntensity = clamp(czm_getLambertDiffuse(czm_sunDirectionEC, normalize(v_normalEC)) * 0.9 + 0.3, 0.0, 1.0);\nvec4 finalColor = vec4(color.rgb * diffuseIntensity, color.a);\n#elif defined(ENABLE_DAYNIGHT_SHADING)\nfloat diffuseIntensity = clamp(czm_getLambertDiffuse(czm_sunDirectionEC, normalEC) * 5.0 + 0.3, 0.0, 1.0);\nfloat cameraDist = length(czm_view[3]);\nfloat fadeOutDist = u_lightingFadeDistance.x;\nfloat fadeInDist = u_lightingFadeDistance.y;\nfloat t = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.0, 1.0);\ndiffuseIntensity = mix(1.0, diffuseIntensity, t);\nvec4 finalColor = vec4(color.rgb * diffuseIntensity, color.a);\n#else\nvec4 finalColor = color;\n#endif\n#ifdef ENABLE_CLIPPING_PLANES\nvec4 clippingPlanesEdgeColor = vec4(1.0);\nclippingPlanesEdgeColor.rgb = u_clippingPlanesEdgeStyle.rgb;\nfloat clippingPlanesEdgeWidth = u_clippingPlanesEdgeStyle.a;\nif (clipDistance < clippingPlanesEdgeWidth)\n{\nfinalColor = clippingPlanesEdgeColor;\n}\n#endif\n#ifdef FOG\nconst float fExposure = 2.0;\nvec3 fogColor = v_mieColor + finalColor.rgb * v_rayleighColor;\nfogColor = vec3(1.0) - exp(-fExposure * fogColor);\n#if defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING)\nfloat darken = clamp(dot(normalize(czm_viewerPositionWC), normalize(czm_sunPositionWC)), u_minimumBrightness, 1.0);\nfogColor *= darken;\n#endif\ngl_FragColor = vec4(czm_fog(v_distance, finalColor.rgb, fogColor), finalColor.a);\n#else\ngl_FragColor = finalColor;\n#endif\n}\n#ifdef SHOW_REFLECTIVE_OCEAN\nfloat waveFade(float edge0, float edge1, float x)\n{\nfloat y = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\nreturn pow(1.0 - y, 5.0);\n}\nfloat linearFade(float edge0, float edge1, float x)\n{\nreturn clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n}\nconst float oceanFrequencyLowAltitude = 825000.0;\nconst float oceanAnimationSpeedLowAltitude = 0.004;\nconst float oceanOneOverAmplitudeLowAltitude = 1.0 / 2.0;\nconst float oceanSpecularIntensity = 0.5;\nconst float oceanFrequencyHighAltitude = 125000.0;\nconst float oceanAnimationSpeedHighAltitude = 0.008;\nconst float oceanOneOverAmplitudeHighAltitude = 1.0 / 2.0;\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float maskValue)\n{\nvec3 positionToEyeEC = -positionEyeCoordinates;\nfloat positionToEyeECLength = length(positionToEyeEC);\nvec3 normalizedpositionToEyeEC = normalize(normalize(positionToEyeEC));\nfloat waveIntensity = waveFade(70000.0, 1000000.0, positionToEyeECLength);\n#ifdef SHOW_OCEAN_WAVES\nfloat time = czm_frameNumber * oceanAnimationSpeedHighAltitude;\nvec4 noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyHighAltitude, time, 0.0);\nvec3 normalTangentSpaceHighAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeHighAltitude);\ntime = czm_frameNumber * oceanAnimationSpeedLowAltitude;\nnoise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyLowAltitude, time, 0.0);\nvec3 normalTangentSpaceLowAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeLowAltitude);\nfloat highAltitudeFade = linearFade(0.0, 60000.0, positionToEyeECLength);\nfloat lowAltitudeFade = 1.0 - linearFade(20000.0, 60000.0, positionToEyeECLength);\nvec3 normalTangentSpace =\n(highAltitudeFade * normalTangentSpaceHighAltitude) +\n(lowAltitudeFade * normalTangentSpaceLowAltitude);\nnormalTangentSpace = normalize(normalTangentSpace);\nnormalTangentSpace.xy *= waveIntensity;\nnormalTangentSpace = normalize(normalTangentSpace);\n#else\nvec3 normalTangentSpace = vec3(0.0, 0.0, 1.0);\n#endif\nvec3 normalEC = enuToEye * normalTangentSpace;\nconst vec3 waveHighlightColor = vec3(0.3, 0.45, 0.6);\nfloat diffuseIntensity = czm_getLambertDiffuse(czm_sunDirectionEC, normalEC) * maskValue;\nvec3 diffuseHighlight = waveHighlightColor * diffuseIntensity;\n#ifdef SHOW_OCEAN_WAVES\nfloat tsPerturbationRatio = normalTangentSpace.z;\nvec3 nonDiffuseHighlight = mix(waveHighlightColor * 5.0 * (1.0 - tsPerturbationRatio), vec3(0.0), diffuseIntensity);\n#else\nvec3 nonDiffuseHighlight = vec3(0.0);\n#endif\nfloat specularIntensity = czm_getSpecular(czm_sunDirectionEC, normalizedpositionToEyeEC, normalEC, 10.0) + 0.25 * czm_getSpecular(czm_moonDirectionEC, normalizedpositionToEyeEC, normalEC, 10.0);\nfloat surfaceReflectance = mix(0.0, mix(u_zoomedOutOceanSpecularIntensity, oceanSpecularIntensity, waveIntensity), maskValue);\nfloat specular = specularIntensity * surfaceReflectance;\nreturn vec4(imageryColor.rgb + diffuseHighlight + nonDiffuseHighlight + specular, imageryColor.a);\n}\n#endif // #ifdef SHOW_REFLECTIVE_OCEAN\n"}),define("Shaders/GlobeVS",[],function(){"use strict";return"#ifdef QUANTIZATION_BITS12\nattribute vec4 compressed0;\nattribute float compressed1;\n#else\nattribute vec4 position3DAndHeight;\nattribute vec4 textureCoordAndEncodedNormals;\n#endif\nuniform vec3 u_center3D;\nuniform mat4 u_modifiedModelView;\nuniform mat4 u_modifiedModelViewProjection;\nuniform vec4 u_tileRectangle;\nuniform vec2 u_southAndNorthLatitude;\nuniform vec2 u_southMercatorYAndOneOverHeight;\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec3 v_textureCoordinates;\nvarying vec3 v_normalMC;\nvarying vec3 v_normalEC;\n#ifdef APPLY_MATERIAL\nvarying float v_slope;\nvarying float v_height;\n#endif\n#ifdef FOG\nvarying float v_distance;\nvarying vec3 v_mieColor;\nvarying vec3 v_rayleighColor;\n#endif\nvec4 getPosition(vec3 position, float height, vec2 textureCoordinates);\nfloat get2DYPositionFraction(vec2 textureCoordinates);\nvec4 getPosition3DMode(vec3 position, float height, vec2 textureCoordinates)\n{\nreturn u_modifiedModelViewProjection * vec4(position, 1.0);\n}\nfloat get2DMercatorYPositionFraction(vec2 textureCoordinates)\n{\nconst float maxTileWidth = 0.003068;\nfloat positionFraction = textureCoordinates.y;\nfloat southLatitude = u_southAndNorthLatitude.x;\nfloat northLatitude = u_southAndNorthLatitude.y;\nif (northLatitude - southLatitude > maxTileWidth)\n{\nfloat southMercatorY = u_southMercatorYAndOneOverHeight.x;\nfloat oneOverMercatorHeight = u_southMercatorYAndOneOverHeight.y;\nfloat currentLatitude = mix(southLatitude, northLatitude, textureCoordinates.y);\ncurrentLatitude = clamp(currentLatitude, -czm_webMercatorMaxLatitude, czm_webMercatorMaxLatitude);\npositionFraction = czm_latitudeToWebMercatorFraction(currentLatitude, southMercatorY, oneOverMercatorHeight);\n}\nreturn positionFraction;\n}\nfloat get2DGeographicYPositionFraction(vec2 textureCoordinates)\n{\nreturn textureCoordinates.y;\n}\nvec4 getPositionPlanarEarth(vec3 position, float height, vec2 textureCoordinates)\n{\nfloat yPositionFraction = get2DYPositionFraction(textureCoordinates);\nvec4 rtcPosition2D = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);\nreturn u_modifiedModelViewProjection * rtcPosition2D;\n}\nvec4 getPosition2DMode(vec3 position, float height, vec2 textureCoordinates)\n{\nreturn getPositionPlanarEarth(position, 0.0, textureCoordinates);\n}\nvec4 getPositionColumbusViewMode(vec3 position, float height, vec2 textureCoordinates)\n{\nreturn getPositionPlanarEarth(position, height, textureCoordinates);\n}\nvec4 getPositionMorphingMode(vec3 position, float height, vec2 textureCoordinates)\n{\nvec3 position3DWC = position + u_center3D;\nfloat yPositionFraction = get2DYPositionFraction(textureCoordinates);\nvec4 position2DWC = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);\nvec4 morphPosition = czm_columbusViewMorph(position2DWC, vec4(position3DWC, 1.0), czm_morphTime);\nreturn czm_modelViewProjection * morphPosition;\n}\n#ifdef QUANTIZATION_BITS12\nuniform vec2 u_minMaxHeight;\nuniform mat4 u_scaleAndBias;\n#endif\nvoid main()\n{\n#ifdef QUANTIZATION_BITS12\nvec2 xy = czm_decompressTextureCoordinates(compressed0.x);\nvec2 zh = czm_decompressTextureCoordinates(compressed0.y);\nvec3 position = vec3(xy, zh.x);\nfloat height = zh.y;\nvec2 textureCoordinates = czm_decompressTextureCoordinates(compressed0.z);\nheight = height * (u_minMaxHeight.y - u_minMaxHeight.x) + u_minMaxHeight.x;\nposition = (u_scaleAndBias * vec4(position, 1.0)).xyz;\n#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)) && defined(INCLUDE_WEB_MERCATOR_Y)\nfloat webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;\nfloat encodedNormal = compressed1;\n#elif defined(INCLUDE_WEB_MERCATOR_Y)\nfloat webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;\nfloat encodedNormal = 0.0;\n#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)\nfloat webMercatorT = textureCoordinates.y;\nfloat encodedNormal = compressed0.w;\n#else\nfloat webMercatorT = textureCoordinates.y;\nfloat encodedNormal = 0.0;\n#endif\n#else\nvec3 position = position3DAndHeight.xyz;\nfloat height = position3DAndHeight.w;\nvec2 textureCoordinates = textureCoordAndEncodedNormals.xy;\n#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)) && defined(INCLUDE_WEB_MERCATOR_Y)\nfloat webMercatorT = textureCoordAndEncodedNormals.z;\nfloat encodedNormal = textureCoordAndEncodedNormals.w;\n#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)\nfloat webMercatorT = textureCoordinates.y;\nfloat encodedNormal = textureCoordAndEncodedNormals.z;\n#elif defined(INCLUDE_WEB_MERCATOR_Y)\nfloat webMercatorT = textureCoordAndEncodedNormals.z;\nfloat encodedNormal = 0.0;\n#else\nfloat webMercatorT = textureCoordinates.y;\nfloat encodedNormal = 0.0;\n#endif\n#endif\nvec3 position3DWC = position + u_center3D;\ngl_Position = getPosition(position, height, textureCoordinates);\nv_textureCoordinates = vec3(textureCoordinates, webMercatorT);\n#if defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)\nv_positionEC = (u_modifiedModelView * vec4(position, 1.0)).xyz;\nv_positionMC = position3DWC;\nvec3 normalMC = czm_octDecode(encodedNormal);\nv_normalMC = normalMC;\nv_normalEC = czm_normal3D * v_normalMC;\n#elif defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING) || defined(GENERATE_POSITION)\nv_positionEC = (u_modifiedModelView * vec4(position, 1.0)).xyz;\nv_positionMC = position3DWC;\n#endif\n#ifdef FOG\nAtmosphereColor atmosColor = computeGroundAtmosphereFromSpace(position3DWC);\nv_mieColor = atmosColor.mie;\nv_rayleighColor = atmosColor.rayleigh;\nv_distance = length((czm_modelView3D * vec4(position3DWC, 1.0)).xyz);\n#endif\n#ifdef APPLY_MATERIAL\nvec3 finalNormal = normalMC;\nvec3 ellipsoidNormal = normalize(position3DWC.xyz);\nv_slope = abs(dot(ellipsoidNormal, finalNormal));\nv_height = height;\n#endif\n}\n"}),define("Shaders/GroundAtmosphere",[],function(){"use strict";return"const float fInnerRadius = 6378137.0;\nconst float fOuterRadius = 6378137.0 * 1.025;\nconst float fOuterRadius2 = fOuterRadius * fOuterRadius;\nconst float Kr = 0.0025;\nconst float Km = 0.0015;\nconst float ESun = 15.0;\nconst float fKrESun = Kr * ESun;\nconst float fKmESun = Km * ESun;\nconst float fKr4PI = Kr * 4.0 * czm_pi;\nconst float fKm4PI = Km * 4.0 * czm_pi;\nconst float fScale = 1.0 / (fOuterRadius - fInnerRadius);\nconst float fScaleDepth = 0.25;\nconst float fScaleOverScaleDepth = fScale / fScaleDepth;\nstruct AtmosphereColor\n{\nvec3 mie;\nvec3 rayleigh;\n};\nconst int nSamples = 2;\nconst float fSamples = 2.0;\nfloat scale(float fCos)\n{\nfloat x = 1.0 - fCos;\nreturn fScaleDepth * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\nAtmosphereColor computeGroundAtmosphereFromSpace(vec3 v3Pos)\n{\nvec3 v3InvWavelength = vec3(1.0 / pow(0.650, 4.0), 1.0 / pow(0.570, 4.0), 1.0 / pow(0.475, 4.0));\nvec3 v3Ray = v3Pos - czm_viewerPositionWC;\nfloat fFar = length(v3Ray);\nv3Ray /= fFar;\nfloat fCameraHeight = length(czm_viewerPositionWC);\nfloat fCameraHeight2 = fCameraHeight * fCameraHeight;\nfloat B = 2.0 * length(czm_viewerPositionWC) * dot(normalize(czm_viewerPositionWC), v3Ray);\nfloat C = fCameraHeight2 - fOuterRadius2;\nfloat fDet = max(0.0, B*B - 4.0 * C);\nfloat fNear = 0.5 * (-B - sqrt(fDet));\nvec3 v3Start = czm_viewerPositionWC + v3Ray * fNear;\nfFar -= fNear;\nfloat fDepth = exp((fInnerRadius - fOuterRadius) / fScaleDepth);\nfloat fLightAngle = 1.0;\nfloat fCameraAngle = dot(-v3Ray, v3Pos) / length(v3Pos);\nfloat fCameraScale = scale(fCameraAngle);\nfloat fLightScale = scale(fLightAngle);\nfloat fCameraOffset = fDepth*fCameraScale;\nfloat fTemp = (fLightScale + fCameraScale);\nfloat fSampleLength = fFar / fSamples;\nfloat fScaledLength = fSampleLength * fScale;\nvec3 v3SampleRay = v3Ray * fSampleLength;\nvec3 v3SamplePoint = v3Start + v3SampleRay * 0.5;\nvec3 v3FrontColor = vec3(0.0);\nvec3 v3Attenuate = vec3(0.0);\nfor(int i=0; i<nSamples; i++)\n{\nfloat fHeight = length(v3SamplePoint);\nfloat fDepth = exp(fScaleOverScaleDepth * (fInnerRadius - fHeight));\nfloat fScatter = fDepth*fTemp - fCameraOffset;\nv3Attenuate = exp(-fScatter * (v3InvWavelength * fKr4PI + fKm4PI));\nv3FrontColor += v3Attenuate * (fDepth * fScaledLength);\nv3SamplePoint += v3SampleRay;\n}\nAtmosphereColor color;\ncolor.mie = v3FrontColor * (v3InvWavelength * fKrESun + fKmESun);\ncolor.rayleigh = v3Attenuate;\nreturn color;\n}\n"}),define("Scene/GlobeSurfaceShaderSet",["../Core/defined","../Core/destroyObject","../Core/TerrainQuantization","../Renderer/ShaderProgram","../Scene/SceneMode"],function(O,a,I,M,r){"use strict";function R(e,t,r,i){this.numberOfDayTextures=e,this.flags=t,this.material=r,this.shaderProgram=i}function e(){this.baseVertexShaderSource=void 0,this.baseFragmentShaderSource=void 0,this._shadersByTexturesFlags=[],this._pickShaderPrograms=[],this.material=void 0}function L(e){var t;switch(e){case r.SCENE3D:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPosition3DMode(position, height, textureCoordinates); }";break;case r.SCENE2D:case r.COLUMBUS_VIEW:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionColumbusViewMode(position, height, textureCoordinates); }";break;case r.MORPHING:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionMorphingMode(position, height, textureCoordinates); }"}return t}function N(e){return e?"float get2DYPositionFraction(vec2 textureCoordinates) { return get2DMercatorYPositionFraction(textureCoordinates); }":"float get2DYPositionFraction(vec2 textureCoordinates) { return get2DGeographicYPositionFraction(textureCoordinates); }"}return e.prototype.getShaderProgram=function(e,t,r,i,n,o,a,s,l,u,c,d,h,p,f,m,g,_){var v=0,y="",b=t.pickTerrain.mesh.encoding;b.quantization===I.BITS12&&(v=1,y="QUANTIZATION_BITS12");var C=e.mode,w=C|i<<2|n<<3|o<<4|a<<5|s<<6|l<<7|c<<8|d<<9|h<<10|p<<11|f<<12|m<<13|v<<14|u<<15|g<<16,S=t.surfaceShader;if(O(S)&&S.numberOfDayTextures===r&&S.flags===w&&S.material===this.material)return S.shaderProgram;var T=this._shadersByTexturesFlags[r];if(O(T)||(T=this._shadersByTexturesFlags[r]=[]),S=T[w],!O(S)||S.material!==this.material){var E=this.baseVertexShaderSource.clone(),A=this.baseFragmentShaderSource.clone();E.defines.push(y),A.defines.push("TEXTURE_UNITS "+r),i&&A.defines.push("APPLY_BRIGHTNESS"),n&&A.defines.push("APPLY_CONTRAST"),o&&A.defines.push("APPLY_HUE"),a&&A.defines.push("APPLY_SATURATION"),s&&A.defines.push("APPLY_GAMMA"),l&&A.defines.push("APPLY_ALPHA"),c&&(A.defines.push("SHOW_REFLECTIVE_OCEAN"),E.defines.push("SHOW_REFLECTIVE_OCEAN")),d&&A.defines.push("SHOW_OCEAN_WAVES"),h&&(p?(E.defines.push("ENABLE_VERTEX_LIGHTING"),A.defines.push("ENABLE_VERTEX_LIGHTING")):(E.defines.push("ENABLE_DAYNIGHT_SHADING"),A.defines.push("ENABLE_DAYNIGHT_SHADING"))),E.defines.push("INCLUDE_WEB_MERCATOR_Y"),A.defines.push("INCLUDE_WEB_MERCATOR_Y"),m&&(E.defines.push("FOG"),A.defines.push("FOG")),u&&A.defines.push("APPLY_SPLIT"),g&&(A.defines.push("ENABLE_CLIPPING_PLANES"),_&&A.defines.push("UNION_CLIPPING_REGIONS"));for(var x="    vec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates)\n    {\n        vec4 color = initialColor;\n",P=0;P<r;++P)x+="    color = sampleAndBlend(\n        color,\n        u_dayTextures["+P+"],\n        u_dayTextureUseWebMercatorT["+P+"] ? textureCoordinates.xz : textureCoordinates.xy,\n        u_dayTextureTexCoordsRectangle["+P+"],\n        u_dayTextureTranslationAndScale["+P+"],\n        "+(l?"u_dayTextureAlpha["+P+"]":"1.0")+",\n        "+(i?"u_dayTextureBrightness["+P+"]":"0.0")+",\n        "+(n?"u_dayTextureContrast["+P+"]":"0.0")+",\n        "+(o?"u_dayTextureHue["+P+"]":"0.0")+",\n        "+(a?"u_dayTextureSaturation["+P+"]":"0.0")+",\n        "+(s?"u_dayTextureOneOverGamma["+P+"]":"0.0")+",\n        "+(u?"u_dayTextureSplit["+P+"]":"0.0")+"\n    );\n";x+="        return color;\n    }",A.sources.push(x),E.sources.push(L(C)),E.sources.push(N(f));var D=M.fromCache({context:e.context,vertexShaderSource:E,fragmentShaderSource:A,attributeLocations:b.getAttributeLocations()});S=T[w]=new R(r,w,this.material,D)}return(t.surfaceShader=S).shaderProgram},e.prototype.getPickShaderProgram=function(e,t,r){var i=0,n="",o=t.pickTerrain.mesh.encoding;o.quantization===I.BITS12&&(i=1,n="QUANTIZATION_BITS12");var a=e.mode,s=a|r<<2|i<<3,l=this._pickShaderPrograms[s];if(!O(l)){var u=this.baseVertexShaderSource.clone();u.defines.push(n),u.sources.push(L(a)),u.sources.push(N(r));l=this._pickShaderPrograms[s]=M.fromCache({context:e.context,vertexShaderSource:u,fragmentShaderSource:"void main()\n{\n    gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n}\n",attributeLocations:o.getAttributeLocations()})}return l},e.prototype.destroy=function(){var e,t,r=this._shadersByTexturesFlags;for(var i in r)if(r.hasOwnProperty(i)){var n=r[i];if(!O(n))continue;for(e in n)n.hasOwnProperty(e)&&(t=n[e],O(t)&&t.shaderProgram.destroy())}var o=this._pickShaderPrograms;for(e in o)o.hasOwnProperty(e)&&(t=o[e]).destroy();return a(this)},e}),define("Scene/ImageryState",["../Core/freezeObject"],function(e){"use strict";return e({UNLOADED:0,TRANSITIONING:1,RECEIVED:2,TEXTURE_LOADED:3,READY:4,FAILED:5,INVALID:6,PLACEHOLDER:7})}),define("Scene/QuadtreeTileLoadState",["../Core/freezeObject"],function(e){"use strict";return e({START:0,LOADING:1,DONE:2,FAILED:3})}),define("Scene/TerrainState",["../Core/freezeObject"],function(e){"use strict";return e({FAILED:0,UNLOADED:1,RECEIVING:2,RECEIVED:3,TRANSFORMING:4,TRANSFORMED:5,READY:6})}),define("Scene/TileTerrain",["../Core/BoundingSphere","../Core/Cartesian3","../Core/defined","../Core/DeveloperError","../Core/IndexDatatype","../Core/OrientedBoundingBox","../Core/Request","../Core/RequestState","../Core/RequestType","../Core/TileProviderError","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/VertexArray","../ThirdParty/when","./TerrainState"],function(i,n,p,d,f,o,c,h,m,g,_,v,y,b,C){"use strict";function e(e){this.state=C.UNLOADED,this.data=void 0,this.mesh=void 0,this.vertexArray=void 0,this.upsampleDetails=e,this.request=void 0}function w(t,e,r,i,n,o){var a=r.tilingScheme,s=t.data.createMesh(a,i,n,o,e.terrainExaggeration);p(s)&&(t.state=C.TRANSFORMING,b(s,function(e){t.mesh=e,t.state=C.TRANSFORMED},function(){t.state=C.FAILED}))}function S(e,t,r,i,n,o){var a=e.mesh.vertices,s=_.createVertexBuffer({context:t,typedArray:a,usage:v.STATIC_DRAW}),l=e.mesh.encoding.getAttributes(s),u=e.mesh.indices.indexBuffers||{},c=u[t.id];if(!p(c)||c.isDestroyed()){var d=e.mesh.indices,h=2===d.BYTES_PER_ELEMENT?f.UNSIGNED_SHORT:f.UNSIGNED_INT;(c=_.createIndexBuffer({context:t,typedArray:d,usage:v.STATIC_DRAW,indexDatatype:h})).vertexArrayDestroyable=!1,c.referenceCount=1,u[t.id]=c,e.mesh.indices.indexBuffers=u}else++c.referenceCount;e.vertexArray=new y({context:t,attributes:l,indexBuffer:c}),e.state=C.READY}return e.prototype.freeResources=function(){if(this.state=C.UNLOADED,this.data=void 0,this.mesh=void 0,p(this.vertexArray)){var e=this.vertexArray.indexBuffer;this.vertexArray.destroy(),this.vertexArray=void 0,!e.isDestroyed()&&p(e.referenceCount)&&(--e.referenceCount,0===e.referenceCount&&e.destroy())}},e.prototype.publishToTile=function(e){var t=e.data,r=this.mesh;n.clone(r.center,t.center),t.minimumHeight=r.minimumHeight,t.maximumHeight=r.maximumHeight,t.boundingSphere3D=i.clone(r.boundingSphere3D,t.boundingSphere3D),t.orientedBoundingBox=o.clone(r.orientedBoundingBox,t.orientedBoundingBox),t.tileBoundingRegion.minimumHeight=r.minimumHeight,t.tileBoundingRegion.maximumHeight=r.maximumHeight,e.data.occludeePointInScaledSpace=n.clone(r.occludeePointInScaledSpace,t.occludeePointInScaledSpace)},e.prototype.processLoadStateMachine=function(e,t,r,i,n,o){this.state===C.UNLOADED&&function(t,r,i,n,o,a){function s(e){t.data=e,t.state=C.RECEIVED,t.request=void 0}function l(){if(t.request.state===h.CANCELLED)return t.data=void 0,t.state=C.UNLOADED,void(t.request=void 0);t.state=C.FAILED,t.request=void 0;var e="Failed to obtain terrain tile X: "+i+" Y: "+n+" Level: "+o+".";r._requestError=g.handleError(r._requestError,r,r.errorEvent,e,i,n,o,u)}function u(){var e=new c({throttle:!0,throttleByServer:!0,type:m.TERRAIN,priorityFunction:a});t.request=e,t.data=r.requestTileGeometry(i,n,o,e),p(t.data)?(t.state=C.RECEIVING,b(t.data,s,l)):(t.state=C.UNLOADED,t.request=void 0)}u()}(this,t,r,i,n,o),this.state===C.RECEIVED&&w(this,e,t,r,i,n),this.state===C.TRANSFORMED&&S(this,e.context,t,r,i,n)},e.prototype.processUpsampleStateMachine=function(e,t,r,i,n){if(this.state===C.UNLOADED){var o=this.upsampleDetails;if(!p(o))throw new d("TileTerrain cannot upsample unless provided upsampleDetails.");var a=o.data,s=o.x,l=o.y,u=o.level;if(this.data=a.upsample(t.tilingScheme,s,l,u,r,i,n),!p(this.data))return;this.state=C.RECEIVING;var c=this;b(this.data,function(e){c.data=e,c.state=C.RECEIVED},function(){c.state=C.FAILED})}this.state===C.RECEIVED&&w(this,e,t,r,i,n),this.state===C.TRANSFORMED&&S(this,e.context,t,r,i,n)},e}),define("Scene/GlobeSurfaceTile",["../Core/BoundingSphere","../Core/Cartesian3","../Core/Cartesian4","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/IntersectionTests","../Core/PixelFormat","../Renderer/PixelDatatype","../Renderer/Sampler","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","./ImageryState","./QuadtreeTileLoadState","./SceneMode","./TerrainState","./TileBoundingRegion","./TileTerrain"],function(e,y,S,T,E,t,b,A,x,P,D,O,I,M,R,L,s,N,k,F){"use strict";function B(){this.imagery=[],this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new S(0,0,1,1),this.terrainData=void 0,this.center=new y,this.vertexArray=void 0,this.minimumHeight=0,this.maximumHeight=0,this.boundingSphere3D=new e,this.boundingSphere2D=new e,this.orientedBoundingBox=void 0,this.tileBoundingRegion=void 0,this.occludeePointInScaledSpace=new y,this.loadedTerrain=void 0,this.upsampledTerrain=void 0,this.pickBoundingSphere=new e,this.pickTerrain=void 0,this.surfaceShader=void 0,this.isClipped=!0}function C(e,t,r,i,n,o){if(e.decodePosition(i,n,o),E(t)&&t!==s.SCENE3D){var a=r.ellipsoid.cartesianToCartographic(o);r.project(a,o),y.fromElements(o.z,o.x,o.y,o)}return o}t(B.prototype,{eligibleForUnloading:{get:function(){for(var e=this.loadedTerrain,t=E(e)&&(e.state===N.RECEIVING||e.state===N.TRANSFORMING),r=this.upsampledTerrain,i=E(r)&&(r.state===N.RECEIVING||r.state===N.TRANSFORMING),n=!t&&!i,o=this.imagery,a=0,s=o.length;n&&a<s;++a){var l=o[a];n=!E(l.loadingImagery)||l.loadingImagery.state!==R.TRANSITIONING}return n}}});var w=new y,U=new y,V=new y,z=new y;function q(e,t){if(E(t)&&t.state!==L.START){var r=t.data;if(E(r.terrainData)&&!r.terrainData.wasCreatedByUpsampling())return;E(r.upsampledTerrain)&&r.upsampledTerrain.freeResources(),r.upsampledTerrain=new F({data:e.data.terrainData,x:e.x,y:e.y,level:e.level}),t.state=L.LOADING}}function G(e,t,r){if(r.state!==L.START){var i=r.data;if(E(i.terrainData)&&!i.terrainData.wasCreatedByUpsampling())return;E(i.upsampledTerrain)&&i.upsampledTerrain.freeResources(),i.upsampledTerrain=new F({data:t.terrainData,x:e.x,y:e.y,level:e.level}),t.terrainData.isChildAvailable(e.x,e.y,r.x,r.y)&&(E(i.loadedTerrain)||(i.loadedTerrain=new F)),r.state=L.LOADING}}return B.prototype.pick=function(e,t,r,i,n){var o=this.pickTerrain;if(E(o)){var a=o.mesh;if(E(a))for(var s=a.vertices,l=a.indices,u=a.encoding,c=l.length,d=0;d<c;d+=3){var h=l[d],p=l[d+1],f=l[d+2],m=C(u,t,r,s,h,w),g=C(u,t,r,s,p,U),_=C(u,t,r,s,f,V),v=b.rayTriangle(e,m,g,_,i,z);if(E(v))return y.clone(v,n)}}},B.prototype.freeResources=function(){var e,t;E(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,0===this.waterMaskTexture.referenceCount&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0),this.terrainData=void 0,E(this.loadedTerrain)&&(this.loadedTerrain.freeResources(),this.loadedTerrain=void 0),E(this.upsampledTerrain)&&(this.upsampledTerrain.freeResources(),this.upsampledTerrain=void 0),E(this.pickTerrain)&&(this.pickTerrain.freeResources(),this.pickTerrain=void 0);var r=this.imagery;for(e=0,t=r.length;e<t;++e)r[e].freeResources();this.imagery.length=0,this.freeVertexArray()},B.prototype.freeVertexArray=function(){var e;E(this.vertexArray)&&(e=this.vertexArray.indexBuffer,this.vertexArray=this.vertexArray.destroy(),!e.isDestroyed()&&E(e.referenceCount)&&(--e.referenceCount,0===e.referenceCount&&e.destroy())),E(this.wireframeVertexArray)&&(e=this.wireframeVertexArray.indexBuffer,this.wireframeVertexArray=this.wireframeVertexArray.destroy(),!e.isDestroyed()&&E(e.referenceCount)&&(--e.referenceCount,0===e.referenceCount&&e.destroy()))},B.processStateMachine=function(e,t,r,i,n){var o,a,s,l,u,c=e.data;E(c)||((c=e.data=new B).tileBoundingRegion=(E((o=e).parent)&&E(o.parent.data)&&(a=o.parent.data.minimumHeight,s=o.parent.data.maximumHeight),new k({rectangle:o.rectangle,ellipsoid:o.tilingScheme.ellipsoid,minimumHeight:a,maximumHeight:s}))),E(e._priorityFunction)||(e._priorityFunction=(l=c,u=t,function(){return l.tileBoundingRegion.distanceToCamera(u)})),e.state===L.START&&(!function(e,t,r){var i=e.data,n=function(e){var t=e.parent;for(;E(t)&&E(t.data)&&!E(t.data.terrainData);)t=t.parent;return E(t)&&E(t.data)?{data:t.data.terrainData,x:t.x,y:t.y,level:t.level}:void 0}(e);E(n)&&(i.upsampledTerrain=new F(n));(function(e,t){var r=t.getTileDataAvailable(e.x,e.y,e.level);if(E(r))return r;var i=e.parent;return!E(i)||!(!E(i.data)||!E(i.data.terrainData))&&i.data.terrainData.isChildAvailable(i.x,i.y,e.x,e.y)})(e,t)&&(i.loadedTerrain=new F);for(var o=0,a=r.length;o<a;++o){var s=r.get(o);s.show&&s._createTileImagerySkeletons(e,t)}}(e,r,i),e.state=L.LOADING),e.state===L.LOADING&&function(e,t,r,i){var n=e.data,o=n.loadedTerrain,a=n.upsampledTerrain,s=!1;E(o)&&(o.processLoadStateMachine(t,r,e.x,e.y,e.level,e._priorityFunction),o.state>=N.RECEIVED&&(n.terrainData!==o.data&&(n.terrainData=o.data,function(e,t){var r=t.waterMaskTexture;E(r)&&(--r.referenceCount,0===r.referenceCount&&r.destroy(),t.waterMaskTexture=void 0);var i=t.terrainData.waterMask;if(!E(i))return;var n,o=function(e){var t=e.cache.tile_waterMaskData;if(!E(t)){var r=new D({context:e,pixelFormat:A.LUMINANCE,pixelDatatype:x.UNSIGNED_BYTE,source:{arrayBufferView:new Uint8Array([255]),width:1,height:1}});r.referenceCount=1;var i=new P({wrapS:M.CLAMP_TO_EDGE,wrapT:M.CLAMP_TO_EDGE,minificationFilter:I.LINEAR,magnificationFilter:O.LINEAR});t={allWaterTexture:r,sampler:i,destroy:function(){this.allWaterTexture.destroy()}},e.cache.tile_waterMaskData=t}return t}(e),a=i.length;if(1===a){if(0===i[0])return;n=o.allWaterTexture}else{var s=Math.sqrt(a);(n=new D({context:e,pixelFormat:A.LUMINANCE,pixelDatatype:x.UNSIGNED_BYTE,source:{width:s,height:s,arrayBufferView:i},sampler:o.sampler})).referenceCount=0}++n.referenceCount,t.waterMaskTexture=n,S.fromElements(0,0,1,1,t.waterMaskTranslationAndScale)}(t.context,n),u=(l=e).data,G(l,u,l.southwestChild),G(l,u,l.southeastChild),G(l,u,l.northwestChild),G(l,u,l.northeastChild)),s=!0),o.state===N.READY?(o.publishToTile(e),E(e.data.vertexArray)&&i.push(e.data.vertexArray),e.data.vertexArray=o.vertexArray,o.vertexArray=void 0,n.pickTerrain=T(n.loadedTerrain,n.upsampledTerrain),n.loadedTerrain=void 0,n.upsampledTerrain=void 0):o.state===N.FAILED&&(n.loadedTerrain=void 0));var l,u;!s&&E(a)&&(a.processUpsampleStateMachine(t,r,e.x,e.y,e.level),a.state>=N.RECEIVED&&n.terrainData!==a.data&&(n.terrainData=a.data,r.hasWaterMask&&function(e){var t=e.data,r=e.parent;for(;E(r)&&!E(r.data.terrainData)||r.data.terrainData.wasCreatedByUpsampling();)r=r.parent;if(!E(r)||!E(r.data.waterMaskTexture))return;t.waterMaskTexture=r.data.waterMaskTexture,++t.waterMaskTexture.referenceCount;var i=r.rectangle,n=e.rectangle,o=n.width,a=n.height,s=o/i.width,l=a/i.height;t.waterMaskTranslationAndScale.x=s*(n.west-i.west)/o,t.waterMaskTranslationAndScale.y=l*(n.south-i.south)/a,t.waterMaskTranslationAndScale.z=s,t.waterMaskTranslationAndScale.w=l}(e),q(c=e,c._southwestChild),q(c,c._southeastChild),q(c,c._northwestChild),q(c,c._northeastChild)),a.state===N.READY?(a.publishToTile(e),E(e.data.vertexArray)&&i.push(e.data.vertexArray),e.data.vertexArray=a.vertexArray,a.vertexArray=void 0,n.pickTerrain=n.upsampledTerrain,n.upsampledTerrain=void 0):a.state===N.FAILED&&(n.upsampledTerrain=void 0));var c}(e,t,r,n);var d,h,p=E(c.vertexArray),f=!E(c.loadedTerrain)&&!E(c.upsampledTerrain),m=E(c.terrainData)&&c.terrainData.wasCreatedByUpsampling(),g=c.imagery;for(d=0,h=g.length;d<h;++d){var _=g[d];if(E(_.loadingImagery)){if(_.loadingImagery.state===R.PLACEHOLDER){var v=_.loadingImagery.imageryLayer;if(v.imageryProvider.ready){_.freeResources(),g.splice(d,1),v._createTileImagerySkeletons(e,r,d),--d,h=g.length;continue}m=!1}var y=_.processStateMachine(e,t);f=f&&y,p=p&&(y||E(_.readyImagery)),m=m&&E(_.loadingImagery)&&(_.loadingImagery.state===R.FAILED||_.loadingImagery.state===R.INVALID)}else m=!1}if(e.upsampledFromParent=m,d===h&&(p&&(e.renderable=!0),f)){var b=e._loadedCallbacks,C={};for(var w in b)b.hasOwnProperty(w)&&(b[w](e)||(C[w]=b[w]));e._loadedCallbacks=C,e.state=L.DONE,e._priorityFunction=void 0}},B}),define("Shaders/ReprojectWebMercatorFS",[],function(){"use strict";return"uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\ngl_FragColor = texture2D(u_texture, v_textureCoordinates);\n}\n"}),define("Shaders/ReprojectWebMercatorVS",[],function(){"use strict";return"attribute vec4 position;\nattribute float webMercatorT;\nuniform vec2 u_textureDimensions;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nv_textureCoordinates = vec2(position.x, webMercatorT);\ngl_Position = czm_viewportOrthographic * (position * vec4(u_textureDimensions, 1.0, 1.0));\n}\n"}),define("Scene/Imagery",["../Core/defined","../Core/destroyObject","./ImageryState"],function(l,e,u){"use strict";function r(e,t,r,i,n){if(this.imageryLayer=e,this.x=t,this.y=r,this.level=i,this.request=void 0,0!==i){var o=t/2|0,a=r/2|0,s=i-1;this.parent=e.getImageryFromCache(o,a,s)}(this.state=u.UNLOADED,this.imageUrl=void 0,this.image=void 0,this.texture=void 0,this.textureWebMercator=void 0,this.credits=void 0,this.referenceCount=0,!l(n)&&e.imageryProvider.ready)&&(n=e.imageryProvider.tilingScheme.tileXYToRectangle(t,r,i));this.rectangle=n}return r.createPlaceholder=function(e){var t=new r(e,0,0,0);return t.addReference(),t.state=u.PLACEHOLDER,t},r.prototype.addReference=function(){++this.referenceCount},r.prototype.releaseReference=function(){return--this.referenceCount,0===this.referenceCount?(this.imageryLayer.removeImageryFromCache(this),l(this.parent)&&this.parent.releaseReference(),l(this.image)&&l(this.image.destroy)&&this.image.destroy(),l(this.texture)&&this.texture.destroy(),l(this.textureWebMercator)&&this.texture!==this.textureWebMercator&&this.textureWebMercator.destroy(),e(this),0):this.referenceCount},r.prototype.processStateMachine=function(e,t,r){this.state===u.UNLOADED&&(this.state=u.TRANSITIONING,this.imageryLayer._requestImagery(this,r)),this.state===u.RECEIVED&&(this.state=u.TRANSITIONING,this.imageryLayer._createTexture(e.context,this));var i=this.state===u.READY&&t&&!this.texture;(this.state===u.TEXTURE_LOADED||i)&&(this.state=u.TRANSITIONING,this.imageryLayer._reprojectTexture(e,this,t))},r}),define("Scene/ImagerySplitDirection",["../Core/freezeObject"],function(e){"use strict";return e({LEFT:-1,NONE:0,RIGHT:1})}),define("Scene/TileImagery",["../Core/defined","./ImageryState"],function(a,s){"use strict";function e(e,t,r){this.readyImagery=void 0,this.loadingImagery=e,this.textureCoordinateRectangle=t,this.textureTranslationAndScale=void 0,this.useWebMercatorT=r}return e.prototype.freeResources=function(){a(this.readyImagery)&&this.readyImagery.releaseReference(),a(this.loadingImagery)&&this.loadingImagery.releaseReference()},e.prototype.processStateMachine=function(e,t){var r=this.loadingImagery,i=r.imageryLayer;if(r.processStateMachine(t,!this.useWebMercatorT,e._priorityFunction),r.state===s.READY)return a(this.readyImagery)&&this.readyImagery.releaseReference(),this.readyImagery=this.loadingImagery,this.loadingImagery=void 0,this.textureTranslationAndScale=i._calculateTextureTranslationAndScale(e,this),!0;for(var n,o=r.parent;a(o)&&(o.state!==s.READY||!this.useWebMercatorT&&!a(o.texture));)o.state!==s.FAILED&&o.state!==s.INVALID&&(n=n||o),o=o.parent;return this.readyImagery!==o&&(a(this.readyImagery)&&this.readyImagery.releaseReference(),this.readyImagery=o,a(o)&&(o.addReference(),this.textureTranslationAndScale=i._calculateTextureTranslationAndScale(e,this))),(r.state===s.FAILED||r.state===s.INVALID)&&(!a(n)||(n.processStateMachine(t,!this.useWebMercatorT,e._priorityFunction),!1))},e}),define("Scene/ImageryLayer",["../Core/Cartesian2","../Core/Cartesian4","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/FeatureDetection","../Core/GeographicTilingScheme","../Core/IndexDatatype","../Core/Math","../Core/PixelFormat","../Core/Rectangle","../Core/Request","../Core/RequestState","../Core/RequestType","../Core/TerrainProvider","../Core/TileProviderError","../Core/WebMercatorProjection","../Core/WebMercatorTilingScheme","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/ComputeCommand","../Renderer/ContextLimits","../Renderer/MipmapHint","../Renderer/Sampler","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","../Renderer/VertexArray","../Shaders/ReprojectWebMercatorFS","../Shaders/ReprojectWebMercatorVS","../ThirdParty/when","./Imagery","./ImagerySplitDirection","./ImageryState","./TileImagery"],function(e,H,f,j,t,r,s,i,Y,P,D,m,X,u,c,d,O,h,Q,Z,I,M,l,g,R,L,N,k,F,B,U,V,z,q,G,p,a,n,_,K){"use strict";function o(e,t){this._imageryProvider=e,t=f(t,{}),this.alpha=f(t.alpha,f(e.defaultAlpha,1)),this.brightness=f(t.brightness,f(e.defaultBrightness,o.DEFAULT_BRIGHTNESS)),this.contrast=f(t.contrast,f(e.defaultContrast,o.DEFAULT_CONTRAST)),this.hue=f(t.hue,f(e.defaultHue,o.DEFAULT_HUE)),this.saturation=f(t.saturation,f(e.defaultSaturation,o.DEFAULT_SATURATION)),this.gamma=f(t.gamma,f(e.defaultGamma,o.DEFAULT_GAMMA)),this.splitDirection=f(t.splitDirection,f(e.defaultSplit,o.DEFAULT_SPLIT)),this.minificationFilter=f(t.minificationFilter,f(e.defaultMinificationFilter,o.DEFAULT_MINIFICATION_FILTER)),this.magnificationFilter=f(t.magnificationFilter,f(e.defaultMagnificationFilter,o.DEFAULT_MAGNIFICATION_FILTER)),this.show=f(t.show,!0),this._minimumTerrainLevel=t.minimumTerrainLevel,this._maximumTerrainLevel=t.maximumTerrainLevel,this._rectangle=f(t.rectangle,X.MAX_VALUE),this._maximumAnisotropy=t.maximumAnisotropy,this._imageryCache={},this._skeletonPlaceholder=new K(a.createPlaceholder(this)),this._show=!0,this._layerIndex=-1,this._isBaseLayer=!1,this._requestImageError=void 0,this._reprojectComputeCommands=[]}t(o.prototype,{imageryProvider:{get:function(){return this._imageryProvider}},rectangle:{get:function(){return this._rectangle}}}),o.DEFAULT_BRIGHTNESS=1,o.DEFAULT_CONTRAST=1,o.DEFAULT_HUE=0,o.DEFAULT_SATURATION=1,o.DEFAULT_GAMMA=1,o.DEFAULT_SPLIT=n.NONE,o.DEFAULT_MINIFICATION_FILTER=U.LINEAR,o.DEFAULT_MAGNIFICATION_FILTER=B.LINEAR,o.prototype.isBaseLayer=function(){return this._isBaseLayer},o.prototype.isDestroyed=function(){return!1},o.prototype.destroy=function(){return r(this)};var J=new X,$=new X,ee=new X,te=new X;function v(e,t,r){return e+":"+t+":"+r}function y(e,t,r,i){var n=e.minificationFilter,o=e.magnificationFilter;if(n===U.LINEAR&&o===B.LINEAR&&!m.isCompressedFormat(i.pixelFormat)&&D.isPowerOfTwo(i.width)&&D.isPowerOfTwo(i.height)){n=U.LINEAR_MIPMAP_LINEAR;var a=g.maximumTextureFilterAnisotropy,s=Math.min(a,f(e._maximumAnisotropy,a)),l=v(n,o,s),u=t.cache.imageryLayerMipmapSamplers;j(u)||(u={},t.cache.imageryLayerMipmapSamplers=u);var c=u[l];j(c)||(c=u[l]=new L({wrapS:V.CLAMP_TO_EDGE,wrapT:V.CLAMP_TO_EDGE,minificationFilter:n,magnificationFilter:o,maximumAnisotropy:s})),i.generateMipmap(R.NICEST),i.sampler=c}else{var d=v(n,o,0),h=t.cache.imageryLayerNonMipmapSamplers;j(h)||(h={},t.cache.imageryLayerNonMipmapSamplers=h);var p=h[d];j(p)||(p=h[d]=new L({wrapS:V.CLAMP_TO_EDGE,wrapT:V.CLAMP_TO_EDGE,minificationFilter:n,magnificationFilter:o})),i.sampler=p}r.state=_.READY}function b(e,t,r){return JSON.stringify([e,t,r])}o.prototype.getViewableRectangle=function(){var e=this._imageryProvider,t=this._rectangle;return e.readyPromise.then(function(){return X.intersection(e.rectangle,t)})},o.prototype._createTileImagerySkeletons=function(e,t,r){var i=e.data;if(j(this._minimumTerrainLevel)&&e.level<this._minimumTerrainLevel)return!1;if(j(this._maximumTerrainLevel)&&e.level>this._maximumTerrainLevel)return!1;var n=this._imageryProvider;if(j(r)||(r=i.imagery.length),!n.ready)return this._skeletonPlaceholder.loadingImagery.addReference(),i.imagery.splice(r,0,this._skeletonPlaceholder),!0;var o=n.tilingScheme instanceof Z&&e.rectangle.north<Q.MaximumLatitude&&e.rectangle.south>-Q.MaximumLatitude,a=X.intersection(n.rectangle,this._rectangle,J),s=X.intersection(e.rectangle,a,$);if(!j(s)){if(!this.isBaseLayer())return!1;var l=a,u=e.rectangle;s=$,u.south>=l.north?s.north=s.south=l.north:u.north<=l.south?s.north=s.south=l.south:(s.south=Math.max(u.south,l.south),s.north=Math.min(u.north,l.north)),u.west>=l.east?s.west=s.east=l.east:u.east<=l.west?s.west=s.east=l.west:(s.west=Math.max(u.west,l.west),s.east=Math.min(u.east,l.east))}var c=0;0<s.south?c=s.south:s.north<0&&(c=s.north);var d,h,p,f,m,g,_,v,y,b,C=1*t.getLevelMaximumGeometricError(e.level),w=(h=C,p=c,f=(d=this)._imageryProvider,m=f.tilingScheme,g=m.ellipsoid,_=d._imageryProvider.tilingScheme instanceof Y?1:Math.cos(p),v=m.rectangle,y=g.maximumRadius*v.width*_/(f.tileWidth*m.getNumberOfXTilesAtLevel(0))/h,b=Math.log(y)/Math.log(2),0|Math.round(b));w=Math.max(0,w);var S=n.maximumLevel;if(S<w&&(w=S),j(n.minimumLevel)){var T=n.minimumLevel;w<T&&(w=T)}var E=n.tilingScheme,A=E.positionToTileXY(X.northwest(s),w),x=E.positionToTileXY(X.southeast(s),w),P=e.rectangle.width/512,D=e.rectangle.height/512,O=E.tileXYToRectangle(A.x,A.y,w);Math.abs(O.south-e.rectangle.north)<D&&A.y<x.y&&++A.y,Math.abs(O.east-e.rectangle.west)<P&&A.x<x.x&&++A.x;var I=E.tileXYToRectangle(x.x,x.y,w);Math.abs(I.north-e.rectangle.south)<D&&x.y>A.y&&--x.y,Math.abs(I.west-e.rectangle.east)<P&&x.x>A.x&&--x.x;var M,R,L=X.clone(e.rectangle,te),N=E.tileXYToRectangle(A.x,A.y,w),k=X.intersection(N,a,ee);o?(E.rectangleToNativeRectangle(L,L),E.rectangleToNativeRectangle(N,N),E.rectangleToNativeRectangle(k,k),E.rectangleToNativeRectangle(a,a),M=E.tileXYToNativeRectangle.bind(E),P=L.width/512,D=L.height/512):M=E.tileXYToRectangle.bind(E);var F,B=0,U=1;!this.isBaseLayer()&&Math.abs(k.west-L.west)>=P&&(B=Math.min(1,(k.west-L.west)/L.width)),!this.isBaseLayer()&&Math.abs(k.north-L.north)>=D&&(U=Math.max(0,(k.north-L.south)/L.height));for(var V=U,z=A.x;z<=x.x;z++)if(R=B,N=M(z,A.y,w),k=X.simpleIntersection(N,a,ee),j(k)){B=Math.min(1,(k.east-L.west)/L.width),z===x.x&&(this.isBaseLayer()||Math.abs(k.east-L.east)<P)&&(B=1),U=V;for(var q=A.y;q<=x.y;q++)if(F=U,N=M(z,q,w),k=X.simpleIntersection(N,a,ee),j(k)){U=Math.max(0,(k.south-L.south)/L.height),q===x.y&&(this.isBaseLayer()||Math.abs(k.south-L.south)<D)&&(U=0);var G=new H(R,U,B,F),W=this.getImageryFromCache(z,q,w);i.imagery.splice(r,0,new K(W,G,o)),++r}}return!0},o.prototype._calculateTextureTranslationAndScale=function(e,t){var r=t.readyImagery.rectangle,i=e.rectangle;if(t.useWebMercatorT){var n=t.readyImagery.imageryLayer.imageryProvider.tilingScheme;r=n.rectangleToNativeRectangle(r,J),i=n.rectangleToNativeRectangle(i,te)}var o=i.width,a=i.height,s=o/r.width,l=a/r.height;return new H(s*(i.west-r.west)/o,l*(i.south-r.south)/a,s,l)},o.prototype._requestImagery=function(r,i){var n=this._imageryProvider,o=this;function a(e){if(!j(e))return s();r.image=e,r.state=_.RECEIVED,r.request=void 0,h.handleSuccess(o._requestImageError)}function s(e){if(r.request.state===c.CANCELLED)return r.state=_.UNLOADED,void(r.request=void 0);r.state=_.FAILED,r.request=void 0;var t="Failed to obtain image tile X: "+r.x+" Y: "+r.y+" Level: "+r.level+".";o._requestImageError=h.handleError(o._requestImageError,n,n.errorEvent,t,r.x,r.y,r.level,l,e)}function l(){var e=new u({throttle:!0,throttleByServer:!0,type:d.IMAGERY,priorityFunction:i});r.request=e,r.state=_.TRANSITIONING;var t=n.requestImage(r.x,r.y,r.level,e);if(!j(t))return r.state=_.UNLOADED,void(r.request=void 0);j(n.getTileCredits)&&(r.credits=n.getTileCredits(r.x,r.y,r.level)),p(t,a,s)}l()},o.prototype._createTexture=function(e,t){var r=this._imageryProvider,i=t.image;if(j(r.tileDiscardPolicy)){var n=r.tileDiscardPolicy;if(j(n)){if(!n.isReady())return void(t.state=_.RECEIVED);if(n.shouldDiscardImage(i))return void(t.state=_.INVALID)}}if(this.minificationFilter!==U.NEAREST&&this.minificationFilter!==U.LINEAR)throw new s("ImageryLayer minification filter must be NEAREST or LINEAR");var o,a=new L({minificationFilter:this.minificationFilter,magnificationFilter:this.magnificationFilter});o=j(i.internalFormat)?new F({context:e,pixelFormat:i.internalFormat,width:i.width,height:i.height,source:{arrayBufferView:i.bufferView},sampler:a}):new F({context:e,source:i,pixelFormat:r.hasAlphaChannel?m.RGBA:m.RGB,sampler:a}),r.tilingScheme instanceof Z?t.textureWebMercator=o:t.texture=o,t.image=void 0,t.state=_.TEXTURE_LOADED},o.prototype._reprojectTexture=function(e,t,r){var i=t.textureWebMercator||t.texture,n=t.rectangle,o=e.context;if((r=f(r,!0))&&!(this._imageryProvider.tilingScheme instanceof Y)&&1e-5<n.width/i.width){var a=this;t.addReference();var s=new l({persists:!0,owner:this,preExecute:function(e){!function(e,t,r,i){var n=t.cache.imageryLayer_reproject;if(!j(n)){n=t.cache.imageryLayer_reproject={vertexArray:void 0,shaderProgram:void 0,sampler:void 0,destroy:function(){j(this.framebuffer)&&this.framebuffer.destroy(),j(this.vertexArray)&&this.vertexArray.destroy(),j(this.shaderProgram)&&this.shaderProgram.destroy()}};for(var o=new Float32Array(256),a=0,s=0;s<64;++s){var l=s/63;o[a++]=0,o[a++]=l,o[a++]=1,o[a++]=l}var u={position:0,webMercatorT:1},c=O.getRegularGridIndices(2,64),d=I.createIndexBuffer({context:t,typedArray:c,usage:M.STATIC_DRAW,indexDatatype:P.UNSIGNED_SHORT});n.vertexArray=new z({context:t,attributes:[{index:u.position,vertexBuffer:I.createVertexBuffer({context:t,typedArray:o,usage:M.STATIC_DRAW}),componentsPerAttribute:2},{index:u.webMercatorT,vertexBuffer:I.createVertexBuffer({context:t,sizeInBytes:512,usage:M.STREAM_DRAW}),componentsPerAttribute:1}],indexBuffer:d});var h=new k({sources:[G]});n.shaderProgram=N.fromCache({context:t,vertexShaderSource:h,fragmentShaderSource:q,attributeLocations:u}),n.sampler=new L({wrapS:V.CLAMP_TO_EDGE,wrapT:V.CLAMP_TO_EDGE,minificationFilter:U.LINEAR,magnificationFilter:B.LINEAR})}r.sampler=n.sampler;var p=r.width,f=r.height;W.textureDimensions.x=p,W.textureDimensions.y=f,W.texture=r;var m=Math.sin(i.south),g=.5*Math.log((1+m)/(1-m));m=Math.sin(i.north);var _=1/(.5*Math.log((1+m)/(1-m))-g),v=new F({context:t,width:p,height:f,pixelFormat:r.pixelFormat,pixelDatatype:r.pixelDatatype,preMultiplyAlpha:r.preMultiplyAlpha});D.isPowerOfTwo(p)&&D.isPowerOfTwo(f)&&v.generateMipmap(R.NICEST);for(var y=i.south,b=i.north,C=re,w=0,S=0;S<64;++S){var T=S/63,E=D.lerp(y,b,T);m=Math.sin(E);var A=.5*Math.log((1+m)/(1-m)),x=(A-g)*_;C[w++]=x,C[w++]=x}n.vertexArray.getAttribute(1).vertexBuffer.copyFromArrayView(C),e.shaderProgram=n.shaderProgram,e.outputTexture=v,e.uniformMap=W,e.vertexArray=n.vertexArray}(e,o,i,t.rectangle)},postExecute:function(e){t.texture=e,y(a,o,t,e),t.releaseReference()}});this._reprojectComputeCommands.push(s)}else r&&(t.texture=i),y(this,o,t,i)},o.prototype.queueReprojectionCommands=function(e){for(var t=this._reprojectComputeCommands,r=t.length,i=0;i<r;++i)e.commandList.push(t[i]);t.length=0},o.prototype.cancelReprojections=function(){this._reprojectComputeCommands.length=0},o.prototype.getImageryFromCache=function(e,t,r,i){var n=b(e,t,r),o=this._imageryCache[n];return j(o)||(o=new a(this,e,t,r,i),this._imageryCache[n]=o),o.addReference(),o},o.prototype.removeImageryFromCache=function(e){var t=b(e.x,e.y,e.level);delete this._imageryCache[t]};var W={u_textureDimensions:function(){return this.textureDimensions},u_texture:function(){return this.texture},textureDimensions:new e,texture:void 0},re=i.supportsTypedArrays()?new Float32Array(128):void 0;return o}),define("Scene/GlobeSurfaceTileProvider",["../Core/BoundingSphere","../Core/BoxOutlineGeometry","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/ClippingPlaneCollection","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/combine","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Event","../Core/GeometryInstance","../Core/GeometryPipeline","../Core/IndexDatatype","../Core/Intersect","../Core/Math","../Core/Matrix4","../Core/OrientedBoundingBox","../Core/OrthographicFrustum","../Core/Plane","../Core/PrimitiveType","../Core/Rectangle","../Core/SphereOutlineGeometry","../Core/TerrainQuantization","../Core/Visibility","../Core/WebMercatorProjection","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/VertexArray","../Scene/BlendingState","../Scene/DepthFunction","../Scene/PerInstanceColorAppearance","../Scene/Primitive","./GlobeSurfaceTile","./ImageryLayer","./QuadtreeTileLoadState","./SceneMode","./ShadowMode"],function(fe,e,t,me,ge,_e,ve,l,ye,p,be,r,i,Ce,n,u,a,s,h,we,Se,Te,f,o,Ee,Ae,c,xe,m,Pe,d,g,De,Oe,Ie,_,v,y,b,C,w,S,Me,T,Re,Le){"use strict";function E(e){if(!be(e))throw new Ce("options is required.");if(!be(e.terrainProvider))throw new Ce("options.terrainProvider is required.");if(!be(e.imageryLayers))throw new Ce("options.imageryLayers is required.");if(!be(e.surfaceShaderSet))throw new Ce("options.surfaceShaderSet is required.");this.lightingFadeOutDistance=65e5,this.lightingFadeInDistance=9e6,this.hasWaterMask=!1,this.oceanNormalMap=void 0,this.zoomedOutOceanSpecularIntensity=.5,this.enableLighting=!1,this.shadows=Le.RECEIVE_ONLY,this._quadtree=void 0,this._terrainProvider=e.terrainProvider,this._imageryLayers=e.imageryLayers,this._surfaceShaderSet=e.surfaceShaderSet,this._renderState=void 0,this._blendRenderState=void 0,this._pickRenderState=void 0,this._errorEvent=new n,this._imageryLayers.layerAdded.addEventListener(E.prototype._onLayerAdded,this),this._imageryLayers.layerRemoved.addEventListener(E.prototype._onLayerRemoved,this),this._imageryLayers.layerMoved.addEventListener(E.prototype._onLayerMoved,this),this._imageryLayers.layerShownOrHidden.addEventListener(E.prototype._onLayerShownOrHidden,this),this._tileLoadedEvent=new n,this._imageryLayersUpdatedEvent=new n,this._layerOrderChanged=!1,this._tilesToRenderByTextureCount=[],this._drawCommands=[],this._uniformMaps=[],this._pickCommands=[],this._usedDrawCommands=0,this._usedPickCommands=0,this._vertexArraysToDestroy=[],this._debug={wireframe:!1,boundingSphereTile:void 0},this._baseColor=void 0,this._firstPassInitialColor=void 0,this.baseColor=new ve(0,0,.5,1),this.clippingPlanes=void 0}function A(e,t){var r=e.loadingImagery;be(r)||(r=e.readyImagery);var i=t.loadingImagery;return be(i)||(i=t.readyImagery),r.imageryLayer._layerIndex-i.imageryLayer._layerIndex}r(E.prototype,{baseColor:{get:function(){return this._baseColor},set:function(e){if(!be(e))throw new Ce("value is required.");this._baseColor=e,this._firstPassInitialColor=ge.fromColor(e,this._firstPassInitialColor)}},quadtree:{get:function(){return this._quadtree},set:function(e){if(!be(e))throw new Ce("value is required.");this._quadtree=e}},ready:{get:function(){return this._terrainProvider.ready&&(0===this._imageryLayers.length||this._imageryLayers.get(0).imageryProvider.ready)}},tilingScheme:{get:function(){return this._terrainProvider.tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},tileLoadedEvent:{get:function(){return this._tileLoadedEvent}},imageryLayersUpdatedEvent:{get:function(){return this._imageryLayersUpdatedEvent}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){if(this._terrainProvider!==e){if(!be(e))throw new Ce("terrainProvider is required.");this._terrainProvider=e,be(this._quadtree)&&this._quadtree.invalidateAllTiles()}}}}),E.prototype.update=function(e){this._imageryLayers._update()},E.prototype.initialize=function(e){this._imageryLayers.queueReprojectionCommands(e),this._layerOrderChanged&&(this._layerOrderChanged=!1,this._quadtree.forEachLoadedTile(function(e){e.data.imagery.sort(A)})),function(e,t){var r=t.creditDisplay;e._terrainProvider.ready&&be(e._terrainProvider.credit)&&r.addCredit(e._terrainProvider.credit);for(var i=e._imageryLayers,n=0,o=i.length;n<o;++n){var a=i.get(n).imageryProvider;a.ready&&be(a.credit)&&r.addCredit(a.credit)}}(this,e);for(var t,r,i=this._vertexArraysToDestroy,n=i.length,o=0;o<n;++o)t=i[o],r=void 0,r=t.indexBuffer,t.destroy(),!r.isDestroyed()&&be(r.referenceCount)&&(--r.referenceCount,0===r.referenceCount&&r.destroy());i.length=0},E.prototype.beginUpdate=function(e){for(var t=this._tilesToRenderByTextureCount,r=0,i=t.length;r<i;++r){var n=t[r];be(n)&&(n.length=0)}this._usedDrawCommands=0},E.prototype.endUpdate=function(e){be(this._renderState)||(this._renderState=_.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:b.LESS}}),this._blendRenderState=_.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:b.LESS_OR_EQUAL},blending:y.ALPHA_BLEND}));for(var t=this._tilesToRenderByTextureCount,r=0,i=t.length;r<i;++r){var n=t[r];if(be(n))for(var o=0,a=n.length;o<a;++o)I(this,n[o],e)}},E.prototype.updateForPick=function(e){be(this._pickRenderState)||(this._pickRenderState=_.fromCache({colorMask:{red:!1,green:!1,blue:!1,alpha:!1},depthTest:{enabled:!0}})),this._usedPickCommands=0;for(var t=this._drawCommands,r=0,i=this._usedDrawCommands;r<i;++r)M(this,t[r],e)},E.prototype.cancelReprojections=function(){this._imageryLayers.cancelReprojections()},E.prototype.getLevelMaximumGeometricError=function(e){return this._terrainProvider.getLevelMaximumGeometricError(e)},E.prototype.loadTile=function(e,t){S.processStateMachine(t,e,this._terrainProvider,this._imageryLayers,this._vertexArraysToDestroy);var r=this._tileLoadedEvent;t._loadedCallbacks.tileLoadedEvent=function(e){return r.raiseEvent(),!0}};var x=new fe;E.prototype.computeTileVisibility=function(e,t,r){var i=this.computeDistanceToTile(e,t);if(e._distance=i,t.fog.enabled&&1<=we.fog(i,t.fog.density))return m.NONE;var n=e.data,o=t.cullingVolume,a=p(n.orientedBoundingBox,n.boundingSphere3D);t.mode!==Re.SCENE3D&&(a=x,fe.fromRectangleWithHeights2D(e.rectangle,t.mapProjection,n.minimumHeight,n.maximumHeight,a),me.fromElements(a.center.z,a.center.x,a.center.y,a.center),t.mode===Re.MORPHING&&(a=fe.union(n.boundingSphere3D,a,a)));var s=this.clippingPlanes;if(be(s)&&s.enabled){var l=s.computeIntersectionWithBoundingVolume(a);if(e.isClipped=l!==h.INSIDE,l===h.OUTSIDE)return m.NONE}var u=o.computeVisibility(a);if(u===h.OUTSIDE)return m.NONE;var c=t.mode===Re.SCENE3D&&t.camera.frustum instanceof f;if(t.mode!==Re.SCENE3D||c||!be(r))return u;var d=n.occludeePointInScaledSpace;return be(d)?r.ellipsoid.isScaledSpacePointVisible(d)?u:m.NONE:u};var Ne,ke,Fe,P=new Se,D=new Se,Be=new ge,Ue=new me,O=new me,Ve=new me,ze=new me;function qe(i){return{u_initialColor:function(){return this.properties.initialColor},u_zoomedOutOceanSpecularIntensity:function(){return this.properties.zoomedOutOceanSpecularIntensity},u_oceanNormalMap:function(){return this.properties.oceanNormalMap},u_lightingFadeDistance:function(){return this.properties.lightingFadeDistance},u_center3D:function(){return this.properties.center3D},u_tileRectangle:function(){return this.properties.tileRectangle},u_modifiedModelView:function(){var e=i.context.uniformState.view,t=Se.multiplyByPoint(e,this.properties.rtc,O);return Se.setTranslation(e,t,P),P},u_modifiedModelViewProjection:function(){var e=i.context.uniformState.view,t=i.context.uniformState.projection,r=Se.multiplyByPoint(e,this.properties.rtc,O);return Se.setTranslation(e,r,D),Se.multiply(t,D,D),D},u_dayTextures:function(){return this.properties.dayTextures},u_dayTextureTranslationAndScale:function(){return this.properties.dayTextureTranslationAndScale},u_dayTextureTexCoordsRectangle:function(){return this.properties.dayTextureTexCoordsRectangle},u_dayTextureUseWebMercatorT:function(){return this.properties.dayTextureUseWebMercatorT},u_dayTextureAlpha:function(){return this.properties.dayTextureAlpha},u_dayTextureBrightness:function(){return this.properties.dayTextureBrightness},u_dayTextureContrast:function(){return this.properties.dayTextureContrast},u_dayTextureHue:function(){return this.properties.dayTextureHue},u_dayTextureSaturation:function(){return this.properties.dayTextureSaturation},u_dayTextureOneOverGamma:function(){return this.properties.dayTextureOneOverGamma},u_dayIntensity:function(){return this.properties.dayIntensity},u_southAndNorthLatitude:function(){return this.properties.southAndNorthLatitude},u_southMercatorYAndOneOverHeight:function(){return this.properties.southMercatorYAndOneOverHeight},u_waterMask:function(){return this.properties.waterMask},u_waterMaskTranslationAndScale:function(){return this.properties.waterMaskTranslationAndScale},u_minMaxHeight:function(){return this.properties.minMaxHeight},u_scaleAndBias:function(){return this.properties.scaleAndBias},u_dayTextureSplit:function(){return this.properties.dayTextureSplit},u_clippingPlanesLength:function(){return this.properties.clippingPlanes.length},u_clippingPlanes:function(){return this.properties.clippingPlanes},u_clippingPlanesEdgeStyle:function(){var e=this.properties.clippingPlanesEdgeColor;return e.alpha=this.properties.clippingPlanesEdgeWidth,e},u_minimumBrightness:function(){return i.fog.minimumBrightness},properties:{initialColor:new ge(0,0,.5,1),zoomedOutOceanSpecularIntensity:.5,oceanNormalMap:void 0,lightingFadeDistance:new t(65e5,9e6),center3D:void 0,rtc:new me,modifiedModelView:new Se,tileRectangle:new ge,dayTextures:[],dayTextureTranslationAndScale:[],dayTextureTexCoordsRectangle:[],dayTextureUseWebMercatorT:[],dayTextureAlpha:[],dayTextureBrightness:[],dayTextureContrast:[],dayTextureHue:[],dayTextureSaturation:[],dayTextureOneOverGamma:[],dayTextureSplit:[],dayIntensity:0,southAndNorthLatitude:new t,southMercatorYAndOneOverHeight:new t,waterMask:void 0,waterMaskTranslationAndScale:new ge,minMaxHeight:new t,scaleAndBias:new Se,clippingPlanes:[],clippingPlanesEdgeColor:ve.clone(ve.WHITE),clippingPlanesEdgeWidth:0}}}function Ge(e,t,r){var i=r.data;be(i.wireframeVertexArray)||be(i.terrainData)&&be(i.terrainData._mesh)&&(i.wireframeVertexArray=function(e,t,r){var i={indices:r.indices,primitiveType:Ee.TRIANGLES};a.toWireframe(i);var n=i.indices,o=d.createIndexBuffer({context:e,typedArray:n,usage:g.STATIC_DRAW,indexDatatype:s.UNSIGNED_SHORT});return new v({context:e,attributes:t._attributes,indexBuffer:o})}(e,i.vertexArray,i.terrainData._mesh))}E.prototype.showTileThisFrame=function(e,t){for(var r=0,i=e.data.imagery,n=0,o=i.length;n<o;++n){var a=i[n];be(a.readyImagery)&&0!==a.readyImagery.imageryLayer.alpha&&++r}var s=this._tilesToRenderByTextureCount[r];be(s)||(s=[],this._tilesToRenderByTextureCount[r]=s),s.push(e);var l=this._debug;++l.tilesRendered,l.texturesRendered+=r},E.prototype.computeDistanceToTile=function(e,t){return e.data.tileBoundingRegion.distanceToCamera(t)},E.prototype.isDestroyed=function(){return!1},E.prototype.destroy=function(){return this._tileProvider=this._tileProvider&&this._tileProvider.destroy(),i(this)},E.prototype._onLayerAdded=function(d,e){if(d.show){var h=this._terrainProvider,t=this,r=d.imageryProvider,i=this._imageryLayersUpdatedEvent;r._reload=function(){d._imageryCache={},t._quadtree.forEachLoadedTile(function(e){if(!be(e._loadedCallbacks[d._layerIndex])){var t,r=e.data.imagery,i=r.length,n=-1,o=0;for(t=0;t<i;++t){var a=r[t];if(p(a.readyImagery,a.loadingImagery).imageryLayer===d)-1===n&&(n=t),++o;else if(-1!==n)break}if(-1!==n){var l,u,c,s=n+o;d._createTileImagerySkeletons(e,h,s)&&(e._loadedCallbacks[d._layerIndex]=(l=o,u=d,c=h,function(e){var t,r,i,n=-1,o=e.data.imagery,a=o.length;for(i=0;i<a;++i)if(t=o[i],(r=p(t.readyImagery,t.loadingImagery)).imageryLayer===u){n=i;break}if(-1!==n){var s=n+l;if(t=o[s],r=be(t)?p(t.readyImagery,t.loadingImagery):void 0,!be(r)||r.imageryLayer!==u)return!u._createTileImagerySkeletons(e,c,s);for(i=n;i<s;++i)o[i].freeResources();o.splice(n,l)}return!0}),e.state=T.LOADING)}}})},this._quadtree.forEachLoadedTile(function(e){d._createTileImagerySkeletons(e,h)&&(e.state=T.LOADING)}),this._layerOrderChanged=!0,i.raiseEvent()}},E.prototype._onLayerRemoved=function(l,e){this._quadtree.forEachLoadedTile(function(e){for(var t=e.data.imagery,r=-1,i=0,n=0,o=t.length;n<o;++n){var a=t[n],s=a.loadingImagery;if(be(s)||(s=a.readyImagery),s.imageryLayer===l)-1===r&&(r=n),a.freeResources(),++i;else if(-1!==r)break}-1!==r&&t.splice(r,i)}),be(l.imageryProvider)&&(l.imageryProvider._reload=void 0),this._imageryLayersUpdatedEvent.raiseEvent()},E.prototype._onLayerMoved=function(e,t,r){this._layerOrderChanged=!0,this._imageryLayersUpdatedEvent.raiseEvent()},E.prototype._onLayerShownOrHidden=function(e,t,r){r?this._onLayerAdded(e,t):this._onLayerRemoved(e,t)},function(){var r,i,n=new u({geometry:e.fromDimensions({dimensions:new me(2,2,2)})}),o=new u({geometry:new c({radius:1})}),a=new Se;function s(e){return new w({geometryInstances:e,appearance:new C({translucent:!1,flat:!0}),asynchronous:!1})}Ne=function(e,t){return e===r?i:(Fe(),r=e,a=Se.fromRotationTranslation(e.halfAxes,e.center,a),n.modelMatrix=a,n.attributes.color=l.fromColor(t),i=s(n))},ke=function(e,t){return e===r?i:(Fe(),r=e,a=Se.fromTranslation(e.center,a),a=Se.multiplyByUniformScale(a,e.radius,a),o.modelMatrix=a,o.attributes.color=l.fromColor(t),i=s(o))},Fe=function(){be(i)&&(i.destroy(),r=i=void 0)}}();var We=new ge(0,0,0,0);function I(e,t,r){var i=t.data,n=r.creditDisplay,o=i.terrainData;if(be(o)&&be(o.credits))for(var a=o.credits,s=0,l=a.length;s<l;++s)n.addCredit(a[s]);var u=De.maximumTextureImageUnits,c=i.waterMaskTexture,d=e.hasWaterMask&&be(c),h=e.oceanNormalMap,p=d&&be(h),f=e.terrainProvider.ready&&e.terrainProvider.hasVertexNormals,m=r.fog.enabled,g=Le.castShadows(e.shadows),_=Le.receiveShadows(e.shadows);d&&--u,p&&--u;var v=i.center,y=i.pickTerrain.mesh.encoding,b=Be,C=0,w=0,S=0,T=0,E=!1;if(r.mode!==Re.SCENE3D){var A=r.mapProjection,x=A.project(Ae.southwest(t.rectangle),Ve),P=A.project(Ae.northeast(t.rectangle),ze);if(b.x=x.x,b.y=x.y,b.z=P.x,b.w=P.y,r.mode!==Re.MORPHING&&((v=Ue).x=0,v.y=.5*(b.z+b.x),v.z=.5*(b.w+b.y),b.x-=v.y,b.y-=v.z,b.z-=v.y,b.w-=v.z),r.mode===Re.SCENE2D&&y.quantization===xe.BITS12){var D=1/(Math.pow(2,12)-1)*.5,O=(b.z-b.x)*D,I=(b.w-b.y)*D;b.x-=O,b.y-=I,b.z+=O,b.w+=I}A instanceof Pe&&(C=t.rectangle.south,w=t.rectangle.north,S=Pe.geodeticLatitudeToMercatorAngle(C),T=1/(Pe.geodeticLatitudeToMercatorAngle(w)-S),E=!0)}var M=i.imagery,R=0,L=M.length,N=e._renderState,k=e._blendRenderState,F=N,B=e._firstPassInitialColor,U=r.context;be(e._debug.boundingSphereTile)||Fe();do{var V,z,q=0;e._drawCommands.length<=e._usedDrawCommands?((V=new Oe).owner=t,V.cull=!1,V.boundingVolume=new fe,V.orientedBoundingBox=void 0,z=qe(r),e._drawCommands.push(V),e._uniformMaps.push(z)):(V=e._drawCommands[e._usedDrawCommands],z=e._uniformMaps[e._usedDrawCommands]),V.owner=t,++e._usedDrawCommands,t===e._debug.boundingSphereTile&&(be(i.orientedBoundingBox)?Ne(i.orientedBoundingBox,ve.RED).update(r):be(i.boundingSphere3D)&&ke(i.boundingSphere3D,ve.RED).update(r));var G=z.properties;ge.clone(B,G.initialColor),G.oceanNormalMap=h,G.lightingFadeDistance.x=e.lightingFadeOutDistance,G.lightingFadeDistance.y=e.lightingFadeInDistance,G.zoomedOutOceanSpecularIntensity=e.zoomedOutOceanSpecularIntensity,G.center3D=i.center,me.clone(v,G.rtc),ge.clone(b,G.tileRectangle),G.southAndNorthLatitude.x=C,G.southAndNorthLatitude.y=w,G.southMercatorYAndOneOverHeight.x=S,G.southMercatorYAndOneOverHeight.y=T;for(var W=m&&we.fog(t._distance,r.fog.density)>we.EPSILON3,H=!1,j=!1,Y=!1,X=!1,Q=!1,Z=!1,K=!1;q<u&&R<L;){var J=M[R],$=J.readyImagery;if(++R,be($)&&0!==$.imageryLayer.alpha){var ee=J.useWebMercatorT?$.textureWebMercator:$.texture;if(!be(ee))throw new Ce("readyImagery is not actually ready!");var te=$.imageryLayer;if(be(J.textureTranslationAndScale)||(J.textureTranslationAndScale=te._calculateTextureTranslationAndScale(t,J)),G.dayTextures[q]=ee,G.dayTextureTranslationAndScale[q]=J.textureTranslationAndScale,G.dayTextureTexCoordsRectangle[q]=J.textureCoordinateRectangle,G.dayTextureUseWebMercatorT[q]=J.useWebMercatorT,G.dayTextureAlpha[q]=te.alpha,Z=Z||1!==G.dayTextureAlpha[q],G.dayTextureBrightness[q]=te.brightness,H=H||G.dayTextureBrightness[q]!==Me.DEFAULT_BRIGHTNESS,G.dayTextureContrast[q]=te.contrast,j=j||G.dayTextureContrast[q]!==Me.DEFAULT_CONTRAST,G.dayTextureHue[q]=te.hue,Y=Y||G.dayTextureHue[q]!==Me.DEFAULT_HUE,G.dayTextureSaturation[q]=te.saturation,X=X||G.dayTextureSaturation[q]!==Me.DEFAULT_SATURATION,G.dayTextureOneOverGamma[q]=1/te.gamma,Q=Q||G.dayTextureOneOverGamma[q]!==1/Me.DEFAULT_GAMMA,G.dayTextureSplit[q]=te.splitDirection,K=K||0!==G.dayTextureSplit[q],be($.credits))for(var re=$.credits,ie=0,ne=re.length;ie<ne;++ie)n.addCredit(re[ie]);++q}}G.dayTextures.length=q,G.waterMask=c,ge.clone(i.waterMaskTranslationAndScale,G.waterMaskTranslationAndScale),G.minMaxHeight.x=y.minimumHeight,G.minMaxHeight.y=y.maximumHeight,Se.clone(y.matrix,G.scaleAndBias);var oe=e.clippingPlanes,ae=0;be(oe)&&t.isClipped&&(ae=oe.length);var se=G.clippingPlanes,le=se.length;if(le!==ae){se.length=ae;for(var ue=le;ue<ae;++ue)se[ue]=new ge}be(oe)&&oe.enabled&&t.isClipped&&(oe.transformAndPackPlanes(U.uniformState.view,se),G.clippingPlanesEdgeColor=ve.clone(oe.edgeColor,G.clippingPlanesEdgeColor),G.clippingPlanesEdgeWidth=oe.edgeWidth);var ce=be(oe)&&oe.enabled&&0<G.clippingPlanes.length&&_e.isSupported(),de=!!ce&&oe.unionClippingRegions;be(e.uniformMap)&&(z=ye(z,e.uniformMap)),V.shaderProgram=e._surfaceShaderSet.getShaderProgram(r,i,q,H,j,Y,X,Q,Z,K,d,p,e.enableLighting,f,E,W,ce,de),V.castShadows=g,V.receiveShadows=_,V.renderState=F,V.primitiveType=Ee.TRIANGLES,V.vertexArray=i.vertexArray,V.uniformMap=z,V.pass=Ie.GLOBE,e._debug.wireframe&&(Ge(U,0,t),be(i.wireframeVertexArray)&&(V.vertexArray=i.wireframeVertexArray,V.primitiveType=Ee.LINES));var he=V.boundingVolume,pe=V.orientedBoundingBox;r.mode!==Re.SCENE3D?(fe.fromRectangleWithHeights2D(t.rectangle,r.mapProjection,i.minimumHeight,i.maximumHeight,he),me.fromElements(he.center.z,he.center.x,he.center.y,he.center),r.mode===Re.MORPHING&&(he=fe.union(i.boundingSphere3D,he,he))):(V.boundingVolume=fe.clone(i.boundingSphere3D,he),V.orientedBoundingBox=Te.clone(i.orientedBoundingBox,pe)),r.commandList.push(V),F=k,B=We}while(R<L)}function M(e,t,r){var i;e._pickCommands.length<=e._usedPickCommands?((i=new Oe).cull=!1,e._pickCommands.push(i)):i=e._pickCommands[e._usedPickCommands],++e._usedPickCommands;var n=t.owner.data,o=r.projection instanceof Pe;i.shaderProgram=e._surfaceShaderSet.getPickShaderProgram(r,n,o),i.renderState=e._pickRenderState,i.owner=t.owner,i.primitiveType=t.primitiveType,i.vertexArray=t.vertexArray,i.uniformMap=t.uniformMap,i.boundingVolume=t.boundingVolume,i.orientedBoundingBox=t.orientedBoundingBox,i.pass=t.pass,r.commandList.push(i)}return E}),define("Scene/ImageryLayerCollection",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Event","../Core/Math","../Core/Rectangle","../ThirdParty/when","./ImageryLayer"],function(o,v,e,t,i,r,y,b,C,n){"use strict";function a(){this._layers=[],this.layerAdded=new r,this.layerRemoved=new r,this.layerMoved=new r,this.layerShownOrHidden=new r}function s(e,t){if(!v(t))throw new i("layer is required.");var r=e.indexOf(t);if(-1===r)throw new i("layer is not in this collection.");return r}function l(e,t,r){var i=e._layers;if((t=y.clamp(t,0,i.length-1))!==(r=y.clamp(r,0,i.length-1))){var n=i[t];i[t]=i[r],i[r]=n,e._update(),e.layerMoved.raiseEvent(n,r,t)}}e(a.prototype,{length:{get:function(){return this._layers.length}}}),a.prototype.add=function(e,t){var r=v(t);if(!v(e))throw new i("layer is required.");if(r){if(t<0)throw new i("index must be greater than or equal to zero.");if(t>this._layers.length)throw new i("index must be less than or equal to the number of layers.")}r?this._layers.splice(t,0,e):(t=this._layers.length,this._layers.push(e)),this._update(),this.layerAdded.raiseEvent(e,t)},a.prototype.addImageryProvider=function(e,t){if(!v(e))throw new i("imageryProvider is required.");var r=new n(e);return this.add(r,t),r},a.prototype.remove=function(e,t){t=o(t,!0);var r=this._layers.indexOf(e);return-1!==r&&(this._layers.splice(r,1),this._update(),this.layerRemoved.raiseEvent(e,r),t&&e.destroy(),!0)},a.prototype.removeAll=function(e){e=o(e,!0);for(var t=this._layers,r=0,i=t.length;r<i;r++){var n=t[r];this.layerRemoved.raiseEvent(n,r),e&&n.destroy()}this._layers=[]},a.prototype.contains=function(e){return-1!==this.indexOf(e)},a.prototype.indexOf=function(e){return this._layers.indexOf(e)},a.prototype.get=function(e){if(!v(e))throw new i("index is required.","index");return this._layers[e]},a.prototype.raise=function(e){var t=s(this._layers,e);l(this,t,t+1)},a.prototype.lower=function(e){var t=s(this._layers,e);l(this,t,t-1)},a.prototype.raiseToTop=function(e){var t=s(this._layers,e);t!==this._layers.length-1&&(this._layers.splice(t,1),this._layers.push(e),this._update(),this.layerMoved.raiseEvent(e,this._layers.length-1,t))},a.prototype.lowerToBottom=function(e){var t=s(this._layers,e);0!==t&&(this._layers.splice(t,1),this._layers.splice(0,0,e),this._update(),this.layerMoved.raiseEvent(e,0,t))};var w=new b;return a.prototype.pickImageryLayerFeatures=function(e,t){var r=t.globe.pick(e,t);if(v(r)){for(var i,s=t.globe.ellipsoid.cartesianToCartographic(r),n=t.globe._surface._tilesToRender,o=0;!v(i)&&o<n.length;++o){var a=n[o];b.contains(a.rectangle,s)&&(i=a)}if(v(i)){for(var l=i.data.imagery,u=[],c=[],d=l.length-1;0<=d;--d){var h=l[d],p=h.readyImagery;if(v(p)){var f=p.imageryLayer.imageryProvider;if(v(f.pickFeatures)&&b.contains(p.rectangle,s)){var m=w,g=1/1024;if(m.west=y.lerp(i.rectangle.west,i.rectangle.east,h.textureCoordinateRectangle.x-g),m.east=y.lerp(i.rectangle.west,i.rectangle.east,h.textureCoordinateRectangle.z+g),m.south=y.lerp(i.rectangle.south,i.rectangle.north,h.textureCoordinateRectangle.y-g),m.north=y.lerp(i.rectangle.south,i.rectangle.north,h.textureCoordinateRectangle.w+g),b.contains(m,s)){var _=f.pickFeatures(p.x,p.y,p.level,s.longitude,s.latitude);v(_)&&(u.push(_),c.push(p.imageryLayer))}}}}if(0!==u.length)return C.all(u,function(e){for(var t=[],r=0;r<e.length;++r){var i=e[r],n=c[r];if(v(i)&&0<i.length)for(var o=0;o<i.length;++o){var a=i[o];a.imageryLayer=n,v(a.position)||(a.position=s),t.push(a)}}return t})}}},a.prototype.queueReprojectionCommands=function(e){for(var t=this._layers,r=0,i=t.length;r<i;++r)t[r].queueReprojectionCommands(e)},a.prototype.cancelReprojections=function(){for(var e=this._layers,t=0,r=e.length;t<r;++t)e[t].cancelReprojections()},a.prototype.isDestroyed=function(){return!1},a.prototype.destroy=function(){return this.removeAll(!0),t(this)},a.prototype._update=function(){var e,t,r,i,n=!0,o=this._layers;for(r=0,i=o.length;r<i;++r)(t=o[r])._layerIndex=r,t.show?(t._isBaseLayer=n,n=!1):t._isBaseLayer=!1,t.show!==t._show&&(v(t._show)&&(v(e)||(e=[]),e.push(t)),t._show=t.show);if(v(e))for(r=0,i=e.length;r<i;++r)t=e[r],this.layerShownOrHidden.raiseEvent(t,t._layerIndex,t.show)},a}),define("Scene/QuadtreeOccluders",["../Core/Cartesian3","../Core/defineProperties","../Core/EllipsoidalOccluder"],function(t,e,r){"use strict";function i(e){this._ellipsoid=new r(e.ellipsoid,t.ZERO)}return e(i.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),i}),define("Scene/QuadtreeTile",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Rectangle","./QuadtreeTileLoadState"],function(u,e,s,c,t){"use strict";function l(e){if(!u(e))throw new s("options is required.");if(!u(e.x))throw new s("options.x is required.");if(!u(e.y))throw new s("options.y is required.");if(e.x<0||e.y<0)throw new s("options.x and options.y must be greater than or equal to zero.");if(!u(e.level))throw new s("options.level is required and must be greater than or equal to zero.");if(!u(e.tilingScheme))throw new s("options.tilingScheme is required.");this._tilingScheme=e.tilingScheme,this._x=e.x,this._y=e.y,this._level=e.level,this._parent=e.parent,this._rectangle=this._tilingScheme.tileXYToRectangle(this._x,this._y,this._level),this._southwestChild=void 0,this._southeastChild=void 0,this._northwestChild=void 0,this._northeastChild=void 0,this._replacementPrevious=void 0,this._replacementNext=void 0,this._distance=0,this._priorityFunction=void 0,this._customData=[],this._frameUpdated=void 0,this._frameRendered=void 0,this._loadedCallbacks={},this.state=t.START,this.renderable=!1,this.upsampledFromParent=!1,this.data=void 0}function r(e){u(e)&&e.freeResources()}return l.createLevelZeroTiles=function(e){if(!u(e))throw new s("tilingScheme is required.");for(var t=e.getNumberOfXTilesAtLevel(0),r=e.getNumberOfYTilesAtLevel(0),i=new Array(t*r),n=0,o=0;o<r;++o)for(var a=0;a<t;++a)i[n++]=new l({tilingScheme:e,x:a,y:o,level:0});return i},l.prototype._updateCustomData=function(e,t,r){var i,n,o,a=this.customData;if(u(t)&&u(r)){for(a=a.filter(function(e){return-1===r.indexOf(e)}),this._customData=a,o=this._rectangle,i=0;i<t.length;++i)n=t[i],c.contains(o,n.positionCartographic)&&a.push(n);this._frameUpdated=e}else{var s=this._parent;if(u(s)&&this._frameUpdated!==s._frameUpdated){a.length=0,o=this._rectangle;var l=s.customData;for(i=0;i<l.length;++i)n=l[i],c.contains(o,n.positionCartographic)&&a.push(n);this._frameUpdated=s._frameUpdated}}},e(l.prototype,{tilingScheme:{get:function(){return this._tilingScheme}},x:{get:function(){return this._x}},y:{get:function(){return this._y}},level:{get:function(){return this._level}},parent:{get:function(){return this._parent}},rectangle:{get:function(){return this._rectangle}},children:{get:function(){return[this.northwestChild,this.northeastChild,this.southwestChild,this.southeastChild]}},southwestChild:{get:function(){return u(this._southwestChild)||(this._southwestChild=new l({tilingScheme:this.tilingScheme,x:2*this.x,y:2*this.y+1,level:this.level+1,parent:this})),this._southwestChild}},southeastChild:{get:function(){return u(this._southeastChild)||(this._southeastChild=new l({tilingScheme:this.tilingScheme,x:2*this.x+1,y:2*this.y+1,level:this.level+1,parent:this})),this._southeastChild}},northwestChild:{get:function(){return u(this._northwestChild)||(this._northwestChild=new l({tilingScheme:this.tilingScheme,x:2*this.x,y:2*this.y,level:this.level+1,parent:this})),this._northwestChild}},northeastChild:{get:function(){return u(this._northeastChild)||(this._northeastChild=new l({tilingScheme:this.tilingScheme,x:2*this.x+1,y:2*this.y,level:this.level+1,parent:this})),this._northeastChild}},customData:{get:function(){return this._customData}},needsLoading:{get:function(){return this.state<t.DONE}},eligibleForUnloading:{get:function(){var e=!0;return u(this.data)&&(e=this.data.eligibleForUnloading,u(e)||(e=!0)),e}}}),l.prototype.freeResources=function(){this.state=t.START,this.renderable=!1,this.upsampledFromParent=!1,u(this.data)&&u(this.data.freeResources)&&this.data.freeResources(),r(this._southwestChild),this._southwestChild=void 0,r(this._southeastChild),this._southeastChild=void 0,r(this._northwestChild),this._northwestChild=void 0,r(this._northeastChild),this._northeastChild=void 0},l}),define("Scene/TileReplacementQueue",["../Core/defined"],function(n){"use strict";function e(){this.head=void 0,this.tail=void 0,this.count=0,this._lastBeforeStartOfFrame=void 0}function o(e,t){var r=t.replacementPrevious,i=t.replacementNext;t===e._lastBeforeStartOfFrame&&(e._lastBeforeStartOfFrame=i),t===e.head?e.head=i:r.replacementNext=i,t===e.tail?e.tail=r:i.replacementPrevious=r,t.replacementPrevious=void 0,t.replacementNext=void 0,--e.count}return e.prototype.markStartOfRenderFrame=function(){this._lastBeforeStartOfFrame=this.head},e.prototype.trimTiles=function(e){for(var t=this.tail,r=!0;r&&n(this._lastBeforeStartOfFrame)&&this.count>e&&n(t);){r=t!==this._lastBeforeStartOfFrame;var i=t.replacementPrevious;t.eligibleForUnloading&&(t.freeResources(),o(this,t)),t=i}},e.prototype.markTileRendered=function(e){var t=this.head;if(t!==e){if(++this.count,!n(t))return e.replacementPrevious=void 0,e.replacementNext=void 0,this.head=e,void(this.tail=e);(n(e.replacementPrevious)||n(e.replacementNext))&&o(this,e),e.replacementPrevious=void 0,(e.replacementNext=t).replacementPrevious=e,this.head=e}else e===this._lastBeforeStartOfFrame&&(this._lastBeforeStartOfFrame=e.replacementNext)},e}),define("Scene/QuadtreePrimitive",["../Core/Cartesian3","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/getTimestamp","../Core/Math","../Core/OrthographicFrustum","../Core/Ray","../Core/Rectangle","../Core/Visibility","./QuadtreeOccluders","./QuadtreeTile","./QuadtreeTileLoadState","./SceneMode","./TileReplacementQueue"],function(x,P,D,O,e,r,n,I,y,b,t,M,p,i,f,o,R,a){"use strict";function s(e){if(!O(e)||!O(e.tileProvider))throw new r("options.tileProvider is required.");if(O(e.tileProvider.quadtree))throw new r("A QuadtreeTileProvider can only be used with a single QuadtreePrimitive");this._tileProvider=e.tileProvider,(this._tileProvider.quadtree=this)._debug={enableDebugOutput:!1,maxDepth:0,tilesVisited:0,tilesCulled:0,tilesRendered:0,tilesWaitingForChildren:0,lastMaxDepth:-1,lastTilesVisited:-1,lastTilesCulled:-1,lastTilesRendered:-1,lastTilesWaitingForChildren:-1,suspendLodUpdate:!1};var t=this._tileProvider.tilingScheme.ellipsoid;this._tilesToRender=[],this._tileLoadQueueHigh=[],this._tileLoadQueueMedium=[],this._tileLoadQueueLow=[],this._tileReplacementQueue=new a,this._levelZeroTiles=void 0,this._loadQueueTimeSlice=5,this._addHeightCallbacks=[],this._removeHeightCallbacks=[],this._tileToUpdateHeights=[],this._lastTileIndex=0,this._updateHeightsTimeSlice=2,this.maximumScreenSpaceError=D(e.maximumScreenSpaceError,2),this.tileCacheSize=D(e.tileCacheSize,100),this._occluders=new i({ellipsoid:t}),this._tileLoadProgressEvent=new n,this._lastTileLoadQueueLength=0}function l(e){var t=e._debug;t.maxDepth=0,t.tilesVisited=0,t.tilesCulled=0,t.tilesRendered=0,t.tilesWaitingForChildren=0,e._tileLoadQueueHigh.length=0,e._tileLoadQueueMedium.length=0,e._tileLoadQueueLow.length=0}var m;e(s.prototype,{tileProvider:{get:function(){return this._tileProvider}},tileLoadProgressEvent:{get:function(){return this._tileLoadProgressEvent}}}),s.prototype.invalidateAllTiles=function(){var e=this._tileReplacementQueue;e.head=void 0,e.tail=void 0,e.count=0,l(this);var t=this._levelZeroTiles;if(O(t))for(var r=0;r<t.length;++r){for(var i=t[r].customData,n=i.length,o=0;o<n;++o){var a=i[o];a.level=0,this._addHeightCallbacks.push(a)}t[r].freeResources()}this._levelZeroTiles=void 0,this._tileProvider.cancelReprojections()},s.prototype.forEachLoadedTile=function(e){for(var t=this._tileReplacementQueue.head;O(t);)t.state!==o.START&&e(t),t=t.replacementNext},s.prototype.forEachRenderedTile=function(e){for(var t=this._tilesToRender,r=0,i=t.length;r<i;++r)e(t[r])},s.prototype.updateHeight=function(e,t){var i=this,n={positionOnEllipsoidSurface:void 0,positionCartographic:e,level:-1,callback:t,removeFunc:function(){for(var e=i._addHeightCallbacks,t=e.length,r=0;r<t;++r)if(e[r]===n){e.splice(r,1);break}i._removeHeightCallbacks.push(n)}};return i._addHeightCallbacks.push(n),n.removeFunc},s.prototype.update=function(e){O(this._tileProvider.update)&&this._tileProvider.update(e)},s.prototype.beginFrame=function(e){e.passes.render&&(this._tileProvider.initialize(e),this._debug.suspendLodUpdate||(l(this),this._tileReplacementQueue.markStartOfRenderFrame()))},s.prototype.render=function(e){var t=e.passes,r=this._tileProvider;t.render&&(r.beginUpdate(e),function(e,t){var r=e._debug;if(r.suspendLodUpdate)return;e._tilesToRender.length=0;var i,n=e._tileProvider;if(!O(e._levelZeroTiles)){if(!n.ready)return;var o=n.tilingScheme;e._levelZeroTiles=f.createLevelZeroTiles(o)}e._occluders.ellipsoid.cameraPosition=t.camera.positionWC;var a=e._levelZeroTiles,s=1<a.length?e._occluders:void 0;m=t.camera.positionCartographic,a.sort(g);var l,u,c=e._addHeightCallbacks,d=e._removeHeightCallbacks,h=t.frameNumber;if(0<c.length||0<d.length){for(l=0,u=a.length;l<u;++l)(i=a[l])._updateCustomData(h,c,d);c.length=0,d.length=0}for(l=0,u=a.length;l<u;++l)i=a[l],e._tileReplacementQueue.markTileRendered(i),i.renderable?n.computeTileVisibility(i,t,s)!==p.NONE?_(e,t,i):(i.needsLoading&&e._tileLoadQueueLow.push(i),++r.tilesCulled):(i.needsLoading&&e._tileLoadQueueHigh.push(i),++r.tilesWaitingForChildren)}(this,e),function(e,t){for(var r=e._tileProvider,i=e._tilesToRender,n=e._tileToUpdateHeights,o=0,a=i.length;o<a;++o){var s=i[o];r.showTileThisFrame(s,t),s._frameRendered!==t.frameNumber-1&&n.push(s),s._frameRendered=t.frameNumber}}(this,e),r.endUpdate(e)),t.pick&&0<this._tilesToRender.length&&r.updateForPick(e)},s.prototype.endFrame=function(e){e.passes.render&&e.mode!==R.MORPHING&&(function(e,t){var r=e._tileLoadQueueHigh,i=e._tileLoadQueueMedium,n=e._tileLoadQueueLow;if(0===r.length&&0===i.length&&0===n.length)return;e._tileReplacementQueue.trimTiles(e.tileCacheSize);var o=I()+e._loadQueueTimeSlice,a=e._tileProvider;d(e,t,a,o,r),d(e,t,a,o,i),d(e,t,a,o,n)}(this,e),function(e,t){var r=e._tileToUpdateHeights,i=e._tileProvider.terrainProvider,n=I(),o=e._updateHeightsTimeSlice,a=n+o,s=t.mode,l=t.mapProjection,u=l.ellipsoid;for(;0<r.length;){var c,d=r[0],h=d.customData,p=h.length,f=!1;for(c=e._lastTileIndex;c<p;++c){var m=h[c];if(d.level>m.level){if(O(m.positionOnEllipsoidSurface)||(m.positionOnEllipsoidSurface=x.fromRadians(m.positionCartographic.longitude,m.positionCartographic.latitude,0,u)),s===R.SCENE3D){var g=u.geodeticSurfaceNormal(m.positionOnEllipsoidSurface,L.direction),_=u.getSurfaceNormalIntersectionWithZAxis(m.positionOnEllipsoidSurface,11500,L.origin);if(!O(_)){var v=Math.min(D(d.data.minimumHeight,0),-11500),y=x.multiplyByScalar(g,Math.abs(v)+1,k);x.subtract(m.positionOnEllipsoidSurface,y,L.origin)}}else P.clone(m.positionCartographic,N),N.height=-11500,l.project(N,k),x.fromElements(k.z,k.x,k.y,k),x.clone(k,L.origin),x.clone(x.UNIT_X,L.direction);var b=d.data.pick(L,s,l,!1,k);O(b)&&m.callback(b),m.level=d.level}else if(d.level===m.level){for(var C,w=d.children,S=w.length,T=0;T<S&&(C=w[T],!M.contains(C.rectangle,m.positionCartographic));++T);var E=i.getTileDataAvailable(C.x,C.y,C.level),A=d.parent;(O(E)&&!E||O(A)&&O(A.data)&&O(A.data.terrainData)&&!A.data.terrainData.isChildAvailable(A.x,A.y,C.x,C.y))&&m.removeFunc()}if(I()>=a){f=!0;break}}if(f){e._lastTileIndex=c;break}e._lastTileIndex=0,r.shift()}}(this,e),function(e,t){var r=e._tileLoadQueueHigh.length+e._tileLoadQueueMedium.length+e._tileLoadQueueLow.length;r!==e._lastTileLoadQueueLength&&(t.afterRender.push(n.prototype.raiseEvent.bind(e._tileLoadProgressEvent,r)),e._lastTileLoadQueueLength=r);var i=e._debug;i.enableDebugOutput&&!i.suspendLodUpdate&&(i.tilesVisited===i.lastTilesVisited&&i.tilesRendered===i.lastTilesRendered&&i.tilesCulled===i.lastTilesCulled&&i.maxDepth===i.lastMaxDepth&&i.tilesWaitingForChildren===i.lastTilesWaitingForChildren||(console.log("Visited "+i.tilesVisited+", Rendered: "+i.tilesRendered+", Culled: "+i.tilesCulled+", Max Depth: "+i.maxDepth+", Waiting for children: "+i.tilesWaitingForChildren),i.lastTilesVisited=i.tilesVisited,i.lastTilesRendered=i.tilesRendered,i.lastTilesCulled=i.tilesCulled,i.lastMaxDepth=i.maxDepth,i.lastTilesWaitingForChildren=i.tilesWaitingForChildren))}(this,e))},s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){this._tileProvider=this._tileProvider&&this._tileProvider.destroy()};var u=new P;function g(e,t){var r=M.center(e.rectangle,u),i=r.longitude-m.longitude,n=r.latitude-m.latitude,o=(r=M.center(t.rectangle,u)).longitude-m.longitude,a=r.latitude-m.latitude;return i*i+n*n-(o*o+a*a)}function _(e,t,r){var i=e._debug;if(++i.tilesVisited,e._tileReplacementQueue.markTileRendered(r),r._updateCustomData(t.frameNumber),r.level>i.maxDepth&&(i.maxDepth=r.level),function(e,t,r){if(t.mode===R.SCENE2D||t.camera.frustum instanceof b)return function(e,t,r){var i=t.camera.frustum;O(i._offCenterFrustum)&&(i=i._offCenterFrustum);var n=t.context,o=n.drawingBufferWidth,a=n.drawingBufferHeight,s=e._tileProvider.getLevelMaximumGeometricError(r.level),l=Math.max(i.top-i.bottom,i.right-i.left)/Math.max(o,a),u=s/l;t.fog.enabled&&t.mode!==R.SCENE2D&&(u-=y.fog(r._distance,t.fog.density)*t.fog.sse);return u}(e,t,r);var i=e._tileProvider.getLevelMaximumGeometricError(r.level),n=r._distance,o=t.context.drawingBufferHeight,a=t.camera.frustum.sseDenominator,s=i*o/(n*a);t.fog.enabled&&(s-=y.fog(n,t.fog.density)*t.fog.sse);return s}(e,t,r)<e.maximumScreenSpaceError)return r.needsLoading&&e._tileLoadQueueMedium.push(r),void S(e,r);var n,o,a,s,l,u,c,d,h,p=r.southwestChild,f=r.southeastChild,m=r.northwestChild,g=r.northeastChild,_=p.renderable&&f.renderable&&m.renderable&&g.renderable,v=p.upsampledFromParent&&f.upsampledFromParent&&m.upsampledFromParent&&g.upsampledFromParent;_?v?(S(e,r),C(e,t.camera.positionCartographic,p,f,m,g),r.needsLoading&&e._tileLoadQueueMedium.push(r)):(n=e,o=p,a=f,s=m,l=g,c=(u=t).camera.positionCartographic,d=n._tileProvider,h=n._occluders,c.longitude<o.rectangle.east?c.latitude<o.rectangle.north?(w(n,o,d,u,h),w(n,a,d,u,h),w(n,s,d,u,h),w(n,l,d,u,h)):(w(n,s,d,u,h),w(n,o,d,u,h),w(n,l,d,u,h),w(n,a,d,u,h)):c.latitude<o.rectangle.north?(w(n,a,d,u,h),w(n,o,d,u,h),w(n,l,d,u,h),w(n,s,d,u,h)):(w(n,l,d,u,h),w(n,s,d,u,h),w(n,a,d,u,h),w(n,o,d,u,h)),r.needsLoading&&e._tileLoadQueueLow.push(r)):(C(e,t.camera.positionCartographic,p,f,m,g),S(e,r),r.needsLoading&&e._tileLoadQueueLow.push(r))}function C(e,t,r,i,n,o){t.longitude<r.east?t.latitude<r.north?(c(e,r),c(e,i),c(e,n),c(e,o)):(c(e,n),c(e,r),c(e,o),c(e,i)):t.latitude<r.north?(c(e,i),c(e,r),c(e,o),c(e,n)):(c(e,o),c(e,n),c(e,i),c(e,r))}function c(e,t){e._tileReplacementQueue.markTileRendered(t),t.needsLoading&&(t.renderable?e._tileLoadQueueLow.push(t):e._tileLoadQueueHigh.push(t))}function w(e,t,r,i,n){r.computeTileVisibility(t,i,n)!==p.NONE?_(e,i,t):(++e._debug.tilesCulled,e._tileReplacementQueue.markTileRendered(t),t.needsLoading&&e._tileLoadQueueLow.push(t))}function S(e,t){e._tilesToRender.push(t),++e._debug.tilesRendered}function d(e,t,r,i,n){for(var o=0,a=n.length;o<a&&I()<i;++o){var s=n[o];e._tileReplacementQueue.markTileRendered(s),r.loadTile(t,s)}}var L=new t,N=new P,k=new x;return s}),define("Scene/Globe",["../Core/BoundingSphere","../Core/buildModuleUrl","../Core/Cartesian3","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Ellipsoid","../Core/EllipsoidTerrainProvider","../Core/Event","../Core/IntersectionTests","../Core/Ray","../Core/Rectangle","../Core/Resource","../Renderer/ShaderSource","../Renderer/Texture","../Shaders/GlobeFS","../Shaders/GlobeVS","../Shaders/GroundAtmosphere","../ThirdParty/when","./GlobeSurfaceShaderSet","./GlobeSurfaceTileProvider","./ImageryLayerCollection","./Material","./QuadtreePrimitive","./SceneMode","./ShadowMode"],function(m,i,g,e,p,_,t,r,v,n,o,a,y,s,f,l,u,c,d,h,b,C,w,S,T,E,A,x,P){"use strict";function D(e){e=p(e,n.WGS84);var t=new o({ellipsoid:e}),r=new T;this._ellipsoid=e,this._imageryLayerCollection=r,this._surfaceShaderSet=new w,this._material=void 0,this._surface=new A({tileProvider:new S({terrainProvider:t,imageryLayers:r,surfaceShaderSet:this._surfaceShaderSet})}),this._terrainProvider=t,this._terrainProviderChanged=new a,O(this),this.show=!0,this._oceanNormalMapResourceDirty=!0,this._oceanNormalMapResource=new l({url:i("Assets/Textures/waterNormalsSmall.jpg")}),this.maximumScreenSpaceError=2,this.tileCacheSize=100,this.enableLighting=!1,this.lightingFadeOutDistance=65e5,this.lightingFadeInDistance=9e6,this.showWaterEffect=!0,this.depthTestAgainstTerrain=!1,this.shadows=P.RECEIVE_ONLY,this._oceanNormalMap=void 0,this._zoomedOutOceanSpecularIntensity=.5}function O(e){var t=[],r=_(e._material)&&(e._material.shaderSource.match(/slope/)||e._material.shaderSource.match("normalEC")),i=[];!_(e._material)||r&&!e._terrainProvider.requestVertexNormals?e._surface._tileProvider.uniformMap=void 0:(i.push(e._material.shaderSource),t.push("APPLY_MATERIAL"),e._surface._tileProvider.uniformMap=e._material._uniforms),i.push(d),e._surfaceShaderSet.baseVertexShaderSource=new u({sources:[b,h],defines:t}),e._surfaceShaderSet.baseFragmentShaderSource=new u({sources:i,defines:t}),e._surfaceShaderSet.material=e._material}t(D.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},imageryLayers:{get:function(){return this._imageryLayerCollection}},imageryLayersUpdatedEvent:{get:function(){return this._surface.tileProvider.imageryLayersUpdatedEvent}},tileLoadedEvent:{get:function(){return this._surface.tileProvider.tileLoadedEvent}},baseColor:{get:function(){return this._surface.tileProvider.baseColor},set:function(e){this._surface.tileProvider.baseColor=e}},clippingPlanes:{get:function(){return this._surface.tileProvider.clippingPlanes},set:function(e){this._surface.tileProvider.clippingPlanes=e}},oceanNormalMapUrl:{get:function(){return this._oceanNormalMapResource.url},set:function(e){this._oceanNormalMapResource.url=e,this._oceanNormalMapResourceDirty=!0}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){e!==this._terrainProvider&&(this._terrainProvider=e,this._terrainProviderChanged.raiseEvent(e),_(this._material)&&O(this))}},terrainProviderChanged:{get:function(){return this._terrainProviderChanged}},tileLoadProgressEvent:{get:function(){return this._surface.tileLoadProgressEvent}},material:{get:function(){return this._material},set:function(e){this._material!==e&&(this._material=e,O(this))}}});var I=[],M={start:0,stop:0};D.prototype.pick=function(e,t,r){if(!_(e))throw new v("ray is required");if(!_(t))throw new v("scene is required");var i=t.mode,n=t.mapProjection,o=I;o.length=0;var a,s,l,u,c=this._surface._tilesToRender,d=c.length;for(s=0;s<d;++s){var h=(a=c[s]).data;if(_(h)){var p=h.pickBoundingSphere;i!==x.SCENE3D?(m.fromRectangleWithHeights2D(a.rectangle,n,h.minimumHeight,h.maximumHeight,p),g.fromElements(p.center.z,p.center.x,p.center.y,p.center)):m.clone(h.boundingSphere3D,p);var f=y.raySphere(e,p,M);_(f)&&o.push(h)}}for(o.sort((l=e.origin,function(e,t){return m.distanceSquaredTo(e.pickBoundingSphere,l)-m.distanceSquaredTo(t.pickBoundingSphere,l)})),d=o.length,s=0;s<d&&(u=o[s].pick(e,t.mode,t.mapProjection,!0,r),!_(u));++s);return u};var R=new g,L=new g,N=new e,k=new s;function F(e,t){return f.contains(e.rectangle,t)?e:void 0}return D.prototype.getHeight=function(e){if(!_(e))throw new v("cartographic is required");var t=this._surface._levelZeroTiles;if(_(t)){var r,i,n=t.length;for(i=0;i<n&&(r=t[i],!f.contains(r.rectangle,e));++i);if(_(r)&&f.contains(r.rectangle,e)){for(;r.renderable;)r=F(r.southwestChild,e)||F(r.southeastChild,e)||F(r.northwestChild,e)||r.northeastChild;for(;_(r)&&(!_(r.data)||!_(r.data.pickTerrain));)r=r.parent;if(_(r)){var o=this._surface._tileProvider.tilingScheme.ellipsoid,a=g.fromRadians(e.longitude,e.latitude,0,o,R),s=k,l=o.geodeticSurfaceNormal(a,s.direction),u=o.getSurfaceNormalIntersectionWithZAxis(a,11500,s.origin);if(!_(u)){var c=Math.min(p(r.data.minimumHeight,0),-11500),d=g.multiplyByScalar(l,Math.abs(c)+1,L);g.subtract(a,d,s.origin)}var h=r.data.pick(s,void 0,void 0,!1,L);if(_(h))return o.cartesianToCartographic(h,N).height}}}},D.prototype.update=function(e){this.show&&e.passes.render&&this._surface.update(e)},D.prototype.beginFrame=function(t){var e=this._surface,r=e.tileProvider,i=this.terrainProvider,n=this.showWaterEffect&&i.ready&&i.hasWaterMask;if(n&&this._oceanNormalMapResourceDirty){this._oceanNormalMapResourceDirty=!1;var o=this._oceanNormalMapResource,a=o.url;if(_(a)){var s=this;C(o.fetchImage(),function(e){a===s._oceanNormalMapResource.url&&(s._oceanNormalMap=s._oceanNormalMap&&s._oceanNormalMap.destroy(),s._oceanNormalMap=new c({context:t.context,source:e}))})}else this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy()}var l=t.passes,u=t.mode;l.render&&(u===x.SCENE3D?this._zoomedOutOceanSpecularIntensity=.5:this._zoomedOutOceanSpecularIntensity=0,e.maximumScreenSpaceError=this.maximumScreenSpaceError,e.tileCacheSize=this.tileCacheSize,r.terrainProvider=this.terrainProvider,r.lightingFadeOutDistance=this.lightingFadeOutDistance,r.lightingFadeInDistance=this.lightingFadeInDistance,r.zoomedOutOceanSpecularIntensity=this._zoomedOutOceanSpecularIntensity,r.hasWaterMask=n,r.oceanNormalMap=this._oceanNormalMap,r.enableLighting=this.enableLighting,r.shadows=this.shadows,e.beginFrame(t))},D.prototype.render=function(e){if(this.show){_(this._material)&&this._material.update(e.context);var t=this._surface,r=e.passes;r.render&&t.render(e),r.pick&&t.render(e)}},D.prototype.endFrame=function(e){this.show&&e.passes.render&&this._surface.endFrame(e)},D.prototype.isDestroyed=function(){return!1},D.prototype.destroy=function(){return this._surfaceShaderSet=this._surfaceShaderSet&&this._surfaceShaderSet.destroy(),this._surface=this._surface&&this._surface.destroy(),this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy(),r(this)},D}),define("Shaders/PostProcessFilters/PassThrough",[],function(){"use strict";return"uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\ngl_FragColor = texture2D(u_texture, v_textureCoordinates);\n}\n"}),define("Scene/GlobeDepth",["../Core/BoundingRectangle","../Core/Color","../Core/defined","../Core/destroyObject","../Core/PixelFormat","../Renderer/ClearCommand","../Renderer/Framebuffer","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/Texture","../Shaders/PostProcessFilters/PassThrough"],function(s,l,h,t,p,u,f,m,c,g,d){"use strict";function e(){this._colorTexture=void 0,this._depthStencilTexture=void 0,this._globeDepthTexture=void 0,this.framebuffer=void 0,this._copyDepthFramebuffer=void 0,this._clearColorCommand=void 0,this._copyColorCommand=void 0,this._copyDepthCommand=void 0,this._viewport=new s,this._rs=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0,this._debugGlobeDepthViewportCommand=void 0}function _(e){e._colorTexture=e._colorTexture&&!e._colorTexture.isDestroyed()&&e._colorTexture.destroy(),e._depthStencilTexture=e._depthStencilTexture&&!e._depthStencilTexture.isDestroyed()&&e._depthStencilTexture.destroy(),e._globeDepthTexture=e._globeDepthTexture&&!e._globeDepthTexture.isDestroyed()&&e._globeDepthTexture.destroy()}function v(e){e.framebuffer=e.framebuffer&&!e.framebuffer.isDestroyed()&&e.framebuffer.destroy(),e._copyDepthFramebuffer=e._copyDepthFramebuffer&&!e._copyDepthFramebuffer.isDestroyed()&&e._copyDepthFramebuffer.destroy()}function n(e,t,r,i){var n,o,a,s,l,u,c=e._colorTexture,d=!h(c)||c.width!==r||c.height!==i;h(e.framebuffer)&&!d||(_(e),v(e),s=t,l=r,u=i,(a=e)._colorTexture=new g({context:s,width:l,height:u,pixelFormat:p.RGBA,pixelDatatype:m.UNSIGNED_BYTE}),a._depthStencilTexture=new g({context:s,width:l,height:u,pixelFormat:p.DEPTH_STENCIL,pixelDatatype:m.UNSIGNED_INT_24_8}),a._globeDepthTexture=new g({context:s,width:l,height:u,pixelFormat:p.RGBA,pixelDatatype:m.UNSIGNED_BYTE}),o=t,(n=e).framebuffer=new f({context:o,colorTextures:[n._colorTexture],depthStencilTexture:n._depthStencilTexture,destroyAttachments:!1}),n._copyDepthFramebuffer=new f({context:o,colorTextures:[n._globeDepthTexture],destroyAttachments:!1}))}return e.prototype.executeDebugGlobeDepth=function(e,t){!function(e,t,r){h(e._debugGlobeDepthViewportCommand)||(e._debugGlobeDepthViewportCommand=t.createViewportQuadCommand("uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    float z_window = czm_unpackDepth(texture2D(u_texture, v_textureCoordinates));\n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\n    gl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n}\n",{uniformMap:{u_texture:function(){return e._globeDepthTexture}},owner:e}));e._debugGlobeDepthViewportCommand.execute(t,r)}(this,e,t)},e.prototype.update=function(e,t){var r=e.drawingBufferWidth,i=e.drawingBufferHeight;n(this,e,r,i),function(e,t,r,i,n){e._viewport.width=r,e._viewport.height=i;var o=!s.equals(e._viewport,n.viewport),a=o!==e._useScissorTest;e._useScissorTest=o,s.equals(e._scissorRectangle,n.viewport)||(e._scissorRectangle=s.clone(n.viewport,e._scissorRectangle),a=!0),h(e._rs)&&s.equals(e._viewport,e._rs.viewport)&&!a||(e._rs=c.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle}})),h(e._copyDepthCommand)||(e._copyDepthCommand=t.createViewportQuadCommand("uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    gl_FragColor = czm_packDepth(texture2D(u_texture, v_textureCoordinates).r);\n}\n",{uniformMap:{u_texture:function(){return e._depthStencilTexture}},owner:e}));e._copyDepthCommand.framebuffer=e._copyDepthFramebuffer,h(e._copyColorCommand)||(e._copyColorCommand=t.createViewportQuadCommand(d,{uniformMap:{u_texture:function(){return e._colorTexture}},owner:e})),e._copyDepthCommand.renderState=e._rs,e._copyColorCommand.renderState=e._rs,h(e._clearColorCommand)||(e._clearColorCommand=new u({color:new l(0,0,0,0),stencil:0,owner:e})),e._clearColorCommand.framebuffer=e.framebuffer}(this,e,r,i,t),e.uniformState.globeDepthTexture=void 0},e.prototype.executeCopyDepth=function(e,t){h(this._copyDepthCommand)&&(this._copyDepthCommand.execute(e,t),e.uniformState.globeDepthTexture=this._globeDepthTexture)},e.prototype.executeCopyColor=function(e,t){h(this._copyColorCommand)&&this._copyColorCommand.execute(e,t)},e.prototype.clear=function(e,t,r){var i=this._clearColorCommand;h(i)&&(l.clone(r,i.color),i.execute(e,t))},e.prototype.isDestroyed=function(){return!1},e.prototype.destroy=function(){_(this),v(this),h(this._copyColorCommand)&&(this._copyColorCommand.shaderProgram=this._copyColorCommand.shaderProgram.destroy()),h(this._copyDepthCommand)&&(this._copyDepthCommand.shaderProgram=this._copyDepthCommand.shaderProgram.destroy());var e=this._debugGlobeDepthViewportCommand;return h(e)&&(e.shaderProgram=e.shaderProgram.destroy()),t(this)},e}),define("Scene/GoogleEarthEnterpriseImageryProvider",["../Core/Credit","../Core/decodeGoogleEarthEnterpriseData","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/DeveloperError","../Core/Event","../Core/GeographicTilingScheme","../Core/GoogleEarthEnterpriseMetadata","../Core/loadImageFromTypedArray","../Core/Math","../Core/Rectangle","../Core/Request","../Core/Resource","../Core/RuntimeError","../Core/TileProviderError","../ThirdParty/protobuf-minimal","../ThirdParty/when"],function(a,v,s,y,e,l,b,u,c,C,w,d,h,S,p,T,f,E,m){"use strict";function g(){this._image=new Image}function t(e){if(e=s(e,s.EMPTY_OBJECT),!y(e.url)&&!y(e.metadata))throw new b("options.url or options.metadata is required.");var r;if(y(e.proxy)&&l("GoogleEarthEnterpriseImageryProvider.proxy","The options.proxy parameter has been deprecated. Specify options.url as a Resource instance and set the proxy property there."),y(e.metadata))r=e.metadata;else{var t=p.createIfNeeded(e.url,{proxy:e.proxy});r=new C(t)}this._metadata=r,this._tileDiscardPolicy=e.tileDiscardPolicy,this._tilingScheme=new c({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new h(-d.PI,-d.PI,d.PI,d.PI),ellipsoid:e.ellipsoid});var i=e.credit;"string"==typeof i&&(i=new a({text:i})),this._credit=i,this._tileWidth=256,this._tileHeight=256,this._maximumLevel=23,y(this._tileDiscardPolicy)||(this._tileDiscardPolicy=new g),this._errorEvent=new u,this._ready=!1;var n,o=this;this._readyPromise=r.readyPromise.then(function(e){if(r.imageryPresent)return f.handleSuccess(n),o._ready=e;var t=new T("The server "+r.url+" doesn't have imagery");return n=f.handleError(n,o,o._errorEvent,t.message,void 0,void 0,void 0,t),m.reject(t)}).otherwise(function(e){return n=f.handleError(n,o,o._errorEvent,e.message,void 0,void 0,void 0,e),m.reject(e)})}return g.prototype.isReady=function(){return!0},g.prototype.shouldDiscardImage=function(e){return e===this._image},e(t.prototype,{url:{get:function(){return this._metadata.url}},proxy:{get:function(){return this._metadata.proxy}},tileWidth:{get:function(){if(!this._ready)throw new b("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth}},tileHeight:{get:function(){if(!this._ready)throw new b("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready)throw new b("maximumLevel must not be called before the imagery provider is ready.");return this._maximumLevel}},minimumLevel:{get:function(){if(!this._ready)throw new b("minimumLevel must not be called before the imagery provider is ready.");return 0}},tilingScheme:{get:function(){if(!this._ready)throw new b("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}},rectangle:{get:function(){if(!this._ready)throw new b("rectangle must not be called before the imagery provider is ready.");return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready)throw new b("tileDiscardPolicy must not be called before the imagery provider is ready.");return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!1}}}),t.prototype.getTileCredits=function(e,t,r){if(!this._ready)throw new b("getTileCredits must not be called before the imagery provider is ready.");var i=this._metadata,n=i.getTileInformation(e,t,r);if(y(n)){var o=i.providers[n.imageryProvider];if(y(o))return[o]}},t.prototype.requestImage=function(e,t,r,i){if(!this._ready)throw new b("requestImage must not be called before the imagery provider is ready.");var o=this._tileDiscardPolicy._image,a=this._metadata,n=C.tileXYToQuadKey(e,t,r),s=a.getTileInformation(e,t,r);if(!y(s)){if(a.isValid(n)){var l=new S({throttle:i.throttle,throttleByServer:i.throttleByServer,type:i.type,priorityFunction:i.priorityFunction});return void a.populateSubtree(e,t,r,l)}return o}if(!s.hasImagery())return o;var u,c,d,h,p,f,m,g,_=(u=this,c=s,d=e,h=t,p=r,f=i,m=C.tileXYToQuadKey(d,h,p),g=c.imageryVersion,g=y(g)&&0<g?g:1,u._metadata.resource.getDerivedResource({url:"flatfile?f1-0"+m+"-i."+g.toString(),request:f})).fetchArrayBuffer();return y(_)?_.then(function(e){v(a.key,e);var t,r=new Uint8Array(e),i=a.protoImagery;if(y(i)&&i||(t=function(e){var t="JFIF";if(e[6]===t.charCodeAt(0)&&e[7]===t.charCodeAt(1)&&e[8]===t.charCodeAt(2)&&e[9]===t.charCodeAt(3))return"image/jpeg";if(e[1]!=="PNG".charCodeAt(0)||e[2]!=="PNG".charCodeAt(1)||e[3]!=="PNG".charCodeAt(2))return;return"image/png"}(r)),!y(t)&&(!y(i)||i)){var n=function(e){var t=E.Reader.create(e),r=t.len,i={};for(;t.pos<r;){var n=t.uint32();switch(n>>>3){case 1:i.imageType=t.uint32();break;case 2:i.imageData=t.bytes();break;case 3:i.alphaType=t.uint32();break;case 4:i.imageAlpha=t.bytes();break;case 5:var o=i.copyrightIds;if(y(o)||(o=i.copyrightIds=[]),2==(7&n))for(var a=t.uint32()+t.pos;t.pos<a;)o.push(t.uint32());else o.push(t.uint32());break;default:t.skipType(7&n)}}var s=i.imageType;if(y(s))switch(s){case 0:i.imageType="image/jpeg";break;case 4:i.imageType="image/png";break;default:throw new T("GoogleEarthEnterpriseImageryProvider: Unsupported image type.")}var l=i.alphaType;y(l)&&0!==l&&(console.log("GoogleEarthEnterpriseImageryProvider: External alpha not supported."),delete i.alphaType,delete i.imageAlpha);return i}(r);t=n.imageType,r=n.imageData}return y(t)&&y(r)?w(r,t):o}):void 0},t.prototype.pickFeatures=function(e,t,r,i,n){},t}),define("Scene/GridImageryProvider",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","../Core/GeographicTilingScheme","../ThirdParty/when"],function(e,t,r,i,n,o,a){"use strict";var s=new e(1,1,1,.4),l=new e(0,1,0,.05),u=new e(0,.5,0,.2);function c(e){e=t(e,t.EMPTY_OBJECT),this._tilingScheme=r(e.tilingScheme)?e.tilingScheme:new o({ellipsoid:e.ellipsoid}),this._cells=t(e.cells,8),this._color=t(e.color,s),this._glowColor=t(e.glowColor,l),this._glowWidth=t(e.glowWidth,6),this._backgroundColor=t(e.backgroundColor,u),this._errorEvent=new n,this._tileWidth=t(e.tileWidth,256),this._tileHeight=t(e.tileHeight,256),this._canvasSize=t(e.canvasSize,256),this._canvas=this._createGridCanvas(),this._readyPromise=a.resolve(!0)}return i(c.prototype,{proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){}},minimumLevel:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return!0}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){}},hasAlphaChannel:{get:function(){return!0}}}),c.prototype._drawGrid=function(e){for(var t=this._canvasSize,r=0;r<=this._cells;++r){var i=1+r/this._cells*(t-1);e.moveTo(i,0),e.lineTo(i,t),e.moveTo(0,i),e.lineTo(t,i)}e.stroke()},c.prototype._createGridCanvas=function(){var e=document.createElement("canvas");e.width=this._canvasSize,e.height=this._canvasSize;var t=this._canvasSize,r=e.getContext("2d"),i=this._backgroundColor.toCssColorString();r.fillStyle=i,r.fillRect(0,0,t,t);var n=this._glowColor.toCssColorString();r.strokeStyle=n,r.lineWidth=this._glowWidth,r.strokeRect(0,0,t,t),this._drawGrid(r),r.lineWidth=.5*this._glowWidth,r.strokeRect(0,0,t,t),this._drawGrid(r);var o=this._color.toCssColorString();return r.strokeStyle=o,r.lineWidth=2,r.strokeRect(0,0,t,t),r.lineWidth=1,this._drawGrid(r),e},c.prototype.getTileCredits=function(e,t,r){},c.prototype.requestImage=function(e,t,r,i){return this._canvas},c.prototype.pickFeatures=function(e,t,r,i,n){},c}),define("Scene/InvertClassification",["../Core/Color","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/PixelFormat","../Renderer/ClearCommand","../Renderer/Framebuffer","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/Sampler","../Renderer/ShaderSource","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","../Shaders/PostProcessFilters/PassThrough","./BlendingState","./StencilFunction","./StencilOperation"],function(t,d,e,r,h,i,p,f,m,g,_,v,y,b,C,w,n,o,a){"use strict";function s(){this.previousFramebuffer=void 0,this._previousFramebuffer=void 0,this._texture=void 0,this._classifiedTexture=void 0,this._depthStencilTexture=void 0,this._fbo=void 0,this._fboClassified=void 0,this._rsUnclassified=void 0,this._rsClassified=void 0,this._unclassifiedCommand=void 0,this._classifiedCommand=void 0,this._translucentCommand=void 0,this._clearColorCommand=new i({color:new t(0,0,0,0),owner:this}),this._clearCommand=new i({color:new t(0,0,0,0),depth:1,stencil:0});var e=this;this._uniformMap={u_texture:function(){return e._texture},u_depth:function(){return e._depthStencilTexture},u_classified:function(){return e._classifiedTexture}}}e(s.prototype,{unclassifiedCommand:{get:function(){return this._unclassifiedCommand}}});var S={depthMask:!(s.isTranslucencySupported=function(e){return e.depthTexture&&e.fragmentDepth}),stencilTest:{enabled:!0,frontFunction:o.EQUAL,frontOperation:{fail:a.KEEP,zFail:a.KEEP,zPass:a.KEEP},backFunction:o.NEVER,reference:0,mask:15},blending:n.ALPHA_BLEND},T={depthMask:!1,stencilTest:{enabled:!0,frontFunction:o.NOT_EQUAL,frontOperation:{fail:a.KEEP,zFail:a.KEEP,zPass:a.KEEP},backFunction:o.NEVER,reference:0,mask:15},blending:n.ALPHA_BLEND},E={depthMask:!0,depthTest:{enabled:!0},blending:n.ALPHA_BLEND};return s.prototype.update=function(e){var t=this._texture,r=!d(t)||this.previousFramebuffer!==this._previousFramebuffer;this._previousFramebuffer=this.previousFramebuffer;var i,n,o=e.drawingBufferWidth,a=e.drawingBufferHeight,s=!d(t)||t.width!==o||t.height!==a;((s||r)&&(this._texture=this._texture&&this._texture.destroy(),this._classifiedTexture=this._classifiedTexture&&this._classifiedTexture.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._texture=new v({context:e,width:o,height:a,pixelFormat:h.RGBA,pixelDatatype:f.UNSIGNED_BYTE,sampler:new g({wrapS:C.CLAMP_TO_EDGE,wrapT:C.CLAMP_TO_EDGE,minificationFilter:b.LINEAR,magnificationFilter:y.LINEAR})}),d(this._previousFramebuffer)||(this._classifiedTexture=new v({context:e,width:o,height:a,pixelFormat:h.RGBA,pixelDatatype:f.UNSIGNED_BYTE,sampler:new g({wrapS:C.CLAMP_TO_EDGE,wrapT:C.CLAMP_TO_EDGE,minificationFilter:b.LINEAR,magnificationFilter:y.LINEAR})}),this._depthStencilTexture=new v({context:e,width:o,height:a,pixelFormat:h.DEPTH_STENCIL,pixelDatatype:f.UNSIGNED_INT_24_8}))),!d(this._fbo)||s||r)&&(this._fbo=this._fbo&&this._fbo.destroy(),this._fboClassified=this._fboClassified&&this._fboClassified.destroy(),d(this._previousFramebuffer)?(i=this._previousFramebuffer.depthStencilTexture,n=this._previousFramebuffer.depthStencilRenderbuffer):i=this._depthStencilTexture,this._fbo=new p({context:e,colorTextures:[this._texture],depthStencilTexture:i,depthStencilRenderbuffer:n,destroyAttachments:!1}),d(this._previousFramebuffer)||(this._fboClassified=new p({context:e,colorTextures:[this._classifiedTexture],depthStencilTexture:i,destroyAttachments:!1})));if(d(this._rsUnclassified)||(this._rsUnclassified=m.fromCache(S),this._rsClassified=m.fromCache(T),this._rsDefault=m.fromCache(E)),!d(this._unclassifiedCommand)||r){d(this._unclassifiedCommand)&&(this._unclassifiedCommand.shaderProgram=this._unclassifiedCommand.shaderProgram&&this._unclassifiedCommand.shaderProgram.destroy(),this._classifiedCommand.shaderProgram=this._classifiedCommand.shaderProgram&&this._classifiedCommand.shaderProgram.destroy());var l=d(this._previousFramebuffer)?"uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    vec4 color = texture2D(u_texture, v_textureCoordinates);\n    if (color.a == 0.0)\n    {\n        discard;\n    }\n#ifdef UNCLASSIFIED\n    gl_FragColor = color * czm_invertClassificationColor;\n#else\n    gl_FragColor = color;\n#endif\n}\n":"#extension GL_EXT_frag_depth : enable\nuniform sampler2D u_texture;\nuniform sampler2D u_depth;\nuniform sampler2D u_classified;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    vec4 color = texture2D(u_texture, v_textureCoordinates);\n    if (color.a == 0.0)\n    {\n        discard;\n    }\n    bool isClassified = all(equal(texture2D(u_classified, v_textureCoordinates), vec4(0.0)));\n#ifdef UNCLASSIFIED\n    vec4 highlightColor = czm_invertClassificationColor;\n    if (isClassified)\n    {\n        discard;\n    }\n#else\n    vec4 highlightColor = vec4(1.0);\n    if (!isClassified)\n    {\n        discard;\n    }\n#endif\n    gl_FragColor = color * highlightColor;\n    gl_FragDepthEXT = texture2D(u_depth, v_textureCoordinates).r;\n}\n",u=new _({defines:["UNCLASSIFIED"],sources:[l]}),c=new _({sources:[l]});this._unclassifiedCommand=e.createViewportQuadCommand(u,{renderState:d(this._previousFramebuffer)?this._rsUnclassified:this._rsDefault,uniformMap:this._uniformMap,owner:this}),this._classifiedCommand=e.createViewportQuadCommand(c,{renderState:d(this._previousFramebuffer)?this._rsClassified:this._rsDefault,uniformMap:this._uniformMap,owner:this}),d(this._translucentCommand)&&(this._translucentCommand.shaderProgram=this._translucentCommand.shaderProgram&&this._translucentCommand.shaderProgram.destroy()),d(this._previousFramebuffer)||(this._translucentCommand=e.createViewportQuadCommand(w,{renderState:this._rsUnclassified,uniformMap:this._uniformMap,owner:this}))}},s.prototype.clear=function(e,t){var r=t.framebuffer;d(this._previousFramebuffer)?(t.framebuffer=this._fbo,this._clearColorCommand.execute(e,t)):(t.framebuffer=this._fbo,this._clearCommand.execute(e,t),t.framebuffer=this._fboClassified,this._clearCommand.execute(e,t)),t.framebuffer=r},s.prototype.executeClassified=function(e,t){if(!d(this._previousFramebuffer)){var r=t.framebuffer;t.framebuffer=this._fboClassified,this._translucentCommand.execute(e,t),t.framebuffer=r}this._classifiedCommand.execute(e,t)},s.prototype.executeUnclassified=function(e,t){this._unclassifiedCommand.execute(e,t)},s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){return this._fbo=this._fbo&&this._fbo.destroy(),this._texture=this._texture&&this._texture.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),d(this._unclassifiedCommand)&&(this._unclassifiedCommand.shaderProgram=this._unclassifiedCommand.shaderProgram&&this._unclassifiedCommand.shaderProgram.destroy(),this._classifiedCommand.shaderProgram=this._classifiedCommand.shaderProgram&&this._classifiedCommand.shaderProgram.destroy()),r(this)},s}),define("Scene/JobScheduler",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/getTimestamp","./JobType"],function(a,e,s,t,l){"use strict";function u(e){this._total=e,this.usedThisFrame=0,this.stolenFromMeThisFrame=0,this.starvedThisFrame=!1,this.starvedLastFrame=!1}function c(e){if(a(e)&&e.length!==l.NUMBER_OF_JOB_TYPES)throw new s("A budget must be specified for each job type; budgets.length should equal JobType.NUMBER_OF_JOB_TYPES.");var t=new Array(l.NUMBER_OF_JOB_TYPES);t[l.TEXTURE]=new u(a(e)?e[l.TEXTURE]:10),t[l.PROGRAM]=new u(a(e)?e[l.PROGRAM]:10),t[l.BUFFER]=new u(a(e)?e[l.BUFFER]:30);var r,i=t.length,n=0;for(r=0;r<i;++r)n+=t[r].total;var o=new Array(i);for(r=0;r<i;++r)o[r]=!1;this._totalBudget=n,this._totalUsedThisFrame=0,this._budgets=t,this._executedThisFrame=o}return e(u.prototype,{total:{get:function(){return this._total}}}),c.getTimestamp=t,e(c.prototype,{totalBudget:{get:function(){return this._totalBudget}}}),c.prototype.disableThisFrame=function(){this._totalUsedThisFrame=this._totalBudget},c.prototype.resetBudgets=function(){for(var e=this._budgets,t=e.length,r=0;r<t;++r){var i=e[r];i.starvedLastFrame=i.starvedThisFrame,i.starvedThisFrame=!1,i.usedThisFrame=0,i.stolenFromMeThisFrame=0}this._totalUsedThisFrame=0},c.prototype.execute=function(e,t){var r,i=this._budgets,n=i[t],o=this._executedThisFrame[t];if(this._totalUsedThisFrame>=this._totalBudget&&o)return!(n.starvedThisFrame=!0);if(n.usedThisFrame+n.stolenFromMeThisFrame>=n.total){var a,s=i.length;for(a=0;a<s&&(!((r=i[a]).usedThisFrame+r.stolenFromMeThisFrame<r.total)||r.starvedLastFrame);++a);if(a===s&&o)return!1;o&&(n.starvedThisFrame=!0)}var l=c.getTimestamp();e.execute();var u=c.getTimestamp()-l;return this._totalUsedThisFrame+=u,r?r.stolenFromMeThisFrame+=u:n.usedThisFrame+=u,this._executedThisFrame[t]=!0},c}),define("Scene/Moon",["../Core/buildModuleUrl","../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/Ellipsoid","../Core/IauOrientationAxes","../Core/Matrix3","../Core/Matrix4","../Core/Simon1994PlanetaryPositions","../Core/Transforms","./EllipsoidPrimitive","./Material"],function(r,e,i,a,t,n,o,s,l,u,c,d,h,p){"use strict";function f(e){var t=(e=i(e,i.EMPTY_OBJECT)).textureUrl;a(t)||(t=r("Assets/Textures/moonSmall.jpg")),this.show=i(e.show,!0),this.textureUrl=t,this._ellipsoid=i(e.ellipsoid,o.MOON),this.onlySunLighting=i(e.onlySunLighting,!0),this._ellipsoidPrimitive=new h({radii:this.ellipsoid.radii,material:p.fromType(p.ImageType),depthTestEnabled:!1,_owner:this}),this._ellipsoidPrimitive.material.translucent=!1,this._axes=new s}t(f.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});var m=new l,g=new l,_=new e,v=[];return f.prototype.update=function(e){if(this.show){var t=this._ellipsoidPrimitive;t.material.uniforms.image=this.textureUrl,t.onlySunLighting=this.onlySunLighting;var r=e.time;a(d.computeIcrfToFixedMatrix(r,m))||d.computeTemeToPseudoFixedMatrix(r,m);var i=this._axes.evaluate(r,g);l.transpose(i,i),l.multiply(m,i,i);var n=c.computeMoonPositionInEarthInertialFrame(r,_);l.multiplyByVector(m,n,n),u.fromRotationTranslation(i,n,t.modelMatrix);var o=e.commandList;return(e.commandList=v).length=0,t.update(e),e.commandList=o,1===v.length?v[0]:void 0}},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){return this._ellipsoidPrimitive=this._ellipsoidPrimitive&&this._ellipsoidPrimitive.destroy(),n(this)},f}),define("Scene/NeverTileDiscardPolicy",[],function(){"use strict";function e(e){}return e.prototype.isReady=function(){return!0},e.prototype.shouldDiscardImage=function(e){return!1},e}),define("Shaders/AdjustTranslucentFS",[],function(){"use strict";return"#ifdef MRT\n#extension GL_EXT_draw_buffers : enable\n#endif\nuniform vec4 u_bgColor;\nuniform sampler2D u_depthTexture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nif (texture2D(u_depthTexture, v_textureCoordinates).r < 1.0)\n{\n#ifdef MRT\ngl_FragData[0] = u_bgColor;\ngl_FragData[1] = vec4(u_bgColor.a);\n#else\ngl_FragColor = u_bgColor;\n#endif\nreturn;\n}\ndiscard;\n}\n"}),define("Shaders/CompositeOITFS",[],function(){"use strict";return"uniform sampler2D u_opaque;\nuniform sampler2D u_accumulation;\nuniform sampler2D u_revealage;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nvec4 opaque = texture2D(u_opaque, v_textureCoordinates);\nvec4 accum = texture2D(u_accumulation, v_textureCoordinates);\nfloat r = texture2D(u_revealage, v_textureCoordinates).r;\n#ifdef MRT\nvec4 transparent = vec4(accum.rgb / clamp(r, 1e-4, 5e4), accum.a);\n#else\nvec4 transparent = vec4(accum.rgb / clamp(accum.a, 1e-4, 5e4), r);\n#endif\ngl_FragColor = (1.0 - transparent.a) * transparent + transparent.a * opaque;\nif (opaque != czm_backgroundColor)\n{\ngl_FragColor.a = 1.0;\n}\n}\n"}),define("Scene/OIT",["../Core/BoundingRectangle","../Core/Color","../Core/defined","../Core/destroyObject","../Core/PixelFormat","../Core/WebGLConstants","../Renderer/ClearCommand","../Renderer/DrawCommand","../Renderer/Framebuffer","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/ShaderSource","../Renderer/Texture","../Shaders/AdjustTranslucentFS","../Shaders/CompositeOITFS","./BlendEquation","./BlendFunction"],function(h,n,C,e,p,f,r,w,m,g,_,v,y,b,S,t,i){"use strict";function o(e){this._translucentMultipassSupport=!1,this._translucentMRTSupport=!1;var t=e.floatingPointTexture&&e.depthTexture;this._translucentMRTSupport=e.drawBuffers&&t,this._translucentMultipassSupport=!this._translucentMRTSupport&&t,this._opaqueFBO=void 0,this._opaqueTexture=void 0,this._depthStencilTexture=void 0,this._accumulationTexture=void 0,this._translucentFBO=void 0,this._alphaFBO=void 0,this._adjustTranslucentFBO=void 0,this._adjustAlphaFBO=void 0,this._opaqueClearCommand=new r({color:new n(0,0,0,0),owner:this}),this._translucentMRTClearCommand=new r({color:new n(0,0,0,1),owner:this}),this._translucentMultipassClearCommand=new r({color:new n(0,0,0,0),owner:this}),this._alphaClearCommand=new r({color:new n(1,1,1,1),owner:this}),this._translucentRenderStateCache={},this._alphaRenderStateCache={},this._compositeCommand=void 0,this._adjustTranslucentCommand=void 0,this._adjustAlphaCommand=void 0,this._viewport=new h,this._rs=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0}function T(e){e._accumulationTexture=e._accumulationTexture&&!e._accumulationTexture.isDestroyed()&&e._accumulationTexture.destroy(),e._revealageTexture=e._revealageTexture&&!e._revealageTexture.isDestroyed()&&e._revealageTexture.destroy()}function E(e){e._translucentFBO=e._translucentFBO&&!e._translucentFBO.isDestroyed()&&e._translucentFBO.destroy(),e._alphaFBO=e._alphaFBO&&!e._alphaFBO.isDestroyed()&&e._alphaFBO.destroy(),e._adjustTranslucentFBO=e._adjustTranslucentFBO&&!e._adjustTranslucentFBO.isDestroyed()&&e._adjustTranslucentFBO.destroy(),e._adjustAlphaFBO=e._adjustAlphaFBO&&!e._adjustAlphaFBO.isDestroyed()&&e._adjustAlphaFBO.destroy()}function A(e){T(e),E(e)}o.prototype.update=function(e,t,r){if(this.isSupported()){this._opaqueFBO=r,this._opaqueTexture=r.getColorTexture(0),this._depthStencilTexture=r.depthStencilTexture;var i=this._opaqueTexture.width,n=this._opaqueTexture.height,o=this._accumulationTexture,a=!C(o)||o.width!==i||o.height!==n;if(a&&function(e,t,r,i){T(e);var n=new Float32Array(r*i*4);e._accumulationTexture=new y({context:t,pixelFormat:p.RGBA,pixelDatatype:g.FLOAT,source:{arrayBufferView:n,width:r,height:i}}),e._revealageTexture=new y({context:t,pixelFormat:p.RGBA,pixelDatatype:g.FLOAT,source:{arrayBufferView:n,width:r,height:i}})}(this,e,i,n),C(this._translucentFBO)&&!a||function(e,t){E(e);var r=f.FRAMEBUFFER_COMPLETE,i=!0;if(e._translucentMRTSupport&&(e._translucentFBO=new m({context:t,colorTextures:[e._accumulationTexture,e._revealageTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._adjustTranslucentFBO=new m({context:t,colorTextures:[e._accumulationTexture,e._revealageTexture],destroyAttachments:!1}),e._translucentFBO.status===r&&e._adjustTranslucentFBO.status===r||(E(e),e._translucentMRTSupport=!1)),!e._translucentMRTSupport){e._translucentFBO=new m({context:t,colorTextures:[e._accumulationTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._alphaFBO=new m({context:t,colorTextures:[e._revealageTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._adjustTranslucentFBO=new m({context:t,colorTextures:[e._accumulationTexture],destroyAttachments:!1}),e._adjustAlphaFBO=new m({context:t,colorTextures:[e._revealageTexture],destroyAttachments:!1});var n=e._translucentFBO.status===r,o=e._alphaFBO.status===r,a=e._adjustTranslucentFBO.status===r,s=e._adjustAlphaFBO.status===r;n&&o&&a&&s||(A(e),i=e._translucentMultipassSupport=!1)}return i}(this,e)){var s,l,u=this;C(this._compositeCommand)||(s=new v({sources:[S]}),this._translucentMRTSupport&&s.defines.push("MRT"),l={u_opaque:function(){return u._opaqueTexture},u_accumulation:function(){return u._accumulationTexture},u_revealage:function(){return u._revealageTexture}},this._compositeCommand=e.createViewportQuadCommand(s,{uniformMap:l,owner:this})),C(this._adjustTranslucentCommand)||(this._translucentMRTSupport?(s=new v({defines:["MRT"],sources:[b]}),l={u_bgColor:function(){return u._translucentMRTClearCommand.color},u_depthTexture:function(){return u._depthStencilTexture}},this._adjustTranslucentCommand=e.createViewportQuadCommand(s,{uniformMap:l,owner:this})):this._translucentMultipassSupport&&(s=new v({sources:[b]}),l={u_bgColor:function(){return u._translucentMultipassClearCommand.color},u_depthTexture:function(){return u._depthStencilTexture}},this._adjustTranslucentCommand=e.createViewportQuadCommand(s,{uniformMap:l,owner:this}),l={u_bgColor:function(){return u._alphaClearCommand.color},u_depthTexture:function(){return u._depthStencilTexture}},this._adjustAlphaCommand=e.createViewportQuadCommand(s,{uniformMap:l,owner:this}))),this._viewport.width=i,this._viewport.height=n;var c=!h.equals(this._viewport,t.viewport),d=c!==this._useScissorTest;this._useScissorTest=c,h.equals(this._scissorRectangle,t.viewport)||(this._scissorRectangle=h.clone(t.viewport,this._scissorRectangle),d=!0),C(this._rs)&&h.equals(this._viewport,this._rs.viewport)&&!d||(this._rs=_.fromCache({viewport:this._viewport,scissorTest:{enabled:this._useScissorTest,rectangle:this._scissorRectangle}})),C(this._compositeCommand)&&(this._compositeCommand.renderState=this._rs),this._adjustTranslucentCommand&&(this._adjustTranslucentCommand.renderState=this._rs),C(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.renderState=this._rs)}}};var x={enabled:!0,color:new n(0,0,0,0),equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:i.ONE,functionDestinationRgb:i.ONE,functionSourceAlpha:i.ZERO,functionDestinationAlpha:i.ONE_MINUS_SOURCE_ALPHA},P={enabled:!0,color:new n(0,0,0,0),equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:i.ONE,functionDestinationRgb:i.ONE,functionSourceAlpha:i.ONE,functionDestinationAlpha:i.ONE},D={enabled:!0,color:new n(0,0,0,0),equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:i.ZERO,functionDestinationRgb:i.ONE_MINUS_SOURCE_ALPHA,functionSourceAlpha:i.ZERO,functionDestinationAlpha:i.ONE_MINUS_SOURCE_ALPHA};function O(e,t,r,i){var n=r[i.id];if(!C(n)){var o=_.getState(i);o.depthMask=!1,o.blending=t,n=_.fromCache(o),r[i.id]=n}return n}function I(e,t,r,i){var n=e.shaderCache.getDerivedShaderProgram(t,r);if(!C(n)){var o=t._attributeLocations,a=t.fragmentShaderSource.clone();a.sources=a.sources.map(function(e){return e=(e=(e=(e=v.replaceMain(e,"czm_translucent_main")).replace(/gl_FragColor/g,"czm_gl_FragColor")).replace(/\bdiscard\b/g,"czm_discard = true")).replace(/czm_phong/g,"czm_translucentPhong")}),a.sources.splice(0,0,(-1!==i.indexOf("gl_FragData")?"#extension GL_EXT_draw_buffers : enable \n":"")+"vec4 czm_gl_FragColor;\nbool czm_discard = false;\n"),a.sources.push("void main()\n{\n    czm_translucent_main();\n    if (czm_discard)\n    {\n        discard;\n    }\n"+i+"}\n"),n=e.shaderCache.createDerivedShaderProgram(t,r,{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:a,attributeLocations:o})}return n}return o.prototype.createDerivedCommands=function(e,t,r){var i,n,o,a,s,l,u,c,d,h,p,f,m,g,_,v,y,b;(C(r)||(r={}),this._translucentMRTSupport)?(C(r.translucentCommand)&&(i=r.translucentCommand.shaderProgram,n=r.translucentCommand.renderState),r.translucentCommand=w.shallowClone(e,r.translucentCommand),C(i)&&r.shaderProgramId===e.shaderProgram.id?(r.translucentCommand.shaderProgram=i,r.translucentCommand.renderState=n):(r.translucentCommand.shaderProgram=(y=t,b=e.shaderProgram,I(y,b,"translucentMRT","    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\n    float ai = czm_gl_FragColor.a;\n    float wzi = czm_alphaWeight(ai);\n    gl_FragData[0] = vec4(Ci * wzi, ai);\n    gl_FragData[1] = vec4(ai * wzi);\n")),r.translucentCommand.renderState=(_=this,v=e.renderState,O(0,x,_._translucentRenderStateCache,v)),r.shaderProgramId=e.shaderProgram.id)):(C(r.translucentCommand)&&(o=r.translucentCommand.shaderProgram,a=r.translucentCommand.renderState,s=r.alphaCommand.shaderProgram,l=r.alphaCommand.renderState),r.translucentCommand=w.shallowClone(e,r.translucentCommand),r.alphaCommand=w.shallowClone(e,r.alphaCommand),C(o)&&r.shaderProgramId===e.shaderProgram.id?(r.translucentCommand.shaderProgram=o,r.translucentCommand.renderState=a,r.alphaCommand.shaderProgram=s,r.alphaCommand.renderState=l):(r.translucentCommand.shaderProgram=(m=t,g=e.shaderProgram,I(m,g,"translucentMultipass","    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\n    float ai = czm_gl_FragColor.a;\n    float wzi = czm_alphaWeight(ai);\n    gl_FragColor = vec4(Ci, ai) * wzi;\n")),r.translucentCommand.renderState=(p=this,f=e.renderState,O(0,P,p._translucentRenderStateCache,f)),r.alphaCommand.shaderProgram=(d=t,h=e.shaderProgram,I(d,h,"alphaMultipass","    float ai = czm_gl_FragColor.a;\n    gl_FragColor = vec4(ai);\n")),r.alphaCommand.renderState=(u=this,c=e.renderState,O(0,D,u._alphaRenderStateCache,c)),r.shaderProgramId=e.shaderProgram.id));return r},o.prototype.executeCommands=function(e,t,r,i,n){this._translucentMRTSupport?function(e,t,r,i,n,o){var a=t.context,s=i.framebuffer,l=n.length,u=t.frameState.shadowHints.shadowsEnabled;i.framebuffer=e._adjustTranslucentFBO,e._adjustTranslucentCommand.execute(a,i);var c,d=e._opaqueFBO;i.framebuffer=e._translucentFBO;for(var h=0;h<l;++h)c=n[h],r(u&&c.receiveShadows?c.derivedCommands.oit.shadows.translucentCommand:c.derivedCommands.oit.translucentCommand,t,a,i,d);C(o)&&(c=o.unclassifiedCommand,r(u&&c.receiveShadows?c.derivedCommands.oit.shadows.translucentCommand:c.derivedCommands.oit.translucentCommand,t,a,i,d)),i.framebuffer=s}(this,e,t,r,i,n):function(e,t,r,i,n,o){var a,s,l=t.context,u=i.framebuffer,c=n.length,d=t.frameState.shadowHints.shadowsEnabled;i.framebuffer=e._adjustTranslucentFBO,e._adjustTranslucentCommand.execute(l,i),i.framebuffer=e._adjustAlphaFBO,e._adjustAlphaCommand.execute(l,i);var h=e._opaqueFBO;for(i.framebuffer=e._translucentFBO,s=0;s<c;++s)a=n[s],r(d&&a.receiveShadows?a.derivedCommands.oit.shadows.translucentCommand:a.derivedCommands.oit.translucentCommand,t,l,i,h);for(C(o)&&(a=o.unclassifiedCommand,r(d&&a.receiveShadows?a.derivedCommands.oit.shadows.translucentCommand:a.derivedCommands.oit.translucentCommand,t,l,i,h)),i.framebuffer=e._alphaFBO,s=0;s<c;++s)a=n[s],r(d&&a.receiveShadows?a.derivedCommands.oit.shadows.alphaCommand:a.derivedCommands.oit.alphaCommand,t,l,i,h);C(o)&&(a=o.unclassifiedCommand,r(d&&a.receiveShadows?a.derivedCommands.oit.shadows.alphaCommand:a.derivedCommands.oit.alphaCommand,t,l,i,h)),i.framebuffer=u}(this,e,t,r,i,n)},o.prototype.execute=function(e,t){this._compositeCommand.execute(e,t)},o.prototype.clear=function(e,t,r){var i=t.framebuffer;t.framebuffer=this._opaqueFBO,n.clone(r,this._opaqueClearCommand.color),this._opaqueClearCommand.execute(e,t),t.framebuffer=this._translucentFBO,(this._translucentMRTSupport?this._translucentMRTClearCommand:this._translucentMultipassClearCommand).execute(e,t),this._translucentMultipassSupport&&(t.framebuffer=this._alphaFBO,this._alphaClearCommand.execute(e,t)),t.framebuffer=i},o.prototype.isSupported=function(){return this._translucentMRTSupport||this._translucentMultipassSupport},o.prototype.isDestroyed=function(){return!1},o.prototype.destroy=function(){return A(this),C(this._compositeCommand)&&(this._compositeCommand.shaderProgram=this._compositeCommand.shaderProgram&&this._compositeCommand.shaderProgram.destroy()),C(this._adjustTranslucentCommand)&&(this._adjustTranslucentCommand.shaderProgram=this._adjustTranslucentCommand.shaderProgram&&this._adjustTranslucentCommand.shaderProgram.destroy()),C(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.shaderProgram=this._adjustAlphaCommand.shaderProgram&&this._adjustAlphaCommand.shaderProgram.destroy()),e(this)},o}),define("Scene/Particle",["../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties"],function(t,o,r,i,a,e){"use strict";var n=new t(1,1);function s(e){e=i(e,i.EMPTY_OBJECT),this.mass=i(e.mass,1),this.position=o.clone(i(e.position,o.ZERO)),this.velocity=o.clone(i(e.velocity,o.ZERO)),this.life=i(e.life,Number.MAX_VALUE),this.image=e.image,this.startColor=r.clone(i(e.startColor,r.WHITE)),this.endColor=r.clone(i(e.endColor,r.WHITE)),this.startScale=i(e.startScale,1),this.endScale=i(e.endScale,1),this.size=t.clone(i(e.size,n)),this._age=0,this._normalizedAge=0,this._billboard=void 0}e(s.prototype,{age:{get:function(){return this._age}},normalizedAge:{get:function(){return this._normalizedAge}}});var l=new o;return s.prototype.update=function(e,t){if(o.multiplyByScalar(this.velocity,e,l),o.add(this.position,l,this.position),a(t))for(var r=t.length,i=0;i<r;++i){var n=t[i];"function"==typeof n&&n(this,e)}return this._age+=e,this.life===Number.MAX_VALUE?this._normalizedAge=0:this._normalizedAge=this._age/this.life,this._age<=this.life},s}),define("Scene/ParticleBurst",["../Core/defaultValue","../Core/defineProperties"],function(t,e){"use strict";function r(e){e=t(e,t.EMPTY_OBJECT),this.time=t(e.time,0),this.minimum=t(e.minimum,0),this.maximum=t(e.maximum,50),this._complete=!1}return e(r.prototype,{complete:{get:function(){return this._complete}}}),r}),define("Scene/ParticleEmitter",["../Core/DeveloperError"],function(t){"use strict";function e(e){throw new t("This type should not be instantiated directly.  Instead, use BoxEmitter, CircleEmitter, ConeEmitter or SphereEmitter.")}return e.prototype.emit=function(e){t.throwInstantiationError()},e}),define("Scene/ParticleSystem",["../Core/Cartesian2","../Core/Cartesian3","../Core/Check","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/Event","../Core/JulianDate","../Core/Math","../Core/Matrix4","./BillboardCollection","./CircleEmitter","./Particle"],function(o,f,t,l,r,m,e,i,n,g,_,v,y,a,b){"use strict";function s(e){e=r(e,r.EMPTY_OBJECT),this.show=r(e.show,!0),this.forces=e.forces,this.loop=r(e.loop,!0),this.image=r(e.image,void 0);var t=e.emitter;m(t)||(t=new a(.5)),this._emitter=t,this._bursts=e.bursts,this._modelMatrix=v.clone(r(e.modelMatrix,v.IDENTITY)),this._emitterModelMatrix=v.clone(r(e.emitterModelMatrix,v.IDENTITY)),this._matrixDirty=!0,this._combinedMatrix=new v,this._startColor=l.clone(r(e.startColor,l.WHITE)),this._endColor=l.clone(r(e.endColor,l.WHITE)),this._startScale=r(e.startScale,1),this._endScale=r(e.endScale,1),this._rate=r(e.rate,5),this._minimumSpeed=r(e.speed,r(e.minimumSpeed,1)),this._maximumSpeed=r(e.speed,r(e.maximumSpeed,1)),this._minimumLife=r(e.life,r(e.minimumLife,5)),this._maximumLife=r(e.life,r(e.maximumLife,5)),this._minimumMass=r(e.mass,r(e.minimumMass,1)),this._maximumMass=r(e.mass,r(e.maximumMass,1)),this._minimumWidth=r(e.width,r(e.minimumWidth,1)),this._maximumWidth=r(e.width,r(e.maximumWidth,1)),this._minimumHeight=r(e.height,r(e.minimumHeight,1)),this._maximumHeight=r(e.height,r(e.maximumHeight,1)),this._lifeTime=r(e.lifeTime,Number.MAX_VALUE),this._billboardCollection=void 0,this._particles=[],this._particlePool=[],this._previousTime=void 0,this._currentTime=0,this._carryOver=0,this._complete=new n,this._isComplete=!1,this._updateParticlePool=!0,this._particleEstimate=0}function C(e,t){var r=t._billboard;m(r)||(r=t._billboard=e._billboardCollection.add({image:t.image})),r.width=t.size.x,r.height=t.size.y,r.position=t.position,r.show=!0;var i=_.lerp(t.startColor.red,t.endColor.red,t.normalizedAge),n=_.lerp(t.startColor.green,t.endColor.green,t.normalizedAge),o=_.lerp(t.startColor.blue,t.endColor.blue,t.normalizedAge),a=_.lerp(t.startColor.alpha,t.endColor.alpha,t.normalizedAge);r.color=new l(i,n,o,a);var s=_.lerp(t.startScale,t.endScale,t.normalizedAge);r.scale=s}function w(e,t){t.startColor=l.clone(e._startColor,t.startColor),t.endColor=l.clone(e._endColor,t.endColor),t.startScale=e._startScale,t.endScale=e._endScale,t.image=e.image,t.life=_.randomBetween(e._minimumLife,e._maximumLife),t.mass=_.randomBetween(e._minimumMass,e._maximumMass);var r=_.randomBetween(e._minimumWidth,e._maximumWidth),i=_.randomBetween(e._minimumHeight,e._maximumHeight);t.size=o.fromElements(r,i,t.size),t._normalizedAge=0,t._age=0;var n=_.randomBetween(e._minimumSpeed,e._maximumSpeed);f.multiplyByScalar(t.velocity,n,t.velocity),e._particles.push(t)}e(s.prototype,{emitter:{get:function(){return this._emitter},set:function(e){t.defined("value",e),this._emitter=e}},bursts:{get:function(){return this._bursts},set:function(e){this._bursts=e,this._updateParticlePool=!0}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){t.defined("value",e),this._matrixDirty=this._matrixDirty||!v.equals(this._modelMatrix,e),v.clone(e,this._modelMatrix)}},emitterModelMatrix:{get:function(){return this._emitterModelMatrix},set:function(e){t.defined("value",e),this._matrixDirty=this._matrixDirty||!v.equals(this._emitterModelMatrix,e),v.clone(e,this._emitterModelMatrix)}},startColor:{get:function(){return this._startColor},set:function(e){t.defined("value",e),l.clone(e,this._startColor)}},endColor:{get:function(){return this._endColor},set:function(e){t.defined("value",e),l.clone(e,this._endColor)}},startScale:{get:function(){return this._startScale},set:function(e){t.typeOf.number.greaterThanOrEquals("value",e,0),this._startScale=e}},endScale:{get:function(){return this._endScale},set:function(e){t.typeOf.number.greaterThanOrEquals("value",e,0),this._endScale=e}},rate:{get:function(){return this._rate},set:function(e){t.typeOf.number.greaterThanOrEquals("value",e,0),this._rate=e,this._updateParticlePool=!0}},minimumSpeed:{get:function(){return this._minimumSpeed},set:function(e){t.typeOf.number.greaterThanOrEquals("value",e,0),this._minimumSpeed=e}},maximumSpeed:{get:function(){return this._maximumSpeed},set:function(e){t.typeOf.number.greaterThanOrEquals("value",e,0),this._maximumSpeed=e}},minimumLife:{get:function(){return this._minimumLife},set:function(e){t.typeOf.number.greaterThanOrEquals("value",e,0),this._minimumLife=e}},maximumLife:{get:function(){return this._maximumLife},set:function(e){t.typeOf.number.greaterThanOrEquals("value",e,0),this._maximumLife=e,this._updateParticlePool=!0}},minimumMass:{get:function(){return this._minimumMass},set:function(e){t.typeOf.number.greaterThanOrEquals("value",e,0),this._minimumMass=e}},maximumMass:{get:function(){return this._maximumMass},set:function(e){t.typeOf.number.greaterThanOrEquals("value",e,0),this._maximumMass=e}},minimumWidth:{get:function(){return this._minimumWidth},set:function(e){t.typeOf.number.greaterThanOrEquals("value",e,0),this._minimumWidth=e}},maximumWidth:{get:function(){return this._maximumWidth},set:function(e){t.typeOf.number.greaterThanOrEquals("value",e,0),this._maximumWidth=e}},minimumHeight:{get:function(){return this._minimumHeight},set:function(e){t.typeOf.number.greaterThanOrEquals("value",e,0),this._minimumHeight=e}},maximumHeight:{get:function(){return this._maximumHeight},set:function(e){t.typeOf.number.greaterThanOrEquals("value",e,0),this._maximumHeight=e}},lifeTime:{get:function(){return this._lifeTime},set:function(e){t.typeOf.number.greaterThanOrEquals("value",e,0),this._lifeTime=e}},complete:{get:function(){return this._complete}},isComplete:{get:function(){return this._isComplete}}});var S=new f;return s.prototype.update=function(e){if(this.show){m(this._billboardCollection)||(this._billboardCollection=new y),this._updateParticlePool&&(!function(e){var t=e._rate,r=e._maximumLife,i=0,n=e._bursts;if(m(n))for(var o=n.length,a=0;a<o;++a)i+=n[a].maximum;for(var s=e._billboardCollection,l=e.image,u=Math.ceil(t*r+i),c=e._particles,d=e._particlePool,h=Math.max(u-c.length-d.length,0),p=0;p<h;++p){var f=new b;f._billboard=s.add({image:l}),d.push(f)}e._particleEstimate=u}(this),this._updateParticlePool=!1);var t=0;this._previousTime&&(t=g.secondsDifference(e.time,this._previousTime)),t<0&&(t=0);var r,i,n,o,a=this._particles,s=this._emitter,l=this.forces,u=a.length;for(r=0;r<u;++r)(i=a[r]).update(t,l)?C(this,i):(m((o=i)._billboard)&&(o._billboard.show=!1),n=i,this._particlePool.push(n),a[r]=a[u-1],--r,--u);a.length=u;var c,d=function(e,t){if(e._isComplete)return 0;var r=(t=_.mod(t,e._lifeTime))*e._rate,i=Math.floor(r);if(e._carryOver+=r-i,1<e._carryOver&&(i++,e._carryOver-=1),m(e.bursts))for(var n=e.bursts.length,o=0;o<n;o++){var a=e.bursts[o],s=e._currentTime;m(a)&&!a._complete&&s>a.time&&(i+=_.randomBetween(a.minimum,a.maximum),a._complete=!0)}return i}(this,t);if(0<d&&m(s)){this._matrixDirty&&(this._combinedMatrix=v.multiply(this.modelMatrix,this.emitterModelMatrix,this._combinedMatrix),this._matrixDirty=!1);var h=this._combinedMatrix;for(r=0;r<d;r++)c=void 0,c=this._particlePool.pop(),m(c)||(c=new b),i=c,this._emitter.emit(i),f.add(i.position,i.velocity,S),v.multiplyByPoint(h,S,S),i.position=v.multiplyByPoint(h,i.position,i.position),f.subtract(S,i.position,i.velocity),f.normalize(i.velocity,i.velocity),w(this,i),C(this,i)}if(this._billboardCollection.update(e),this._previousTime=g.clone(e.time,this._previousTime),this._currentTime+=t,this._lifeTime!==Number.MAX_VALUE&&this._currentTime>this._lifeTime)if(this.loop){if(this._currentTime=_.mod(this._currentTime,this._lifeTime),this.bursts){var p=this.bursts.length;for(r=0;r<p;r++)this.bursts[r]._complete=!1}}else this._isComplete=!0,this._complete.raiseEvent(this);e.frameNumber%120==0&&function(e){for(var t=e._particles,r=e._particlePool,i=e._billboardCollection,n=t.length,o=r.length,a=e._particleEstimate,s=o-Math.max(a-n-o,0),l=s;l<o;++l){var u=r[l];i.remove(u._billboard)}r.length=s}(this)}},s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){return this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),i(this)},s}),define("Widgets/getElement",["../Core/DeveloperError"],function(r){"use strict";return function(e){if("string"==typeof e){var t=document.getElementById(e);if(null===t)throw new r('Element with id "'+e+'" does not exist in the document.');e=t}return e}}),define("Scene/PerformanceDisplay",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/getTimestamp","../Widgets/getElement"],function(s,a,e,t,l,u,c){"use strict";function r(e){e=s(e,s.EMPTY_OBJECT);var t=c(e.container);if(!a(t))throw new l("container is required");this._container=t;var r=document.createElement("div");r.className="cesium-performanceDisplay";var i=document.createElement("div");i.className="cesium-performanceDisplay-fps",this._fpsText=document.createTextNode(""),i.appendChild(this._fpsText);var n=document.createElement("div");n.className="cesium-performanceDisplay-ms",this._msText=document.createTextNode(""),n.appendChild(this._msText),r.appendChild(n),r.appendChild(i),this._container.appendChild(r),this._lastFpsSampleTime=u(),this._lastMsSampleTime=u(),this._fpsFrameCount=0,this._msFrameCount=0,this._throttled=!1;var o=document.createElement("div");o.className="cesium-performanceDisplay-throttled",this._throttledText=document.createTextNode(""),o.appendChild(this._throttledText),r.appendChild(o)}return e(r.prototype,{throttled:{get:function(){return this._throttled},set:function(e){this._throttled!==e&&(this._throttledText.nodeValue=e?"(throttled)":"",this._throttled=e)}}}),r.prototype.update=function(e){var t=u(),r=s(e,!0);this._fpsFrameCount++;var i=t-this._lastFpsSampleTime;if(1e3<i){var n="N/A";r&&(n=1e3*this._fpsFrameCount/i|0),this._fpsText.nodeValue=n+" FPS",this._lastFpsSampleTime=t,this._fpsFrameCount=0}this._msFrameCount++;var o=t-this._lastMsSampleTime;if(200<o){var a="N/A";r&&(a=(o/this._msFrameCount).toFixed(2)),this._msText.nodeValue=a+" MS",this._lastMsSampleTime=t,this._msFrameCount=0}},r.prototype.destroy=function(){return t(this)},r}),define("Scene/PickDepth",["../Core/defined","../Core/destroyObject","../Core/PixelFormat","../Renderer/Framebuffer","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/Texture"],function(u,e,s,l,c,d,h){"use strict";function t(){this.framebuffer=void 0,this._depthTexture=void 0,this._textureToCopy=void 0,this._copyDepthCommand=void 0,this._debugPickDepthViewportCommand=void 0}function p(e){e._depthTexture=e._depthTexture&&!e._depthTexture.isDestroyed()&&e._depthTexture.destroy()}function f(e){e.framebuffer=e.framebuffer&&!e.framebuffer.isDestroyed()&&e.framebuffer.destroy()}function m(e,t,r,i){var n,o,a;p(e),f(e),n=t,o=r,a=i,e._depthTexture=new h({context:n,width:o,height:a,pixelFormat:s.RGBA,pixelDatatype:c.UNSIGNED_BYTE}),e.framebuffer=new l({context:t,colorTextures:[e._depthTexture],destroyAttachments:!1})}return t.prototype.executeDebugPickDepth=function(e,t){!function(e,t,r){u(e._debugPickDepthViewportCommand)||(e._debugPickDepthViewportCommand=t.createViewportQuadCommand("uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    float z_window = czm_unpackDepth(texture2D(u_texture, v_textureCoordinates));\n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\n    gl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n}\n",{uniformMap:{u_texture:function(){return e._depthTexture}},owner:e}));e._debugPickDepthViewportCommand.execute(t,r)}(this,e,t)},t.prototype.update=function(e,t){var r,i,n,o,a,s,l;r=this,i=e,o=(n=t).width,a=n.height,s=r._depthTexture,l=!u(s)||s.width!==o||s.height!==a,u(r.framebuffer)&&!l||m(r,i,o,a),function(e,t,r){u(e._copyDepthCommand)||(e._copyDepthCommand=t.createViewportQuadCommand("uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    gl_FragColor = czm_packDepth(texture2D(u_texture, v_textureCoordinates).r);\n}\n",{renderState:d.fromCache(),uniformMap:{u_texture:function(){return e._textureToCopy}},owner:e}));e._textureToCopy=r,e._copyDepthCommand.framebuffer=e.framebuffer}(this,e,t)},t.prototype.executeCopyDepth=function(e,t){this._copyDepthCommand.execute(e,t)},t.prototype.isDestroyed=function(){return!1},t.prototype.destroy=function(){return p(this),f(this),this._copyDepthCommand.shaderProgram=u(this._copyDepthCommand.shaderProgram)&&this._copyDepthCommand.shaderProgram.destroy(),e(this)},t}),define("Scene/PrimitiveCollection",["../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError"],function(t,r,n,e,i,o){"use strict";function a(e){e=r(e,r.EMPTY_OBJECT),this._primitives=[],this._guid=t(),this.show=r(e.show,!0),this.destroyPrimitives=r(e.destroyPrimitives,!0)}function s(e,t){if(!e.contains(t))throw new o("primitive is not in this collection.");return e._primitives.indexOf(t)}return e(a.prototype,{length:{get:function(){return this._primitives.length}}}),a.prototype.add=function(e){if(!n(e))throw new o("primitive is required.");var t=e._external=e._external||{};return(t._composites=t._composites||{})[this._guid]={collection:this},this._primitives.push(e),e},a.prototype.remove=function(e){if(this.contains(e)){var t=this._primitives.indexOf(e);if(-1!==t)return this._primitives.splice(t,1),delete e._external._composites[this._guid],this.destroyPrimitives&&e.destroy(),!0}return!1},a.prototype.removeAndDestroy=function(e){var t=this.remove(e);return t&&!this.destroyPrimitives&&e.destroy(),t},a.prototype.removeAll=function(){if(this.destroyPrimitives)for(var e=this._primitives,t=e.length,r=0;r<t;++r)e[r].destroy();this._primitives=[]},a.prototype.contains=function(e){return!!(n(e)&&e._external&&e._external._composites&&e._external._composites[this._guid])},a.prototype.raise=function(e){if(n(e)){var t=s(this,e),r=this._primitives;if(t!==r.length-1){var i=r[t];r[t]=r[t+1],r[t+1]=i}}},a.prototype.raiseToTop=function(e){if(n(e)){var t=s(this,e),r=this._primitives;t!==r.length-1&&(r.splice(t,1),r.push(e))}},a.prototype.lower=function(e){if(n(e)){var t=s(this,e),r=this._primitives;if(0!==t){var i=r[t];r[t]=r[t-1],r[t-1]=i}}},a.prototype.lowerToBottom=function(e){if(n(e)){var t=s(this,e),r=this._primitives;0!==t&&(r.splice(t,1),r.unshift(e))}},a.prototype.get=function(e){if(!n(e))throw new o("index is required.");return this._primitives[e]},a.prototype.update=function(e){if(this.show)for(var t=this._primitives,r=0;r<t.length;++r)t[r].update(e)},a.prototype.isDestroyed=function(){return!1},a.prototype.destroy=function(){return this.removeAll(),i(this)},a}),define("Scene/QuadtreeTileProvider",["../Core/defineProperties","../Core/DeveloperError"],function(e,t){"use strict";function r(){t.throwInstantiationError()}return r.computeDefaultLevelZeroMaximumGeometricError=function(e){return 2*e.ellipsoid.maximumRadius*Math.PI*.25/(65*e.getNumberOfXTilesAtLevel(0))},e(r.prototype,{quadtree:{get:t.throwInstantiationError,set:t.throwInstantiationError},ready:{get:t.throwInstantiationError},tilingScheme:{get:t.throwInstantiationError},errorEvent:{get:t.throwInstantiationError}}),r.prototype.update=t.throwInstantiationError,r.prototype.beginUpdate=t.throwInstantiationError,r.prototype.endUpdate=t.throwInstantiationError,r.prototype.getLevelMaximumGeometricError=t.throwInstantiationError,r.prototype.loadTile=t.throwInstantiationError,r.prototype.computeTileVisibility=t.throwInstantiationError,r.prototype.showTileThisFrame=t.throwInstantiationError,r.prototype.computeDistanceToTile=t.throwInstantiationError,r.prototype.isDestroyed=t.throwInstantiationError,r.prototype.destroy=t.throwInstantiationError,r}),define("Scene/SceneTransitioner",["../Core/Cartesian3","../Core/Cartographic","../Core/Check","../Core/defined","../Core/destroyObject","../Core/EasingFunction","../Core/Math","../Core/Matrix4","../Core/OrthographicFrustum","../Core/OrthographicOffCenterFrustum","../Core/PerspectiveFrustum","../Core/Ray","../Core/ScreenSpaceEventHandler","../Core/ScreenSpaceEventType","../Core/Transforms","./Camera","./SceneMode"],function(v,e,t,y,r,b,C,w,d,i,n,o,a,s,_,S,T){"use strict";function l(e){t.typeOf.object("scene",e),this._scene=e,this._currentTweens=[],this._morphHandler=void 0,this._morphCancelled=!1,this._completeMorph=void 0,this._morphToOrthographic=!1}l.prototype.completeMorph=function(){y(this._completeMorph)&&this._completeMorph()},l.prototype.morphTo2D=function(e,t){y(this._completeMorph)&&this._completeMorph();var r=this._scene;this._previousMode=r.mode,this._morphToOrthographic=r.camera.frustum instanceof d,this._previousMode!==T.SCENE2D&&this._previousMode!==T.MORPHING&&(this._scene.morphStart.raiseEvent(this,this._previousMode,T.SCENE2D,!0),r._mode=T.MORPHING,r.camera._setTransform(w.IDENTITY),this._previousMode===T.COLUMBUS_VIEW?function(e,t){t*=.5;var r=e._scene,i=r.camera,n=v.clone(i.position,re),o=v.clone(i.direction,ie),a=v.clone(i.up,ne),s=v.negate(v.UNIT_Z,ae),l=v.clone(v.UNIT_Y,se),u=oe;if(0<t)v.clone(v.ZERO,oe),u.z=5*r.mapProjection.ellipsoid.maximumRadius;else{v.clone(n,oe);var c=ue;w.multiplyByPoint(S.TRANSFORM_2D,n,c.origin),w.multiplyByPointAsVector(S.TRANSFORM_2D,o,c.direction);var d=r.globe;if(y(d)){var h=d.pick(c,r,ce);y(h)&&(w.multiplyByPoint(S.TRANSFORM_2D_INVERSE,h,u),u.z+=v.distance(n,u))}}var p=le;p.right=.5*u.z,p.left=-p.right,p.top=p.right*(r.drawingBufferHeight/r.drawingBufferWidth),p.bottom=-p.top;var f=de;f.position=u,f.direction=s,f.up=l,f.frustum=p;var m=Se(f);function g(e,t){e.position.z=t}N(e,m);var _=r.tweens.add({duration:t,easingFunction:b.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){ee(n,u,e.time,i.position),ee(o,s,e.time,i.direction),ee(a,l,e.time,i.up),v.cross(i.direction,i.up,i.right),v.normalize(i.right,i.right),i._adjustOrthographicFrustum(!0)},complete:function(){te(e,t,f,g,m)}});e._currentTweens.push(_)}(this,e):function(e,t,r){t*=.5;var i=e._scene,n=i.camera,o=pe;if(0<t)v.clone(v.ZERO,o.position),o.position.z=5*r.maximumRadius,v.negate(v.UNIT_Z,o.direction),v.clone(v.UNIT_Y,o.up);else{r.cartesianToCartographic(n.positionWC,he),i.mapProjection.project(he,o.position),v.negate(v.UNIT_Z,o.direction),v.clone(v.UNIT_Y,o.up);var a=ge;v.clone(o.position2D,a.origin);var s=v.clone(n.directionWC,a.direction),l=r.scaleToGeodeticSurface(n.positionWC,ve),u=_.eastNorthUpToFixedFrame(l,r,_e);w.inverseTransformation(u,u),w.multiplyByPointAsVector(u,s,s),w.multiplyByPointAsVector(S.TRANSFORM_2D,s,s);var c=i.globe;if(y(c)){var d=c.pick(a,i,me);if(y(d)){var h=v.distance(o.position2D,d);d.x+=h,v.clone(d,o.position2D)}}}function p(e,t){e.position.x=t}w.multiplyByPoint(S.TRANSFORM_2D,o.position,o.position2D),w.multiplyByPointAsVector(S.TRANSFORM_2D,o.direction,o.direction2D),w.multiplyByPointAsVector(S.TRANSFORM_2D,o.up,o.up2D);var f=o.frustum;f.right=.5*o.position.z,f.left=-f.right,f.top=f.right*(i.drawingBufferHeight/i.drawingBufferWidth),f.bottom=-f.top;var m=fe;w.multiplyByPoint(S.TRANSFORM_2D_INVERSE,o.position2D,m.position),v.clone(o.direction,m.direction),v.clone(o.up,m.up),m.frustum=f;var g=Se(m);N(e,g),be(e,t,o,function(){te(e,t,o,p,g)})}(this,e,t),0===e&&y(this._completeMorph)&&this._completeMorph())};var p=new v,f=new v,m=new v,g=new v,E=new v,A=new v,x=new v,P=new e,D=new w,O=new n,I=new d,M={position:void 0,direction:void 0,up:void 0,position2D:void 0,direction2D:void 0,up2D:void 0,frustum:void 0};l.prototype.morphToColumbusView=function(e,t){y(this._completeMorph)&&this._completeMorph();var r=this._scene;if(this._previousMode=r.mode,this._previousMode!==T.COLUMBUS_VIEW&&this._previousMode!==T.MORPHING){this._scene.morphStart.raiseEvent(this,this._previousMode,T.COLUMBUS_VIEW,!0),r.camera._setTransform(w.IDENTITY);var i,n=p,o=f,a=m;if(0<e)n.x=0,n.y=-1,n.z=1,n=v.multiplyByScalar(v.normalize(n,n),5*t.maximumRadius,n),v.negate(v.normalize(n,o),o),v.cross(v.UNIT_X,o,a);else{var s=r.camera;if(this._previousMode===T.SCENE2D)v.clone(s.position,n),n.z=s.frustum.right-s.frustum.left,v.negate(v.UNIT_Z,o),v.clone(v.UNIT_Y,a);else{v.clone(s.positionWC,n),v.clone(s.directionWC,o),v.clone(s.upWC,a);var l=t.scaleToGeodeticSurface(n,x),u=_.eastNorthUpToFixedFrame(l,t,D);w.inverseTransformation(u,u),r.mapProjection.project(t.cartesianToCartographic(n,P),n),w.multiplyByPointAsVector(u,o,o),w.multiplyByPointAsVector(u,a,a)}}this._morphToOrthographic?((i=I).width=r.camera.frustum.right-r.camera.frustum.left,i.aspectRatio=r.drawingBufferWidth/r.drawingBufferHeight):((i=O).aspectRatio=r.drawingBufferWidth/r.drawingBufferHeight,i.fov=C.toRadians(60));var c=M;c.position=n,c.direction=o,c.up=a,c.frustum=i;var d,h=(d=c,function(e){var t=e._scene;if(t._mode=T.COLUMBUS_VIEW,t.morphTime=T.getMorphTime(T.COLUMBUS_VIEW),k(e),e._previousModeMode!==T.MORPHING||e._morphCancelled){e._morphCancelled=!1;var r=t.camera;v.clone(d.position,r.position),v.clone(d.direction,r.direction),v.clone(d.up,r.up),v.cross(r.direction,r.up,r.right),v.normalize(r.right,r.right)}var i=y(e._completeMorph);e._completeMorph=void 0,t.camera.update(t.mode),e._scene.morphComplete.raiseEvent(e,e._previousMode,T.COLUMBUS_VIEW,i)});N(this,h),this._previousMode===T.SCENE2D?function(n,o,a,s){o*=.5;var l=n._scene,u=l.camera,c=v.clone(a.position,K),d=v.clone(a.direction,J),h=v.clone(a.up,$);function e(){u.frustum=a.frustum.clone();var t=v.clone(u.position,X),r=v.clone(u.direction,Q),i=v.clone(u.up,Z);t.z=c.z;var e=l.tweens.add({duration:o,easingFunction:b.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){ee(t,c,e.time,u.position),ee(r,d,e.time,u.direction),ee(i,h,e.time,u.up),v.cross(u.direction,u.up,u.right),v.normalize(u.right,u.right)},complete:function(){s(n)}});n._currentTweens.push(e)}l._mode=T.MORPHING,n._morphToOrthographic?e():ye(n,0,a,e)}(this,e,c,h):(c.position2D=w.multiplyByPoint(S.TRANSFORM_2D,n,g),c.direction2D=w.multiplyByPointAsVector(S.TRANSFORM_2D,o,E),c.up2D=w.multiplyByPointAsVector(S.TRANSFORM_2D,a,A),r._mode=T.MORPHING,be(this,e,c,h)),0===e&&y(this._completeMorph)&&this._completeMorph()}};var R={position:new v,direction:new v,up:new v,frustum:void 0},L=new n;function N(e,t){if(e._scene.completeMorphOnUserInput){e._morphHandler=new a(e._scene.canvas,!1);var r=function(){e._morphCancelled=!0,t(e)};e._completeMorph=r,e._morphHandler.setInputAction(r,s.LEFT_DOWN),e._morphHandler.setInputAction(r,s.MIDDLE_DOWN),e._morphHandler.setInputAction(r,s.RIGHT_DOWN),e._morphHandler.setInputAction(r,s.WHEEL)}}function k(e){for(var t=e._currentTweens,r=0;r<t.length;++r)t[r].cancelTween();e._currentTweens.length=0,e._morphHandler=e._morphHandler&&e._morphHandler.destroy()}l.prototype.morphTo3D=function(e,t){y(this._completeMorph)&&this._completeMorph();var r=this._scene;if(this._previousMode=r.mode,this._previousMode!==T.SCENE3D&&this._previousMode!==T.MORPHING){if(this._scene.morphStart.raiseEvent(this,this._previousMode,T.SCENE3D,!0),r._mode=T.MORPHING,r.camera._setTransform(w.IDENTITY),this._previousMode===T.SCENE2D)!function(e,t,r){t/=3;var i,n,o=e._scene,a=o.camera;0<t?(i=R,v.fromDegrees(0,0,5*r.maximumRadius,r,i.position),v.negate(i.position,i.direction),v.normalize(i.direction,i.direction),v.clone(v.UNIT_Z,i.up)):(a.position.z=a.frustum.right-a.frustum.left,i=U(e,r));e._morphToOrthographic?((n=Y).aspectRatio=o.drawingBufferWidth/o.drawingBufferHeight,n.width=a.frustum.right-a.frustum.left):((n=L).aspectRatio=o.drawingBufferWidth/o.drawingBufferHeight,n.fov=C.toRadians(60));i.frustum=n;var s=we(i);N(e,s);var l,u=v.clone(a.position,X),c=v.clone(a.direction,Q),d=v.clone(a.up,Z),h=v.fromElements(0,0,5*r.maximumRadius,K),p=v.negate(v.UNIT_Z,J),f=v.clone(v.UNIT_Y,$),m=a.frustum.right,g=.5*h.z;l=e._morphToOrthographic?function(){j(e,t,i,s)}:function(){ye(e,t,i,function(){j(e,t,i,s)})};if(0<t){var _=o.tweens.add({duration:t,easingFunction:b.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){ee(u,h,e.time,a.position),ee(c,p,e.time,a.direction),ee(d,f,e.time,a.up),v.cross(a.direction,a.up,a.right),v.normalize(a.right,a.right);var t=a.frustum;t.right=C.lerp(m,g,e.time),t.left=-t.right,t.top=t.right*(o.drawingBufferHeight/o.drawingBufferWidth),t.bottom=-t.top,a.position.z=2*o.mapProjection.ellipsoid.maximumRadius},complete:function(){o._mode=T.MORPHING,l()}});e._currentTweens.push(_)}else l()}(this,e,t);else{var i,n;0<e?(i=R,v.fromDegrees(0,0,5*t.maximumRadius,t,i.position),v.negate(i.position,i.direction),v.normalize(i.direction,i.direction),v.clone(v.UNIT_Z,i.up)):i=U(this,t);var o=r.camera;o.frustum instanceof d?n=o.frustum.clone():((n=L).aspectRatio=r.drawingBufferWidth/r.drawingBufferHeight,n.fov=C.toRadians(60)),i.frustum=n;var a=we(i);N(this,a),j(this,e,i,a)}0===e&&y(this._completeMorph)&&this._completeMorph()}},l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){return k(this),r(this)};var h=new e,F=new v,B=new w;function U(e,t){var r=e._scene,i=r.camera,n=R,o=n.position,a=n.direction,s=n.up,l=r.mapProjection.unproject(i.position,h);t.cartographicToCartesian(l,o);var u=t.scaleToGeodeticSurface(o,F),c=_.eastNorthUpToFixedFrame(u,t,B);return w.multiplyByPointAsVector(c,i.direction,a),w.multiplyByPointAsVector(c,i.up,s),n}var V=new v,z=new v,q=new v,G=new v,W=new v,H=new v;function j(e,t,r,i){t*=.5;var n=e._scene,o=n.camera,a=v.clone(o.position,V),s=v.clone(o.direction,z),l=v.clone(o.up,q),u=w.multiplyByPoint(S.TRANSFORM_2D_INVERSE,r.position,G),c=w.multiplyByPointAsVector(S.TRANSFORM_2D_INVERSE,r.direction,W),d=w.multiplyByPointAsVector(S.TRANSFORM_2D_INVERSE,r.up,H);var h=n.tweens.add({duration:t,easingFunction:b.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){ee(a,u,e.time,o.position),ee(s,c,e.time,o.direction),ee(l,d,e.time,o.up),v.cross(o.direction,o.up,o.right),v.normalize(o.right,o.right)},complete:function(){Ce(e,n,0,1,t,i)}});e._currentTweens.push(h)}var Y=new d,X=new v,Q=new v,Z=new v,K=new v,J=new v,$=new v;function ee(e,t,r,i){return v.lerp(e,t,r,i)}function te(e,t,r,i,n){var o=e._scene,a=o.camera;if(!(a.frustum instanceof d)){var s=a.frustum.fov,l=.5*C.RADIANS_PER_DEGREE,u=r.position.z*Math.tan(.5*s);a.frustum.far=u/Math.tan(.5*l)+1e7;var c=o.tweens.add({duration:t,easingFunction:b.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){a.frustum.fov=C.lerp(s,l,e.time);var t=u/Math.tan(.5*a.frustum.fov);i(a,t)},complete:function(){a.frustum=r.frustum.clone(),n(e)}});e._currentTweens.push(c)}}var re=new v,ie=new v,ne=new v,oe=new v,ae=new v,se=new v,le=new i,ue=new o,ce=new v,de={position:void 0,direction:void 0,up:void 0,frustum:void 0};var he=new e,pe={position:new v,direction:new v,up:new v,position2D:new v,direction2D:new v,up2D:new v,frustum:new i},fe={position:new v,direction:new v,up:new v,frustum:void 0},me=new v,ge=new o,_e=new w,ve=new v;function ye(e,t,r,i){var n=e._scene,o=n.camera,a=o.frustum.right-o.frustum.left;o.frustum=r.frustum.clone();var s=o.frustum.fov,l=.5*C.RADIANS_PER_DEGREE,u=a*Math.tan(.5*s);o.frustum.far=u/Math.tan(.5*l)+1e7,o.frustum.fov=l;var c=n.tweens.add({duration:t,easingFunction:b.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){o.frustum.fov=C.lerp(l,s,e.time),o.position.z=u/Math.tan(.5*o.frustum.fov)},complete:function(){i(e)}});e._currentTweens.push(c)}function be(e,t,r,i){var n=e._scene,o=n.camera,a=v.clone(o.position,X),s=v.clone(o.direction,Q),l=v.clone(o.up,Z),u=v.clone(r.position2D,K),c=v.clone(r.direction2D,J),d=v.clone(r.up2D,$);var h=n.tweens.add({duration:t,easingFunction:b.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){ee(a,u,e.time,o.position),ee(s,c,e.time,o.direction),ee(l,d,e.time,o.up),v.cross(o.direction,o.up,o.right),v.normalize(o.right,o.right),o._adjustOrthographicFrustum(!0)},complete:function(){Ce(e,n,1,0,t,i)}});e._currentTweens.push(h)}function Ce(e,t,r,i,n,o){var a={object:t,property:"morphTime",startValue:r,stopValue:i,duration:n,easingFunction:b.QUARTIC_OUT};y(o)&&(a.complete=function(){o(e)});var s=t.tweens.addProperty(a);e._currentTweens.push(s)}function we(n){return function(e){var t=e._scene;if(t._mode=T.SCENE3D,t.morphTime=T.getMorphTime(T.SCENE3D),k(e),e._previousMode!==T.MORPHING||e._morphCancelled){e._morphCancelled=!1;var r=t.camera;v.clone(n.position,r.position),v.clone(n.direction,r.direction),v.clone(n.up,r.up),v.cross(r.direction,r.up,r.right),v.normalize(r.right,r.right),r.frustum=n.frustum.clone()}var i=y(e._completeMorph);e._completeMorph=void 0,t.camera.update(t.mode),e._scene.morphComplete.raiseEvent(e,e._previousMode,T.SCENE3D,i)}}function Se(n){return function(e){var t=e._scene;t._mode=T.SCENE2D,t.morphTime=T.getMorphTime(T.SCENE2D),k(e);var r=t.camera;v.clone(n.position,r.position),r.position.z=2*t.mapProjection.ellipsoid.maximumRadius,v.clone(n.direction,r.direction),v.clone(n.up,r.up),v.cross(r.direction,r.up,r.right),v.normalize(r.right,r.right),r.frustum=n.frustum.clone();var i=y(e._completeMorph);e._completeMorph=void 0,t.camera.update(t.mode),e._scene.morphComplete.raiseEvent(e,e._previousMode,T.SCENE2D,i)}}return l}),define("Scene/TweenCollection",["../Core/clone","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/EasingFunction","../Core/getTimestamp","../Core/TimeConstants","../ThirdParty/Tween"],function(c,l,u,e,d,h,o,p,f){"use strict";function m(e,t,r,i,n,o,a,s,l,u){this._tweens=e,this._tweenjs=t,this._startObject=c(r),this._stopObject=c(i),this._duration=n,this._delay=o,this._easingFunction=a,this._update=s,this._complete=l,this.cancel=u,this.needsStart=!0}function t(){this._tweens=[]}return e(m.prototype,{startObject:{get:function(){return this._startObject}},stopObject:{get:function(){return this._stopObject}},duration:{get:function(){return this._duration}},delay:{get:function(){return this._delay}},easingFunction:{get:function(){return this._easingFunction}},update:{get:function(){return this._update}},complete:{get:function(){return this._complete}},tweenjs:{get:function(){return this._tweenjs}}}),m.prototype.cancelTween=function(){this._tweens.remove(this)},e(t.prototype,{length:{get:function(){return this._tweens.length}}}),t.prototype.add=function(e){if(e=l(e,l.EMPTY_OBJECT),!u(e.startObject)||!u(e.stopObject))throw new d("options.startObject and options.stopObject are required.");if(!u(e.duration)||e.duration<0)throw new d("options.duration is required and must be positive.");if(0===e.duration)return u(e.complete)&&e.complete(),new m(this);var t=e.duration/p.SECONDS_PER_MILLISECOND,r=l(e.delay,0),i=r/p.SECONDS_PER_MILLISECOND,n=l(e.easingFunction,h.LINEAR_NONE),o=e.startObject,a=new f.Tween(o);a.to(c(e.stopObject),t),a.delay(i),a.easing(n),u(e.update)&&a.onUpdate(function(){e.update(o)}),a.onComplete(l(e.complete,null)),a.repeat(l(e._repeat,0));var s=new m(this,a,e.startObject,e.stopObject,e.duration,r,n,e.update,e.complete,e.cancel);return this._tweens.push(s),s},t.prototype.addProperty=function(e){var t=(e=l(e,l.EMPTY_OBJECT)).object,r=e.property,i=e.startValue,n=e.stopValue;if(!u(t)||!u(e.property))throw new d("options.object and options.property are required.");if(!u(t[r]))throw new d("options.object must have the specified property.");if(!u(i)||!u(n))throw new d("options.startValue and options.stopValue are required.");return this.add({startObject:{value:i},stopObject:{value:n},duration:l(e.duration,3),delay:e.delay,easingFunction:e.easingFunction,update:function(e){t[r]=e.value},complete:e.complete,cancel:e.cancel,_repeat:e._repeat})},t.prototype.addAlpha=function(e){var i=(e=l(e,l.EMPTY_OBJECT)).material;if(!u(i))throw new d("options.material is required.");var n=[];for(var t in i.uniforms)i.uniforms.hasOwnProperty(t)&&u(i.uniforms[t])&&u(i.uniforms[t].alpha)&&n.push(t);if(0===n.length)throw new d("material has no properties with alpha components.");return this.add({startObject:{alpha:l(e.startValue,0)},stopObject:{alpha:l(e.stopValue,1)},duration:l(e.duration,3),delay:e.delay,easingFunction:e.easingFunction,update:function(e){for(var t=n.length,r=0;r<t;++r)i.uniforms[n[r]].alpha=e.alpha},complete:e.complete,cancel:e.cancel})},t.prototype.addOffsetIncrement=function(e){var t=(e=l(e,l.EMPTY_OBJECT)).material;if(!u(t))throw new d("material is required.");if(!u(t.uniforms.offset))throw new d("material.uniforms must have an offset property.");var r=t.uniforms;return this.addProperty({object:r,property:"offset",startValue:r.offset,stopValue:r.offset+1,duration:e.duration,delay:e.delay,easingFunction:e.easingFunction,update:e.update,cancel:e.cancel,_repeat:1/0})},t.prototype.remove=function(e){if(!u(e))return!1;var t=this._tweens.indexOf(e);return-1!==t&&(e.tweenjs.stop(),u(e.cancel)&&e.cancel(),this._tweens.splice(t,1),!0)},t.prototype.removeAll=function(){for(var e=this._tweens,t=0;t<e.length;++t){var r=e[t];r.tweenjs.stop(),u(r.cancel)&&r.cancel()}e.length=0},t.prototype.contains=function(e){return u(e)&&-1!==this._tweens.indexOf(e)},t.prototype.get=function(e){if(!u(e))throw new d("index is required.");return this._tweens[e]},t.prototype.update=function(e){var t=this._tweens,r=0;for(e=u(e)?e/p.SECONDS_PER_MILLISECOND:o();r<t.length;){var i=t[r],n=i.tweenjs;i.needsStart?(i.needsStart=!1,n.start(e)):n.update(e)?r++:(n.stop(),t.splice(r,1))}},t}),define("Scene/ScreenSpaceCameraController",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Ellipsoid","../Core/HeadingPitchRoll","../Core/IntersectionTests","../Core/isArray","../Core/KeyboardEventModifier","../Core/Math","../Core/Matrix3","../Core/Matrix4","../Core/OrthographicFrustum","../Core/Plane","../Core/Quaternion","../Core/Ray","../Core/Transforms","./CameraEventAggregator","./CameraEventType","./MapMode2D","./SceneMode","./SceneTransforms","./TweenCollection"],function(re,ie,e,r,b,ne,t,i,F,n,B,f,o,oe,U,V,ae,z,q,N,G,a,s,l,se,le,u){"use strict";function c(e){if(!ne(e))throw new i("scene is required.");this.enableInputs=!0,this.enableTranslate=!0,this.enableZoom=!0,this.enableRotate=!0,this.enableTilt=!0,this.enableLook=!0,this.inertiaSpin=.9,this.inertiaTranslate=.9,this.inertiaZoom=.8,this.maximumMovementRatio=.1,this.bounceAnimationTime=3,this.minimumZoomDistance=1,this.maximumZoomDistance=Number.POSITIVE_INFINITY,this.translateEventTypes=s.LEFT_DRAG,this.zoomEventTypes=[s.RIGHT_DRAG,s.WHEEL,s.PINCH],this.rotateEventTypes=s.LEFT_DRAG,this.tiltEventTypes=[s.MIDDLE_DRAG,s.PINCH,{eventType:s.LEFT_DRAG,modifier:o.CTRL},{eventType:s.RIGHT_DRAG,modifier:o.CTRL}],this.lookEventTypes={eventType:s.LEFT_DRAG,modifier:o.SHIFT},this.minimumPickingTerrainHeight=15e4,this._minimumPickingTerrainHeight=this.minimumPickingTerrainHeight,this.minimumCollisionTerrainHeight=15e3,this._minimumCollisionTerrainHeight=this.minimumCollisionTerrainHeight,this.minimumTrackBallHeight=75e5,this._minimumTrackBallHeight=this.minimumTrackBallHeight,this.enableCollisionDetection=!0,this._scene=e,this._globe=void 0,this._ellipsoid=void 0,this._aggregator=new a(e.canvas),this._lastInertiaSpinMovement=void 0,this._lastInertiaZoomMovement=void 0,this._lastInertiaTranslateMovement=void 0,this._lastInertiaTiltMovement=void 0,this._tweens=new u,this._tween=void 0,this._horizontalRotationAxis=void 0,this._tiltCenterMousePosition=new re(-1,-1),this._tiltCenter=new ie,this._rotateMousePosition=new re(-1,-1),this._rotateStartPosition=new ie,this._strafeStartPosition=new ie,this._zoomMouseStart=new re(-1,-1),this._zoomWorldPosition=new ie,this._useZoomWorldPosition=!1,this._tiltCVOffMap=!1,this._looking=!1,this._rotating=!1,this._strafing=!1,this._zoomingOnVector=!1,this._rotatingZoom=!1;var t=e.mapProjection;this._maxCoord=t.project(new r(Math.PI,oe.PI_OVER_TWO)),this._zoomFactor=5,this._rotateFactor=void 0,this._rotateRateRangeAdjustment=void 0,this._maximumRotateRate=1.77,this._minimumRotateRate=2e-4,this._minimumZoomRate=20,this._maximumZoomRate=5906376272e3}var g=.4;function m(e,t,r,i,n,o,a){var s=o[a];ne(s)||(s=o[a]={startPosition:new re,endPosition:new re,motion:new re,active:!1});var l,u=e.getButtonPressTime(t,r),c=e.getButtonReleaseTime(t,r),d=u&&c&&(c.getTime()-u.getTime())/1e3,h=new Date,p=c&&(h.getTime()-c.getTime())/1e3;if(u&&c&&d<g){var f=function(e,t){if(e<0)return 0;var r=25*(1-t);return Math.exp(-r*e)}(p,i);if(s.active)s.startPosition=re.clone(s.endPosition,s.startPosition),s.endPosition=re.multiplyByScalar(s.motion,f,s.endPosition),s.endPosition=re.add(s.startPosition,s.endPosition,s.endPosition),s.motion=re.clone(re.ZERO,s.motion);else{var m=e.getLastMovement(t,r);if(!ne(m)||(l=m,re.equalsEpsilon(l.startPosition,l.endPosition,oe.EPSILON14)))return;s.motion.x=.5*(m.endPosition.x-m.startPosition.x),s.motion.y=.5*(m.endPosition.y-m.startPosition.y),s.startPosition=re.clone(m.startPosition,s.startPosition),s.endPosition=re.multiplyByScalar(s.motion,f,s.endPosition),s.endPosition=re.add(s.startPosition,s.endPosition,s.endPosition),s.active=!0}if(isNaN(s.endPosition.x)||isNaN(s.endPosition.y)||re.distance(s.startPosition,s.endPosition)<.5)return void(s.active=!1);if(!e.isButtonDown(t,r))n(o,e.getStartMousePosition(t,r),s)}else s.active=!1}var _=[];function d(e,t,r,i,n,o){if(ne(r)){var a=e._aggregator;f(r)||(_[0]=r,r=_);for(var s=r.length,l=0;l<s;++l){var u=r[l],c=ne(u.eventType)?u.eventType:u,d=u.modifier,h=a.isMoving(c,d)&&a.getMovement(c,d),p=a.getStartMousePosition(c,d);e.enableInputs&&t&&(h?i(e,p,h):n<1&&m(a,c,d,n,i,e,o))}}}var ue=new N,ce=new ie,de=new re,he=new ie,pe=new re,fe=new ie,me=new ie,ge=new ie,_e=new ie,ve=new ie,ye=new ie,be=new ie,Ce=new ie,we=new ie,Se=new ie,Te=new ie,Ee=new ie,Ae=new ie,xe=new ie,Pe=new ie,De=new ie,Oe=new ie,Ie=new ie,Me={orientation:new n};function p(e,t,r,i,n,o){var a=1;ne(o)&&(a=oe.clamp(Math.abs(o),.25,1));var s=e.minimumZoomDistance*a,l=e.maximumZoomDistance,u=i*(n-s);u=oe.clamp(u,e._minimumZoomRate,e._maximumZoomRate);var c=(r.endPosition.y-r.startPosition.y)/e._scene.canvas.clientHeight,d=u*(c=Math.min(c,e.maximumMovementRatio));if(!(0<d&&Math.abs(n-s)<1||d<0&&Math.abs(n-l)<1)){n-d<s?d=n-s-1:l<n-d&&(d=n-l);var h=e._scene,p=h.camera,f=h.mode,m=Me.orientation;if(m.heading=p.heading,m.pitch=p.pitch,m.roll=p.roll,p.frustum instanceof ae)0<Math.abs(d)&&(p.zoomIn(d),p._adjustOrthographicFrustum());else{var g,_=re.equals(t,e._zoomMouseStart),v=e._zoomingOnVector,y=e._rotatingZoom;if(_||(e._zoomMouseStart=re.clone(t,e._zoomMouseStart),ne(e._globe)&&(g=f!==se.SCENE2D?Re(e,t,ce):p.getPickRay(t,ue).origin),ne(g)?(e._useZoomWorldPosition=!0,e._zoomWorldPosition=ie.clone(g,e._zoomWorldPosition)):e._useZoomWorldPosition=!1,v=e._zoomingOnVector=!1,y=e._rotatingZoom=!1),e._useZoomWorldPosition){var b=f===se.COLUMBUS_VIEW;if(p.positionCartographic.height<2e6&&(y=!0),!_||y){if(f===se.SCENE2D){var C=e._zoomWorldPosition,w=p.position;if(!ie.equals(C,w)&&p.positionCartographic.height<2*e._maxCoord.x){var S=p.position.x,T=ie.subtract(C,w,he);ie.normalize(T,T);var E=ie.distance(C,w)*d/(.5*p.getMagnitude());p.move(T,.5*E),(p.position.x<0&&0<S||0<p.position.x&&S<0)&&(g=p.getPickRay(t,ue).origin,e._zoomWorldPosition=ie.clone(g,e._zoomWorldPosition))}}else if(f===se.SCENE3D){var A=ie.normalize(p.position,ve);if(p.positionCartographic.height<3e3&&Math.abs(ie.dot(p.direction,A))<.6)b=!0;else{var x=h.canvas,P=pe;P.x=x.clientWidth/2,P.y=x.clientHeight/2;var D=Re(e,P,fe);if(ne(D)&&p.positionCartographic.height<1e6){var O=be;ie.clone(p.position,O);var I=e._zoomWorldPosition,M=ye;if(M=ie.normalize(I,M),ie.dot(M,A)<0)return;var R=Pe,L=Se;ie.clone(p.direction,L),ie.add(O,ie.multiplyByScalar(L,1e3,De),R);var N=Te,k=Ee;ie.subtract(I,O,N),ie.normalize(N,k);var F=ie.dot(A,k);if(0<=F)return void(e._zoomMouseStart.x=-1);var B=Math.acos(-F),U=ie.magnitude(O),V=ie.magnitude(I),z=U-d,q=ie.magnitude(N),G=Math.asin(oe.clamp(q/V*Math.sin(B),-1,1))-Math.asin(oe.clamp(z/V*Math.sin(B),-1,1))+B,W=Ce;ie.normalize(O,W);var H=we;H=ie.cross(k,W,H),H=ie.normalize(H,H),ie.normalize(ie.cross(W,H,De),L),ie.multiplyByScalar(ie.normalize(R,De),ie.magnitude(R)-d,R),ie.normalize(O,O),ie.multiplyByScalar(O,z,O);var j=Ae;ie.multiplyByScalar(ie.add(ie.multiplyByScalar(W,Math.cos(G)-1,Oe),ie.multiplyByScalar(L,Math.sin(G),Ie),De),z,j),ie.add(O,j,O),ie.normalize(R,W),ie.normalize(ie.cross(W,H,De),L);var Y=xe;return ie.multiplyByScalar(ie.add(ie.multiplyByScalar(W,Math.cos(G)-1,Oe),ie.multiplyByScalar(L,Math.sin(G),Ie),De),ie.magnitude(R),Y),ie.add(R,Y,R),ie.clone(O,p.position),ie.normalize(ie.subtract(R,O,De),p.direction),ie.clone(p.direction,p.direction),ie.cross(p.direction,p.up,p.right),ie.cross(p.right,p.direction,p.up),void p.setView(Me)}if(ne(D)){var X=ie.normalize(D,me),Q=ie.normalize(e._zoomWorldPosition,ge),Z=ie.dot(Q,X);if(0<Z&&Z<1){var K=oe.acosClamped(Z),J=ie.cross(Q,X,_e),$=d/(Math.abs(K)>oe.toRadians(20)?.75*p.positionCartographic.height:p.positionCartographic.height-d);p.rotate(J,K*$)}}else b=!0}}e._rotatingZoom=!b}if(!_&&b||v){var ee=le.wgs84ToWindowCoordinates(h,e._zoomWorldPosition,de),te=(f!==se.COLUMBUS_VIEW&&re.equals(t,e._zoomMouseStart)&&ne(ee)?p.getPickRay(ee,ue):p.getPickRay(t,ue)).direction;f===se.COLUMBUS_VIEW&&ie.fromElements(te.y,te.z,te.x,te),p.move(te,d),e._zoomingOnVector=!0}else p.zoomIn(d);p.setView(Me)}else p.zoomIn(d)}}}var h=new N,v=new N,y=new ie;function C(e,t,r){var i=e._scene.camera,n=i.getPickRay(r.startPosition,h).origin,o=i.getPickRay(r.endPosition,v).origin,a=ie.subtract(n,o,y),s=ie.magnitude(a);0<s&&(ie.normalize(a,a),i.move(a,s))}function w(e,t,r){ne(r.distance)&&(r=r.distance);var i=e._scene.camera;p(e,t,r,e._zoomFactor,i.getMagnitude())}var S=new re,T=new re;function E(e,t,r){if(ne(r.angleAndHeight))!function(e,t,r){var i=e._rotateFactor*e._rotateRateRangeAdjustment;i>e._maximumRotateRate&&(i=e._maximumRotateRate);i<e._minimumRotateRate&&(i=e._minimumRotateRate);var n=e._scene,o=n.camera,a=n.canvas,s=(r.endPosition.x-r.startPosition.x)/a.clientWidth;s=Math.min(s,e.maximumMovementRatio);var l=i*s*Math.PI*4;o.twistRight(l)}(e,0,r.angleAndHeight);else{var i=e._scene,n=i.camera,o=i.canvas,a=o.clientWidth,s=o.clientHeight,l=S;l.x=2/a*r.startPosition.x-1,l.y=2/s*(s-r.startPosition.y)-1,l=re.normalize(l,l);var u=T;u.x=2/a*r.endPosition.x-1,u.y=2/s*(s-r.endPosition.y)-1,u=re.normalize(u,u);var c=oe.acosClamped(l.x);l.y<0&&(c=oe.TWO_PI-c);var d=oe.acosClamped(u.x);u.y<0&&(d=oe.TWO_PI-d);var h=d-c;n.twistRight(h)}}var A=new N,x=new ie,P=new ie;function Re(e,t,r){var i=e._scene,n=e._globe,o=i.camera;if(ne(n)){var a;i.pickPositionSupported&&(a=i.pickPositionWorldCoordinates(t,x));var s=o.getPickRay(t,A),l=n.pick(s,i,P);return(ne(a)?ie.distance(a,o.positionWC):Number.POSITIVE_INFINITY)<(ne(l)?ie.distance(l,o.positionWC):Number.POSITIVE_INFINITY)?ie.clone(a,r):ie.clone(l,r)}}var D=new N,O=new N,I=new ie,M=new ie,R=new ie,L=new ie,k=new z(ie.UNIT_X,0),W=new re,H=new re;function j(e,t,r){if(ie.equals(t,e._translateMousePosition)||(e._looking=!1),ie.equals(t,e._strafeMousePosition)||(e._strafing=!1),e._looking)Lt(e,t,r);else if(e._strafing)Qe(e,t,r);else{var i,n=e._scene.camera,o=re.clone(r.startPosition,W),a=re.clone(r.endPosition,H),s=n.getPickRay(o,D),l=ie.clone(ie.ZERO,L),u=ie.UNIT_X;if(n.position.z<e._minimumPickingTerrainHeight&&(i=Re(e,o,I),ne(i)&&(l.x=i.x)),l.x>n.position.z&&ne(i))return ie.clone(i,e._strafeStartPosition),e._strafing=!0,Qe(e,t,r),void(e._strafeMousePosition=re.clone(t,e._strafeMousePosition));var c=z.fromPointNormal(l,u,k);s=n.getPickRay(o,D);var d=B.rayPlane(s,c,I),h=n.getPickRay(a,O),p=B.rayPlane(h,c,M);if(!ne(d)||!ne(p))return e._looking=!0,Lt(e,t,r),void re.clone(t,e._translateMousePosition);var f=ie.subtract(d,p,R),m=f.x;f.x=f.y,f.y=f.z,f.z=m;var g=ie.magnitude(f);g>oe.EPSILON6&&(ie.normalize(f,f),n.move(f,g))}}var Y=new re,X=new N,Q=new ie,Z=new ie,K=new V,J=new V,$=new ie,ee=new z(ie.UNIT_X,0),te=new ie,Le=new r,Ne=new V,ke=new q,Fe=new U,Be=new ie;function Ue(e,t,r){if(ne(r.angleAndHeight)&&(r=r.angleAndHeight),re.equals(t,e._tiltCenterMousePosition)||(e._tiltCVOffMap=!1,e._looking=!1),e._looking)Lt(e,t,r);else{var i=e._scene.camera,n=e._maxCoord,o=Math.abs(i.position.x)-n.x<0&&Math.abs(i.position.y)-n.y<0;e._tiltCVOffMap||!o||i.position.z>e._minimumPickingTerrainHeight?(e._tiltCVOffMap=!0,function(e,t,r){var i=e._scene,n=i.camera,o=i.canvas,a=Y;a.x=o.clientWidth/2,a.y=o.clientHeight/2;var s,l=n.getPickRay(a,X),u=ie.UNIT_X,c=l.origin,d=l.direction,h=ie.dot(u,d);Math.abs(h)>oe.EPSILON6&&(s=-ie.dot(u,c)/h);if(!ne(s)||s<=0)return e._looking=!0,Lt(e,t,r),re.clone(t,e._tiltCenterMousePosition);var p=ie.multiplyByScalar(d,s,Q);ie.add(c,p,p);var f=i.mapProjection,m=f.ellipsoid;ie.fromElements(p.y,p.z,p.x,p);var g=f.unproject(p,Le);m.cartographicToCartesian(g,p);var _=G.eastNorthUpToFixedFrame(p,m,K),v=e._globe,y=e._ellipsoid;e._globe=void 0,e._ellipsoid=F.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;var b=V.clone(n.transform,Ne);n._setTransform(_),rt(e,t,r,ie.UNIT_Z),n._setTransform(b),e._globe=v;var C=(e._ellipsoid=y).maximumRadius;e._rotateFactor=1/C,e._rotateRateRangeAdjustment=C}(e,t,r)):function(e,t,r){var i,n,o=e._scene,a=o.camera,s=ie.UNIT_X;if(re.equals(t,e._tiltCenterMousePosition))i=ie.clone(e._tiltCenter,Q);else{if(a.position.z<e._minimumPickingTerrainHeight&&(i=Re(e,t,Q)),!ne(i)){var l,u=(n=a.getPickRay(t,X)).origin,c=n.direction,d=ie.dot(s,c);if(Math.abs(d)>oe.EPSILON6&&(l=-ie.dot(s,u)/d),!ne(l)||l<=0)return e._looking=!0,Lt(e,t,r),re.clone(t,e._tiltCenterMousePosition);i=ie.multiplyByScalar(c,l,Q),ie.add(u,i,i)}re.clone(t,e._tiltCenterMousePosition),ie.clone(i,e._tiltCenter)}var h=o.canvas,p=Y;p.x=h.clientWidth/2,p.y=e._tiltCenterMousePosition.y,n=a.getPickRay(p,X);var f=ie.clone(ie.ZERO,$);f.x=i.x;var m=z.fromPointNormal(f,s,ee),g=B.rayPlane(n,m,Z),_=a._projection,v=_.ellipsoid;ie.fromElements(i.y,i.z,i.x,i);var y=_.unproject(i,Le);v.cartographicToCartesian(y,i);var b,C=G.eastNorthUpToFixedFrame(i,v,K);b=ne(g)?(ie.fromElements(g.y,g.z,g.x,g),y=_.unproject(g,Le),v.cartographicToCartesian(y,g),G.eastNorthUpToFixedFrame(g,v,J)):C;var w=e._globe,S=e._ellipsoid;e._globe=void 0,e._ellipsoid=F.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;var T=ie.UNIT_Z,E=V.clone(a.transform,Ne);a._setTransform(C);var A=ie.cross(ie.UNIT_Z,ie.normalize(a.position,te),te),x=ie.dot(a.right,A);if(rt(e,t,r,T,!1,!0),a._setTransform(b),x<0){r.startPosition.y>r.endPosition.y&&(T=void 0);var P=a.constrainedAxis;a.constrainedAxis=void 0,rt(e,t,r,T,!0,!1),a.constrainedAxis=P}else rt(e,t,r,T,!0,!1);if(ne(a.constrainedAxis)){var D=ie.cross(a.direction,a.constrainedAxis,Be);ie.equalsEpsilon(D,ie.ZERO,oe.EPSILON6)||(ie.dot(D,a.right)<0&&ie.negate(D,D),ie.cross(D,a.direction,a.up),ie.cross(a.direction,a.up,a.right),ie.normalize(a.up,a.up),ie.normalize(a.right,a.right))}a._setTransform(E),e._globe=w;var O=(e._ellipsoid=S).maximumRadius;e._rotateFactor=1/O,e._rotateRateRangeAdjustment=O;var I=ie.clone(a.positionWC,te);if(a._adjustHeightForTerrain(),!ie.equals(a.positionWC,I)){a._setTransform(b),a.worldToCameraCoordinatesPoint(I,I);var M=ie.magnitudeSquared(I);ie.magnitudeSquared(a.position)>M&&(ie.normalize(a.position,a.position),ie.multiplyByScalar(a.position,Math.sqrt(M),a.position));var R=ie.angleBetween(I,a.position),L=ie.cross(I,a.position,I);ie.normalize(L,L);var N=q.fromAxisAngle(L,R,ke),k=U.fromQuaternion(N,Fe);U.multiplyByVector(k,a.direction,a.direction),U.multiplyByVector(k,a.up,a.up),ie.cross(a.direction,a.up,a.right),ie.cross(a.right,a.direction,a.up),a._setTransform(E)}}(e,t,r)}}var Ve=new re,ze=new N,qe=new ie;function Ge(e,t,r){ne(r.distance)&&(r=r.distance);var i=e._scene,n=i.camera,o=i.canvas,a=Ve;a.x=o.clientWidth/2,a.y=o.clientHeight/2;var s,l,u=n.getPickRay(a,ze);if(n.position.z<e._minimumPickingTerrainHeight&&(s=Re(e,a,qe)),ne(s))l=ie.distance(u.origin,s);else{var c=ie.UNIT_X,d=u.origin,h=u.direction;l=-ie.dot(c,d)/ie.dot(c,h)}p(e,t,r,e._zoomFactor,l)}var We=new N,He=new z(ie.UNIT_X,0),je=new ie,Ye=new ie,Xe=new ie;function Qe(e,t,r){var i=e._scene,n=i.camera,o=Re(e,r.startPosition,Xe);if(ne(o)){var a=r.endPosition,s=n.getPickRay(a,We),l=ie.clone(n.direction,Ye);i.mode===se.COLUMBUS_VIEW&&ie.fromElements(l.z,l.x,l.y,l);var u=z.fromPointNormal(o,l,He),c=B.rayPlane(s,u,je);ne(c)&&(l=ie.subtract(o,c,l),i.mode===se.COLUMBUS_VIEW&&ie.fromElements(l.y,l.z,l.x,l),ie.add(n.position,l,n.position))}}var Ze=new ie,Ke=new r,Je=new ie,$e=new F,et=new ie;function tt(e,t,r){var i=e._scene.camera;if(V.equals(i.transform,V.IDENTITY)){var n,o,a,s=e._ellipsoid.geodeticSurfaceNormal(i.position,et),l=e._ellipsoid.cartesianToCartographic(i.positionWC,Ke).height,u=e._globe;if(ne(u)&&l<e._minimumPickingTerrainHeight&&(a=Re(e,r.startPosition,Xe),ne(a))){var c=i.getPickRay(r.startPosition,A),d=e._ellipsoid.geodeticSurfaceNormal(a);Math.abs(ie.dot(c.direction,d))<.05&&!e._looking&&(e._rotating=!1,e._strafing=!0)}re.equals(t,e._rotateMousePosition)?e._looking?Lt(e,t,r,s):e._rotating?rt(e,t,r):e._strafing?(ie.clone(a,e._strafeStartPosition),Qe(e,0,r)):(n=ie.magnitude(e._rotateStartPosition),(o=Je).x=o.y=o.z=n,dt(e,t,r,F.fromCartesian3(o,$e))):(e._looking=!1,e._rotating=!1,e._strafing=!1,ne(u)&&l<e._minimumPickingTerrainHeight?ne(a)?ie.magnitude(i.position)<ie.magnitude(a)?(ie.clone(a,e._strafeStartPosition),e._strafing=!0,Qe(e,0,r)):(n=ie.magnitude(a),(o=Je).x=o.y=o.z=n,dt(e,t,r,F.fromCartesian3(o,$e)),ie.clone(a,e._rotateStartPosition)):(e._looking=!0,Lt(e,t,r,s)):ne(i.pickEllipsoid(r.startPosition,e._ellipsoid,Ze))?(dt(e,t,r,e._ellipsoid),ie.clone(Ze,e._rotateStartPosition)):l>e._minimumTrackBallHeight?(e._rotating=!0,rt(e,t,r)):(e._looking=!0,Lt(e,t,r,s)),re.clone(t,e._rotateMousePosition))}else rt(e,t,r)}function rt(e,t,r,i,n,o){n=b(n,!1),o=b(o,!1);var a=e._scene,s=a.camera,l=a.canvas,u=s.constrainedAxis;ne(i)&&(s.constrainedAxis=i);var c=ie.magnitude(s.position),d=e._rotateFactor*(c-e._rotateRateRangeAdjustment);d>e._maximumRotateRate&&(d=e._maximumRotateRate),d<e._minimumRotateRate&&(d=e._minimumRotateRate);var h=(r.startPosition.x-r.endPosition.x)/l.clientWidth,p=(r.startPosition.y-r.endPosition.y)/l.clientHeight;h=Math.min(h,e.maximumMovementRatio),p=Math.min(p,e.maximumMovementRatio);var f=d*h*Math.PI*2,m=d*p*Math.PI;n||s.rotateRight(f),o||s.rotateUp(m),s.constrainedAxis=u}var it=e.clone(e.UNIT_W),nt=e.clone(e.UNIT_W),ot=new ie,at=new ie,st=new ie,lt=new ie,ut=new re,ct=new re;function dt(e,t,r,i){var n=e._scene.camera,o=re.clone(r.startPosition,ut),a=re.clone(r.endPosition,ct),s=n.pickEllipsoid(o,i,it),l=n.pickEllipsoid(a,i,nt);if(!ne(s)||!ne(l))return e._rotating=!0,void rt(e,0,r);if(s=n.worldToCameraCoordinates(s,s),l=n.worldToCameraCoordinates(l,l),ne(n.constrainedAxis)){var u=n.constrainedAxis,c=ie.mostOrthogonalAxis(u,ot);ie.cross(c,u,c),ie.normalize(c,c);var d=ie.cross(u,c,at),h=ie.magnitude(s),p=ie.dot(u,s),f=Math.acos(p/h),m=ie.multiplyByScalar(u,p,st);ie.subtract(s,m,m),ie.normalize(m,m);var g=ie.magnitude(l),_=ie.dot(u,l),v=Math.acos(_/g),y=ie.multiplyByScalar(u,_,lt);ie.subtract(l,y,y),ie.normalize(y,y);var b=Math.acos(ie.dot(m,c));ie.dot(m,d)<0&&(b=oe.TWO_PI-b);var C=Math.acos(ie.dot(y,c));ie.dot(y,d)<0&&(C=oe.TWO_PI-C);var w,S=b-C;w=ie.equalsEpsilon(u,n.position,oe.EPSILON2)?n.right:ie.cross(u,n.position,ot);var T,E=ie.cross(u,w,ot),A=ie.dot(E,ie.subtract(s,u,at)),x=ie.dot(E,ie.subtract(l,u,at));T=0<A&&0<x?v-f:0<A&&x<=0?0<ie.dot(n.position,u)?-f-v:f+v:f-v,n.rotateRight(S),n.rotateUp(T)}else{ie.normalize(s,s),ie.normalize(l,l);var P=ie.dot(s,l),D=ie.cross(s,l,ot);if(P<1&&!ie.equalsEpsilon(D,ie.ZERO,oe.EPSILON14)){var O=Math.acos(P);n.rotate(D,O)}}}var ht=new ie,pt=new r;function ft(e,t,r){ne(r.distance)&&(r=r.distance);var i=e._ellipsoid,n=e._scene,o=n.camera,a=n.canvas,s=Ve;s.x=a.clientWidth/2,s.y=a.clientHeight/2;var l,u,c=o.getPickRay(s,ze),d=i.cartesianToCartographic(o.position,pt).height;d<e._minimumPickingTerrainHeight&&(l=Re(e,s,qe)),u=ne(l)?ie.distance(c.origin,l):d;var h=ie.normalize(o.position,ht);p(e,t,r,e._zoomFactor,u,ie.dot(h,o.direction))}var mt=new re,gt=new N,_t=new ie,vt=new ie,yt=new V,bt=new V,Ct=new V,wt=new q,St=new U,Tt=new r,Et=new ie;function At(e,t,r){var i=e._scene.camera;if(V.equals(i.transform,V.IDENTITY))if(ne(r.angleAndHeight)&&(r=r.angleAndHeight),re.equals(t,e._tiltCenterMousePosition)||(e._tiltOnEllipsoid=!1,e._looking=!1),e._looking){Lt(e,t,r,e._ellipsoid.geodeticSurfaceNormal(i.position,Et))}else{var n=e._ellipsoid.cartesianToCartographic(i.position,Tt);e._tiltOnEllipsoid||n.height>e._minimumCollisionTerrainHeight?(e._tiltOnEllipsoid=!0,function(e,t,r){var i=e._ellipsoid,n=e._scene,o=n.camera,a=.25*e.minimumZoomDistance,s=i.cartesianToCartographic(o.positionWC,xt).height;if(s-a-1<oe.EPSILON3&&r.endPosition.y-r.startPosition.y<0)return;var l=n.canvas,u=mt;u.x=l.clientWidth/2,u.y=l.clientHeight/2;var c,d=o.getPickRay(u,gt),h=B.rayEllipsoid(d,i);if(ne(h))c=N.getPoint(d,h.start,_t);else{if(!(s>e._minimumTrackBallHeight)){e._looking=!0;var p=e._ellipsoid.geodeticSurfaceNormal(o.position,Et);return Lt(e,t,r,p),re.clone(t,e._tiltCenterMousePosition)}var f=B.grazingAltitudeLocation(d,i);if(!ne(f))return;var m=i.cartesianToCartographic(f,Tt);m.height=0,c=i.cartographicToCartesian(m,_t)}var g=G.eastNorthUpToFixedFrame(c,i,yt),_=e._globe,v=e._ellipsoid;e._globe=void 0,e._ellipsoid=F.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;var y=V.clone(o.transform,Ct);o._setTransform(g),rt(e,0,r,ie.UNIT_Z),o._setTransform(y),e._globe=_;var b=(e._ellipsoid=v).maximumRadius;e._rotateFactor=1/b,e._rotateRateRangeAdjustment=b}(e,t,r)):function(e,t,r){var i,n,o,a=e._ellipsoid,s=e._scene,l=s.camera;if(re.equals(t,e._tiltCenterMousePosition))i=ie.clone(e._tiltCenter,_t);else{if(i=Re(e,t,_t),!ne(i)){if(n=l.getPickRay(t,gt),o=B.rayEllipsoid(n,a),!ne(o)){var u=a.cartesianToCartographic(l.position,Tt);if(u.height<=e._minimumTrackBallHeight){e._looking=!0;var c=e._ellipsoid.geodeticSurfaceNormal(l.position,Et);Lt(e,t,r,c),re.clone(t,e._tiltCenterMousePosition)}return}i=N.getPoint(n,o.start,_t)}re.clone(t,e._tiltCenterMousePosition),ie.clone(i,e._tiltCenter)}var d=s.canvas,h=mt;h.x=d.clientWidth/2,h.y=e._tiltCenterMousePosition.y,n=l.getPickRay(h,gt);var p=ie.magnitude(i),f=ie.fromElements(p,p,p,Je),m=F.fromCartesian3(f,$e);if(o=B.rayEllipsoid(n,m),!ne(o))return;var g=ie.magnitude(n.origin)>p?o.start:o.stop,_=N.getPoint(n,g,vt),v=G.eastNorthUpToFixedFrame(i,a,yt),y=G.eastNorthUpToFixedFrame(_,m,bt),b=e._globe,C=e._ellipsoid;e._globe=void 0,e._ellipsoid=F.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;var w=ie.UNIT_Z,S=V.clone(l.transform,Ct);l._setTransform(v);var T=ie.cross(_,l.positionWC,Be),E=ie.dot(l.rightWC,T);if(rt(e,0,r,w,!1,!0),l._setTransform(y),E<0){r.startPosition.y>r.endPosition.y&&(w=void 0);var A=l.constrainedAxis;l.constrainedAxis=void 0,rt(e,0,r,w,!0,!1),l.constrainedAxis=A}else rt(e,0,r,w,!0,!1);if(ne(l.constrainedAxis)){var x=ie.cross(l.direction,l.constrainedAxis,Be);ie.equalsEpsilon(x,ie.ZERO,oe.EPSILON6)||(ie.dot(x,l.right)<0&&ie.negate(x,x),ie.cross(x,l.direction,l.up),ie.cross(l.direction,l.up,l.right),ie.normalize(l.up,l.up),ie.normalize(l.right,l.right))}l._setTransform(S),e._globe=b;var P=(e._ellipsoid=C).maximumRadius;e._rotateFactor=1/P,e._rotateRateRangeAdjustment=P;var D=ie.clone(l.positionWC,Be);if(l._adjustHeightForTerrain(),!ie.equals(l.positionWC,D)){l._setTransform(y),l.worldToCameraCoordinatesPoint(D,D);var O=ie.magnitudeSquared(D);ie.magnitudeSquared(l.position)>O&&(ie.normalize(l.position,l.position),ie.multiplyByScalar(l.position,Math.sqrt(O),l.position));var I=ie.angleBetween(D,l.position),M=ie.cross(D,l.position,D);ie.normalize(M,M);var R=q.fromAxisAngle(M,I,wt),L=U.fromQuaternion(R,St);U.multiplyByVector(L,l.direction,l.direction),U.multiplyByVector(L,l.up,l.up),ie.cross(l.direction,l.up,l.right),ie.cross(l.right,l.direction,l.up),l._setTransform(S)}}(e,t,r)}}var xt=new r;var Pt=new re,Dt=new re,Ot=new N,It=new N,Mt=new ie,Rt=new ie;function Lt(e,t,r,i){var n=e._scene.camera,o=Pt;o.x=r.startPosition.x,o.y=0;var a=Dt;a.x=r.endPosition.x,a.y=0;var s,l,u=n.getPickRay(o,Ot),c=n.getPickRay(a,It),d=0;n.frustum instanceof ae?(s=u.origin,l=c.origin,ie.add(n.direction,s,s),ie.add(n.direction,l,l),ie.subtract(s,n.position,s),ie.subtract(l,n.position,l),ie.normalize(s,s),ie.normalize(l,l)):(s=u.direction,l=c.direction);var h=ie.dot(s,l);h<1&&(d=Math.acos(h)),d=r.startPosition.x>r.endPosition.x?-d:d;var p=e._horizontalRotationAxis;if(ne(i)?n.look(i,-d):ne(p)?n.look(p,-d):n.lookLeft(d),o.x=0,o.y=r.startPosition.y,a.x=0,a.y=r.endPosition.y,u=n.getPickRay(o,Ot),c=n.getPickRay(a,It),d=0,n.frustum instanceof ae?(s=u.origin,l=c.origin,ie.add(n.direction,s,s),ie.add(n.direction,l,l),ie.subtract(s,n.position,s),ie.subtract(l,n.position,l),ie.normalize(s,s),ie.normalize(l,l)):(s=u.direction,l=c.direction),(h=ie.dot(s,l))<1&&(d=Math.acos(h)),d=r.startPosition.y>r.endPosition.y?-d:d,i=b(i,p),ne(i)){var f=n.direction,m=ie.negate(i,Mt),g=ie.equalsEpsilon(f,i,oe.EPSILON2),_=ie.equalsEpsilon(f,m,oe.EPSILON2);if(g||_)(g&&d<0||_&&0<d)&&n.look(n.right,-d);else{h=ie.dot(f,i);var v=oe.acosClamped(h);0<d&&v<d&&(d=v-oe.EPSILON4),h=ie.dot(f,m),v=oe.acosClamped(h),d<0&&v<-d&&(d=-v+oe.EPSILON4);var y=ie.cross(i,f,Rt);n.look(y,d)}}else n.lookUp(d)}return c.prototype.update=function(){V.equals(this._scene.camera.transform,V.IDENTITY)?(this._globe=this._scene.globe,this._ellipsoid=ne(this._globe)?this._globe.ellipsoid:this._scene.mapProjection.ellipsoid):(this._globe=void 0,this._ellipsoid=F.UNIT_SPHERE),this._minimumCollisionTerrainHeight=this.minimumCollisionTerrainHeight*this._scene.terrainExaggeration,this._minimumPickingTerrainHeight=this.minimumPickingTerrainHeight*this._scene.terrainExaggeration,this._minimumTrackBallHeight=this.minimumTrackBallHeight*this._scene.terrainExaggeration;var e=this._ellipsoid.maximumRadius;this._rotateFactor=1/e,this._rotateRateRangeAdjustment=e;var t,r,i,n=this._scene.mode;n===se.SCENE2D?(i=(r=this)._scene.mapMode2D===l.ROTATE,V.equals(V.IDENTITY,r._scene.camera.transform)?(d(r,r.enableTranslate,r.translateEventTypes,C,r.inertiaTranslate,"_lastInertiaTranslateMovement"),d(r,r.enableZoom,r.zoomEventTypes,w,r.inertiaZoom,"_lastInertiaZoomMovement"),i&&d(r,r.enableRotate,r.tiltEventTypes,E,r.inertiaSpin,"_lastInertiaTiltMovement")):(d(r,r.enableZoom,r.zoomEventTypes,w,r.inertiaZoom,"_lastInertiaZoomMovement"),i&&d(r,r.enableRotate,r.translateEventTypes,E,r.inertiaSpin,"_lastInertiaSpinMovement"))):n===se.COLUMBUS_VIEW?(this._horizontalRotationAxis=ie.UNIT_Z,function(e){var t=e._scene.camera;if(V.equals(V.IDENTITY,t.transform)){var r=e._tweens;if(e._aggregator.anyButtonDown&&r.removeAll(),d(e,e.enableTilt,e.tiltEventTypes,Ue,e.inertiaSpin,"_lastInertiaTiltMovement"),d(e,e.enableTranslate,e.translateEventTypes,j,e.inertiaTranslate,"_lastInertiaTranslateMovement"),d(e,e.enableZoom,e.zoomEventTypes,Ge,e.inertiaZoom,"_lastInertiaZoomMovement"),d(e,e.enableLook,e.lookEventTypes,Lt),!(e._aggregator.anyButtonDown||ne(e._lastInertiaZoomMovement)&&e._lastInertiaZoomMovement.active||ne(e._lastInertiaTranslateMovement)&&e._lastInertiaTranslateMovement.active||r.contains(e._tween))){var i=t.createCorrectPositionTween(e.bounceAnimationTime);ne(i)&&(e._tween=r.add(i))}r.update()}else d(e,e.enableRotate,e.rotateEventTypes,rt,e.inertiaSpin,"_lastInertiaSpinMovement"),d(e,e.enableZoom,e.zoomEventTypes,ft,e.inertiaZoom,"_lastInertiaZoomMovement")}(this)):n===se.SCENE3D&&(this._horizontalRotationAxis=void 0,d(t=this,t.enableRotate,t.rotateEventTypes,tt,t.inertiaSpin,"_lastInertiaSpinMovement"),d(t,t.enableZoom,t.zoomEventTypes,ft,t.inertiaZoom,"_lastInertiaZoomMovement"),d(t,t.enableTilt,t.tiltEventTypes,At,t.inertiaSpin,"_lastInertiaTiltMovement"),d(t,t.enableLook,t.lookEventTypes,Lt)),this._aggregator.reset()},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){return this._tweens.removeAll(),this._aggregator=this._aggregator&&this._aggregator.destroy(),t(this)},c}),define("Scene/ShadowMapShader",["../Core/defined","../Renderer/ShaderSource"],function(w,S){"use strict";function e(){}return e.getShadowCastShaderKeyword=function(e,t,r,i){return"castShadow "+e+" "+t+" "+r+" "+i},e.createShadowCastVertexShader=function(e,t,r){var i=e.defines.slice(0),n=e.sources.slice(0);r&&i.push("GENERATE_POSITION");var o=S.findPositionVarying(e),a=w(o);if(t&&!a){for(var s=n.length,l=0;l<s;++l)n[l]=S.replaceMain(n[l],"czm_shadow_cast_main");n.push("varying vec3 v_positionEC; \nvoid main() \n{ \n    czm_shadow_cast_main(); \n    v_positionEC = (czm_inverseProjection * gl_Position).xyz; \n}")}return new S({defines:i,sources:n})},e.createShadowCastFragmentShader=function(e,t,r,i){var n=e.defines.slice(0),o=e.sources.slice(0),a=S.findPositionVarying(e),s=w(a);s||(a="v_positionEC");for(var l=o.length,u=0;u<l;++u)o[u]=S.replaceMain(o[u],"czm_shadow_cast_main");var c="";return t&&(s||(c+="varying vec3 v_positionEC; \n"),c+="uniform vec4 shadowMap_lightPositionEC; \n"),c+=i?"void main() \n{ \n":"void main() \n{ \n    czm_shadow_cast_main(); \n    if (gl_FragColor.a == 0.0) \n    { \n       discard; \n    } \n",c+=t?"    float distance = length("+a+"); \n    if (distance >= shadowMap_lightPositionEC.w) \n    { \n        discard; \n    } \n    distance /= shadowMap_lightPositionEC.w; // radius \n    gl_FragColor = czm_packDepth(distance); \n":r?"    gl_FragColor = vec4(1.0); \n":"    gl_FragColor = czm_packDepth(gl_FragCoord.z); \n",c+="} \n",o.push(c),new S({defines:n,sources:o})},e.getShadowReceiveShaderKeyword=function(e,t,r,i){return"receiveShadow "+e._usesDepthTexture+e._polygonOffsetSupported+e._isPointLight+e._isSpotLight+(1<e._numberOfCascades)+e.debugCascadeColors+e.softShadows+t+r+i},e.createShadowReceiveVertexShader=function(e,t,r){var i=e.defines.slice(0),n=e.sources.slice(0);return t&&(r?i.push("GENERATE_POSITION_AND_NORMAL"):i.push("GENERATE_POSITION")),new S({defines:i,sources:n})},e.createShadowReceiveFragmentShader=function(e,t,r,i,n){for(var o=S.findNormalVarying(e),a=!i&&w(o)||i&&n,s=S.findPositionVarying(e),l=w(s),u=t._usesDepthTexture,c=t._polygonOffsetSupported,d=t._isPointLight,h=t._isSpotLight,p=1<t._numberOfCascades,f=t.debugCascadeColors,m=t.softShadows,g=d?t._pointBias:i?t._terrainBias:t._primitiveBias,_=e.defines.slice(0),v=e.sources.slice(0),y=v.length,b=0;b<y;++b)v[b]=S.replaceMain(v[b],"czm_shadow_receive_main");d?_.push("USE_CUBE_MAP_SHADOW"):u&&_.push("USE_SHADOW_DEPTH_TEXTURE"),m&&!d&&_.push("USE_SOFT_SHADOWS"),p&&r&&i&&(a?_.push("ENABLE_VERTEX_LIGHTING"):_.push("ENABLE_DAYNIGHT_SHADING")),r&&g.normalShading&&a&&(_.push("USE_NORMAL_SHADING"),0<g.normalShadingSmooth&&_.push("USE_NORMAL_SHADING_SMOOTH"));var C="";return C+=d?"uniform samplerCube shadowMap_textureCube; \n":"uniform sampler2D shadowMap_texture; \n",C+="uniform mat4 shadowMap_matrix; \nuniform vec3 shadowMap_lightDirectionEC; \nuniform vec4 shadowMap_lightPositionEC; \nuniform vec4 shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness; \nuniform vec4 shadowMap_texelSizeDepthBiasAndNormalShadingSmooth; \nvec4 getPositionEC() \n{ \n"+(l?"    return vec4("+s+", 1.0); \n":"    return czm_windowToEyeCoordinates(gl_FragCoord); \n")+"} \nvec3 getNormalEC() \n{ \n"+(a?"    return normalize("+o+"); \n":"    return vec3(1.0); \n")+"} \nvoid applyNormalOffset(inout vec4 positionEC, vec3 normalEC, float nDotL) \n{ \n"+(g.normalOffset&&a?"    float normalOffset = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.x; \n    float normalOffsetScale = 1.0 - nDotL; \n    vec3 offset = normalOffset * normalOffsetScale * normalEC; \n    positionEC.xyz += offset; \n":"")+"} \n",C+="void main() \n{ \n    czm_shadow_receive_main(); \n    vec4 positionEC = getPositionEC(); \n    vec3 normalEC = getNormalEC(); \n    float depth = -positionEC.z; \n",C+="    czm_shadowParameters shadowParameters; \n    shadowParameters.texelStepSize = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.xy; \n    shadowParameters.depthBias = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.z; \n    shadowParameters.normalShadingSmooth = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.w; \n    shadowParameters.darkness = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.w; \n",i?C+="    shadowParameters.depthBias *= max(depth * 0.01, 1.0); \n":c||(C+="    shadowParameters.depthBias *= mix(1.0, 100.0, depth * 0.0015); \n"),C+=d?"    vec3 directionEC = positionEC.xyz - shadowMap_lightPositionEC.xyz; \n    float distance = length(directionEC); \n    directionEC = normalize(directionEC); \n    float radius = shadowMap_lightPositionEC.w; \n    // Stop early if the fragment is beyond the point light radius \n    if (distance > radius) \n    { \n        return; \n    } \n    vec3 directionWC  = czm_inverseViewRotation * directionEC; \n    shadowParameters.depth = distance / radius; \n    shadowParameters.nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    shadowParameters.texCoords = directionWC; \n    float visibility = czm_shadowVisibility(shadowMap_textureCube, shadowParameters); \n":h?"    vec3 directionEC = normalize(positionEC.xyz - shadowMap_lightPositionEC.xyz); \n    float nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Spot light uses a perspective projection, so perform the perspective divide \n    shadowPosition /= shadowPosition.w; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n":p?"    float maxDepth = shadowMap_cascadeSplits[1].w; \n    // Stop early if the eye depth exceeds the last cascade \n    if (depth > maxDepth) \n    { \n        return; \n    } \n    // Get the cascade based on the eye-space depth \n    vec4 weights = czm_cascadeWeights(depth); \n    // Apply normal offset \n    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    // Transform position into the cascade \n    vec4 shadowPosition = czm_cascadeMatrix(weights) * positionEC; \n    // Get visibility \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n    // Fade out shadows that are far away \n    float shadowMapMaximumDistance = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.z; \n    float fade = max((depth - shadowMapMaximumDistance * 0.8) / (shadowMapMaximumDistance * 0.2), 0.0); \n    visibility = mix(visibility, 1.0, fade); \n"+(f?"    // Draw cascade colors for debugging \n    gl_FragColor *= czm_cascadeColor(weights); \n":""):"    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n",C+="    gl_FragColor.rgb *= visibility; \n} \n",v.push(C),new S({defines:_,sources:v})},e}),define("Scene/ShadowMap",["../Core/BoundingRectangle","../Core/BoundingSphere","../Core/BoxOutlineGeometry","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/clone","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/combine","../Core/CullingVolume","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/FeatureDetection","../Core/GeometryInstance","../Core/Intersect","../Core/Math","../Core/Matrix4","../Core/OrthographicOffCenterFrustum","../Core/PerspectiveFrustum","../Core/PixelFormat","../Core/Quaternion","../Core/SphereOutlineGeometry","../Core/WebGLConstants","../Renderer/ClearCommand","../Renderer/ContextLimits","../Renderer/CubeMap","../Renderer/DrawCommand","../Renderer/Framebuffer","../Renderer/Pass","../Renderer/PassState","../Renderer/PixelDatatype","../Renderer/Renderbuffer","../Renderer/RenderbufferFormat","../Renderer/RenderState","../Renderer/Sampler","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","./Camera","./CullFace","./DebugCameraPrimitive","./PerInstanceColorAppearance","./Primitive","./ShadowMapShader"],function(p,d,f,o,q,G,t,y,m,g,a,s,l,S,e,r,u,c,_,h,W,H,v,b,C,w,T,n,E,A,x,P,D,O,I,M,R,L,N,i,k,F,B,U,V,z,j,Y,X,Q){"use strict";function Z(e){var t=(e=l(e,l.EMPTY_OBJECT)).context;if(!S(t))throw new u("context is required.");if(!S(e.lightCamera))throw new u("lightCamera is required.");if(S(e.numberOfCascades)&&1!==e.numberOfCascades&&4!==e.numberOfCascades)throw new u("Only one or four cascades are supported.");this._enabled=l(e.enabled,!0),this._softShadows=l(e.softShadows,!1),this._normalOffset=l(e.normalOffset,!0),this.dirty=!0,this.fromLightSource=l(e.fromLightSource,!0),this.darkness=l(e.darkness,.3),this._darkness=this.darkness,this.maximumDistance=l(e.maximumDistance,5e3),this._outOfView=!1,this._outOfViewPrevious=!1;var r,i=this._needsUpdate=!0;(c.isInternetExplorer()||c.isEdge()||(c.isChrome()||c.isFirefox())&&c.isWindows()&&!t.depthTexture)&&(i=!1),this._polygonOffsetSupported=i,this._terrainBias={polygonOffset:i,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.5,normalShading:!0,normalShadingSmooth:.3,depthBias:1e-4},this._primitiveBias={polygonOffset:i,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.1,normalShading:!0,normalShadingSmooth:.05,depthBias:2e-5},this._pointBias={polygonOffset:!1,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:0,normalShading:!0,normalShadingSmooth:.1,depthBias:5e-4},this._depthAttachment=void 0,this._colorAttachment=void 0,this._shadowMapMatrix=new H,this._shadowMapTexture=void 0,this._lightDirectionEC=new q,this._lightPositionEC=new G,this._distance=0,this._lightCamera=e.lightCamera,this._shadowMapCamera=new fe,this._shadowMapCullingVolume=void 0,this._sceneCamera=void 0,this._boundingSphere=new d,this._isPointLight=l(e.isPointLight,!1),this._pointLightRadius=l(e.pointLightRadius,100),this._cascadesEnabled=!this._isPointLight&&l(e.cascadesEnabled,!0),this._numberOfCascades=this._cascadesEnabled?l(e.numberOfCascades,4):0,this._fitNearFar=!0,this._maximumCascadeDistances=[25,150,700,Number.MAX_VALUE],this._textureSize=new o,this._isSpotLight=!1,this._cascadesEnabled?this._shadowMapCamera.frustum=new v:S(this._lightCamera.frustum.fov)&&(this._isSpotLight=!0),this._cascadeSplits=[new G,new G],this._cascadeMatrices=[new H,new H,new H,new H],this._cascadeDistances=new G,r=this._isPointLight?6:this._cascadesEnabled?this._numberOfCascades:1,this._passes=new Array(r);for(var n=0;n<r;++n)this._passes[n]=new K(t);this.debugShow=!1,this.debugFreezeFrame=!1,this._debugFreezeFrame=!1,this._debugCascadeColors=!1,this._debugLightFrustum=void 0,this._debugCameraFrustum=void 0,this._debugCascadeFrustums=new Array(this._numberOfCascades),this._debugShadowViewCommand=void 0,this._usesDepthTexture=t.depthTexture,this._isPointLight&&(this._usesDepthTexture=!1),this._primitiveRenderState=void 0,this._terrainRenderState=void 0,this._pointRenderState=void 0,$(this),this._clearCommand=new E({depth:1,color:new m}),this._clearPassState=new I(t),this._size=l(e.size,2048),this.size=this._size}function K(e){this.camera=new fe,this.passState=new I(e),this.framebuffer=void 0,this.textureOffsets=void 0,this.commandList=[],this.cullingVolume=void 0}function J(e,t){return N.fromCache({cull:{enabled:!0,face:z.BACK},depthTest:{enabled:!0},colorMask:{red:e,green:e,blue:e,alpha:e},depthMask:!0,polygonOffset:{enabled:t.polygonOffset,factor:t.polygonOffsetFactor,units:t.polygonOffsetUnits}})}function $(e){var t=!e._usesDepthTexture;e._primitiveRenderState=J(t,e._primitiveBias),e._terrainRenderState=J(t,e._terrainBias),e._pointRenderState=J(t,e._pointBias)}function ee(e){for(var t=e._passes.length,r=0;r<t;++r){var i=e._passes[r],n=i.framebuffer;S(n)&&!n.isDestroyed()&&n.destroy(),i.framebuffer=void 0}e._depthAttachment=e._depthAttachment&&e._depthAttachment.destroy(),e._colorAttachment=e._colorAttachment&&e._colorAttachment.destroy()}function te(){return new i({wrapS:U.CLAMP_TO_EDGE,wrapT:U.CLAMP_TO_EDGE,minificationFilter:B.NEAREST,magnificationFilter:F.NEAREST})}function re(e,t){e._isPointLight?function(e,t){for(var r=new R({context:t,width:e._textureSize.x,height:e._textureSize.y,format:L.DEPTH_COMPONENT16}),i=new x({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:C.RGBA,pixelDatatype:M.UNSIGNED_BYTE,sampler:te()}),n=[i.negativeX,i.negativeY,i.negativeZ,i.positiveX,i.positiveY,i.positiveZ],o=0;o<6;++o){var a=new D({context:t,depthRenderbuffer:r,colorTextures:[n[o]],destroyAttachments:!1}),s=e._passes[o];s.framebuffer=a,s.passState.framebuffer=a}e._shadowMapTexture=i,e._depthAttachment=r,e._colorAttachment=i}(e,t):e._usesDepthTexture?function(e,t){for(var r=new k({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:C.DEPTH_STENCIL,pixelDatatype:M.UNSIGNED_INT_24_8,sampler:te()}),i=new D({context:t,depthStencilTexture:r,destroyAttachments:!1}),n=e._passes.length,o=0;o<n;++o){var a=e._passes[o];a.framebuffer=i,a.passState.framebuffer=i}e._shadowMapTexture=r,e._depthAttachment=r}(e,t):function(e,t){for(var r=new R({context:t,width:e._textureSize.x,height:e._textureSize.y,format:L.DEPTH_COMPONENT16}),i=new k({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:C.RGBA,pixelDatatype:M.UNSIGNED_BYTE,sampler:te()}),n=new D({context:t,depthRenderbuffer:r,colorTextures:[i],destroyAttachments:!1}),o=e._passes.length,a=0;a<o;++a){var s=e._passes[a];s.framebuffer=n,s.passState.framebuffer=n}e._shadowMapTexture=i,e._depthAttachment=r,e._colorAttachment=i}(e,t)}function ie(e,t){var r,i;S(e._passes[0].framebuffer)&&e._shadowMapTexture.width===e._textureSize.x||(ee(e),re(e,t),i=t,(r=e)._usesDepthTexture&&r._passes[0].framebuffer.status!==n.FRAMEBUFFER_COMPLETE&&(r._usesDepthTexture=!1,$(r),ee(r),re(r,i)),ne(e,t))}function ne(e,t,r){r=l(r,0),(e._isPointLight||0===r)&&(e._clearCommand.framebuffer=e._passes[r].framebuffer,e._clearCommand.execute(t,e._clearPassState))}Z.MAXIMUM_DISTANCE=2e4,Z.prototype.debugCreateRenderStates=function(){$(this)},e(Z.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this.dirty=this._enabled!==e,this._enabled=e}},normalOffset:{get:function(){return this._normalOffset},set:function(e){this.dirty=this._normalOffset!==e,this._normalOffset=e,this._terrainBias.normalOffset=e,this._primitiveBias.normalOffset=e,this._pointBias.normalOffset=e}},softShadows:{get:function(){return this._softShadows},set:function(e){this.dirty=this._softShadows!==e,this._softShadows=e}},size:{get:function(){return this._size},set:function(e){!function(e,t){e._size=t;var r=e._passes,i=r.length,n=e._textureSize;if(e._isPointLight){t=A.maximumCubeMapSize>=t?t:A.maximumCubeMapSize,n.x=t,n.y=t;var o=new p(0,0,t,t);r[0].passState.viewport=o,r[1].passState.viewport=o,r[2].passState.viewport=o,r[3].passState.viewport=o,r[4].passState.viewport=o,r[5].passState.viewport=o}else 1===i?(t=A.maximumTextureSize>=t?t:A.maximumTextureSize,n.x=t,n.y=t,r[0].passState.viewport=new p(0,0,t,t)):4===i&&(t=A.maximumTextureSize>=2*t?t:A.maximumTextureSize/2,n.x=2*t,n.y=2*t,r[0].passState.viewport=new p(0,0,t,t),r[1].passState.viewport=new p(t,0,t,t),r[2].passState.viewport=new p(0,t,t,t),r[3].passState.viewport=new p(t,t,t,t));e._clearPassState.viewport=new p(0,0,n.x,n.y);for(var a=0;a<i;++a){var s=r[a],l=s.passState.viewport,u=l.x/n.x,c=l.y/n.y,d=l.width/n.x,h=l.height/n.y;s.textureOffsets=new H(d,0,0,u,0,h,0,c,0,0,1,0,0,0,0,1)}}(this,e)}},outOfView:{get:function(){return this._outOfView}},shadowMapCullingVolume:{get:function(){return this._shadowMapCullingVolume}},passes:{get:function(){return this._passes}},isPointLight:{get:function(){return this._isPointLight}},debugCascadeColors:{get:function(){return this._debugCascadeColors},set:function(e){this.dirty=this._debugCascadeColors!==e,this._debugCascadeColors=e}}});var oe=new p;function ae(e,t){var r=t.context,i=t.context.drawingBufferWidth,n=t.context.drawingBufferHeight,o=.3*Math.min(i,n),a=oe;a.x=i-o,a.y=0,a.width=o,a.height=o;var s=e._debugShadowViewCommand;S(s)||(s=function(e,t){var r;r=e._isPointLight?"uniform samplerCube shadowMap_textureCube; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n    vec2 uv = v_textureCoordinates; \n    vec3 dir; \n \n    if (uv.y < 0.5) \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = -1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = -1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else \n        { \n            dir.z = -1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 1.0; \n        } \n    } \n    else \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = 1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = 1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else \n        { \n            dir.z = 1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 3.0; \n        } \n    } \n \n    float shadow = czm_unpackDepth(textureCube(shadowMap_textureCube, dir)); \n    gl_FragColor = vec4(vec3(shadow), 1.0); \n} \n":"uniform sampler2D shadowMap_texture; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n"+(e._usesDepthTexture?"    float shadow = texture2D(shadowMap_texture, v_textureCoordinates).r; \n":"    float shadow = czm_unpackDepth(texture2D(shadowMap_texture, v_textureCoordinates)); \n")+"    gl_FragColor = vec4(vec3(shadow), 1.0); \n} \n";var i=t.createViewportQuadCommand(r,{uniformMap:{shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture}}});return i.pass=O.OVERLAY,i}(e,r),e._debugShadowViewCommand=s),S(s.renderState)&&p.equals(s.renderState.viewport,a)||(s.renderState=N.fromCache({viewport:p.clone(a)})),t.commandList.push(e._debugShadowViewCommand)}var se=new Array(8);se[0]=new G(-1,-1,-1,1),se[1]=new G(1,-1,-1,1),se[2]=new G(1,1,-1,1),se[3]=new G(-1,1,-1,1),se[4]=new G(-1,-1,1,1),se[5]=new G(1,-1,1,1),se[6]=new G(1,1,1,1),se[7]=new G(-1,1,1,1);for(var le=new H,ue=new Array(8),ce=0;ce<8;++ce)ue[ce]=new G;var de=[m.RED,m.GREEN,m.BLUE,m.MAGENTA],he=new q;function pe(e,t){ae(e,t);var r,i,n,o,a=e.debugFreezeFrame&&!e._debugFreezeFrame;if(e._debugFreezeFrame=e.debugFreezeFrame,e.debugFreezeFrame&&(a&&(e._debugCameraFrustum=e._debugCameraFrustum&&e._debugCameraFrustum.destroy(),e._debugCameraFrustum=new j({camera:e._sceneCamera,color:m.CYAN,updateOnChange:!1})),e._debugCameraFrustum.update(t)),e._cascadesEnabled){if(e.debugFreezeFrame){a&&(e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=new j({camera:e._shadowMapCamera,color:m.YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t);for(var s=0;s<e._numberOfCascades;++s)a&&(e._debugCascadeFrustums[s]=e._debugCascadeFrustums[s]&&e._debugCascadeFrustums[s].destroy(),e._debugCascadeFrustums[s]=new j({camera:e._passes[s].camera,color:de[s],updateOnChange:!1})),e._debugCascadeFrustums[s].update(t)}}else if(e._isPointLight){if(!S(e._debugLightFrustum)||e._needsUpdate){var l=e._shadowMapCamera.positionWC,u=w.IDENTITY,c=2*e._pointLightRadius,d=q.fromElements(c,c,c,he),h=H.fromTranslationQuaternionRotationScale(l,u,d,le);e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=(r=h,i=m.YELLOW,n=new _({geometry:new f({minimum:new q(-.5,-.5,-.5),maximum:new q(.5,.5,.5)}),attributes:{color:g.fromColor(i)}}),o=new _({geometry:new T({radius:.5}),attributes:{color:g.fromColor(i)}}),new X({geometryInstances:[n,o],appearance:new Y({translucent:!1,flat:!0}),asynchronous:!1,modelMatrix:r}))}e._debugLightFrustum.update(t)}else S(e._debugLightFrustum)&&!e._needsUpdate||(e._debugLightFrustum=new j({camera:e._shadowMapCamera,color:m.YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t)}function fe(){this.viewMatrix=new H,this.inverseViewMatrix=new H,this.frustum=void 0,this.positionCartographic=new t,this.positionWC=new q,this.directionWC=q.clone(q.UNIT_Z),this.upWC=q.clone(q.UNIT_Y),this.rightWC=q.clone(q.UNIT_X),this.viewProjectionMatrix=new H}fe.prototype.clone=function(e){H.clone(e.viewMatrix,this.viewMatrix),H.clone(e.inverseViewMatrix,this.inverseViewMatrix),this.frustum=e.frustum.clone(this.frustum),t.clone(e.positionCartographic,this.positionCartographic),q.clone(e.positionWC,this.positionWC),q.clone(e.directionWC,this.directionWC),q.clone(e.upWC,this.upWC),q.clone(e.rightWC,this.rightWC)};var me=new H(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);fe.prototype.getViewProjection=function(){var e=this.viewMatrix,t=this.frustum.projectionMatrix;return H.multiply(t,e,this.viewProjectionMatrix),H.multiply(me,this.viewProjectionMatrix,this.viewProjectionMatrix),this.viewProjectionMatrix};var ge=new Array(5),_e=new b,ve=new Array(4),ye=new q,be=new q;var Ce=new H,we=new q,Se=new q,Te=new q;var Ee=[new q(-1,0,0),new q(0,-1,0),new q(0,0,-1),new q(1,0,0),new q(0,1,0),new q(0,0,1)],Ae=[new q(0,-1,0),new q(0,0,-1),new q(0,-1,0),new q(0,-1,0),new q(0,0,1),new q(0,-1,0)],xe=[new q(0,0,1),new q(1,0,0),new q(-1,0,0),new q(0,0,-1),new q(1,0,0),new q(1,0,0)];var Pe=new q,De=new q,Oe=new d,Ie=Oe.center;function Me(e,t){var r=t.camera,i=e._lightCamera,n=e._sceneCamera,o=e._shadowMapCamera;e._cascadesEnabled?q.clone(i.directionWC,o.directionWC):e._isPointLight?q.clone(i.positionWC,o.positionWC):o.clone(i);var a,s,l=e._lightDirectionEC;H.multiplyByPointAsVector(r.viewMatrix,o.directionWC,l),q.normalize(l,l),q.negate(l,l),H.multiplyByPoint(r.viewMatrix,o.positionWC,e._lightPositionEC),e._lightPositionEC.w=e._pointLightRadius,s=e._fitNearFar?(a=Math.min(t.shadowHints.nearPlane,e.maximumDistance),Math.min(t.shadowHints.farPlane,e.maximumDistance+1)):(a=r.frustum.near,e.maximumDistance),e._sceneCamera=V.clone(r,n),r.frustum.clone(e._sceneCamera.frustum),e._sceneCamera.frustum.near=a,e._sceneCamera.frustum.far=s,e._distance=s-a,function(e,t){var r=e._sceneCamera,i=e._shadowMapCamera,n=Oe;if(e._cascadesEnabled){if(r.frustum.near>=e.maximumDistance)return e._outOfView=!0,e._needsUpdate=!1;var o=t.mapProjection.ellipsoid.geodeticSurfaceNormal(r.positionWC,Pe),a=q.negate(i.directionWC,De),s=q.dot(o,a),l=W.clamp(s/.1,0,1);if(e._darkness=W.lerp(1,e.darkness,l),s<0)return e._outOfView=!0,e._needsUpdate=!1;e._needsUpdate=!0,e._outOfView=!1}else if(e._isPointLight)n.center=i.positionWC,n.radius=e._pointLightRadius,e._outOfView=t.cullingVolume.computeVisibility(n)===h.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(n),d.clone(n,e._boundingSphere);else{var u=i.frustum.far/2,c=q.add(i.positionWC,q.multiplyByScalar(i.directionWC,u,Ie),Ie);n.center=c,n.radius=u,e._outOfView=t.cullingVolume.computeVisibility(n)===h.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(n),d.clone(n,e._boundingSphere)}}(e,t),!e._outOfViewPrevious&&e._outOfView&&(e._needsUpdate=!0),e._outOfViewPrevious=e._outOfView}Z.prototype.update=function(e){if(Me(this,e),this._needsUpdate)if(ie(this,e.context),this._isPointLight&&function(e,t){var r=new b;r.fov=W.PI_OVER_TWO,r.near=1,r.far=e._pointLightRadius,r.aspectRatio=1;for(var i=0;i<6;++i){var n=e._passes[i].camera;n.positionWC=e._shadowMapCamera.positionWC,n.positionCartographic=t.mapProjection.ellipsoid.cartesianToCartographic(n.positionWC,n.positionCartographic),n.directionWC=Ee[i],n.upWC=Ae[i],n.rightWC=xe[i],H.computeView(n.positionWC,n.directionWC,n.upWC,n.rightWC,n.viewMatrix),H.inverse(n.viewMatrix,n.inverseViewMatrix),n.frustum=r}}(this,e),this._cascadesEnabled&&(function(e,t){var r=e._shadowMapCamera,i=e._sceneCamera,n=H.multiply(i.frustum.projectionMatrix,i.viewMatrix,le),o=H.inverse(n,le),a=r.directionWC,s=i.directionWC,l=q.cross(a,s,we);s=q.cross(l,a,Se),q.normalize(s,s),q.normalize(l,l);for(var u=q.fromElements(0,0,0,Te),c=H.computeView(u,a,s,l,Ce),d=H.multiply(c,o,le),h=q.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,ye),p=q.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,be),f=0;f<8;++f){var m=G.clone(se[f],ue[f]);H.multiplyByVector(d,m,m),q.divideByScalar(m,m.w,m),q.minimumByComponent(m,h,h),q.maximumByComponent(m,p,p)}p.z+=1e3,h.z-=10;var g=Te;g.x=-.5*(h.x+p.x),g.y=-.5*(h.y+p.y),g.z=-p.z;var _=H.fromTranslation(g,le);c=H.multiply(_,c,c);var v=.5*(p.x-h.x),y=.5*(p.y-h.y),b=p.z-h.z,C=r.frustum;C.left=-v,C.right=v,C.bottom=-y,C.top=y,C.near=.01,C.far=b,H.clone(c,r.viewMatrix),H.inverse(c,r.inverseViewMatrix),H.getTranslation(r.inverseViewMatrix,r.positionWC),t.mapProjection.ellipsoid.cartesianToCartographic(r.positionWC,r.positionCartographic),q.clone(a,r.directionWC),q.clone(s,r.upWC),q.clone(l,r.rightWC)}(this,e),1<this._numberOfCascades&&function(e,t){var r,i=e._shadowMapCamera,n=e._sceneCamera,o=n.frustum.near,a=n.frustum.far,s=e._numberOfCascades,l=a-o,u=a/o,c=.9,d=!1;t.shadowHints.closestObjectSize<200&&(d=!0,c=.9);var h=ve,p=ge;for(p[0]=o,p[s]=a,r=0;r<s;++r){var f=(r+1)/s,m=o*Math.pow(u,f),g=o+l*f,_=W.lerp(g,m,c);p[r+1]=_,h[r]=_-p[r]}if(d){for(r=0;r<s;++r)h[r]=Math.min(h[r],e._maximumCascadeDistances[r]);var v=p[0];for(r=0;r<s-1;++r)v+=h[r],p[r+1]=v}G.unpack(p,0,e._cascadeSplits[0]),G.unpack(p,1,e._cascadeSplits[1]),G.unpack(h,0,e._cascadeDistances);var y=i.frustum,b=y.left,C=y.right,w=y.bottom,S=y.top,T=y.near,E=y.far,A=i.positionWC,x=i.directionWC,P=i.upWC,D=n.frustum.clone(_e),O=i.getViewProjection();for(r=0;r<s;++r){D.near=p[r],D.far=p[r+1];for(var I=H.multiply(D.projectionMatrix,n.viewMatrix,le),M=H.inverse(I,le),R=H.multiply(O,M,le),L=q.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,ye),N=q.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,be),k=0;k<8;++k){var F=G.clone(se[k],ue[k]);H.multiplyByVector(R,F,F),q.divideByScalar(F,F.w,F),q.minimumByComponent(F,L,L),q.maximumByComponent(F,N,N)}L.x=Math.max(L.x,0),L.y=Math.max(L.y,0),L.z=0,N.x=Math.min(N.x,1),N.y=Math.min(N.y,1),N.z=Math.min(N.z,1);var B=e._passes[r],U=B.camera;U.clone(i);var V=U.frustum;V.left=b+L.x*(C-b),V.right=b+N.x*(C-b),V.bottom=w+L.y*(S-w),V.top=w+N.y*(S-w),V.near=T+L.z*(E-T),V.far=T+N.z*(E-T),B.cullingVolume=U.frustum.computeCullingVolume(A,x,P);var z=e._cascadeMatrices[r];H.multiply(U.getViewProjection(),n.inverseViewMatrix,z),H.multiply(B.textureOffsets,z,z)}}(this,e)),this._isPointLight)this._shadowMapCullingVolume=s.fromBoundingSphere(this._boundingSphere);else{var t=this._shadowMapCamera,r=t.positionWC,i=t.directionWC,n=t.upWC;this._shadowMapCullingVolume=t.frustum.computeCullingVolume(r,i,n),1===this._passes.length&&this._passes[0].camera.clone(t)}if(1===this._passes.length){var o=this._sceneCamera.inverseViewMatrix;H.multiply(this._shadowMapCamera.getViewProjection(),o,this._shadowMapMatrix)}this.debugShow&&pe(this,e)},Z.prototype.updatePass=function(e,t){ne(this,e,t)};var Re=new o;function Le(t,e,r){var i=t._isPointLight?t._pointBias:r?t._terrainBias:t._primitiveBias,n={shadowMap_texture:function(){return t._shadowMapTexture},shadowMap_textureCube:function(){return t._shadowMapTexture},shadowMap_matrix:function(){return t._shadowMapMatrix},shadowMap_cascadeSplits:function(){return t._cascadeSplits},shadowMap_cascadeMatrices:function(){return t._cascadeMatrices},shadowMap_lightDirectionEC:function(){return t._lightDirectionEC},shadowMap_lightPositionEC:function(){return t._lightPositionEC},shadowMap_cascadeDistances:function(){return t._cascadeDistances},shadowMap_texelSizeDepthBiasAndNormalShadingSmooth:function(){var e=Re;return e.x=1/t._textureSize.x,e.y=1/t._textureSize.y,G.fromElements(e.x,e.y,i.depthBias,i.normalShadingSmooth,this.combinedUniforms1)},shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness:function(){return G.fromElements(i.normalOffsetScale,t._distance,t.maximumDistance,t._darkness,this.combinedUniforms2)},combinedUniforms1:new G,combinedUniforms2:new G};return a(e,n,!1)}function Ne(e,t,r,i,n,o){var a,s,l;if(S(o)&&(a=o.shaderProgram,s=o.renderState,l=o.uniformMap),(o=P.shallowClone(r,o)).castShadows=!0,o.receiveShadows=!1,!S(a)||n!==r.shaderProgram.id||t){var u=r.shaderProgram,c=r.pass===O.GLOBE,d=r.pass!==O.TRANSLUCENT,h=e._isPointLight,p=e._usesDepthTexture,f=Q.getShadowCastShaderKeyword(h,c,p,d);if(a=i.shaderCache.getDerivedShaderProgram(u,f),!S(a)){var m=u.vertexShaderSource,g=u.fragmentShaderSource,_=Q.createShadowCastVertexShader(m,h,c),v=Q.createShadowCastFragmentShader(g,h,p,d);a=i.shaderCache.createDerivedShaderProgram(u,f,{vertexShaderSource:_,fragmentShaderSource:v,attributeLocations:u._attributeLocations})}s=e._primitiveRenderState,h?s=e._pointRenderState:c&&(s=e._terrainRenderState),r.renderState.cull.enabled||((s=y(s,!1)).cull=y(s.cull,!1),s.cull.enabled=!1,s=N.fromCache(s)),l=Le(e,r.uniformMap,c)}return o.shaderProgram=a,o.renderState=s,o.uniformMap=l,o}return Z.createDerivedCommands=function(e,t,r,i,n,o){S(o)||(o={});var a=0<t.length,s=r.shaderProgram,l=s.vertexShaderSource,u=s.fragmentShaderSource,c=r.pass===O.GLOBE,d=!1;if(c&&(d=r.owner.data.pickTerrain.mesh.encoding.hasVertexNormals),r.castShadows){var h=o.castCommands;S(h)||(h=o.castCommands=[]);var p=o.castShaderProgramId,f=e.length;h.length=f;for(var m=0;m<f;++m)h[m]=Ne(e[m],i,r,n,p,h[m]);o.castShaderProgramId=r.shaderProgram.id}if(r.receiveShadows&&a){var g,_;S(o.receiveCommand)&&(g=o.receiveCommand.shaderProgram,_=o.receiveCommand.uniformMap),o.receiveCommand=P.shallowClone(r,o.receiveCommand),o.castShadows=!1,o.receiveShadows=!0;var v=o.receiveShaderCastShadows!==r.castShadows,y=o.receiveShaderProgramId!==r.shaderProgram.id;if(!S(g)||y||i||v){var b=Q.getShadowReceiveShaderKeyword(t[0],r.castShadows,c,d);if(g=n.shaderCache.getDerivedShaderProgram(s,b),!S(g)){var C=Q.createShadowReceiveVertexShader(l,c,d),w=Q.createShadowReceiveFragmentShader(u,t[0],r.castShadows,c,d);g=n.shaderCache.createDerivedShaderProgram(s,b,{vertexShaderSource:C,fragmentShaderSource:w,attributeLocations:s._attributeLocations})}_=Le(t[0],r.uniformMap,c)}o.receiveCommand.shaderProgram=g,o.receiveCommand.uniformMap=_,o.receiveShaderProgramId=r.shaderProgram.id,o.receiveShaderCastShadows=r.castShadows}return o},Z.prototype.isDestroyed=function(){return!1},Z.prototype.destroy=function(){ee(this),this._debugLightFrustum=this._debugLightFrustum&&this._debugLightFrustum.destroy(),this._debugCameraFrustum=this._debugCameraFrustum&&this._debugCameraFrustum.destroy(),this._debugShadowViewCommand=this._debugShadowViewCommand&&this._debugShadowViewCommand.shaderProgram&&this._debugShadowViewCommand.shaderProgram.destroy();for(var e=0;e<this._numberOfCascades;++e)this._debugCascadeFrustums[e]=this._debugCascadeFrustums[e]&&this._debugCascadeFrustums[e].destroy();return r(this)},Z}),define("Shaders/PostProcessFilters/AdditiveBlend",[],function(){"use strict";return"uniform sampler2D u_texture0;\nuniform sampler2D u_texture1;\nuniform vec2 u_center;\nuniform float u_radius;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nvec4 color0 = texture2D(u_texture0, v_textureCoordinates);\nvec4 color1 = texture2D(u_texture1, v_textureCoordinates);\nfloat x = length(gl_FragCoord.xy - u_center) / u_radius;\nfloat t = smoothstep(0.5, 0.8, x);\ngl_FragColor = mix(color0 + color1, color0, t);\n}\n"}),define("Shaders/PostProcessFilters/BrightPass",[],function(){"use strict";return"uniform sampler2D u_texture;\nuniform float u_avgLuminance;\nuniform float u_threshold;\nuniform float u_offset;\nvarying vec2 v_textureCoordinates;\nfloat key(float avg)\n{\nfloat guess = 1.5 - (1.5 / (avg * 0.1 + 1.0));\nreturn max(0.0, guess) + 0.1;\n}\nvoid main()\n{\nvec4 color = texture2D(u_texture, v_textureCoordinates);\nvec3 xyz = czm_RGBToXYZ(color.rgb);\nfloat luminance = xyz.r;\nfloat scaledLum = key(u_avgLuminance) * luminance / u_avgLuminance;\nfloat brightLum = max(scaledLum - u_threshold, 0.0);\nfloat brightness = brightLum / (u_offset + brightLum);\nxyz.r = brightness;\ngl_FragColor = vec4(czm_XYZToRGB(xyz), 1.0);\n}\n"}),define("Shaders/PostProcessFilters/GaussianBlur1D",[],function(){"use strict";return"#define SAMPLES 8\nuniform float delta;\nuniform float sigma;\nuniform float direction;\nuniform sampler2D u_texture;\nuniform vec2 u_step;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nvec2 st = v_textureCoordinates;\nvec2 dir = vec2(1.0 - direction, direction);\nvec3 g;\ng.x = 1.0 / (sqrt(czm_twoPi) * sigma);\ng.y = exp((-0.5 * delta * delta) / (sigma * sigma));\ng.z = g.y * g.y;\nvec4 result = texture2D(u_texture, st) * g.x;\nfor (int i = 1; i < SAMPLES; ++i)\n{\ng.xy *= g.yz;\nvec2 offset = float(i) * dir * u_step;\nresult += texture2D(u_texture, st - offset) * g.x;\nresult += texture2D(u_texture, st + offset) * g.x;\n}\ngl_FragColor = result;\n}\n"}),define("Scene/SunPostProcess",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian4","../Core/Color","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/Math","../Core/Matrix4","../Core/PixelFormat","../Core/Transforms","../Renderer/ClearCommand","../Renderer/Framebuffer","../Renderer/PassState","../Renderer/PixelDatatype","../Renderer/Renderbuffer","../Renderer/RenderbufferFormat","../Renderer/RenderState","../Renderer/Texture","../Shaders/PostProcessFilters/AdditiveBlend","../Shaders/PostProcessFilters/BrightPass","../Shaders/PostProcessFilters/GaussianBlur1D","../Shaders/PostProcessFilters/PassThrough"],function(e,D,t,O,i,I,r,M,R,L,N,k,F,n,B,U,V,z,q,G,W,H,j){"use strict";function o(){this._fbo=void 0,this._downSampleFBO1=void 0,this._downSampleFBO2=void 0,this._clearFBO1Command=void 0,this._clearFBO2Command=void 0,this._downSampleCommand=void 0,this._brightPassCommand=void 0,this._blurXCommand=void 0,this._blurYCommand=void 0,this._blendCommand=void 0,this._fullScreenCommand=void 0,this._downSamplePassState=new n,this._downSamplePassState.scissorTest={enable:!0,rectangle:new e},this._upSamplePassState=new n,this._upSamplePassState.scissorTest={enabled:!0,rectangle:new e},this._uCenter=new D,this._uRadius=void 0,this._blurStep=new D}o.prototype.clear=function(e,t){var r=this._clearFBO1Command;O.clone(i(t,O.BLACK),r.color),r.execute(e),r=this._clearFBO2Command,O.clone(i(t,O.BLACK),r.color),r.execute(e)},o.prototype.execute=function(e,t){this._downSampleCommand.execute(e,this._downSamplePassState),this._brightPassCommand.execute(e,this._downSamplePassState),this._blurXCommand.execute(e,this._downSamplePassState),this._blurYCommand.execute(e,this._downSamplePassState),this._fullScreenCommand.framebuffer=t,this._blendCommand.framebuffer=t,this._fullScreenCommand.execute(e),this._blendCommand.execute(e,this._upSamplePassState)};var Y=new e,X=new e,Q=new t,Z=new D,K=new D,J=new R;return o.prototype.update=function(e){var t=e.context,r=e.viewport,i=t.drawingBufferWidth,n=t.drawingBufferHeight,o=this;if(!I(this._downSampleCommand)){this._clearFBO1Command=new k({color:new O}),this._clearFBO2Command=new k({color:new O});var a={};this._downSampleCommand=t.createViewportQuadCommand(j,{uniformMap:a,owner:this}),a={u_avgLuminance:function(){return.5},u_threshold:function(){return.25},u_offset:function(){return.1}},this._brightPassCommand=t.createViewportQuadCommand(W,{uniformMap:a,owner:this});a={delta:function(){return 1},sigma:function(){return 2},direction:function(){return 0}},this._blurXCommand=t.createViewportQuadCommand(H,{uniformMap:a,owner:this}),a={delta:function(){return 1},sigma:function(){return 2},direction:function(){return 1}},this._blurYCommand=t.createViewportQuadCommand(H,{uniformMap:a,owner:this}),a={u_center:function(){return o._uCenter},u_radius:function(){return o._uRadius}},this._blendCommand=t.createViewportQuadCommand(G,{uniformMap:a,owner:this}),a={},this._fullScreenCommand=t.createViewportQuadCommand(j,{uniformMap:a,owner:this})}var s=Math.pow(2,Math.ceil(Math.log(i)/Math.log(2))-2),l=Math.pow(2,Math.ceil(Math.log(n)/Math.log(2))-2),u=Math.max(1,s,l),c=X;c.width=u,c.height=u;var d=this._fbo,h=I(d)&&d.getColorTexture(0)||void 0;if(!I(h)||h.width!==i||h.height!==n){d=d&&d.destroy(),this._downSampleFBO1=this._downSampleFBO1&&this._downSampleFBO1.destroy(),this._downSampleFBO2=this._downSampleFBO2&&this._downSampleFBO2.destroy(),this._blurStep.x=this._blurStep.y=1/u;var p=[new q({context:t,width:i,height:n})];d=t.depthTexture?this._fbo=new F({context:t,colorTextures:p,depthTexture:new q({context:t,width:i,height:n,pixelFormat:L.DEPTH_COMPONENT,pixelDatatype:B.UNSIGNED_SHORT})}):this._fbo=new F({context:t,colorTextures:p,depthRenderbuffer:new U({context:t,format:V.DEPTH_COMPONENT16})}),this._downSampleFBO1=new F({context:t,colorTextures:[new q({context:t,width:u,height:u})]}),this._downSampleFBO2=new F({context:t,colorTextures:[new q({context:t,width:u,height:u})]}),this._clearFBO1Command.framebuffer=this._downSampleFBO1,this._clearFBO2Command.framebuffer=this._downSampleFBO2,this._downSampleCommand.framebuffer=this._downSampleFBO1,this._brightPassCommand.framebuffer=this._downSampleFBO2,this._blurXCommand.framebuffer=this._downSampleFBO1,this._blurYCommand.framebuffer=this._downSampleFBO2;var f=z.fromCache({viewport:c});this._downSampleCommand.uniformMap.u_texture=function(){return d.getColorTexture(0)},this._downSampleCommand.renderState=f,this._brightPassCommand.uniformMap.u_texture=function(){return o._downSampleFBO1.getColorTexture(0)},this._brightPassCommand.renderState=f,this._blurXCommand.uniformMap.u_texture=function(){return o._downSampleFBO2.getColorTexture(0)},this._blurXCommand.uniformMap.u_step=function(){return o._blurStep},this._blurXCommand.renderState=f,this._blurYCommand.uniformMap.u_texture=function(){return o._downSampleFBO1.getColorTexture(0)},this._blurYCommand.uniformMap.u_step=function(){return o._blurStep},this._blurYCommand.renderState=f;var m=Y;m.width=i,m.height=n;var g=z.fromCache({viewport:m});this._blendCommand.uniformMap.u_texture0=function(){return d.getColorTexture(0)},this._blendCommand.uniformMap.u_texture1=function(){return o._downSampleFBO2.getColorTexture(0)},this._blendCommand.renderState=g,this._fullScreenCommand.uniformMap.u_texture=function(){return d.getColorTexture(0)},this._fullScreenCommand.renderState=g}var _=t.uniformState,v=_.sunPositionWC,y=_.view,b=_.viewProjection,C=_.projection,w=R.computeViewportTransformation(r,0,1,J),S=R.multiplyByPoint(y,v,Q),T=N.pointToGLWindowCoordinates(b,w,v,Z);S.x+=M.SOLAR_RADIUS;var E=N.pointToGLWindowCoordinates(C,w,S,S),A=30*D.magnitude(D.subtract(E,T,E))*2,x=K;x.x=A,x.y=A;var P=this._upSamplePassState.scissorTest.rectangle;return P.x=Math.max(T.x-.5*x.x,0),P.y=Math.max(T.y-.5*x.y,0),P.width=Math.min(x.x,i),P.height=Math.min(x.y,n),this._uCenter=D.clone(T,this._uCenter),this._uRadius=.15*Math.max(x.x,x.y),w=R.computeViewportTransformation(c,0,1,J),T=N.pointToGLWindowCoordinates(b,w,v,Z),x.x*=s/i,x.y*=l/n,(P=this._downSamplePassState.scissorTest.rectangle).x=Math.max(T.x-.5*x.x,0),P.y=Math.max(T.y-.5*x.y,0),P.width=Math.min(x.x,i),P.height=Math.min(x.y,n),this._downSamplePassState.context=t,this._upSamplePassState.context=t,this._fbo},o.prototype.isDestroyed=function(){return!1},o.prototype.destroy=function(){return this._fbo=this._fbo&&this._fbo.destroy(),this._downSampleFBO1=this._downSampleFBO1&&this._downSampleFBO1.destroy(),this._downSampleFBO2=this._downSampleFBO2&&this._downSampleFBO2.destroy(),this._downSampleCommand=this._downSampleCommand&&this._downSampleCommand.shaderProgram&&this._downSampleCommand.shaderProgram.destroy(),this._brightPassCommand=this._brightPassCommand&&this._brightPassCommand.shaderProgram&&this._brightPassCommand.shaderProgram.destroy(),this._blurXCommand=this._blurXCommand&&this._blurXCommand.shaderProgram&&this._blurXCommand.shaderProgram.destroy(),this._blurYCommand=this._blurYCommand&&this._blurYCommand.shaderProgram&&this._blurYCommand.shaderProgram.destroy(),this._blendCommand=this._blendCommand&&this._blendCommand.shaderProgram&&this._blendCommand.shaderProgram.destroy(),this._fullScreenCommand=this._fullScreenCommand&&this._fullScreenCommand.shaderProgram&&this._fullScreenCommand.shaderProgram.destroy(),r(this)},o}),define("Scene/Scene",["../Core/BoundingRectangle","../Core/BoundingSphere","../Core/BoxGeometry","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/createGuid","../Core/CullingVolume","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EllipsoidGeometry","../Core/Event","../Core/GeographicProjection","../Core/GeometryInstance","../Core/GeometryPipeline","../Core/getTimestamp","../Core/Intersect","../Core/Interval","../Core/JulianDate","../Core/Math","../Core/Matrix4","../Core/mergeSort","../Core/Occluder","../Core/OrthographicFrustum","../Core/OrthographicOffCenterFrustum","../Core/PerspectiveFrustum","../Core/PerspectiveOffCenterFrustum","../Core/PixelFormat","../Core/RequestScheduler","../Core/ShowGeometryInstanceAttribute","../Core/TaskProcessor","../Core/Transforms","../Renderer/ClearCommand","../Renderer/ComputeEngine","../Renderer/Context","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Framebuffer","../Renderer/Pass","../Renderer/PassState","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/Texture","./BrdfLutGenerator","./Camera","./CreditDisplay","./DebugCameraPrimitive","./DepthPlane","./DeviceOrientationCameraController","./Fog","./FrameState","./FrustumCommands","./FXAA","./GlobeDepth","./InvertClassification","./JobScheduler","./MapMode2D","./OIT","./PerformanceDisplay","./PerInstanceColorAppearance","./PickDepth","./Primitive","./PrimitiveCollection","./SceneMode","./SceneTransforms","./SceneTransitioner","./ScreenSpaceCameraController","./ShadowMap","./SunPostProcess","./TweenCollection"],function(C,e,_,t,w,g,r,m,v,f,i,y,N,n,o,b,S,T,E,A,x,a,s,l,P,k,D,u,c,O,I,d,h,M,R,p,L,F,B,U,V,z,q,G,W,H,j,Y,X,Q,Z,K,J,$,ee,te,re,ie,ne,oe,ae,se,le,ue,ce,de,he,pe,fe,me,ge,_e,ve,ye,be,Ce,we,Se){"use strict";var Te=function(e){return function(){e.frameState.afterRender.push(function(){e.requestRender()})}};function Ee(e){var t=(e=y(e,y.EMPTY_OBJECT)).canvas,r=e.contextOptions,i=e.creditContainer,n=e.creditViewport;if(!N(t))throw new b("options and options.canvas are required.");var o=N(i),a=new V(t,r);o||((i=document.createElement("div")).style.position="absolute",i.style.bottom="0",i.style["text-shadow"]="0 0 2px #000000",i.style.color="#ffffff",i.style["font-size"]="10px",i.style["padding-right"]="5px",t.parentNode.appendChild(i)),N(n)||(n=t.parentNode),this._id=f(),this._jobScheduler=new ue,this._frameState=new ne(a,new $(i,"  ",n),this._jobScheduler),this._frameState.scene3DOnly=y(e.scene3DOnly,!1),this._removeCreditContainer=!o,this._creditContainer=i;var s,l,u=new H(a);u.viewport=new C,u.viewport.x=0,u.viewport.y=0,u.viewport.width=a.drawingBufferWidth,u.viewport.height=a.drawingBufferHeight,this._passState=u,this._canvas=t,this._context=a,this._computeEngine=new U(a),this._globe=void 0,this._primitives=new ge,this._groundPrimitives=new ge,this._tweens=new Se,this._shaderFrameCount=0,this._sunPostProcess=void 0,this._computeCommandList=[],this._frustumCommandsList=[],this._overlayCommandList=[],this._pickFramebuffer=void 0,this._useOIT=y(e.orderIndependentTranslucency,!0),this._executeOITFunction=void 0,a.depthTexture&&(s=new se),this._useOIT&&N(s)&&(l=new de(a)),this._globeDepth=s,this._depthPlane=new te,this._oit=l,this._fxaa=new ae,this._clearColorCommand=new B({color:new m,stencil:0,owner:this}),this._depthClearCommand=new B({depth:1,owner:this}),this._stencilClearCommand=new B({stencil:0}),this._pickDepths=[],this._debugGlobeDepths=[],this._pickDepthPassState=void 0,this._pickDepthFramebuffer=void 0,this._pickDepthFramebufferWidth=void 0,this._pickDepthFramebufferHeight=void 0,this._depthOnlyRenderStateCache={},this._transitioner=new ye(this),this._preUpdate=new T,this._postUpdate=new T,this._renderError=new T,this._preRender=new T,this._postRender=new T,this._cameraStartFired=!1,this._cameraMovedTime=void 0,this._pickPositionCache={},this._pickPositionCacheDirty=!1,this._minimumDisableDepthTestDistance=0,this.rethrowRenderErrors=!1,this.completeMorphOnUserInput=!0,this.morphStart=new T,this.morphComplete=new T,this.skyBox=void 0,this.skyAtmosphere=void 0,this.sun=void 0,this.sunBloom=!0,this._sunBloom=void 0,this.moon=void 0,this.backgroundColor=m.clone(m.BLACK),this._mode=_e.SCENE3D,this._mapProjection=N(e.mapProjection)?e.mapProjection:new E,this.morphTime=1,this.farToNearRatio=1e3,this.nearToFarDistance2D=175e4,this.debugCommandFilter=void 0,this.debugShowCommands=!1,this.debugShowFrustums=!1,this._debugFrustumStatistics=void 0,this.debugShowFramesPerSecond=!1,this.debugShowGlobeDepth=!1,this.debugShowDepthFrustum=1,this.debugShowFrustumPlanes=!1,this._debugShowFrustumPlanes=!1,this._debugFrustumPlanes=void 0,this.fxaa=!0,this.useDepthPicking=!0,this.pickTranslucentDepth=!1,this.cameraEventWaitTime=500,this.copyGlobeDepth=!1,this.fog=new ie,this._sunCamera=new J(this),this.shadowMap=new Ce({context:a,lightCamera:this._sunCamera,enabled:y(e.shadows,!1)}),this.invertClassification=!1,this.invertClassificationColor=m.clone(m.WHITE),this._actualInvertClassificationColor=m.clone(this._invertClassificationColor),this._invertClassification=new le,this.focalLength=void 0,this.eyeSeparation=void 0,this._brdfLutGenerator=new K,this._terrainExaggeration=y(e.terrainExaggeration,1),this._performanceDisplay=void 0,this._debugVolume=void 0;var c=new J(this);this._camera=c,this._cameraClone=J.clone(c),this._screenSpaceCameraController=new be(this),this._mapMode2D=y(e.mapMode2D,ce.INFINITE_SCROLL),this._environmentState={skyBoxCommand:void 0,skyAtmosphereCommand:void 0,sunDrawCommand:void 0,sunComputeCommand:void 0,moonCommand:void 0,isSunVisible:!1,isMoonVisible:!1,isReadyForAtmosphere:!1,isSkyAtmosphereVisible:!1,clearGlobeDepth:!1,useDepthPlane:!1,originalFramebuffer:void 0,useGlobeDepthFramebuffer:!1,useOIT:!1,useFXAA:!1,useInvertClassification:!1},this._useWebVR=!1,this._cameraVR=void 0,this._aspectRatioVR=void 0,this.requestRenderMode=y(e.requestRenderMode,!1),this._renderRequested=!0,this.maximumRenderTimeChange=y(e.maximumRenderTimeChange,0),this._lastRenderTime=void 0,this._removeRequestListenerCallback=R.requestCompletedEvent.addEventListener(Te(this)),this._removeTaskProcessorListenerCallback=L.taskCompletedEvent.addEventListener(Te(this)),this._removeGlobeCallbacks=[];var d=c.frustum.near,h=c.frustum.far,p=Math.ceil(Math.log(h/d)/Math.log(this.farToNearRatio));Ne(d,h,this.farToNearRatio,p,this._frustumCommandsList,!1,void 0),Le(this,0,P.now()),this.initializeFrame()}var Ae=.9999;n(Ee.prototype,{canvas:{get:function(){return this._canvas}},drawingBufferHeight:{get:function(){return this._context.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._context.drawingBufferWidth}},maximumAliasedLineWidth:{get:function(){return z.maximumAliasedLineWidth}},maximumCubeMapSize:{get:function(){return z.maximumCubeMapSize}},pickPositionSupported:{get:function(){return this._context.depthTexture}},globe:{get:function(){return this._globe},set:function(e){this._globe=this._globe&&this._globe.destroy(),this._globe=e,function(e,t){for(var r=0;r<e._removeGlobeCallbacks.length;++r)e._removeGlobeCallbacks[r]();e._removeGlobeCallbacks.length=0;var i=[];N(t)&&(i.push(t.tileLoadedEvent.addEventListener(Te(e))),i.push(t.imageryLayersUpdatedEvent.addEventListener(Te(e)))),e._removeGlobeCallbacks=i}(this,e)}},primitives:{get:function(){return this._primitives}},groundPrimitives:{get:function(){return this._groundPrimitives}},camera:{get:function(){return this._camera}},screenSpaceCameraController:{get:function(){return this._screenSpaceCameraController}},mapProjection:{get:function(){return this._mapProjection}},frameState:{get:function(){return this._frameState}},tweens:{get:function(){return this._tweens}},imageryLayers:{get:function(){if(N(this.globe))return this.globe.imageryLayers}},terrainProvider:{get:function(){if(N(this.globe))return this.globe.terrainProvider},set:function(e){N(this.globe)&&(this.globe.terrainProvider=e)}},terrainProviderChanged:{get:function(){if(N(this.globe))return this.globe.terrainProviderChanged}},preUpdate:{get:function(){return this._preUpdate}},postUpdate:{get:function(){return this._postUpdate}},renderError:{get:function(){return this._renderError}},preRender:{get:function(){return this._preRender}},postRender:{get:function(){return this._postRender}},lastRenderTime:{get:function(){return this._lastRenderTime}},context:{get:function(){return this._context}},debugFrustumStatistics:{get:function(){return this._debugFrustumStatistics}},scene3DOnly:{get:function(){return this._frameState.scene3DOnly}},orderIndependentTranslucency:{get:function(){return N(this._oit)}},id:{get:function(){return this._id}},mode:{get:function(){return this._mode},set:function(e){if(this.scene3DOnly&&e!==_e.SCENE3D)throw new b("Only SceneMode.SCENE3D is valid when scene3DOnly is true.");if(e===_e.SCENE2D)this.morphTo2D(0);else if(e===_e.SCENE3D)this.morphTo3D(0);else{if(e!==_e.COLUMBUS_VIEW)throw new b("value must be a valid SceneMode enumeration.");this.morphToColumbusView(0)}this._mode=e}},numberOfFrustums:{get:function(){return this._frustumCommandsList.length}},terrainExaggeration:{get:function(){return this._terrainExaggeration}},useWebVR:{get:function(){return this._useWebVR},set:function(e){if(this.camera.frustum instanceof O)throw new b("VR is unsupported with an orthographic projection.");this._useWebVR=e,this._useWebVR?(this._frameState.creditDisplay.container.style.visibility="hidden",this._cameraVR=new J(this),N(this._deviceOrientationCameraController)||(this._deviceOrientationCameraController=new re(this)),this._aspectRatioVR=this._camera.frustum.aspectRatio):(this._frameState.creditDisplay.container.style.visibility="visible",this._cameraVR=void 0,this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy(),this._camera.frustum.aspectRatio=this._aspectRatioVR,this._camera.frustum.xOffset=0)}},mapMode2D:{get:function(){return this._mapMode2D}},imagerySplitPosition:{get:function(){return this._frameState.imagerySplitPosition},set:function(e){this._frameState.imagerySplitPosition=e}},minimumDisableDepthTestDistance:{get:function(){return this._minimumDisableDepthTestDistance},set:function(e){if(!N(e)||e<0)throw new b("minimumDisableDepthTestDistance must be greater than or equal to 0.0.");this._minimumDisableDepthTestDistance=e}}}),Ee.prototype.getCompressedTextureFormatSupported=function(e){var t=this.context;return("WEBGL_compressed_texture_s3tc"===e||"s3tc"===e)&&t.s3tc||("WEBGL_compressed_texture_pvrtc"===e||"pvrtc"===e)&&t.pvrtc||("WEBGL_compressed_texture_etc1"===e||"etc1"===e)&&t.etc1};var xe=new w,Pe=new w;function De(e,t,r){var i,n,o,a,s,l=1/Math.max(1,(i=e.position,n=t.position,o=Math.max(Math.abs(i.x),Math.abs(n.x)),a=Math.max(Math.abs(i.y),Math.abs(n.y)),s=Math.max(Math.abs(i.z),Math.abs(n.z)),Math.max(Math.max(o,a),s)));return w.multiplyByScalar(e.position,l,xe),w.multiplyByScalar(t.position,l,Pe),w.equalsEpsilon(xe,Pe,r)&&w.equalsEpsilon(e.direction,t.direction,r)&&w.equalsEpsilon(e.up,t.up,r)&&w.equalsEpsilon(e.right,t.right,r)&&D.equalsEpsilon(e.transform,t.transform,r)}function Oe(e,t){var r=e.frameState,i=e._context,n=r.shadowHints.shadowsEnabled,o=r.shadowHints.shadowMaps,a=r.shadowHints.lightShadowMaps,s=n&&0<a.length,l=!1,u=r.shadowHints.lastDirtyTime;t.lastDirtyTime!==u&&(t.lastDirtyTime=u,l=t.dirty=!0);var c=t.derivedCommands;if(t.dirty&&N(c)){t.dirty=!1,n&&(t.receiveShadows||t.castShadows)&&(c.shadows=Ce.createDerivedCommands(o,a,t,l,i,c.shadows));var d=e._oit;t.pass===W.TRANSLUCENT&&N(d)&&d.isSupported()&&(s&&t.receiveShadows?(c.oit=N(c.oit)?c.oit:{},c.oit.shadows=d.createDerivedCommands(t.derivedCommands.shadows.receiveCommand,i,c.oit.shadows)):c.oit=d.createDerivedCommands(t,i,c.oit)),c.depth=function(e,t,r,i){N(i)||(i={});var n,o;N(i.depthOnlyCommand)&&(n=i.depthOnlyCommand.shaderProgram,o=i.depthOnlyCommand.renderState);i.depthOnlyCommand=q.shallowClone(t,i.depthOnlyCommand),N(n)&&i.shaderProgramId===t.shaderProgram.id?(i.depthOnlyCommand.shaderProgram=n,i.depthOnlyCommand.renderState=o):(i.depthOnlyCommand.shaderProgram=function(e,t){var r=e.shaderCache.getDerivedShaderProgram(t,"depthOnly");if(!N(r)){for(var i=t._attributeLocations,n=t.fragmentShaderSource,o=!1,a=n.sources,s=a.length,l=0;l<s;++l)if(Rt.test(a[l])||Lt.test(a[l])){o=!0;break}o||(n=new Q({sources:["void main() { gl_FragColor = vec4(1.0); }"]})),r=e.shaderCache.createDerivedShaderProgram(t,"depthOnly",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:n,attributeLocations:i})}return r}(r,t.shaderProgram),i.depthOnlyCommand.renderState=function(e,t){var r=e._depthOnlyRenderStateCache,i=r[t.id];if(!N(i)){var n=Y.getState(t);n.depthMask=!0,n.colorMask={red:!1,green:!1,blue:!1,alpha:!1},i=Y.fromCache(n),r[t.id]=i}return i}(e,t.renderState),i.shaderProgramId=t.shaderProgram.id);return i}(e,t,i,c.depth)}}var Ie,Me=new e;function Re(e){e.render=!1,e.pick=!1,e.depth=!1}function Le(e,t,r){var i=e._camera,n=e._frameState;n.commandList.length=0,n.shadowMaps.length=0,n.brdfLutGenerator=e._brdfLutGenerator,n.environmentMap=e.skyBox&&e.skyBox._cubeMap,n.mode=e._mode,n.morphTime=e.morphTime,n.mapProjection=e.mapProjection,n.frameNumber=t,n.time=P.clone(r,n.time),n.camera=i,n.cullingVolume=i.frustum.computeCullingVolume(i.positionWC,i.directionWC,i.upWC),n.occluder=function(e){var t=e.globe;if(e._mode===_e.SCENE3D&&N(t)){var r=t.ellipsoid;return Me.radius=r.minimumRadius,Ie=c.fromBoundingSphere(Me,e._camera.positionWC,Ie)}}(e),n.terrainExaggeration=e._terrainExaggeration,n.minimumDisableDepthTestDistance=e._minimumDisableDepthTestDistance,n.invertClassification=e.invertClassification,e._actualInvertClassificationColor=m.clone(e.invertClassificationColor,e._actualInvertClassificationColor),le.isTranslucencySupported(e._context)||(e._actualInvertClassificationColor.alpha=1),n.invertClassificationColor=e._actualInvertClassificationColor,N(e.globe)?n.maximumScreenSpaceError=e.globe.maximumScreenSpaceError:n.maximumScreenSpaceError=2,Re(n.passes)}function Ne(e,t,r,i,n,o,a){n.length=i;for(var s=0;s<i;++s){var l,u;u=o?(l=Math.min(t-a,e+s*a),Math.min(t,l+a)):(l=Math.max(e,Math.pow(r,s)*e),Math.min(t,r*l));var c=n[s];N(c)?(c.near=l,c.far=u):c=n[s]=new oe(l,u)}}function ke(e,t,r){e.debugShowFrustums&&(t.debugOverlappingFrustums=0),e.frameState.passes.pick||Oe(e,t);for(var i=e._frustumCommandsList,n=i.length,o=0;o<n;++o){var a=i[o],s=a.near,l=a.far;if(!(r.start>l)){if(r.stop<s)break;var u=t.pass,c=a.indices[u]++;if(a.commands[u][c]=t,e.debugShowFrustums&&(t.debugOverlappingFrustums|=1<<o),t.executeInClosestFrustum)break}}if(e.debugShowFrustums){var d=e._debugFrustumStatistics.commandsInFrustums;d[t.debugOverlappingFrustums]=N(d[t.debugOverlappingFrustums])?d[t.debugOverlappingFrustums]+1:1,++e._debugFrustumStatistics.totalCommands}}var Fe=new i,Be=new l;function Ue(e,t,r){return N(e)&&(!N(e.boundingVolume)||!e.cull||t.computeVisibility(e.boundingVolume)!==s.OUTSIDE&&(!N(r)||!e.boundingVolume.isOccluded(r)))}function Ve(e){var t=e._frameState,r=t.camera,i=r.directionWC,n=r.positionWC,o=e._computeCommandList,a=e._overlayCommandList,s=t.commandList;e.debugShowFrustums&&(e._debugFrustumStatistics={totalCommands:0,commandsInFrustums:{}});for(var l=e._frustumCommandsList,u=l.length,c=W.NUMBER_OF_PASSES,d=0;d<u;++d)for(var h=0;h<c;++h)l[d].indices[h]=0;o.length=0,a.length=0;for(var p=Number.MAX_VALUE,f=-Number.MAX_VALUE,m=!1,g=t.shadowHints.shadowsEnabled,_=Number.MAX_VALUE,v=-Number.MAX_VALUE,y=Number.MAX_VALUE,b=t.mode===_e.SCENE3D?t.occluder:void 0,C=t.cullingVolume,w=Fe.planes,S=0;S<5;++S)w[S]=C.planes[S];C=Fe;for(var T=s.length,E=0;E<T;++E){var A=s[E],x=A.pass;if(x===W.COMPUTE)o.push(A);else if(x===W.OVERLAY)a.push(A);else{var P=A.boundingVolume;if(N(P)){if(!Ue(A,C,b))continue;if(Be=P.computePlaneDistances(n,i,Be),p=Math.min(p,Be.start),f=Math.max(f,Be.stop),g&&A.receiveShadows&&Be.start<Ce.MAXIMUM_DISTANCE&&!(x===W.GLOBE&&Be.start<-100&&100<Be.stop)){var D=Be.stop-Be.start;x!==W.GLOBE&&Be.start<100&&(y=Math.min(y,D)),_=Math.min(_,Be.start),v=Math.max(v,Be.stop)}}else Be.start=r.frustum.near,Be.stop=r.frustum.far,m=!(A instanceof B);ke(e,A,Be)}}m?(p=r.frustum.near,f=r.frustum.far):(p=Math.min(Math.max(p,r.frustum.near),r.frustum.far),f=Math.max(Math.min(f,r.frustum.far),p),g&&(_=Math.min(Math.max(_,r.frustum.near),r.frustum.far),v=Math.max(Math.min(v,r.frustum.far),_))),g&&(t.shadowHints.nearPlane=_,t.shadowHints.farPlane=v,t.shadowHints.closestObjectSize=y);var O,I=e.mode===_e.SCENE2D,M=e.farToNearRatio;O=I?(f=Math.min(f,r.position.z+e.nearToFarDistance2D),p=Math.min(p,f),Math.ceil(Math.max(1,f-p)/e.nearToFarDistance2D)):Math.ceil(Math.log(f/p)/Math.log(M)),p!==Number.MAX_VALUE&&(O!==u||0!==l.length&&(p<l[0].near||f>l[u-1].far&&!k.equalsEpsilon(f,l[u-1].far,k.EPSILON8)))&&(Ne(p,f,M,O,l,I,e.nearToFarDistance2D),Ve(e));var R=t.frustumSplits;R.length=O+1;for(var L=0;L<O;++L)R[L]=l[L].near,L===O-1&&(R[L+1]=l[L].far)}function ze(e,t,r){var i=q.shallowClone(e);i.shaderProgram=function(e,t,r){var i=t.context,n=y(r,e.shaderProgram),o=n.fragmentShaderSource.clone(),a=[];o.sources=o.sources.map(function(e){e=Q.replaceMain(e,"czm_Debug_main");for(var t,r=/gl_FragData\[(\d+)\]/g;null!==(t=r.exec(e));)-1===a.indexOf(t[1])&&a.push(t[1]);return e});var s,l=a.length,u="void main() \n{ \n    czm_Debug_main(); \n";if(t.debugShowCommands){N(e._debugColor)||(e._debugColor=m.fromRandom());var c=e._debugColor;if(0<l)for(s=0;s<l;++s)u+="    gl_FragData["+a[s]+"].rgb *= vec3("+c.red+", "+c.green+", "+c.blue+"); \n";else u+="    gl_FragColor.rgb *= vec3("+c.red+", "+c.green+", "+c.blue+"); \n"}if(t.debugShowFrustums){var d=1&e.debugOverlappingFrustums?"1.0":"0.0",h=2&e.debugOverlappingFrustums?"1.0":"0.0",p=4&e.debugOverlappingFrustums?"1.0":"0.0";if(0<l)for(s=0;s<l;++s)u+="    gl_FragData["+a[s]+"].rgb *= vec3("+d+", "+h+", "+p+"); \n";else u+="    gl_FragColor.rgb *= vec3("+d+", "+h+", "+p+"); \n"}u+="}",o.sources.push(u);var f=function(e){var t={},r=e.vertexAttributes;for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i].index);return t}(n);return X.fromCache({context:i,vertexShaderSource:n.vertexShaderSource,fragmentShaderSource:o,attributeLocations:f})}(e,t),i.execute(t.context,r),i.shaderProgram.destroy()}var qe=new D(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1);function Ge(e,t,r,i,n){if(!N(t.debugCommandFilter)||t.debugCommandFilter(e))if(e instanceof B)e.execute(r,i);else{var o=t.frameState.shadowHints.shadowsEnabled&&0<t.frameState.shadowHints.lightShadowMaps.length;if(t.debugShowCommands||t.debugShowFrustums?ze(e,t,i):o&&e.receiveShadows&&N(e.derivedCommands.shadows)?e.derivedCommands.shadows.receiveCommand.execute(r,i):t.frameState.passes.depth&&N(e.derivedCommands.depth)?e.derivedCommands.depth.depthOnlyCommand.execute(r,i):e.execute(r,i),e.debugShowBoundingVolume&&N(e.boundingVolume)){var a,s=t._frameState,l=e.boundingVolume;N(t._debugVolume)&&t._debugVolume.destroy();var u=w.clone(l.center);if(s.mode!==_e.SCENE3D){u=D.multiplyByPoint(qe,u,u);var c=s.mapProjection,d=c.unproject(u);u=c.ellipsoid.cartographicToCartesian(d)}if(N(l.radius)){var h=l.radius;a=x.toWireframe(S.createGeometry(new S({radii:new w(h,h,h),vertexFormat:pe.FLAT_VERTEX_FORMAT}))),t._debugVolume=new me({geometryInstances:new A({geometry:a,modelMatrix:D.fromTranslation(u),attributes:{color:new v(1,0,0,1)}}),appearance:new pe({flat:!0,translucent:!1}),asynchronous:!1})}else{var p=l.halfAxes;a=x.toWireframe(_.createGeometry(_.fromDimensions({dimensions:new w(2,2,2),vertexFormat:pe.FLAT_VERTEX_FORMAT}))),t._debugVolume=new me({geometryInstances:new A({geometry:a,modelMatrix:D.fromRotationTranslation(p,u,new D),attributes:{color:new v(1,0,0,1)}}),appearance:new pe({flat:!0,translucent:!1}),asynchronous:!1})}var f,m=s.commandList,g=s.commandList=[];t._debugVolume.update(s),N(n)&&(f=i.framebuffer,i.framebuffer=n),g[0].execute(r,i),N(f)&&(i.framebuffer=f),s.commandList=m}}}function We(e,t,r){return t.boundingVolume.distanceSquaredTo(r)-e.boundingVolume.distanceSquaredTo(r)}function He(e,t,r,i,n){var o=e.context;u(i,We,e._camera.positionWC),N(n)&&t(n.unclassifiedCommand,e,o,r);for(var a=i.length,s=0;s<a;++s)t(i[s],e,o,r)}function je(e,t){var r=e._debugGlobeDepths[t];return!N(r)&&e.context.depthTexture&&(r=new se,e._debugGlobeDepths[t]=r),r}function Ye(e,t){var r=e._pickDepths[t];return N(r)||(r=new fe,e._pickDepths[t]=r),r}qe=D.inverseTransformation(qe,qe);var Xe=new d,Qe=new h,Ze=new O,Ke=new I;function Je(e,t){var r,i=e._camera,n=e.context,o=n.uniformState;o.updateCamera(i),(r=N(i.frustum.fov)?i.frustum.clone(Xe):N(i.frustum.infiniteProjectionMatrix)?i.frustum.clone(Qe):N(i.frustum.width)?i.frustum.clone(Ze):i.frustum.clone(Ke)).near=i.frustum.near,r.far=i.frustum.far,o.updateFrustum(r),o.updatePass(W.ENVIRONMENT);var a,s=e._useWebVR&&e.mode!==_e.SCENE2D,l=e._frameState.passes,u=l.pick,c=l.depth,d=e._environmentState;if(!u){var h,p=d.skyBoxCommand;if(N(p)&&Ge(p,e,n,t),d.isSkyAtmosphereVisible&&Ge(d.skyAtmosphereCommand,e,n,t),d.isSunVisible)if(d.sunDrawCommand.execute(n,t),e.sunBloom&&!s)h=d.useGlobeDepthFramebuffer?e._globeDepth.framebuffer:d.useFXAA?e._fxaa.getColorFramebuffer():d.originalFramebuffer,e._sunPostProcess.execute(n,h),t.framebuffer=h;d.isMoonVisible&&d.moonCommand.execute(n,t)}a=d.useOIT?(N(e._executeOITFunction)||(e._executeOITFunction=function(e,t,r,i,n){e._oit.executeCommands(e,t,r,i,n)}),e._executeOITFunction):He;for(var f,m=d.clearGlobeDepth,g=d.useDepthPlane,_=e._depthClearCommand,v=e._depthPlane,y=i.position.z,b=e._frustumCommandsList,C=b.length,w=0;w<C;++w){var S=C-w-1,T=b[S];e.mode===_e.SCENE2D?(i.position.z=y-T.near+1,r.far=Math.max(1,T.far-T.near),r.near=1,o.update(e.frameState)):(r.near=0!==S?T.near*Ae:T.near,r.far=T.far),o.updateFrustum(r);var E,A=e.debugShowGlobeDepth?je(e,S):e._globeDepth;e.debugShowGlobeDepth&&N(A)&&d.useGlobeDepthFramebuffer&&(E=t.framebuffer,t.framebuffer=A.framebuffer),_.execute(n,t),e._stencilClearCommand.execute(n,t),o.updatePass(W.GLOBE);var x,P=T.commands[W.GLOBE],D=T.indices[W.GLOBE];for(f=0;f<D;++f)Ge(P[f],e,n,t);for(N(A)&&d.useGlobeDepthFramebuffer&&(e.copyGlobeDepth||e.debugShowGlobeDepth)&&(A.update(n,t),A.executeCopyDepth(n,t)),e.debugShowGlobeDepth&&N(A)&&d.useGlobeDepthFramebuffer&&(t.framebuffer=E),o.updatePass(W.TERRAIN_CLASSIFICATION),P=T.commands[W.TERRAIN_CLASSIFICATION],D=T.indices[W.TERRAIN_CLASSIFICATION],f=0;f<D;++f)Ge(P[f],e,n,t);for(o.updatePass(W.CLASSIFICATION),P=T.commands[W.CLASSIFICATION],D=T.indices[W.CLASSIFICATION],f=0;f<D;++f)Ge(P[f],e,n,t);if(m&&_.execute(n,t),!d.useInvertClassification||u){for(o.updatePass(W.CESIUM_3D_TILE),P=T.commands[W.CESIUM_3D_TILE],D=T.indices[W.CESIUM_3D_TILE],f=0;f<D;++f)Ge(P[f],e,n,t);for(o.updatePass(W.CESIUM_3D_TILE_CLASSIFICATION),P=T.commands[W.CESIUM_3D_TILE_CLASSIFICATION],D=T.indices[W.CESIUM_3D_TILE_CLASSIFICATION],f=0;f<D;++f)Ge(P[f],e,n,t);for(o.updatePass(W.CLASSIFICATION),P=T.commands[W.CLASSIFICATION],D=T.indices[W.CLASSIFICATION],f=0;f<D;++f)Ge(P[f],e,n,t)}else{e._invertClassification.clear(n,t);var O=t.framebuffer;for(t.framebuffer=e._invertClassification._fbo,o.updatePass(W.CESIUM_3D_TILE),P=T.commands[W.CESIUM_3D_TILE],D=T.indices[W.CESIUM_3D_TILE],f=0;f<D;++f)Ge(P[f],e,n,t);for(o.updatePass(W.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW),P=T.commands[W.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW],D=T.indices[W.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW],f=0;f<D;++f)Ge(P[f],e,n,t);for(t.framebuffer=O,e._invertClassification.executeClassified(n,t),1===e.frameState.invertClassificationColor.alpha&&e._invertClassification.executeUnclassified(n,t),0<D&&n.stencilBuffer&&e._stencilClearCommand.execute(n,t),o.updatePass(W.CESIUM_3D_TILE_CLASSIFICATION),P=T.commands[W.CESIUM_3D_TILE_CLASSIFICATION],D=T.indices[W.CESIUM_3D_TILE_CLASSIFICATION],f=0;f<D;++f)Ge(P[f],e,n,t);for(o.updatePass(W.CLASSIFICATION),P=T.commands[W.CLASSIFICATION],D=T.indices[W.CLASSIFICATION],f=0;f<D;++f)Ge(P[f],e,n,t)}for(0<D&&n.stencilBuffer&&e._stencilClearCommand.execute(n,t),m&&g&&v.execute(n,t),o.updatePass(W.OPAQUE),P=T.commands[W.OPAQUE],D=T.indices[W.OPAQUE],f=0;f<D;++f)Ge(P[f],e,n,t);if(0!==S&&e.mode!==_e.SCENE2D&&(r.near=T.near,o.updateFrustum(r)),!u&&d.useInvertClassification&&e.frameState.invertClassificationColor.alpha<1&&(x=e._invertClassification),o.updatePass(W.TRANSLUCENT),(P=T.commands[W.TRANSLUCENT]).length=T.indices[W.TRANSLUCENT],a(e,Ge,t,P,x),N(A)&&(d.useGlobeDepthFramebuffer||c)&&e.useDepthPicking){var I=c?t.framebuffer.depthStencilTexture:A.framebuffer.depthStencilTexture,M=Ye(e,S);M.update(n,I),M.executeCopyDepth(n,t)}}}function $e(e){e.context.uniformState.updatePass(W.COMPUTE);var t=e._environmentState.sunComputeCommand;N(t)&&t.execute(e._computeEngine);for(var r=e._computeCommandList,i=r.length,n=0;n<i;++n)r[n].execute(e._computeEngine)}function et(e,t,r){for(var i=r.shadowMapCullingVolume,n=r.isPointLight,o=r.passes,a=o.length,s=t.length,l=0;l<s;++l){var u=t[l];if(Oe(e,u),u.castShadows&&(u.pass===W.GLOBE||u.pass===W.CESIUM_3D_TILE||u.pass===W.OPAQUE||u.pass===W.TRANSLUCENT)&&Ue(u,i))if(n)for(var c=0;c<a;++c)o[c].commandList.push(u);else if(1===a)o[0].commandList.push(u);else for(var d=!1,h=a-1;0<=h;--h){if(Ue(u,o[h].cullingVolume))o[h].commandList.push(u),d=!0;else if(d)break}}}function tt(e){var t=e.frameState,r=t.shadowHints.shadowMaps,i=r.length;if(t.shadowHints.shadowsEnabled)for(var n=e.context,o=n.uniformState,a=0;a<i;++a){var s=r[a];if(!s.outOfView){var l,u=s.passes,c=u.length;for(l=0;l<c;++l)u[l].commandList.length=0;for(et(e,e.frameState.commandList,s),l=0;l<c;++l){var d=s.passes[l];o.updateCamera(d.camera),s.updatePass(n,l);for(var h=d.commandList.length,p=0;p<h;++p){var f=d.commandList[p];o.updatePass(f.pass),Ge(f.derivedCommands.shadows.castCommands[a],e,n,d.passState)}}}}}var rt=new w;function it(e,t,r){var i=e._context,n=t.viewport;n.x=0,n.y=0,n.width=i.drawingBufferWidth,n.height=i.drawingBufferHeight;var o=e._frameState,a=o.camera,s=o.mode,l=o.passes.depth;if(e._useWebVR&&s!==_e.SCENE2D){mt(e,t,r),l||ft(e),Ve(e),l||($e(e),tt(e)),n.x=0,n.y=0,n.width=.5*i.drawingBufferWidth,n.height=i.drawingBufferHeight;var u=J.clone(a,e._cameraVR),c=a.frustum.near,d=c*y(e.focalLength,5),h=y(e.eyeSeparation,d/30),p=w.multiplyByScalar(u.right,.5*h,rt);a.frustum.aspectRatio=n.width/n.height;var f=.5*h*c/d;w.add(u.position,p,a.position),a.frustum.xOffset=f,Je(e,t),n.x=t.viewport.width,w.subtract(u.position,p,a.position),a.frustum.xOffset=-f,Je(e,t),J.clone(u,a)}else s!==_e.SCENE2D||e._mapMode2D===ce.ROTATE?ht(!0,e,t,r):(mt(e,t,r),function(e,t){var r=e.context,i=e.frameState,n=e.camera,o=t.viewport,a=C.clone(o,dt);t.viewport=a;var s=nt,l=ot;e.mapProjection.project(s,l);var u=w.clone(n.position,at),c=D.clone(n.transform,lt),d=n.frustum.clone();n._setTransform(D.IDENTITY);var h=D.computeViewportTransformation(a,0,1,st),p=n.frustum.projectionMatrix,f=n.positionWC.y,m=w.fromElements(k.sign(f)*l.x-f,0,-n.positionWC.x,ut),g=F.pointToGLWindowCoordinates(p,h,m,ct);g.x=Math.floor(g.x);var _=a.x,v=a.width;if(0===f||g.x<=_||g.x>=_+v)ht(!0,e,t);else if(Math.abs(_+.5*v-g.x)<1)a.width=g.x-a.x,n.position.x*=k.sign(n.position.x),n.frustum.right=0,i.cullingVolume=n.frustum.computeCullingVolume(n.positionWC,n.directionWC,n.upWC),r.uniformState.update(i),ht(!0,e,t),a.x=g.x,n.position.x=-n.position.x,n.frustum.right=-n.frustum.left,n.frustum.left=0,i.cullingVolume=n.frustum.computeCullingVolume(n.positionWC,n.directionWC,n.upWC),r.uniformState.update(i),ht(!1,e,t);else if(g.x>_+.5*v){a.width=g.x-_;var y=n.frustum.right;n.frustum.right=l.x-f,i.cullingVolume=n.frustum.computeCullingVolume(n.positionWC,n.directionWC,n.upWC),r.uniformState.update(i),ht(!0,e,t),a.x=g.x,a.width=_+v-g.x,n.position.x=-n.position.x,n.frustum.left=-n.frustum.right,n.frustum.right=y-2*n.frustum.right,i.cullingVolume=n.frustum.computeCullingVolume(n.positionWC,n.directionWC,n.upWC),r.uniformState.update(i),ht(!1,e,t)}else{a.x=g.x,a.width=_+v-g.x;var b=n.frustum.left;n.frustum.left=-l.x-f,i.cullingVolume=n.frustum.computeCullingVolume(n.positionWC,n.directionWC,n.upWC),r.uniformState.update(i),ht(!0,e,t),a.x=_,a.width=g.x-_,n.position.x=-n.position.x,n.frustum.right=-n.frustum.left,n.frustum.left=b-2*n.frustum.left,i.cullingVolume=n.frustum.computeCullingVolume(n.positionWC,n.directionWC,n.upWC),r.uniformState.update(i),ht(!1,e,t)}n._setTransform(c),w.clone(u,n.position),n.frustum=d.clone(),t.viewport=o}(e,t))}var nt=new r(Math.PI,k.PI_OVER_TWO),ot=new w,at=new w,st=new D,lt=new D,ut=new w,ct=new w,dt=new C;function ht(e,t,r,i){var n=t.frameState.passes.depth;e||n||(t.frameState.commandList.length=0),n||ft(t),Ve(t),e&&(N(i)&&mt(t,r,i),n||($e(t),tt(t))),Je(t,r)}function pt(e,t){var r=e._frameState,i=e._environmentState,n=r.passes.render,o=e.skyAtmosphere,a=e.globe;if(!n||e._mode!==_e.SCENE2D&&r.camera.frustum instanceof O)i.skyAtmosphereCommand=void 0,i.skyBoxCommand=void 0,i.sunDrawCommand=void 0,i.sunComputeCommand=void 0,i.moonCommand=void 0;else{N(o)&&N(a)&&(o.setDynamicAtmosphereColor(a.enableLighting),i.isReadyForAtmosphere=i.isReadyForAtmosphere||0<a._surface._tilesToRender.length),i.skyAtmosphereCommand=N(o)?o.update(r):void 0,i.skyBoxCommand=N(e.skyBox)?e.skyBox.update(r):void 0;var s=N(e.sun)?e.sun.update(r,t):void 0;i.sunDrawCommand=N(s)?s.drawCommand:void 0,i.sunComputeCommand=N(s)?s.computeCommand:void 0,i.moonCommand=N(e.moon)?e.moon.update(r):void 0}var l=i.clearGlobeDepth=N(a)&&(!a.depthTestAgainstTerrain||e.mode===_e.SCENE2D);(i.useDepthPlane=l&&e.mode===_e.SCENE3D)&&e._depthPlane.update(r);for(var u=r.mode===_e.SCENE3D?r.occluder:void 0,c=r.cullingVolume,d=Fe.planes,h=0;h<5;++h)d[h]=c.planes[h];c=Fe,i.isSkyAtmosphereVisible=N(i.skyAtmosphereCommand)&&i.isReadyForAtmosphere,i.isSunVisible=Ue(i.sunDrawCommand,c,u),i.isMoonVisible=Ue(i.moonCommand,c,u)}function ft(e){var t,r,i=e._frameState;e._groundPrimitives.update(i),e._primitives.update(i),r=(t=e)._frameState,t.debugShowFrustumPlanes!==t._debugShowFrustumPlanes&&(t.debugShowFrustumPlanes?t._debugFrustumPlanes=new ee({camera:t.camera,updateOnChange:!1}):t._debugFrustumPlanes=t._debugFrustumPlanes&&t._debugFrustumPlanes.destroy(),t._debugShowFrustumPlanes=t.debugShowFrustumPlanes),N(t._debugFrustumPlanes)&&t._debugFrustumPlanes.update(r),function(e){var t=e._frameState,r=t.shadowMaps,i=r.length,n=0<i&&!t.passes.pick&&e.mode===_e.SCENE3D;if(n!==t.shadowHints.shadowsEnabled&&(++t.shadowHints.lastDirtyTime,t.shadowHints.shadowsEnabled=n),n){for(var o=0;o<i;++o)if(r[o]!==t.shadowHints.shadowMaps[o]){++t.shadowHints.lastDirtyTime;break}t.shadowHints.shadowMaps.length=0;for(var a=t.shadowHints.lightShadowMaps.length=0;a<i;++a){var s=r[a];s.update(t),t.shadowHints.shadowMaps.push(s),s.fromLightSource&&t.shadowHints.lightShadowMaps.push(s),s.dirty&&(++t.shadowHints.lastDirtyTime,s.dirty=!1)}}}(e),e._globe&&e._globe.render(i)}function mt(e,t,r){var i=e._context,n=e._environmentState,o=e._frameState.passes.pick,a=e._useWebVR&&e.mode!==_e.SCENE2D;n.originalFramebuffer=t.framebuffer,N(e.sun)&&e.sunBloom!==e._sunBloom?(e.sunBloom&&!a?e._sunPostProcess=new we:N(e._sunPostProcess)&&(e._sunPostProcess=e._sunPostProcess.destroy()),e._sunBloom=e.sunBloom):!N(e.sun)&&N(e._sunPostProcess)&&(e._sunPostProcess=e._sunPostProcess.destroy(),e._sunBloom=!1);var s=e._clearColorCommand;m.clone(r,s.color),s.execute(i,t);var l=n.useGlobeDepthFramebuffer=!o&&N(e._globeDepth);l&&(e._globeDepth.update(i,t),e._globeDepth.clear(i,t,r));var u=n.useOIT=!o&&N(e._oit)&&e._oit.isSupported();u&&(e._oit.update(i,t,e._globeDepth.framebuffer),e._oit.clear(i,t,r),n.useOIT=e._oit.isSupported());var c,d=n.useFXAA=!o&&e.fxaa;if((d&&(e._fxaa.update(i,t),e._fxaa.clear(i,t,r)),n.isSunVisible&&e.sunBloom&&!a?t.framebuffer=e._sunPostProcess.update(t):l?t.framebuffer=e._globeDepth.framebuffer:d&&(t.framebuffer=e._fxaa.getColorFramebuffer()),N(t.framebuffer)&&s.execute(i,t),n.useInvertClassification=!o&&N(t.framebuffer)&&e.invertClassification)&&(1===e.frameState.invertClassificationColor.alpha&&(n.useGlobeDepthFramebuffer?c=e._globeDepth.framebuffer:n.useFXAA&&(c=e._fxaa.getColorFramebuffer())),e._invertClassification.previousFramebuffer=c,e._invertClassification.update(i),e._invertClassification.clear(i,t),e.frameState.invertClassificationColor.alpha<1&&u)){var h=e._invertClassification.unclassifiedCommand,p=h.derivedCommands;p.oit=e._oit.createDerivedCommands(h,i,p.oit)}}function gt(e,t){var r=e._context,i=e._environmentState,n=i.useGlobeDepthFramebuffer;e.debugShowGlobeDepth&&n&&je(e,e.debugShowDepthFrustum-1).executeDebugGlobeDepth(r,t);e.debugShowPickDepth&&n&&Ye(e,e.debugShowDepthFrustum-1).executeDebugPickDepth(r,t);var o=i.useOIT,a=i.useFXAA;o&&(t.framebuffer=a?e._fxaa.getColorFramebuffer():void 0,e._oit.execute(r,t)),a&&(!o&&n&&(t.framebuffer=e._fxaa.getColorFramebuffer(),e._globeDepth.executeCopyColor(r,t)),t.framebuffer=i.originalFramebuffer,e._fxaa.execute(r,t)),o||a||!n||(t.framebuffer=i.originalFramebuffer,e._globeDepth.executeCopyColor(r,t))}function _t(e){for(var t=e._frameState.afterRender,r=0,i=t.length;r<i;++r)t[r](),e.requestRender();t.length=0}function vt(e){var t=e._frameState;N(e.globe)&&e.globe.update(t),t.creditDisplay.update()}function yt(e,t){e._pickPositionCacheDirty=!0;var r=e.context,i=r.uniformState,n=e._frameState;Le(e,k.incrementWrap(n.frameNumber,15e6,1),t),n.passes.render=!0;var o=y(e.backgroundColor,m.BLACK);n.backgroundColor=o,n.creditDisplay.beginFrame(),e.fog.update(n),i.update(n);var a=e.shadowMap;N(a)&&a.enabled&&(w.negate(i.sunDirectionWC,e._sunCamera.direction),n.shadowMaps.push(a)),e._computeCommandList.length=0,e._overlayCommandList.length=0;var s=e._passState;s.framebuffer=void 0,s.blendingEnabled=void 0,s.scissorTest=void 0,N(e.globe)&&e.globe.beginFrame(n),pt(e,s),it(e,s,o),gt(e,s),function(e,t){e.context.uniformState.updatePass(W.OVERLAY);for(var r=e.context,i=e._overlayCommandList,n=i.length,o=0;o<n;++o)i[o].execute(r,t)}(e,s),N(e.globe)&&e.globe.endFrame(n),n.creditDisplay.endFrame(),r.endFrame()}function bt(t,e,r){try{r(t,e)}catch(e){if(t._renderError.raiseEvent(t,e),t.rethrowRenderErrors)throw e}}Ee.prototype.initializeFrame=function(){120==this._shaderFrameCount++&&(this._shaderFrameCount=0,this._context.shaderCache.destroyReleasedShaderPrograms()),this._tweens.update(),this._screenSpaceCameraController.update(),N(this._deviceOrientationCameraController)&&this._deviceOrientationCameraController.update(),this._camera.update(this._mode),this._camera._updateCameraChanged()},Ee.prototype.render=function(e){N(e)||(e=P.now()),this._jobScheduler.resetBudgets(),this._preUpdate.raiseEvent(this,e),bt(this,e,vt),this._postUpdate.raiseEvent(this,e);var t,r,i=De(r=(t=this)._camera,t._cameraClone,k.EPSILON15)?(t._cameraStartFired&&a()-t._cameraMovedTime>t.cameraEventWaitTime&&(r.moveEnd.raiseEvent(),t._cameraStartFired=!1),!1):(t._cameraStartFired||(r.moveStart.raiseEvent(),t._cameraStartFired=!0),t._cameraMovedTime=a(),J.clone(r,t._cameraClone),!0),n=!this.requestRenderMode||this._renderRequested||i||this.mode===_e.MORPHING;if(!n&&N(this.maximumRenderTimeChange)&&N(this._lastRenderTime)){var o=Math.abs(P.secondsDifference(this._lastRenderTime,e));n=n||o>this.maximumRenderTimeChange}n&&(this._lastRenderTime=P.clone(e,this._lastRenderTime),this._renderRequested=!1,this._preRender.raiseEvent(this,e),bt(this,e,yt),this._postRender.raiseEvent(this,e),R.update()),function(e,t){if(e.debugShowFramesPerSecond){if(!N(e._performanceDisplay)){var r=document.createElement("div");r.className="cesium-performanceDisplay-defaultContainer",e._canvas.parentNode.appendChild(r);var i=new he({container:r});e._performanceDisplay=i,e._performanceContainer=r}e._performanceDisplay.throttled=e.requestRenderMode,e._performanceDisplay.update(t)}else N(e._performanceDisplay)&&(e._performanceDisplay=e._performanceDisplay&&e._performanceDisplay.destroy(),e._performanceContainer.parentNode.removeChild(e._performanceContainer))}(this,n),_t(this)},Ee.prototype.forceRender=function(e){this._renderRequested=!0,this.render(e)},Ee.prototype.requestRender=function(){this._renderRequested=!0},Ee.prototype.clampLineWidth=function(e){return Math.max(z.minimumAliasedLineWidth,Math.min(e,z.maximumAliasedLineWidth))};var Ct=new I,wt=new w,St=new w,Tt=new t,Et=new D;var At=new h;function xt(e,t,r,i){var n,o,a,s,l,u,c,d,h,p,f,m,g,_,v,y,b=e.camera.frustum;return b instanceof O||b instanceof I?function(e,t,r,i){var n=e._camera,o=n.frustum;N(o._offCenterFrustum)&&(o=o._offCenterFrustum);var a=e._passState.viewport,s=2*(t.x-a.x)/a.width-1;s*=.5*(o.right-o.left);var l=2*(a.height-t.y-a.y)/a.height-1;l*=.5*(o.top-o.bottom);var u=D.clone(n.transform,Et);n._setTransform(D.IDENTITY);var c=w.clone(n.position,wt);w.multiplyByScalar(n.right,s,St),w.add(St,c,c),w.multiplyByScalar(n.up,l,St),w.add(St,c,c),n._setTransform(u),e.mode===_e.SCENE2D&&w.fromElements(c.z,c.x,c.y,c);var d=o.getPixelDimensions(a.width,a.height,1,Tt),h=Ct;return h.right=.5*d.x,h.left=-h.right,h.top=.5*d.y,h.bottom=-h.top,h.near=o.near,h.far=o.far,h.computeCullingVolume(c,n.directionWC,n.upWC)}(e,t):(o=t,a=r,s=i,l=(n=e)._camera,u=l.frustum,c=u.near,d=Math.tan(.5*u.fovy),h=u.aspectRatio*d,p=n._passState.viewport,f=(2*(o.x-p.x)/p.width-1)*c*h,m=(2*(p.height-o.y-p.y)/p.height-1)*c*d,g=u.getPixelDimensions(p.width,p.height,1,Tt),_=g.x*a*.5,v=g.y*s*.5,(y=At).top=m+v,y.bottom=m-v,y.right=f+_,y.left=f-_,y.near=c,y.far=u.far,y.computeCullingVolume(l.positionWC,l.directionWC,l.upWC))}var Pt=3,Dt=3,Ot=new C(0,0,Pt,Dt),It=new m(0,0,0,0),Mt=new t;Ee.prototype.pick=function(e,t,r){if(!N(e))throw new b("windowPosition is undefined.");Pt=y(t,3),Dt=y(r,Pt);var i=this._context,n=i.uniformState,o=this._frameState,a=ve.transformWindowToDrawingBuffer(this,e,Mt);N(this._pickFramebuffer)||(this._pickFramebuffer=i.createPickFramebuffer()),this._jobScheduler.disableThisFrame(),Le(this,o.frameNumber,o.time),o.cullingVolume=xt(this,a,Pt,Dt),o.invertClassification=!1,o.passes.pick=!0,n.update(o),Ot.x=a.x-.5*(Pt-1),Ot.y=this.drawingBufferHeight-a.y-.5*(Dt-1),Ot.width=Pt,Ot.height=Dt;var s=this._pickFramebuffer.begin(Ot);pt(this,s),it(this,s,It),gt(this,s);var l=this._pickFramebuffer.end(Ot);return i.endFrame(),_t(this),l};var Rt=/\bgl_FragDepthEXT\b/,Lt=/\bdiscard\b/;var Nt=new g,kt=new g(1,1/255,1/65025,1/16581375);Ee.prototype.pickPositionWorldCoordinates=function(e,t){if(this.useDepthPicking){if(!N(e))throw new b("windowPosition is undefined.");if(!N(this._globeDepth))throw new b("Picking from the depth buffer is not supported. Check pickPositionSupported.");var r=e.toString();if(this._pickPositionCacheDirty)this._pickPositionCache={},this._pickPositionCacheDirty=!1;else if(this._pickPositionCache.hasOwnProperty(r))return w.clone(this._pickPositionCache[r],t);var i=this._context,n=i.uniformState,o=ve.transformWindowToDrawingBuffer(this,e,Mt);this.pickTranslucentDepth&&function(e,t){var r=e._context,i=e._frameState;Re(i.passes),i.passes.pick=!0,i.passes.depth=!0,i.cullingVolume=xt(e,t,1,1);var n=e._pickDepthPassState;N(n)||((n=e._pickDepthPassState=new H(r)).scissorTest={enabled:!0,rectangle:new C},n.viewport=new C);var o=r.drawingBufferWidth,a=r.drawingBufferHeight,s=e._pickDepthFramebuffer,l=e._pickDepthFramebufferWidth,u=e._pickDepthFramebufferHeight;N(s)&&l===o&&u===a||(e._pickDepthFramebuffer=e._pickDepthFramebuffer&&e._pickDepthFramebuffer.destroy(),s=e._pickDepthFramebuffer=new G({context:r,depthStencilTexture:new Z({context:r,width:o,height:a,pixelFormat:M.DEPTH_STENCIL,pixelDatatype:j.UNSIGNED_INT_24_8})}),e._pickDepthFramebufferWidth=o,e._pickDepthFramebufferHeight=a),n.framebuffer=s,n.viewport.width=o,n.viewport.height=a,n.scissorTest.rectangle.x=t.x,n.scissorTest.rectangle.y=a-t.y,n.scissorTest.rectangle.width=1,n.scissorTest.rectangle.height=1,pt(e,n),it(e,n,It),gt(e,n),r.endFrame()}(this,o),o.y=this.drawingBufferHeight-o.y;var a,s=this._camera;a=N(s.frustum.fov)?s.frustum.clone(Xe):N(s.frustum.infiniteProjectionMatrix)?s.frustum.clone(Qe):N(s.frustum.width)?s.frustum.clone(Ze):s.frustum.clone(Ke);for(var l=this.numberOfFrustums,u=0;u<l;++u){var c=Ye(this,u),d=i.readPixels({x:o.x,y:o.y,width:1,height:1,framebuffer:c.framebuffer}),h=g.unpack(d,0,Nt);g.divideByScalar(h,255,h);var p=g.dot(h,kt);if(0<p&&p<1){var f,m=this._frustumCommandsList[u];return this.mode===_e.SCENE2D?(f=s.position.z,s.position.z=f-m.near+1,a.far=Math.max(1,m.far-m.near),a.near=1,n.update(this.frameState)):(a.near=m.near*(0!==u?Ae:1),a.far=m.far),n.updateFrustum(a),t=ve.drawingBufferToWgs84Coordinates(this,o,p,t),this.mode===_e.SCENE2D&&(s.position.z=f,n.update(this.frameState)),this._pickPositionCache[r]=w.clone(t),t}}this._pickPositionCache[r]=void 0}};var Ft=new r;return Ee.prototype.pickPosition=function(e,t){if(t=this.pickPositionWorldCoordinates(e,t),N(t)&&this.mode!==_e.SCENE3D){w.fromElements(t.y,t.z,t.x,t);var r=this.mapProjection,i=r.ellipsoid,n=r.unproject(t,Ft);i.cartographicToCartesian(n,t)}return t},Ee.prototype.drillPick=function(e,t){if(!N(e))throw new b("windowPosition is undefined.");var r,i,n=[],o=[],a=[];N(t)||(t=Number.MAX_VALUE);for(var s=this.pick(e);N(s)&&N(s.primitive)&&(n.push(s),!(--t<=0));){var l=s.primitive,u=!1;"function"==typeof l.getGeometryInstanceAttributes&&N(s.id)&&(i=l.getGeometryInstanceAttributes(s.id),N(i)&&N(i.show)&&(u=!0,i.show=p.toValue(!1,i.show),a.push(i))),u||(l.show=!1,o.push(l)),s=this.pick(e)}for(r=0;r<o.length;++r)o[r].show=!0;for(r=0;r<a.length;++r)(i=a[r]).show=p.toValue(!0,i.show);return n},Ee.prototype.cartesianToCanvasCoordinates=function(e,t){return ve.wgs84ToWindowCoordinates(this,e,t)},Ee.prototype.completeMorph=function(){this._transitioner.completeMorph()},Ee.prototype.morphTo2D=function(e){var t,r=this.globe;t=N(r)?r.ellipsoid:this.mapProjection.ellipsoid,e=y(e,2),this._transitioner.morphTo2D(e,t)},Ee.prototype.morphToColumbusView=function(e){var t,r=this.globe;t=N(r)?r.ellipsoid:this.mapProjection.ellipsoid,e=y(e,2),this._transitioner.morphToColumbusView(e,t)},Ee.prototype.morphTo3D=function(e){var t,r=this.globe;t=N(r)?r.ellipsoid:this.mapProjection.ellipsoid,e=y(e,2),this._transitioner.morphTo3D(e,t)},Ee.prototype.isDestroyed=function(){return!1},Ee.prototype.destroy=function(){this._tweens.removeAll(),this._computeEngine=this._computeEngine&&this._computeEngine.destroy(),this._screenSpaceCameraController=this._screenSpaceCameraController&&this._screenSpaceCameraController.destroy(),this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy(),this._pickFramebuffer=this._pickFramebuffer&&this._pickFramebuffer.destroy(),this._pickDepthFramebuffer=this._pickDepthFramebuffer&&this._pickDepthFramebuffer.destroy(),this._primitives=this._primitives&&this._primitives.destroy(),this._groundPrimitives=this._groundPrimitives&&this._groundPrimitives.destroy(),this._globe=this._globe&&this._globe.destroy(),this.skyBox=this.skyBox&&this.skyBox.destroy(),this.skyAtmosphere=this.skyAtmosphere&&this.skyAtmosphere.destroy(),this._debugSphere=this._debugSphere&&this._debugSphere.destroy(),this.sun=this.sun&&this.sun.destroy(),this._sunPostProcess=this._sunPostProcess&&this._sunPostProcess.destroy(),this._depthPlane=this._depthPlane&&this._depthPlane.destroy(),this._transitioner.destroy(),this._debugFrustumPlanes=this._debugFrustumPlanes&&this._debugFrustumPlanes.destroy(),this._brdfLutGenerator=this._brdfLutGenerator&&this._brdfLutGenerator.destroy(),N(this._globeDepth)&&this._globeDepth.destroy(),this._removeCreditContainer&&this._canvas.parentNode.removeChild(this._creditContainer),N(this._oit)&&this._oit.destroy(),this._fxaa.destroy(),this._context=this._context&&this._context.destroy(),this._frameState.creditDisplay.destroy(),N(this._performanceDisplay)&&(this._performanceDisplay=this._performanceDisplay&&this._performanceDisplay.destroy(),this._performanceContainer.parentNode.removeChild(this._performanceContainer)),this._removeRequestListenerCallback(),this._removeTaskProcessorListenerCallback();for(var e=0;e<this._removeGlobeCallbacks.length;++e)this._removeGlobeCallbacks[e]();return this._removeGlobeCallbacks.length=0,o(this)},Ee}),define("Shaders/SkyAtmosphereFS",[],function(){"use strict";return"#ifdef COLOR_CORRECT\nuniform vec3 u_hsbShift;\n#endif\nuniform vec4 u_cameraAndRadiiAndDynamicAtmosphereColor;\nconst float g = -0.95;\nconst float g2 = g * g;\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\nvarying vec3 v_toCamera;\nvarying vec3 v_positionEC;\nvoid main (void)\n{\nfloat cosAngle = dot(czm_sunDirectionWC, normalize(v_toCamera)) / length(v_toCamera);\nfloat rayleighPhase = 0.75 * (1.0 + cosAngle * cosAngle);\nfloat miePhase = 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + cosAngle * cosAngle) / pow(1.0 + g2 - 2.0 * g * cosAngle, 1.5);\nconst float exposure = 2.0;\nvec3 rgb = rayleighPhase * v_rayleighColor + miePhase * v_mieColor;\nrgb = vec3(1.0) - exp(-exposure * rgb);\nfloat l = czm_luminance(rgb);\n#ifdef COLOR_CORRECT\nvec3 hsb = czm_RGBToHSB(rgb);\nhsb.x += u_hsbShift.x;\nhsb.y = clamp(hsb.y + u_hsbShift.y, 0.0, 1.0);\nhsb.z = hsb.z > czm_epsilon7 ? hsb.z + u_hsbShift.z : 0.0;\nrgb = czm_HSBToRGB(hsb);\nl = min(l, czm_luminance(rgb));\n#endif\nfloat atmosphereAlpha = clamp((u_cameraAndRadiiAndDynamicAtmosphereColor.y - u_cameraAndRadiiAndDynamicAtmosphereColor.x) / (u_cameraAndRadiiAndDynamicAtmosphereColor.y - u_cameraAndRadiiAndDynamicAtmosphereColor.z), 0.0, 1.0);\nfloat nightAlpha = (u_cameraAndRadiiAndDynamicAtmosphereColor.w > 0.0) ? clamp(dot(normalize(czm_viewerPositionWC), normalize(czm_sunPositionWC)), 0.0, 1.0) : 1.0;\natmosphereAlpha *= pow(nightAlpha, 0.5);\ngl_FragColor = vec4(rgb, mix(rgb.b, 1.0, atmosphereAlpha) * smoothstep(0.0, 1.0, czm_morphTime));\n}\n"}),define("Shaders/SkyAtmosphereVS",[],function(){"use strict";return"attribute vec4 position;\nuniform vec4 u_cameraAndRadiiAndDynamicAtmosphereColor;\nconst float Kr = 0.0025;\nconst float Kr4PI = Kr * 4.0 * czm_pi;\nconst float Km = 0.0015;\nconst float Km4PI = Km * 4.0 * czm_pi;\nconst float ESun = 15.0;\nconst float KmESun = Km * ESun;\nconst float KrESun = Kr * ESun;\nconst vec3 InvWavelength = vec3(\n5.60204474633241,\n9.473284437923038,\n19.643802610477206);\nconst float rayleighScaleDepth = 0.25;\nconst int nSamples = 2;\nconst float fSamples = 2.0;\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\nvarying vec3 v_toCamera;\nfloat scale(float cosAngle)\n{\nfloat x = 1.0 - cosAngle;\nreturn rayleighScaleDepth  * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\nvoid main(void)\n{\nfloat cameraHeight = u_cameraAndRadiiAndDynamicAtmosphereColor.x;\nfloat outerRadius = u_cameraAndRadiiAndDynamicAtmosphereColor.y;\nfloat innerRadius = u_cameraAndRadiiAndDynamicAtmosphereColor.z;\nvec3 positionV3 = position.xyz;\nvec3 ray = positionV3 - czm_viewerPositionWC;\nfloat far = length(ray);\nray /= far;\nfloat atmosphereScale = 1.0 / (outerRadius - innerRadius);\n#ifdef SKY_FROM_SPACE\nfloat B = 2.0 * dot(czm_viewerPositionWC, ray);\nfloat C = cameraHeight * cameraHeight - outerRadius * outerRadius;\nfloat det = max(0.0, B*B - 4.0 * C);\nfloat near = 0.5 * (-B - sqrt(det));\nvec3 start = czm_viewerPositionWC + ray * near;\nfar -= near;\nfloat startAngle = dot(ray, start) / outerRadius;\nfloat startDepth = exp(-1.0 / rayleighScaleDepth );\nfloat startOffset = startDepth*scale(startAngle);\n#else // SKY_FROM_ATMOSPHERE\nvec3 start = czm_viewerPositionWC;\nfloat height = length(start);\nfloat depth = exp((atmosphereScale / rayleighScaleDepth ) * (innerRadius - cameraHeight));\nfloat startAngle = dot(ray, start) / height;\nfloat startOffset = depth*scale(startAngle);\n#endif\nfloat sampleLength = far / fSamples;\nfloat scaledLength = sampleLength * atmosphereScale;\nvec3 sampleRay = ray * sampleLength;\nvec3 samplePoint = start + sampleRay * 0.5;\nvec3 frontColor = vec3(0.0, 0.0, 0.0);\nvec3 lightDir = (u_cameraAndRadiiAndDynamicAtmosphereColor.w > 0.0) ? czm_sunPositionWC - czm_viewerPositionWC : czm_viewerPositionWC;\nlightDir = normalize(lightDir);\nfor(int i=0; i<nSamples; i++)\n{\nfloat height = length(samplePoint);\nfloat depth = exp((atmosphereScale / rayleighScaleDepth ) * (innerRadius - height));\nfloat fLightAngle = dot(lightDir, samplePoint) / height;\nfloat fCameraAngle = dot(ray, samplePoint) / height;\nfloat fScatter = (startOffset + depth*(scale(fLightAngle) - scale(fCameraAngle)));\nvec3 attenuate = exp(-fScatter * (InvWavelength * Kr4PI + Km4PI));\nfrontColor += attenuate * (depth * scaledLength);\nsamplePoint += sampleRay;\n}\nv_mieColor = frontColor * KmESun;\nv_rayleighColor = frontColor * (InvWavelength * KrESun);\nv_toCamera = czm_viewerPositionWC - positionV3;\ngl_Position = czm_modelViewProjection * position;\n}\n"}),define("Scene/SkyAtmosphere",["../Core/Cartesian3","../Core/Cartesian4","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/Ellipsoid","../Core/EllipsoidGeometry","../Core/GeometryPipeline","../Core/Math","../Core/VertexFormat","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../Shaders/SkyAtmosphereFS","../Shaders/SkyAtmosphereVS","./BlendingState","./CullFace","./SceneMode"],function(p,i,n,f,e,t,o,m,g,_,v,y,a,b,C,w,S,T,E,A,x,P){"use strict";function r(e){e=n(e,o.WGS84),this.show=!0,this._ellipsoid=e,this._command=new a({owner:this}),this._spSkyFromSpace=void 0,this._spSkyFromAtmosphere=void 0,this._spSkyFromSpaceColorCorrect=void 0,this._spSkyFromAtmosphereColorCorrect=void 0,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this._hueSaturationBrightness=new p;var t=new i;t.w=0,t.y=p.maximumComponent(p.multiplyByScalar(e.radii,1.025,new p)),t.z=e.maximumRadius,this._cameraAndRadiiAndDynamicAtmosphereColor=t;var r=this;this._command.uniformMap={u_cameraAndRadiiAndDynamicAtmosphereColor:function(){return r._cameraAndRadiiAndDynamicAtmosphereColor},u_hsbShift:function(){return r._hueSaturationBrightness.x=r.hueShift,r._hueSaturationBrightness.y=r.saturationShift,r._hueSaturationBrightness.z=r.brightnessShift,r._hueSaturationBrightness}}}return e(r.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),r.prototype.setDynamicAtmosphereColor=function(e){this._cameraAndRadiiAndDynamicAtmosphereColor.w=e?1:0},r.prototype.update=function(e){if(this.show){var t=e.mode;if((t===P.SCENE3D||t===P.MORPHING)&&e.passes.render){var r=this._command;if(!f(r.vertexArray)){var i=e.context,n=m.createGeometry(new m({radii:p.multiplyByScalar(this._ellipsoid.radii,1.025,new p),slicePartitions:256,stackPartitions:256,vertexFormat:v.POSITION_ONLY}));r.vertexArray=S.fromGeometry({context:i,geometry:n,attributeLocations:g.createAttributeLocations(n),bufferUsage:y.STATIC_DRAW}),r.renderState=b.fromCache({cull:{enabled:!0,face:x.FRONT},blending:A.ALPHA_BLEND});var o=new w({defines:["SKY_FROM_SPACE"],sources:[E]});this._spSkyFromSpace=C.fromCache({context:i,vertexShaderSource:o,fragmentShaderSource:T}),o=new w({defines:["SKY_FROM_ATMOSPHERE"],sources:[E]}),this._spSkyFromAtmosphere=C.fromCache({context:i,vertexShaderSource:o,fragmentShaderSource:T})}var a,s=(a=this,!(_.equalsEpsilon(a.hueShift,0,_.EPSILON7)&&_.equalsEpsilon(a.saturationShift,0,_.EPSILON7)&&_.equalsEpsilon(a.brightnessShift,0,_.EPSILON7)));if(s&&(!f(this._spSkyFromSpaceColorCorrect)||!f(this._spSkyFromAtmosphereColorCorrect))){var l=e.context,u=new w({defines:["SKY_FROM_SPACE"],sources:[E]}),c=new w({defines:["COLOR_CORRECT"],sources:[T]});this._spSkyFromSpaceColorCorrect=C.fromCache({context:l,vertexShaderSource:u,fragmentShaderSource:c}),u=new w({defines:["SKY_FROM_ATMOSPHERE"],sources:[E]}),this._spSkyFromAtmosphereColorCorrect=C.fromCache({context:l,vertexShaderSource:u,fragmentShaderSource:c})}var d=e.camera.positionWC,h=p.magnitude(d);return(this._cameraAndRadiiAndDynamicAtmosphereColor.x=h)>this._cameraAndRadiiAndDynamicAtmosphereColor.y?r.shaderProgram=s?this._spSkyFromSpaceColorCorrect:this._spSkyFromSpace:r.shaderProgram=s?this._spSkyFromAtmosphereColorCorrect:this._spSkyFromAtmosphere,r}}},r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),this._spSkyFromSpace=this._spSkyFromSpace&&this._spSkyFromSpace.destroy(),this._spSkyFromAtmosphere=this._spSkyFromAtmosphere&&this._spSkyFromAtmosphere.destroy(),this._spSkyFromSpaceColorCorrect=this._spSkyFromSpaceColorCorrect&&this._spSkyFromSpaceColorCorrect.destroy(),this._spSkyFromAtmosphereColorCorrect=this._spSkyFromAtmosphereColorCorrect&&this._spSkyFromAtmosphereColorCorrect.destroy(),t(this)},r}),define("Shaders/SkyBoxFS",[],function(){"use strict";return"uniform samplerCube u_cubeMap;\nvarying vec3 v_texCoord;\nvoid main()\n{\nvec3 rgb = textureCube(u_cubeMap, normalize(v_texCoord)).rgb;\ngl_FragColor = vec4(rgb, czm_morphTime);\n}\n"}),define("Shaders/SkyBoxVS",[],function(){"use strict";return"attribute vec3 position;\nvarying vec3 v_texCoord;\nvoid main()\n{\nvec3 p = czm_viewRotation * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));\ngl_Position = czm_projection * vec4(p, 1.0);\nv_texCoord = position.xyz;\n}\n"}),define("Scene/SkyBox",["../Core/BoxGeometry","../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/GeometryPipeline","../Core/Matrix4","../Core/VertexFormat","../Renderer/BufferUsage","../Renderer/CubeMap","../Renderer/DrawCommand","../Renderer/loadCubeMap","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/VertexArray","../Shaders/SkyBoxFS","../Shaders/SkyBoxVS","./BlendingState","./SceneMode"],function(s,l,t,u,r,c,d,i,h,p,f,n,m,g,_,v,y,b,C,w){"use strict";function e(e){this.sources=e.sources,this._sources=void 0,this.show=t(e.show,!0),this._command=new n({modelMatrix:i.clone(i.IDENTITY),owner:this}),this._cubeMap=void 0}return e.prototype.update=function(e){var t=this;if(this.show&&(e.mode===w.SCENE3D||e.mode===w.MORPHING)&&e.passes.render){var r=e.context;if(this._sources!==this.sources){this._sources=this.sources;var i=this.sources;if(!(u(i.positiveX)&&u(i.negativeX)&&u(i.positiveY)&&u(i.negativeY)&&u(i.positiveZ)&&u(i.negativeZ)))throw new c("this.sources is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.");if(typeof i.positiveX!=typeof i.negativeX||typeof i.positiveX!=typeof i.positiveY||typeof i.positiveX!=typeof i.negativeY||typeof i.positiveX!=typeof i.positiveZ||typeof i.positiveX!=typeof i.negativeZ)throw new c("this.sources properties must all be the same type.");"string"==typeof i.positiveX?m(r,this._sources).then(function(e){t._cubeMap=t._cubeMap&&t._cubeMap.destroy(),t._cubeMap=e}):(this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),this._cubeMap=new f({context:r,source:i}))}var n=this._command;if(!u(n.vertexArray)){n.uniformMap={u_cubeMap:function(){return t._cubeMap}};var o=s.createGeometry(s.fromDimensions({dimensions:new l(2,2,2),vertexFormat:h.POSITION_ONLY})),a=d.createAttributeLocations(o);n.vertexArray=v.fromGeometry({context:r,geometry:o,attributeLocations:a,bufferUsage:p.STATIC_DRAW}),n.shaderProgram=_.fromCache({context:r,vertexShaderSource:b,fragmentShaderSource:y,attributeLocations:a}),n.renderState=g.fromCache({blending:C.ALPHA_BLEND})}if(u(this._cubeMap))return n}},e.prototype.isDestroyed=function(){return!1},e.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),r(this)},e}),define("Scene/SphereEmitter",["../Core/Cartesian3","../Core/Check","../Core/defaultValue","../Core/defineProperties","../Core/Math"],function(s,t,r,e,l){"use strict";function i(e){e=r(e,1),t.typeOf.number.greaterThan("radius",e,0),this._radius=r(e,1)}return e(i.prototype,{radius:{get:function(){return this._radius},set:function(e){t.typeOf.number.greaterThan("value",e,0),this._radius=e}}}),i.prototype.emit=function(e){var t=l.randomBetween(0,l.TWO_PI),r=l.randomBetween(0,l.PI),i=l.randomBetween(0,this._radius),n=i*Math.cos(t)*Math.sin(r),o=i*Math.sin(t)*Math.sin(r),a=i*Math.cos(r);e.position=s.fromElements(n,o,a,e.position),e.velocity=s.normalize(e.position,e.velocity)},i}),define("Scene/StyleExpression",["../Core/DeveloperError"],function(n){"use strict";function e(){}return e.prototype.evaluate=function(e,t,r){n.throwInstantiationError()},e.prototype.evaluateColor=function(e,t,r){n.throwInstantiationError()},e.prototype.getShaderFunction=function(e,t,r,i){n.throwInstantiationError()},e}),define("Shaders/SunFS",[],function(){"use strict";return"uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\ngl_FragColor = texture2D(u_texture, v_textureCoordinates);\n}\n"}),define("Shaders/SunTextureFS",[],function(){"use strict";return"uniform float u_glowLengthTS;\nuniform float u_radiusTS;\nvarying vec2 v_textureCoordinates;\nvec2 rotate(vec2 p, vec2 direction)\n{\nreturn vec2(p.x * direction.x - p.y * direction.y, p.x * direction.y + p.y * direction.x);\n}\nvec4 addBurst(vec2 position, vec2 direction)\n{\nvec2 rotatedPosition = rotate(position, direction) * vec2(25.0, 0.75);\nfloat radius = length(rotatedPosition);\nfloat burst = 1.0 - smoothstep(0.0, 0.55, radius);\nreturn vec4(burst);\n}\nvoid main()\n{\nvec2 position = v_textureCoordinates - vec2(0.5);\nfloat radius = length(position);\nfloat surface = step(radius, u_radiusTS);\nvec4 color = vec4(1.0, 1.0, surface + 0.2, surface);\nfloat glow = 1.0 - smoothstep(0.0, 0.55, radius);\ncolor.ba += mix(vec2(0.0), vec2(1.0), glow) * 0.75;\nvec4 burst = vec4(0.0);\nburst += 0.4 * addBurst(position, vec2(0.38942,  0.92106));\nburst += 0.4 * addBurst(position, vec2(0.99235,  0.12348));\nburst += 0.4 * addBurst(position, vec2(0.60327, -0.79754));\nburst += 0.3 * addBurst(position, vec2(0.31457,  0.94924));\nburst += 0.3 * addBurst(position, vec2(0.97931,  0.20239));\nburst += 0.3 * addBurst(position, vec2(0.66507, -0.74678));\ncolor += clamp(burst, vec4(0.0), vec4(1.0)) * 0.15;\ngl_FragColor = clamp(color, vec4(0.0), vec4(1.0));\n}\n"}),define("Shaders/SunVS",[],function(){"use strict";return"attribute vec2 direction;\nuniform float u_size;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nvec4 position;\nif (czm_morphTime == 1.0)\n{\nposition = vec4(czm_sunPositionWC, 1.0);\n}\nelse\n{\nposition = vec4(czm_sunPositionColumbusView.zxy, 1.0);\n}\nvec4 positionEC = czm_view * position;\nvec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\nvec2 halfSize = vec2(u_size * 0.5);\nhalfSize *= ((direction * 2.0) - 1.0);\ngl_Position = czm_viewportOrthographic * vec4(positionWC.xy + halfSize, -positionWC.z, 1.0);\nv_textureCoordinates = direction;\n}\n"}),define("Scene/Sun",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/ComponentDatatype","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/IndexDatatype","../Core/Math","../Core/Matrix4","../Core/PixelFormat","../Core/PrimitiveType","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/ComputeCommand","../Renderer/DrawCommand","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/Texture","../Renderer/VertexArray","../Shaders/SunFS","../Shaders/SunTextureFS","../Shaders/SunVS","./BlendingState","./SceneMode","./SceneTransforms"],function(x,P,D,e,O,I,t,r,M,R,L,N,i,k,F,B,n,U,V,z,q,G,W,H,j,Y,X){"use strict";function o(){this.show=!0,this._drawCommand=new n({primitiveType:i.TRIANGLES,boundingVolume:new x,owner:this}),this._commands={drawCommand:this._drawCommand,computeCommand:void 0},this._boundingVolume=new x,this._boundingVolume2D=new x,this._texture=void 0,this._drawingBufferWidth=void 0,this._drawingBufferHeight=void 0,this._radiusTS=void 0,this._size=void 0,this.glowFactor=1,this._glowFactorDirty=!1;var e=this;this._uniformMap={u_texture:function(){return e._texture},u_size:function(){return e._size}}}t(o.prototype,{glowFactor:{get:function(){return this._glowFactor},set:function(e){e=Math.max(e,0),this._glowFactor=e,this._glowFactorDirty=!0}}});var Q=new P,Z=new P,K=new e,J=new e;return o.prototype.update=function(e,t){if(this.show){var r=e.mode;if(r!==Y.SCENE2D&&r!==Y.MORPHING&&e.passes.render){var i=e.context,n=t.viewport.width,o=t.viewport.height;if(!I(this._texture)||n!==this._drawingBufferWidth||o!==this._drawingBufferHeight||this._glowFactorDirty){this._texture=this._texture&&this._texture.destroy(),this._drawingBufferWidth=n,this._drawingBufferHeight=o,this._glowFactorDirty=!1;var a=Math.max(n,o);a=Math.pow(2,Math.ceil(Math.log(a)/Math.log(2))-2),a=Math.max(1,a),this._texture=new z({context:i,width:a,height:a,pixelFormat:N.RGBA}),this._glowLengthTS=5*this._glowFactor,this._radiusTS=1/(1+2*this._glowLengthTS)*.5;var s=this,l={u_glowLengthTS:function(){return s._glowLengthTS},u_radiusTS:function(){return s._radiusTS}};this._commands.computeCommand=new B({fragmentShaderSource:W,outputTexture:this._texture,uniformMap:l,persists:!1,owner:this,postExecute:function(){s._commands.computeCommand=void 0}})}var u=this._drawCommand;if(!I(u.vertexArray)){var c={direction:0},d=new Uint8Array(8);d[0]=0,d[1]=0,d[2]=255,d[3]=0,d[4]=255,d[5]=255,d[6]=0,d[7]=255;var h=k.createVertexBuffer({context:i,typedArray:d,usage:F.STATIC_DRAW}),p=[{index:c.direction,vertexBuffer:h,componentsPerAttribute:2,normalize:!0,componentDatatype:O.UNSIGNED_BYTE}],f=k.createIndexBuffer({context:i,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:F.STATIC_DRAW,indexDatatype:M.UNSIGNED_SHORT});u.vertexArray=new q({context:i,attributes:p,indexBuffer:f}),u.shaderProgram=V.fromCache({context:i,vertexShaderSource:H,fragmentShaderSource:G,attributeLocations:c}),u.renderState=U.fromCache({blending:j.ALPHA_BLEND}),u.uniformMap=this._uniformMap}var m=i.uniformState.sunPositionWC,g=i.uniformState.sunPositionColumbusView,_=this._boundingVolume,v=this._boundingVolume2D;D.clone(m,_.center),v.center.x=g.z,v.center.y=g.x,v.center.z=g.y,_.radius=R.SOLAR_RADIUS+R.SOLAR_RADIUS*this._glowLengthTS,v.radius=_.radius,r===Y.SCENE3D?x.clone(_,u.boundingVolume):r===Y.COLUMBUS_VIEW&&x.clone(v,u.boundingVolume);var y=X.computeActualWgs84Position(e,m,J),b=D.magnitude(D.subtract(y,e.camera.position,J)),C=i.uniformState.projection,w=K;w.x=0,w.y=0,w.z=-b,w.w=1;var S=L.multiplyByVector(C,w,J),T=X.clipToGLWindowCoordinates(t.viewport,S,Q);w.x=R.SOLAR_RADIUS;var E=L.multiplyByVector(C,w,J),A=X.clipToGLWindowCoordinates(t.viewport,E,Z);return this._size=Math.ceil(P.magnitude(P.subtract(A,T,J))),this._size=2*this._size*(1+2*this._glowLengthTS),this._commands}}},o.prototype.isDestroyed=function(){return!1},o.prototype.destroy=function(){var e=this._drawCommand;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._texture=this._texture&&this._texture.destroy(),r(this)},o}),define("Scene/TileBoundingVolume",["../Core/DeveloperError"],function(t){"use strict";function e(){}return e.prototype.boundingVolume=void 0,e.prototype.boundingSphere=void 0,e.prototype.distanceToCamera=function(e){t.throwInstantiationError()},e.prototype.intersectPlane=function(e){t.throwInstantiationError()},e.prototype.createDebugVolume=function(e){t.throwInstantiationError()},e}),define("Scene/TileCoordinatesImageryProvider",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","../Core/GeographicTilingScheme","../ThirdParty/when"],function(t,r,i,e,n,o,a){"use strict";function s(e){e=r(e,r.EMPTY_OBJECT),this._tilingScheme=i(e.tilingScheme)?e.tilingScheme:new o({ellipsoid:e.ellipsoid}),this._color=r(e.color,t.YELLOW),this._errorEvent=new n,this._tileWidth=r(e.tileWidth,256),this._tileHeight=r(e.tileHeight,256),this._readyPromise=a.resolve(!0)}return e(s.prototype,{proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){}},minimumLevel:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return!0}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){}},hasAlphaChannel:{get:function(){return!0}}}),s.prototype.getTileCredits=function(e,t,r){},s.prototype.requestImage=function(e,t,r,i){var n=document.createElement("canvas");n.width=256,n.height=256;var o=n.getContext("2d"),a=this._color.toCssColorString();o.strokeStyle=a,o.lineWidth=2,o.strokeRect(1,1,255,255);var s="L"+r+"X"+e+"Y"+t;return o.font="bold 25px Arial",o.textAlign="center",o.fillStyle="black",o.fillText(s,127,127),o.fillStyle=a,o.fillText(s,124,124),n},s.prototype.pickFeatures=function(e,t,r,i,n){},s}),define("Scene/TileDiscardPolicy",["../Core/DeveloperError"],function(t){"use strict";function e(e){t.throwInstantiationError()}return e.prototype.isReady=t.throwInstantiationError,e.prototype.shouldDiscardImage=t.throwInstantiationError,e}),define("Scene/TileState",["../Core/freezeObject"],function(e){"use strict";return e({START:0,LOADING:1,READY:2,UPSAMPLED_ONLY:3})}),define("Shaders/ViewportQuadFS",[],function(){"use strict";return"varying vec2 v_textureCoordinates;\nvoid main()\n{\nczm_materialInput materialInput;\nmaterialInput.s = v_textureCoordinates.s;\nmaterialInput.st = v_textureCoordinates;\nmaterialInput.str = vec3(v_textureCoordinates, 0.0);\nmaterialInput.normalEC = vec3(0.0, 0.0, -1.0);\nczm_material material = czm_getMaterial(materialInput);\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n}\n"}),define("Scene/ViewportQuad",["../Core/BoundingRectangle","../Core/Color","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderSource","../Shaders/ViewportQuadFS","./BlendingState","./Material"],function(n,r,o,e,a,s,l,u,c,d,i){"use strict";function t(e,t){this.show=!0,o(e)||(e=new n),this.rectangle=n.clone(e),o(t)||(t=i.fromType(i.ColorType,{color:new r(1,1,1,1)})),this.material=t,this._material=void 0,this._overlayCommand=void 0,this._rs=void 0}return t.prototype.update=function(e){if(this.show){if(!o(this.material))throw new a("this.material must be defined.");if(!o(this.rectangle))throw new a("this.rectangle must be defined.");var t=this._rs;if(o(t)&&n.equals(t.viewport,this.rectangle)||(this._rs=l.fromCache({blending:d.ALPHA_BLEND,viewport:this.rectangle})),e.passes.render){var r=e.context;if(this._material!==this.material||!o(this._overlayCommand)){this._material=this.material,o(this._overlayCommand)&&this._overlayCommand.shaderProgram.destroy();var i=new u({sources:[this._material.shaderSource,c]});this._overlayCommand=r.createViewportQuadCommand(i,{renderState:this._rs,uniformMap:this._material._uniforms,owner:this}),this._overlayCommand.pass=s.OVERLAY}this._material.update(r),this._overlayCommand.uniformMap=this._material._uniforms,e.commandList.push(this._overlayCommand)}}},t.prototype.isDestroyed=function(){return!1},t.prototype.destroy=function(){return o(this._overlayCommand)&&(this._overlayCommand.shaderProgram=this._overlayCommand.shaderProgram&&this._overlayCommand.shaderProgram.destroy()),e(this)},t}),define("ThirdParty/crunch",[],function(){var Module;Module||(Module=(void 0!==Module?Module:null)||{});var moduleOverrides={};for(var key in Module)Module.hasOwnProperty(key)&&(moduleOverrides[key]=Module[key]);var ENVIRONMENT_IS_WEB=!1,ENVIRONMENT_IS_WORKER=!1,ENVIRONMENT_IS_NODE=!1,ENVIRONMENT_IS_SHELL=!1,nodeFS,nodePath;if(Module.ENVIRONMENT)if("WEB"===Module.ENVIRONMENT)ENVIRONMENT_IS_WEB=!0;else if("WORKER"===Module.ENVIRONMENT)ENVIRONMENT_IS_WORKER=!0;else if("NODE"===Module.ENVIRONMENT)ENVIRONMENT_IS_NODE=!0;else{if("SHELL"!==Module.ENVIRONMENT)throw new Error("The provided Module['ENVIRONMENT'] value is not valid. It must be one of: WEB|WORKER|NODE|SHELL.");ENVIRONMENT_IS_SHELL=!0}else ENVIRONMENT_IS_WEB="object"==typeof window,ENVIRONMENT_IS_WORKER="function"==typeof importScripts,ENVIRONMENT_IS_NODE="object"==typeof process&&"function"==typeof require&&!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_WORKER,ENVIRONMENT_IS_SHELL=!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_NODE&&!ENVIRONMENT_IS_WORKER;if(ENVIRONMENT_IS_NODE)Module.print||(Module.print=console.log),Module.printErr||(Module.printErr=console.warn),Module.read=function(e,t){nodeFS||(nodeFS=require("fs")),nodePath||(nodePath=require("path")),e=nodePath.normalize(e);var r=nodeFS.readFileSync(e);return t?r:r.toString()},Module.readBinary=function(e){var t=Module.read(e,!0);return t.buffer||(t=new Uint8Array(t)),assert(t.buffer),t},Module.load=function(e){globalEval(read(e))},Module.thisProgram||(1<process.argv.length?Module.thisProgram=process.argv[1].replace(/\\/g,"/"):Module.thisProgram="unknown-program"),Module.arguments=process.argv.slice(2),"undefined"!=typeof module&&(module.exports=Module),process.on("uncaughtException",function(e){if(!(e instanceof ExitStatus))throw e}),Module.inspect=function(){return"[Emscripten Module object]"};else if(ENVIRONMENT_IS_SHELL)Module.print||(Module.print=print),"undefined"!=typeof printErr&&(Module.printErr=printErr),"undefined"!=typeof read?Module.read=read:Module.read=function(){throw"no read() available"},Module.readBinary=function(e){if("function"==typeof readbuffer)return new Uint8Array(readbuffer(e));var t=read(e,"binary");return assert("object"==typeof t),t},"undefined"!=typeof scriptArgs?Module.arguments=scriptArgs:void 0!==arguments&&(Module.arguments=arguments),"function"==typeof quit&&(Module.quit=function(e,t){quit(e)});else{if(!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_WORKER)throw"Unknown runtime environment. Where are we?";if(Module.read=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},ENVIRONMENT_IS_WORKER&&(Module.readBinary=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),Module.readAsync=function(e,t,r){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(){200==i.status||0==i.status&&i.response?t(i.response):r()},i.onerror=r,i.send(null)},void 0!==arguments&&(Module.arguments=arguments),"undefined"!=typeof console)Module.print||(Module.print=function(e){console.log(e)}),Module.printErr||(Module.printErr=function(e){console.warn(e)});else{var TRY_USE_DUMP=!1;Module.print||(Module.print=TRY_USE_DUMP&&"undefined"!=typeof dump?function(e){dump(e)}:function(e){})}ENVIRONMENT_IS_WORKER&&(Module.load=importScripts),void 0===Module.setWindowTitle&&(Module.setWindowTitle=function(e){document.title=e})}function globalEval(e){eval.call(null,e)}for(var key in!Module.load&&Module.read&&(Module.load=function(e){globalEval(Module.read(e))}),Module.print||(Module.print=function(){}),Module.printErr||(Module.printErr=Module.print),Module.arguments||(Module.arguments=[]),Module.thisProgram||(Module.thisProgram="./this.program"),Module.quit||(Module.quit=function(e,t){throw t}),Module.print=Module.print,Module.printErr=Module.printErr,Module.preRun=[],Module.postRun=[],moduleOverrides)moduleOverrides.hasOwnProperty(key)&&(Module[key]=moduleOverrides[key]);moduleOverrides=void 0;var Runtime={setTempRet0:function(e){return tempRet0=e},getTempRet0:function(){return tempRet0},stackSave:function(){return STACKTOP},stackRestore:function(e){STACKTOP=e},getNativeTypeSize:function(e){switch(e){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:if("*"===e[e.length-1])return Runtime.QUANTUM_SIZE;if("i"!==e[0])return 0;var t=parseInt(e.substr(1));return assert(t%8==0),t/8}},getNativeFieldSize:function(e){return Math.max(Runtime.getNativeTypeSize(e),Runtime.QUANTUM_SIZE)},STACK_ALIGN:16,prepVararg:function(e,t){return"double"===t||"i64"===t?7&e&&(assert(4==(7&e)),e+=4):assert(0==(3&e)),e},getAlignSize:function(e,t,r){return r||"i64"!=e&&"double"!=e?e?Math.min(t||(e?Runtime.getNativeFieldSize(e):0),Runtime.QUANTUM_SIZE):Math.min(t,8):8},dynCall:function(e,t,r){return r&&r.length?Module["dynCall_"+e].apply(null,[t].concat(r)):Module["dynCall_"+e].call(null,t)},functionPointers:[],addFunction:function(e){for(var t=0;t<Runtime.functionPointers.length;t++)if(!Runtime.functionPointers[t])return Runtime.functionPointers[t]=e,2*(1+t);throw"Finished up all reserved function pointers. Use a higher value for RESERVED_FUNCTION_POINTERS."},removeFunction:function(e){Runtime.functionPointers[(e-2)/2]=null},warnOnce:function(e){Runtime.warnOnce.shown||(Runtime.warnOnce.shown={}),Runtime.warnOnce.shown[e]||(Runtime.warnOnce.shown[e]=1,Module.printErr(e))},funcWrappers:{},getFuncWrapper:function(t,r){assert(r),Runtime.funcWrappers[r]||(Runtime.funcWrappers[r]={});var e=Runtime.funcWrappers[r];return e[t]||(1===r.length?e[t]=function(){return Runtime.dynCall(r,t)}:2===r.length?e[t]=function(e){return Runtime.dynCall(r,t,[e])}:e[t]=function(){return Runtime.dynCall(r,t,Array.prototype.slice.call(arguments))}),e[t]},getCompilerSetting:function(e){throw"You must build with -s RETAIN_COMPILER_SETTINGS=1 for Runtime.getCompilerSetting or emscripten_get_compiler_setting to work"},stackAlloc:function(e){var t=STACKTOP;return STACKTOP=(STACKTOP=STACKTOP+e|0)+15&-16,t},staticAlloc:function(e){var t=STATICTOP;return STATICTOP=(STATICTOP=STATICTOP+e|0)+15&-16,t},dynamicAlloc:function(e){var t=HEAP32[DYNAMICTOP_PTR>>2],r=-16&(t+e+15|0);if((HEAP32[DYNAMICTOP_PTR>>2]=r,TOTAL_MEMORY<=r)&&!enlargeMemory())return HEAP32[DYNAMICTOP_PTR>>2]=t,0;return t},alignMemory:function(e,t){return e=Math.ceil(e/(t||16))*(t||16)},makeBigInt:function(e,t,r){return r?+(e>>>0)+4294967296*+(t>>>0):+(e>>>0)+4294967296*+(0|t)},GLOBAL_BASE:8,QUANTUM_SIZE:4,__dummy__:0};Module.Runtime=Runtime;var ABORT=0,EXITSTATUS=0,cwrap,ccall;function assert(e,t){e||abort("Assertion failed: "+t)}function getCFunc(ident){var func=Module["_"+ident];if(!func)try{func=eval("_"+ident)}catch(e){}return assert(func,"Cannot call unknown function "+ident+" (perhaps LLVM optimizations or closure removed it?)"),func}function setValue(e,t,r,i){switch("*"===(r=r||"i8").charAt(r.length-1)&&(r="i32"),r){case"i1":case"i8":HEAP8[e>>0]=t;break;case"i16":HEAP16[e>>1]=t;break;case"i32":HEAP32[e>>2]=t;break;case"i64":tempI64=[t>>>0,(tempDouble=t,1<=+Math_abs(tempDouble)?0<tempDouble?(0|Math_min(+Math_floor(tempDouble/4294967296),4294967295))>>>0:~~+Math_ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],HEAP32[e>>2]=tempI64[0],HEAP32[e+4>>2]=tempI64[1];break;case"float":HEAPF32[e>>2]=t;break;case"double":HEAPF64[e>>3]=t;break;default:abort("invalid type for setValue: "+r)}}function getValue(e,t,r){switch("*"===(t=t||"i8").charAt(t.length-1)&&(t="i32"),t){case"i1":case"i8":return HEAP8[e>>0];case"i16":return HEAP16[e>>1];case"i32":case"i64":return HEAP32[e>>2];case"float":return HEAPF32[e>>2];case"double":return HEAPF64[e>>3];default:abort("invalid type for setValue: "+t)}return null}!function(){var JSfuncs={stackSave:function(){Runtime.stackSave()},stackRestore:function(){Runtime.stackRestore()},arrayToC:function(e){var t=Runtime.stackAlloc(e.length);return writeArrayToMemory(e,t),t},stringToC:function(e){var t=0;if(null!=e&&0!==e){var r=1+(e.length<<2);stringToUTF8(e,t=Runtime.stackAlloc(r),r)}return t}},toC={string:JSfuncs.stringToC,array:JSfuncs.arrayToC};ccall=function(e,t,r,i,n){var o=getCFunc(e),a=[],s=0;if(i)for(var l=0;l<i.length;l++){var u=toC[r[l]];a[l]=u?(0===s&&(s=Runtime.stackSave()),u(i[l])):i[l]}var c=o.apply(null,a);if("string"===t&&(c=Pointer_stringify(c)),0!==s){if(n&&n.async)return void EmterpreterAsync.asyncFinalizers.push(function(){Runtime.stackRestore(s)});Runtime.stackRestore(s)}return c};var sourceRegex=/^function\s*[a-zA-Z$_0-9]*\s*\(([^)]*)\)\s*{\s*([^*]*?)[\s;]*(?:return\s*(.*?)[;\s]*)?}$/;function parseJSFunc(e){var t=e.toString().match(sourceRegex).slice(1);return{arguments:t[0],body:t[1],returnValue:t[2]}}var JSsource=null;function ensureJSsource(){if(!JSsource)for(var e in JSsource={},JSfuncs)JSfuncs.hasOwnProperty(e)&&(JSsource[e]=parseJSFunc(JSfuncs[e]))}cwrap=function cwrap(ident,returnType,argTypes){argTypes=argTypes||[];var cfunc=getCFunc(ident),numericArgs=argTypes.every(function(e){return"number"===e}),numericRet="string"!==returnType;if(numericRet&&numericArgs)return cfunc;var argNames=argTypes.map(function(e,t){return"$"+t}),funcstr="(function("+argNames.join(",")+") {",nargs=argTypes.length;if(!numericArgs){ensureJSsource(),funcstr+="var stack = "+JSsource.stackSave.body+";";for(var i=0;i<nargs;i++){var arg=argNames[i],type=argTypes[i];if("number"!==type){var convertCode=JSsource[type+"ToC"];funcstr+="var "+convertCode.arguments+" = "+arg+";",funcstr+=convertCode.body+";",funcstr+=arg+"=("+convertCode.returnValue+");"}}}var cfuncname=parseJSFunc(function(){return cfunc}).returnValue;if(funcstr+="var ret = "+cfuncname+"("+argNames.join(",")+");",!numericRet){var strgfy=parseJSFunc(function(){return Pointer_stringify}).returnValue;funcstr+="ret = "+strgfy+"(ret);"}return numericArgs||(ensureJSsource(),funcstr+=JSsource.stackRestore.body.replace("()","(stack)")+";"),funcstr+="return ret})",eval(funcstr)}}(),Module.ccall=ccall,Module.cwrap=cwrap,Module.setValue=setValue,Module.getValue=getValue;var ALLOC_NORMAL=0,ALLOC_STACK=1,ALLOC_STATIC=2,ALLOC_DYNAMIC=3,ALLOC_NONE=4;function allocate(e,t,r,i){var n,o;o="number"==typeof e?(n=!0,e):(n=!1,e.length);var a,s="string"==typeof t?t:null;if(a=r==ALLOC_NONE?i:["function"==typeof _malloc?_malloc:Runtime.staticAlloc,Runtime.stackAlloc,Runtime.staticAlloc,Runtime.dynamicAlloc][void 0===r?ALLOC_STATIC:r](Math.max(o,s?1:t.length)),n){var l;i=a;for(assert(0==(3&a)),l=a+(-4&o);i<l;i+=4)HEAP32[i>>2]=0;for(l=a+o;i<l;)HEAP8[i++>>0]=0;return a}if("i8"===s)return e.subarray||e.slice?HEAPU8.set(e,a):HEAPU8.set(new Uint8Array(e),a),a;for(var u,c,d,h=0;h<o;){var p=e[h];"function"==typeof p&&(p=Runtime.getFunctionIndex(p)),0!==(u=s||t[h])?("i64"==u&&(u="i32"),setValue(a+h,p,u),d!==u&&(c=Runtime.getNativeTypeSize(u),d=u),h+=c):h++}return a}function getMemory(e){return staticSealed?runtimeInitialized?_malloc(e):Runtime.dynamicAlloc(e):Runtime.staticAlloc(e)}function Pointer_stringify(e,t){if(0===t||!e)return"";for(var r,i=0,n=0;i|=r=HEAPU8[e+n>>0],(0!=r||t)&&(n++,!t||n!=t););t||(t=n);var o="";if(i<128){for(var a;0<t;)a=String.fromCharCode.apply(String,HEAPU8.subarray(e,e+Math.min(t,1024))),o=o?o+a:a,e+=1024,t-=1024;return o}return Module.UTF8ToString(e)}function AsciiToString(e){for(var t="";;){var r=HEAP8[e++>>0];if(!r)return t;t+=String.fromCharCode(r)}}function stringToAscii(e,t){return writeAsciiToMemory(e,t,!1)}Module.ALLOC_NORMAL=ALLOC_NORMAL,Module.ALLOC_STACK=ALLOC_STACK,Module.ALLOC_STATIC=ALLOC_STATIC,Module.ALLOC_DYNAMIC=ALLOC_DYNAMIC,Module.ALLOC_NONE=ALLOC_NONE,Module.allocate=allocate,Module.getMemory=getMemory,Module.Pointer_stringify=Pointer_stringify,Module.AsciiToString=AsciiToString,Module.stringToAscii=stringToAscii;var UTF8Decoder="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function UTF8ArrayToString(e,t){for(var r=t;e[r];)++r;if(16<r-t&&e.subarray&&UTF8Decoder)return UTF8Decoder.decode(e.subarray(t,r));for(var i,n,o,a,s,l="";;){if(!(i=e[t++]))return l;if(128&i)if(n=63&e[t++],192!=(224&i))if(o=63&e[t++],(i=224==(240&i)?(15&i)<<12|n<<6|o:(a=63&e[t++],240==(248&i)?(7&i)<<18|n<<12|o<<6|a:(s=63&e[t++],248==(252&i)?(3&i)<<24|n<<18|o<<12|a<<6|s:(1&i)<<30|n<<24|o<<18|a<<12|s<<6|63&e[t++])))<65536)l+=String.fromCharCode(i);else{var u=i-65536;l+=String.fromCharCode(55296|u>>10,56320|1023&u)}else l+=String.fromCharCode((31&i)<<6|n);else l+=String.fromCharCode(i)}}function UTF8ToString(e){return UTF8ArrayToString(HEAPU8,e)}function stringToUTF8Array(e,t,r,i){if(!(0<i))return 0;for(var n=r,o=r+i-1,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(55296<=s&&s<=57343&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++a)),s<=127){if(o<=r)break;t[r++]=s}else if(s<=2047){if(o<=r+1)break;t[r++]=192|s>>6,t[r++]=128|63&s}else if(s<=65535){if(o<=r+2)break;t[r++]=224|s>>12,t[r++]=128|s>>6&63,t[r++]=128|63&s}else if(s<=2097151){if(o<=r+3)break;t[r++]=240|s>>18,t[r++]=128|s>>12&63,t[r++]=128|s>>6&63,t[r++]=128|63&s}else if(s<=67108863){if(o<=r+4)break;t[r++]=248|s>>24,t[r++]=128|s>>18&63,t[r++]=128|s>>12&63,t[r++]=128|s>>6&63,t[r++]=128|63&s}else{if(o<=r+5)break;t[r++]=252|s>>30,t[r++]=128|s>>24&63,t[r++]=128|s>>18&63,t[r++]=128|s>>12&63,t[r++]=128|s>>6&63,t[r++]=128|63&s}}return t[r]=0,r-n}function stringToUTF8(e,t,r){return stringToUTF8Array(e,HEAPU8,t,r)}function lengthBytesUTF8(e){for(var t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);55296<=i&&i<=57343&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++r)),i<=127?++t:t+=i<=2047?2:i<=65535?3:i<=2097151?4:i<=67108863?5:6}return t}Module.UTF8ArrayToString=UTF8ArrayToString,Module.UTF8ToString=UTF8ToString,Module.stringToUTF8Array=stringToUTF8Array,Module.stringToUTF8=stringToUTF8,Module.lengthBytesUTF8=lengthBytesUTF8;var UTF16Decoder="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0;function demangle(e){var t=Module.___cxa_demangle||Module.__cxa_demangle;if(t){try{var r=e.substr(1),i=lengthBytesUTF8(r)+1,n=_malloc(i);stringToUTF8(r,n,i);var o=_malloc(4),a=t(n,0,0,o);if(0===getValue(o,"i32")&&a)return Pointer_stringify(a)}catch(e){}finally{n&&_free(n),o&&_free(o),a&&_free(a)}return e}return Runtime.warnOnce("warning: build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling"),e}function demangleAll(e){return e.replace(/__Z[\w\d_]+/g,function(e){var t=demangle(e);return e===t?e:e+" ["+t+"]"})}function jsStackTrace(){var t=new Error;if(!t.stack){try{throw new Error(0)}catch(e){t=e}if(!t.stack)return"(no stack trace available)"}return t.stack.toString()}function stackTrace(){var e=jsStackTrace();return Module.extraStackTrace&&(e+="\n"+Module.extraStackTrace()),demangleAll(e)}Module.stackTrace=stackTrace;var WASM_PAGE_SIZE=65536,ASMJS_PAGE_SIZE=16777216,MIN_TOTAL_MEMORY=16777216,HEAP,buffer,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64,STATIC_BASE,STATICTOP,staticSealed,STACK_BASE,STACKTOP,STACK_MAX,DYNAMIC_BASE,DYNAMICTOP_PTR,byteLength;function alignUp(e,t){return 0<e%t&&(e+=t-e%t),e}function updateGlobalBuffer(e){Module.buffer=buffer=e}function updateGlobalBufferViews(){Module.HEAP8=HEAP8=new Int8Array(buffer),Module.HEAP16=HEAP16=new Int16Array(buffer),Module.HEAP32=HEAP32=new Int32Array(buffer),Module.HEAPU8=HEAPU8=new Uint8Array(buffer),Module.HEAPU16=HEAPU16=new Uint16Array(buffer),Module.HEAPU32=HEAPU32=new Uint32Array(buffer),Module.HEAPF32=HEAPF32=new Float32Array(buffer),Module.HEAPF64=HEAPF64=new Float64Array(buffer)}function abortOnCannotGrowMemory(){abort("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+TOTAL_MEMORY+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime but prevents some optimizations, (3) set Module.TOTAL_MEMORY to a higher value before the program runs, or (4) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}function enlargeMemory(){var e=Module.usingWasm?WASM_PAGE_SIZE:ASMJS_PAGE_SIZE,t=2147483648-e;if(HEAP32[DYNAMICTOP_PTR>>2]>t)return!1;var r=TOTAL_MEMORY;for(TOTAL_MEMORY=Math.max(TOTAL_MEMORY,MIN_TOTAL_MEMORY);TOTAL_MEMORY<HEAP32[DYNAMICTOP_PTR>>2];)TOTAL_MEMORY=TOTAL_MEMORY<=536870912?alignUp(2*TOTAL_MEMORY,e):Math.min(alignUp((3*TOTAL_MEMORY+2147483648)/4,e),t);var i=Module.reallocBuffer(TOTAL_MEMORY);return i&&i.byteLength==TOTAL_MEMORY?(updateGlobalBuffer(i),updateGlobalBufferViews(),!0):(TOTAL_MEMORY=r,!1)}STATIC_BASE=STATICTOP=STACK_BASE=STACKTOP=STACK_MAX=DYNAMIC_BASE=DYNAMICTOP_PTR=0,staticSealed=!1,Module.reallocBuffer||(Module.reallocBuffer=function(e){var t;try{if(ArrayBuffer.transfer)t=ArrayBuffer.transfer(buffer,e);else{var r=HEAP8;t=new ArrayBuffer(e),new Int8Array(t).set(r)}}catch(e){return!1}return!!_emscripten_replace_memory(t)&&t});try{byteLength=Function.prototype.call.bind(Object.getOwnPropertyDescriptor(ArrayBuffer.prototype,"byteLength").get),byteLength(new ArrayBuffer(4))}catch(e){byteLength=function(e){return e.byteLength}}var TOTAL_STACK=Module.TOTAL_STACK||5242880,TOTAL_MEMORY=Module.TOTAL_MEMORY||16777216;function getTotalMemory(){return TOTAL_MEMORY}if(TOTAL_MEMORY<TOTAL_STACK&&Module.printErr("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+TOTAL_MEMORY+"! (TOTAL_STACK="+TOTAL_STACK+")"),buffer=Module.buffer?Module.buffer:new ArrayBuffer(TOTAL_MEMORY),updateGlobalBufferViews(),HEAP32[0]=1668509029,HEAP16[1]=25459,115!==HEAPU8[2]||99!==HEAPU8[3])throw"Runtime error: expected the system to be little-endian!";function callRuntimeCallbacks(e){for(;0<e.length;){var t=e.shift();if("function"!=typeof t){var r=t.func;"number"==typeof r?void 0===t.arg?Module.dynCall_v(r):Module.dynCall_vi(r,t.arg):r(void 0===t.arg?null:t.arg)}else t()}}Module.HEAP=HEAP,Module.buffer=buffer,Module.HEAP8=HEAP8,Module.HEAP16=HEAP16,Module.HEAP32=HEAP32,Module.HEAPU8=HEAPU8,Module.HEAPU16=HEAPU16,Module.HEAPU32=HEAPU32,Module.HEAPF32=HEAPF32,Module.HEAPF64=HEAPF64;var __ATPRERUN__=[],__ATINIT__=[],__ATMAIN__=[],__ATEXIT__=[],__ATPOSTRUN__=[],runtimeInitialized=!1,runtimeExited=!1;function preRun(){if(Module.preRun)for("function"==typeof Module.preRun&&(Module.preRun=[Module.preRun]);Module.preRun.length;)addOnPreRun(Module.preRun.shift());callRuntimeCallbacks(__ATPRERUN__)}function ensureInitRuntime(){runtimeInitialized||(runtimeInitialized=!0,callRuntimeCallbacks(__ATINIT__))}function preMain(){callRuntimeCallbacks(__ATMAIN__)}function exitRuntime(){callRuntimeCallbacks(__ATEXIT__),runtimeExited=!0}function postRun(){if(Module.postRun)for("function"==typeof Module.postRun&&(Module.postRun=[Module.postRun]);Module.postRun.length;)addOnPostRun(Module.postRun.shift());callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(e){__ATPRERUN__.unshift(e)}function addOnInit(e){__ATINIT__.unshift(e)}function addOnPreMain(e){__ATMAIN__.unshift(e)}function addOnExit(e){__ATEXIT__.unshift(e)}function addOnPostRun(e){__ATPOSTRUN__.unshift(e)}function intArrayFromString(e,t,r){var i=0<r?r:lengthBytesUTF8(e)+1,n=new Array(i),o=stringToUTF8Array(e,n,0,n.length);return t&&(n.length=o),n}function intArrayToString(e){for(var t=[],r=0;r<e.length;r++){var i=e[r];255<i&&(i&=255),t.push(String.fromCharCode(i))}return t.join("")}function writeStringToMemory(e,t,r){var i,n;Runtime.warnOnce("writeStringToMemory is deprecated and should not be called! Use stringToUTF8() instead!"),r&&(n=t+lengthBytesUTF8(e),i=HEAP8[n]),stringToUTF8(e,t,1/0),r&&(HEAP8[n]=i)}function writeArrayToMemory(e,t){HEAP8.set(e,t)}function writeAsciiToMemory(e,t,r){for(var i=0;i<e.length;++i)HEAP8[t++>>0]=e.charCodeAt(i);r||(HEAP8[t>>0]=0)}Module.addOnPreRun=addOnPreRun,Module.addOnInit=addOnInit,Module.addOnPreMain=addOnPreMain,Module.addOnExit=addOnExit,Module.addOnPostRun=addOnPostRun,Module.intArrayFromString=intArrayFromString,Module.intArrayToString=intArrayToString,Module.writeStringToMemory=writeStringToMemory,Module.writeArrayToMemory=writeArrayToMemory,Module.writeAsciiToMemory=writeAsciiToMemory,Math.imul&&-5===Math.imul(4294967295,5)||(Math.imul=function(e,t){var r=65535&e,i=65535&t;return r*i+((e>>>16)*i+r*(t>>>16)<<16)|0}),Math.imul=Math.imul,Math.clz32||(Math.clz32=function(e){e>>>=0;for(var t=0;t<32;t++)if(e&1<<31-t)return t;return 32}),Math.clz32=Math.clz32,Math.trunc||(Math.trunc=function(e){return e<0?Math.ceil(e):Math.floor(e)}),Math.trunc=Math.trunc;var Math_abs=Math.abs,Math_cos=Math.cos,Math_sin=Math.sin,Math_tan=Math.tan,Math_acos=Math.acos,Math_asin=Math.asin,Math_atan=Math.atan,Math_atan2=Math.atan2,Math_exp=Math.exp,Math_log=Math.log,Math_sqrt=Math.sqrt,Math_ceil=Math.ceil,Math_floor=Math.floor,Math_pow=Math.pow,Math_imul=Math.imul,Math_fround=Math.fround,Math_round=Math.round,Math_min=Math.min,Math_clz32=Math.clz32,Math_trunc=Math.trunc,runDependencies=0,runDependencyWatcher=null,dependenciesFulfilled=null;function addRunDependency(e){runDependencies++,Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies)}function removeRunDependency(e){if(runDependencies--,Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies),0==runDependencies&&(null!==runDependencyWatcher&&(clearInterval(runDependencyWatcher),runDependencyWatcher=null),dependenciesFulfilled)){var t=dependenciesFulfilled;dependenciesFulfilled=null,t()}}Module.addRunDependency=addRunDependency,Module.removeRunDependency=removeRunDependency,Module.preloadedImages={},Module.preloadedAudios={};var ASM_CONSTS=[];STATIC_BASE=Runtime.GLOBAL_BASE,STATICTOP=STATIC_BASE+6192,__ATINIT__.push(),allocate([228,2,0,0,81,16,0,0,12,3,0,0,177,16,0,0,32,0,0,0,0,0,0,0,12,3,0,0,94,16,0,0,48,0,0,0,0,0,0,0,228,2,0,0,127,16,0,0,12,3,0,0,140,16,0,0,16,0,0,0,0,0,0,0,12,3,0,0,183,17,0,0,32,0,0,0,0,0,0,0,12,3,0,0,147,17,0,0,72,0,0,0,0,0,0,0,108,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,0,0,0,32,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,248,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,224,1,0,0,5,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,2,0,0,0,40,20,0,0,0,4,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,16,0,0,0,1,0,0,0,2,0,0,0,3,0,0,0,4,0,0,0,5,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,56,0,0,0,1,0,0,0,5,0,0,0,3,0,0,0,4,0,0,0,5,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,37,115,40,37,117,41,58,32,65,115,115,101,114,116,105,111,110,32,102,97,105,108,117,114,101,58,32,34,37,115,34,10,0,109,95,115,105,122,101,32,60,61,32,109,95,99,97,112,97,99,105,116,121,0,46,47,105,110,99,92,99,114,110,95,100,101,99,111,109,112,46,104,0,109,105,110,95,110,101,119,95,99,97,112,97,99,105,116,121,32,60,32,40,48,120,55,70,70,70,48,48,48,48,85,32,47,32,101,108,101,109,101,110,116,95,115,105,122,101,41,0,110,101,119,95,99,97,112,97,99,105,116,121,32,38,38,32,40,110,101,119,95,99,97,112,97,99,105,116,121,32,62,32,109,95,99,97,112,97,99,105,116,121,41,0,110,117,109,95,99,111,100,101,115,91,99,93,0,115,111,114,116,101,100,95,112,111,115,32,60,32,116,111,116,97,108,95,117,115,101,100,95,115,121,109,115,0,112,67,111,100,101,115,105,122,101,115,91,115,121,109,95,105,110,100,101,120,93,32,61,61,32,99,111,100,101,115,105,122,101,0,116,32,60,32,40,49,85,32,60,60,32,116,97,98,108,101,95,98,105,116,115,41,0,109,95,108,111,111,107,117,112,91,116,93,32,61,61,32,99,85,73,78,84,51,50,95,77,65,88,0,99,114,110,100,95,109,97,108,108,111,99,58,32,115,105,122,101,32,116,111,111,32,98,105,103,0,99,114,110,100,95,109,97,108,108,111,99,58,32,111,117,116,32,111,102,32,109,101,109,111,114,121,0,40,40,117,105,110,116,51,50,41,112,95,110,101,119,32,38,32,40,67,82,78,68,95,77,73,78,95,65,76,76,79,67,95,65,76,73,71,78,77,69,78,84,32,45,32,49,41,41,32,61,61,32,48,0,99,114,110,100,95,114,101,97,108,108,111,99,58,32,98,97,100,32,112,116,114,0,99,114,110,100,95,102,114,101,101,58,32,98,97,100,32,112,116,114,0,102,97,108,115,101,0,40,116,111,116,97,108,95,115,121,109,115,32,62,61,32,49,41,32,38,38,32,40,116,111,116,97,108,95,115,121,109,115,32,60,61,32,112,114,101,102,105,120,95,99,111,100,105,110,103,58,58,99,77,97,120,83,117,112,112,111,114,116,101,100,83,121,109,115,41,0,17,18,19,20,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15,16,48,0,110,117,109,95,98,105,116,115,32,60,61,32,51,50,85,0,109,95,98,105,116,95,99,111,117,110,116,32,60,61,32,99,66,105,116,66,117,102,83,105,122,101,0,116,32,33,61,32,99,85,73,78,84,51,50,95,77,65,88,0,109,111,100,101,108,46,109,95,99,111,100,101,95,115,105,122,101,115,91,115,121,109,93,32,61,61,32,108,101,110,0,0,2,3,1,0,2,3,4,5,6,7,1,40,108,101,110,32,62,61,32,49,41,32,38,38,32,40,108,101,110,32,60,61,32,99,77,97,120,69,120,112,101,99,116,101,100,67,111,100,101,83,105,122,101,41,0,105,32,60,32,109,95,115,105,122,101,0,110,101,120,116,95,108,101,118,101,108,95,111,102,115,32,62,32,99,117,114,95,108,101,118,101,108,95,111,102,115,0,1,2,2,3,3,3,3,4,0,0,0,0,0,0,1,1,0,1,0,1,0,0,1,2,1,2,0,0,0,1,0,2,1,0,2,0,0,1,2,3,110,117,109,32,38,38,32,40,110,117,109,32,61,61,32,126,110,117,109,95,99,104,101,99,107,41,0,17,0,10,0,17,17,17,0,0,0,0,5,0,0,0,0,0,0,9,0,0,0,0,11,0,0,0,0,0,0,0,0,17,0,15,10,17,17,17,3,10,7,0,1,19,9,11,11,0,0,9,6,11,0,0,11,0,6,17,0,0,0,17,17,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,17,0,10,10,17,17,17,0,10,0,0,2,0,9,11,0,0,0,9,0,11,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,12,0,0,0,0,9,12,0,0,0,0,0,12,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,0,0,0,0,0,0,0,0,0,0,0,13,0,0,0,4,13,0,0,0,0,9,14,0,0,0,0,0,14,0,0,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,0,15,0,0,0,0,9,16,0,0,0,0,0,16,0,0,16,0,0,18,0,0,0,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,0,0,0,18,18,18,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,10,0,0,0,0,9,11,0,0,0,0,0,11,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,12,0,0,0,0,9,12,0,0,0,0,0,12,0,0,12,0,0,45,43,32,32,32,48,88,48,120,0,40,110,117,108,108,41,0,45,48,88,43,48,88,32,48,88,45,48,120,43,48,120,32,48,120,0,105,110,102,0,73,78,70,0,110,97,110,0,78,65,78,0,48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70,46,0,84,33,34,25,13,1,2,3,17,75,28,12,16,4,11,29,18,30,39,104,110,111,112,113,98,32,5,6,15,19,20,21,26,8,22,7,40,36,23,24,9,10,14,27,31,37,35,131,130,125,38,42,43,60,61,62,63,67,71,74,77,88,89,90,91,92,93,94,95,96,97,99,100,101,102,103,105,106,107,108,114,115,116,121,122,123,124,0,73,108,108,101,103,97,108,32,98,121,116,101,32,115,101,113,117,101,110,99,101,0,68,111,109,97,105,110,32,101,114,114,111,114,0,82,101,115,117,108,116,32,110,111,116,32,114,101,112,114,101,115,101,110,116,97,98,108,101,0,78,111,116,32,97,32,116,116,121,0,80,101,114,109,105,115,115,105,111,110,32,100,101,110,105,101,100,0,79,112,101,114,97,116,105,111,110,32,110,111,116,32,112,101,114,109,105,116,116,101,100,0,78,111,32,115,117,99,104,32,102,105,108,101,32,111,114,32,100,105,114,101,99,116,111,114,121,0,78,111,32,115,117,99,104,32,112,114,111,99,101,115,115,0,70,105,108,101,32,101,120,105,115,116,115,0,86,97,108,117,101,32,116,111,111,32,108,97,114,103,101,32,102,111,114,32,100,97,116,97,32,116,121,112,101,0,78,111,32,115,112,97,99,101,32,108,101,102,116,32,111,110,32,100,101,118,105,99,101,0,79,117,116,32,111,102,32,109,101,109,111,114,121,0,82,101,115,111,117,114,99,101,32,98,117,115,121,0,73,110,116,101,114,114,117,112,116,101,100,32,115,121,115,116,101,109,32,99,97,108,108,0,82,101,115,111,117,114,99,101,32,116,101,109,112,111,114,97,114,105,108,121,32,117,110,97,118,97,105,108,97,98,108,101,0,73,110,118,97,108,105,100,32,115,101,101,107,0,67,114,111,115,115,45,100,101,118,105,99,101,32,108,105,110,107,0,82,101,97,100,45,111,110,108,121,32,102,105,108,101,32,115,121,115,116,101,109,0,68,105,114,101,99,116,111,114,121,32,110,111,116,32,101,109,112,116,121,0,67,111,110,110,101,99,116,105,111,110,32,114,101,115,101,116,32,98,121,32,112,101,101,114,0,79,112,101,114,97,116,105,111,110,32,116,105,109,101,100,32,111,117,116,0,67,111,110,110,101,99,116,105,111,110,32,114,101,102,117,115,101,100,0,72,111,115,116,32,105,115,32,100,111,119,110,0,72,111,115,116,32,105,115,32,117,110,114,101,97,99,104,97,98,108,101,0,65,100,100,114,101,115,115,32,105,110,32,117,115,101,0,66,114,111,107,101,110,32,112,105,112,101,0,73,47,79,32,101,114,114,111,114,0,78,111,32,115,117,99,104,32,100,101,118,105,99,101,32,111,114,32,97,100,100,114,101,115,115,0,66,108,111,99,107,32,100,101,118,105,99,101,32,114,101,113,117,105,114,101,100,0,78,111,32,115,117,99,104,32,100,101,118,105,99,101,0,78,111,116,32,97,32,100,105,114,101,99,116,111,114,121,0,73,115,32,97,32,100,105,114,101,99,116,111,114,121,0,84,101,120,116,32,102,105,108,101,32,98,117,115,121,0,69,120,101,99,32,102,111,114,109,97,116,32,101,114,114,111,114,0,73,110,118,97,108,105,100,32,97,114,103,117,109,101,110,116,0,65,114,103,117,109,101,110,116,32,108,105,115,116,32,116,111,111,32,108,111,110,103,0,83,121,109,98,111,108,105,99,32,108,105,110,107,32,108,111,111,112,0,70,105,108,101,110,97,109,101,32,116,111,111,32,108,111,110,103,0,84,111,111,32,109,97,110,121,32,111,112,101,110,32,102,105,108,101,115,32,105,110,32,115,121,115,116,101,109,0,78,111,32,102,105,108,101,32,100,101,115,99,114,105,112,116,111,114,115,32,97,118,97,105,108,97,98,108,101,0,66,97,100,32,102,105,108,101,32,100,101,115,99,114,105,112,116,111,114,0,78,111,32,99,104,105,108,100,32,112,114,111,99,101,115,115,0,66,97,100,32,97,100,100,114,101,115,115,0,70,105,108,101,32,116,111,111,32,108,97,114,103,101,0,84,111,111,32,109,97,110,121,32,108,105,110,107,115,0,78,111,32,108,111,99,107,115,32,97,118,97,105,108,97,98,108,101,0,82,101,115,111,117,114,99,101,32,100,101,97,100,108,111,99,107,32,119,111,117,108,100,32,111,99,99,117,114,0,83,116,97,116,101,32,110,111,116,32,114,101,99,111,118,101,114,97,98,108,101,0,80,114,101,118,105,111,117,115,32,111,119,110,101,114,32,100,105,101,100,0,79,112,101,114,97,116,105,111,110,32,99,97,110,99,101,108,101,100,0,70,117,110,99,116,105,111,110,32,110,111,116,32,105,109,112,108,101,109,101,110,116,101,100,0,78,111,32,109,101,115,115,97,103,101,32,111,102,32,100,101,115,105,114,101,100,32,116,121,112,101,0,73,100,101,110,116,105,102,105,101,114,32,114,101,109,111,118,101,100,0,68,101,118,105,99,101,32,110,111,116,32,97,32,115,116,114,101,97,109,0,78,111,32,100,97,116,97,32,97,118,97,105,108,97,98,108,101,0,68,101,118,105,99,101,32,116,105,109,101,111,117,116,0,79,117,116,32,111,102,32,115,116,114,101,97,109,115,32,114,101,115,111,117,114,99,101,115,0,76,105,110,107,32,104,97,115,32,98,101,101,110,32,115,101,118,101,114,101,100,0,80,114,111,116,111,99,111,108,32,101,114,114,111,114,0,66,97,100,32,109,101,115,115,97,103,101,0,70,105,108,101,32,100,101,115,99,114,105,112,116,111,114,32,105,110,32,98,97,100,32,115,116,97,116,101,0,78,111,116,32,97,32,115,111,99,107,101,116,0,68,101,115,116,105,110,97,116,105,111,110,32,97,100,100,114,101,115,115,32,114,101,113,117,105,114,101,100,0,77,101,115,115,97,103,101,32,116,111,111,32,108,97,114,103,101,0,80,114,111,116,111,99,111,108,32,119,114,111,110,103,32,116,121,112,101,32,102,111,114,32,115,111,99,107,101,116,0,80,114,111,116,111,99,111,108,32,110,111,116,32,97,118,97,105,108,97,98,108,101,0,80,114,111,116,111,99,111,108,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,83,111,99,107,101,116,32,116,121,112,101,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,78,111,116,32,115,117,112,112,111,114,116,101,100,0,80,114,111,116,111,99,111,108,32,102,97,109,105,108,121,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,65,100,100,114,101,115,115,32,102,97,109,105,108,121,32,110,111,116,32,115,117,112,112,111,114,116,101,100,32,98,121,32,112,114,111,116,111,99,111,108,0,65,100,100,114,101,115,115,32,110,111,116,32,97,118,97,105,108,97,98,108,101,0,78,101,116,119,111,114,107,32,105,115,32,100,111,119,110,0,78,101,116,119,111,114,107,32,117,110,114,101,97,99,104,97,98,108,101,0,67,111,110,110,101,99,116,105,111,110,32,114,101,115,101,116,32,98,121,32,110,101,116,119,111,114,107,0,67,111,110,110,101,99,116,105,111,110,32,97,98,111,114,116,101,100,0,78,111,32,98,117,102,102,101,114,32,115,112,97,99,101,32,97,118,97,105,108,97,98,108,101,0,83,111,99,107,101,116,32,105,115,32,99,111,110,110,101,99,116,101,100,0,83,111,99,107,101,116,32,110,111,116,32,99,111,110,110,101,99,116,101,100,0,67,97,110,110,111,116,32,115,101,110,100,32,97,102,116,101,114,32,115,111,99,107,101,116,32,115,104,117,116,100,111,119,110,0,79,112,101,114,97,116,105,111,110,32,97,108,114,101,97,100,121,32,105,110,32,112,114,111,103,114,101,115,115,0,79,112,101,114,97,116,105,111,110,32,105,110,32,112,114,111,103,114,101,115,115,0,83,116,97,108,101,32,102,105,108,101,32,104,97,110,100,108,101,0,82,101,109,111,116,101,32,73,47,79,32,101,114,114,111,114,0,81,117,111,116,97,32,101,120,99,101,101,100,101,100,0,78,111,32,109,101,100,105,117,109,32,102,111,117,110,100,0,87,114,111,110,103,32,109,101,100,105,117,109,32,116,121,112,101,0,78,111,32,101,114,114,111,114,32,105,110,102,111,114,109,97,116,105,111,110,0,0,116,101,114,109,105,110,97,116,105,110,103,32,119,105,116,104,32,37,115,32,101,120,99,101,112,116,105,111,110,32,111,102,32,116,121,112,101,32,37,115,58,32,37,115,0,116,101,114,109,105,110,97,116,105,110,103,32,119,105,116,104,32,37,115,32,101,120,99,101,112,116,105,111,110,32,111,102,32,116,121,112,101,32,37,115,0,116,101,114,109,105,110,97,116,105,110,103,32,119,105,116,104,32,37,115,32,102,111,114,101,105,103,110,32,101,120,99,101,112,116,105,111,110,0,116,101,114,109,105,110,97,116,105,110,103,0,117,110,99,97,117,103,104,116,0,83,116,57,101,120,99,101,112,116,105,111,110,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,54,95,95,115,104,105,109,95,116,121,112,101,95,105,110,102,111,69,0,83,116,57,116,121,112,101,95,105,110,102,111,0,78,49,48,95,95,99,120,120,97,98,105,118,49,50,48,95,95,115,105,95,99,108,97,115,115,95,116,121,112,101,95,105,110,102,111,69,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,55,95,95,99,108,97,115,115,95,116,121,112,101,95,105,110,102,111,69,0,112,116,104,114,101,97,100,95,111,110,99,101,32,102,97,105,108,117,114,101,32,105,110,32,95,95,99,120,97,95,103,101,116,95,103,108,111,98,97,108,115,95,102,97,115,116,40,41,0,99,97,110,110,111,116,32,99,114,101,97,116,101,32,112,116,104,114,101,97,100,32,107,101,121,32,102,111,114,32,95,95,99,120,97,95,103,101,116,95,103,108,111,98,97,108,115,40,41,0,99,97,110,110,111,116,32,122,101,114,111,32,111,117,116,32,116,104,114,101,97,100,32,118,97,108,117,101,32,102,111,114,32,95,95,99,120,97,95,103,101,116,95,103,108,111,98,97,108,115,40,41,0,116,101,114,109,105,110,97,116,101,95,104,97,110,100,108,101,114,32,117,110,101,120,112,101,99,116,101,100,108,121,32,114,101,116,117,114,110,101,100,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,57,95,95,112,111,105,110,116,101,114,95,116,121,112,101,95,105,110,102,111,69,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,55,95,95,112,98,97,115,101,95,116,121,112,101,95,105,110,102,111,69,0],"i8",ALLOC_NONE,Runtime.GLOBAL_BASE);var tempDoublePtr=STATICTOP;function _abort(){Module.abort()}function __ZSt18uncaught_exceptionv(){return!!__ZSt18uncaught_exceptionv.uncaught_exception}STATICTOP+=16;var EXCEPTIONS={last:0,caught:[],infos:{},deAdjust:function(e){if(!e||EXCEPTIONS.infos[e])return e;for(var t in EXCEPTIONS.infos){if(EXCEPTIONS.infos[t].adjusted===e)return t}return e},addRef:function(e){e&&EXCEPTIONS.infos[e].refcount++},decRef:function(e){if(e){var t=EXCEPTIONS.infos[e];assert(0<t.refcount),t.refcount--,0!==t.refcount||t.rethrown||(t.destructor&&Module.dynCall_vi(t.destructor,e),delete EXCEPTIONS.infos[e],___cxa_free_exception(e))}},clearRef:function(e){e&&(EXCEPTIONS.infos[e].refcount=0)}};function ___cxa_begin_catch(e){var t=EXCEPTIONS.infos[e];return t&&!t.caught&&(t.caught=!0,__ZSt18uncaught_exceptionv.uncaught_exception--),t&&(t.rethrown=!1),EXCEPTIONS.caught.push(e),EXCEPTIONS.addRef(EXCEPTIONS.deAdjust(e)),e}function _pthread_once(e,t){_pthread_once.seen||(_pthread_once.seen={}),e in _pthread_once.seen||(Module.dynCall_v(t),_pthread_once.seen[e]=1)}function _emscripten_memcpy_big(e,t,r){return HEAPU8.set(HEAPU8.subarray(t,t+r),e),e}var SYSCALLS={varargs:0,get:function(e){return SYSCALLS.varargs+=4,HEAP32[SYSCALLS.varargs-4>>2]},getStr:function(){return Pointer_stringify(SYSCALLS.get())},get64:function(){var e=SYSCALLS.get(),t=SYSCALLS.get();return assert(0<=e?0===t:-1===t),e},getZero:function(){assert(0===SYSCALLS.get())}};function ___syscall6(e,t){SYSCALLS.varargs=t;try{var r=SYSCALLS.getStreamFromFD();return FS.close(r),0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||abort(e),-e.errno}}var cttz_i8=allocate([8,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,7,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0],"i8",ALLOC_STATIC),PTHREAD_SPECIFIC={};function _pthread_getspecific(e){return PTHREAD_SPECIFIC[e]||0}function ___setErrNo(e){return Module.___errno_location&&(HEAP32[Module.___errno_location()>>2]=e),e}var PTHREAD_SPECIFIC_NEXT_KEY=1,ERRNO_CODES={EPERM:1,ENOENT:2,ESRCH:3,EINTR:4,EIO:5,ENXIO:6,E2BIG:7,ENOEXEC:8,EBADF:9,ECHILD:10,EAGAIN:11,EWOULDBLOCK:11,ENOMEM:12,EACCES:13,EFAULT:14,ENOTBLK:15,EBUSY:16,EEXIST:17,EXDEV:18,ENODEV:19,ENOTDIR:20,EISDIR:21,EINVAL:22,ENFILE:23,EMFILE:24,ENOTTY:25,ETXTBSY:26,EFBIG:27,ENOSPC:28,ESPIPE:29,EROFS:30,EMLINK:31,EPIPE:32,EDOM:33,ERANGE:34,ENOMSG:42,EIDRM:43,ECHRNG:44,EL2NSYNC:45,EL3HLT:46,EL3RST:47,ELNRNG:48,EUNATCH:49,ENOCSI:50,EL2HLT:51,EDEADLK:35,ENOLCK:37,EBADE:52,EBADR:53,EXFULL:54,ENOANO:55,EBADRQC:56,EBADSLT:57,EDEADLOCK:35,EBFONT:59,ENOSTR:60,ENODATA:61,ETIME:62,ENOSR:63,ENONET:64,ENOPKG:65,EREMOTE:66,ENOLINK:67,EADV:68,ESRMNT:69,ECOMM:70,EPROTO:71,EMULTIHOP:72,EDOTDOT:73,EBADMSG:74,ENOTUNIQ:76,EBADFD:77,EREMCHG:78,ELIBACC:79,ELIBBAD:80,ELIBSCN:81,ELIBMAX:82,ELIBEXEC:83,ENOSYS:38,ENOTEMPTY:39,ENAMETOOLONG:36,ELOOP:40,EOPNOTSUPP:95,EPFNOSUPPORT:96,ECONNRESET:104,ENOBUFS:105,EAFNOSUPPORT:97,EPROTOTYPE:91,ENOTSOCK:88,ENOPROTOOPT:92,ESHUTDOWN:108,ECONNREFUSED:111,EADDRINUSE:98,ECONNABORTED:103,ENETUNREACH:101,ENETDOWN:100,ETIMEDOUT:110,EHOSTDOWN:112,EHOSTUNREACH:113,EINPROGRESS:115,EALREADY:114,EDESTADDRREQ:89,EMSGSIZE:90,EPROTONOSUPPORT:93,ESOCKTNOSUPPORT:94,EADDRNOTAVAIL:99,ENETRESET:102,EISCONN:106,ENOTCONN:107,ETOOMANYREFS:109,EUSERS:87,EDQUOT:122,ESTALE:116,ENOTSUP:95,ENOMEDIUM:123,EILSEQ:84,EOVERFLOW:75,ECANCELED:125,ENOTRECOVERABLE:131,EOWNERDEAD:130,ESTRPIPE:86};function _pthread_key_create(e,t){return 0==e?ERRNO_CODES.EINVAL:(HEAP32[e>>2]=PTHREAD_SPECIFIC_NEXT_KEY,PTHREAD_SPECIFIC[PTHREAD_SPECIFIC_NEXT_KEY]=0,PTHREAD_SPECIFIC_NEXT_KEY++,0)}function ___resumeException(e){throw EXCEPTIONS.last||(EXCEPTIONS.last=e),e+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."}function ___cxa_find_matching_catch(){var e=EXCEPTIONS.last;if(!e)return 0|(Runtime.setTempRet0(0),0);var t=EXCEPTIONS.infos[e],r=t.type;if(!r)return 0|(Runtime.setTempRet0(0),e);var i=Array.prototype.slice.call(arguments);Module.___cxa_is_pointer_type(r);___cxa_find_matching_catch.buffer||(___cxa_find_matching_catch.buffer=_malloc(4)),HEAP32[___cxa_find_matching_catch.buffer>>2]=e,e=___cxa_find_matching_catch.buffer;for(var n=0;n<i.length;n++)if(i[n]&&Module.___cxa_can_catch(i[n],r,e))return e=HEAP32[e>>2],t.adjusted=e,0|(Runtime.setTempRet0(i[n]),e);return e=HEAP32[e>>2],0|(Runtime.setTempRet0(r),e)}function ___gxx_personality_v0(){}function _pthread_setspecific(e,t){return e in PTHREAD_SPECIFIC?(PTHREAD_SPECIFIC[e]=t,0):ERRNO_CODES.EINVAL}function ___syscall140(e,t){SYSCALLS.varargs=t;try{var r=SYSCALLS.getStreamFromFD(),i=(SYSCALLS.get(),SYSCALLS.get()),n=SYSCALLS.get(),o=SYSCALLS.get(),a=i;return FS.llseek(r,a,o),HEAP32[n>>2]=r.position,r.getdents&&0===a&&0===o&&(r.getdents=null),0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||abort(e),-e.errno}}function ___syscall146(e,t){SYSCALLS.varargs=t;try{var r=SYSCALLS.get(),i=SYSCALLS.get(),n=SYSCALLS.get(),o=0;___syscall146.buffer||(___syscall146.buffers=[null,[],[]],___syscall146.printChar=function(e,t){var r=___syscall146.buffers[e];assert(r),0===t||10===t?((1===e?Module.print:Module.printErr)(UTF8ArrayToString(r,0)),r.length=0):r.push(t)});for(var a=0;a<n;a++){for(var s=HEAP32[i+8*a>>2],l=HEAP32[i+(8*a+4)>>2],u=0;u<l;u++)___syscall146.printChar(r,HEAPU8[s+u]);o+=l}return o}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||abort(e),-e.errno}}function ___syscall54(e,t){SYSCALLS.varargs=t;try{return 0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||abort(e),-e.errno}}function invoke_iiii(e,t,r,i){try{return Module.dynCall_iiii(e,t,r,i)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_viiiii(e,t,r,i,n,o){try{Module.dynCall_viiiii(e,t,r,i,n,o)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_vi(e,t){try{Module.dynCall_vi(e,t)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_ii(e,t){try{return Module.dynCall_ii(e,t)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_viii(e,t,r,i){try{Module.dynCall_viii(e,t,r,i)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_v(e){try{Module.dynCall_v(e)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_viiiiii(e,t,r,i,n,o,a){try{Module.dynCall_viiiiii(e,t,r,i,n,o,a)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_viiii(e,t,r,i,n){try{Module.dynCall_viiii(e,t,r,i,n)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}__ATEXIT__.push(function(){var e=Module._fflush;e&&e(0);var t=___syscall146.printChar;if(t){var r=___syscall146.buffers;r[1].length&&t(1,10),r[2].length&&t(2,10)}}),DYNAMICTOP_PTR=allocate(1,"i32",ALLOC_STATIC),STACK_BASE=STACKTOP=Runtime.alignMemory(STATICTOP),STACK_MAX=STACK_BASE+TOTAL_STACK,DYNAMIC_BASE=Runtime.alignMemory(STACK_MAX),HEAP32[DYNAMICTOP_PTR>>2]=DYNAMIC_BASE,staticSealed=!0,Module.asmGlobalArg={Math:Math,Int8Array:Int8Array,Int16Array:Int16Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0,byteLength:byteLength},Module.asmLibraryArg={abort:abort,assert:assert,enlargeMemory:enlargeMemory,getTotalMemory:getTotalMemory,abortOnCannotGrowMemory:abortOnCannotGrowMemory,invoke_iiii:invoke_iiii,invoke_viiiii:invoke_viiiii,invoke_vi:invoke_vi,invoke_ii:invoke_ii,invoke_viii:invoke_viii,invoke_v:invoke_v,invoke_viiiiii:invoke_viiiiii,invoke_viiii:invoke_viiii,_pthread_getspecific:_pthread_getspecific,___syscall54:___syscall54,_pthread_setspecific:_pthread_setspecific,___gxx_personality_v0:___gxx_personality_v0,___syscall6:___syscall6,___setErrNo:___setErrNo,_abort:_abort,___cxa_begin_catch:___cxa_begin_catch,_pthread_once:_pthread_once,_emscripten_memcpy_big:_emscripten_memcpy_big,_pthread_key_create:_pthread_key_create,___syscall140:___syscall140,___resumeException:___resumeException,___cxa_find_matching_catch:___cxa_find_matching_catch,___syscall146:___syscall146,__ZSt18uncaught_exceptionv:__ZSt18uncaught_exceptionv,DYNAMICTOP_PTR:DYNAMICTOP_PTR,tempDoublePtr:tempDoublePtr,ABORT:ABORT,STACKTOP:STACKTOP,STACK_MAX:STACK_MAX,cttz_i8:cttz_i8};var asm=function(e,t,r){var i=e.Int8Array,de=new i(r),n=e.Int16Array,q=new n(r),o=e.Int32Array,he=new o(r),a=e.Uint8Array,pe=new a(r),s=e.Uint16Array,fe=new s(r),l=e.Uint32Array,u=(new l(r),e.Float32Array),c=(new u(r),e.Float64Array),P=new c(r),d=e.byteLength,h=0|t.DYNAMICTOP_PTR,p=0|t.tempDoublePtr,me=(t.ABORT,0|t.STACKTOP),f=(t.STACK_MAX,0|t.cttz_i8),m=0,D=(e.NaN,e.Infinity,0),ne=(e.Math.floor,e.Math.abs,e.Math.sqrt,e.Math.pow,e.Math.cos,e.Math.sin,e.Math.tan,e.Math.acos,e.Math.asin,e.Math.atan,e.Math.atan2,e.Math.exp,e.Math.log,e.Math.ceil,e.Math.imul),g=(e.Math.min,e.Math.max,e.Math.clz32),_=t.abort,v=(t.assert,t.enlargeMemory),y=t.getTotalMemory,b=t.abortOnCannotGrowMemory,C=(t.invoke_iiii,t.invoke_viiiii,t.invoke_vi,t.invoke_ii,t.invoke_viii,t.invoke_v,t.invoke_viiiiii,t.invoke_viiii,t._pthread_getspecific),w=t.___syscall54,S=t._pthread_setspecific,T=(t.___gxx_personality_v0,t.___syscall6),E=t.___setErrNo,A=t._abort,x=(t.___cxa_begin_catch,t._pthread_once),O=t._emscripten_memcpy_big,I=t._pthread_key_create,M=t.___syscall140,R=(t.___resumeException,t.___cxa_find_matching_catch,t.___syscall146);t.__ZSt18uncaught_exceptionv;function L(e){e|=0;var t,r=0,i=0,n=0,o=0,a=0,s=0,l=0,u=0,c=0,d=0,h=0,p=0,f=0,m=0,g=0,_=0,v=0,y=0,b=0,C=0;me=(t=me)+16|0,p=t;do{if(e>>>0<245){if(e=(c=e>>>0<11?16:e+11&-8)>>>3,3&(i=(h=0|he[1144])>>>e)|0)return n=0|he[(i=(e=4616+((r=(1&i^1)+e|0)<<1<<2)|0)+8|0)>>2],(0|e)==(0|(a=0|he[(o=n+8|0)>>2]))?he[1144]=h&~(1<<r):(he[a+12>>2]=e,he[i>>2]=a),C=r<<3,he[n+4>>2]=3|C,he[(C=n+C+4|0)>>2]=1|he[C>>2],me=t,0|(C=o);if((d=0|he[1146])>>>0<c>>>0){if(0|i)return r=((r=i<<e&((r=2<<e)|0-r))&0-r)-1|0,o=0|he[(e=(r=4616+((n=((i=(r>>>=s=r>>>12&16)>>>5&8)|s|(o=(r>>>=i)>>>2&4)|(e=(r>>>=o)>>>1&2)|(n=(r>>>=e)>>>1&1))+(r>>>n)|0)<<1<<2)|0)+8|0)>>2],(0|r)==(0|(i=0|he[(s=o+8|0)>>2]))?(e=h&~(1<<n),he[1144]=e):(he[i+12>>2]=r,he[e>>2]=i,e=h),a=(n<<3)-c|0,he[o+4>>2]=3|c,he[(n=o+c|0)+4>>2]=1|a,he[n+a>>2]=a,0|d&&(o=0|he[1149],i=4616+((r=d>>>3)<<1<<2)|0,e&(r=1<<r)?r=0|he[(e=i+8|0)>>2]:(he[1144]=e|r,e=(r=i)+8|0),he[e>>2]=o,he[r+12>>2]=o,he[o+8>>2]=r,he[o+12>>2]=i),he[1146]=a,he[1149]=n,me=t,0|(C=s);if(l=0|he[1145]){if(i=(l&0-l)-1|0,e=0|he[4880+(((a=(i>>>=s=i>>>12&16)>>>5&8)|s|(u=(i>>>=a)>>>2&4)|(n=(i>>>=u)>>>1&2)|(e=(i>>>=n)>>>1&1))+(i>>>e)<<2)>>2],i=(-8&he[e+4>>2])-c|0,n=0|he[e+16+((0==(0|he[e+16>>2])&1)<<2)>>2]){for(;i=(u=(s=(-8&he[n+4>>2])-c|0)>>>0<i>>>0)?s:i,e=u?n:e,0!=(0|(n=0|he[n+16+((0==(0|he[n+16>>2])&1)<<2)>>2])););u=e,a=i}else u=e,a=i;if(u>>>0<(s=u+c|0)>>>0){o=0|he[u+24>>2],r=0|he[u+12>>2];do{if((0|r)==(0|u)){if(!(r=0|he[(e=u+20|0)>>2])&&!(r=0|he[(e=u+16|0)>>2])){i=0;break}for(;;)if(0|(n=0|he[(i=r+20|0)>>2]))r=n,e=i;else{if(!(n=0|he[(i=r+16|0)>>2]))break;r=n,e=i}he[e>>2]=0,i=r}else i=0|he[u+8>>2],he[i+12>>2]=r,he[r+8>>2]=i,i=r}while(0);do{if(0|o){if(r=0|he[u+28>>2],(0|u)==(0|he[(e=4880+(r<<2)|0)>>2])){if(!(he[e>>2]=i)){he[1145]=l&~(1<<r);break}}else if(!(he[o+16+(((0|he[o+16>>2])!=(0|u)&1)<<2)>>2]=i))break;he[i+24>>2]=o,0|(r=0|he[u+16>>2])&&(he[i+16>>2]=r,he[r+24>>2]=i),0|(r=0|he[u+20>>2])&&(he[i+20>>2]=r,he[r+24>>2]=i)}}while(0);return a>>>0<16?(C=a+c|0,he[u+4>>2]=3|C,he[(C=u+C+4|0)>>2]=1|he[C>>2]):(he[u+4>>2]=3|c,he[s+4>>2]=1|a,he[s+a>>2]=a,0|d&&(n=0|he[1149],i=4616+((r=d>>>3)<<1<<2)|0,h&(r=1<<r)?r=0|he[(e=i+8|0)>>2]:(he[1144]=h|r,e=(r=i)+8|0),he[e>>2]=n,he[r+12>>2]=n,he[n+8>>2]=r,he[n+12>>2]=i),he[1146]=a,he[1149]=s),me=t,0|(C=u+8|0)}h=c}else h=c}else h=c}else if(e>>>0<=4294967231)if(c=-8&(e=e+11|0),u=0|he[1145]){n=0-c|0,l=(e>>>=8)?16777215<c>>>0?31:c>>>((l=14-((d=((b=e<<(h=(e+1048320|0)>>>16&8))+520192|0)>>>16&4)|h|(l=((b<<=d)+245760|0)>>>16&2))+(b<<l>>>15)|0)+7|0)&1|l<<1:0,i=0|he[4880+(l<<2)>>2];e:do{if(i)for(s=c<<(31==((e=0)|l)?0:25-(l>>>1)|0),a=0;;){if((o=(-8&he[i+4>>2])-c|0)>>>0<n>>>0){if(!o){n=0,o=e=i,b=61;break e}e=i,n=o}if(a=0==(0|(o=0|he[i+20>>2]))|(0|o)==(0|(i=0|he[i+16+(s>>>31<<2)>>2]))?a:o,o=0==(0|i)){i=a,b=57;break}s<<=1&(1^o)}else e=i=0,b=57}while(0);if(57==(0|b)){if(0==(0|i)&0==(0|e)){if(!(e=u&((e=2<<l)|0-e))){h=c;break}h=(e&0-e)-1|0,i=(e=0)|he[4880+(((a=(h>>>=s=h>>>12&16)>>>5&8)|s|(l=(h>>>=a)>>>2&4)|(d=(h>>>=l)>>>1&2)|(i=(h>>>=d)>>>1&1))+(h>>>i)<<2)>>2]}i?(o=i,b=61):(l=e,s=n)}if(61==(0|b))for(;;){if(b=0,i=(h=(i=(-8&he[o+4>>2])-c|0)>>>0<n>>>0)?i:n,e=h?o:e,!(o=0|he[o+16+((0==(0|he[o+16>>2])&1)<<2)>>2])){l=e,s=i;break}n=i,b=61}if(0!=(0|l)&&s>>>0<((0|he[1146])-c|0)>>>0){if((a=l+c|0)>>>0<=l>>>0)return me=t,(C=0)|C;o=0|he[l+24>>2],r=0|he[l+12>>2];do{if((0|r)==(0|l)){if(!(r=0|he[(e=l+20|0)>>2])&&!(r=0|he[(e=l+16|0)>>2])){r=0;break}for(;;)if(0|(n=0|he[(i=r+20|0)>>2]))r=n,e=i;else{if(!(n=0|he[(i=r+16|0)>>2]))break;r=n,e=i}he[e>>2]=0}else C=0|he[l+8>>2],he[C+12>>2]=r,he[r+8>>2]=C}while(0);do{if(o){if(e=0|he[l+28>>2],(0|l)==(0|he[(i=4880+(e<<2)|0)>>2])){if(!(he[i>>2]=r)){n=u&~(1<<e),he[1145]=n;break}}else if(!(he[o+16+(((0|he[o+16>>2])!=(0|l)&1)<<2)>>2]=r)){n=u;break}he[r+24>>2]=o,0|(e=0|he[l+16>>2])&&(he[r+16>>2]=e,he[e+24>>2]=r),n=((e=0|he[l+20>>2])&&(he[r+20>>2]=e,he[e+24>>2]=r),u)}else n=u}while(0);do{if(16<=s>>>0){if(he[l+4>>2]=3|c,he[a+4>>2]=1|s,r=(he[a+s>>2]=s)>>>3,s>>>0<256){i=4616+(r<<1<<2)|0,(e=0|he[1144])&(r=1<<r)?r=0|he[(e=i+8|0)>>2]:(he[1144]=e|r,e=(r=i)+8|0),he[e>>2]=a,he[r+12>>2]=a,he[a+8>>2]=r,he[a+12>>2]=i;break}if(i=4880+((r=(r=s>>>8)?16777215<s>>>0?31:s>>>((r=14-((y=((C=r<<(b=(r+1048320|0)>>>16&8))+520192|0)>>>16&4)|b|(r=((C<<=y)+245760|0)>>>16&2))+(C<<r>>>15)|0)+7|0)&1|r<<1:0)<<2)|0,he[a+28>>2]=r,he[(e=a+16|0)+4>>2]=0,he[e>>2]=0,!(n&(e=1<<r))){he[1145]=n|e,he[i>>2]=a,he[a+24>>2]=i,he[a+12>>2]=a,he[a+8>>2]=a;break}for(e=s<<(31==(0|r)?0:25-(r>>>1)|0),i=0|he[i>>2];;){if((-8&he[i+4>>2]|0)==(0|s)){b=97;break}if(!(r=0|he[(n=i+16+(e>>>31<<2)|0)>>2])){b=96;break}e<<=1,i=r}if(96==(0|b)){he[n>>2]=a,he[a+24>>2]=i,he[a+12>>2]=a,he[a+8>>2]=a;break}if(97==(0|b)){C=0|he[(b=i+8|0)>>2],he[C+12>>2]=a,he[b>>2]=a,he[a+8>>2]=C,he[a+12>>2]=i,he[a+24>>2]=0;break}}else C=s+c|0,he[l+4>>2]=3|C,he[(C=l+C+4|0)>>2]=1|he[C>>2]}while(0);return me=t,0|(C=l+8|0)}h=c}else h=c;else h=-1}while(0);if(h>>>0<=(i=0|he[1146])>>>0)return r=i-h|0,e=0|he[1149],15<r>>>0?(C=e+h|0,he[1149]=C,he[1146]=r,he[C+4>>2]=1|r,he[C+r>>2]=r,he[e+4>>2]=3|h):(he[1146]=0,he[1149]=0,he[e+4>>2]=3|i,he[(C=e+i+4|0)>>2]=1|he[C>>2]),me=t,0|(C=e+8|0);if(h>>>0<(s=0|he[1147])>>>0)return y=s-h|0,he[1147]=y,b=(C=0|he[1150])+h|0,he[1150]=b,he[b+4>>2]=1|y,he[C+4>>2]=3|h,me=t,0|(C=C+8|0);if(l=h+48|0,(c=(a=(e=0|he[1262]?0|he[1264]:(he[1264]=4096,he[1263]=4096,he[1265]=-1,he[1266]=-1,he[1267]=0,he[1255]=0,e=-16&p^1431655768,he[p>>2]=e,he[1262]=e,4096))+(u=h+47|0)|0)&(o=0-e|0))>>>0<=h>>>0)return me=t,(C=0)|C;if(0|(e=0|he[1254])&&(p=(d=0|he[1252])+c|0)>>>0<=d>>>0|e>>>0<p>>>0)return me=t,(C=0)|C;e:do{if(4&he[1255])r=0,b=133;else{i=0|he[1150];t:do{if(i){for(n=5024;!((e=0|he[n>>2])>>>0<=i>>>0&&(e+(0|he[(g=n+4|0)>>2])|0)>>>0>i>>>0);){if(!(e=0|he[n+8>>2])){b=118;break t}n=e}if((r=a-s&o)>>>0<2147483647)if((0|(e=0|Ee(0|r)))==((0|he[n>>2])+(0|he[g>>2])|0)){if(-1!=(0|e)){s=r,a=e,b=135;break e}}else n=e,b=126;else r=0}else b=118}while(0);do{if(118==(0|b))if(-1!=(0|(i=0|Ee(0)))&&(r=i,m=(r=(0==((m=(f=0|he[1263])+-1|0)&r|0)?0:(m+r&0-f)-r|0)+c|0)+(f=0|he[1252])|0,h>>>0<r>>>0&r>>>0<2147483647)){if(0|(g=0|he[1254])&&m>>>0<=f>>>0|g>>>0<m>>>0){r=0;break}if((0|(e=0|Ee(0|r)))==(0|i)){s=r,a=i,b=135;break e}n=e,b=126}else r=0}while(0);do{if(126==(0|b)){if(i=0-r|0,!(r>>>0<l>>>0&r>>>0<2147483647&-1!=(0|n))){if(-1==(0|n)){r=0;break}s=r,a=n,b=135;break e}if(2147483647<=(e=u-r+(e=0|he[1264])&0-e)>>>0){s=r,a=n,b=135;break e}if(-1==(0|Ee(0|e))){Ee(0|i),r=0;break}s=e+r|0,a=n,b=135;break e}}while(0);he[1255]=4|he[1255],b=133}}while(0);if(133==(0|b)&&c>>>0<2147483647&&!(-1==(0|(y=0|Ee(0|c)))|1^(v=(h+40|0)>>>0<(_=(g=0|Ee(0))-y|0)>>>0)|y>>>0<g>>>0&-1!=(0|y)&-1!=(0|g)^1)&&(s=v?_:r,a=y,b=135),135==(0|b)){r=(0|he[1252])+s|0,(he[1252]=r)>>>0>(0|he[1253])>>>0&&(he[1253]=r),u=0|he[1150];do{if(u){for(r=5024;;){if((0|a)==((e=0|he[r>>2])+(n=0|he[(i=r+4|0)>>2])|0)){b=145;break}if(!(o=0|he[r+8>>2]))break;r=o}if(145==(0|b)&&0==(8&he[r+12>>2]|0)&&u>>>0<a>>>0&e>>>0<=u>>>0){he[i>>2]=n+s,b=u+(C=0==(7&(C=u+8|0)|0)?0:0-C&7)|0,C=(0|he[1147])+(s-C)|0,he[1150]=b,he[1147]=C,he[b+4>>2]=1|C,he[b+C+4>>2]=40,he[1151]=he[1266];break}for(a>>>0<(0|he[1148])>>>0&&(he[1148]=a),i=a+s|0,r=5024;;){if((0|he[r>>2])==(0|i)){b=153;break}if(!(e=0|he[r+8>>2]))break;r=e}if(153==(0|b)&&0==(8&he[r+12>>2]|0)){he[r>>2]=a,he[(d=r+4|0)>>2]=(0|he[d>>2])+s,c=(d=a+(0==(7&(d=a+8|0)|0)?0:0-d&7)|0)+h|0,l=(r=i+(0==(7&(r=i+8|0)|0)?0:0-r&7)|0)-d-h|0,he[d+4>>2]=3|h;do{if((0|r)!=(0|u)){if((0|r)==(0|he[1149])){C=(0|he[1146])+l|0,he[1146]=C,he[1149]=c,he[c+4>>2]=1|C,he[c+C>>2]=C;break}if(1==(3&(e=0|he[r+4>>2])|0)){s=-8&e,n=e>>>3;e:do{if(e>>>0<256){if(e=0|he[r+8>>2],(0|(i=0|he[r+12>>2]))==(0|e)){he[1144]=he[1144]&~(1<<n);break}he[e+12>>2]=i,he[i+8>>2]=e;break}a=0|he[r+24>>2],e=0|he[r+12>>2];do{if((0|e)==(0|r)){if(!(e=0|he[(i=(n=r+16|0)+4|0)>>2])){if(!(e=0|he[n>>2])){e=0;break}i=n}for(;;)if(0|(o=0|he[(n=e+20|0)>>2]))e=o,i=n;else{if(!(o=0|he[(n=e+16|0)>>2]))break;e=o,i=n}he[i>>2]=0}else C=0|he[r+8>>2],he[C+12>>2]=e,he[e+8>>2]=C}while(0);if(!a)break;n=4880+((i=0|he[r+28>>2])<<2)|0;do{if((0|r)==(0|he[n>>2])){if(0|(he[n>>2]=e))break;he[1145]=he[1145]&~(1<<i);break e}if(!(he[a+16+(((0|he[a+16>>2])!=(0|r)&1)<<2)>>2]=e))break e}while(0);if(he[e+24>>2]=a,0|(n=0|he[(i=r+16|0)>>2])&&(he[e+16>>2]=n,he[n+24>>2]=e),!(i=0|he[i+4>>2]))break;he[e+20>>2]=i,he[i+24>>2]=e}while(0);r=r+s|0,o=s+l|0}else o=l;if(he[(r=r+4|0)>>2]=-2&he[r>>2],he[c+4>>2]=1|o,r=(he[c+o>>2]=o)>>>3,o>>>0<256){i=4616+(r<<1<<2)|0,(e=0|he[1144])&(r=1<<r)?r=0|he[(e=i+8|0)>>2]:(he[1144]=e|r,e=(r=i)+8|0),he[e>>2]=c,he[r+12>>2]=c,he[c+8>>2]=r,he[c+12>>2]=i;break}r=o>>>8;do{if(r){if(16777215<o>>>0){r=31;break}r=o>>>((r=14-((y=((C=r<<(b=(r+1048320|0)>>>16&8))+520192|0)>>>16&4)|b|(r=((C<<=y)+245760|0)>>>16&2))+(C<<r>>>15)|0)+7|0)&1|r<<1}else r=0}while(0);if(n=4880+(r<<2)|0,he[c+28>>2]=r,he[(e=c+16|0)+4>>2]=0,!((e=(he[e>>2]=0)|he[1145])&(i=1<<r))){he[1145]=e|i,he[n>>2]=c,he[c+24>>2]=n,he[c+12>>2]=c,he[c+8>>2]=c;break}for(e=o<<(31==(0|r)?0:25-(r>>>1)|0),i=0|he[n>>2];;){if((-8&he[i+4>>2]|0)==(0|o)){b=194;break}if(!(r=0|he[(n=i+16+(e>>>31<<2)|0)>>2])){b=193;break}e<<=1,i=r}if(193==(0|b)){he[n>>2]=c,he[c+24>>2]=i,he[c+12>>2]=c,he[c+8>>2]=c;break}if(194==(0|b)){C=0|he[(b=i+8|0)>>2],he[C+12>>2]=c,he[b>>2]=c,he[c+8>>2]=C,he[c+12>>2]=i,he[c+24>>2]=0;break}}else C=(0|he[1147])+l|0,he[1147]=C,he[1150]=c,he[c+4>>2]=1|C}while(0);return me=t,0|(C=d+8|0)}for(r=5024;!((e=0|he[r>>2])>>>0<=u>>>0&&u>>>0<(C=e+(0|he[r+4>>2])|0)>>>0);)r=0|he[r+8>>2];for(r=(e=(e=(o=C+-47|0)+(0==(7&(e=o+8|0)|0)?0:0-e&7)|0)>>>0<(o=u+16|0)>>>0?u:e)+8|0,b=a+(i=0==(7&(i=a+8|0)|0)?0:0-i&7)|0,i=s+-40-i|0,he[1150]=b,he[1147]=i,he[b+4>>2]=1|i,he[b+i+4>>2]=40,he[1151]=he[1266],he[(i=e+4|0)>>2]=27,he[r>>2]=he[1256],he[r+4>>2]=he[1257],he[r+8>>2]=he[1258],he[r+12>>2]=he[1259],he[1256]=a,he[1257]=s,he[1259]=0,he[1258]=r,r=e+24|0;he[(r=(b=r)+4|0)>>2]=7,(b+8|0)>>>0<C>>>0;);if((0|e)!=(0|u)){if(a=e-u|0,he[i>>2]=-2&he[i>>2],he[u+4>>2]=1|a,r=(he[e>>2]=a)>>>3,a>>>0<256){i=4616+(r<<1<<2)|0,(e=0|he[1144])&(r=1<<r)?r=0|he[(e=i+8|0)>>2]:(he[1144]=e|r,e=(r=i)+8|0),he[e>>2]=u,he[r+12>>2]=u,he[u+8>>2]=r,he[u+12>>2]=i;break}if(n=4880+((i=(r=a>>>8)?16777215<a>>>0?31:a>>>((i=14-((y=((C=r<<(b=(r+1048320|0)>>>16&8))+520192|0)>>>16&4)|b|(i=((C<<=y)+245760|0)>>>16&2))+(C<<i>>>15)|0)+7|0)&1|i<<1:0)<<2)|0,he[u+28>>2]=i,he[u+20>>2]=0,!((r=(he[o>>2]=0)|he[1145])&(e=1<<i))){he[1145]=r|e,he[n>>2]=u,he[u+24>>2]=n,he[u+12>>2]=u,he[u+8>>2]=u;break}for(e=a<<(31==(0|i)?0:25-(i>>>1)|0),i=0|he[n>>2];;){if((-8&he[i+4>>2]|0)==(0|a)){b=216;break}if(!(r=0|he[(n=i+16+(e>>>31<<2)|0)>>2])){b=215;break}e<<=1,i=r}if(215==(0|b)){he[n>>2]=u,he[u+24>>2]=i,he[u+12>>2]=u,he[u+8>>2]=u;break}if(216==(0|b)){C=0|he[(b=i+8|0)>>2],he[C+12>>2]=u,he[b>>2]=u,he[u+8>>2]=C,he[u+12>>2]=i,he[u+24>>2]=0;break}}}else{for(0==(0|(C=0|he[1148]))|a>>>0<C>>>0&&(he[1148]=a),he[1256]=a,he[1257]=s,he[1259]=0,he[1153]=he[1262],he[1152]=-1,r=0;he[(C=4616+(r<<1<<2)|0)+12>>2]=C,he[C+8>>2]=C,32!=(0|(r=r+1|0)););b=a+(C=0==(7&(C=a+8|0)|0)?0:0-C&7)|0,C=s+-40-C|0,he[1150]=b,he[1147]=C,he[b+4>>2]=1|C,he[b+C+4>>2]=40,he[1151]=he[1266]}}while(0);if(h>>>0<(r=0|he[1147])>>>0)return y=r-h|0,he[1147]=y,b=(C=0|he[1150])+h|0,he[1150]=b,he[b+4>>2]=1|y,he[C+4>>2]=3|h,me=t,0|(C=C+8|0)}return C=0|rt(),he[C>>2]=12,me=t,(C=0)|C}function N(e,t,r,i,n,o){e|=0,t=+t,r|=0,i|=0,n|=0,o|=0;var a,s=0,l=0,u=0,c=0,d=0,h=0,p=0,f=0,m=0,g=0,_=0,v=0,y=0,b=0,C=0,w=0,S=0,T=0,E=0,A=0,x=0,P=0;me=(a=me)+560|0,u=a+8|0,x=P=(_=a)+524|0,A=(c=a+512|0)+12|(he[_>>2]=0),Ue(t),S=(0|D)<0?(t=-t,T=1,2087):(T=0!=(2049&n|0)&1,0==(2048&n|0)?0==(1&n|0)?2088:2093:2090),Ue(t),E=2146435072&D;do{if(E>>>0<2146435072|2146435072==(0|E)&!1){if((s=0!=(f=2*+tt(t,_)))&&(he[_>>2]=(0|he[_>>2])-1),97==(0|(y=32|o))){p=0==(0|(m=32&o))?S:S+9|0,h=2|T,s=12-i|0;do{if(!(11<i>>>0|0==(0|s))){for(t=8;t*=16,0!=(0|(s=s+-1|0)););if(45==(0|de[p>>0])){t=-(t+(-f-t));break}t=f+t-t;break}t=f}while(0);for((0|(s=0|ve(s=(0|(l=0|he[_>>2]))<0?0-l|0:l,((0|s)<0)<<31>>31,A)))==(0|A)&&(de[(s=c+11|0)>>0]=48),de[s+-1>>0]=43+(l>>31&2),de[(d=s+-2|0)>>0]=o+15,c=(0|i)<1,u=0==(8&n|0),s=P;E=~~t,l=s+1|0,de[s>>0]=pe[2122+E>>0]|m,t=16*(t-+(0|E)),s=1!=(l-x|0)||u&c&0==t?l:(de[l>>0]=46,s+2|0),0!=t;);E=s-x|0,we(e,32,r,s=(x=A-d|0)+h+(A=0!=(0|i)&(E+-2|0)<(0|i)?i+2|0:E)|0,n),Ge(e,p,h),we(e,48,r,s,65536^n),Ge(e,P,E),we(e,48,A-E|0,0,0),Ge(e,d,x),we(e,32,r,s,8192^n);break}for(l=(0|i)<0?6:i,s?(s=(0|he[_>>2])-28|0,he[_>>2]=s,t=268435456*f):(t=f,s=0|he[_>>2]),u=E=(0|s)<0?u:u+288|0;C=~~t>>>0,he[u>>2]=C,u=u+4|0,0!=(t=1e9*(t-+(C>>>0))););if(0<(0|s))for(c=E,h=u;;){if(d=(0|s)<29?s:29,c>>>0<=(s=h+-4|0)>>>0){for(u=0;v=0|Ie(0|(b=0|Ve(0|(b=0|Ne(0|he[s>>2],0,0|d)),0|D,0|u,0)),0|(C=D),1e9,0),he[s>>2]=v,u=0|Xe(0|b,0|C,1e9,0),c>>>0<=(s=s+-4|0)>>>0;);u&&(he[(c=c+-4|0)>>2]=u)}for(u=h;!(u>>>0<=c>>>0||0|he[(s=u+-4|0)>>2]);)u=s;if(s=(0|he[_>>2])-d|0,!(0<(0|(he[_>>2]=s))))break;h=u}else c=E;if((0|s)<0){i=1+((l+25|0)/9|0)|0,g=102==(0|y);do{if(m=(0|(m=0-s|0))<9?m:9,c>>>0<u>>>0){for(d=(1<<m)-1|0,h=1e9>>>m,p=0,s=c;C=0|he[s>>2],he[s>>2]=(C>>>m)+p,p=0|ne(C&d,h),(s=s+4|0)>>>0<u>>>0;);s=0==(0|he[c>>2])?c+4|0:c,s=p?(he[u>>2]=p,c=s,u+4|0):(c=s,u)}else c=0==(0|he[c>>2])?c+4|0:c,s=u;u=(0|i)<(s-(u=g?E:c)>>2|0)?u+(i<<2)|0:s,s=(0|he[_>>2])+m|0,he[_>>2]=s}while((0|s)<0);s=c,i=u}else s=c,i=u;if(C=E,s>>>0<i>>>0){if(u=9*(C-s>>2)|0,10<=(d=0|he[s>>2])>>>0)for(c=10;u=u+1|0,(c=10*c|0)>>>0<=d>>>0;);}else u=0;if((0|(c=l-(102!=(0|y)?u:0)+(((v=0!=(0|l))&(g=103==(0|y)))<<31>>31)|0))<((9*(i-C>>2)|0)-9|0)){if(m=E+4+(((0|(c=c+9216|0))/9|0)-1024<<2)|0,(0|(c=1+((0|c)%9|0)|0))<9)for(d=10;d=10*d|0,9!=(0|(c=c+1|0)););else d=10;if((c=(m+4|0)==(0|i))&0==(0|(p=((h=0|he[m>>2])>>>0)%(d>>>0)|0)))c=m;else if(f=0==(1&((h>>>0)/(d>>>0)|0)|0)?9007199254740992:9007199254740994,t=p>>>0<(b=(0|d)/2|0)>>>0?.5:c&(0|p)==(0|b)?1:1.5,T&&(t=(b=45==(0|de[S>>0]))?-t:t,f=b?-f:f),c=h-p|0,he[m>>2]=c,f+t!=f){if(b=c+d|0,999999999<(he[m>>2]=b)>>>0)for(u=m;(c=u+-4|0)>>>(he[u>>2]=0)<s>>>0&&(he[(s=s+-4|0)>>2]=0),b=1+(0|he[c>>2])|0,999999999<(he[c>>2]=b)>>>0;)u=c;else c=m;if(u=9*(C-s>>2)|0,10<=(h=0|he[s>>2])>>>0)for(d=10;u=u+1|0,(d=10*d|0)>>>0<=h>>>0;);}else c=m;c=(c=c+4|0)>>>0<i>>>0?c:i,b=s}else c=i,b=s;for(y=c;;){if(y>>>0<=b>>>0){_=0;break}if(0|he[(s=y+-4|0)>>2]){_=1;break}y=s}i=0-u|0;do{if(g){if(l=(0|u)<(0|(s=(1&(1^v))+l|0))&-5<(0|u)?(d=o+-1|0,s+-1-u|0):(d=o+-2|0,s+-1|0),!(s=8&n)){if(_&&0!=(0|(w=0|he[y+-4>>2])))if((w>>>0)%10|0)c=0;else for(c=0,s=10;c=c+1|0,!(0|(w>>>0)%((s=10*s|0)>>>0)););else c=9;if(s=(9*(y-C>>2)|0)-9|0,102==(32|d)){l=(0|l)<(0|(m=0<(0|(m=s-c|0))?m:0))?l:m,m=0;break}l=(0|l)<(0|(m=0<(0|(m=s+u-c|0))?m:0))?l:m,m=0;break}m=s}else d=o,m=8&n}while(0);if(h=0!=(0|(g=l|m))&1,p=102==(32|d))s=(v=0)<(0|u)?u:0;else{if(((c=A)-(s=0|ve(s=(0|u)<0?i:u,((0|s)<0)<<31>>31,A))|0)<2)for(;de[(s=s+-1|0)>>0]=48,(c-s|0)<2;);de[s+-1>>0]=43+(u>>31&2),de[(s=s+-2|0)>>0]=d,s=c-(v=s)|0}if(we(e,32,r,s=T+1+l+h+s|0,n),Ge(e,S,T),we(e,48,r,s,65536^n),p){h=m=P+9|0,p=P+8|0,c=d=E>>>0<b>>>0?E:b;do{if(u=0|ve(0|he[c>>2],0,m),(0|c)==(0|d))(0|u)==(0|m)&&(de[p>>0]=48,u=p);else if(P>>>0<u>>>0)for(se(0|P,48,u-x|0);P>>>0<(u=u+-1|0)>>>0;);Ge(e,u,h-u|0),c=c+4|0}while(c>>>0<=E>>>0);if(0|g&&Ge(e,2138,1),c>>>0<y>>>0&0<(0|l))for(;;){if(P>>>0<(u=0|ve(0|he[c>>2],0,m))>>>0)for(se(0|P,48,u-x|0);P>>>0<(u=u+-1|0)>>>0;);if(Ge(e,u,(0|l)<9?l:9),u=l+-9|0,!((c=c+4|0)>>>0<y>>>0&9<(0|l))){l=u;break}l=u}we(e,48,l+9|0,9,0)}else{if(g=_?y:b+4|0,-1<(0|l)){m=0==(0|m),i=_=P+9|0,h=0-x|0,p=P+8|0,d=b;do{(0|(u=0|ve(0|he[d>>2],0,_)))==(0|_)&&(de[p>>0]=48,u=p);do{if((0|d)==(0|b)){if(c=u+1|0,Ge(e,u,1),m&(0|l)<1){u=c;break}Ge(e,2138,1),u=c}else{if(u>>>0<=P>>>0)break;for(se(0|P,48,u+h|0);P>>>0<(u=u+-1|0)>>>0;);}}while(0);Ge(e,u,(0|(x=i-u|0))<(0|l)?x:l),l=l-x|0,d=d+4|0}while(d>>>0<g>>>0&-1<(0|l))}we(e,48,l+18|0,18,0),Ge(e,v,A-v|0)}we(e,32,r,s,8192^n)}else P=0!=(32&o|0),we(e,32,r,s=T+3|0,-65537&n),Ge(e,S,T),Ge(e,t!=t|!1?P?2114:2118:P?2106:2110,3),we(e,32,r,s,8192^n)}while(0);return me=a,0|((0|s)<(0|r)?r:s)}function k(e,t,r,i,n){e|=0,t|=0,r|=0,i|=0,n|=0;var o,a,s,l,u,c,d,h,p,f=0,m=0,g=0,_=0,v=0,y=0,b=0,C=0,w=0,S=0,T=0,E=0,A=0,x=0;me=(p=me)+64|0,x=(c=p)+24|0,d=p+8|0,h=p+20|0,he[(u=p+16|0)>>2]=t,o=0!=(0|e),s=a=x+40|0,x=x+39|0,l=d+4|0,y=f=m=0;e:for(;;){do{if(-1<(0|f)){if((2147483647-f|0)<(0|m)){f=0|rt(),he[f>>2]=75,f=-1;break}f=m+f|0;break}}while(0);if(!((m=0|de[t>>0])<<24>>24)){A=87;break}g=t;t:for(;;){switch(m<<24>>24){case 37:m=g,A=9;break t;case 0:m=g;break t}E=g+1|0,he[u>>2]=E,m=0|de[E>>0],g=E}t:do{if(9==(0|A))for(;;){if(37!=((A=0)|de[g+1>>0]))break t;if(m=m+1|0,g=g+2|0,he[u>>2]=g,37!=(0|de[g>>0]))break;A=9}}while(0);if(m=m-t|0,o&&Ge(e,t,m),0|m)t=g;else{(m=(0|de[(_=g+1|0)>>0])-48|0)>>>0<10?(T=(E=36==(0|de[g+2>>0]))?m:-1,y=E?1:y,_=E?g+3|0:_):T=-1,he[u>>2]=_,g=((m=0|de[_>>0])<<24>>24)-32|0;t:do{if(g>>>0<32)for(v=0,b=m;;){if(!(75913&(m=1<<g))){m=b;break t}if(v|=m,_=_+1|0,he[u>>2]=_,32<=(g=((m=0|de[_>>0])<<24>>24)-32|0)>>>0)break;b=m}else v=0}while(0);if(m<<24>>24==42){if((m=(0|de[(g=_+1|0)>>0])-48|0)>>>0<10&&36==(0|de[_+2>>0]))he[n+(m<<2)>>2]=10,m=0|he[i+((0|de[g>>0])-48<<3)>>2],y=1,_=_+3|0;else{if(0|y){f=-1;break}_=(y=o?(y=3+(0|he[r>>2])&-4,m=0|he[y>>2],he[r>>2]=y+4,0):m=0,g)}he[u>>2]=_,m=(E=(0|m)<0)?0-m|0:m,v=E?8192|v:v}else{if((0|(m=0|Ae(u)))<0){f=-1;break}_=0|he[u>>2]}do{if(46==(0|de[_>>0])){if(42!=(0|de[_+1>>0])){he[u>>2]=_+1,g=0|Ae(u),_=0|he[u>>2];break}if((g=(0|de[(b=_+2|0)>>0])-48|0)>>>0<10&&36==(0|de[_+3>>0])){he[n+(g<<2)>>2]=10,g=0|he[i+((0|de[b>>0])-48<<3)>>2],_=_+4|0,he[u>>2]=_;break}if(0|y){f=-1;break e}o?(E=3+(0|he[r>>2])&-4,g=0|he[E>>2],he[r>>2]=E+4):g=0,_=he[u>>2]=b}else g=-1}while(0);for(S=0;;){if(57<((0|de[_>>0])-65|0)>>>0){f=-1;break e}if(E=_+1|0,he[u>>2]=E,!(((C=255&(b=0|de[(0|de[_>>0])-65+(1606+(58*S|0))>>0]))+-1|0)>>>0<8))break;S=C,_=E}if(!(b<<24>>24)){f=-1;break}w=-1<(0|T);do{if(b<<24>>24==19){if(w){f=-1;break e}A=49}else{if(w){he[n+(T<<2)>>2]=C,T=0|he[(w=i+(T<<3)|0)+4>>2],he[(A=c)>>2]=he[w>>2],he[A+4>>2]=T,A=49;break}if(!o){f=0;break e}W(c,C,r)}}while(0);if(49!=(0|A)||(A=0,o)){_=0!=(0|S)&3==(15&(_=0|de[_>>0])|0)?-33&_:_,w=-65537&v,T=0==(8192&v|0)?v:w;t:do{switch(0|_){case 110:switch((255&S)<<24>>24){case 0:case 1:he[he[c>>2]>>2]=f,m=0,t=E;continue e;case 2:m=0|he[c>>2],he[m>>2]=f,he[m+4>>2]=((0|f)<0)<<31>>31,m=0,t=E;continue e;case 3:q[he[c>>2]>>1]=f,m=0,t=E;continue e;case 4:de[he[c>>2]>>0]=f,m=0,t=E;continue e;case 6:he[he[c>>2]>>2]=f,m=0,t=E;continue e;case 7:m=0|he[c>>2],he[m>>2]=f,he[m+4>>2]=((0|f)<0)<<31>>31,m=0,t=E;continue e;default:m=0,t=E;continue e}case 112:_=120,g=8<g>>>0?g:8,t=8|T,A=61;break;case 88:case 120:t=T,A=61;break;case 111:b=2070,g=(v=0)==(8&T|0)|(0|(w=s-(C=0|Oe(t=0|he[(_=c)>>2],_=0|he[_+4>>2],a))|0))<(0|g)?g:w+1|0,w=T,A=67;break;case 105:case 100:if(t=0|he[(_=c)>>2],(0|(_=0|he[_+4>>2]))<0){t=0|Be(0,0,0|t,0|_),_=D,he[(v=c)>>2]=t,he[v+4>>2]=_,v=1,b=2070,A=66;break t}v=0!=(2049&T|0)&1,b=0==(2048&T|0)?0==(1&T|0)?2070:2072:2071,A=66;break t;case 117:b=2070,t=(v=0)|he[(_=c)>>2],_=0|he[_+4>>2],A=66;break;case 99:de[x>>0]=he[c>>2],t=x,v=0,b=2070,C=a,_=1,g=w;break;case 109:_=0|rt(),_=0|We(0|he[_>>2]),A=71;break;case 115:_=0|(_=0|he[c>>2])?_:2080,A=71;break;case 67:he[d>>2]=he[c>>2],he[l>>2]=0,C=-1,_=he[c>>2]=d,A=75;break;case 83:t=0|he[c>>2],A=g?(C=g,_=t,75):(we(e,32,m,0,T),t=0,84);break;case 65:case 71:case 70:case 69:case 97:case 103:case 102:case 101:m=0|N(e,+P[c>>3],m,g,T,_),t=E;continue e;default:v=0,b=2070,C=a,_=g,g=T}}while(0);t:do{if(61==(0|A))C=0|xe(S=0|he[(T=c)>>2],T=0|he[T+4>>2],a,32&_),v=(b=0==(8&t|0)|0==(0|S)&0==(0|T))?0:2,b=b?2070:2070+(_>>4)|0,w=t,t=S,_=T,A=67;else if(66==(0|A))C=0|ve(t,_,a),w=T,A=67;else if(71==(0|A))v=A=0,b=2070,C=(S=0==(0|(T=0|te(t=_,0,g))))?_+g|0:T,_=S?g:T-_|0,g=w;else if(75==(0|A)){for(b=_,g=t=A=0;(v=0|he[b>>2])&&!((0|(g=0|He(h,v)))<0|(C-t|0)>>>0<g>>>0)&&(t=g+t|0)>>>0<C>>>0;)b=b+4|0;if((0|g)<0){f=-1;break e}if(we(e,32,m,t,T),t)for(v=0;;){if(!(g=0|he[_>>2])){A=84;break t}if((0|t)<(0|(v=(g=0|He(h,g))+v|0))){A=84;break t}if(Ge(e,h,g),t>>>0<=v>>>0){A=84;break}_=_+4|0}else t=0,A=84}}while(0);if(67==(0|A))T=(A=0)!=(0|g)|(_=0!=(0|t)|0!=(0|_)),_=s-C+(1&(1^_))|0,t=T?C:a,C=a,_=T?(0|_)<(0|g)?g:_:g,g=-1<(0|g)?-65537&w:w;else if(84==(0|A)){A=0,we(e,32,m,t,8192^T),m=(0|t)<(0|m)?m:t,t=E;continue}we(e,32,m=(0|m)<(0|(T=(w=(0|_)<(0|(S=C-t|0))?S:_)+v|0))?T:m,T,g),Ge(e,b,v),we(e,48,m,T,65536^g),we(e,48,w,S,0),Ge(e,t,S),we(e,32,m,T,8192^g),t=E}else m=0,t=E}}e:do{if(87==(0|A)&&!e)if(y){for(f=1;t=0|he[n+(f<<2)>>2];)if(W(i+(f<<3)|0,t,r),10<=(0|(f=f+1|0))){f=1;break e}for(;;){if(0|he[n+(f<<2)>>2]){f=-1;break e}if(10<=(0|(f=f+1|0))){f=1;break}}}else f=0}while(0);return me=p,0|f}function G(e,t){t|=0;var r,i,n,o,a,s,l,u,c,d,h,p,f,m,g,_=0,v=0,y=0,b=0,C=0,w=0,S=0,T=0,E=0,A=0;if(me=(g=me)+704|0,f=g+144|0,p=g+128|0,h=g+112|0,d=g+96|0,c=g+80|0,u=g+64|0,l=g+48|0,m=g+32|0,r=g+16|0,n=(w=g)+184|0,A=g+160|0,!(o=0|function(e,t){e|=0;var r=0,i=0,n=0,o=0,a=0,s=0,l=0,u=0;if(me=(u=me)+528|0,o=(a=u)+16|0,!(t|=0))return me=u,(l=0)|l;if(t>>>0<=16)return l=0|ee(e,t),me=u,0|l;if(s=0|ee(e,t+-16|0),(0|(t=0|he[(l=e+20|0)>>2]))<16)for(i=e+4|0,n=e+8|0,r=e+16|0;e=(0|(e=0|he[i>>2]))==(0|he[n>>2])?0:(he[i>>2]=e+1,0|pe[e>>0]),t=t+8|0,33<=(0|(he[l>>2]=t))&&(he[a>>2]=866,he[a+4>>2]=3208,he[a+8>>2]=1366,Le(o,812,a),Ce(o),t=0|he[l>>2]),e=e<<32-t|he[r>>2],he[r>>2]=e,(0|t)<16;);else e=0|he[(r=e=e+16|0)>>2];return he[r>>2]=e<<16,he[l>>2]=t+-16,me=u,0|(l=e>>>16|s<<16)}(e|=0,14)))return function(e){var t=0,r=0,i=0,n=0,o=0,a=0;me=(a=me)+544|0,o=a+16|0,n=(i=a)+32|0,(he[(e|=0)>>2]=0)|(r=0|he[(t=e+4|0)>>2])&&(7&r?(he[i>>2]=866,he[i+4>>2]=2506,he[i+8>>2]=1232,Le(n,812,i),Ce(n)):ce(r,0,0,1,0),he[t>>2]=0,he[e+8>>2]=0,he[e+12>>2]=0);if(de[e+16>>0]=0,!(t=0|he[(e=e+20|0)>>2]))return me=a;J(t),7&t?(he[o>>2]=866,he[o+4>>2]=2506,he[o+8>>2]=1232,Le(n,812,o),Ce(n)):ce(t,0,0,1,0);he[e>>2]=0,me=a}(t),me=g,0|(A=1);if(a=t+4|0,(0|(_=0|he[(s=t+8|0)>>2]))!=(0|o)){if(_>>>0<=o>>>0){do{if((0|he[t+12>>2])>>>0<o>>>0){if(0|H(a,o,(_+1|0)==(0|o),1,0)){_=0|he[s>>2];break}return de[t+16>>0]=1,me=g,(A=0)|A}}while(0);se((0|he[a>>2])+_|0,0,o-_|0)}he[s>>2]=o}if(se(0|he[a>>2],0,0|o),(0|(_=0|he[(i=e+20|0)>>2]))<5)for(b=e+4|0,C=e+8|0,y=e+16|0;v=(0|(v=0|he[b>>2]))==(0|he[C>>2])?0:(he[b>>2]=v+1,0|pe[v>>0]),_=_+8|0,33<=(0|(he[i>>2]=_))&&(he[w>>2]=866,he[w+4>>2]=3208,he[w+8>>2]=1366,Le(n,812,w),Ce(n),_=0|he[i>>2]),v=v<<32-_|he[y>>2],he[y>>2]=v,(0|_)<5;);else v=0|he[(y=v=e+16|0)>>2];if(T=v>>>27,he[y>>2]=v<<5,he[i>>2]=_+-5,20<(T+-1|0)>>>0)return me=g,(A=0)|A;he[A+20>>2]=0,he[A>>2]=0,he[A+4>>2]=0,he[A+8>>2]=0,he[A+12>>2]=0,_=A+4|(de[A+16>>0]=0),v=A+8|0;e:do{if(0|H(_,21,0,1,0)){b=0|he[v>>2],se((S=0|he[_>>2])+b|0,0,21-b|0),he[v>>2]=21,b=e+4|0,C=e+8|0,w=e+16|0,y=0;do{if((0|(_=0|he[i>>2]))<3)for(;v=(0|(v=0|he[b>>2]))==(0|he[C>>2])?0:(he[b>>2]=v+1,0|pe[v>>0]),_=_+8|0,33<=(0|(he[i>>2]=_))&&(he[r>>2]=866,he[r+4>>2]=3208,he[r+8>>2]=1366,Le(n,812,r),Ce(n),_=0|he[i>>2]),v=v<<32-_|he[w>>2],he[w>>2]=v,(0|_)<3;);else v=0|he[w>>2];he[w>>2]=v<<3,he[i>>2]=_+-3,de[S+(0|pe[1327+y>>0])>>0]=v>>>29,y=y+1|0}while((0|y)!=(0|T));if(0|K(A)){w=e+4|0,S=e+8|0,T=e+16|0,_=0;t:do{C=o-_|0,y=0|ge(e,A);r:do{if(y>>>0<17)(0|he[s>>2])>>>0<=_>>>0&&(he[m>>2]=866,he[m+4>>2]=910,he[m+8>>2]=1497,Le(n,812,m),Ce(n)),de[(0|he[a>>2])+_>>0]=y,_=_+1|0;else switch(0|y){case 17:if((0|(v=0|he[i>>2]))<3)for(;y=(0|(y=0|he[w>>2]))==(0|he[S>>2])?0:(he[w>>2]=y+1,0|pe[y>>0]),v=v+8|0,33<=(0|(he[i>>2]=v))&&(he[l>>2]=866,he[l+4>>2]=3208,he[l+8>>2]=1366,Le(n,812,l),Ce(n),v=0|he[i>>2]),y=y<<32-v|he[T>>2],he[T>>2]=y,(0|v)<3;);else y=0|he[T>>2];if(he[T>>2]=y<<3,he[i>>2]=v+-3,v=C>>>0<(y=3+(y>>>29)|0)>>>0){_=0;break e}_=(v?0:y)+_|0;break r;case 18:if((0|(v=0|he[i>>2]))<7)for(;y=(0|(y=0|he[w>>2]))==(0|he[S>>2])?0:(he[w>>2]=y+1,0|pe[y>>0]),v=v+8|0,33<=(0|(he[i>>2]=v))&&(he[u>>2]=866,he[u+4>>2]=3208,he[u+8>>2]=1366,Le(n,812,u),Ce(n),v=0|he[i>>2]),y=y<<32-v|he[T>>2],he[T>>2]=y,(0|v)<7;);else y=0|he[T>>2];if(he[T>>2]=y<<7,he[i>>2]=v+-7,v=C>>>0<(y=11+(y>>>25)|0)>>>0){_=0;break e}_=(v?0:y)+_|0;break r;default:if(2<=(y+-19|0)>>>0){E=81;break t}if(v=0|he[i>>2],19==(0|y)){if((0|v)<2)for(y=v;b=(0|(v=0|he[w>>2]))==(0|he[S>>2])?0:(he[w>>2]=v+1,0|pe[v>>0]),v=y+8|0,33<=(0|(he[i>>2]=v))&&(he[c>>2]=866,he[c+4>>2]=3208,he[c+8>>2]=1366,Le(n,812,c),Ce(n),v=0|he[i>>2]),y=b<<32-v|he[T>>2],he[T>>2]=y,(0|v)<2;)y=v;else y=0|he[T>>2];he[T>>2]=y<<2,y>>>=30,b=3,v=v+-2|0}else{if((0|v)<6)for(;y=(0|(y=0|he[w>>2]))==(0|he[S>>2])?0:(he[w>>2]=y+1,0|pe[y>>0]),v=v+8|0,33<=(0|(he[i>>2]=v))&&(he[d>>2]=866,he[d+4>>2]=3208,he[d+8>>2]=1366,Le(n,812,d),Ce(n),v=0|he[i>>2]),y=y<<32-v|he[T>>2],he[T>>2]=y,(0|v)<6;);else y=0|he[T>>2];he[T>>2]=y<<6,y>>>=26,b=7,v=v+-6|0}if(he[i>>2]=v,0==(0|_)|C>>>0<(y=y+b|0)>>>0){_=0;break e}if(v=_+-1|0,(0|he[s>>2])>>>0<=v>>>0&&(he[h>>2]=866,he[h+4>>2]=910,he[h+8>>2]=1497,Le(n,812,h),Ce(n)),!((b=0|de[(0|he[a>>2])+v>>0])<<24>>24)){_=0;break e}if((v=y+_|0)>>>0<=_>>>0)break r;for(;(0|he[s>>2])>>>0<=_>>>0&&(he[p>>2]=866,he[p+4>>2]=910,he[p+8>>2]=1497,Le(n,812,p),Ce(n)),de[(0|he[a>>2])+_>>0]=b,(0|(_=_+1|0))!=(0|v););_=v}}while(0)}while(_>>>0<o>>>0);if(81==(0|E)){he[f>>2]=866,he[f+4>>2]=3149,he[f+8>>2]=1348,Le(n,812,f),Ce(n),_=0;break}_=(0|o)==(0|_)?0|K(t):0}else _=0}else de[A+16>>0]=1,_=0}while(0);return oe(A),me=g,0|(A=_)}function F(e,t,r,i){r|=0;var n,o,a,s,l,u,c=0,d=0,h=0,p=0,f=0,m=0,g=0,_=0,v=0,y=0,b=0,C=0,w=0,S=0,T=0,E=0,A=0,x=0,P=0,D=0,O=0,I=0;if(me=(u=me)+880|0,O=u+144|0,l=u+128|0,s=u+112|0,a=u+96|0,P=u+80|0,S=u+64|0,C=u+48|0,w=u+32|0,_=u+16|0,n=(g=u)+360|0,o=u+296|0,I=u+224|0,b=u+156|0,0==(0|(t|=0))|11<(i|=0)>>>0)return me=u,(I=0)|I;for(he[(e|=0)>>2]=t,d=(c=I)+68|0;(0|(c=c+4|(he[c>>2]=0)))<(0|d););for(c=0;d=I+((255&(D=0|de[r+c>>0]))<<2)|0,D<<24>>24&&(he[d>>2]=1+(0|he[d>>2])),(0|(c=c+1|0))!=(0|t););for(p=h=d=0,f=-1,m=1;(c=0|he[I+(m<<2)>>2])?(d=c+(he[o+((v=m+-1|0)<<2)>>2]=d)|0,D=16-m|0,he[e+28+(v<<2)>>2]=1+(d+-1<<D|(1<<D)-1),he[e+96+(v<<2)>>2]=h,v=c+(he[b+(m<<2)>>2]=h)|0,p=m>>>0<p>>>0?p:m,f=f>>>0<m>>>0?f:m):(he[e+28+(m+-1<<2)>>2]=0,v=h),17!=(0|(m=m+1|0));)d<<=1,h=v;he[e+4>>2]=v,d=e+172|0;do{if(v>>>0>(0|he[d>>2])>>>0){c=(c=v+-1|0)&v?(c|=c>>>16,c|=c>>>8,c|=c>>>4,t>>>0<(c=1+((c|=c>>>2)>>>1|c)|0)>>>0?t:c):v,he[d>>2]=c,c=0|he[(h=e+176|0)>>2];do{if(0|c){if(D=0|he[c+-4>>2],c=c+-8|0,0!=(0|D)&&(0|D)==(0|~he[c>>2])||(he[g>>2]=866,he[g+4>>2]=651,he[g+8>>2]=1579,Le(n,812,g),Ce(n)),7&c){he[_>>2]=866,he[_+4>>2]=2506,he[_+8>>2]=1232,Le(n,812,_),Ce(n);break}ce(c,0,0,1,0);break}}while(0);if(d=0|ae(8+((c=0|(c=0|he[d>>2])?c:1)<<1)|0,0)){he[d+4>>2]=c,he[d>>2]=~c,he[h>>2]=d+8,y=24;break}i=he[h>>2]=0;break}y=24}while(0);e:do{if(24==(0|y)){for(de[(D=e+24|0)>>0]=f,de[e+25>>0]=p,h=e+176|0,d=0;c=255&(x=0|de[r+d>>0]),x<<24>>24&&(0|he[I+(c<<2)>>2]||(he[w>>2]=866,he[w+4>>2]=2276,he[w+8>>2]=977,Le(n,812,w),Ce(n)),c=0|he[(x=b+(c<<2)|0)>>2],he[x>>2]=c+1,v>>>0<=c>>>0&&(he[C>>2]=866,he[C+4>>2]=2280,he[C+8>>2]=990,Le(n,812,C),Ce(n)),q[(0|he[h>>2])+(c<<1)>>1]=d),(0|(d=d+1|0))!=(0|t););if(A=(0|pe[D>>0])>>>0<i>>>0?i:0,E=0!=(0|(he[(x=e+8|0)>>2]=A))){T=1<<A,c=e+164|0;do{if(T>>>0>(0|he[c>>2])>>>0){he[c>>2]=T,c=0|he[(h=e+168|0)>>2];do{if(0|c){if(w=0|he[c+-4>>2],c=c+-8|0,0!=(0|w)&&(0|w)==(0|~he[c>>2])||(he[S>>2]=866,he[S+4>>2]=651,he[S+8>>2]=1579,Le(n,812,S),Ce(n)),7&c){he[P>>2]=866,he[P+4>>2]=2506,he[P+8>>2]=1232,Le(n,812,P),Ce(n);break}ce(c,0,0,1,0);break}}while(0);if(d=0|ae((c=T<<2)+8|0,0)){P=d+8|0,he[d+4>>2]=T,he[d>>2]=~T,d=he[h>>2]=P;break}i=he[h>>2]=0;break e}c=T<<2,d=0|he[(h=d=e+168|0)>>2]}while(0);se(0|d,-1,0|c),C=e+176|0,b=1;do{if(0|he[I+(b<<2)>>2]&&(S=1<<(w=A-b|0),d=0|he[o+((c=b+-1|0)<<2)>>2],16<=c>>>0&&(he[a>>2]=866,he[a+4>>2]=1960,he[a+8>>2]=1453,Le(n,812,a),Ce(n)),d>>>0<=(t=0==(0|(t=0|he[e+28+(c<<2)>>2]))?-1:(t+-1|0)>>>(16-b|0))>>>0)){v=(0|he[e+96+(c<<2)>>2])-d|0,y=b<<16;do{for(c=0|fe[(0|he[C>>2])+(v+d<<1)>>1],(0|pe[r+c>>0])!=(0|b)&&(he[s>>2]=866,he[s+4>>2]=2322,he[s+8>>2]=1019,Le(n,812,s),Ce(n)),_=d<<w,m=c|y,f=0;T>>>0<=(g=f+_|0)>>>0&&(he[l>>2]=866,he[l+4>>2]=2328,he[l+8>>2]=1053,Le(n,812,l),Ce(n)),c=0|he[h>>2],-1!=(0|he[c+(g<<2)>>2])&&(he[O>>2]=866,he[O+4>>2]=2330,he[O+8>>2]=1076,Le(n,812,O),Ce(n),c=0|he[h>>2]),he[c+(g<<2)>>2]=m,(f=f+1|0)>>>0<S>>>0;);d=d+1|0}while(d>>>0<=t>>>0)}b=b+1|0}while(b>>>0<=A>>>0)}he[(c=e+96|0)>>2]=(0|he[c>>2])-(0|he[o>>2]),he[(c=e+100|0)>>2]=(0|he[c>>2])-(0|he[o+4>>2]),he[(c=e+104|0)>>2]=(0|he[c>>2])-(0|he[o+8>>2]),he[(c=e+108|0)>>2]=(0|he[c>>2])-(0|he[o+12>>2]),he[(c=e+112|0)>>2]=(0|he[c>>2])-(0|he[o+16>>2]),he[(c=e+116|0)>>2]=(0|he[c>>2])-(0|he[o+20>>2]),he[(c=e+120|0)>>2]=(0|he[c>>2])-(0|he[o+24>>2]),he[(c=e+124|0)>>2]=(0|he[c>>2])-(0|he[o+28>>2]),he[(c=e+128|0)>>2]=(0|he[c>>2])-(0|he[o+32>>2]),he[(c=e+132|0)>>2]=(0|he[c>>2])-(0|he[o+36>>2]),he[(c=e+136|0)>>2]=(0|he[c>>2])-(0|he[o+40>>2]),he[(c=e+140|0)>>2]=(0|he[c>>2])-(0|he[o+44>>2]),he[(c=e+144|0)>>2]=(0|he[c>>2])-(0|he[o+48>>2]),he[(c=e+148|0)>>2]=(0|he[c>>2])-(0|he[o+52>>2]),he[(c=e+152|0)>>2]=(0|he[c>>2])-(0|he[o+56>>2]),he[(c=e+156|0)>>2]=(0|he[c>>2])-(0|he[o+60>>2]),he[(c=e+16|0)>>2]=0,he[(d=e+20|0)>>2]=pe[D>>0];t:do{if(E){do{if(!i)break t;i=(O=i)+-1|0}while(!(0|he[I+(O<<2)>>2]));if(he[c>>2]=he[e+28+(i<<2)>>2],i=A+1|0,(he[d>>2]=i)>>>0<=p>>>0){for(;!(0|he[I+(i<<2)>>2]);)if(p>>>0<(i=i+1|0)>>>0)break t;he[d>>2]=i}}}while(0);he[e+92>>2]=-1,he[e+160>>2]=1048575,he[e+12>>2]=32-(0|he[x>>2]),i=1}}while(0);return me=u,0|(I=i)}function B(e){var t=0,r=0,i=0,n=0,o=0,a=0,s=0,l=0;if(e|=0){r=e+-8|0,n=0|he[1148],l=r+(t=-8&(e=0|he[e+-4>>2]))|0;do{if(1&e)a=s=r;else{if(i=0|he[r>>2],!(3&e))return;if(o=i+t|0,(a=r+(0-i)|0)>>>0<n>>>0)return;if((0|a)==(0|he[1149])){if(3==(3&(t=0|he[(e=l+4|0)>>2])|0))return he[1146]=o,he[e>>2]=-2&t,he[a+4>>2]=1|o,void(he[a+o>>2]=o);s=a,t=o;break}if(r=i>>>3,i>>>0<256){if(e=0|he[a+8>>2],(0|(t=0|he[a+12>>2]))==(0|e)){he[1144]=he[1144]&~(1<<r),s=a,t=o;break}he[e+12>>2]=t,he[t+8>>2]=e,s=a,t=o;break}n=0|he[a+24>>2],e=0|he[a+12>>2];do{if((0|e)==(0|a)){if(!(e=0|he[(t=(r=a+16|0)+4|0)>>2])){if(!(e=0|he[r>>2])){e=0;break}t=r}for(;;)if(0|(i=0|he[(r=e+20|0)>>2]))e=i,t=r;else{if(!(i=0|he[(r=e+16|0)>>2]))break;e=i,t=r}he[t>>2]=0}else s=0|he[a+8>>2],he[s+12>>2]=e,he[e+8>>2]=s}while(0);if(n){if(t=0|he[a+28>>2],(0|a)==(0|he[(r=4880+(t<<2)|0)>>2])){if(!(he[r>>2]=e)){he[1145]=he[1145]&~(1<<t),s=a,t=o;break}}else if(!(he[n+16+(((0|he[n+16>>2])!=(0|a)&1)<<2)>>2]=e)){s=a,t=o;break}he[e+24>>2]=n,0|(r=0|he[(t=a+16|0)>>2])&&(he[e+16>>2]=r,he[r+24>>2]=e),t=(s=((t=0|he[t+4>>2])&&(he[e+20>>2]=t,he[t+24>>2]=e),a),o)}else s=a,t=o}}while(0);if(!(l>>>0<=a>>>0)&&1&(i=0|he[(e=l+4|0)>>2])){if(2&i)he[e>>2]=-2&i,he[s+4>>2]=1|t,n=he[a+t>>2]=t;else{if(e=0|he[1149],(0|l)==(0|he[1150])){if(l=(0|he[1147])+t|0,he[1147]=l,he[1150]=s,he[s+4>>2]=1|l,(0|s)!=(0|e))return;return he[1149]=0,void(he[1146]=0)}if((0|l)==(0|e))return l=(0|he[1146])+t|0,he[1146]=l,he[1149]=a,he[s+4>>2]=1|l,void(he[a+l>>2]=l);n=(-8&i)+t|0,r=i>>>3;do{if(i>>>0<256){if(t=0|he[l+8>>2],(0|(e=0|he[l+12>>2]))==(0|t)){he[1144]=he[1144]&~(1<<r);break}he[t+12>>2]=e,he[e+8>>2]=t;break}o=0|he[l+24>>2],e=0|he[l+12>>2];do{if((0|e)==(0|l)){if(!(e=0|he[(t=(r=l+16|0)+4|0)>>2])){if(!(e=0|he[r>>2])){r=0;break}t=r}for(;;)if(0|(i=0|he[(r=e+20|0)>>2]))e=i,t=r;else{if(!(i=0|he[(r=e+16|0)>>2]))break;e=i,t=r}he[t>>2]=0,r=e}else r=0|he[l+8>>2],he[r+12>>2]=e,he[e+8>>2]=r,r=e}while(0);if(0|o){if(e=0|he[l+28>>2],(0|l)==(0|he[(t=4880+(e<<2)|0)>>2])){if(!(he[t>>2]=r)){he[1145]=he[1145]&~(1<<e);break}}else if(!(he[o+16+(((0|he[o+16>>2])!=(0|l)&1)<<2)>>2]=r))break;he[r+24>>2]=o,0|(t=0|he[(e=l+16|0)>>2])&&(he[r+16>>2]=t,he[t+24>>2]=r),0|(e=0|he[e+4>>2])&&(he[r+20>>2]=e,he[e+24>>2]=r)}}while(0);if(he[s+4>>2]=1|n,he[a+n>>2]=n,(0|s)==(0|he[1149]))return void(he[1146]=n)}if(e=n>>>3,n>>>0<256)return r=4616+(e<<1<<2)|0,(t=0|he[1144])&(e=1<<e)?e=0|he[(t=r+8|0)>>2]:(he[1144]=t|e,t=(e=r)+8|0),he[t>>2]=s,he[e+12>>2]=s,he[s+8>>2]=e,void(he[s+12>>2]=r);i=4880+((e=(e=n>>>8)?16777215<n>>>0?31:n>>>((e=14-((o=((l=e<<(a=(e+1048320|0)>>>16&8))+520192|0)>>>16&4)|a|(e=((l<<=o)+245760|0)>>>16&2))+(l<<e>>>15)|0)+7|0)&1|e<<1:0)<<2)|0,he[s+28>>2]=e,he[s+20>>2]=0,t=(he[s+16>>2]=0)|he[1145],r=1<<e;do{if(t&r){for(t=n<<(31==(0|e)?0:25-(e>>>1)|0),r=0|he[i>>2];;){if((-8&he[r+4>>2]|0)==(0|n)){e=73;break}if(!(e=0|he[(i=r+16+(t>>>31<<2)|0)>>2])){e=72;break}t<<=1,r=e}if(72==(0|e)){he[i>>2]=s,he[s+24>>2]=r,he[s+12>>2]=s,he[s+8>>2]=s;break}if(73==(0|e)){l=0|he[(a=r+8|0)>>2],he[l+12>>2]=s,he[a>>2]=s,he[s+8>>2]=l,he[s+12>>2]=r,he[s+24>>2]=0;break}}else he[1145]=t|r,he[i>>2]=s,he[s+24>>2]=i,he[s+12>>2]=s,he[s+8>>2]=s}while(0);if(l=(0|he[1152])-1|0,!(he[1152]=l)){for(e=5032;e=0|he[e>>2];)e=e+8|0;he[1152]=-1}}}}function U(e,t){var r=0,i=0,n=0,o=0,a=0,s=0,l=0;l=(e|=0)+(t|=0)|0,r=0|he[e+4>>2];do{if(1&r)s=e,r=t;else{if(i=0|he[e>>2],!(3&r))return;if(a=i+t|0,(0|(o=e+(0-i)|0))==(0|he[1149])){if(3==(3&(r=0|he[(e=l+4|0)>>2])|0))return he[1146]=a,he[e>>2]=-2&r,he[o+4>>2]=1|a,void(he[o+a>>2]=a);s=o,r=a;break}if(t=i>>>3,i>>>0<256){if(e=0|he[o+8>>2],(0|(r=0|he[o+12>>2]))==(0|e)){he[1144]=he[1144]&~(1<<t),s=o,r=a;break}he[e+12>>2]=r,he[r+8>>2]=e,s=o,r=a;break}n=0|he[o+24>>2],e=0|he[o+12>>2];do{if((0|e)==(0|o)){if(!(e=0|he[(r=(t=o+16|0)+4|0)>>2])){if(!(e=0|he[t>>2])){e=0;break}r=t}for(;;)if(0|(i=0|he[(t=e+20|0)>>2]))e=i,r=t;else{if(!(i=0|he[(t=e+16|0)>>2]))break;e=i,r=t}he[r>>2]=0}else s=0|he[o+8>>2],he[s+12>>2]=e,he[e+8>>2]=s}while(0);if(n){if(r=0|he[o+28>>2],(0|o)==(0|he[(t=4880+(r<<2)|0)>>2])){if(!(he[t>>2]=e)){he[1145]=he[1145]&~(1<<r),s=o,r=a;break}}else if(!(he[n+16+(((0|he[n+16>>2])!=(0|o)&1)<<2)>>2]=e)){s=o,r=a;break}he[e+24>>2]=n,0|(t=0|he[(r=o+16|0)>>2])&&(he[e+16>>2]=t,he[t+24>>2]=e),r=(s=((r=0|he[r+4>>2])&&(he[e+20>>2]=r,he[r+24>>2]=e),o),a)}else s=o,r=a}}while(0);if(2&(i=0|he[(e=l+4|0)>>2]))he[e>>2]=-2&i,he[s+4>>2]=1|r,he[s+r>>2]=r;else{if(e=0|he[1149],(0|l)==(0|he[1150])){if(l=(0|he[1147])+r|0,he[1147]=l,he[1150]=s,he[s+4>>2]=1|l,(0|s)!=(0|e))return;return he[1149]=0,void(he[1146]=0)}if((0|l)==(0|e))return l=(0|he[1146])+r|0,he[1146]=l,he[1149]=s,he[s+4>>2]=1|l,void(he[s+l>>2]=l);o=(-8&i)+r|0,t=i>>>3;do{if(i>>>0<256){if(r=0|he[l+8>>2],(0|(e=0|he[l+12>>2]))==(0|r)){he[1144]=he[1144]&~(1<<t);break}he[r+12>>2]=e,he[e+8>>2]=r;break}n=0|he[l+24>>2],e=0|he[l+12>>2];do{if((0|e)==(0|l)){if(!(e=0|he[(r=(t=l+16|0)+4|0)>>2])){if(!(e=0|he[t>>2])){t=0;break}r=t}for(;;)if(0|(i=0|he[(t=e+20|0)>>2]))e=i,r=t;else{if(!(i=0|he[(t=e+16|0)>>2]))break;e=i,r=t}he[r>>2]=0,t=e}else t=0|he[l+8>>2],he[t+12>>2]=e,he[e+8>>2]=t,t=e}while(0);if(0|n){if(e=0|he[l+28>>2],(0|l)==(0|he[(r=4880+(e<<2)|0)>>2])){if(!(he[r>>2]=t)){he[1145]=he[1145]&~(1<<e);break}}else if(!(he[n+16+(((0|he[n+16>>2])!=(0|l)&1)<<2)>>2]=t))break;he[t+24>>2]=n,0|(r=0|he[(e=l+16|0)>>2])&&(he[t+16>>2]=r,he[r+24>>2]=t),0|(e=0|he[e+4>>2])&&(he[t+20>>2]=e,he[e+24>>2]=t)}}while(0);if(he[s+4>>2]=1|o,he[s+o>>2]=o,(0|s)==(0|he[1149]))return void(he[1146]=o);r=o}if(e=r>>>3,r>>>0<256)return t=4616+(e<<1<<2)|0,(r=0|he[1144])&(e=1<<e)?e=0|he[(r=t+8|0)>>2]:(he[1144]=r|e,r=(e=t)+8|0),he[r>>2]=s,he[e+12>>2]=s,he[s+8>>2]=e,void(he[s+12>>2]=t);if(n=4880+((e=(e=r>>>8)?16777215<r>>>0?31:r>>>((e=14-((o=((l=e<<(a=(e+1048320|0)>>>16&8))+520192|0)>>>16&4)|a|(e=((l<<=o)+245760|0)>>>16&2))+(l<<e>>>15)|0)+7|0)&1|e<<1:0)<<2)|0,he[s+28>>2]=e,he[s+20>>2]=0,!((t=(he[s+16>>2]=0)|he[1145])&(i=1<<e)))return he[1145]=t|i,he[n>>2]=s,he[s+24>>2]=n,he[s+12>>2]=s,void(he[s+8>>2]=s);for(t=r<<(31==(0|e)?0:25-(e>>>1)|0),i=0|he[n>>2];;){if((-8&he[i+4>>2]|0)==(0|r)){e=69;break}if(!(e=0|he[(n=i+16+(t>>>31<<2)|0)>>2])){e=68;break}t<<=1,i=e}return 68==(0|e)?(he[n>>2]=s,he[s+24>>2]=i,he[s+12>>2]=s,void(he[s+8>>2]=s)):69==(0|e)?(l=0|he[(a=i+8|0)>>2],he[l+12>>2]=s,he[a>>2]=s,he[s+8>>2]=l,he[s+12>>2]=i,void(he[s+24>>2]=0)):void 0}function V(e,t,r,i,n){n|=0;var o=0,a=0,s=0,l=0,u=0,c=0,d=0,h=0,p=0,f=0;if(c=e|=0,a=r|=0,s=h=i|=0,!(u=l=t|=0))return o=0!=(0|n),s?(o&&(he[n>>2]=0|e,he[n+4>>2]=0&t),(n=h=0)|(D=h,n)):(o&&(he[n>>2]=(c>>>0)%(a>>>0),he[n+4>>2]=0),(h=0)|(D=h,n=(c>>>0)/(a>>>0)>>>0));o=0==(0|s);do{if(a){if(!o){if((o=(0|g(0|s))-(0|g(0|u))|0)>>>0<=31){e=c>>>((a=d=o+1|0)>>>0)&(t=o-31>>31)|u<<(s=31-o|0),t&=u>>>(d>>>0),o=0,s=c<<s;break}return n&&(he[n>>2]=0|e,he[n+4>>2]=l|0&t),(n=h=0)|(D=h,n)}if((o=a-1|0)&a|0){e=(d=32-(s=33+(0|g(0|a))-(0|g(0|u))|0)|0)-1>>31&u>>>((p=s-32|0)>>>0)|(u<<d|c>>>((a=s)>>>0))&(t=p>>31),t&=u>>>(s>>>0),o=c<<(f=64-s|0)&(l=d>>31),s=(u<<f|c>>>(p>>>0))&l|c<<d&s-33>>31;break}return 0|n&&(he[n>>2]=o&c,he[n+4>>2]=0),1==(0|a)?0|(D=p=l|0&t,f=0|e):(f=0|Pe(0|a),0|(D=p=u>>>(f>>>0)|0,f=u<<32-f|c>>>(f>>>0)|0))}if(o)return 0|n&&(he[n>>2]=(u>>>0)%(a>>>0),he[n+4>>2]=0),(p=0)|(D=p,f=(u>>>0)/(a>>>0)>>>0);if(!c)return 0|n&&(he[n>>2]=0,he[n+4>>2]=(u>>>0)%(s>>>0)),(p=0)|(D=p,f=(u>>>0)/(s>>>0)>>>0);if(!((o=s-1|0)&s))return 0|n&&(he[n>>2]=0|e,he[n+4>>2]=o&u|0&t),f=u>>>(((p=0)|Pe(0|s))>>>0),0|(D=p,f);if((o=(0|g(0|s))-(0|g(0|u))|0)>>>0<=30){e=u<<(s=31-o|0)|c>>>((a=t=o+1|0)>>>0),t=u>>>(t>>>0),o=0,s=c<<s;break}return n&&(he[n>>2]=0|e,he[n+4>>2]=l|0&t),(f=p=0)|(D=p,f)}while(0);if(a){for(u=0|Ve(0|(d=0|r),0|(c=h|0&i),-1,-1),r=D,l=s,s=0;l=o>>>31|(i=l)<<1,o=s|o<<1,Be(0|u,0|r,0|(i=e<<1|i>>>31|0),0|(h=e>>>31|t<<1|0)),s=1&(p=(f=D)>>31|((0|f)<0?-1:0)<<1),e=0|Be(0|i,0|h,p&d|0,(((0|f)<0?-1:0)>>31|((0|f)<0?-1:0)<<1)&c|0),t=D,0!=(0|(a=a-1|0)););u=l,l=0}else u=s,s=l=0;return(a=0)|n&&(he[n>>2]=e,he[n+4>>2]=t),0|(D=p=(0|o)>>>31|(u|a)<<1|0&(a<<1|o>>>31)|l,f=-2&(o<<1|0)|s)}function ge(e,t){e|=0;var r,i,n,o,a,s,l,u,c=0,d=0,h=0,p=0,f=0,m=0;me=(u=me)+576|0,n=u+48|0,a=u+32|0,o=u+16|0,l=(i=u)+64|0,s=0|he[(t|=0)+20>>2],(0|(r=0|he[(m=e+20|0)>>2]))<24?(d=(c=0|he[(f=e+4|0)>>2])>>>0<(h=0|he[e+8>>2])>>>0,(0|r)<16?(d?(p=(0|pe[c>>0])<<8,c=c+1|0):p=0,c>>>0<h>>>0?(h=0|pe[c>>0],c=c+1|0):h=0,he[f>>2]=c,he[m>>2]=r+16,d=16,c=h|p):(c=d?(he[f>>2]=c+1,0|pe[c>>0]):0,he[m>>2]=r+8,d=24),h=he[(f=e+16|0)>>2]|c<<d-r,he[f>>2]=h):h=0|he[(f=h=e+16|0)>>2],p=1+(h>>>16)|0;do{if(!(p>>>0<=(0|he[s+16>>2])>>>0)){for(d=0|he[s+20>>2];p>>>0>(0|he[s+28+((c=d+-1|0)<<2)>>2])>>>0;)d=d+1|0;if((c=(h>>>(32-d|0))+(0|he[s+96+(c<<2)>>2])|0)>>>0<(0|he[t>>2])>>>0){c=0|fe[(0|he[s+176>>2])+(c<<1)>>1];break}return he[n>>2]=866,he[n+4>>2]=3275,he[n+8>>2]=1348,Le(l,812,n),Ce(l),me=u,(m=0)|m}-1==(0|(d=0|he[(0|he[s+168>>2])+(h>>>(32-(0|he[s+8>>2])|0)<<2)>>2]))&&(he[i>>2]=866,he[i+4>>2]=3253,he[i+8>>2]=1393,Le(l,812,i),Ce(l)),c=65535&d,d>>>=16,(0|he[t+8>>2])>>>0<=c>>>0&&(he[o>>2]=866,he[o+4>>2]=909,he[o+8>>2]=1497,Le(l,812,o),Ce(l)),(0|pe[(0|he[t+4>>2])+c>>0])!=(0|d)&&(he[a>>2]=866,he[a+4>>2]=3257,he[a+8>>2]=1410,Le(l,812,a),Ce(l))}while(0);return he[f>>2]=he[f>>2]<<d,he[m>>2]=(0|he[m>>2])-d,me=u,0|(m=c)}function z(e){var t,r,i,n,o,a=0,s=0,l=0;if(me=(o=me)+576|0,l=o+48|0,i=o+32|0,r=o+16|0,n=(t=o)+64|0,(he[(e|=0)>>2]=0)|(s=0|he[(a=e+284|0)>>2])&&(7&s?(he[t>>2]=866,he[t+4>>2]=2506,he[t+8>>2]=1232,Le(n,812,t),Ce(n)):ce(s,0,0,1,0),he[a>>2]=0,he[e+288>>2]=0,he[e+292>>2]=0),(de[e+296>>0]=0)|(s=0|he[(a=e+268|0)>>2])&&(7&s?(he[r>>2]=866,he[r+4>>2]=2506,he[r+8>>2]=1232,Le(n,812,r),Ce(n)):ce(s,0,0,1,0),he[a>>2]=0,he[e+272>>2]=0,he[e+276>>2]=0),(de[e+280>>0]=0)|(s=0|he[(a=e+252|0)>>2])&&(7&s?(he[i>>2]=866,he[i+4>>2]=2506,he[i+8>>2]=1232,Le(n,812,i),Ce(n)):ce(s,0,0,1,0),he[a>>2]=0,he[e+256>>2]=0,he[e+260>>2]=0),!(s=(de[e+264>>0]=0)|he[(a=e+236|0)>>2]))return oe(l=e+212|(de[(l=e+248|0)>>0]=0)),oe(l=e+188|0),oe(l=e+164|0),oe(l=e+140|0),oe(l=e+116|0),void(me=o);7&s?(he[l>>2]=866,he[l+4>>2]=2506,he[l+8>>2]=1232,Le(n,812,l),Ce(n)):ce(s,0,0,1,0),he[a>>2]=0,he[e+240>>2]=0,he[e+244>>2]=0,oe(l=e+212|(de[(l=e+248|0)>>0]=0)),oe(l=e+188|0),oe(l=e+164|0),oe(l=e+140|0),oe(l=e+116|0),me=o}function W(e,t,r){e|=0,t|=0,r|=0;var i=0,n=0,o=0;e:do{if(t>>>0<=20){switch(0|t){case 9:i=3+(0|he[r>>2])&-4,t=0|he[i>>2],he[r>>2]=i+4,he[e>>2]=t;break e;case 10:i=3+(0|he[r>>2])&-4,t=0|he[i>>2],he[r>>2]=i+4,he[(i=e)>>2]=t,he[i+4>>2]=((0|t)<0)<<31>>31;break e;case 11:i=3+(0|he[r>>2])&-4,t=0|he[i>>2],he[r>>2]=i+4,he[(i=e)>>2]=t,he[i+4>>2]=0;break e;case 12:i=7+(0|he[r>>2])&-8,n=0|he[(t=i)>>2],t=0|he[t+4>>2],he[r>>2]=i+8,he[(i=e)>>2]=n,he[i+4>>2]=t;break e;case 13:n=3+(0|he[r>>2])&-4,i=0|he[n>>2],he[r>>2]=n+4,i=(65535&i)<<16>>16,he[(n=e)>>2]=i,he[n+4>>2]=((0|i)<0)<<31>>31;break e;case 14:n=3+(0|he[r>>2])&-4,i=0|he[n>>2],he[r>>2]=n+4,he[(n=e)>>2]=65535&i,he[n+4>>2]=0;break e;case 15:n=3+(0|he[r>>2])&-4,i=0|he[n>>2],he[r>>2]=n+4,i=(255&i)<<24>>24,he[(n=e)>>2]=i,he[n+4>>2]=((0|i)<0)<<31>>31;break e;case 16:n=3+(0|he[r>>2])&-4,i=0|he[n>>2],he[r>>2]=n+4,he[(n=e)>>2]=255&i,he[n+4>>2]=0;break e;case 17:case 18:n=7+(0|he[r>>2])&-8,o=+P[n>>3],he[r>>2]=n+8,P[e>>3]=o;break e;default:break e}}}while(0)}function H(e,t,r,i,n){t|=0,r|=0,i|=0,n|=0;var o,a,s,l,u,c,d=0,h=0,p=0,f=0;if(me=(c=me)+576|0,l=c+48|0,o=c+32|0,h=c+16|0,s=(d=c)+64|0,u=c+60|0,f=(e|=0)+8|0,(0|he[(a=e+4|0)>>2])>>>0>(0|he[f>>2])>>>0&&(he[d>>2]=866,he[d+4>>2]=2123,he[d+8>>2]=845,Le(s,812,d),Ce(s)),(2147418112/(i>>>0)|0)>>>0<=t>>>0&&(he[h>>2]=866,he[h+4>>2]=2124,he[h+8>>2]=885,Le(s,812,h),Ce(s)),t>>>0<=(d=0|he[f>>2])>>>0)return me=c,0|(f=1);if(9==(0|(r=r&&0!=((p=t+-1|0)&t|0)?(t=p>>>16|p,t|=t>>>8,t|=t>>>4,(t=1+((t|=t>>>2)>>>1|t)|0)?9:(t=0,10)):9))&&t>>>0<=d>>>0&&(r=10),10==(0|r)&&(he[o>>2]=866,he[o+4>>2]=2133,he[o+8>>2]=933,Le(s,812,o),Ce(s)),p=0|ne(t,i),n)if(h=0|ae(p,u)){ht[0&n](h,0|he[e>>2],0|he[a>>2]),d=0|he[e>>2];do{if(0|d){if(7&d){he[l>>2]=866,he[l+4>>2]=2506,he[l+8>>2]=1232,Le(s,812,l),Ce(s);break}ce(d,0,0,1,0);break}}while(0);he[e>>2]=h,r=20}else t=0;else(d=0|function(e,t,r,i){t|=0,r|=0,i|=0;var n=0,o=0,a=0,s=0,l=0,u=0;if(me=(u=me)+560|0,l=u+32|0,o=u+16|0,a=(n=u)+48|0,s=u+44|0,7&(e|=0)|0)return he[n>>2]=866,he[n+4>>2]=2506,he[n+8>>2]=1210,Le(a,812,n),Ce(a),me=u,(l=0)|l;if(2147418112<t>>>0)return he[o>>2]=866,he[o+4>>2]=2506,he[o+8>>2]=1103,Le(a,812,o),Ce(a),me=u,(l=0)|l;he[s>>2]=t,e=0|ce(e,t,s,i,0),0|r&&(he[r>>2]=he[s>>2]);7&e|0&&(he[l>>2]=866,he[l+4>>2]=2558,he[l+8>>2]=1156,Le(a,812,l),Ce(a));return me=u,0|(l=e)}(0|he[e>>2],p,u,1))?(he[e>>2]=d,r=20):t=0;return 20==(0|r)&&(p>>>0<(d=0|he[u>>2])>>>0&&(t=(d>>>0)/(i>>>0)|0),he[f>>2]=t,t=1),me=c,0|(f=t)}function j(e,t,r,i,n,o,a){t|=0,r|=0,i|=0,n|=0,o|=0,a|=0;var s,l=0,u=0,c=0;if(c=0|he[(e|=0)+88>>2],l=((1<(l=(pe[c+12>>0]<<8|pe[c+13>>0])>>>a)>>>0?l:1)+3|0)>>>2,u=((1<(u=(pe[c+14>>0]<<8|pe[c+15>>0])>>>a)>>>0?u:1)+3|0)>>>2,a=0|de[(c=c+18|0)>>0],a=0|ne(l,a<<24>>24==0|a<<24>>24==9?8:16),o){if(!(0==(3&o|0)&a>>>0<=o>>>0))return(n=0)|n;a=o}if((0|ne(a,u))>>>0>n>>>0)return(n=0)|n;if(o=(l+1|0)>>>1,s=(u+1|0)>>>1,!r)return(n=0)|n;switch(he[e+92>>2]=t,he[e+96>>2]=t,he[e+104>>2]=r,he[e+100>>2]=t+r,he[e+108>>2]=0,(he[e+112>>2]=0)|de[c>>0]){case 0:if(!(0|function(e,t,r,i,n,o,a,s){t|=0,r|=0,i|=0,n|=0,o|=0,a|=0,s|=0;var l,u,c,d,h,p,f,m,g,_,v,y,b,C,w,S,T,E,A,x,P,D,O,I,M,R,L,N,k,F,B,U,V=0,z=0,q=0,G=0,W=0,H=0,j=0,Y=0,X=0,Q=0,Z=0,K=0,J=0,$=0,ee=0,te=0,re=0,ie=0;if(me=(U=me)+656|0,F=U+112|0,N=U+96|0,L=U+80|0,R=U+64|0,M=U+48|0,B=U+32|0,k=U+16|0,D=(I=U)+144|0,O=U+128|0,C=0|he[(b=240+(e|=0)|0)>>2],S=0|he[(w=e+256|0)>>2],T=255&(te=0|de[17+(0|he[e+88>>2])>>0]),!(te<<24>>24))return me=U,1;A=0==(0|s),P=(x=a+-1|0)<<4,te=s+-1|0,f=0!=(1&o|0),m=i<<1,g=e+92|0,_=e+116|0,v=e+140|0,y=e+236|0,p=0!=(1&n|0),h=e+188|0,l=e+252|0,u=1+(E=i>>>2)|0,c=E+2|0,d=E+3|0,r=o=ee=0,n=1;do{if(!A)for(J=0|he[t+(ee<<2)>>2],$=0;;){if(z=0==(0|(Z=1&$)),Q=(Z<<5^32)-16|0,Z=(Z<<1^2)-1|0,K=f&(e=(0|$)==(0|te)),(0|(V=z?0:x))!=(0|(X=z?a:-1)))for(Y=f&e^1,j=z?J:J+P|0;;){for(1==(0|n)&&(n=512|ge(g,_)),H=7&n,n>>>=3,z=0|pe[1539+H>>0],e=0;r=(W=(G=(q=(0|ge(g,v))+r|0)-C|0)>>31)&q|G&~W,(0|he[b>>2])>>>0<=r>>>0&&(he[I>>2]=866,he[I+4>>2]=910,he[I+8>>2]=1497,Le(D,812,I),Ce(D)),he[O+(e<<2)>>2]=he[(0|he[y>>2])+(r<<2)>>2],(e=e+1|0)>>>0<z>>>0;);if(K|(W=p&(0|V)==(0|x))){G=0;do{e=j+(0|ne(G,i))|0,q=0==(0|G)|Y,z=G<<1,o=(o=(re=(ie=(0|ge(g,h))+o|0)-S|0)>>31)&ie|re&~o;do{if(W){if(!q){o=(o=(ie=(re=(0|ge(g,h))+o|0)-S|0)>>31)&re|ie&~o;break}he[e>>2]=he[O+((0|pe[1547+(H<<2)+z>>0])<<2)>>2],(0|he[w>>2])>>>0<=o>>>0&&(he[N>>2]=866,he[N+4>>2]=910,he[N+8>>2]=1497,Le(D,812,N),Ce(D)),he[e+4>>2]=he[(0|he[l>>2])+(o<<2)>>2],o=(o=(ie=(re=(0|ge(g,h))+o|0)-S|0)>>31)&re|ie&~o}else q&&(he[e>>2]=he[O+((0|pe[1547+(H<<2)+z>>0])<<2)>>2],(0|he[w>>2])>>>0<=o>>>0&&(he[L>>2]=866,he[L+4>>2]=910,he[L+8>>2]=1497,Le(D,812,L),Ce(D)),he[e+4>>2]=he[(0|he[l>>2])+(o<<2)>>2]),e=e+8|0,o=(o=(ie=(re=(0|ge(g,h))+o|0)-S|0)>>31)&re|ie&~o,q&&(he[e>>2]=he[O+((0|pe[1547+(H<<2)+(1|z)>>0])<<2)>>2],(0|he[w>>2])>>>0<=o>>>0&&(he[F>>2]=866,he[F+4>>2]=910,he[F+8>>2]=1497,Le(D,812,F),Ce(D)),he[e+4>>2]=he[(0|he[l>>2])+(o<<2)>>2])}while(0);G=G+1|0}while(2!=(0|G))}else he[j>>2]=he[O+((0|pe[1547+(H<<2)>>0])<<2)>>2],o=(o=(ie=(re=(0|ge(g,h))+o|0)-S|0)>>31)&re|ie&~o,(0|he[w>>2])>>>0<=o>>>0&&(he[k>>2]=866,he[k+4>>2]=910,he[k+8>>2]=1497,Le(D,812,k),Ce(D)),he[j+4>>2]=he[(0|he[l>>2])+(o<<2)>>2],he[j+8>>2]=he[O+((0|pe[1547+(H<<2)+1>>0])<<2)>>2],o=(o=(ie=(re=(0|ge(g,h))+o|0)-S|0)>>31)&re|ie&~o,(0|he[w>>2])>>>0<=o>>>0&&(he[B>>2]=866,he[B+4>>2]=910,he[B+8>>2]=1497,Le(D,812,B),Ce(D)),he[j+12>>2]=he[(0|he[l>>2])+(o<<2)>>2],he[j+(E<<2)>>2]=he[O+((0|pe[1547+(H<<2)+2>>0])<<2)>>2],o=(o=(ie=(re=(0|ge(g,h))+o|0)-S|0)>>31)&re|ie&~o,(0|he[w>>2])>>>0<=o>>>0&&(he[M>>2]=866,he[M+4>>2]=910,he[M+8>>2]=1497,Le(D,812,M),Ce(D)),he[j+(u<<2)>>2]=he[(0|he[l>>2])+(o<<2)>>2],he[j+(c<<2)>>2]=he[O+((0|pe[1547+(H<<2)+3>>0])<<2)>>2],o=(o=(ie=(re=(0|ge(g,h))+o|0)-S|0)>>31)&re|ie&~o,(0|he[w>>2])>>>0<=o>>>0&&(he[R>>2]=866,he[R+4>>2]=910,he[R+8>>2]=1497,Le(D,812,R),Ce(D)),he[j+(d<<2)>>2]=he[(0|he[l>>2])+(o<<2)>>2];if((0|(V=Z+V|0))==(0|X))break;j=j+Q|0}if((0|($=$+1|0))==(0|s))break;J=J+m|0}ee=ee+1|0}while((0|ee)!=(0|T));return me=U,1}(e,i,n,a,l,u,o,s)))return(n=0)|n;break;case 4:case 6:case 5:case 3:case 2:if(!(0|function(e,t,r,i,n,o,a,s){t|=0,r|=0,i|=0,n|=0,o|=0,a|=0,s|=0;var l,u,c,d,h,p,f,m,g,_,v,y,b,C,w,S,T,E,A,x,P,D,O,I,M,R,L,N,k,F,B,U,V,z,q,G=0,W=0,H=0,j=0,Y=0,X=0,Q=0,Z=0,K=0,J=0,$=0,ee=0,te=0,re=0,ie=0,ne=0,oe=0,ae=0,se=0,le=0,ue=0,ce=0;if(me=(q=me)+640|0,U=q+80|0,B=q+64|0,F=q+48|0,z=q+32|0,V=q+16|0,L=(k=q)+128|0,N=q+112|0,p=q+96|0,m=0|he[(f=240+(e|=0)|0)>>2],_=0|he[(g=e+256|0)>>2],y=0|he[(v=e+272|0)>>2],ce=0|he[e+88>>2],b=(0|pe[ce+63>>0])<<8|0|pe[ce+64>>0],C=255&(ce=0|de[ce+17>>0]),!(ce<<24>>24))return me=q,1;w=0==(0|s),T=(S=a+-1|0)<<5,E=s+-1|0,A=i<<1,x=e+92|0,P=e+116|0,D=e+164|0,O=e+268|0,I=e+140|0,M=e+236|0,R=e+212|0,ce=e+188|0,h=0==(1&n|0),d=0==(1&o|0),u=e+288|0,c=e+284|0,l=e+252|0,r=n=o=e=ue=0,G=1;do{if(!w)for(se=0|he[t+(ue<<2)>>2],le=0;;){if(H=0==(0|(ae=1&le)),oe=(ae<<6^64)-32|0,ae=(ae<<1^2)-1|0,(0|(W=H?0:S))!=(0|(ie=H?a:-1)))for(ne=d|(0|le)!=(0|E),re=H?se:se+T|0;;){for(1==(0|G)&&(G=512|ge(x,P)),te=7&G,G>>>=3,j=0|pe[1539+te>>0],H=0;o=(ee=($=(J=(0|ge(x,D))+o|0)-y|0)>>31)&J|$&~ee,(0|he[v>>2])>>>0<=o>>>0&&(he[k>>2]=866,he[k+4>>2]=910,he[k+8>>2]=1497,Le(L,812,k),Ce(L)),he[p+(H<<2)>>2]=fe[(0|he[O>>2])+(o<<1)>>1],(H=H+1|0)>>>0<j>>>0;);for(H=0;r=(ee=($=(J=(0|ge(x,I))+r|0)-m|0)>>31)&J|$&~ee,(0|he[f>>2])>>>0<=r>>>0&&(he[V>>2]=866,he[V+4>>2]=910,he[V+8>>2]=1497,Le(L,812,V),Ce(L)),he[N+(H<<2)>>2]=he[(0|he[M>>2])+(r<<2)>>2],(H=H+1|0)>>>0<j>>>0;);for(ee=h|(0|W)!=(0|S),J=0,$=re;;){if(Q=ne|0==(0|J),Z=J<<1,ee)for(Y=0,X=$;e=(e=(j=(K=(0|ge(x,R))+e|0)-b|0)>>31)&K|j&~e,n=(n=(K=(j=(0|ge(x,ce))+n|0)-_|0)>>31)&j|K&~n,Q&&(H=0|pe[Y+Z+(1547+(te<<2))>>0],j=3*e|0,(0|he[u>>2])>>>0<=j>>>0&&(he[z>>2]=866,he[z+4>>2]=910,he[z+8>>2]=1497,Le(L,812,z),Ce(L)),K=(0|he[c>>2])+(j<<1)|0,he[X>>2]=(0|fe[K>>1])<<16|he[p+(H<<2)>>2],he[X+4>>2]=(0|fe[K+4>>1])<<16|0|fe[K+2>>1],he[X+8>>2]=he[N+(H<<2)>>2],(0|he[g>>2])>>>0<=n>>>0&&(he[F>>2]=866,he[F+4>>2]=910,he[F+8>>2]=1497,Le(L,812,F),Ce(L)),he[X+12>>2]=he[(0|he[l>>2])+(n<<2)>>2]),2!=(0|(Y=Y+1|0));)X=X+16|0;else for(K=1^Q,Q=1547+(te<<2)+Z|0,Y=0,X=$;e=(e=(j=(Z=(0|ge(x,R))+e|0)-b|0)>>31)&Z|j&~e,n=(n=(Z=(j=(0|ge(x,ce))+n|0)-_|0)>>31)&j|Z&~n,0!=(0|Y)|K||(H=0|pe[Q>>0],j=3*e|0,(0|he[u>>2])>>>0<=j>>>0&&(he[B>>2]=866,he[B+4>>2]=910,he[B+8>>2]=1497,Le(L,812,B),Ce(L)),Z=(0|he[c>>2])+(j<<1)|0,he[X>>2]=(0|fe[Z>>1])<<16|he[p+(H<<2)>>2],he[X+4>>2]=(0|fe[Z+4>>1])<<16|0|fe[Z+2>>1],he[X+8>>2]=he[N+(H<<2)>>2],(0|he[g>>2])>>>0<=n>>>0&&(he[U>>2]=866,he[U+4>>2]=910,he[U+8>>2]=1497,Le(L,812,U),Ce(L)),he[X+12>>2]=he[(0|he[l>>2])+(n<<2)>>2]),2!=(0|(Y=Y+1|0));)X=X+16|0;if(2==(0|(J=J+1|0)))break;$=$+i|0}if((0|(W=ae+W|0))==(0|ie))break;re=re+oe|0}if((0|(le=le+1|0))==(0|s))break;se=se+A|0}ue=ue+1|0}while((0|ue)!=(0|C));return me=q,1}(e,i,n,a,l,u,o,s)))return(n=0)|n;break;case 9:if(!(0|function(e,t,r,i,n,o,a,s){t|=0,r|=0,i|=0,n|=0,o|=0,a|=0,s|=0;var l,u,c,d,h,p,f,m,g,_,v,y,b,C,w,S,T,E,A,x,P,D,O,I,M=0,R=0,L=0,N=0,k=0,F=0,B=0,U=0,V=0,z=0,q=0,G=0,W=0,H=0,j=0,Y=0,X=0,Q=0;if(me=(I=me)+592|0,P=I+48|0,O=I+32|0,D=I+16|0,E=(x=I)+80|0,A=I+64|0,p=0|he[(h=272+(e|=0)|0)>>2],Q=0|he[e+88>>2],f=(0|pe[Q+63>>0])<<8|0|pe[Q+64>>0],m=255&(Q=0|de[Q+17>>0]),!(Q<<24>>24))return me=I,1;g=0==(0|s),v=(_=a+-1|0)<<4,y=s+-1|0,b=i<<1,C=e+92|0,w=e+116|0,S=e+164|0,T=e+268|0,Q=e+212|0,d=0==(1&n|0),c=0==(1&o|0),u=e+288|0,l=e+284|0,r=n=X=0,o=1;do{if(!g)for(j=0|he[t+(X<<2)>>2],Y=0;;){if(M=0==(0|(H=1&Y)),W=(H<<5^32)-16|0,H=(H<<1^2)-1|0,(0|(e=M?0:_))!=(0|(q=M?a:-1)))for(G=c|(0|Y)!=(0|y),z=M?j:j+v|0;;){for(1==(0|o)&&(o=512|ge(C,w)),V=7&o,o>>>=3,R=0|pe[1539+V>>0],M=0;r=(U=(B=(F=(0|ge(C,S))+r|0)-p|0)>>31)&F|B&~U,(0|he[h>>2])>>>0<=r>>>0&&(he[x>>2]=866,he[x+4>>2]=910,he[x+8>>2]=1497,Le(E,812,x),Ce(E)),he[A+(M<<2)>>2]=fe[(0|he[T>>2])+(r<<1)>>1],(M=M+1|0)>>>0<R>>>0;);for(U=d|(0|e)!=(0|_),F=0,B=z;k=G|0==(0|F),R=F<<1,N=(N=(L=(M=(0|ge(C,Q))+n|0)-f|0)>>31)&M|L&~N,U?(k&&(n=0|pe[1547+(V<<2)+R>>0],M=3*N|0,(0|he[u>>2])>>>0<=M>>>0&&(he[D>>2]=866,he[D+4>>2]=910,he[D+8>>2]=1497,Le(E,812,D),Ce(E)),L=(0|he[l>>2])+(M<<1)|0,he[B>>2]=(0|fe[L>>1])<<16|he[A+(n<<2)>>2],he[B+4>>2]=(0|fe[L+4>>1])<<16|0|fe[L+2>>1]),L=B+8|0,n=(n=(N=(M=(0|ge(C,Q))+N|0)-f|0)>>31)&M|N&~n,k&&(M=0|pe[1547+(V<<2)+(1|R)>>0],R=3*n|0,(0|he[u>>2])>>>0<=R>>>0&&(he[P>>2]=866,he[P+4>>2]=910,he[P+8>>2]=1497,Le(E,812,P),Ce(E)),k=(0|he[l>>2])+(R<<1)|0,he[L>>2]=(0|fe[k>>1])<<16|he[A+(M<<2)>>2],he[B+12>>2]=(0|fe[k+4>>1])<<16|0|fe[k+2>>1])):(k&&(n=0|pe[1547+(V<<2)+R>>0],M=3*N|0,(0|he[u>>2])>>>0<=M>>>0&&(he[O>>2]=866,he[O+4>>2]=910,he[O+8>>2]=1497,Le(E,812,O),Ce(E)),k=(0|he[l>>2])+(M<<1)|0,he[B>>2]=(0|fe[k>>1])<<16|he[A+(n<<2)>>2],he[B+4>>2]=(0|fe[k+4>>1])<<16|0|fe[k+2>>1]),n=(n=(k=(N=(0|ge(C,Q))+N|0)-f|0)>>31)&N|k&~n),2!=(0|(F=F+1|0));)B=B+i|0;if((0|(e=H+e|0))==(0|q))break;z=z+W|0}if((0|(Y=Y+1|0))==(0|s))break;j=j+b|0}X=X+1|0}while((0|X)!=(0|m));return me=I,1}(e,i,n,a,l,u,o,s)))return(n=0)|n;break;case 8:case 7:if(!(0|function(e,t,r,i,n,o,a,s){t|=0,r|=0,i|=0,n|=0,o|=0,a|=0,s|=0;var l,u,c,d,h,p,f,m,g,_,v,y,b,C,w,S,T,E,A,x,P,D,O,I,M,R,L,N=0,k=0,F=0,B=0,U=0,V=0,z=0,q=0,G=0,W=0,H=0,j=0,Y=0,X=0,Q=0,Z=0,K=0,J=0,$=0,ee=0,te=0,re=0,ie=0,ne=0,oe=0;if(me=(L=me)+640|0,I=L+80|0,O=L+64|0,D=L+48|0,R=L+32|0,M=L+16|0,A=(P=L)+128|0,x=L+112|0,h=L+96|0,f=0|he[(p=272+(e|=0)|0)>>2],oe=0|he[e+88>>2],m=(0|pe[oe+63>>0])<<8|0|pe[oe+64>>0],g=255&(oe=0|de[oe+17>>0]),!(oe<<24>>24))return me=L,1;_=0==(0|s),y=(v=a+-1|0)<<5,b=s+-1|0,C=i<<1,w=e+92|0,S=e+116|0,T=e+164|0,E=e+268|0,oe=e+212|0,d=0==(1&n|0),c=0==(1&o|0),u=e+288|0,l=e+284|0,r=n=o=e=ne=0,N=1;do{if(!_)for(re=0|he[t+(ne<<2)>>2],ie=0;;){if(F=0==(0|(te=1&ie)),ee=(te<<6^64)-32|0,te=(te<<1^2)-1|0,(0|(k=F?0:v))!=(0|(J=F?a:-1)))for($=c|(0|ie)!=(0|b),K=F?re:re+y|0;;){for(1==(0|N)&&(N=512|ge(w,S)),Z=7&N,N>>>=3,B=0|pe[1539+Z>>0],F=0;r=(Q=(X=(Y=(0|ge(w,T))+r|0)-f|0)>>31)&Y|X&~Q,(0|he[p>>2])>>>0<=r>>>0&&(he[P>>2]=866,he[P+4>>2]=910,he[P+8>>2]=1497,Le(A,812,P),Ce(A)),he[x+(F<<2)>>2]=fe[(0|he[E>>2])+(r<<1)>>1],(F=F+1|0)>>>0<B>>>0;);for(F=0;o=(Q=(X=(Y=(0|ge(w,T))+o|0)-f|0)>>31)&Y|X&~Q,(0|he[p>>2])>>>0<=o>>>0&&(he[M>>2]=866,he[M+4>>2]=910,he[M+8>>2]=1497,Le(A,812,M),Ce(A)),he[h+(F<<2)>>2]=fe[(0|he[E>>2])+(o<<1)>>1],(F=F+1|0)>>>0<B>>>0;);for(Q=d|(0|k)!=(0|v),Y=0,X=K;;){if(W=$|0==(0|Y),H=Y<<1,Q)for(q=0,G=X;n=(n=(z=(j=(0|ge(w,oe))+n|0)-m|0)>>31)&j|z&~n,e=(e=(j=(z=(0|ge(w,oe))+e|0)-m|0)>>31)&z|j&~e,W&&(z=0|pe[q+H+(1547+(Z<<2))>>0],B=3*n|0,(F=0|he[u>>2])>>>0<=B>>>0&&(he[R>>2]=866,he[R+4>>2]=910,he[R+8>>2]=1497,Le(A,812,R),Ce(A),F=0|he[u>>2]),B=(U=0|he[l>>2])+(B<<1)|0,j=(F=(V=3*e|0)>>>0<F>>>0?U:(he[D>>2]=866,he[D+4>>2]=910,he[D+8>>2]=1497,Le(A,812,D),Ce(A),0|he[l>>2]))+(V<<1)|0,he[G>>2]=(0|fe[B>>1])<<16|he[x+(z<<2)>>2],he[G+4>>2]=(0|fe[B+4>>1])<<16|0|fe[B+2>>1],he[G+8>>2]=(0|fe[j>>1])<<16|he[h+(z<<2)>>2],he[G+12>>2]=(0|fe[j+4>>1])<<16|0|fe[j+2>>1]),2!=(0|(q=q+1|0));)G=G+16|0;else for(j=1^W,W=1547+(Z<<2)+H|0,q=0,G=X;n=(n=(z=(H=(0|ge(w,oe))+n|0)-m|0)>>31)&H|z&~n,e=(e=(H=(z=(0|ge(w,oe))+e|0)-m|0)>>31)&z|H&~e,0!=(0|q)|j||(z=0|pe[W>>0],B=3*n|0,(F=0|he[u>>2])>>>0<=B>>>0&&(he[O>>2]=866,he[O+4>>2]=910,he[O+8>>2]=1497,Le(A,812,O),Ce(A),F=0|he[u>>2]),B=(U=0|he[l>>2])+(B<<1)|0,H=(F=(V=3*e|0)>>>0<F>>>0?U:(he[I>>2]=866,he[I+4>>2]=910,he[I+8>>2]=1497,Le(A,812,I),Ce(A),0|he[l>>2]))+(V<<1)|0,he[G>>2]=(0|fe[B>>1])<<16|he[x+(z<<2)>>2],he[G+4>>2]=(0|fe[B+4>>1])<<16|0|fe[B+2>>1],he[G+8>>2]=(0|fe[H>>1])<<16|he[h+(z<<2)>>2],he[G+12>>2]=(0|fe[H+4>>1])<<16|0|fe[H+2>>1]),2!=(0|(q=q+1|0));)G=G+16|0;if(2==(0|(Y=Y+1|0)))break;X=X+i|0}if((0|(k=te+k|0))==(0|J))break;K=K+ee|0}if((0|(ie=ie+1|0))==(0|s))break;re=re+C|0}ne=ne+1|0}while((0|ne)!=(0|g));return me=L,1}(e,i,n,a,l,u,o,s)))return(n=0)|n;break;default:return(n=0)|n}return 0|(n=1)}function Y(e,t,r){e|=0,t|=0;var i,n,o=0;if(8192<=(0|(r|=0)))return 0|O(0|e,0|t,0|r);if(n=0|e,i=e+r|0,(3&e)==(3&t)){for(;3&e;){if(!r)return 0|n;de[e>>0]=0|de[t>>0],e=e+1|0,t=t+1|0,r=r-1|0}for(o=(r=-4&i|0)-64|0;(0|e)<=(0|o);)he[e>>2]=he[t>>2],he[e+4>>2]=he[t+4>>2],he[e+8>>2]=he[t+8>>2],he[e+12>>2]=he[t+12>>2],he[e+16>>2]=he[t+16>>2],he[e+20>>2]=he[t+20>>2],he[e+24>>2]=he[t+24>>2],he[e+28>>2]=he[t+28>>2],he[e+32>>2]=he[t+32>>2],he[e+36>>2]=he[t+36>>2],he[e+40>>2]=he[t+40>>2],he[e+44>>2]=he[t+44>>2],he[e+48>>2]=he[t+48>>2],he[e+52>>2]=he[t+52>>2],he[e+56>>2]=he[t+56>>2],he[e+60>>2]=he[t+60>>2],e=e+64|0,t=t+64|0;for(;(0|e)<(0|r);)he[e>>2]=he[t>>2],e=e+4|0,t=t+4|0}else for(r=i-4|0;(0|e)<(0|r);)de[e>>0]=0|de[t>>0],de[e+1>>0]=0|de[t+1>>0],de[e+2>>0]=0|de[t+2>>0],de[e+3>>0]=0|de[t+3>>0],e=e+4|0,t=t+4|0;for(;(0|e)<(0|i);)de[e>>0]=0|de[t>>0],e=e+1|0,t=t+1|0;return 0|n}function X(e,t,r){t|=0,r|=0;var i,n,o,a,s,l=0,u=0,c=0,d=0,h=0,p=0;me=(s=me)+48|0,a=s+16|0,u=(c=s)+32|0,l=0|he[(n=(e|=0)+28|0)>>2],he[u>>2]=l,l=(0|he[(o=e+20|0)>>2])-l|0,he[u+4>>2]=l,he[u+8>>2]=t,l=l+(he[u+12>>2]=r)|0,i=e+60|0,he[c>>2]=he[i>>2],he[c+4>>2]=u,he[c+8>>2]=2,c=0|ze(0|R(146,0|c));e:do{if((0|l)!=(0|c)){for(t=2;!((0|c)<0);)if(l=l-c|0,t=((h=(p=0|he[u+4>>2])>>>0<c>>>0)<<31>>31)+t|0,p=c-(h?p:0)|0,he[(u=h?u+8|0:u)>>2]=(0|he[u>>2])+p,he[(h=u+4|0)>>2]=(0|he[h>>2])-p,he[a>>2]=he[i>>2],he[a+4>>2]=u,he[a+8>>2]=t,(0|l)==(0|(c=0|ze(0|R(146,0|a))))){d=3;break e}he[e+16>>2]=0,he[n>>2]=0,he[o>>2]=0,he[e>>2]=32|he[e>>2],r=2==(0|t)?0:r-(0|he[u+4>>2])|0}else d=3}while(0);return 3==(0|d)&&(p=0|he[e+44>>2],he[e+16>>2]=p+(0|he[e+48>>2]),he[n>>2]=p,he[o>>2]=p),me=s,0|r}function Q(e,t,r){e|=0,t|=0,r|=0;var i,n,o,a,s,l=0,u=0,c=0,d=0,h=0,p=0,f=0,m=0;for(me=(s=me)+224|0,i=s+120|0,a=(o=s)+136|0,u=(l=n=s+80|0)+40|0;(0|(l=l+4|(he[l>>2]=0)))<(0|u););return he[i>>2]=he[r>>2],r=(0|k(0,t,i,o,n))<0?-1:(m=-1<(0|he[e+76>>2])?0|ot(e):0,f=32&(r=0|he[e>>2]),(0|de[e+74>>0])<1&&(he[e>>2]=-33&r),0|he[(l=e+48|0)>>2]?r=0|k(e,t,i,o,n):(c=0|he[(u=e+44|0)>>2],he[u>>2]=a,he[(d=e+28|0)>>2]=a,he[(h=e+20|0)>>2]=a,he[l>>2]=80,he[(p=e+16|0)>>2]=a+80,r=0|k(e,t,i,o,n),c&&(lt[7&he[e+36>>2]](e,0,0),r=0==(0|he[h>>2])?-1:r,he[u>>2]=c,he[l>>2]=0,he[p>>2]=0,he[d>>2]=0,he[h>>2]=0)),l=0|he[e>>2],he[e>>2]=l|f,0|m&&nt(e),0==(32&l|0)?r:-1),me=s,0|r}function Z(e,t,r,i){t|=0,r|=0,i|=0;var n,o,a,s,l,u,c,d=0,h=0;for(me=(c=me)+64|0,l=c,h=0|he[(e|=0)>>2],u=e+(0|he[h+-8>>2])|0,h=0|he[h+-4>>2],he[l>>2]=r,he[l+4>>2]=e,he[l+8>>2]=t,he[l+12>>2]=i,t=l+20|0,i=l+24|0,n=l+28|0,o=l+32|0,a=l+40|0,s=(d=e=l+16|0)+36|0;(0|(d=d+4|(he[d>>2]=0)))<(0|s););q[e+36>>1]=0,de[e+38>>0]=0;e:do{if(0|je(h,r,0))he[l+48>>2]=1,ft[3&he[20+(0|he[h>>2])>>2]](h,l,u,u,1,0),e=1==(0|he[i>>2])?u:0;else{switch(ut[3&he[24+(0|he[h>>2])>>2]](h,l,u,1,0),0|he[l+36>>2]){case 0:e=1==(0|he[a>>2])&1==(0|he[n>>2])&1==(0|he[o>>2])?0|he[t>>2]:0;break e;case 1:break;default:e=0;break e}if(1!=(0|he[i>>2])&&!(0==(0|he[a>>2])&1==(0|he[n>>2])&1==(0|he[o>>2]))){e=0;break}e=0|he[e>>2]}}while(0);return me=c,0|e}function K(e){var t,r=0,i=0,n=0,o=0,a=0,s=0,l=0;if(me=(t=me)+544|0,s=t+16|0,o=(r=t)+32|0,8192<=((i=0|he[(a=(e|=0)+8|0)>>2])+-1|0)>>>0&&(he[r>>2]=866,he[r+4>>2]=3006,he[r+8>>2]=1257,Le(o,812,r),Ce(o)),he[e>>2]=i,l=(r=0|he[(n=e+20|0)>>2])?i:((r=0|ae(180,0))?(he[(l=r+164|0)>>2]=0,he[l+4>>2]=0,he[l+8>>2]=0,he[l+12>>2]=0):r=0,he[n>>2]=r,0|he[e>>2]),s=0|he[a>>2]?l:(he[s>>2]=866,he[s+4>>2]=910,he[s+8>>2]=1497,Le(o,812,s),Ce(o),0|he[e>>2]),o=0|he[e+4>>2],!(16<s>>>0))return e=(e=0)|F(r,l,o,e),me=t,0|e;for(i=s,n=0;a=n+1|0,3<i>>>0;)i>>>=1,n=a;return e=0|F(r,l,o,e=255&((e=n+2+(32!=(0|a)&1<<a>>>0<s>>>0&1)|0)>>>0<11?e:11)),me=t,0|e}function J(e){var t,r,i,n,o,a,s=0,l=0;me=(a=me)+576|0,n=a+48|0,o=a+32|0,r=a+16|0,i=(t=a)+64|0,s=0|he[(e|=0)+168>>2];do{if(0|s){if(l=0|he[s+-4>>2],s=s+-8|0,0!=(0|l)&&(0|l)==(0|~he[s>>2])||(he[t>>2]=866,he[t+4>>2]=651,he[t+8>>2]=1579,Le(i,812,t),Ce(i)),7&s){he[r>>2]=866,he[r+4>>2]=2506,he[r+8>>2]=1232,Le(i,812,r),Ce(i);break}ce(s,0,0,1,0);break}}while(0);if(s=0|he[e+176>>2])return l=0|he[s+-4>>2],s=s+-8|0,0!=(0|l)&&(0|l)==(0|~he[s>>2])||(he[o>>2]=866,he[o+4>>2]=651,he[o+8>>2]=1579,Le(i,812,o),Ce(i)),7&s?(he[n>>2]=866,he[n+4>>2]=2506,he[n+8>>2]=1232,Le(i,812,n),Ce(i)):ce(s,0,0,1,0),void(me=a);me=a}function $(e,t,r){var i;return 0!=(0|(e|=0))&73<(t|=0)>>>0&0!=(0|(r|=0))?40!=(0|he[r>>2])?(r=0)|r:18552!=((0|pe[e>>0])<<8|0|pe[e+1>>0]|0)?(r=0)|r:((0|pe[e+2>>0])<<8|0|pe[e+3>>0])>>>0<74?(r=0)|r:((0|pe[e+7>>0])<<16|(0|pe[e+6>>0])<<24|(0|pe[e+8>>0])<<8|0|pe[e+9>>0])>>>0>t>>>0?(r=0)|r:(he[r+4>>2]=(0|pe[e+12>>0])<<8|0|pe[e+13>>0],he[r+8>>2]=(0|pe[e+14>>0])<<8|0|pe[e+15>>0],he[r+12>>2]=pe[e+16>>0],he[r+16>>2]=pe[e+17>>0],t=e+18|0,he[(i=r+32|0)>>2]=pe[t>>0],t=(he[i+4>>2]=0)|de[t>>0],he[r+20>>2]=t<<24>>24==0|t<<24>>24==9?8:16,he[r+24>>2]=(0|pe[e+26>>0])<<16|(0|pe[e+25>>0])<<24|(0|pe[e+27>>0])<<8|0|pe[e+28>>0],he[r+28>>2]=(0|pe[e+30>>0])<<16|(0|pe[e+29>>0])<<24|(0|pe[e+31>>0])<<8|0|pe[e+32>>0],0|(r=1)):(r=0)|r}function ee(e,t){e|=0;var r,i,n,o=0,a=0,s=0,l=0,u=0;if(me=(n=me)+544|0,u=n+16|0,l=(o=n)+32|0,33<=(t|=0)>>>0&&(he[o>>2]=866,he[o+4>>2]=3199,he[o+8>>2]=1350,Le(l,812,o),Ce(l)),(0|t)<=(0|(o=0|he[(i=e+20|0)>>2])))return l=o,u=(a=0|he[(s=a=e+16|0)>>2])>>>(u=32-t|0),a<<=t,he[s>>2]=a,t=l-t|0,he[i>>2]=t,me=n,0|u;for(a=e+4|0,s=e+8|0,r=e+16|0;e=(0|(e=0|he[a>>2]))==(0|he[s>>2])?0:(he[a>>2]=e+1,0|pe[e>>0]),o=o+8|0,33<=(0|(he[i>>2]=o))&&(he[u>>2]=866,he[u+4>>2]=3208,he[u+8>>2]=1366,Le(l,812,u),Ce(l),o=0|he[i>>2]),e=e<<32-o|he[r>>2],he[r>>2]=e,(0|o)<(0|t););return u=e>>>(u=32-t|0),l=e<<t,he[r>>2]=l,t=o-t|0,he[i>>2]=t,me=n,0|u}function te(e,t,r){e|=0;var i=0,n=0,o=0,a=0;o=255&(t|=0),i=0!=(0|(r|=0));e:do{if(i&0!=(3&e|0))for(n=255&t;;){if((0|de[e>>0])==n<<24>>24){a=6;break e}if(!((i=0!=(0|(r=r+-1|0)))&0!=(3&(e=e+1|0)|0))){a=5;break}}else a=5}while(0);5==(0|a)&&(i?a=6:r=0);e:do{if(6==(0|a)&&(n=255&t,(0|de[e>>0])!=n<<24>>24)){i=0|ne(o,16843009);t:do{if(3<r>>>0){for(;!((-2139062144&(o=he[e>>2]^i)^-2139062144)&o+-16843009|0);)if(e=e+4|0,(r=r+-4|0)>>>0<=3){a=11;break t}}else a=11}while(0);if(11==(0|a)&&!r){r=0;break}for(;;){if((0|de[e>>0])==n<<24>>24)break e;if(e=e+1|0,!(r=r+-1|0)){r=0;break}}}}while(0);return 0|(0|r?e:0)}function re(e,t,r,i,n){t|=0,r|=0,i|=0,n|=0;var o,a,s,l=0,u=0,c=0;return me=(s=me)+528|0,u=(c=s)+16|0,o=0|he[(e|=0)+88>>2],me=(c=((a=(0|pe[o+70+(n<<2)+1>>0])<<16|(0|pe[o+70+(n<<2)>>0])<<24|(0|pe[o+70+(n<<2)+2>>0])<<8|0|pe[o+70+(n<<2)+3>>0])>>>0<(l=(l=n+1|0)>>>0<(0|pe[o+16>>0])>>>0?(0|pe[o+70+(l<<2)+1>>0])<<16|(0|pe[o+70+(l<<2)>>0])<<24|(0|pe[o+70+(l<<2)+2>>0])<<8|0|pe[o+70+(l<<2)+3>>0]:0|he[e+8>>2])>>>0||(he[c>>2]=866,he[c+4>>2]=3694,he[c+8>>2]=1508,Le(u,812,c),Ce(u)),0|j(e,u=(u=0|he[(u=e+4|0)>>2])+a|0,c=l-a|0,t,r,i,n)),s),0|c}function ie(e,t,r){e|=0,t|=0;var i=0,n=0,o=0,a=0,s=0;(n=0|he[(i=(r|=0)+16|0)>>2])?o=5:0|Se(r)?i=0:(n=0|he[i>>2],o=5);e:do{if(5==(0|o)){if((n-(i=a=0|he[(s=r+20|0)>>2])|0)>>>0<t>>>0){i=0|lt[7&he[r+36>>2]](r,e,t);break}t:do{if(-1<(0|de[r+75>>0])){for(a=t;;){if(!a){o=0,n=e;break t}if(10==(0|de[e+(n=a+-1|0)>>0]))break;a=n}if((i=0|lt[7&he[r+36>>2]](r,e,a))>>>0<a>>>0)break e;n=e+(o=a)|0,t=t-a|0,i=0|he[s>>2]}else o=0,n=e}while(0);Y(0|i,0|n,0|t),he[s>>2]=(0|he[s>>2])+t,i=o+t|0}}while(0);return 0|i}function oe(e){var t,r,i=0,n=0,o=0;me=(r=me)+544|0,o=r+16|0,t=(n=r)+32|0,i=0|he[(e|=0)+20>>2];do{if(0|i){if(J(i),7&i){he[n>>2]=866,he[n+4>>2]=2506,he[n+8>>2]=1232,Le(t,812,n),Ce(t);break}ce(i,0,0,1,0);break}}while(0);if(!(n=0|he[(i=e+4|0)>>2]))return de[(o=e+16|0)>>0]=0,void(me=r);7&n?(he[o>>2]=866,he[o+4>>2]=2506,he[o+8>>2]=1232,Le(t,812,o),Ce(t)):ce(n,0,0,1,0),he[i>>2]=0,he[e+8>>2]=0,he[e+12>>2]=0,de[(o=e+16|0)>>0]=0,me=r}function ae(e,t){t|=0;var r,i,n,o,a=0,s=0,l=0;return me=(o=me)+560|0,l=o+32|0,n=o+16|0,i=(a=o)+48|0,r=o+44|0,2147418112<(s=0|(s=(e|=0)+3&-4)?s:4)>>>0?(he[a>>2]=866,he[a+4>>2]=2506,he[a+8>>2]=1103,Le(i,812,a),Ce(i),me=o,(l=0)|l):(e=0|ce(0,he[r>>2]=s,r,1,0),a=0|he[r>>2],0|t&&(he[t>>2]=a),0==(0|e)|a>>>0<s>>>0?(he[n>>2]=866,he[n+4>>2]=2506,he[n+8>>2]=1129,Le(i,812,n),Ce(i),e=0):7&e&&(he[l>>2]=866,he[l+4>>2]=2533,he[l+8>>2]=1156,Le(i,812,l),Ce(i)),me=o,0|(l=e))}function se(e,t,r){t|=0;var i,n=0,o=0,a=0;if(i=(e|=0)+(r|=0)|0,t&=255,67<=(0|r)){for(;3&e;)de[e>>0]=t,e=e+1|0;for(o=(n=-4&i|0)-64|0,a=t|t<<8|t<<16|t<<24;(0|e)<=(0|o);)he[e>>2]=a,he[e+4>>2]=a,he[e+8>>2]=a,he[e+12>>2]=a,he[e+16>>2]=a,he[e+20>>2]=a,he[e+24>>2]=a,he[e+28>>2]=a,he[e+32>>2]=a,he[e+36>>2]=a,he[e+40>>2]=a,he[e+44>>2]=a,he[e+48>>2]=a,he[e+52>>2]=a,he[e+56>>2]=a,he[e+60>>2]=a,e=e+64|0;for(;(0|e)<(0|n);)he[e>>2]=a,e=e+4|0}for(;(0|e)<(0|i);)de[e>>0]=t,e=e+1|0;return i-r|0}function le(e,t,r,i,n){e|=0,r|=0,i|=0,n|=0;var o=0,a=0,s=0,l=0;de[(t|=0)+53>>0]=1;do{if((0|he[t+4>>2])==(0|i)){if(de[t+52>>0]=1,s=t+54|0,l=t+48|0,a=t+24|0,e=t+36|0,!(o=0|he[(i=t+16|0)>>2])){if(he[i>>2]=r,he[a>>2]=n,!((he[e>>2]=1)==(0|he[l>>2])&1==(0|n)))break;de[s>>0]=1;break}if((0|o)!=(0|r)){he[e>>2]=1+(0|he[e>>2]),de[s>>0]=1;break}2==(0|(e=0|he[a>>2]))&&(e=he[a>>2]=n),1==(0|he[l>>2])&1==(0|e)&&(de[s>>0]=1)}}while(0)}function ue(e,t){e|=0;var r,i,n,o=0,a=0,s=0,l=0;me=(n=me)+16|0,i=255&(t|=0),de[(r=n)>>0]=i,(s=0|he[(a=e+16|0)>>2])?l=4:0|Se(e)?o=-1:(s=0|he[a>>2],l=4);do{if(4==(0|l)){if((a=0|he[(l=e+20|0)>>2])>>>0<s>>>0&&(0|(o=255&t))!=(0|de[e+75>>0])){he[l>>2]=a+1,de[a>>0]=i;break}o=1==(0|lt[7&he[e+36>>2]](e,r,1))?0|pe[r>>0]:-1}}while(0);return me=n,0|o}function ce(e,t,r,i,n){e|=0,t|=0,r|=0,i|=0,n|=0;do{if(e){if(!t){if(B(e),!r){t=0;break}t=he[r>>2]=0;break}i?e=0==(0|(t=0|ye(e,t)))?e:t:t=0,r&&(n=0|Re(e),he[r>>2]=n)}else t=0|L(t),r&&(e=t?0|Re(t):0,he[r>>2]=e)}while(0);return 0|t}function _e(e,t){e|=0,t|=0;var r,i,n,o,a=0,s=0;for(s=0;;){if((0|pe[2140+s>>0])==(0|e)){e=2;break}if(87==(0|(a=s+1|0))){a=2228,s=87,e=5;break}s=a}if(2==(0|e)&&(s?(a=2228,e=5):a=2228),5==(0|e))for(;;){for(;a=(e=a)+1|0,0!=(0|de[e>>0]););if(!(s=s+-1|0))break;e=5}return 0|(r=a,i=0|he[t+20>>2],0|(n=r|=0,o=i|=0,n|=0,0|(0|(o=(o|=0)?0|function(e,t,r){t|=0,r|=0;var i,n=0,o=0,a=0,s=0,l=0,u=0,c=0,d=0,h=0;i=1794895138+(0|he[(e|=0)>>2])|0,a=0|Ye(0|he[e+8>>2],i),n=0|Ye(0|he[e+12>>2],i),o=0|Ye(0|he[e+16>>2],i);e:do{if(a>>>0<t>>>2>>>0&&(h=t-(a<<2)|0,n>>>0<h>>>0&o>>>0<h>>>0)&&0==(3&(o|n)|0)){for(h=n>>>2,d=o>>>2,c=0;;){if(n=0|Ye(0|he[e+((o=(s=(u=c+(l=a>>>1)|0)<<1)+h|0)<<2)>>2],i),!((o=0|Ye(0|he[e+(o+1<<2)>>2],i))>>>0<t>>>0&n>>>0<(t-o|0)>>>0)){n=0;break e}if(0|de[e+(o+n)>>0]){n=0;break e}if(!(n=0|Te(r,e+o|0)))break;if(n=(0|n)<0,1==(0|a)){n=0;break e}c=n?c:u,a=n?l:a-l|0}o=0|Ye(0|he[e+((n=s+d|0)<<2)>>2],i),n=(n=0|Ye(0|he[e+(n+1<<2)>>2],i))>>>0<t>>>0&o>>>0<(t-n|0)>>>0&&0==(0|de[e+(n+o)>>0])?e+n|0:0}else n=0}while(0);return 0|n}(0|he[o>>2],0|he[o+4>>2],n):0)?o:n)))}function ve(e,t,r){r|=0;var i=0;if(0<(t|=0)>>>0|0==(0|t)&4294967295<(e|=0)>>>0){for(;i=0|Ie(0|e,0|t,10,0),de[(r=r+-1|0)>>0]=255&i|48,e=0|Xe(0|(i=e),0|t,10,0),9<t>>>0|9==(0|t)&4294967295<i>>>0;)t=D;t=e}else t=e;if(t)for(;de[(r=r+-1|0)>>0]=48|(t>>>0)%10,!(t>>>0<10);)t=(t>>>0)/10|0;return 0|r}function ye(e,t){t|=0;var r=0,i=0;return(e|=0)?4294967231<t>>>0?(t=0|rt(),he[t>>2]=12,(t=0)|t):0|(r=0|function(e,t){t|=0;var r,i,n=0,o=0,a=0,s=0,l=0,u=0,c=0,d=0;if(r=(e|=0)+(n=-8&(c=0|he[(d=e+4|0)>>2]))|0,!(3&c))return t>>>0<256?(e=0)|e:(t+4|0)>>>0<=n>>>0&&(n-t|0)>>>0<=he[1264]<<1>>>0?0|e:(e=0)|e;if(t>>>0<=n>>>0)return(n=n-t|0)>>>0<=15||(u=e+t|0,he[d>>2]=1&c|t|2,he[u+4>>2]=3|n,he[(d=u+n+4|0)>>2]=1|he[d>>2],U(u,n)),0|e;if((0|r)==(0|he[1150]))return n=(u=(0|he[1147])+n|0)-t|0,o=e+t|0,u>>>0<=t>>>0?(e=0)|e:(he[d>>2]=1&c|t|2,he[o+4>>2]=1|n,he[1150]=o,he[1147]=n,0|e);if((0|r)==(0|he[1149]))return(a=(0|he[1146])+n|0)>>>0<t>>>0?(e=0)|e:(o=1&c,15<(n=a-t|0)>>>0?(u=(c=e+t|0)+n|0,he[d>>2]=o|t|2,he[c+4>>2]=1|n,he[u>>2]=n,he[(o=u+4|0)>>2]=-2&he[o>>2],o=c):(he[d>>2]=o|a|2,he[(o=e+a+4|0)>>2]=1|he[o>>2],n=o=0),he[1146]=n,he[1149]=o,0|e);if(2&(o=0|he[r+4>>2])|0)return(e=0)|e;if((i=(-8&o)+n|0)>>>0<t>>>0)return(e=0)|e;u=i-t|0,a=o>>>3;do{if(o>>>0<256){if(o=0|he[r+8>>2],(0|(n=0|he[r+12>>2]))==(0|o)){he[1144]=he[1144]&~(1<<a);break}he[o+12>>2]=n,he[n+8>>2]=o;break}l=0|he[r+24>>2],n=0|he[r+12>>2];do{if((0|n)==(0|r)){if(n=0|he[(o=4+(a=r+16|0)|0)>>2])s=o;else{if(!(n=0|he[a>>2])){a=0;break}s=a}for(;;)if(0|(o=0|he[(a=n+20|0)>>2]))n=o,s=a;else{if(!(a=0|he[(o=n+16|0)>>2]))break;n=a,s=o}he[s>>2]=0,a=n}else a=0|he[r+8>>2],he[a+12>>2]=n,he[n+8>>2]=a,a=n}while(0);if(0|l){if(n=0|he[r+28>>2],(0|r)==(0|he[(o=4880+(n<<2)|0)>>2])){if(!(he[o>>2]=a)){he[1145]=he[1145]&~(1<<n);break}}else if(!(he[l+16+(((0|he[l+16>>2])!=(0|r)&1)<<2)>>2]=a))break;he[a+24>>2]=l,0|(o=0|he[(n=r+16|0)>>2])&&(he[a+16>>2]=o,he[o+24>>2]=a),0|(n=0|he[n+4>>2])&&(he[a+20>>2]=n,he[n+24>>2]=a)}}while(0);return n=1&c,u>>>0<16?(he[d>>2]=i|n|2,he[(d=e+i+4|0)>>2]=1|he[d>>2]):(c=e+t|0,he[d>>2]=n|t|2,he[c+4>>2]=3|u,he[(d=c+u+4|0)>>2]=1|he[d>>2],U(c,u)),0|e}(e+-8|0,t>>>0<11?16:t+11&-8))?0|(t=r+8|0):(r=0|L(t))?(Y(0|r,0|e,0|((i=(-8&(i=0|he[e+-4>>2]))-(0==(3&i|0)?8:4)|0)>>>0<t>>>0?i:t)),B(e),0|(t=r)):(t=0)|t:0|(t=0|L(t))}function be(e,t,r,i){e|=0,r|=0,i|=0;var n,o,a;n=0|he[(e=(t|=0)+16|0)>>2],o=t+36|0,a=t+24|0;do{if(n){if((0|n)!=(0|r)){he[o>>2]=1+(0|he[o>>2]),he[a>>2]=2,de[t+54>>0]=1;break}2==(0|he[a>>2])&&(he[a>>2]=i)}else he[e>>2]=r,he[a>>2]=i,he[o>>2]=1}while(0)}function Ce(e){e|=0;var t,r=0,i=0,n=0;t=0|he[119],n=-1<(0|he[t+76>>2])?0|ot(t):0;do{if((0|qe(e,t))<0)e=1;else{if(10!=(0|de[t+75>>0])&&(i=0|he[(r=t+20|0)>>2])>>>0<(0|he[t+16>>2])>>>0){he[r>>2]=i+1,de[i>>0]=10,e=0;break}e=(0|ue(t,10))<0}}while(0);return 0|n&&nt(t),e<<31>>31|0}function we(e,t,r,i,n){e|=0,t|=0;var o,a;if(me=(a=me)+256|0,o=a,(0|(i|=0))<(0|(r|=0))&0==(73728&(n|=0)|0)){if(se(0|o,0|t,0|((n=r-i|0)>>>0<256?n:256)),255<n>>>0){for(t=r-i|0;Ge(e,o,256),255<(n=n+-256|0)>>>0;);n=255&t}Ge(e,o,n)}me=a}function Se(e){var t=0,r=0;return r=0|de[(t=(e|=0)+74|0)>>0],de[t>>0]=r+255|r,0|(e=8&(t=0|he[e>>2])?(he[e>>2]=32|t,-1):(he[e+8>>2]=0,r=(he[e+4>>2]=0)|he[e+44>>2],he[e+28>>2]=r,he[e+20>>2]=r,he[e+16>>2]=r+(0|he[e+48>>2]),0))}function Te(e,t){t|=0;var r=0,i=0;if(r=0|de[(e|=0)>>0],i=0|de[t>>0],r<<24>>24==0||r<<24>>24!=i<<24>>24)e=i;else{for(;t=t+1|0,r=0|de[(e=e+1|0)>>0],i=0|de[t>>0],r<<24>>24!=0&&r<<24>>24==i<<24>>24;);e=i}return(255&r)-(255&e)|0}function Ee(e){var t,r;return 0<(0|(r=(e|=0)+15&-16|0))&(0|(e=(t=0|he[h>>2])+r|0))<(0|t)|(0|e)<0?(b(),E(12),-1):(0|(he[h>>2]=e))>(0|y())&&0==(0|v())?(he[h>>2]=t,E(12),-1):0|t}function Ae(e){var t=0,r=0,i=0;if(r=0|he[(e|=0)>>2],(i=(0|de[r>>0])-48|0)>>>0<10)for(t=0;t=i+(10*t|0)|0,r=r+1|0,he[e>>2]=r,(i=(0|de[r>>0])-48|0)>>>0<10;);else t=0;return 0|t}function xe(e,t,r,i){if(r|=0,i|=0,!(0==(0|(e|=0))&0==(0|(t|=0))))for(;de[(r=r+-1|0)>>0]=0|pe[2122+(15&e)>>0]|i,!(0==(0|(e=0|ke(0|e,0|t,4)))&0==(0|(t=D))););return 0|r}function Pe(e){var t=0;return(0|(t=0|de[f+(255&(e|=0))>>0]))<8?0|t:(0|(t=0|de[f+(e>>8&255)>>0]))<8?t+8|0:(0|(t=0|de[f+(e>>16&255)>>0]))<8?t+16|0:24+(0|de[f+(e>>>24)>>0])|0}function De(e,t,r,i){r|=0,i|=0;var n=0;(0|he[(t|=0)+4>>2])==(0|r)&&1!=(0|he[(n=t+28|0)>>2])&&(he[n>>2]=i)}function Oe(e,t,r){if(r|=0,!(0==(0|(e|=0))&0==(0|(t|=0))))for(;de[(r=r+-1|0)>>0]=7&e|48,!(0==(0|(e=0|ke(0|e,0|t,3)))&0==(0|(t=D))););return 0|r}function Ie(e,t,r,i){var n,o;return me=(o=me)+16|0,V(e|=0,t|=0,r|=0,i|=0,n=0|o),me=o,0|(D=0|he[n+4>>2],0|he[n>>2])}function Me(){var e,t=0;return me=(e=me)+16|0,0|x(5136,2)?(Fe(4307,e),0):(t=0|C(0|he[1285]),me=e,0|t)}function Re(e){var t=0;return(e|=0)?0|(1==(0|(e=3&(t=0|he[e+-4>>2])))?0:(-8&t)-(0==(0|e)?8:4)|0):0}function Le(e,t,r){e|=0,t|=0,r|=0;var i,n,o,a,s;return me=(i=me)+16|0,he[(n=i)>>2]=r,r=0|(o=e,a=t,s=n,0|function(e,t,r,i){e|=0,t|=0,r|=0,i|=0;var n,o,a=0,s=0,l=0,u=0,c=0;for(me=(o=me)+128|0,a=o+124|0,l=604,n=(s=c=o)+124|0;he[s>>2]=he[l>>2],l=l+4|0,(0|(s=s+4|0))<(0|n););return 2147483646<(t+-1|0)>>>0?t?(t=0|rt(),he[t>>2]=75,t=-1):(e=a,t=1,u=4):u=4,4==(0|u)&&(u=(u=-2-e|0)>>>0<t>>>0?u:t,he[c+48>>2]=u,he[(a=c+20|0)>>2]=e,t=(he[c+44>>2]=e)+u|0,he[(e=c+16|0)>>2]=t,he[c+28>>2]=t,t=0|Q(c,r,i),u&&(c=0|he[a>>2],de[c+(((0|c)==(0|he[e>>2]))<<31>>31)>>0]=0)),me=o,0|t}(o|=0,2147483647,a|=0,s|=0)),me=i,0|r}function Ne(e,t,r){return e|=0,t|=0,(0|(r|=0))<32?(D=t<<r|(e&(1<<r)-1<<32-r)>>>32-r,e<<r):(D=e<<r-32,0)}function ke(e,t,r){return e|=0,t|=0,(0|(r|=0))<32?(D=t>>>r,e>>>r|(t&(1<<r)-1)<<32-r):t>>>r-32|(D=0)}function Fe(e,t){e|=0,t|=0;var r;me=(r=me)+16|0,he[r>>2]=t,Q(t=0|he[26],e,r),function(e,t){var r,i=0,n=0,o=0,a=0,s=0,l=0;i=r=255&(e|=0),0<=(0|he[76+(t|=0)>>2])&&0!=(0|ot(t))?((0|i)!=(0|de[t+75>>0])&&(s=0|he[(a=t+20|0)>>2])>>>0<(0|he[t+16>>2])>>>0?(he[a>>2]=s+1,de[s>>0]=r):i=0|ue(t,e),nt(t)):l=3;do{if(3==(0|l)){if((0|i)!=(0|de[t+75>>0])&&(o=0|he[(n=t+20|0)>>2])>>>0<(0|he[t+16>>2])>>>0){he[n>>2]=o+1,de[o>>0]=r;break}i=0|ue(t,e)}}while(0)}(10,t),A()}function Be(e,t,r,i){return 0|(D=i=(t|=0)-(i|=0)-((e|=0)>>>0<(r|=0)>>>0|0)>>>0,e-r>>>0|0)}function Ue(e){e=+e;var t;return P[p>>3]=e,t=0|he[p>>2],D=0|he[p+4>>2],0|t}function Ve(e,t,r,i){return 0|(D=(t|=0)+(i|=0)+((r=(e|=0)+(r|=0)>>>0)>>>0<e>>>0|0)>>>0,0|r)}function ze(e){var t=0;return 4294963200<(e|=0)>>>0&&(t=0|rt(),he[t>>2]=0-e,e=-1),0|e}function qe(e,t){t|=0;var r;return((0|function(e,t,r,i){e|=0,i|=0;var n,o=0;return n=0|ne(r|=0,t|=0),r=0==(0|t)?0:r,-1<(0|he[i+76>>2])?(o=0==(0|ot(i)),e=0|ie(e,n,i),o||nt(i)):e=0|ie(e,n,i),(0|e)!=(0|n)&&(r=(e>>>0)/(t>>>0)|0),0|r}(e|=0,1,r=0|function(e){var t,r=0,i=0;t=e|=0;e:do{if(3&t)for(r=t;;){if(!(0|de[e>>0])){e=r;break e}if(!(3&(r=e=e+1|0))){i=4;break}}else i=4}while(0);if(4==(0|i)){for(;!((-2139062144&(r=0|he[e>>2])^-2139062144)&r+-16843009);)e=e+4|0;if((255&r)<<24>>24)for(;0!=(0|de[(e=e+1|0)>>0]););}return e-t|0}(e),t))!=(0|r))<<31>>31|0}function Ge(e,t,r){t|=0,r|=0,32&he[(e|=0)>>2]||ie(t,r,e)}function We(e){e|=0;var t;return t=188+(0|it())|0,0|_e(e,0|he[t>>2])}function He(e,t){return t|=0,0|(e=(e|=0)?0|function(e,t,r){e|=0,t|=0,r|=0;do{if(e){if(t>>>0<128){de[e>>0]=t,e=1;break}if(r=188+(0|it())|0,!(0|he[he[r>>2]>>2])){if(57216==(-128&t|0)){de[e>>0]=t,e=1;break}e=0|rt(),he[e>>2]=84,e=-1;break}if(t>>>0<2048){de[e>>0]=t>>>6|192,de[e+1>>0]=63&t|128,e=2;break}if(t>>>0<55296|57344==(-8192&t|0)){de[e>>0]=t>>>12|224,de[e+1>>0]=t>>>6&63|128,de[e+2>>0]=63&t|128,e=3;break}if((t+-65536|0)>>>0<1048576){de[e>>0]=t>>>18|240,de[e+1>>0]=t>>>12&63|128,de[e+2>>0]=t>>>6&63|128,de[e+3>>0]=63&t|128,e=4;break}e=0|rt(),he[e>>2]=84,e=-1;break}e=1}while(0);return 0|e}(e,t,0):0)}function je(e,t,r){return 0,(0|(e|=0))==(0|(t|=0))|0}function Ye(e,t){t|=0;var r;return r=0|Qe(0|(e|=0)),0|(0==(0|t)?e:r)}function Xe(e,t,r,i){return 0|V(e|=0,t|=0,r|=0,i|=0,0)}function Qe(e){return(255&(e|=0))<<24|(e>>8&255)<<16|(e>>16&255)<<8|e>>>24|0}function Ze(e,t,r,i,n,o){_(6)}function Ke(e,t,r,i,n){_(1)}function Je(e){var t;nt(e|=0),t=e,B(t|=0)}function $e(e,t,r,i){_(7)}function et(e,t,r){return 0,0,0,_(0),0}function tt(e,t){return+ +function e(t,r){t=+t,r|=0;var i,n,o=0;switch(P[p>>3]=t,2047&(n=0|ke(0|(o=0|he[p>>2]),0|(i=0|he[p+4>>2]),52))){case 0:o=0!=t?(t=+e(0x10000000000000000*t,r),(0|he[r>>2])-64|0):0,he[r>>2]=o;break;case 2047:break;default:he[r>>2]=(2047&n)-1022,he[p>>2]=o,he[p+4>>2]=-2146435073&i|1071644672,t=+P[p>>3]}return+t}(e=+e,t|=0)}function rt(){return 64+(0|it())|0}function it(){return 232}function nt(e){0}function ot(e){return 0,0}function at(e){_(2)}function st(){_(5)}var lt=[et,X,function(e,t,r){var i,n,o;return e|=0,t|=0,r|=0,me=(n=me)+32|0,i=(o=n)+20|0,he[o>>2]=he[e+60>>2],he[o+4>>2]=0,he[o+8>>2]=t,he[o+12>>2]=i,he[o+16>>2]=r,e=(0|ze(0|M(140,0|o)))<0?he[i>>2]=-1:0|he[i>>2],me=n,0|e},function(e,t,r){t|=0,r|=0;var i,n=0;return me=(i=me)+32|0,n=i,he[36+(e|=0)>>2]=1,0==(64&he[e>>2]|0)&&(he[n>>2]=he[e+60>>2],he[n+4>>2]=21523,he[n+8>>2]=i+16,0|w(54,0|n))&&(de[e+75>>0]=-1),n=0|X(e,t,r),me=i,0|n},function(e,t,r){var i,n;return t|=0,r|=0,Y(0|(n=0|he[(i=20+(e|=0)|0)>>2]),0|t,0|(e=r>>>0<(e=(0|he[e+16>>2])-n|0)>>>0?r:e)),he[i>>2]=(0|he[i>>2])+e,0|r},function(e,t,r){r|=0;var i,n,o=0,a=0;if(me=(n=me)+64|0,i=n,0|je(e|=0,t|=0))t=1;else if(0!=(0|t)&&0!=(0|(a=0|Z(t,32,16,0)))){for(o=52+(t=i+4|0)|0;(0|(t=t+4|(he[t>>2]=0)))<(0|o););he[i>>2]=a,he[i+8>>2]=e,he[i+12>>2]=-1,he[i+48>>2]=1,mt[3&he[28+(0|he[a>>2])>>2]](a,i,0|he[r>>2],1),t=1==(0|he[i+24>>2])?(he[r>>2]=he[i+16>>2],1):0}else t=0;return me=n,0|t},et,et],ut=[Ke,function(e,t,r,i,n){e|=0,t|=0,r|=0,i|=0,0;var o=0;do{if(0|je(e,0|he[t+8>>2]))De(0,t,r,i);else if(0|je(e,0|he[t>>2])){if(e=t+32|0,(0|he[t+16>>2])!=(0|r)&&(0|he[(o=t+20|0)>>2])!=(0|r)){he[e>>2]=i,he[o>>2]=r,he[(i=t+40|0)>>2]=1+(0|he[i>>2]),1==(0|he[t+36>>2])&&2==(0|he[t+24>>2])&&(de[t+54>>0]=1),he[t+44>>2]=4;break}1==(0|i)&&(he[e>>2]=1)}}while(0)},function(e,t,r,i,n){e|=0,t|=0,r|=0,i|=0,n|=0;var o=0,a=0,s=0,l=0;do{if(0|je(e,0|he[t+8>>2]))De(0,t,r,i);else{if(o=e+8|0,!(0|je(e,0|he[t>>2]))){s=0|he[o>>2],ut[3&he[24+(0|he[s>>2])>>2]](s,t,r,i,n);break}if(e=t+32|0,(0|he[t+16>>2])!=(0|r)&&(0|he[(a=t+20|0)>>2])!=(0|r)){if(he[e>>2]=i,4==(0|he[(i=t+44|0)>>2]))break;de[(e=t+52|0)>>0]=0,o=(de[(l=t+53|0)>>0]=0)|he[o>>2],ft[3&he[20+(0|he[o>>2])>>2]](o,t,r,r,1,n),0|de[l>>0]?0|de[e>>0]?e=3:(e=3,s=11):(e=4,s=11),11==(0|s)&&(he[a>>2]=r,he[(l=t+40|0)>>2]=1+(0|he[l>>2]),1==(0|he[t+36>>2])&&2==(0|he[t+24>>2])&&(de[t+54>>0]=1)),he[i>>2]=e;break}1==(0|i)&&(he[e>>2]=1)}}while(0)},Ke],ct=[at,nt,Je,nt,nt,Je,function(e){var t;me=(t=me)+16|0,B(e|=0),0|S(0|he[1285],0)?Fe(4406,t):me=t},at],dt=[function(e){return _(3),0},function(e){var t,r,i;return me=(t=me)+16|0,r=t,e=0|(i=0|he[60+(e|=0)>>2],0|(i|=0)),he[r>>2]=e,e=0|ze(0|T(6,0|r)),me=t,0|e}],ht=[function(e,t,r){_(4)}],pt=[st,function(){var e,t,r,i=0,n=0,o=0,a=0,s=0;me=(a=me)+48|0,r=a+32|0,e=a+24|0,s=a+16|0,a=(t=a)+36|0,0|(i=0|Me())&&0|(o=0|he[i>>2])&&(1126902528==(-256&(n=0|he[(i=o+48|0)>>2])|0)&1129074247==(0|(i=0|he[i+4>>2]))||(he[e>>2]=4168,Fe(4118,e)),i=1126902529==(0|n)&1129074247==(0|i)?0|he[o+44>>2]:o+80|0,he[a>>2]=i,o=0|he[o>>2],i=0|he[o+4>>2],0|lt[7&he[16+(0|he[2])>>2]](8,o,a)?(s=0|he[a>>2],s=0|dt[1&he[8+(0|he[s>>2])>>2]](s),he[t>>2]=4168,he[t+4>>2]=i,he[t+8>>2]=s,Fe(4032,t)):(he[s>>2]=4168,he[s+4>>2]=i,Fe(4077,s))),Fe(4156,r)},function(){var e;me=(e=me)+16|0,0|I(5140,6)?Fe(4356,e):me=e},st],ft=[Ze,function(e,t,r,i,n,o){r|=0,i|=0,n|=0,0,0|je(e|=0,0|he[8+(t|=0)>>2])&&le(0,t,r,i,n)},function(e,t,r,i,n,o){r|=0,i|=0,n|=0,o|=0,0|je(e|=0,0|he[8+(t|=0)>>2])?le(0,t,r,i,n):(e=0|he[e+8>>2],ft[3&he[20+(0|he[e>>2])>>2]](e,t,r,i,n,o))},Ze],mt=[$e,function(e,t,r,i){r|=0,i|=0,0|je(e|=0,0|he[8+(t|=0)>>2])&&be(0,t,r,i)},function(e,t,r,i){r|=0,i|=0,0|je(e|=0,0|he[8+(t|=0)>>2])?be(0,t,r,i):(e=0|he[e+8>>2],mt[3&he[28+(0|he[e>>2])>>2]](e,t,r,i))},$e];return{stackSave:function(){return 0|me},_i64Subtract:Be,_crn_get_bytes_per_block:function(e,t){e|=0,t|=0;var r,i,n,o=0;switch(me=(n=me)+576|0,i=n+40|0,r=n+56|0,he[(o=n)>>2]=40,$(e,t,o),e=0|he[4+(t=o+32|0)>>2],0|he[t>>2]){case 0:if(!e)return me=n,0|(o=8);e=14;break;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:e=e?14:13;break;case 9:case 10:if(!e)return me=n,0|(o=8);e=14;break;default:e=14}return 13==(0|e)?(me=n,0|(o=16)):14==(0|e)?(he[i>>2]=866,he[i+4>>2]=2672,he[i+8>>2]=1251,Le(r,812,i),Ce(r),me=n,(o=0)|o):0},setThrew:function(e,t){e|=0,t|=0,m||(m=e,t)},dynCall_viii:function(e,t,r,i){t|=0,r|=0,i|=0,ht[0&(e|=0)](0|t,0|r,0|i)},_bitshift64Lshr:ke,_bitshift64Shl:Ne,dynCall_viiii:function(e,t,r,i,n){t|=0,r|=0,i|=0,n|=0,mt[3&(e|=0)](0|t,0|r,0|i,0|n)},setTempRet0:function(e){D=e|=0},_crn_decompress:function(e,t,r,i,n,o){e|=0,t|=0,r|=0,i|=0,n|=0,o|=0;var a,s,l,u,c=0,d=0,h=0,p=0,f=0;switch(me=(u=me)+592|0,l=u+56|0,h=u+40|0,a=u+72|0,s=(f=u)+68|0,he[f>>2]=40,$(e,t,f),c=(0|he[f+4>>2])>>>n,d=(0|he[f+8>>2])>>>n,i=0|he[4+(f=f+32|0)>>2],0|he[f>>2]){case 0:i?p=14:f=8;break;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:p=i?14:13;break;case 9:case 10:i?p=14:f=8;break;default:p=14}13==(0|p)?f=16:14==(0|p)&&(he[h>>2]=866,he[h+4>>2]=2672,he[h+8>>2]=1251,Le(a,812,h),Ce(a),f=0),he[s>>2]=r,p=0|function(e,t){var r=0,i=0,n=0,o=0,a=0,s=0,l=0,u=0,c=0,d=0,h=0,p=0;if(me=(h=me)+528|0,s=(c=h)+16|0,0==(0|(e|=0))|(t|=0)>>>0<62)return me=h,(p=0)|p;if(!(l=0|ae(300,0)))return me=h,(p=0)|p;for(he[l>>2]=519686845,he[l+4>>2]=0,he[l+8>>2]=0,u=l+88|0,r=l+136|0,i=l+160|0,n=l+184|0,o=l+208|0,a=l+232|0,he[(d=l+252|0)>>2]=0,he[d+4>>2]=0,he[d+8>>2]=0,de[d+12>>0]=0,he[(d=l+268|0)>>2]=0,he[d+4>>2]=0,he[d+8>>2]=0,de[d+12>>0]=0,he[(d=l+284|0)>>2]=0,he[d+4>>2]=0,he[d+8>>2]=0,de[d+12>>0]=0,p=(d=u)+44|0;((he[d>>2]=0)|(d=d+4|0))<(0|p););return de[u+44>>0]=0,he[r>>2]=0,he[r+4>>2]=0,he[r+8>>2]=0,he[r+12>>2]=0,he[r+16>>2]=0,de[r+20>>0]=0,he[i>>2]=0,he[i+4>>2]=0,he[i+8>>2]=0,he[i+12>>2]=0,he[i+16>>2]=0,de[i+20>>0]=0,he[n>>2]=0,he[n+4>>2]=0,he[n+8>>2]=0,he[n+12>>2]=0,he[n+16>>2]=0,de[n+20>>0]=0,he[o>>2]=0,he[o+4>>2]=0,he[o+8>>2]=0,he[o+12>>2]=0,he[o+16>>2]=0,de[o+20>>0]=0,he[a>>2]=0,he[a+4>>2]=0,he[a+8>>2]=0,he[a+12>>2]=0,(de[a+16>>0]=0)|function(e,t,r){e|=0;var i=0,n=0;if(!(0==(0|(t|=0))|(r|=0)>>>0<74||18552!=((0|pe[t>>0])<<8|0|pe[t+1>>0]|0))&&74<=((0|pe[t+2>>0])<<8|0|pe[t+3>>0])>>>0&&((0|pe[t+7>>0])<<16|(0|pe[t+6>>0])<<24|(0|pe[t+8>>0])<<8|0|pe[t+9>>0])>>>0<=r>>>0){if(he[(i=e+88|0)>>2]=t,he[e+4>>2]=t,he[e+8>>2]=r,!(0|function(e){var t=0,r=0,i=0,n=0;if(n=92+(e|=0)|0,r=0|he[(i=e+88|0)>>2],t=(0|he[e+4>>2])+((0|pe[r+68>>0])<<8|(0|pe[r+67>>0])<<16|0|pe[r+69>>0])|0,!(r=(0|pe[r+65>>0])<<8|0|pe[r+66>>0]))return(n=0)|n;if(he[n>>2]=t,he[e+96>>2]=t,he[e+104>>2]=r,he[e+100>>2]=t+r,he[e+108>>2]=0,!((he[e+112>>2]=0)|G(n,e+116|0)))return(n=0)|n;t=0|he[i>>2];do{if((0|pe[t+39>>0])<<8|0|pe[t+40>>0]){if(!(0|G(n,e+140|0)))return(n=0)|n;if(0|G(n,e+188|0)){t=0|he[i>>2];break}return(n=0)|n}if(!((0|pe[t+55>>0])<<8|0|pe[t+56>>0]))return(n=0)|n}while(0);if((0|pe[t+55>>0])<<8|0|pe[t+56>>0]|0){if(!(0|G(n,e+164|0)))return(n=0)|n;if(!(0|G(n,e+212|0)))return(n=0)|n}return 0|(n=1)}(e)))return(n=0)|n;if(t=0|he[i>>2],(0|pe[t+39>>0])<<8|0|pe[t+40>>0]?0|function(e){var t=0,r=0,i=0,n=0,o=0,a=0,s=0,l=0,u=0,c=0,d=0,h=0,p=0;if(me=(p=me)+576|0,n=(a=p)+64|0,h=p+16|0,t=0|he[(i=88+(e|=0)|0)>>2],d=(0|pe[t+39>>0])<<8|0|pe[t+40>>0],u=e+236|0,(0|(r=0|he[(o=e+240|0)>>2]))!=(0|d)){if(r>>>0<=d>>>0){do{if((0|he[e+244>>2])>>>0<d>>>0){if(0|H(u,d,(r+1|0)==(0|d),4,0)){t=0|he[o>>2];break}return de[e+248>>0]=1,me=p,(h=0)|h}t=r}while(0);se((0|he[u>>2])+(t<<2)|0,0,d-t<<2|0),t=0|he[i>>2]}he[o>>2]=d}if(c=e+92|0,r=(0|he[e+4>>2])+((0|pe[t+34>>0])<<8|(0|pe[t+33>>0])<<16|0|pe[t+35>>0])|0,!(t=(0|pe[t+37>>0])<<8|(0|pe[t+36>>0])<<16|0|pe[t+38>>0]))return me=p,(h=0)|h;if(he[c>>2]=r,he[e+96>>2]=r,he[e+104>>2]=t,he[e+100>>2]=r+t,he[e+108>>2]=0,he[e+112>>2]=0,s=h+20|0,he[h>>2]=0,he[h+4>>2]=0,he[h+8>>2]=0,he[h+12>>2]=0,de[h+16>>0]=0,l=h+24|0,he[h+44>>2]=0,he[s>>2]=0,he[s+4>>2]=0,he[s+8>>2]=0,he[s+12>>2]=0,he[s+16>>2]=0,(de[s+20>>0]=0)|G(c,h)&&0|G(c,l))if(0|he[o>>2]||(he[a>>2]=866,he[a+4>>2]=910,he[a+8>>2]=1497,Le(n,812,a),Ce(n)),d)for(r=(s=a=0)|he[u>>2],o=n=t=e=i=0;;){if(a=(0|ge(c,h))+a&31,o=(0|ge(c,l))+o&63,n=(0|ge(c,h))+n&31,t=(0|ge(c,h))+t|0,e=(0|ge(c,l))+e&63,i=(0|ge(c,h))+i&31,he[r>>2]=o<<5|a<<11|n|t<<27|e<<21|i<<16,d>>>0<=(s=s+1|0)>>>0){t=1;break}r=r+4|0,t&=31}else t=1;else t=0;return oe(h+24|0),oe(h),me=p,0|(h=t)}(e)&&0|function(e){var t,r,i,n,o,a,s=0,l=0,u=0,c=0,d=0,h=0,p=0,f=0,m=0,g=0,_=0,v=0,y=0,b=0,C=0,w=0,S=0,T=0,E=0,A=0,x=0,P=0,D=0,O=0,I=0,M=0,R=0,L=0,N=0,k=0,F=0,B=0,U=0;if(me=(a=me)+1008|0,d=(h=a)+496|0,E=a+472|0,i=a+276|0,n=a+80|0,o=a+16|0,l=0|he[88+(e|=0)>>2],t=(0|pe[l+47>>0])<<8|0|pe[l+48>>0],r=e+92|0,s=(0|he[e+4>>2])+((0|pe[l+42>>0])<<8|(0|pe[l+41>>0])<<16|0|pe[l+43>>0])|0,!(l=(0|pe[l+45>>0])<<8|(0|pe[l+44>>0])<<16|0|pe[l+46>>0]))return me=a,(E=0)|E;if(he[r>>2]=s,he[e+96>>2]=s,he[e+104>>2]=l,he[e+100>>2]=s+l,he[e+108>>2]=0,he[e+112>>2]=0,he[E+20>>2]=0,he[E>>2]=0,he[E+4>>2]=0,he[E+8>>2]=0,he[E+12>>2]=0,(de[E+16>>0]=0)|G(r,E)){for(s=0,u=l=-3;he[i+(s<<2)>>2]=u,he[n+(s<<2)>>2]=l,c=2<(0|u),49!=(0|(s=s+1|0));)l=(1&c)+l|0,u=c?-3:u+1|0;for(l=(s=o)+64|0;(0|(s=s+4|(he[s>>2]=0)))<(0|l););u=e+252|0,s=0|he[(l=e+256|0)>>2];e:do{if((0|s)==(0|t))p=13;else{if(s>>>0<=t>>>0){do{if((0|he[e+260>>2])>>>0<t>>>0){if(0|H(u,t,(s+1|0)==(0|t),4,0)){s=0|he[l>>2];break}de[e+264>>0]=1,s=0;break e}}while(0);se((0|he[u>>2])+(s<<2)|0,0,t-s<<2|0)}he[l>>2]=t,p=13}}while(0);do{if(13==(0|p)){if(!t){he[h>>2]=866,he[h+4>>2]=910,he[h+8>>2]=1497,Le(d,812,h),Ce(d),s=1;break}for(e=o+4|0,d=o+8|0,h=o+12|0,p=o+16|0,f=o+20|0,m=o+24|0,g=o+28|0,_=o+32|0,v=o+36|0,y=o+40|0,b=o+44|0,C=o+48|0,w=o+52|0,S=o+56|0,T=o+60|0,s=(c=0)|he[u>>2],l=0|he[e>>2],u=0|he[o>>2];B=0|ge(r,E),u=u+(0|he[i+(B<<2)>>2])&3,l=l+(0|he[n+(B<<2)>>2])&3,B=0|ge(r,E),U=(0|he[d>>2])+(0|he[i+(B<<2)>>2])&3,he[d>>2]=U,B=(0|he[h>>2])+(0|he[n+(B<<2)>>2])&3,he[h>>2]=B,k=0|ge(r,E),F=(0|he[p>>2])+(0|he[i+(k<<2)>>2])&3,he[p>>2]=F,k=(0|he[f>>2])+(0|he[n+(k<<2)>>2])&3,he[f>>2]=k,L=0|ge(r,E),N=(0|he[m>>2])+(0|he[i+(L<<2)>>2])&3,he[m>>2]=N,L=(0|he[g>>2])+(0|he[n+(L<<2)>>2])&3,he[g>>2]=L,M=0|ge(r,E),R=(0|he[_>>2])+(0|he[i+(M<<2)>>2])&3,he[_>>2]=R,M=(0|he[v>>2])+(0|he[n+(M<<2)>>2])&3,he[v>>2]=M,O=0|ge(r,E),I=(0|he[y>>2])+(0|he[i+(O<<2)>>2])&3,he[y>>2]=I,O=(0|he[b>>2])+(0|he[n+(O<<2)>>2])&3,he[b>>2]=O,P=0|ge(r,E),D=(0|he[C>>2])+(0|he[i+(P<<2)>>2])&3,he[C>>2]=D,P=(0|he[w>>2])+(0|he[n+(P<<2)>>2])&3,he[w>>2]=P,A=0|ge(r,E),x=(0|he[S>>2])+(0|he[i+(A<<2)>>2])&3,he[S>>2]=x,A=(0|he[T>>2])+(0|he[n+(A<<2)>>2])&3,he[T>>2]=A,he[s>>2]=(0|pe[1441+l>>0])<<2|0|pe[1441+u>>0]|(0|pe[1441+U>>0])<<4|(0|pe[1441+B>>0])<<6|(0|pe[1441+F>>0])<<8|(0|pe[1441+k>>0])<<10|(0|pe[1441+N>>0])<<12|(0|pe[1441+L>>0])<<14|(0|pe[1441+R>>0])<<16|(0|pe[1441+M>>0])<<18|(0|pe[1441+I>>0])<<20|(0|pe[1441+O>>0])<<22|(0|pe[1441+D>>0])<<24|(0|pe[1441+P>>0])<<26|(0|pe[1441+x>>0])<<28|(0|pe[1441+A>>0])<<30,!(t>>>0<=(c=c+1|0)>>>0);)s=s+4|0;he[o>>2]=u,he[e>>2]=l,s=1}}while(0)}else s=0;return oe(E),me=a,0|(U=s)}(e)&&(t=0|he[i>>2],n=11):n=11,11==(0|n)){if(!((0|pe[t+55>>0])<<8|0|pe[t+56>>0]))return 0|(n=1);if(0|function(e){var t=0,r=0,i=0,n=0,o=0,a=0,s=0,l=0,u=0;if(me=(u=me)+560|0,i=(n=u)+40|0,l=u+16|0,r=0|he[88+(e|=0)>>2],a=(0|pe[r+55>>0])<<8|0|pe[r+56>>0],s=e+92|0,t=(0|he[e+4>>2])+((0|pe[r+50>>0])<<8|(0|pe[r+49>>0])<<16|0|pe[r+51>>0])|0,!(r=(0|pe[r+53>>0])<<8|(0|pe[r+52>>0])<<16|0|pe[r+54>>0]))return me=u,(l=0)|l;he[s>>2]=t,he[e+96>>2]=t,he[e+104>>2]=r,he[e+100>>2]=t+r,he[e+108>>2]=0,he[e+112>>2]=0,he[l+20>>2]=0,he[l>>2]=0,he[l+4>>2]=0,he[l+8>>2]=0,he[l+12>>2]=0,de[l+16>>0]=0;e:do{if(0|G(s,l)){if(o=e+268|0,(0|(t=0|he[(r=e+272|0)>>2]))!=(0|a)){if(t>>>0<=a>>>0){do{if((0|he[e+276>>2])>>>0<a>>>0){if(0|H(o,a,(t+1|0)==(0|a),2,0)){t=0|he[r>>2];break}de[e+280>>0]=1,t=0;break e}}while(0);se((0|he[o>>2])+(t<<1)|0,0,a-t<<1|0)}he[r>>2]=a}if(!a){he[n>>2]=866,he[n+4>>2]=910,he[n+8>>2]=1497,Le(i,812,n),Ce(i),t=1;break}for(t=(i=e=r=0)|he[o>>2];;){if(o=0|ge(s,l),i=o+i&255,e=(0|ge(s,l))+e&255,q[t>>1]=e<<8|i,a>>>0<=(r=r+1|0)>>>0){t=1;break}t=t+2|0}}else t=0}while(0);return oe(l),me=u,0|(l=t)}(e)&&0|function(e){var t,r,i,n,o,a,s=0,l=0,u=0,c=0,d=0,h=0,p=0,f=0,m=0,g=0,_=0,v=0,y=0,b=0,C=0,w=0,S=0,T=0,E=0,A=0,x=0,P=0,D=0,O=0,I=0,M=0,R=0,L=0,N=0,k=0,F=0,B=0,U=0,V=0,z=0;if(me=(a=me)+2416|0,d=(h=a)+1904|0,U=a+1880|0,i=a+980|0,n=a+80|0,o=a+16|0,l=0|he[88+(e|=0)>>2],t=(0|pe[l+63>>0])<<8|0|pe[l+64>>0],r=e+92|0,s=(0|he[e+4>>2])+((0|pe[l+58>>0])<<8|(0|pe[l+57>>0])<<16|0|pe[l+59>>0])|0,!(l=(0|pe[l+61>>0])<<8|(0|pe[l+60>>0])<<16|0|pe[l+62>>0]))return me=a,(U=0)|U;if(he[r>>2]=s,he[e+96>>2]=s,he[e+104>>2]=l,he[e+100>>2]=s+l,he[e+108>>2]=0,he[e+112>>2]=0,he[U+20>>2]=0,he[U>>2]=0,he[U+4>>2]=0,he[U+8>>2]=0,he[U+12>>2]=0,(de[U+16>>0]=0)|G(r,U)){for(s=0,u=l=-7;he[i+(s<<2)>>2]=u,he[n+(s<<2)>>2]=l,c=6<(0|u),225!=(0|(s=s+1|0));)l=(1&c)+l|0,u=c?-7:u+1|0;for(l=(s=o)+64|0;(0|(s=s+4|(he[s>>2]=0)))<(0|l););c=e+284|0,l=3*t|0,s=0|he[(u=e+288|0)>>2];e:do{if((0|s)==(0|l))p=13;else{if(s>>>0<=l>>>0){do{if((0|he[e+292>>2])>>>0<l>>>0){if(0|H(c,l,(s+1|0)==(0|l),2,0)){s=0|he[u>>2];break}de[e+296>>0]=1,s=0;break e}}while(0);se((0|he[c>>2])+(s<<1)|0,0,l-s<<1|0)}he[u>>2]=l,p=13}}while(0);do{if(13==(0|p)){if(!t){he[h>>2]=866,he[h+4>>2]=910,he[h+8>>2]=1497,Le(d,812,h),Ce(d),s=1;break}for(T=o+4|0,E=o+8|0,A=o+12|0,x=o+16|0,P=o+20|0,D=o+24|0,O=o+28|0,I=o+32|0,M=o+36|0,R=o+40|0,L=o+44|0,N=o+48|0,k=o+52|0,F=o+56|0,B=o+60|0,s=(S=0)|he[c>>2],l=0|he[o>>2],u=0|he[T>>2],c=0|he[E>>2],e=0|he[A>>2],d=0|he[x>>2],h=0|he[P>>2],p=0|he[D>>2],f=0|he[O>>2],m=0|he[I>>2],g=0|he[M>>2],_=0|he[R>>2],v=0|he[L>>2],w=C=b=y=0;z=0|ge(r,U),l=l+(0|he[i+(z<<2)>>2])&7,u=u+(0|he[n+(z<<2)>>2])&7,z=0|ge(r,U),c=c+(0|he[i+(z<<2)>>2])&7,e=e+(0|he[n+(z<<2)>>2])&7,z=0|ge(r,U),d=d+(0|he[i+(z<<2)>>2])&7,h=h+(0|he[n+(z<<2)>>2])&7,z=0|ge(r,U),p=p+(0|he[i+(z<<2)>>2])&7,f=f+(0|he[n+(z<<2)>>2])&7,z=0|ge(r,U),m=m+(0|he[i+(z<<2)>>2])&7,g=g+(0|he[n+(z<<2)>>2])&7,z=0|ge(r,U),_=_+(0|he[i+(z<<2)>>2])&7,v=v+(0|he[n+(z<<2)>>2])&7,z=0|ge(r,U),y=y+(0|he[i+(z<<2)>>2])&7,b=b+(0|he[n+(z<<2)>>2])&7,z=0|ge(r,U),C=C+(0|he[i+(z<<2)>>2])&7,w=w+(0|he[n+(z<<2)>>2])&7,z=0|pe[1445+h>>0],q[s>>1]=(0|pe[1445+u>>0])<<3|0|pe[1445+l>>0]|(0|pe[1445+c>>0])<<6|(0|pe[1445+e>>0])<<9|(0|pe[1445+d>>0])<<12|z<<15,V=0|pe[1445+_>>0],q[s+2>>1]=(0|pe[1445+p>>0])<<2|z>>>1|(0|pe[1445+f>>0])<<5|(0|pe[1445+m>>0])<<8|(0|pe[1445+g>>0])<<11|V<<14,q[s+4>>1]=(0|pe[1445+v>>0])<<1|V>>>2|(0|pe[1445+y>>0])<<4|(0|pe[1445+b>>0])<<7|(0|pe[1445+C>>0])<<10|(0|pe[1445+w>>0])<<13,!(t>>>0<=(S=S+1|0)>>>0);)s=s+6|0;he[o>>2]=l,he[T>>2]=u,he[E>>2]=c,he[A>>2]=e,he[x>>2]=d,he[P>>2]=h,he[D>>2]=p,he[O>>2]=f,he[I>>2]=m,he[M>>2]=g,he[R>>2]=_,he[L>>2]=v,he[N>>2]=y,he[k>>2]=b,he[F>>2]=C,he[B>>2]=w,s=1}}while(0)}else s=0;return oe(U),me=a,0|(z=s)}(e))return 0|(n=1)}return(n=0)|n}return he[e+88>>2]=0,(n=0)|n}(l,e,t)?(me=h,0|(p=l)):(z(l),7&l?(he[c>>2]=866,he[c+4>>2]=2506,he[c+8>>2]=1232,Le(s,812,c),Ce(s)):ce(l,0,0,1,0),me=h,(p=0)|p)}(e,t),t=o+n|0;do{if(n>>>0<t>>>0){if(!p){for(i=r;i=i+(0|ne(0|ne((c+3|0)>>>2,f),(d+3|0)>>>2))|0,(0|(n=n+1|0))!=(0|t);)d>>>=1,c>>>=1;he[s>>2]=i;break}for(e=d,i=r;d=0|ne((c+3|0)>>>2,f),15<n>>>0|(h=0|ne(d,(e+3|0)>>>2))>>>0<8||519686845!=(0|he[p>>2])||(re(p,s,h,d,n),i=0|he[s>>2]),i=i+h|0,he[s>>2]=i,(0|(n=n+1|0))!=(0|t);)e>>>=1,c>>>=1}}while(0);if(p){if(519686845==(0|he[p>>2]))return z(p),7&p?(he[l>>2]=866,he[l+4>>2]=2506,he[l+8>>2]=1232,Le(a,812,l),Ce(a)):ce(p,0,0,1,0),void(me=u);me=u}else me=u},_memset:se,_sbrk:Ee,_memcpy:Y,stackAlloc:function(e){var t;return me=15+(me=(t=me)+(e|=0)|0)&-16,0|t},_crn_get_height:function(e,t){var r,i;return e|=0,t|=0,me=(i=me)+48|0,he[(r=i)>>2]=40,$(e,t,r),me=i,0|he[r+8>>2]},dynCall_vi:function(e,t){t|=0,ct[7&(e|=0)](0|t)},getTempRet0:function(){return 0|D},_crn_get_levels:function(e,t){var r,i;return e|=0,t|=0,me=(i=me)+48|0,he[(r=i)>>2]=40,$(e,t,r),me=i,0|he[r+12>>2]},_crn_get_uncompressed_size:function(e,t,r){e|=0,t|=0,r|=0;var i,n,o,a,s=0,l=0;switch(me=(a=me)+576|0,o=a+40|0,n=a+56|0,he[(l=a)>>2]=40,$(e,t,l),i=(3+((0|he[l+4>>2])>>>r)|0)>>>2,t=(3+((0|he[l+8>>2])>>>r)|0)>>>2,e=0|he[4+(r=l+32|0)>>2],0|he[r>>2]){case 0:e?s=14:e=8;break;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:s=e?14:13;break;case 9:case 10:e?s=14:e=8;break;default:s=14}return 13==(0|s)?e=16:14==(0|s)&&(he[o>>2]=866,he[o+4>>2]=2672,he[o+8>>2]=1251,Le(n,812,o),Ce(n),e=0),l=0|ne(0|ne(t,i),e),me=a,0|l},_i64Add:Ve,dynCall_iiii:function(e,t,r,i){return t|=0,r|=0,i|=0,0|lt[7&(e|=0)](0|t,0|r,0|i)},_emscripten_get_global_libc:function(){return 5072},dynCall_ii:function(e,t){return t|=0,0|dt[1&(e|=0)](0|t)},___udivdi3:Xe,_llvm_bswap_i32:Qe,dynCall_viiiii:function(e,t,r,i,n,o){t|=0,r|=0,i|=0,n|=0,o|=0,ut[3&(e|=0)](0|t,0|r,0|i,0|n,0|o)},___cxa_can_catch:function(e,t,r){var i,n;return e|=0,t|=0,r|=0,me=(n=me)+16|0,he[(i=n)>>2]=he[r>>2],(e=0|lt[7&he[16+(0|he[e>>2])>>2]](e,t,i))&&(he[r>>2]=he[i>>2]),me=n,1&e|0},_free:B,runPostSets:function(){},dynCall_viiiiii:function(e,t,r,i,n,o,a){t|=0,r|=0,i|=0,n|=0,o|=0,a|=0,ft[3&(e|=0)](0|t,0|r,0|i,0|n,0|o,0|a)},establishStackSpace:function(e,t){me=e|=0,t|=0},___uremdi3:Ie,___cxa_is_pointer_type:function(e){return 1&(e=(e|=0)?0!=(0|Z(e,32,88,0)):0)|0},stackRestore:function(e){me=e|=0},_malloc:L,_emscripten_replace_memory:function(e){return!(16777215&d(e)||d(e)<=16777215||2147483648<d(e)||(de=new i(e),q=new n(e),he=new o(e),pe=new a(e),fe=new s(e),new l(e),new u(e),P=new c(e),r=e,0))},dynCall_v:function(e){pt[3&(e|=0)]()},_crn_get_width:function(e,t){var r,i;return e|=0,t|=0,me=(i=me)+48|0,he[(r=i)>>2]=40,$(e,t,r),me=i,0|he[r+4>>2]},_crn_get_dxt_format:function(e,t){var r,i;return e|=0,t|=0,me=(i=me)+48|0,he[(r=i)>>2]=40,$(e,t,r),me=i,0|he[r+32>>2]}}}(Module.asmGlobalArg,Module.asmLibraryArg,buffer),stackSave=Module.stackSave=asm.stackSave,getTempRet0=Module.getTempRet0=asm.getTempRet0,_memset=Module._memset=asm._memset,setThrew=Module.setThrew=asm.setThrew,_bitshift64Lshr=Module._bitshift64Lshr=asm._bitshift64Lshr,_bitshift64Shl=Module._bitshift64Shl=asm._bitshift64Shl,setTempRet0=Module.setTempRet0=asm.setTempRet0,_crn_decompress=Module._crn_decompress=asm._crn_decompress,_crn_get_bytes_per_block=Module._crn_get_bytes_per_block=asm._crn_get_bytes_per_block,_sbrk=Module._sbrk=asm._sbrk,_memcpy=Module._memcpy=asm._memcpy,stackAlloc=Module.stackAlloc=asm.stackAlloc,_crn_get_height=Module._crn_get_height=asm._crn_get_height,_i64Subtract=Module._i64Subtract=asm._i64Subtract,_crn_get_levels=Module._crn_get_levels=asm._crn_get_levels,_crn_get_uncompressed_size=Module._crn_get_uncompressed_size=asm._crn_get_uncompressed_size,_i64Add=Module._i64Add=asm._i64Add,_emscripten_get_global_libc=Module._emscripten_get_global_libc=asm._emscripten_get_global_libc,___udivdi3=Module.___udivdi3=asm.___udivdi3,_llvm_bswap_i32=Module._llvm_bswap_i32=asm._llvm_bswap_i32,___cxa_can_catch=Module.___cxa_can_catch=asm.___cxa_can_catch,_free=Module._free=asm._free,runPostSets=Module.runPostSets=asm.runPostSets,establishStackSpace=Module.establishStackSpace=asm.establishStackSpace,___uremdi3=Module.___uremdi3=asm.___uremdi3,___cxa_is_pointer_type=Module.___cxa_is_pointer_type=asm.___cxa_is_pointer_type,stackRestore=Module.stackRestore=asm.stackRestore,_malloc=Module._malloc=asm._malloc,_emscripten_replace_memory=Module._emscripten_replace_memory=asm._emscripten_replace_memory,_crn_get_width=Module._crn_get_width=asm._crn_get_width,_crn_get_dxt_format=Module._crn_get_dxt_format=asm._crn_get_dxt_format,dynCall_iiii=Module.dynCall_iiii=asm.dynCall_iiii,dynCall_viiiii=Module.dynCall_viiiii=asm.dynCall_viiiii,dynCall_vi=Module.dynCall_vi=asm.dynCall_vi,dynCall_ii=Module.dynCall_ii=asm.dynCall_ii,dynCall_viii=Module.dynCall_viii=asm.dynCall_viii,dynCall_v=Module.dynCall_v=asm.dynCall_v,dynCall_viiiiii=Module.dynCall_viiiiii=asm.dynCall_viiiiii,dynCall_viiii=Module.dynCall_viiii=asm.dynCall_viiii,initialStackTop;function ExitStatus(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}Runtime.stackAlloc=Module.stackAlloc,Runtime.stackSave=Module.stackSave,Runtime.stackRestore=Module.stackRestore,Runtime.establishStackSpace=Module.establishStackSpace,Runtime.setTempRet0=Module.setTempRet0,Runtime.getTempRet0=Module.getTempRet0,Module.asm=asm,ExitStatus.prototype=new Error,ExitStatus.prototype.constructor=ExitStatus;var preloadStartTime=null,calledMain=!1;function run(e){function t(){Module.calledRun||(Module.calledRun=!0,ABORT||(ensureInitRuntime(),preMain(),Module.onRuntimeInitialized&&Module.onRuntimeInitialized(),Module._main&&shouldRunNow&&Module.callMain(e),postRun()))}e=e||Module.arguments,null===preloadStartTime&&(preloadStartTime=Date.now()),0<runDependencies||(preRun(),0<runDependencies||Module.calledRun||(Module.setStatus?(Module.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Module.setStatus("")},1),t()},1)):t()))}function exit(e,t){t&&Module.noExitRuntime||(Module.noExitRuntime||(ABORT=!0,EXITSTATUS=e,STACKTOP=initialStackTop,exitRuntime(),Module.onExit&&Module.onExit(e)),ENVIRONMENT_IS_NODE&&process.exit(e),Module.quit(e,new ExitStatus(e)))}dependenciesFulfilled=function e(){Module.calledRun||run(),Module.calledRun||(dependenciesFulfilled=e)},Module.callMain=Module.callMain=function(e){e=e||[],ensureInitRuntime();var t=e.length+1;function r(){for(var e=0;e<3;e++)i.push(0)}var i=[allocate(intArrayFromString(Module.thisProgram),"i8",ALLOC_NORMAL)];r();for(var n=0;n<t-1;n+=1)i.push(allocate(intArrayFromString(e[n]),"i8",ALLOC_NORMAL)),r();i.push(0),i=allocate(i,"i32",ALLOC_NORMAL);try{exit(Module._main(t,i,0),!0)}catch(e){if(e instanceof ExitStatus)return;if("SimulateInfiniteLoop"==e)return void(Module.noExitRuntime=!0);var o=e;e&&"object"==typeof e&&e.stack&&(o=[e,e.stack]),Module.printErr("exception thrown: "+o),Module.quit(1,e)}finally{calledMain=!0}},Module.run=Module.run=run,Module.exit=Module.exit=exit;var abortDecorators=[];function abort(t){Module.onAbort&&Module.onAbort(t),t=void 0!==t?(Module.print(t),Module.printErr(t),JSON.stringify(t)):"",ABORT=!0,EXITSTATUS=1;var r="abort("+t+") at "+stackTrace()+"\nIf this abort() is unexpected, build with -s ASSERTIONS=1 which can give more information.";throw abortDecorators&&abortDecorators.forEach(function(e){r=e(r,t)}),r}if(Module.abort=Module.abort=abort,Module.preInit)for("function"==typeof Module.preInit&&(Module.preInit=[Module.preInit]);0<Module.preInit.length;)Module.preInit.pop()();var shouldRunNow=!0;return Module.noInitialRun&&(shouldRunNow=!1),Module.noExitRuntime=!0,run(),Module}),define("ThirdParty/GltfPipeline/findAccessorMinMax",["./getAccessorByteStride","./numberOfComponentsForType","../../Core/arrayFill","../../Core/ComponentDatatype","../../Core/defined"],function(y,b,C,w,S){"use strict";return function(e,t){var r=e.bufferViews,i=e.buffers,n=t.bufferView,o=b(t.type),a=C(new Array(o),Number.POSITIVE_INFINITY),s=C(new Array(o),Number.NEGATIVE_INFINITY);if(S(n)&&S(r)&&r.hasOwnProperty(n)){var l=r[n],u=l.buffer;if(S(u)&&S(i)&&i.hasOwnProperty(u))for(var c=i[u].extras._pipeline.source,d=t.count,h=y(e,t),p=t.byteOffset+l.byteOffset,f=t.componentType,m=0;m<d;m++){for(var g=w.createArrayBufferView(f,c.buffer,p+c.byteOffset,o),_=0;_<o;_++){var v=g[_];a[_]=Math.min(a[_],v),s[_]=Math.max(s[_],v)}p+=h}}return{min:a,max:s}}}),define("ThirdParty/GltfPipeline/getJointCountForMaterials",["./ForEach","../../Core/defined"],function(h,p){"use strict";return function(e){var u=e.meshes,c={},d={};return h.node(e,function(e){p(e.skin)&&(p(d[e.skin])||(d[e.skin]=[]),d[e.skin].push(e))}),h.skin(e,function(e,t){for(var r=e.joints.length,i=function(e){c[e.material]=r},n=d[t],o=n.length,a=0;a<o;a++){var s=n[a].mesh;if(p(s)){var l=u[s];h.meshPrimitive(l,i)}}}),c}}),define("ThirdParty/GltfPipeline/removePipelineExtras",["../../Core/defined"],function(i){"use strict";return function e(t){if(i(t)&&"object"==typeof t)for(var r in i(t.extras)&&i(t.extras._pipeline)&&(delete t.extras._pipeline,0===Object.keys(t.extras).length&&delete t.extras),t)t.hasOwnProperty(r)&&e(t[r]);return t}}),function(Ccl){var Icl,Dcl=this||eval("this"),Ecl=Dcl.document,Fcl=Dcl.navigator,Gcl=Dcl.jQuery,Hcl=Dcl.JSON;Icl=function(e,i){function r(e,t){return(null===e||typeof e in g)&&e===t}function o(e,t){var r;return function(){r||(r=E.a.setTimeout(function(){r=Ccl,e()},t))}}function a(e,t){var r;return function(){clearTimeout(r),r=E.a.setTimeout(e,t)}}function l(e,t){t&&t!==_?"beforeChange"===t?this.Ob(e):this.Ja(e,t):this.Pb(e)}function n(e,t){null!==t&&t.k&&t.k()}function s(e,t){var r=this.Mc,i=r[w];i.T||(this.ob&&this.Oa[t]?(r.Sb(t,e,this.Oa[t]),this.Oa[t]=null,--this.ob):i.s[t]||r.Sb(t,e,i.t?{$:e}:r.yc(e)),e.Ha&&e.Hc())}function t(e,l,u,c){E.d[e]={init:function(i,n,e,t,o){var a,s;return E.m(function(){var e=n(),t=E.a.c(e),r=(t=!u!=!t,!s);(r||l||t!==a)&&(r&&E.xa.Ca()&&(s=E.a.wa(E.f.childNodes(i),!0)),t?(r||E.f.fa(i,E.a.wa(s)),E.hb(c?c(o,e):o,i)):E.f.za(i),a=t)},null,{i:i}),{controlsDescendantBindings:!0}}},E.h.va[e]=!1,E.f.aa[e]=!0}var u,c,d,h,p,f,m,E=void 0!==e?e:{};E.b=function(e,t){for(var r=e.split("."),i=E,n=0;n<r.length-1;n++)i=i[r[n]];i[r[r.length-1]]=t},E.H=function(e,t,r){e[t]=r},E.version="3.4.2",E.b("version",E.version),E.options={deferUpdates:!1,useOnlyNativeEvents:!1},E.a=function(){function d(e,t){for(var r in e)e.hasOwnProperty(r)&&t(r,e[r])}function e(e,t){if(t)for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function t(e,t){return e.__proto__=t,e}function n(e,t,r,i){var n=e[t].match(u)||[];E.a.r(r.match(u),function(e){E.a.ra(n,e,i)}),e[t]=n.join(" ")}var r={__proto__:[]}instanceof Array,i="function"==typeof Symbol,o={},a={};o[Fcl&&/Firefox\/2/i.test(Fcl.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],o.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),d(o,function(e,t){if(t.length)for(var r=0,i=t.length;r<i;r++)a[t[r]]=e});var s={propertychange:!0},l=Ecl&&function(){for(var e=3,t=Ecl.createElement("div"),r=t.getElementsByTagName("i");t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",r[0];);return 4<e?e:Ccl}(),u=/\S+/g;return{gc:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],r:function(e,t){for(var r=0,i=e.length;r<i;r++)t(e[r],r)},o:function(e,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t);for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1},Vb:function(e,t,r){for(var i=0,n=e.length;i<n;i++)if(t.call(r,e[i],i))return e[i];return null},Na:function(e,t){var r=E.a.o(e,t);0<r?e.splice(r,1):0===r&&e.shift()},Wb:function(e){for(var t=[],r=0,i=(e=e||[]).length;r<i;r++)E.a.o(t,e[r])<0&&t.push(e[r]);return t},ib:function(e,t){for(var r=[],i=0,n=(e=e||[]).length;i<n;i++)r.push(t(e[i],i));return r},Ma:function(e,t){for(var r=[],i=0,n=(e=e||[]).length;i<n;i++)t(e[i],i)&&r.push(e[i]);return r},ta:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var r=0,i=t.length;r<i;r++)e.push(t[r]);return e},ra:function(e,t,r){var i=E.a.o(E.a.Bb(e),t);i<0?r&&e.push(t):r||e.splice(i,1)},la:r,extend:e,$a:t,ab:r?t:e,D:d,Ea:function(e,t){if(!e)return e;var r,i={};for(r in e)e.hasOwnProperty(r)&&(i[r]=t(e[r],r,e));return i},rb:function(e){for(;e.firstChild;)E.removeNode(e.firstChild)},nc:function(e){for(var t=((e=E.a.W(e))[0]&&e[0].ownerDocument||Ecl).createElement("div"),r=0,i=e.length;r<i;r++)t.appendChild(E.ba(e[r]));return t},wa:function(e,t){for(var r=0,i=e.length,n=[];r<i;r++){var o=e[r].cloneNode(!0);n.push(t?E.ba(o):o)}return n},fa:function(e,t){if(E.a.rb(e),t)for(var r=0,i=t.length;r<i;r++)e.appendChild(t[r])},uc:function(e,t){var r=e.nodeType?[e]:e;if(0<r.length){for(var i=r[0],n=i.parentNode,o=0,a=t.length;o<a;o++)n.insertBefore(t[o],i);for(o=0,a=r.length;o<a;o++)E.removeNode(r[o])}},Ba:function(e,t){if(e.length){for(t=8===t.nodeType&&t.parentNode||t;e.length&&e[0].parentNode!==t;)e.splice(0,1);for(;1<e.length&&e[e.length-1].parentNode!==t;)e.length--;if(1<e.length){var r=e[0],i=e[e.length-1];for(e.length=0;r!==i;)e.push(r),r=r.nextSibling;e.push(i)}}return e},wc:function(e,t){l<7?e.setAttribute("selected",t):e.selected=t},cb:function(e){return null===e||e===Ccl?"":e.trim?e.trim():e.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},sd:function(e,t){return e=e||"",!(t.length>e.length)&&e.substring(0,t.length)===t},Rc:function(e,t){if(e===t)return!0;if(11===e.nodeType)return!1;if(t.contains)return t.contains(3===e.nodeType?e.parentNode:e);if(t.compareDocumentPosition)return 16==(16&t.compareDocumentPosition(e));for(;e&&e!=t;)e=e.parentNode;return!!e},qb:function(e){return E.a.Rc(e,e.ownerDocument.documentElement)},Tb:function(e){return!!E.a.Vb(e,E.a.qb)},A:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},Zb:function(e){return E.onError?function(){try{return e.apply(this,arguments)}catch(e){throw E.onError&&E.onError(e),e}}:e},setTimeout:function(e,t){return setTimeout(E.a.Zb(e),t)},dc:function(e){setTimeout(function(){throw E.onError&&E.onError(e),e},0)},q:function(t,e,r){var i=E.a.Zb(r);if(r=l&&s[e],E.options.useOnlyNativeEvents||r||!Gcl)if(r||"function"!=typeof t.addEventListener){if(void 0===t.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var n=function(e){i.call(t,e)},o="on"+e;t.attachEvent(o,n),E.a.G.qa(t,function(){t.detachEvent(o,n)})}else t.addEventListener(e,i,!1);else Gcl(t).bind(e,i)},Fa:function(e,t){if(!e||!e.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var r;if(r=!("input"!==E.a.A(e)||!e.type||"click"!=t.toLowerCase()||"checkbox"!=(r=e.type)&&"radio"!=r),E.options.useOnlyNativeEvents||!Gcl||r)if("function"==typeof Ecl.createEvent){if("function"!=typeof e.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");(r=Ecl.createEvent(a[t]||"HTMLEvents")).initEvent(t,!0,!0,Dcl,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(r)}else if(r&&e.click)e.click();else{if(void 0===e.fireEvent)throw Error("Browser doesn't support triggering events");e.fireEvent("on"+t)}else Gcl(e).trigger(t)},c:function(e){return E.I(e)?e():e},Bb:function(e){return E.I(e)?e.p():e},fb:function(t,e,r){var i;e&&("object"==typeof t.classList?(i=t.classList[r?"add":"remove"],E.a.r(e.match(u),function(e){i.call(t.classList,e)})):"string"==typeof t.className.baseVal?n(t.className,"baseVal",e,r):n(t,"className",e,r))},bb:function(e,t){var r=E.a.c(t);null!==r&&r!==Ccl||(r="");var i=E.f.firstChild(e);!i||3!=i.nodeType||E.f.nextSibling(i)?E.f.fa(e,[e.ownerDocument.createTextNode(r)]):i.data=r,E.a.Wc(e)},vc:function(e,t){if(e.name=t,l<=7)try{e.mergeAttributes(Ecl.createElement("<input name='"+e.name+"'/>"),!1)}catch(e){}},Wc:function(e){9<=l&&(e=1==e.nodeType?e:e.parentNode).style&&(e.style.zoom=e.style.zoom)},Sc:function(e){if(l){var t=e.style.width;e.style.width=0,e.style.width=t}},nd:function(e,t){e=E.a.c(e),t=E.a.c(t);for(var r=[],i=e;i<=t;i++)r.push(i);return r},W:function(e){for(var t=[],r=0,i=e.length;r<i;r++)t.push(e[r]);return t},bc:function(e){return i?Symbol(e):e},xd:6===l,yd:7===l,C:l,ic:function(e,t){for(var r=E.a.W(e.getElementsByTagName("input")).concat(E.a.W(e.getElementsByTagName("textarea"))),i="string"==typeof t?function(e){return e.name===t}:function(e){return t.test(e.name)},n=[],o=r.length-1;0<=o;o--)i(r[o])&&n.push(r[o]);return n},kd:function(e){return"string"==typeof e&&(e=E.a.cb(e))?Hcl&&Hcl.parse?Hcl.parse(e):new Function("return "+e)():null},Gb:function(e,t,r){if(!Hcl||!Hcl.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return Hcl.stringify(E.a.c(e),t,r)},ld:function(e,t,r){var i=(r=r||{}).params||{},n=r.includeFields||this.gc,o=e;if("object"==typeof e&&"form"===E.a.A(e)){o=e.action;for(var a=n.length-1;0<=a;a--)for(var s=E.a.ic(e,n[a]),l=s.length-1;0<=l;l--)i[s[l].name]=s[l].value}t=E.a.c(t);var u=Ecl.createElement("form");for(var c in u.style.display="none",u.action=o,u.method="post",t)(e=Ecl.createElement("input")).type="hidden",e.name=c,e.value=E.a.Gb(E.a.c(t[c])),u.appendChild(e);d(i,function(e,t){var r=Ecl.createElement("input");r.type="hidden",r.name=e,r.value=t,u.appendChild(r)}),Ecl.body.appendChild(u),r.submitter?r.submitter(u):u.submit(),setTimeout(function(){u.parentNode.removeChild(u)},0)}}}(),E.b("utils",E.a),E.b("utils.arrayForEach",E.a.r),E.b("utils.arrayFirst",E.a.Vb),E.b("utils.arrayFilter",E.a.Ma),E.b("utils.arrayGetDistinctValues",E.a.Wb),E.b("utils.arrayIndexOf",E.a.o),E.b("utils.arrayMap",E.a.ib),E.b("utils.arrayPushAll",E.a.ta),E.b("utils.arrayRemoveItem",E.a.Na),E.b("utils.extend",E.a.extend),E.b("utils.fieldsIncludedWithJsonPost",E.a.gc),E.b("utils.getFormFields",E.a.ic),E.b("utils.peekObservable",E.a.Bb),E.b("utils.postJson",E.a.ld),E.b("utils.parseJson",E.a.kd),E.b("utils.registerEventHandler",E.a.q),E.b("utils.stringifyJson",E.a.Gb),E.b("utils.range",E.a.nd),E.b("utils.toggleDomNodeCssClass",E.a.fb),E.b("utils.triggerEvent",E.a.Fa),E.b("utils.unwrapObservable",E.a.c),E.b("utils.objectForEach",E.a.D),E.b("utils.addOrRemoveItem",E.a.ra),E.b("utils.setTextContent",E.a.bb),E.b("unwrap",E.a.c),Function.prototype.bind||(Function.prototype.bind=function(t){var r=this;if(1===arguments.length)return function(){return r.apply(t,arguments)};var i=Array.prototype.slice.call(arguments,1);return function(){var e=i.slice(0);return e.push.apply(e,arguments),r.apply(t,e)}}),E.a.e=new function(){function i(e,t){var r=e[o];if(!r||"null"===r||!a[r]){if(!t)return Ccl;r=e[o]="ko"+n++,a[r]={}}return a[r]}var n=0,o="__ko__"+(new Date).getTime(),a={};return{get:function(e,t){var r=i(e,!1);return r===Ccl?Ccl:r[t]},set:function(e,t,r){r===Ccl&&i(e,!1)===Ccl||(i(e,!0)[t]=r)},clear:function(e){var t=e[o];return!(!t||(delete a[t],e[o]=null))},J:function(){return n+++o}}},E.b("utils.domData",E.a.e),E.b("utils.domData.clear",E.a.e.clear),E.a.G=new function(){function i(e,t){var r=E.a.e.get(e,o);return r===Ccl&&t&&(r=[],E.a.e.set(e,o,r)),r}function n(e){if(t=i(e,!1))for(var t=t.slice(0),r=0;r<t.length;r++)t[r](e);if(E.a.e.clear(e),E.a.G.cleanExternalData(e),s[e.nodeType])for(t=e.firstChild;e=t;)t=e.nextSibling,8===e.nodeType&&n(e)}var o=E.a.e.J(),a={1:!0,8:!0,9:!0},s={1:!0,9:!0};return{qa:function(e,t){if("function"!=typeof t)throw Error("Callback must be a function");i(e,!0).push(t)},tc:function(e,t){var r=i(e,!1);r&&(E.a.Na(r,t),0==r.length&&E.a.e.set(e,o,Ccl))},ba:function(e){if(a[e.nodeType]&&(n(e),s[e.nodeType])){var t=[];E.a.ta(t,e.getElementsByTagName("*"));for(var r=0,i=t.length;r<i;r++)n(t[r])}return e},removeNode:function(e){E.ba(e),e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){Gcl&&"function"==typeof Gcl.cleanData&&Gcl.cleanData([e])}}},E.ba=E.a.G.ba,E.removeNode=E.a.G.removeNode,E.b("cleanNode",E.ba),E.b("removeNode",E.removeNode),E.b("utils.domNodeDisposal",E.a.G),E.b("utils.domNodeDisposal.addDisposeCallback",E.a.G.qa),E.b("utils.domNodeDisposal.removeDisposeCallback",E.a.G.tc),u=[0,"",""],p={thead:c=[1,"<table>","</table>"],tbody:c,tfoot:c,tr:[2,"<table><tbody>","</tbody></table>"],td:d=[3,"<table><tbody><tr>","</tr></tbody></table>"],th:d,option:h=[1,"<select multiple='multiple'>","</select>"],optgroup:h},f=E.a.C<=8,E.a.na=function(e,t){var r;if(Gcl){if(Gcl.parseHTML)r=Gcl.parseHTML(e,t)||[];else if((r=Gcl.clean([e],t))&&r[0]){for(var i=r[0];i.parentNode&&11!==i.parentNode.nodeType;)i=i.parentNode;i.parentNode&&i.parentNode.removeChild(i)}}else{(r=t)||(r=Ecl),i=r.parentWindow||r.defaultView||Dcl;var n,o=E.a.cb(e).toLowerCase(),a=r.createElement("div");for(o=(n=(o=o.match(/^<([a-z]+)[ >]/))&&p[o[1]]||u)[0],n="ignored<div>"+n[1]+e+n[2]+"</div>","function"==typeof i.innerShiv?a.appendChild(i.innerShiv(n)):(f&&r.appendChild(a),a.innerHTML=n,f&&a.parentNode.removeChild(a));o--;)a=a.lastChild;r=E.a.W(a.lastChild.childNodes)}return r},E.a.Eb=function(e,t){if(E.a.rb(e),null!==(t=E.a.c(t))&&t!==Ccl)if("string"!=typeof t&&(t=t.toString()),Gcl)Gcl(e).html(t);else for(var r=E.a.na(t,e.ownerDocument),i=0;i<r.length;i++)e.appendChild(r[i])},E.b("utils.parseHtmlFragment",E.a.na),E.b("utils.setHtml",E.a.Eb),E.N=(m={},{yb:function(e){if("function"!=typeof e)throw Error("You can only pass a function to ko.memoization.memoize()");var t=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return m[t]=e,"\x3c!--[ko_memo:"+t+"]--\x3e"},Bc:function(e,t){var r=m[e];if(r===Ccl)throw Error("Couldn't find any memo with ID "+e+". Perhaps it's already been unmemoized.");try{return r.apply(null,t||[]),!0}finally{delete m[e]}},Cc:function(e,t){var r=[];!function e(t,r){if(t)if(8==t.nodeType)null!=(i=E.N.pc(t.nodeValue))&&r.push({Qc:t,hd:i});else if(1==t.nodeType)for(var i=0,n=t.childNodes,o=n.length;i<o;i++)e(n[i],r)}(e,r);for(var i=0,n=r.length;i<n;i++){var o=r[i].Qc,a=[o];t&&E.a.ta(a,t),E.N.Bc(r[i].hd,a),o.nodeValue="",o.parentNode&&o.parentNode.removeChild(o)}},pc:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:null}}),E.b("memoization",E.N),E.b("memoization.memoize",E.N.yb),E.b("memoization.unmemoize",E.N.Bc),E.b("memoization.parseMemoText",E.N.pc),E.b("memoization.unmemoizeDomNodeAndDescendants",E.N.Cc),E.Z=function(){function e(){if(o)for(var e,t=o,r=0;s<o;)if(e=n[s++]){if(t<s){if(5e3<=++r){s=o,E.a.dc(Error("'Too much recursion' after processing "+r+" task groups."));break}t=o}try{e()}catch(e){E.a.dc(e)}}}function t(){e(),s=o=n.length=0}var r,i,n=[],o=0,a=1,s=0;return{scheduler:Dcl.MutationObserver?(r=t,i=Ecl.createElement("div"),new MutationObserver(r).observe(i,{attributes:!0}),function(){i.classList.toggle("foo")}):Ecl&&"onreadystatechange"in Ecl.createElement("script")?function(e){var t=Ecl.createElement("script");t.onreadystatechange=function(){t.onreadystatechange=null,Ecl.documentElement.removeChild(t),t=null,e()},Ecl.documentElement.appendChild(t)}:function(e){setTimeout(e,0)},Za:function(e){return o||E.Z.scheduler(t),n[o++]=e,a++},cancel:function(e){s<=(e-=a-o)&&e<o&&(n[e]=null)},resetForTesting:function(){var e=o-s;return s=o=n.length=0,e},rd:e}}(),E.b("tasks",E.Z),E.b("tasks.schedule",E.Z.Za),E.b("tasks.runEarly",E.Z.rd),E.Aa={throttle:function(t,r){t.throttleEvaluation=r;var i=null;return E.B({read:t,write:function(e){clearTimeout(i),i=E.a.setTimeout(function(){t(e)},r)}})},rateLimit:function(e,t){var r,i,n;"number"==typeof t?r=t:(r=t.timeout,i=t.method),e.gb=!1,n="notifyWhenChangesStop"==i?a:o,e.Wa(function(e){return n(e,r)})},deferred:function(i,e){if(!0!==e)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");i.gb||(i.gb=!0,i.Wa(function(e){var t,r=!1;return function(){if(!r){E.Z.cancel(t),t=E.Z.Za(e);try{r=!0,i.notifySubscribers(Ccl,"dirty")}finally{r=!1}}}}))},notify:function(e,t){e.equalityComparer="always"==t?null:r}};var g={undefined:1,boolean:1,number:1,string:1};E.b("extenders",E.Aa),E.zc=function(e,t,r){this.$=e,this.jb=t,this.Pc=r,this.T=!1,E.H(this,"dispose",this.k)},E.zc.prototype.k=function(){this.T=!0,this.Pc()},E.K=function(){E.a.ab(this,v),v.ub(this)};var _="change",v={ub:function(e){e.F={change:[]},e.Qb=1},Y:function(e,t,r){var i=this;r=r||_;var n=new E.zc(i,t?e.bind(t):e,function(){E.a.Na(i.F[r],n),i.Ka&&i.Ka(r)});return i.ua&&i.ua(r),i.F[r]||(i.F[r]=[]),i.F[r].push(n),n},notifySubscribers:function(e,t){if((t=t||_)===_&&this.Kb(),this.Ra(t)){var r=t===_&&this.Fc||this.F[t].slice(0);try{E.l.Xb();for(var i,n=0;i=r[n];++n)i.T||i.jb(e)}finally{E.l.end()}}},Pa:function(){return this.Qb},Zc:function(e){return this.Pa()!==e},Kb:function(){++this.Qb},Wa:function(e){var t,r,i,n,o=this,a=E.I(o);o.Ja||(o.Ja=o.notifySubscribers,o.notifySubscribers=l);var s=e(function(){o.Ha=!1,a&&n===o&&(n=o.Mb?o.Mb():o());var e=r||o.Ua(i,n);r=t=!1,e&&o.Ja(i=n)});o.Pb=function(e){o.Fc=o.F[_].slice(0),o.Ha=t=!0,n=e,s()},o.Ob=function(e){t||(i=e,o.Ja(e,"beforeChange"))},o.Hc=function(){o.Ua(i,o.p(!0))&&(r=!0)}},Ra:function(e){return this.F[e]&&this.F[e].length},Xc:function(e){if(e)return this.F[e]&&this.F[e].length||0;var r=0;return E.a.D(this.F,function(e,t){"dirty"!==e&&(r+=t.length)}),r},Ua:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},extend:function(e){var i=this;return e&&E.a.D(e,function(e,t){var r=E.Aa[e];"function"==typeof r&&(i=r(i,t)||i)}),i}};E.H(v,"subscribe",v.Y),E.H(v,"extend",v.extend),E.H(v,"getSubscriptionsCount",v.Xc),E.a.la&&E.a.$a(v,Function.prototype),E.K.fn=v,E.lc=function(e){return null!=e&&"function"==typeof e.Y&&"function"==typeof e.notifySubscribers},E.b("subscribable",E.K),E.b("isSubscribable",E.lc),E.xa=E.l=function(){function i(e){r.push(t),t=e}function n(){t=r.pop()}var t,r=[],o=0;return{Xb:i,end:n,sc:function(e){if(t){if(!E.lc(e))throw Error("Only subscribable things can act as dependencies");t.jb.call(t.Lc,e,e.Gc||(e.Gc=++o))}},w:function(e,t,r){try{return i(),e.apply(t,r||[])}finally{n()}},Ca:function(){if(t)return t.m.Ca()},Va:function(){if(t)return t.Va}}}(),E.b("computedContext",E.xa),E.b("computedContext.getDependenciesCount",E.xa.Ca),E.b("computedContext.isInitial",E.xa.Va),E.b("ignoreDependencies",E.wd=E.l.w);var y=E.a.bc("_latestValue");E.O=function(e){function t(){return 0<arguments.length?(t.Ua(t[y],arguments[0])&&(t.ia(),t[y]=arguments[0],t.ha()),this):(E.l.sc(t),t[y])}return t[y]=e,E.a.la||E.a.extend(t,E.K.fn),E.K.fn.ub(t),E.a.ab(t,b),E.options.deferUpdates&&E.Aa.deferred(t,!0),t};var b={equalityComparer:r,p:function(){return this[y]},ha:function(){this.notifySubscribers(this[y])},ia:function(){this.notifySubscribers(this[y],"beforeChange")}};E.a.la&&E.a.$a(b,E.K.fn);var C=E.O.md="__ko_proto__";b[C]=E.O,E.Qa=function(e,t){return null!==e&&e!==Ccl&&e[C]!==Ccl&&(e[C]===t||E.Qa(e[C],t))},E.I=function(e){return E.Qa(e,E.O)},E.Da=function(e){return!!("function"==typeof e&&e[C]===E.O||"function"==typeof e&&e[C]===E.B&&e.$c)},E.b("observable",E.O),E.b("isObservable",E.I),E.b("isWriteableObservable",E.Da),E.b("isWritableObservable",E.Da),E.b("observable.fn",b),E.H(b,"peek",b.p),E.H(b,"valueHasMutated",b.ha),E.H(b,"valueWillMutate",b.ia),E.ma=function(e){if("object"!=typeof(e=e||[])||!("length"in e))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return e=E.O(e),E.a.ab(e,E.ma.fn),e.extend({trackArrayChanges:!0})},E.ma.fn={remove:function(t){for(var e=this.p(),r=[],i="function"!=typeof t||E.I(t)?function(e){return e===t}:t,n=0;n<e.length;n++){var o=e[n];i(o)&&(0===r.length&&this.ia(),r.push(o),e.splice(n,1),n--)}return r.length&&this.ha(),r},removeAll:function(t){if(t!==Ccl)return t?this.remove(function(e){return 0<=E.a.o(t,e)}):[];var e=this.p(),r=e.slice(0);return this.ia(),e.splice(0,e.length),this.ha(),r},destroy:function(t){var e=this.p(),r="function"!=typeof t||E.I(t)?function(e){return e===t}:t;this.ia();for(var i=e.length-1;0<=i;i--)r(e[i])&&(e[i]._destroy=!0);this.ha()},destroyAll:function(t){return t===Ccl?this.destroy(function(){return!0}):t?this.destroy(function(e){return 0<=E.a.o(t,e)}):[]},indexOf:function(e){var t=this();return E.a.o(t,e)},replace:function(e,t){var r=this.indexOf(e);0<=r&&(this.ia(),this.p()[r]=t,this.ha())}},E.a.la&&E.a.$a(E.ma.fn,E.O.fn),E.a.r("pop push reverse shift sort splice unshift".split(" "),function(r){E.ma.fn[r]=function(){var e=this.p();this.ia(),this.Yb(e,r,arguments);var t=e[r].apply(e,arguments);return this.ha(),t===e?this:t}}),E.a.r(["slice"],function(t){E.ma.fn[t]=function(){var e=this();return e[t].apply(e,arguments)}}),E.b("observableArray",E.ma),E.Aa.trackArrayChanges=function(i,e){if(i.kb={},e&&"object"==typeof e&&E.a.extend(i.kb,e),i.kb.sparse=!0,!i.Yb){var t,n,d=!1,h=null,p=0,r=i.ua,o=i.Ka;i.ua=function(e){r&&r.call(i,e),"arrayChange"===e&&function(){if(!d){d=!0,n=i.notifySubscribers,i.notifySubscribers=function(e,t){return t&&t!==_||++p,n.apply(this,arguments)};var r=[].concat(i.p()||[]);h=null,t=i.Y(function(e){var t;e=[].concat(e||[]),i.Ra("arrayChange")&&((!h||1<p)&&(h=E.a.lb(r,e,i.kb)),t=h),r=e,h=null,p=0,t&&t.length&&i.notifySubscribers(t,"arrayChange")})}}()},i.Ka=function(e){o&&o.call(i,e),"arrayChange"!==e||i.Ra("arrayChange")||(n&&(i.notifySubscribers=n,n=Ccl),t.k(),d=!1)},i.Yb=function(e,t,r){function i(e,t,r){return n[n.length]={status:e,value:t,index:r}}if(d&&!p){var n=[],o=e.length,a=r.length,s=0;switch(t){case"push":s=o;case"unshift":for(t=0;t<a;t++)i("added",r[t],s+t);break;case"pop":s=o-1;case"shift":o&&i("deleted",e[s],s);break;case"splice":t=Math.min(Math.max(0,r[0]<0?o+r[0]:r[0]),o),o=1===a?o:Math.min(t+(r[1]||0),o),a=t+a-2,s=Math.max(o,a);for(var l=[],u=[],c=2;t<s;++t,++c)t<o&&u.push(i("deleted",e[t],t)),t<a&&l.push(i("added",r[c],t));E.a.hc(u,l);break;default:return}h=n}}}};var w=E.a.bc("_state");E.m=E.B=function(e,t,r){function i(){if(0<arguments.length){if("function"!=typeof n)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return n.apply(o.sb,arguments),this}return E.l.sc(i),(o.V||o.t&&i.Sa())&&i.U(),o.M}if("object"==typeof e?r=e:(r=r||{},e&&(r.read=e)),"function"!=typeof r.read)throw Error("Pass a function that returns the value of the ko.computed");var n=r.write,o={M:Ccl,da:!0,V:!0,Ta:!1,Hb:!1,T:!1,Ya:!1,t:!1,od:r.read,sb:t||r.owner,i:r.disposeWhenNodeIsRemoved||r.i||null,ya:r.disposeWhen||r.ya,pb:null,s:{},L:0,fc:null};return i[w]=o,i.$c="function"==typeof n,E.a.la||E.a.extend(i,E.K.fn),E.K.fn.ub(i),E.a.ab(i,S),r.pure?(o.Ya=!0,o.t=!0,E.a.extend(i,T)):r.deferEvaluation&&E.a.extend(i,A),E.options.deferUpdates&&E.Aa.deferred(i,!0),o.i&&(o.Hb=!0,o.i.nodeType||(o.i=null)),o.t||r.deferEvaluation||i.U(),o.i&&i.ca()&&E.a.G.qa(o.i,o.pb=function(){i.k()}),i};var S={equalityComparer:r,Ca:function(){return this[w].L},Sb:function(e,t,r){if(this[w].Ya&&t===this)throw Error("A 'pure' computed must not be called recursively");(this[w].s[e]=r).Ia=this[w].L++,r.pa=t.Pa()},Sa:function(){var e,t,r=this[w].s;for(e in r)if(r.hasOwnProperty(e)&&(t=r[e],this.oa&&t.$.Ha||t.$.Zc(t.pa)))return!0},gd:function(){this.oa&&!this[w].Ta&&this.oa(!1)},ca:function(){var e=this[w];return e.V||0<e.L},qd:function(){this.Ha?this[w].V&&(this[w].da=!0):this.ec()},yc:function(e){if(!e.gb||this[w].i)return e.Y(this.ec,this);var t=e.Y(this.gd,this,"dirty"),r=e.Y(this.qd,this);return{$:e,k:function(){t.k(),r.k()}}},ec:function(){var e=this,t=e.throttleEvaluation;t&&0<=t?(clearTimeout(this[w].fc),this[w].fc=E.a.setTimeout(function(){e.U(!0)},t)):e.oa?e.oa(!0):e.U(!0)},U:function(e){var t=this[w],r=t.ya,i=!1;if(!t.Ta&&!t.T){if(t.i&&!E.a.qb(t.i)||r&&r()){if(!t.Hb)return void this.k()}else t.Hb=!1;t.Ta=!0;try{i=this.Vc(e)}finally{t.Ta=!1}return t.L||this.k(),i}},Vc:function(e){var t=this[w],r=!1,i=t.Ya?Ccl:!t.L,n={Mc:this,Oa:t.s,ob:t.L};return E.l.Xb({Lc:n,jb:s,m:this,Va:i}),t.s={},t.L=0,n=this.Uc(t,n),this.Ua(t.M,n)&&(t.t||this.notifySubscribers(t.M,"beforeChange"),t.M=n,t.t?this.Kb():e&&this.notifySubscribers(t.M),r=!0),i&&this.notifySubscribers(t.M,"awake"),r},Uc:function(e,t){try{var r=e.od;return e.sb?r.call(e.sb):r()}finally{E.l.end(),t.ob&&!e.t&&E.a.D(t.Oa,n),e.da=e.V=!1}},p:function(e){var t=this[w];return(t.V&&(e||!t.L)||t.t&&this.Sa())&&this.U(),t.M},Wa:function(e){E.K.fn.Wa.call(this,e),this.Mb=function(){return this[w].da?this.U():this[w].V=!1,this[w].M},this.oa=function(e){this.Ob(this[w].M),this[w].V=!0,e&&(this[w].da=!0),this.Pb(this)}},k:function(){var e=this[w];!e.t&&e.s&&E.a.D(e.s,function(e,t){t.k&&t.k()}),e.i&&e.pb&&E.a.G.tc(e.i,e.pb),e.s=null,e.L=0,e.T=!0,e.da=!1,e.V=!1,e.t=!1,e.i=null}},T={ua:function(e){var n=this,o=n[w];if(!o.T&&o.t&&"change"==e){if(o.t=!1,o.da||n.Sa())o.s=null,o.L=0,n.U()&&n.Kb();else{var r=[];E.a.D(o.s,function(e,t){r[t.Ia]=e}),E.a.r(r,function(e,t){var r=o.s[e],i=n.yc(r.$);i.Ia=t,i.pa=r.pa,o.s[e]=i})}o.T||n.notifySubscribers(o.M,"awake")}},Ka:function(e){var r=this[w];r.T||"change"!=e||this.Ra("change")||(E.a.D(r.s,function(e,t){t.k&&(r.s[e]={$:t.$,Ia:t.Ia,pa:t.pa},t.k())}),r.t=!0,this.notifySubscribers(Ccl,"asleep"))},Pa:function(){var e=this[w];return e.t&&(e.da||this.Sa())&&this.U(),E.K.fn.Pa.call(this)}},A={ua:function(e){"change"!=e&&"beforeChange"!=e||this.p()}};E.a.la&&E.a.$a(S,E.K.fn);var x,P=E.O.md;E.m[P]=E.O,S[P]=E.m,E.bd=function(e){return E.Qa(e,E.m)},E.cd=function(e){return E.Qa(e,E.m)&&e[w]&&e[w].Ya},E.b("computed",E.m),E.b("dependentObservable",E.m),E.b("isComputed",E.bd),E.b("isPureComputed",E.cd),E.b("computed.fn",S),E.H(S,"peek",S.p),E.H(S,"dispose",S.k),E.H(S,"isActive",S.ca),E.H(S,"getDependenciesCount",S.Ca),E.rc=function(e,t){return"function"==typeof e?E.m(e,t,{pure:!0}):((e=E.a.extend({},e)).pure=!0,E.m(e,t))},E.b("pureComputed",E.rc),function(){function s(i,n,o){if(o=o||new e,"object"!=typeof(i=n(i))||null===i||i===Ccl||i instanceof RegExp||i instanceof Date||i instanceof String||i instanceof Number||i instanceof Boolean)return i;var a=i instanceof Array?[]:{};return o.save(i,a),function(e,t){if(e instanceof Array){for(var r=0;r<e.length;r++)t(r);"function"==typeof e.toJSON&&t("toJSON")}else for(r in e)t(r)}(i,function(e){var t=n(i[e]);switch(typeof t){case"boolean":case"number":case"string":case"function":a[e]=t;break;case"object":case"undefined":var r=o.get(t);a[e]=r!==Ccl?r:s(t,n,o)}}),a}function e(){this.keys=[],this.Lb=[]}E.Ac=function(e){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return s(e,function(e){for(var t=0;E.I(e)&&t<10;t++)e=e();return e})},E.toJSON=function(e,t,r){return e=E.Ac(e),E.a.Gb(e,t,r)},e.prototype={save:function(e,t){var r=E.a.o(this.keys,e);0<=r?this.Lb[r]=t:(this.keys.push(e),this.Lb.push(t))},get:function(e){return 0<=(e=E.a.o(this.keys,e))?this.Lb[e]:Ccl}}}(),E.b("toJS",E.Ac),E.b("toJSON",E.toJSON),E.j={u:function(e){switch(E.a.A(e)){case"option":return!0===e.__ko__hasDomDataOptionValue__?E.a.e.get(e,E.d.options.zb):E.a.C<=7?e.getAttributeNode("value")&&e.getAttributeNode("value").specified?e.value:e.text:e.value;case"select":return 0<=e.selectedIndex?E.j.u(e.options[e.selectedIndex]):Ccl;default:return e.value}},ja:function(e,t,r){switch(E.a.A(e)){case"option":switch(typeof t){case"string":E.a.e.set(e,E.d.options.zb,Ccl),"__ko__hasDomDataOptionValue__"in e&&delete e.__ko__hasDomDataOptionValue__,e.value=t;break;default:E.a.e.set(e,E.d.options.zb,t),e.__ko__hasDomDataOptionValue__=!0,e.value="number"==typeof t?t:""}break;case"select":""!==t&&null!==t||(t=Ccl);for(var i,n=-1,o=0,a=e.options.length;o<a;++o)if((i=E.j.u(e.options[o]))==t||""==i&&t===Ccl){n=o;break}(r||0<=n||t===Ccl&&1<e.size)&&(e.selectedIndex=n);break;default:null!==t&&t!==Ccl||(t=""),e.value=t}}},E.b("selectExtensions",E.j),E.b("selectExtensions.readValue",E.j.u),E.b("selectExtensions.writeValue",E.j.ja),E.h=function(){function i(e){123===(e=E.a.cb(e)).charCodeAt(0)&&(e=e.slice(1,-1));var t,r=[],i=e.match(d),n=[],o=0;if(i){i.push(",");for(var a,s=0;a=i[s];++s){var l=a.charCodeAt(0);if(44===l){if(o<=0){r.push(t&&n.length?{key:t,value:n.join("")}:{unknown:t||n.join("")}),t=o=0,n=[];continue}}else if(58===l){if(!o&&!t&&1===n.length){t=n.pop();continue}}else 47===l&&s&&1<a.length?(l=i[s-1].match(h))&&!p[l[0]]&&((i=(e=e.substr(e.indexOf(a)+1)).match(d)).push(","),s=-1,a="/"):40===l||123===l||91===l?++o:41===l||125===l||93===l?--o:t||n.length||34!==l&&39!==l||(a=a.slice(1,-1));n.push(a)}}return r}var u=["true","false","null","undefined"],c=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,d=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),h=/[\])"'A-Za-z0-9_$]+$/,p={in:1,return:1,typeof:1},f={};return{va:[],ga:f,Ab:i,Xa:function(e,t){function n(e,t){var r;if(!l){var i=E.getBindingHandler(e);if(i&&i.preprocess&&!(t=i.preprocess(t,e,n)))return;(i=f[e])&&(r=t,i=r=!(0<=E.a.o(u,r))&&null!==(i=r.match(c))&&(i[1]?"Object("+i[1]+")"+i[2]:r)),i&&a.push("'"+e+"':function(_z){"+r+"=_z}")}s&&(t="function(){return "+t+" }"),o.push("'"+e+"':"+t)}var o=[],a=[],s=(t=t||{}).valueAccessors,l=t.bindingParams,r="string"==typeof e?i(e):e;return E.a.r(r,function(e){n(e.key||e.unknown,e.value)}),a.length&&n("_ko_property_writers","{"+a.join(",")+" }"),o.join(",")},fd:function(e,t){for(var r=0;r<e.length;r++)if(e[r].key==t)return!0;return!1},Ga:function(e,t,r,i,n){e&&E.I(e)?!E.Da(e)||n&&e.p()===i||e(i):(e=t.get("_ko_property_writers"))&&e[r]&&e[r](i)}}}(),E.b("expressionRewriting",E.h),E.b("expressionRewriting.bindingRewriteValidators",E.h.va),E.b("expressionRewriting.parseObjectLiteral",E.h.Ab),E.b("expressionRewriting.preProcessBindings",E.h.Xa),E.b("expressionRewriting._twoWayBindings",E.h.ga),E.b("jsonExpressionRewriting",E.h),E.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",E.h.Xa),function(){function o(e){return 8==e.nodeType&&r.test(t?e.text:e.nodeValue)}function a(e){return 8==e.nodeType&&n.test(t?e.text:e.nodeValue)}function i(e,t){for(var r=e,i=1,n=[];r=r.nextSibling;){if(a(r)&&0==--i)return n;n.push(r),o(r)&&i++}if(!t)throw Error("Cannot find closing comment tag to match: "+e.nodeValue);return null}function s(e,t){var r=i(e,t);return r?0<r.length?r[r.length-1].nextSibling:e.nextSibling:null}var t=Ecl&&"\x3c!--test--\x3e"===Ecl.createComment("test").text,r=t?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,n=t?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,l={ul:!0,ol:!0};E.f={aa:{},childNodes:function(e){return o(e)?i(e):e.childNodes},za:function(e){if(o(e))for(var t=0,r=(e=E.f.childNodes(e)).length;t<r;t++)E.removeNode(e[t]);else E.a.rb(e)},fa:function(e,t){if(o(e)){E.f.za(e);for(var r=e.nextSibling,i=0,n=t.length;i<n;i++)r.parentNode.insertBefore(t[i],r)}else E.a.fa(e,t)},qc:function(e,t){o(e)?e.parentNode.insertBefore(t,e.nextSibling):e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)},kc:function(e,t,r){r?o(e)?e.parentNode.insertBefore(t,r.nextSibling):r.nextSibling?e.insertBefore(t,r.nextSibling):e.appendChild(t):E.f.qc(e,t)},firstChild:function(e){return o(e)?!e.nextSibling||a(e.nextSibling)?null:e.nextSibling:e.firstChild},nextSibling:function(e){return o(e)&&(e=s(e)),e.nextSibling&&a(e.nextSibling)?null:e.nextSibling},Yc:o,vd:function(e){return(e=(t?e.text:e.nodeValue).match(r))?e[1]:null},oc:function(e){if(l[E.a.A(e)]){var t=e.firstChild;if(t)do{if(1===t.nodeType){var r,i=null;if(r=t.firstChild)do{if(i)i.push(r);else if(o(r)){var n=s(r,!0);n?r=n:i=[r]}else a(r)&&(i=[r])}while(r=r.nextSibling);if(r=i)for(i=t.nextSibling,n=0;n<r.length;n++)i?e.insertBefore(r[n],i):e.appendChild(r[n])}}while(t=t.nextSibling)}}}}(),E.b("virtualElements",E.f),E.b("virtualElements.allowedBindings",E.f.aa),E.b("virtualElements.emptyNode",E.f.za),E.b("virtualElements.insertAfter",E.f.kc),E.b("virtualElements.prepend",E.f.qc),E.b("virtualElements.setDomNodeChildren",E.f.fa),E.S=function(){this.Kc={}},E.a.extend(E.S.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute("data-bind")||E.g.getComponentNameForNode(e);case 8:return E.f.Yc(e);default:return!1}},getBindings:function(e,t){var r=(r=this.getBindingsString(e,t))?this.parseBindingsString(r,t,e):null;return E.g.Rb(r,e,t,!1)},getBindingAccessors:function(e,t){var r=(r=this.getBindingsString(e,t))?this.parseBindingsString(r,t,e,{valueAccessors:!0}):null;return E.g.Rb(r,e,t,!0)},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind");case 8:return E.f.vd(e);default:return null}},parseBindingsString:function(t,e,r,i){try{var n,o=this.Kc,a=t+(i&&i.valueAccessors||"");if(!(n=o[a])){var s,l="with($context){with($data||{}){return{"+E.h.Xa(t,i)+"}}}";s=new Function("$context","$element",l),n=o[a]=s}return n(e,r)}catch(e){throw e.message="Unable to parse bindings.\nBindings value: "+t+"\nMessage: "+e.message,e}}}),E.S.instance=new E.S,E.b("bindingProvider",E.S),function(){function a(e){return function(){return e}}function g(e){return e()}function s(r){return E.a.Ea(E.l.w(r),function(e,t){return function(){return r()[t]}})}function _(e,t){return s(this.getBindings.bind(this,e,t))}function o(e,t,r){var i,n=E.f.firstChild(t),o=E.S.instance,a=o.preprocessNode;if(a){for(;i=n;)n=E.f.nextSibling(i),a.call(o,i);n=E.f.firstChild(t)}for(;i=n;)n=E.f.nextSibling(i),l(e,i,r)}function l(e,t,r){var i=!0,n=1===t.nodeType;n&&E.f.oc(t),(n&&r||E.S.instance.nodeHasBindings(t))&&(i=u(t,null,e,r).shouldBindDescendants),i&&!d[E.a.A(t)]&&o(e,t,!n)}function u(n,e,o,t){var a,s,i,l,u,c,r=E.a.e.get(n,v);if(!e){if(r)throw Error("You cannot apply bindings multiple times to the same element.");E.a.e.set(n,v,!0)}if(!r&&t&&E.xc(n,o),e&&"function"!=typeof e)a=e;else{var d=E.S.instance,h=d.getBindingAccessors||_,p=E.B(function(){return(a=e?e(o,n):h.call(d,n,o))&&o.Q&&o.Q(),a},null,{i:n});a&&p.ca()||(p=null)}if(a){var f=p?function(e){return function(){return g(p()[e])}}:function(e){return a[e]},m=function(){return E.a.Ea(p?p():a,g)};m.get=function(e){return a[e]&&g(f(e))},m.has=function(e){return e in a},i=a,l=[],u={},c=[],E.a.D(i,function t(e){if(!u[e]){var r=E.getBindingHandler(e);r&&(r.after&&(c.push(e),E.a.r(r.after,function(e){if(i[e]){if(-1!==E.a.o(c,e))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+c.join(", "));t(e)}}),c.length--),l.push({key:e,jc:r})),u[e]=!0}}),t=l,E.a.r(t,function(e){var t=e.jc.init,r=e.jc.update,i=e.key;if(8===n.nodeType&&!E.f.aa[i])throw Error("The binding '"+i+"' cannot be used with virtual elements");try{"function"==typeof t&&E.l.w(function(){var e=t(n,f(i),m,o.$data,o);if(e&&e.controlsDescendantBindings){if(s!==Ccl)throw Error("Multiple bindings ("+s+" and "+i+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");s=i}}),"function"==typeof r&&E.B(function(){r(n,f(i),m,o.$data,o)},null,{i:n})}catch(e){throw e.message='Unable to process binding "'+i+": "+a[i]+'"\nMessage: '+e.message,e}})}return{shouldBindDescendants:s===Ccl}}function c(e){return e&&e instanceof E.R?e:new E.R(e)}E.d={};var d={script:!0,textarea:!0,template:!0};E.getBindingHandler=function(e){return E.d[e]},E.R=function(r,i,n,o,e){function t(){var e=u?r():r,t=E.a.c(e);return i?(i.Q&&i.Q(),E.a.extend(l,i),l.Q=s):(l.$parents=[],l.$root=t,l.ko=E),l.$rawData=e,l.$data=t,n&&(l[n]=t),o&&o(l,i,t),l.$data}var a,s,l=this,u="function"==typeof r&&!E.I(r);e&&e.exportDependencies?t():(s=E.B(t,null,{ya:function(){return a&&!E.a.Tb(a)},i:!0})).ca()&&((l.Q=s).equalityComparer=null,a=[],s.Dc=function(e){a.push(e),E.a.G.qa(e,function(e){E.a.Na(a,e),a.length||(s.k(),l.Q=s=Ccl)})})},E.R.prototype.createChildContext=function(e,t,r,i){return new E.R(e,this,t,function(e,t){e.$parentContext=t,e.$parent=t.$data,e.$parents=(t.$parents||[]).slice(0),e.$parents.unshift(e.$parent),r&&r(e)},i)},E.R.prototype.extend=function(r){return new E.R(this.Q||this.$data,this,null,function(e,t){e.$rawData=t.$rawData,E.a.extend(e,"function"==typeof r?r():r)})},E.R.prototype.ac=function(e,t){return this.createChildContext(e,t,null,{exportDependencies:!0})};var v=E.a.e.J(),r=E.a.e.J();E.xc=function(e,t){if(2!=arguments.length)return E.a.e.get(e,r);E.a.e.set(e,r,t),t.Q&&t.Q.Dc(e)},E.La=function(e,t,r){return 1===e.nodeType&&E.f.oc(e),u(e,t,c(r),!0)},E.Ic=function(e,t,r){return r=c(r),E.La(e,(n=r,o=e,"function"==typeof(i=t)?s(i.bind(null,n,o)):E.a.Ea(i,a)),r);var i,n,o},E.hb=function(e,t){1!==t.nodeType&&8!==t.nodeType||o(c(e),t,!0)},E.Ub=function(e,t){if(!Gcl&&Dcl.jQuery&&(Gcl=Dcl.jQuery),t&&1!==t.nodeType&&8!==t.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");t=t||Dcl.document.body,l(c(e),t,!0)},E.nb=function(e){switch(e.nodeType){case 1:case 8:var t=E.xc(e);if(t)return t;if(e.parentNode)return E.nb(e.parentNode)}return Ccl},E.Oc=function(e){return(e=E.nb(e))?e.$data:Ccl},E.b("bindingHandlers",E.d),E.b("applyBindings",E.Ub),E.b("applyBindingsToDescendants",E.hb),E.b("applyBindingAccessorsToNode",E.La),E.b("applyBindingsToNode",E.Ic),E.b("contextFor",E.nb),E.b("dataFor",E.Oc)}(),function(s){function i(i,e){var n,r,o,a=u.hasOwnProperty(i)?u[i]:s;a?a.Y(e):((a=u[i]=new E.K).Y(e),o=function(e,t){var r=!(!t||!t.synchronous);c[i]={definition:e,dd:r},delete u[i],n||r?a.notifySubscribers(e):E.Z.Za(function(){a.notifySubscribers(e)})},l("getConfig",[r=i],function(t){t?l("loadComponent",[r,t],function(e){o(e,t)}):o(null,null)}),n=!0)}function l(t,r,i,n){n||(n=E.g.loaders.slice(0));var e=n.shift();if(e){var o=e[t];if(o){var a=!1;if(o.apply(e,r.concat(function(e){a?i(null):null!==e?i(e):l(t,r,i,n)}))!==s&&(a=!0,!e.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else l(t,r,i,n)}else i(null)}var u={},c={};E.g={get:function(e,t){var r=c.hasOwnProperty(e)?c[e]:s;r?r.dd?E.l.w(function(){t(r.definition)}):E.Z.Za(function(){t(r.definition)}):i(e,t)},$b:function(e){delete c[e]},Nb:l},E.g.loaders=[],E.b("components",E.g),E.b("components.get",E.g.get),E.b("components.clearCachedDefinition",E.g.$b)}(),function(){function n(e){switch(E.a.A(e)){case"script":return E.a.na(e.text);case"textarea":return E.a.na(e.value);case"template":if(o(e.content))return E.a.wa(e.content.childNodes)}return E.a.wa(e.childNodes)}function o(e){return Dcl.DocumentFragment?e instanceof DocumentFragment:e&&11===e.nodeType}function l(e,t,r){"string"==typeof t.require?i||Dcl.require?(i||Dcl.require)([t.require],r):e("Uses require, but no AMD loader is present"):r(t)}function a(t){return function(e){throw Error("Component '"+t+"': "+e)}}var r={};E.g.register=function(e,t){if(!t)throw Error("Invalid configuration for "+e);if(E.g.wb(e))throw Error("Component "+e+" is already registered");r[e]=t},E.g.wb=function(e){return r.hasOwnProperty(e)},E.g.ud=function(e){delete r[e],E.g.$b(e)},E.g.cc={getConfig:function(e,t){t(r.hasOwnProperty(e)?r[e]:null)},loadComponent:function(t,e,r){var i=a(t);l(i,e,function(e){!function(t,e,r,i){function n(){0==--a&&i(o)}var o={},a=2,s=r.template;r=r.viewModel,s?l(e,s,function(e){E.g.Nb("loadTemplate",[t,e],function(e){o.template=e,n()})}):n(),r?l(e,r,function(e){E.g.Nb("loadViewModel",[t,e],function(e){o[u]=e,n()})}):n()}(t,i,e,r)})},loadTemplate:function(e,t,r){if(e=a(e),"string"==typeof t)r(E.a.na(t));else if(t instanceof Array)r(t);else if(o(t))r(E.a.W(t.childNodes));else if(t.element)if(t=t.element,Dcl.HTMLElement?t instanceof HTMLElement:t&&t.tagName&&1===t.nodeType)r(n(t));else if("string"==typeof t){var i=Ecl.getElementById(t);i?r(n(i)):e("Cannot find element with ID "+t)}else e("Unknown element type: "+t);else e("Unknown template value: "+t)},loadViewModel:function(e,t,r){!function e(t,r,i){if("function"==typeof r)i(function(e){return new r(e)});else if("function"==typeof r[u])i(r[u]);else if("instance"in r){var n=r.instance;i(function(){return n})}else"viewModel"in r?e(t,r.viewModel,i):t("Unknown viewModel value: "+r)}(a(e),t,r)}};var u="createViewModel";E.b("components.register",E.g.register),E.b("components.isRegistered",E.g.wb),E.b("components.unregister",E.g.ud),E.b("components.defaultLoader",E.g.cc),E.g.loaders.push(E.g.cc),E.g.Ec=r}(),function(){E.g.getComponentNameForNode=function(e){var t=E.a.A(e);if(E.g.wb(t)&&(-1!=t.indexOf("-")||"[object HTMLUnknownElement]"==""+e||E.a.C<=8&&e.tagName===t))return t},E.g.Rb=function(e,t,r,i){if(1===t.nodeType){var n=E.g.getComponentNameForNode(t);if(n){if((e=e||{}).component)throw Error('Cannot use the "component" binding on a custom element matching a component');var o={name:n,params:function(r,e){if(t=r.getAttribute("params")){var t=a.parseBindingsString(t,e,r,{valueAccessors:!0,bindingParams:!0}),i=(t=E.a.Ea(t,function(e){return E.m(e,null,{i:r})}),E.a.Ea(t,function(t){var e=t.p();return t.ca()?E.m({read:function(){return E.a.c(t())},write:E.Da(e)&&function(e){t()(e)},i:r}):e}));return i.hasOwnProperty("$raw")||(i.$raw=t),i}return{$raw:{}}}(t,r)};e.component=i?function(){return o}:o}}return e};var i,t,a=new E.S;E.a.C<9&&(E.g.register=(t=E.g.register,function(e){return Ecl.createElement(e),t.apply(this,arguments)}),Ecl.createDocumentFragment=(i=Ecl.createDocumentFragment,function(){var e,t=i(),r=E.g.Ec;for(e in r)r.hasOwnProperty(e)&&t.createElement(e);return t}))}(),x=0,E.d.component={init:function(c,t,e,r,d){function h(){var e=p&&p.dispose;"function"==typeof e&&e.call(p),f=p=null}var p,f,m=E.a.W(E.f.childNodes(c));return E.a.G.qa(c,h),E.m(function(){var s,l,e=E.a.c(t());if("string"==typeof e?s=e:(s=E.a.c(e.name),l=E.a.c(e.params)),!s)throw Error("No component name specified");var u=f=++x;E.g.get(s,function(e){if(f===u){if(h(),!e)throw Error("Unknown component '"+s+"'");!function(e,t,r){if(!(t=t.template))throw Error("Component '"+e+"' has no template");e=E.a.wa(t),E.f.fa(r,e)}(s,e,c);var t=(i=c,n=m,o=l,(a=(r=e).createViewModel)?a.call(r,o,{element:i,templateNodes:n}):o);e=d.createChildContext(t,void 0,function(e){e.$component=t,e.$componentTemplateNodes=m}),p=t,E.hb(e,c)}var r,i,n,o,a})},null,{i:c}),{controlsDescendantBindings:!0}}},E.f.aa.component=!0;var D={class:"className",for:"htmlFor"};E.d.attr={update:function(i,e){var t=E.a.c(e())||{};E.a.D(t,function(e,t){var r=!1===(t=E.a.c(t))||null===t||t===Ccl;r&&i.removeAttribute(e),E.a.C<=8&&e in D?(e=D[e],r?i.removeAttribute(e):i[e]=t):r||i.setAttribute(e,t.toString()),"name"===e&&E.a.vc(i,r?"":t.toString())})}},E.d.checked={after:["value","attr"],init:function(n,o,a){function e(){var e=n.checked,t=h?s():e;if(!E.xa.Va()&&(!l||e)){var r=E.l.w(o);if(u){var i=c?r.p():r;d!==t?(e&&(E.a.ra(i,t,!0),E.a.ra(i,d,!1)),d=t):E.a.ra(i,t,e),c&&E.Da(r)&&r(i)}else E.h.Ga(r,a,"checked",t,!0)}}var s=E.rc(function(){return a.has("checkedValue")?E.a.c(a.get("checkedValue")):a.has("value")?E.a.c(a.get("value")):n.value}),t="checkbox"==n.type,l="radio"==n.type;if(t||l){var r=o(),u=t&&E.a.c(r)instanceof Array,c=!(u&&r.push&&r.splice),d=u?s():Ccl,h=l||u;l&&!n.name&&E.d.uniqueName.init(n,function(){return!0}),E.m(e,null,{i:n}),E.a.q(n,"click",e),E.m(function(){var e=E.a.c(o());n.checked=u?0<=E.a.o(e,s()):t?e:s()===e},null,{i:n}),r=Ccl}}},E.h.ga.checked=!0,E.d.checkedValue={update:function(e,t){e.value=E.a.c(t())}},E.d.css={update:function(r,e){var t=E.a.c(e());null!==t&&"object"==typeof t?E.a.D(t,function(e,t){t=E.a.c(t),E.a.fb(r,e,t)}):(t=E.a.cb(String(t||"")),E.a.fb(r,r.__ko__cssValue,!1),r.__ko__cssValue=t,E.a.fb(r,t,!0))}},E.d.enable={update:function(e,t){var r=E.a.c(t());r&&e.disabled?e.removeAttribute("disabled"):r||e.disabled||(e.disabled=!0)}},E.d.disable={update:function(e,t){E.d.enable.update(e,function(){return!E.a.c(t())})}},E.d.event={init:function(e,o,a,s,l){var t=o()||{};E.a.D(t,function(n){"string"==typeof n&&E.a.q(e,n,function(e){var t,r=o()[n];if(r){try{var i=E.a.W(arguments);s=l.$data,i.unshift(s),t=r.apply(s,i)}finally{!0!==t&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}!1===a.get(n+"Bubble")&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}})})}},E.d.foreach={mc:function(r){return function(){var e=r(),t=E.a.Bb(e);return t&&"number"!=typeof t.length?(E.a.c(e),{foreach:t.data,as:t.as,includeDestroyed:t.includeDestroyed,afterAdd:t.afterAdd,beforeRemove:t.beforeRemove,afterRender:t.afterRender,beforeMove:t.beforeMove,afterMove:t.afterMove,templateEngine:E.X.vb}):{foreach:e,templateEngine:E.X.vb}}},init:function(e,t){return E.d.template.init(e,E.d.foreach.mc(t))},update:function(e,t,r,i,n){return E.d.template.update(e,E.d.foreach.mc(t),r,i,n)}},E.h.va.foreach=!1,E.f.aa.foreach=!0,E.d.hasfocus={init:function(i,n,o){function e(e){i.__ko_hasfocusUpdating=!0;var t=i.ownerDocument;if("activeElement"in t){var r;try{r=t.activeElement}catch(e){r=t.body}e=r===i}t=n(),E.h.Ga(t,o,"hasfocus",e,!0),i.__ko_hasfocusLastValue=e,i.__ko_hasfocusUpdating=!1}var t=e.bind(null,!0),r=e.bind(null,!1);E.a.q(i,"focus",t),E.a.q(i,"focusin",t),E.a.q(i,"blur",r),E.a.q(i,"focusout",r)},update:function(e,t){var r=!!E.a.c(t());e.__ko_hasfocusUpdating||e.__ko_hasfocusLastValue===r||(r?e.focus():e.blur(),!r&&e.__ko_hasfocusLastValue&&e.ownerDocument.body.focus(),E.l.w(E.a.Fa,null,[e,r?"focusin":"focusout"]))}},E.h.ga.hasfocus=!0,E.d.hasFocus=E.d.hasfocus,E.h.ga.hasFocus=!0,E.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){E.a.Eb(e,t())}},t("if"),t("ifnot",!1,!0),t("with",!0,!1,function(e,t){return e.ac(t)});var O={};E.d.options={init:function(e){if("select"!==E.a.A(e))throw Error("options binding applies only to SELECT elements");for(;0<e.length;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(i,e,n){function t(){return E.a.Ma(i.options,function(e){return e.selected})}function o(e,t,r){var i=typeof t;return"function"==i?t(e):"string"==i?e[t]:r}function r(e,t){if(p&&u)E.j.ja(i,E.a.c(n.get("value")),!0);else if(h.length){var r=0<=E.a.o(h,E.j.u(t[0]));E.a.wc(t[0],r),p&&!r&&E.l.w(E.a.Fa,null,[i,"change"])}}var a=i.multiple,s=0!=i.length&&a?i.scrollTop:null,l=E.a.c(e()),u=n.get("valueAllowUnset")&&n.has("value"),c=n.get("optionsIncludeDestroyed");e={};var d,h=[];u||(a?h=E.a.ib(t(),E.j.u):0<=i.selectedIndex&&h.push(E.j.u(i.options[i.selectedIndex]))),l&&(void 0===l.length&&(l=[l]),d=E.a.Ma(l,function(e){return c||e===Ccl||null===e||!E.a.c(e._destroy)}),n.has("optionsCaption")&&null!==(l=E.a.c(n.get("optionsCaption")))&&l!==Ccl&&d.unshift(O));var p=!1;e.beforeRemove=function(e){i.removeChild(e)},l=r,n.has("optionsAfterRender")&&"function"==typeof n.get("optionsAfterRender")&&(l=function(e,t){r(0,t),E.l.w(n.get("optionsAfterRender"),null,[t[0],e!==O?e:Ccl])}),E.a.Db(i,d,function(e,t,r){return r.length&&(h=!u&&r[0].selected?[E.j.u(r[0])]:[],p=!0),t=i.ownerDocument.createElement("option"),e===O?(E.a.bb(t,n.get("optionsCaption")),E.j.ja(t,Ccl)):(r=o(e,n.get("optionsValue"),e),E.j.ja(t,E.a.c(r)),e=o(e,n.get("optionsText"),r),E.a.bb(t,e)),[t]},e,l),E.l.w(function(){u?E.j.ja(i,E.a.c(n.get("value")),!0):(a?h.length&&t().length<h.length:h.length&&0<=i.selectedIndex?E.j.u(i.options[i.selectedIndex])!==h[0]:h.length||0<=i.selectedIndex)&&E.a.Fa(i,"change")}),E.a.Sc(i),s&&20<Math.abs(s-i.scrollTop)&&(i.scrollTop=s)}},E.d.options.zb=E.a.e.J(),E.d.selectedOptions={after:["options","foreach"],init:function(r,i,n){E.a.q(r,"change",function(){var e=i(),t=[];E.a.r(r.getElementsByTagName("option"),function(e){e.selected&&t.push(E.j.u(e))}),E.h.Ga(e,n,"selectedOptions",t)})},update:function(e,t){if("select"!=E.a.A(e))throw Error("values binding applies only to SELECT elements");var r=E.a.c(t()),i=e.scrollTop;r&&"number"==typeof r.length&&E.a.r(e.getElementsByTagName("option"),function(e){var t=0<=E.a.o(r,E.j.u(e));e.selected!=t&&E.a.wc(e,t)}),e.scrollTop=i}},E.h.ga.selectedOptions=!0,E.d.style={update:function(r,e){var t=E.a.c(e()||{});E.a.D(t,function(e,t){null!==(t=E.a.c(t))&&t!==Ccl&&!1!==t||(t=""),r.style[e]=t})}},E.d.submit={init:function(i,n,e,t,o){if("function"!=typeof n())throw Error("The value for a submit binding must be a function");E.a.q(i,"submit",function(e){var t,r=n();try{t=r.call(o.$data,i)}finally{!0!==t&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}})}},E.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){E.a.bb(e,t())}},E.f.aa.text=!0,function(){if(Dcl&&Dcl.navigator)var e=function(e){if(e)return parseFloat(e[1])},c=Dcl.opera&&Dcl.opera.version&&parseInt(Dcl.opera.version()),t=Dcl.navigator.userAgent,d=e(t.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),h=e(t.match(/Firefox\/([^ ]*)/));if(E.a.C<10)var i=E.a.e.J(),n=E.a.e.J(),o=function(e){var t=this.activeElement;(t=t&&E.a.e.get(t,n))&&t(e)},p=function(e,t){var r=e.ownerDocument;E.a.e.get(r,i)||(E.a.e.set(r,i,!0),E.a.q(r,"selectionchange",o)),E.a.e.set(e,n,t)};E.d.textInput={init:function(r,i,t){function e(e,t){E.a.q(r,e,t)}function n(){a||(s=r.value,a=E.a.setTimeout(o,4))}function o(){clearTimeout(a),s=a=Ccl;var e=r.value;l!==e&&(l=e,E.h.Ga(i(),t,"textInput",e))}var a,s,l=r.value,u=9==E.a.C?n:o;E.a.C<10?(e("propertychange",function(e){"value"===e.propertyName&&u(e)}),8==E.a.C&&(e("keyup",o),e("keydown",o)),8<=E.a.C&&(p(r,u),e("dragend",n))):(e("input",o),d<5&&"textarea"===E.a.A(r)?(e("keydown",n),e("paste",n),e("cut",n)):c<11?e("keydown",n):h<4&&(e("DOMAutoComplete",o),e("dragdrop",o),e("drop",o))),e("change",o),E.m(function e(){var t=E.a.c(i());null!==t&&t!==Ccl||(t=""),s!==Ccl&&t===s?E.a.setTimeout(e,4):r.value!==t&&(l=t,r.value=t)},null,{i:r})}},E.h.ga.textInput=!0,E.d.textinput={preprocess:function(e,t,r){r("textInput",e)}}}(),E.d.uniqueName={init:function(e,t){if(t()){var r="ko_unique_"+ ++E.d.uniqueName.Nc;E.a.vc(e,r)}}},E.d.uniqueName.Nc=0,E.d.value={after:["options","foreach"],init:function(i,n,o){if("input"!=i.tagName.toLowerCase()||"checkbox"!=i.type&&"radio"!=i.type){var e=["change"],t=o.get("valueUpdate"),r=!1,a=null;t&&("string"==typeof t&&(t=[t]),E.a.ta(e,t),e=E.a.Wb(e));var s=function(){a=null,r=!1;var e=n(),t=E.j.u(i);E.h.Ga(e,o,"value",t)};!E.a.C||"input"!=i.tagName.toLowerCase()||"text"!=i.type||"off"==i.autocomplete||i.form&&"off"==i.form.autocomplete||-1!=E.a.o(e,"propertychange")||(E.a.q(i,"propertychange",function(){r=!0}),E.a.q(i,"focus",function(){r=!1}),E.a.q(i,"blur",function(){r&&s()})),E.a.r(e,function(e){var t=s;E.a.sd(e,"after")&&(t=function(){a=E.j.u(i),E.a.setTimeout(s,0)},e=e.substring(5)),E.a.q(i,e,t)});var l=function(){var e=E.a.c(n()),t=E.j.u(i);if(null!==a&&e===a)E.a.setTimeout(l,0);else if(e!==t)if("select"===E.a.A(i)){var r=o.get("valueAllowUnset");(t=function(){E.j.ja(i,e,r)})(),r||e===E.j.u(i)?E.a.setTimeout(t,0):E.l.w(E.a.Fa,null,[i,"change"])}else E.j.ja(i,e)};E.m(l,null,{i:i})}else E.La(i,{checkedValue:n})},update:function(){}},E.h.ga.value=!0,E.d.visible={update:function(e,t){var r=E.a.c(t()),i="none"!=e.style.display;r&&!i?e.style.display="":!r&&i&&(e.style.display="none")}},E.d.click={init:function(e,t,r,i,n){return E.d.event.init.call(this,e,function(){var e={};return e.click=t(),e},r,i,n)}},E.P=function(){},E.P.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},E.P.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},E.P.prototype.makeTemplateSource=function(e,t){if("string"==typeof e){var r=(t=t||Ecl).getElementById(e);if(!r)throw Error("Cannot find template with ID "+e);return new E.v.n(r)}if(1==e.nodeType||8==e.nodeType)return new E.v.sa(e);throw Error("Unknown template type: "+e)},E.P.prototype.renderTemplate=function(e,t,r,i){return e=this.makeTemplateSource(e,i),this.renderTemplateSource(e,t,r,i)},E.P.prototype.isTemplateRewritten=function(e,t){return!1===this.allowTemplateRewriting||this.makeTemplateSource(e,t).data("isRewritten")},E.P.prototype.rewriteTemplate=function(e,t,r){t=t((e=this.makeTemplateSource(e,r)).text()),e.text(t),e.data("isRewritten",!0)},E.b("templateEngine",E.P),E.Ib=function(){function a(e,t,r,i){e=E.h.Ab(e);for(var n=E.h.va,o=0;o<e.length;o++){var a=e[o].key;if(n.hasOwnProperty(a)){var s=n[a];if("function"==typeof s){if(a=s(e[o].value))throw Error(a)}else if(!s)throw Error("This template engine does not support the '"+a+"' binding within its templates")}}return r="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+E.h.Xa(e,{valueAccessors:!0})+" } })()},'"+r.toLowerCase()+"')",i.createJavaScriptEvaluatorBlock(r)+t}var t=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,r=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{Tc:function(e,t,r){t.isTemplateRewritten(e,r)||t.rewriteTemplate(e,function(e){return E.Ib.jd(e,t)},r)},jd:function(e,o){return e.replace(t,function(e,t,r,i,n){return a(n,t,r,o)}).replace(r,function(e,t){return a(t,"\x3c!-- ko --\x3e","#comment",o)})},Jc:function(i,n){return E.N.yb(function(e,t){var r=e.nextSibling;r&&r.nodeName.toLowerCase()===n&&E.La(r,i,t)})}}}(),E.b("__tr_ambtns",E.Ib.Jc),function(){E.v={},E.v.n=function(e){if(this.n=e){var t=E.a.A(e);this.eb="script"===t?1:"textarea"===t?2:"template"==t&&e.content&&11===e.content.nodeType?3:4}},E.v.n.prototype.text=function(){var e=1===this.eb?"text":2===this.eb?"value":"innerHTML";if(0==arguments.length)return this.n[e];var t=arguments[0];"innerHTML"===e?E.a.Eb(this.n,t):this.n[e]=t};var t=E.a.e.J()+"_";E.v.n.prototype.data=function(e){if(1===arguments.length)return E.a.e.get(this.n,t+e);E.a.e.set(this.n,t+e,arguments[1])};var r=E.a.e.J();E.v.n.prototype.nodes=function(){var e=this.n;if(0==arguments.length)return(E.a.e.get(e,r)||{}).mb||(3===this.eb?e.content:4===this.eb?e:Ccl);E.a.e.set(e,r,{mb:arguments[0]})},E.v.sa=function(e){this.n=e},E.v.sa.prototype=new E.v.n,E.v.sa.prototype.text=function(){if(0==arguments.length){var e=E.a.e.get(this.n,r)||{};return e.Jb===Ccl&&e.mb&&(e.Jb=e.mb.innerHTML),e.Jb}E.a.e.set(this.n,r,{Jb:arguments[0]})},E.b("templateSources",E.v),E.b("templateSources.domElement",E.v.n),E.b("templateSources.anonymousTemplate",E.v.sa)}(),function(){function i(e,t,r){var i;for(t=E.f.nextSibling(t);e&&(i=e)!==t;)r(i,e=E.f.nextSibling(i))}function u(e,t){if(e.length){var n=e[0],o=e[e.length-1],r=n.parentNode,a=E.S.instance,s=a.preprocessNode;if(s){if(i(n,o,function(e,t){var r=e.previousSibling,i=s.call(a,e);i&&(e===n&&(n=i[0]||t),e===o&&(o=i[i.length-1]||r))}),e.length=0,!n)return;n===o?e.push(n):(e.push(n,o),E.a.Ba(e,r))}i(n,o,function(e){1!==e.nodeType&&8!==e.nodeType||E.Ub(t,e)}),i(n,o,function(e){1!==e.nodeType&&8!==e.nodeType||E.N.Cc(e,[t])}),E.a.Ba(e,r)}}function l(e){return e.nodeType?e:0<e.length?e[0]:null}function c(e,t,r,i,n){n=n||{};var o=(e&&l(e)||r||{}).ownerDocument,a=n.templateEngine||h;if(E.Ib.Tc(r,a,o),"number"!=typeof(r=a.renderTemplate(r,i,n,o)).length||0<r.length&&"number"!=typeof r[0].nodeType)throw Error("Template engine must return an array of DOM nodes");switch(o=!1,t){case"replaceChildren":E.f.fa(e,r),o=!0;break;case"replaceNode":E.a.uc(e,r),o=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+t)}return o&&(u(r,i),n.afterRender&&E.l.w(n.afterRender,null,[r,i.$data])),r}function d(e,t,r){return E.I(e)?e():"function"==typeof e?e(t,r):e}var h;E.Fb=function(e){if(e!=Ccl&&!(e instanceof E.P))throw Error("templateEngine must inherit from ko.templateEngine");h=e},E.Cb=function(r,i,n,o,a){if(((n=n||{}).templateEngine||h)==Ccl)throw Error("Set a template engine before calling renderTemplate");if(a=a||"replaceChildren",o){var s=l(o);return E.B(function(){var e=i&&i instanceof E.R?i:new E.R(i,null,null,null,{exportDependencies:!0}),t=d(r,e.$data,e);e=c(o,a,t,e,n),"replaceNode"==a&&(s=l(o=e))},null,{ya:function(){return!s||!E.a.qb(s)},i:s&&"replaceNode"==a?s.parentNode:s})}return E.N.yb(function(e){E.Cb(r,i,n,e,"replaceNode")})},E.pd=function(r,t,i,n,o){function a(e,t){u(t,l),i.afterRender&&i.afterRender(t,e),l=null}function s(e,t){return l=o.createChildContext(e,i.as,function(e){e.$index=t}),c(null,"ignoreTargetNode",d(r,e,l),l,i)}var l;return E.B(function(){var e=E.a.c(t)||[];void 0===e.length&&(e=[e]),e=E.a.Ma(e,function(e){return i.includeDestroyed||e===Ccl||null===e||!E.a.c(e._destroy)}),E.l.w(E.a.Db,null,[n,e,s,i,a])},null,{i:n})};var a=E.a.e.J();E.d.template={init:function(e,t){var r=E.a.c(t());if("string"==typeof r||r.name)E.f.za(e);else{if("nodes"in r){if(r=r.nodes||[],E.I(r))throw Error('The "nodes" option must be a plain, non-observable array.')}else r=E.f.childNodes(e);r=E.a.nc(r),new E.v.sa(e).nodes(r)}return{controlsDescendantBindings:!0}},update:function(e,t,r,i,n){var o=t();r=!0,i=null,"string"==typeof(t=E.a.c(o))?t={}:(o=t.name,"if"in t&&(r=E.a.c(t.if)),r&&"ifnot"in t&&(r=!E.a.c(t.ifnot))),"foreach"in t?i=E.pd(o||e,r&&t.foreach||[],t,e,n):r?(n="data"in t?n.ac(t.data,t.as):n,i=E.Cb(o||e,n,t,e)):E.f.za(e),n=i,(t=E.a.e.get(e,a))&&"function"==typeof t.k&&t.k(),E.a.e.set(e,a,n&&n.ca()?n:Ccl)}},E.h.va.template=function(e){return 1==(e=E.h.Ab(e)).length&&e[0].unknown||E.h.fd(e,"name")?null:"This template engine does not support anonymous templates nested within its templates"},E.f.aa.template=!0}(),E.b("setTemplateEngine",E.Fb),E.b("renderTemplate",E.Cb),E.a.hc=function(e,t,r){var i,n,o,a,s;if(e.length&&t.length)for(i=n=0;(!r||i<r)&&(a=e[n]);++n){for(o=0;s=t[o];++o)if(a.value===s.value){a.moved=s.index,s.moved=a.index,t.splice(o,1),i=o=0;break}i+=o}},E.a.lb=function(){function i(e,t,r,i,n){var o,a,s,l,u,c=Math.min,d=Math.max,h=[],p=e.length,f=t.length,m=f-p||1,g=p+f+1;for(o=0;o<=p;o++)for(l=s,h.push(s=[]),u=c(f,o+m),a=d(0,o-1);a<=u;a++)s[a]=a?o?e[o-1]===t[a-1]?l[a-1]:c(l[a]||g,s[a-1]||g)+1:a+1:o+1;for(c=[],d=[],m=[],o=p,a=f;o||a;)f=h[o][a]-1,a&&f===h[o][a-1]?d.push(c[c.length]={status:r,value:t[--a],index:a}):o&&f===h[o-1][a]?m.push(c[c.length]={status:i,value:e[--o],index:o}):(--a,--o,n.sparse||c.push({status:"retained",value:t[a]}));return E.a.hc(m,d,!n.dontLimitMoves&&10*p),c.reverse()}return function(e,t,r){return r="boolean"==typeof r?{dontLimitMoves:r}:r||{},t=t||[],(e=e||[]).length<t.length?i(e,t,"added","deleted",r):i(t,e,"deleted","added",r)}}(),E.b("utils.compareArrays",E.a.lb),function(){function w(t,r,i,n,o){var a=[],e=E.B(function(){var e=r(i,o,E.a.Ba(a,t))||[];0<a.length&&(E.a.uc(a,e),n&&E.l.w(n,null,[i,e,o])),a.length=0,E.a.ta(a,e)},null,{i:t,ya:function(){return!E.a.Tb(a)}});return{ea:a,B:e.ca()?e:Ccl}}var S=E.a.e.J(),T=E.a.e.J();E.a.Db=function(r,e,t,i,n){function o(e,t){_=u[t],f!==t&&(b[e]=_),_.tb(f++),E.a.Ba(_.ea,r),h.push(_),g.push(_)}function a(t,r){if(t)for(var i=0,e=r.length;i<e;i++)r[i]&&E.a.r(r[i].ea,function(e){t(e,i,r[i].ka)})}e=e||[],i=i||{};var s,l=E.a.e.get(r,S)===Ccl,u=E.a.e.get(r,S)||[],c=E.a.ib(u,function(e){return e.ka}),d=E.a.lb(c,e,i.dontLimitMoves),h=[],p=0,f=0,m=[],g=[];e=[];for(var _,v,y,b=[],C=(c=[],0);v=d[C];C++)switch(y=v.moved,v.status){case"deleted":y===Ccl&&((_=u[p]).B&&(_.B.k(),_.B=Ccl),E.a.Ba(_.ea,r).length&&(i.beforeRemove&&(h.push(_),g.push(_),_.ka===T?_=null:e[C]=_),_&&m.push.apply(m,_.ea))),p++;break;case"retained":o(C,p++);break;case"added":y!==Ccl?o(C,y):(_={ka:v.value,tb:E.O(f++)},h.push(_),g.push(_),l||(c[C]=_))}for(E.a.e.set(r,S,h),a(i.beforeMove,b),E.a.r(m,i.beforeRemove?E.ba:E.removeNode),C=0,l=E.f.firstChild(r);_=g[C];C++){for(_.ea||E.a.extend(_,w(r,t,_.ka,n,_.tb)),p=0;d=_.ea[p];l=d.nextSibling,s=d,p++)d!==l&&E.f.kc(r,d,s);!_.ad&&n&&(n(_.ka,_.ea,_.tb),_.ad=!0)}for(a(i.beforeRemove,e),C=0;C<e.length;++C)e[C]&&(e[C].ka=T);a(i.afterMove,b),a(i.afterAdd,c)}}(),E.b("utils.setDomNodeChildrenFromArrayMapping",E.a.Db),E.X=function(){this.allowTemplateRewriting=!1},E.X.prototype=new E.P,E.X.prototype.renderTemplateSource=function(e,t,r,i){return(t=E.a.C<9||!e.nodes?null:e.nodes())?E.a.W(t.cloneNode(!0).childNodes):(e=e.text(),E.a.na(e,i))},E.X.vb=new E.X,E.Fb(E.X.vb),E.b("nativeTemplateEngine",E.X),function(){E.xb=function(){var o=this.ed=function(){if(!Gcl||!Gcl.tmpl)return 0;try{if(0<=Gcl.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(e){}return 1}();this.renderTemplateSource=function(e,t,r,i){if(i=i||Ecl,r=r||{},o<2)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var n=e.data("precompiled");return n||(n=e.text()||"",n=Gcl.template(null,"{{ko_with $item.koBindingContext}}"+n+"{{/ko_with}}"),e.data("precompiled",n)),e=[t.$data],t=Gcl.extend({koBindingContext:t},r.templateOptions),(t=Gcl.tmpl(n,e,t)).appendTo(i.createElement("div")),Gcl.fragments={},t},this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"},this.addTemplate=function(e,t){Ecl.write("<script type='text/html' id='"+e+"'>"+t+"<\/script>")},0<o&&(Gcl.tmpl.tag.ko_code={open:"__.push($1 || '');"},Gcl.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},E.xb.prototype=new E.P;var e=new E.xb;0<e.ed&&E.Fb(e),E.b("jqueryTmplTemplateEngine",E.xb)}()},"function"==typeof define&&define.amd?define("ThirdParty/knockout-3.4.2",["exports","require"],Icl):"object"==typeof exports&&"object"==typeof module?Icl(module.exports||exports):Icl(Dcl.ko={})}(),define("ThirdParty/knockout-es5",[],function(){"use strict";var c="__knockoutObservables",d="__knockoutSubscribable";function n(s,e){if(!s)throw new Error("When calling ko.track, you must pass an object as the first parameter.");var l=this,u=i(s,!0);return(e=e||Object.getOwnPropertyNames(s)).forEach(function(e){if(e!==c&&e!==d&&!(e in u)){var r,i,n,t=s[e],o=t instanceof Array,a=l.isObservable(t)?t:o?l.observableArray(t):l.observable(t);Object.defineProperty(s,e,{configurable:!0,enumerable:!0,get:a,set:l.isWriteableObservable(a)?a:void 0}),u[e]=a,o&&(i=a,n=null,(r=l).computed(function(){n&&(n.dispose(),n=null);var e,t=i();t instanceof Array&&(e=i,n=function(e,t){var r,i,n,o,a,s,l,u=t[d];if(!u){u=new e.subscribable,Object.defineProperty(t,d,{value:u});var c={};a=t,s=u,l=c,["pop","push","reverse","shift","sort","splice","unshift"].forEach(function(e){var t=a[e];a[e]=function(){var e=t.apply(this,arguments);return!0!==l.pause&&s.notifySubscribers(this),e}}),r=e,i=t,n=u,o=c,["remove","removeAll","destroy","destroyAll","replace"].forEach(function(t){Object.defineProperty(i,t,{enumerable:!1,value:function(){var e;o.pause=!0;try{e=r.observableArray.fn[t].apply(r.observableArray(i),arguments)}finally{o.pause=!1}return n.notifySubscribers(i),e}})})}return u}(r,t).subscribe(e))}))}}),s}function i(e,t){var r=e[c];return!r&&t&&(r={},Object.defineProperty(e,c,{value:r})),r}function t(e,t,r){var i={owner:e,deferEvaluation:!0};if("function"==typeof r)i.read=r;else{if("value"in r)throw new Error('For ko.defineProperty, you must not specify a "value" for the property. You must provide a "get" function.');if("function"!=typeof r.get)throw new Error('For ko.defineProperty, the third parameter must be either an evaluator function, or an options object containing a function called "get".');i.read=r.get,i.write=r.set}return e[t]=this.computed(i),n.call(this,e,[t]),e}function o(e,t){if(!e)return null;var r=i(e,!1);return r&&r[t]||null}function r(e,t){var r=o(e,t);r&&r.valueHasMutated()}return{attachToKo:function(e){e.track=n,e.getObservable=o,e.valueHasMutated=r,e.defineProperty=t}}}),define("Widgets/SvgPathBindingHandler",[],function(){"use strict";var t="http://www.w3.org/2000/svg",s="cesium-svgPath-svg";return{register:function(a){a.bindingHandlers.cesiumSvgPath={init:function(e,i){var n=document.createElementNS(t,"svg:svg");n.setAttribute("class",s);var o=document.createElementNS(t,"path");return n.appendChild(o),a.virtualElements.setDomNodeChildren(e,[n]),a.computed({read:function(){var e=a.unwrap(i());o.setAttribute("d",a.unwrap(e.path));var t=a.unwrap(e.width),r=a.unwrap(e.height);n.setAttribute("width",t),n.setAttribute("height",r),n.setAttribute("viewBox","0 0 "+t+" "+r),e.css&&n.setAttribute("class",s+" "+a.unwrap(e.css))},disposeWhenNodeIsRemoved:e}),{controlsDescendantBindings:!0}}},a.virtualElements.allowedBindings.cesiumSvgPath=!0}}}),define("ThirdParty/knockout",["./knockout-3.4.2","./knockout-es5","../Widgets/SvgPathBindingHandler"],function(e,t,r){"use strict";return t.attachToKo(e),r.register(e),e}),ZBl=this,$Bl=function(){return function(r){var i={};function n(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}return n.m=r,n.c=i,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,r){"use strict";var i=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}}();var n=r(1),o="undefined"!=typeof navigator&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",n),this.noSleepVideo.addEventListener("timeupdate",function(e){.5<this.noSleepVideo.currentTime&&(this.noSleepVideo.currentTime=Math.random())}.bind(this)))}return i(e,[{key:"enable",value:function(){o?(this.disable(),this.noSleepTimer=window.setInterval(function(){window.location.href="/",window.setTimeout(window.stop,0)},15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){o?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),e}();e.exports=a},function(e,t,r){"use strict";e.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])},"object"==typeof exports&&"object"==typeof module?module.exports=$Bl():"function"==typeof define&&define.amd?define("ThirdParty/NoSleep",[],$Bl):"object"==typeof exports?exports.NoSleep=$Bl():ZBl.NoSleep=$Bl(),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("ThirdParty/pako_inflate",[],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).pako=e()}}(function(){return function o(a,s,l){function u(r,e){if(!s[r]){if(!a[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(c)return c(r,!0);var i=new Error("Cannot find module '"+r+"'");throw i.code="MODULE_NOT_FOUND",i}var n=s[r]={exports:{}};a[r][0].call(n.exports,function(e){var t=a[r][1][e];return u(t||e)},n,n.exports,o,a,s,l)}return s[r].exports}for(var c="function"==typeof require&&require,e=0;e<l.length;e++)u(l[e]);return u}({1:[function(e,t,r){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}}return e},r.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var n={arraySet:function(e,t,r,i,n){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+i),n);else for(var o=0;o<i;o++)e[n+o]=t[r+o]},flattenChunks:function(e){var t,r,i,n,o,a;for(t=i=0,r=e.length;t<r;t++)i+=e[t].length;for(a=new Uint8Array(i),t=n=0,r=e.length;t<r;t++)o=e[t],a.set(o,n),n+=o.length;return a}},o={arraySet:function(e,t,r,i,n){for(var o=0;o<i;o++)e[n+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){e?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,n)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,o))},r.setTyped(i)},{}],2:[function(e,t,r){"use strict";var l=e("./common"),n=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var u=new l.Buf8(256),i=0;i<256;i++)u[i]=252<=i?6:248<=i?5:240<=i?4:224<=i?3:192<=i?2:1;function c(e,t){if(t<65537&&(e.subarray&&o||!e.subarray&&n))return String.fromCharCode.apply(null,l.shrinkBuf(e,t));for(var r="",i=0;i<t;i++)r+=String.fromCharCode(e[i]);return r}u[254]=u[254]=1,r.string2buf=function(e){var t,r,i,n,o,a=e.length,s=0;for(n=0;n<a;n++)55296==(64512&(r=e.charCodeAt(n)))&&n+1<a&&56320==(64512&(i=e.charCodeAt(n+1)))&&(r=65536+(r-55296<<10)+(i-56320),n++),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new l.Buf8(s),n=o=0;o<s;n++)55296==(64512&(r=e.charCodeAt(n)))&&n+1<a&&56320==(64512&(i=e.charCodeAt(n+1)))&&(r=65536+(r-55296<<10)+(i-56320),n++),t[o++]=r<128?r:(t[o++]=r<2048?192|r>>>6:(t[o++]=r<65536?224|r>>>12:(t[o++]=240|r>>>18,128|r>>>12&63),128|r>>>6&63),128|63&r);return t},r.buf2binstring=function(e){return c(e,e.length)},r.binstring2buf=function(e){for(var t=new l.Buf8(e.length),r=0,i=t.length;r<i;r++)t[r]=e.charCodeAt(r);return t},r.buf2string=function(e,t){var r,i,n,o,a=t||e.length,s=new Array(2*a);for(r=i=0;r<a;)if((n=e[r++])<128)s[i++]=n;else if(4<(o=u[n]))s[i++]=65533,r+=o-1;else{for(n&=2===o?31:3===o?15:7;1<o&&r<a;)n=n<<6|63&e[r++],o--;s[i++]=1<o?65533:n<65536?n:(n-=65536,s[i++]=55296|n>>10&1023,56320|1023&n)}return c(s,i)},r.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0?t:0===r?t:r+u[e[r]]>t?r:t}},{"./common":1}],3:[function(e,t,r){"use strict";t.exports=function(e,t,r,i){for(var n=65535&e|0,o=e>>>16&65535|0,a=0;0!==r;){for(r-=a=2e3<r?2e3:r;o=o+(n=n+t[i++]|0)|0,--a;);n%=65521,o%=65521}return n|o<<16|0}},{}],4:[function(e,t,r){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],5:[function(e,t,r){"use strict";var s=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t,r,i){var n=s,o=i+r;e^=-1;for(var a=i;a<o;a++)e=e>>>8^n[255&(e^t[a])];return-1^e}},{}],6:[function(e,t,r){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],7:[function(e,t,r){"use strict";t.exports=function(e,t){var r,i,n,o,a,s,l,u,c,d,h,p,f,m,g,_,v,y,b,C,w,S,T,E,A;r=e.state,i=e.next_in,E=e.input,n=i+(e.avail_in-5),o=e.next_out,A=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),l=r.dmax,u=r.wsize,c=r.whave,d=r.wnext,h=r.window,p=r.hold,f=r.bits,m=r.lencode,g=r.distcode,_=(1<<r.lenbits)-1,v=(1<<r.distbits)-1;e:do{f<15&&(p+=E[i++]<<f,f+=8,p+=E[i++]<<f,f+=8),y=m[p&_];t:for(;;){if(p>>>=b=y>>>24,f-=b,0===(b=y>>>16&255))A[o++]=65535&y;else{if(!(16&b)){if(0==(64&b)){y=m[(65535&y)+(p&(1<<b)-1)];continue t}if(32&b){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}C=65535&y,(b&=15)&&(f<b&&(p+=E[i++]<<f,f+=8),C+=p&(1<<b)-1,p>>>=b,f-=b),f<15&&(p+=E[i++]<<f,f+=8,p+=E[i++]<<f,f+=8),y=g[p&v];r:for(;;){if(p>>>=b=y>>>24,f-=b,!(16&(b=y>>>16&255))){if(0==(64&b)){y=g[(65535&y)+(p&(1<<b)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(w=65535&y,f<(b&=15)&&(p+=E[i++]<<f,(f+=8)<b&&(p+=E[i++]<<f,f+=8)),l<(w+=p&(1<<b)-1)){e.msg="invalid distance too far back",r.mode=30;break e}if(p>>>=b,f-=b,(b=o-a)<w){if(c<(b=w-b)&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(T=h,(S=0)===d){if(S+=u-b,b<C){for(C-=b;A[o++]=h[S++],--b;);S=o-w,T=A}}else if(d<b){if(S+=u+d-b,(b-=d)<C){for(C-=b;A[o++]=h[S++],--b;);if(S=0,d<C){for(C-=b=d;A[o++]=h[S++],--b;);S=o-w,T=A}}}else if(S+=d-b,b<C){for(C-=b;A[o++]=h[S++],--b;);S=o-w,T=A}for(;2<C;)A[o++]=T[S++],A[o++]=T[S++],A[o++]=T[S++],C-=3;C&&(A[o++]=T[S++],1<C&&(A[o++]=T[S++]))}else{for(S=o-w;A[o++]=A[S++],A[o++]=A[S++],A[o++]=A[S++],2<(C-=3););C&&(A[o++]=A[S++],1<C&&(A[o++]=A[S++]))}break}}break}}while(i<n&&o<s);i-=C=f>>3,p&=(1<<(f-=C<<3))-1,e.next_in=i,e.next_out=o,e.avail_in=i<n?n-i+5:5-(i-n),e.avail_out=o<s?s-o+257:257-(o-s),r.hold=p,r.bits=f}},{}],8:[function(e,t,r){"use strict";var D=e("../utils/common"),O=e("./adler32"),I=e("./crc32"),M=e("./inffast"),R=e("./inftrees"),L=1,N=2,k=0,F=-2,B=1,i=852,n=592;function U(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function o(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new D.Buf16(320),this.work=new D.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function a(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=B,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new D.Buf32(i),t.distcode=t.distdyn=new D.Buf32(n),t.sane=1,t.back=-1,k):F}function s(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,a(e)):F}function l(e,t){var r,i;return e&&e.state?(i=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?F:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=r,i.wbits=t,s(e))):F}function u(e,t){var r,i;return e?(i=new o,(e.state=i).window=null,(r=l(e,t))!==k&&(e.state=null),r):F}var c,d,h=!0;function V(e){if(h){var t;for(c=new D.Buf32(512),d=new D.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(R(L,e.lens,0,288,c,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;R(N,e.lens,0,32,d,0,e.work,{bits:5}),h=!1}e.lencode=c,e.lenbits=9,e.distcode=d,e.distbits=5}function z(e,t,r,i){var n,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new D.Buf8(o.wsize)),i>=o.wsize?(D.arraySet(o.window,t,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(i<(n=o.wsize-o.wnext)&&(n=i),D.arraySet(o.window,t,r-i,n,o.wnext),(i-=n)?(D.arraySet(o.window,t,r-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=n,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=n))),0}r.inflateReset=s,r.inflateReset2=l,r.inflateResetKeep=a,r.inflateInit=function(e){return u(e,15)},r.inflateInit2=u,r.inflate=function(e,t){var r,i,n,o,a,s,l,u,c,d,h,p,f,m,g,_,v,y,b,C,w,S,T,E,A=0,x=new D.Buf8(4),P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return F;12===(r=e.state).mode&&(r.mode=13),a=e.next_out,n=e.output,l=e.avail_out,o=e.next_in,i=e.input,s=e.avail_in,u=r.hold,c=r.bits,d=s,h=l,S=k;e:for(;;)switch(r.mode){case B:if(0===r.wrap){r.mode=13;break}for(;c<16;){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}if(2&r.wrap&&35615===u){x[r.check=0]=255&u,x[1]=u>>>8&255,r.check=I(r.check,x,2,0),c=u=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&u)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!=(15&u)){e.msg="unknown compression method",r.mode=30;break}if(c-=4,w=8+(15&(u>>>=4)),0===r.wbits)r.wbits=w;else if(w>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<w,e.adler=r.check=1,r.mode=512&u?10:12,c=u=0;break;case 2:for(;c<16;){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}if(r.flags=u,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=u>>8&1),512&r.flags&&(x[0]=255&u,x[1]=u>>>8&255,r.check=I(r.check,x,2,0)),c=u=0,r.mode=3;case 3:for(;c<32;){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}r.head&&(r.head.time=u),512&r.flags&&(x[0]=255&u,x[1]=u>>>8&255,x[2]=u>>>16&255,x[3]=u>>>24&255,r.check=I(r.check,x,4,0)),c=u=0,r.mode=4;case 4:for(;c<16;){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}r.head&&(r.head.xflags=255&u,r.head.os=u>>8),512&r.flags&&(x[0]=255&u,x[1]=u>>>8&255,r.check=I(r.check,x,2,0)),c=u=0,r.mode=5;case 5:if(1024&r.flags){for(;c<16;){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}r.length=u,r.head&&(r.head.extra_len=u),512&r.flags&&(x[0]=255&u,x[1]=u>>>8&255,r.check=I(r.check,x,2,0)),c=u=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(s<(p=r.length)&&(p=s),p&&(r.head&&(w=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),D.arraySet(r.head.extra,i,o,p,w)),512&r.flags&&(r.check=I(r.check,i,p,o)),s-=p,o+=p,r.length-=p),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===s)break e;for(p=0;w=i[o+p++],r.head&&w&&r.length<65536&&(r.head.name+=String.fromCharCode(w)),w&&p<s;);if(512&r.flags&&(r.check=I(r.check,i,p,o)),s-=p,o+=p,w)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===s)break e;for(p=0;w=i[o+p++],r.head&&w&&r.length<65536&&(r.head.comment+=String.fromCharCode(w)),w&&p<s;);if(512&r.flags&&(r.check=I(r.check,i,p,o)),s-=p,o+=p,w)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;c<16;){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}if(u!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}c=u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;c<32;){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}e.adler=r.check=U(u),c=u=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=u,r.bits=c,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){u>>>=7&c,c-=7&c,r.mode=27;break}for(;c<3;){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}switch(r.last=1&u,c-=1,3&(u>>>=1)){case 0:r.mode=14;break;case 1:if(V(r),r.mode=20,6!==t)break;u>>>=2,c-=2;break e;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}u>>>=2,c-=2;break;case 14:for(u>>>=7&c,c-=7&c;c<32;){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}if((65535&u)!=(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&u,c=u=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(p=r.length){if(s<p&&(p=s),l<p&&(p=l),0===p)break e;D.arraySet(n,i,o,p,a),s-=p,o+=p,l-=p,a+=p,r.length-=p;break}r.mode=12;break;case 17:for(;c<14;){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}if(r.nlen=257+(31&u),u>>>=5,c-=5,r.ndist=1+(31&u),u>>>=5,c-=5,r.ncode=4+(15&u),u>>>=4,c-=4,286<r.nlen||30<r.ndist){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;c<3;){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}r.lens[P[r.have++]]=7&u,u>>>=3,c-=3}for(;r.have<19;)r.lens[P[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,T={bits:r.lenbits},S=R(0,r.lens,0,19,r.lencode,0,r.work,T),r.lenbits=T.bits,S){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;_=(A=r.lencode[u&(1<<r.lenbits)-1])>>>16&255,v=65535&A,!((g=A>>>24)<=c);){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}if(v<16)u>>>=g,c-=g,r.lens[r.have++]=v;else{if(16===v){for(E=g+2;c<E;){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}if(u>>>=g,c-=g,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}w=r.lens[r.have-1],p=3+(3&u),u>>>=2,c-=2}else if(17===v){for(E=g+3;c<E;){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}c-=g,w=0,p=3+(7&(u>>>=g)),u>>>=3,c-=3}else{for(E=g+7;c<E;){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}c-=g,w=0,p=11+(127&(u>>>=g)),u>>>=7,c-=7}if(r.have+p>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;p--;)r.lens[r.have++]=w}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,T={bits:r.lenbits},S=R(L,r.lens,0,r.nlen,r.lencode,0,r.work,T),r.lenbits=T.bits,S){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,T={bits:r.distbits},S=R(N,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,T),r.distbits=T.bits,S){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(6<=s&&258<=l){e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=u,r.bits=c,M(e,h),a=e.next_out,n=e.output,l=e.avail_out,o=e.next_in,i=e.input,s=e.avail_in,u=r.hold,c=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;_=(A=r.lencode[u&(1<<r.lenbits)-1])>>>16&255,v=65535&A,!((g=A>>>24)<=c);){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}if(_&&0==(240&_)){for(y=g,b=_,C=v;_=(A=r.lencode[C+((u&(1<<y+b)-1)>>y)])>>>16&255,v=65535&A,!(y+(g=A>>>24)<=c);){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}u>>>=y,c-=y,r.back+=y}if(u>>>=g,c-=g,r.back+=g,r.length=v,0===_){r.mode=26;break}if(32&_){r.back=-1,r.mode=12;break}if(64&_){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&_,r.mode=22;case 22:if(r.extra){for(E=r.extra;c<E;){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,c-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;_=(A=r.distcode[u&(1<<r.distbits)-1])>>>16&255,v=65535&A,!((g=A>>>24)<=c);){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}if(0==(240&_)){for(y=g,b=_,C=v;_=(A=r.distcode[C+((u&(1<<y+b)-1)>>y)])>>>16&255,v=65535&A,!(y+(g=A>>>24)<=c);){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}u>>>=y,c-=y,r.back+=y}if(u>>>=g,c-=g,r.back+=g,64&_){e.msg="invalid distance code",r.mode=30;break}r.offset=v,r.extra=15&_,r.mode=24;case 24:if(r.extra){for(E=r.extra;c<E;){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,c-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===l)break e;if(p=h-l,r.offset>p){if((p=r.offset-p)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}f=p>r.wnext?(p-=r.wnext,r.wsize-p):r.wnext-p,p>r.length&&(p=r.length),m=r.window}else m=n,f=a-r.offset,p=r.length;for(l<p&&(p=l),l-=p,r.length-=p;n[a++]=m[f++],--p;);0===r.length&&(r.mode=21);break;case 26:if(0===l)break e;n[a++]=r.length,l--,r.mode=21;break;case 27:if(r.wrap){for(;c<32;){if(0===s)break e;s--,u|=i[o++]<<c,c+=8}if(h-=l,e.total_out+=h,r.total+=h,h&&(e.adler=r.check=r.flags?I(r.check,n,h,a-h):O(r.check,n,h,a-h)),h=l,(r.flags?u:U(u))!==r.check){e.msg="incorrect data check",r.mode=30;break}c=u=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;c<32;){if(0===s)break e;s--,u+=i[o++]<<c,c+=8}if(u!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}c=u=0}r.mode=29;case 29:S=1;break e;case 30:S=-3;break e;case 31:return-4;case 32:default:return F}return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=u,r.bits=c,(r.wsize||h!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&z(e,e.output,e.next_out,h-e.avail_out)?(r.mode=31,-4):(d-=e.avail_in,h-=e.avail_out,e.total_in+=d,e.total_out+=h,r.total+=h,r.wrap&&h&&(e.adler=r.check=r.flags?I(r.check,n,h,e.next_out-h):O(r.check,n,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0===d&&0===h||4===t)&&S===k&&(S=-5),S)},r.inflateEnd=function(e){if(!e||!e.state)return F;var t=e.state;return t.window&&(t.window=null),e.state=null,k},r.inflateGetHeader=function(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?F:((r.head=t).done=!1,k):F},r.inflateSetDictionary=function(e,t){var r,i=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?F:11===r.mode&&O(1,t,i,0)!==r.check?-3:z(e,t,i,i)?(r.mode=31,-4):(r.havedict=1,k):F},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":1,"./adler32":3,"./crc32":5,"./inffast":7,"./inftrees":9}],9:[function(e,t,r){"use strict";var L=e("../utils/common"),N=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],k=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],F=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],B=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,r,i,n,o,a,s){var l,u,c,d,h,p,f,m,g,_=s.bits,v=0,y=0,b=0,C=0,w=0,S=0,T=0,E=0,A=0,x=0,P=null,D=0,O=new L.Buf16(16),I=new L.Buf16(16),M=null,R=0;for(v=0;v<=15;v++)O[v]=0;for(y=0;y<i;y++)O[t[r+y]]++;for(w=_,C=15;1<=C&&0===O[C];C--);if(C<w&&(w=C),0===C)return n[o++]=20971520,n[o++]=20971520,s.bits=1,0;for(b=1;b<C&&0===O[b];b++);for(w<b&&(w=b),v=E=1;v<=15;v++)if(E<<=1,(E-=O[v])<0)return-1;if(0<E&&(0===e||1!==C))return-1;for(I[1]=0,v=1;v<15;v++)I[v+1]=I[v]+O[v];for(y=0;y<i;y++)0!==t[r+y]&&(a[I[t[r+y]]++]=y);if(p=0===e?(P=M=a,19):1===e?(P=N,D-=257,M=k,R-=257,256):(P=F,M=B,-1),v=b,h=o,T=y=x=0,c=-1,d=(A=1<<(S=w))-1,1===e&&852<A||2===e&&592<A)return 1;for(;;){for(f=v-T,g=a[y]<p?(m=0,a[y]):a[y]>p?(m=M[R+a[y]],P[D+a[y]]):(m=96,0),l=1<<v-T,b=u=1<<S;n[h+(x>>T)+(u-=l)]=f<<24|m<<16|g|0,0!==u;);for(l=1<<v-1;x&l;)l>>=1;if(0!==l?(x&=l-1,x+=l):x=0,y++,0==--O[v]){if(v===C)break;v=t[r+a[y]]}if(w<v&&(x&d)!==c){for(0===T&&(T=w),h+=b,E=1<<(S=v-T);S+T<C&&!((E-=O[S+T])<=0);)S++,E<<=1;if(A+=1<<S,1===e&&852<A||2===e&&592<A)return 1;n[c=x&d]=w<<24|S<<16|h-o|0}}return 0!==x&&(n[h+x]=v-T<<24|64<<16|0),s.bits=w,0}},{"../utils/common":1}],10:[function(e,t,r){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],11:[function(e,t,r){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],"/lib/inflate.js":[function(e,t,r){"use strict";var h=e("./zlib/inflate"),p=e("./utils/common"),f=e("./utils/strings"),m=e("./zlib/constants"),i=e("./zlib/messages"),n=e("./zlib/zstream"),o=e("./zlib/gzheader"),g=Object.prototype.toString;function a(e){if(!(this instanceof a))return new a(e);this.options=p.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new n,this.strm.avail_out=0;var r=h.inflateInit2(this.strm,t.windowBits);if(r!==m.Z_OK)throw new Error(i[r]);this.header=new o,h.inflateGetHeader(this.strm,this.header)}function s(e,t){var r=new a(t);if(r.push(e,!0),r.err)throw r.msg||i[r.err];return r.result}a.prototype.push=function(e,t){var r,i,n,o,a,s,l=this.strm,u=this.options.chunkSize,c=this.options.dictionary,d=!1;if(this.ended)return!1;i=t===~~t?t:!0===t?m.Z_FINISH:m.Z_NO_FLUSH,"string"==typeof e?l.input=f.binstring2buf(e):"[object ArrayBuffer]"===g.call(e)?l.input=new Uint8Array(e):l.input=e,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new p.Buf8(u),l.next_out=0,l.avail_out=u),(r=h.inflate(l,m.Z_NO_FLUSH))===m.Z_NEED_DICT&&c&&(s="string"==typeof c?f.string2buf(c):"[object ArrayBuffer]"===g.call(c)?new Uint8Array(c):c,r=h.inflateSetDictionary(this.strm,s)),r===m.Z_BUF_ERROR&&!0===d&&(r=m.Z_OK,d=!1),r!==m.Z_STREAM_END&&r!==m.Z_OK)return this.onEnd(r),!(this.ended=!0);l.next_out&&(0!==l.avail_out&&r!==m.Z_STREAM_END&&(0!==l.avail_in||i!==m.Z_FINISH&&i!==m.Z_SYNC_FLUSH)||("string"===this.options.to?(n=f.utf8border(l.output,l.next_out),o=l.next_out-n,a=f.buf2string(l.output,n),l.next_out=o,l.avail_out=u-o,o&&p.arraySet(l.output,l.output,n,o,0),this.onData(a)):this.onData(p.shrinkBuf(l.output,l.next_out)))),0===l.avail_in&&0===l.avail_out&&(d=!0)}while((0<l.avail_in||0===l.avail_out)&&r!==m.Z_STREAM_END);return r===m.Z_STREAM_END&&(i=m.Z_FINISH),i===m.Z_FINISH?(r=h.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===m.Z_OK):i!==m.Z_SYNC_FLUSH||(this.onEnd(m.Z_OK),!(l.avail_out=0))},a.prototype.onData=function(e){this.chunks.push(e)},a.prototype.onEnd=function(e){e===m.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=p.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Inflate=a,r.inflate=s,r.inflateRaw=function(e,t){return(t=t||{}).raw=!0,s(e,t)},r.ungzip=s},{"./utils/common":1,"./utils/strings":2,"./zlib/constants":4,"./zlib/gzheader":6,"./zlib/inflate":8,"./zlib/messages":10,"./zlib/zstream":11}]},{},[])("/lib/inflate.js")}),define("Widgets/subscribeAndEvaluate",["../ThirdParty/knockout"],function(o){"use strict";return function(e,t,r,i,n){return r.call(i,e[t]),o.getObservable(e,t).subscribe(r,i,n)}}),define("Widgets/Animation/Animation",["../../Core/Color","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../getElement","../subscribeAndEvaluate"],function(t,y,e,n,b,C,w){"use strict";var S,T="http://www.w3.org/2000/svg",E="http://www.w3.org/1999/xlink",c=t.fromCssColorString("rgba(247,250,255,0.384)"),d=t.fromCssColorString("rgba(143,191,255,0.216)"),h=t.fromCssColorString("rgba(153,197,255,0.098)"),p=t.fromCssColorString("rgba(255,255,255,0.086)"),f=t.fromCssColorString("rgba(255,255,255,0.267)"),m=t.fromCssColorString("rgba(255,255,255,0)"),g=t.fromCssColorString("rgba(66,67,68,0.3)"),_=t.fromCssColorString("rgba(0,0,0,0.5)");function v(e){return t.fromCssColorString(window.getComputedStyle(e).getPropertyValue("color"))}function A(e){var t=document.createElementNS(T,e.tagName);for(var r in e)if(e.hasOwnProperty(r)&&"tagName"!==r)if("children"===r){var i,n=e.children.length;for(i=0;i<n;++i)t.appendChild(A(e.children[i]))}else 0===r.indexOf("xlink:")?t.setAttributeNS(E,r.substring(6),e[r]):"textContent"===r?t.textContent=e[r]:t.setAttribute(r,e[r]);return t}function x(e,t,r){var i=document.createElementNS(T,"text");i.setAttribute("x",e),i.setAttribute("y",t),i.setAttribute("class","cesium-animation-svgText");var n=document.createElementNS(T,"tspan");return n.textContent=r,i.appendChild(n),i}var o=new t;function P(e,t){var r=t.alpha,i=1-r;return o.red=e.red*i+t.red*r,o.green=e.green*i+t.green*r,o.blue=e.blue*i+t.blue*r,o.toCssColorString()}function D(e,t,r){return A({tagName:"g",class:"cesium-animation-rectButton",transform:"translate("+e+","+t+")",children:[{tagName:"rect",class:"cesium-animation-buttonGlow",width:32,height:32,rx:2,ry:2},{tagName:"rect",class:"cesium-animation-buttonMain",width:32,height:32,rx:4,ry:4},{tagName:"use",class:"cesium-animation-buttonPath","xlink:href":r},{tagName:"title",textContent:""}]})}function O(e,t){this._viewModel=t,this.svgElement=e,this._enabled=void 0,this._toggled=void 0;var r=this;this._clickFunction=function(){var e=r._viewModel.command;e.canExecute&&e()},e.addEventListener("click",this._clickFunction,!0),this._subscriptions=[w(t,"toggled",this.setToggled,this),w(t,"tooltip",this.setTooltip,this),w(t.command,"canExecute",this.setEnabled,this)]}function r(e,t){if(!y(e))throw new b("container is required.");if(!y(t))throw new b("viewModel is required.");e=C(e),this._viewModel=t,this._container=e,this._centerX=0,this._centerY=0,this._defsElement=void 0,this._svgNode=void 0,this._topG=void 0,this._lastHeight=void 0,this._lastWidth=void 0;var r=document.createElement("style");r.textContent=".cesium-animation-rectButton .cesium-animation-buttonGlow { filter: url(#animation_blurred); }.cesium-animation-rectButton .cesium-animation-buttonMain { fill: url(#animation_buttonNormal); }.cesium-animation-buttonToggled .cesium-animation-buttonMain { fill: url(#animation_buttonToggled); }.cesium-animation-rectButton:hover .cesium-animation-buttonMain { fill: url(#animation_buttonHovered); }.cesium-animation-buttonDisabled .cesium-animation-buttonMain { fill: url(#animation_buttonDisabled); }.cesium-animation-shuttleRingG .cesium-animation-shuttleRingSwoosh { fill: url(#animation_shuttleRingSwooshGradient); }.cesium-animation-shuttleRingG:hover .cesium-animation-shuttleRingSwoosh { fill: url(#animation_shuttleRingSwooshHovered); }.cesium-animation-shuttleRingPointer { fill: url(#animation_shuttleRingPointerGradient); }.cesium-animation-shuttleRingPausePointer { fill: url(#animation_shuttleRingPointerPaused); }.cesium-animation-knobOuter { fill: url(#animation_knobOuter); }.cesium-animation-knobInner { fill: url(#animation_knobInner); }",document.head.insertBefore(r,document.head.childNodes[0]);var i=document.createElement("div");i.className="cesium-animation-theme",i.innerHTML='<div class="cesium-animation-themeNormal"></div><div class="cesium-animation-themeHover"></div><div class="cesium-animation-themeSelect"></div><div class="cesium-animation-themeDisabled"></div><div class="cesium-animation-themeKnob"></div><div class="cesium-animation-themePointer"></div><div class="cesium-animation-themeSwoosh"></div><div class="cesium-animation-themeSwooshHover"></div>',this._theme=i,this._themeNormal=i.childNodes[0],this._themeHover=i.childNodes[1],this._themeSelect=i.childNodes[2],this._themeDisabled=i.childNodes[3],this._themeKnob=i.childNodes[4],this._themePointer=i.childNodes[5],this._themeSwoosh=i.childNodes[6],this._themeSwooshHover=i.childNodes[7];var n=document.createElementNS(T,"svg:svg");(this._svgNode=n).setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink",E);var o=document.createElementNS(T,"g");this._topG=o,this._realtimeSVG=new O(A({tagName:"g",class:"cesium-animation-rectButton",transform:"translate("+3+","+4+")",children:[{tagName:"use",class:"cesium-animation-buttonGlow","xlink:href":"#animation_pathWingButton"},{tagName:"use",class:"cesium-animation-buttonMain","xlink:href":"#animation_pathWingButton"},{tagName:"use",class:"cesium-animation-buttonPath","xlink:href":"#animation_pathClock"},{tagName:"title",textContent:""}]}),t.playRealtimeViewModel),this._playReverseSVG=new O(D(44,99,"#animation_pathPlayReverse"),t.playReverseViewModel),this._playForwardSVG=new O(D(124,99,"#animation_pathPlay"),t.playForwardViewModel),this._pauseSVG=new O(D(84,99,"#animation_pathPause"),t.pauseViewModel);var a=document.createElementNS(T,"g");a.appendChild(this._realtimeSVG.svgElement),a.appendChild(this._playReverseSVG.svgElement),a.appendChild(this._playForwardSVG.svgElement),a.appendChild(this._pauseSVG.svgElement);var s=A({tagName:"circle",class:"cesium-animation-shuttleRingBack",cx:100,cy:100,r:99});this._shuttleRingBackPanel=s;var l=A({tagName:"g",class:"cesium-animation-shuttleRingSwoosh",children:[{tagName:"use",transform:"translate(100,97) scale(-1,1)","xlink:href":"#animation_pathSwooshFX"},{tagName:"use",transform:"translate(100,97)","xlink:href":"#animation_pathSwooshFX"},{tagName:"line",x1:100,y1:8,x2:100,y2:22}]});this._shuttleRingSwooshG=l,this._shuttleRingPointer=A({tagName:"use",class:"cesium-animation-shuttleRingPointer","xlink:href":"#animation_pathPointer"});var u=A({tagName:"g",transform:"translate(100,100)"});this._knobOuter=A({tagName:"circle",class:"cesium-animation-knobOuter",cx:0,cy:0,r:71});var c=A({tagName:"circle",class:"cesium-animation-knobInner",cx:0,cy:0,r:61});this._knobDate=x(0,-24,""),this._knobTime=x(0,-7,""),this._knobStatus=x(0,-41,"");var d=A({tagName:"circle",class:"cesium-animation-blank",cx:0,cy:0,r:61}),h=document.createElementNS(T,"g");h.setAttribute("class","cesium-animation-shuttleRingG"),e.appendChild(i),o.appendChild(h),o.appendChild(u),o.appendChild(a),h.appendChild(s),h.appendChild(l),h.appendChild(this._shuttleRingPointer),u.appendChild(this._knobOuter),u.appendChild(c),u.appendChild(this._knobDate),u.appendChild(this._knobTime),u.appendChild(this._knobStatus),u.appendChild(d),n.appendChild(o),e.appendChild(n);var p=this;function f(e){!function(e,t){var r=e._viewModel,i=r.shuttleRingDragging;if(!i||S===e)if("mousedown"===t.type||i&&"mousemove"===t.type||"touchstart"===t.type&&1===t.touches.length||i&&"touchmove"===t.type&&1===t.touches.length){var n,o,a=e._centerX,s=e._centerY,l=e._svgNode.getBoundingClientRect();if(o="touchstart"===t.type||"touchmove"===t.type?(n=t.touches[0].clientX,t.touches[0].clientY):(n=t.clientX,t.clientY),!i&&(n>l.right||n<l.left||o<l.top||o>l.bottom))return;var u=e._shuttleRingPointer.getBoundingClientRect(),c=n-a-l.left,d=o-s-l.top,h=180*Math.atan2(d,c)/Math.PI+90;180<h&&(h-=360);var p=r.shuttleRingAngle;i||n<u.right&&n>u.left&&o>u.top&&o<u.bottom?(S=e,r.shuttleRingDragging=!0,r.shuttleRingAngle=h):h<p?r.slower():p<h&&r.faster(),t.preventDefault()}else e===S&&(S=void 0),r.shuttleRingDragging=!1}(p,e)}this._mouseCallback=f,s.addEventListener("mousedown",f,!0),s.addEventListener("touchstart",f,!0),l.addEventListener("mousedown",f,!0),l.addEventListener("touchstart",f,!0),document.addEventListener("mousemove",f,!0),document.addEventListener("touchmove",f,!0),document.addEventListener("mouseup",f,!0),document.addEventListener("touchend",f,!0),document.addEventListener("touchcancel",f,!0),this._shuttleRingPointer.addEventListener("mousedown",f,!0),this._shuttleRingPointer.addEventListener("touchstart",f,!0),this._knobOuter.addEventListener("mousedown",f,!0),this._knobOuter.addEventListener("touchstart",f,!0);var m,g=this._knobTime.childNodes[0],_=this._knobDate.childNodes[0],v=this._knobStatus.childNodes[0];this._subscriptions=[w(t.pauseViewModel,"toggled",function(e){m!==e&&((m=e)?p._shuttleRingPointer.setAttribute("class","cesium-animation-shuttleRingPausePointer"):p._shuttleRingPointer.setAttribute("class","cesium-animation-shuttleRingPointer"))}),w(t,"shuttleRingAngle",function(e){var t,r,i;t=p._shuttleRingPointer,r=p._knobOuter,i=e,t.setAttribute("transform","translate(100,100) rotate("+i+")"),r.setAttribute("transform","rotate("+i+")")}),w(t,"dateLabel",function(e){_.textContent!==e&&(_.textContent=e)}),w(t,"timeLabel",function(e){g.textContent!==e&&(g.textContent=e)}),w(t,"multiplierLabel",function(e){v.textContent!==e&&(v.textContent=e)})],this.applyThemeChanges(),this.resize()}return O.prototype.destroy=function(){this.svgElement.removeEventListener("click",this._clickFunction,!0);for(var e=this._subscriptions,t=0,r=e.length;t<r;t++)e[t].dispose();n(this)},O.prototype.isDestroyed=function(){return!1},O.prototype.setEnabled=function(e){if(this._enabled!==e){if(!(this._enabled=e))return void this.svgElement.setAttribute("class","cesium-animation-buttonDisabled");if(this._toggled)return void this.svgElement.setAttribute("class","cesium-animation-rectButton cesium-animation-buttonToggled");this.svgElement.setAttribute("class","cesium-animation-rectButton")}},O.prototype.setToggled=function(e){this._toggled!==e&&(this._toggled=e,this._enabled&&(e?this.svgElement.setAttribute("class","cesium-animation-rectButton cesium-animation-buttonToggled"):this.svgElement.setAttribute("class","cesium-animation-rectButton")))},O.prototype.setTooltip=function(e){this.svgElement.getElementsByTagName("title")[0].textContent=e},e(r.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){y(this._observer)&&(this._observer.disconnect(),this._observer=void 0);var e=this._mouseCallback;this._shuttleRingBackPanel.removeEventListener("mousedown",e,!0),this._shuttleRingBackPanel.removeEventListener("touchstart",e,!0),this._shuttleRingSwooshG.removeEventListener("mousedown",e,!0),this._shuttleRingSwooshG.removeEventListener("touchstart",e,!0),document.removeEventListener("mousemove",e,!0),document.removeEventListener("touchmove",e,!0),document.removeEventListener("mouseup",e,!0),document.removeEventListener("touchend",e,!0),document.removeEventListener("touchcancel",e,!0),this._shuttleRingPointer.removeEventListener("mousedown",e,!0),this._shuttleRingPointer.removeEventListener("touchstart",e,!0),this._knobOuter.removeEventListener("mousedown",e,!0),this._knobOuter.removeEventListener("touchstart",e,!0),this._container.removeChild(this._svgNode),this._container.removeChild(this._theme),this._realtimeSVG.destroy(),this._playReverseSVG.destroy(),this._playForwardSVG.destroy(),this._pauseSVG.destroy();for(var t=this._subscriptions,r=0,i=t.length;r<i;r++)t[r].dispose();return n(this)},r.prototype.resize=function(){var e=this._container.clientWidth,t=this._container.clientHeight;if(e!==this._lastWidth||t!==this._lastHeight){var r=this._svgNode,i=e,n=t;0===e&&0===t?(i=200,n=132):0===e?i=(n=t)/132*200:0===t&&(n=(i=e)/200*132);var o=i/200,a=n/132;r.style.cssText="width: "+i+"px; height: "+n+"px; position: absolute; bottom: 0; left: 0; overflow: hidden;",r.setAttribute("width",i),r.setAttribute("height",n),r.setAttribute("viewBox","0 0 "+i+" "+n),this._topG.setAttribute("transform","scale("+o+","+a+")"),this._centerX=Math.max(1,100*o),this._centerY=Math.max(1,100*a),this._lastHeight=e,this._lastWidth=t}},r.prototype.applyThemeChanges=function(){if(!document.body.contains(this._container)){if(y(this._observer))return;var e=this;return e._observer=new MutationObserver(function(){document.body.contains(e._container)&&(e._observer.disconnect(),e._observer=void 0,e.applyThemeChanges())}),void e._observer.observe(document,{childList:!0,subtree:!0})}var t=v(this._themeNormal),r=v(this._themeHover),i=v(this._themeSelect),n=v(this._themeDisabled),o=v(this._themeKnob),a=v(this._themePointer),s=v(this._themeSwoosh),l=v(this._themeSwooshHover),u=A({tagName:"defs",children:[{id:"animation_buttonNormal",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":P(t,c)},{tagName:"stop",offset:"12%","stop-color":P(t,d)},{tagName:"stop",offset:"46%","stop-color":P(t,h)},{tagName:"stop",offset:"81%","stop-color":P(t,p)}]},{id:"animation_buttonHovered",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":P(r,c)},{tagName:"stop",offset:"12%","stop-color":P(r,d)},{tagName:"stop",offset:"46%","stop-color":P(r,h)},{tagName:"stop",offset:"81%","stop-color":P(r,p)}]},{id:"animation_buttonToggled",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":P(i,c)},{tagName:"stop",offset:"12%","stop-color":P(i,d)},{tagName:"stop",offset:"46%","stop-color":P(i,h)},{tagName:"stop",offset:"81%","stop-color":P(i,p)}]},{id:"animation_buttonDisabled",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":P(n,f)},{tagName:"stop",offset:"75%","stop-color":P(n,m)}]},{id:"animation_blurred",tagName:"filter",width:"200%",height:"200%",x:"-50%",y:"-50%",children:[{tagName:"feGaussianBlur",stdDeviation:4,in:"SourceGraphic"}]},{id:"animation_shuttleRingSwooshGradient",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-opacity":.2,"stop-color":s.toCssColorString()},{tagName:"stop",offset:"85%","stop-opacity":.85,"stop-color":s.toCssColorString()},{tagName:"stop",offset:"95%","stop-opacity":.05,"stop-color":s.toCssColorString()}]},{id:"animation_shuttleRingSwooshHovered",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-opacity":.2,"stop-color":l.toCssColorString()},{tagName:"stop",offset:"85%","stop-opacity":.85,"stop-color":l.toCssColorString()},{tagName:"stop",offset:"95%","stop-opacity":.05,"stop-color":l.toCssColorString()}]},{id:"animation_shuttleRingPointerGradient",tagName:"linearGradient",x1:"0%",y1:"50%",x2:"100%",y2:"50%",children:[{tagName:"stop",offset:"0%","stop-color":a.toCssColorString()},{tagName:"stop",offset:"40%","stop-color":a.toCssColorString()},{tagName:"stop",offset:"60%","stop-color":P(a,_)},{tagName:"stop",offset:"100%","stop-color":P(a,_)}]},{id:"animation_shuttleRingPointerPaused",tagName:"linearGradient",x1:"0%",y1:"50%",x2:"100%",y2:"50%",children:[{tagName:"stop",offset:"0%","stop-color":"#CCC"},{tagName:"stop",offset:"40%","stop-color":"#CCC"},{tagName:"stop",offset:"60%","stop-color":"#555"},{tagName:"stop",offset:"100%","stop-color":"#555"}]},{id:"animation_knobOuter",tagName:"linearGradient",x1:"20%",y1:"0%",x2:"90%",y2:"100%",children:[{tagName:"stop",offset:"5%","stop-color":P(o,c)},{tagName:"stop",offset:"60%","stop-color":P(o,g)},{tagName:"stop",offset:"85%","stop-color":P(o,d)}]},{id:"animation_knobInner",tagName:"linearGradient",x1:"20%",y1:"0%",x2:"90%",y2:"100%",children:[{tagName:"stop",offset:"5%","stop-color":P(o,g)},{tagName:"stop",offset:"60%","stop-color":P(o,c)},{tagName:"stop",offset:"85%","stop-color":P(o,p)}]},{id:"animation_pathReset",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M24.316,5.318,9.833,13.682,9.833,5.5,5.5,5.5,5.5,25.5,9.833,25.5,9.833,17.318,24.316,25.682z"},{id:"animation_pathPause",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M13,5.5,7.5,5.5,7.5,25.5,13,25.5zM24.5,5.5,19,5.5,19,25.5,24.5,25.5z"},{id:"animation_pathPlay",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M6.684,25.682L24.316,15.5L6.684,5.318V25.682z"},{id:"animation_pathPlayReverse",tagName:"path",transform:"translate(16,16) scale(-0.85,0.85) translate(-16,-16)",d:"M6.684,25.682L24.316,15.5L6.684,5.318V25.682z"},{id:"animation_pathLoop",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M24.249,15.499c-0.009,4.832-3.918,8.741-8.75,8.75c-2.515,0-4.768-1.064-6.365-2.763l2.068-1.442l-7.901-3.703l0.744,8.694l2.193-1.529c2.244,2.594,5.562,4.242,9.26,4.242c6.767,0,12.249-5.482,12.249-12.249H24.249zM15.499,6.75c2.516,0,4.769,1.065,6.367,2.764l-2.068,1.443l7.901,3.701l-0.746-8.693l-2.192,1.529c-2.245-2.594-5.562-4.245-9.262-4.245C8.734,3.25,3.25,8.734,3.249,15.499H6.75C6.758,10.668,10.668,6.758,15.499,6.75z"},{id:"animation_pathClock",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-15.5)",d:"M15.5,2.374C8.251,2.375,2.376,8.251,2.374,15.5C2.376,22.748,8.251,28.623,15.5,28.627c7.249-0.004,13.124-5.879,13.125-13.127C28.624,8.251,22.749,2.375,15.5,2.374zM15.5,25.623C9.909,25.615,5.385,21.09,5.375,15.5C5.385,9.909,9.909,5.384,15.5,5.374c5.59,0.01,10.115,4.535,10.124,10.125C25.615,21.09,21.091,25.615,15.5,25.623zM8.625,15.5c-0.001-0.552-0.448-0.999-1.001-1c-0.553,0-1,0.448-1,1c0,0.553,0.449,1,1,1C8.176,16.5,8.624,16.053,8.625,15.5zM8.179,18.572c-0.478,0.277-0.642,0.889-0.365,1.367c0.275,0.479,0.889,0.641,1.365,0.365c0.479-0.275,0.643-0.887,0.367-1.367C9.27,18.461,8.658,18.297,8.179,18.572zM9.18,10.696c-0.479-0.276-1.09-0.112-1.366,0.366s-0.111,1.09,0.365,1.366c0.479,0.276,1.09,0.113,1.367-0.366C9.821,11.584,9.657,10.973,9.18,10.696zM22.822,12.428c0.478-0.275,0.643-0.888,0.366-1.366c-0.275-0.478-0.89-0.642-1.366-0.366c-0.479,0.278-0.642,0.89-0.366,1.367C21.732,12.54,22.344,12.705,22.822,12.428zM12.062,21.455c-0.478-0.275-1.089-0.111-1.366,0.367c-0.275,0.479-0.111,1.09,0.366,1.365c0.478,0.277,1.091,0.111,1.365-0.365C12.704,22.344,12.54,21.732,12.062,21.455zM12.062,9.545c0.479-0.276,0.642-0.888,0.366-1.366c-0.276-0.478-0.888-0.642-1.366-0.366s-0.642,0.888-0.366,1.366C10.973,9.658,11.584,9.822,12.062,9.545zM22.823,18.572c-0.48-0.275-1.092-0.111-1.367,0.365c-0.275,0.479-0.112,1.092,0.367,1.367c0.477,0.275,1.089,0.113,1.365-0.365C23.464,19.461,23.3,18.848,22.823,18.572zM19.938,7.813c-0.477-0.276-1.091-0.111-1.365,0.366c-0.275,0.48-0.111,1.091,0.366,1.367s1.089,0.112,1.366-0.366C20.581,8.702,20.418,8.089,19.938,7.813zM23.378,14.5c-0.554,0.002-1.001,0.45-1.001,1c0.001,0.552,0.448,1,1.001,1c0.551,0,1-0.447,1-1C24.378,14.949,23.929,14.5,23.378,14.5zM15.501,6.624c-0.552,0-1,0.448-1,1l-0.466,7.343l-3.004,1.96c-0.478,0.277-0.642,0.889-0.365,1.365c0.275,0.479,0.889,0.643,1.365,0.367l3.305-1.676C15.39,16.99,15.444,17,15.501,17c0.828,0,1.5-0.671,1.5-1.5l-0.5-7.876C16.501,7.072,16.053,6.624,15.501,6.624zM15.501,22.377c-0.552,0-1,0.447-1,1s0.448,1,1,1s1-0.447,1-1S16.053,22.377,15.501,22.377zM18.939,21.455c-0.479,0.277-0.643,0.889-0.366,1.367c0.275,0.477,0.888,0.643,1.366,0.365c0.478-0.275,0.642-0.889,0.366-1.365C20.028,21.344,19.417,21.18,18.939,21.455z"},{id:"animation_pathWingButton",tagName:"path",d:"m 4.5,0.5 c -2.216,0 -4,1.784 -4,4 l 0,24 c 0,2.216 1.784,4 4,4 l 13.71875,0 C 22.478584,27.272785 27.273681,22.511272 32.5,18.25 l 0,-13.75 c 0,-2.216 -1.784,-4 -4,-4 l -24,0 z"},{id:"animation_pathPointer",tagName:"path",d:"M-15,-65,-15,-55,15,-55,15,-65,0,-95z"},{id:"animation_pathSwooshFX",tagName:"path",d:"m 85,0 c 0,16.617 -4.813944,35.356 -13.131081,48.4508 h 6.099803 c 8.317138,-13.0948 13.13322,-28.5955 13.13322,-45.2124 0,-46.94483 -38.402714,-85.00262 -85.7743869,-85.00262 -1.0218522,0 -2.0373001,0.0241 -3.0506131,0.0589 45.958443,1.59437 82.723058,35.77285 82.723058,81.70532 z"}]});y(this._defsElement)?this._svgNode.replaceChild(u,this._defsElement):this._svgNode.appendChild(u),this._defsElement=u},r}),define("Widgets/createCommand",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../ThirdParty/knockout"],function(t,a,s,l,u,c){"use strict";return function(r,e){if(!a(r))throw new l("func is required.");e=t(e,!0);var i=new u,n=new u;function o(){if(!o.canExecute)throw new l("Cannot execute command, canExecute is false.");var e,t={args:arguments,cancel:!1};return i.raiseEvent(t),t.cancel||(e=r.apply(null,arguments),n.raiseEvent(e)),e}return o.canExecute=e,c.track(o,["canExecute"]),s(o,{beforeExecute:{value:i},afterExecute:{value:n}}),o}}),define("Widgets/ToggleButtonViewModel",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../ThirdParty/knockout"],function(r,i,e,n,o){"use strict";function t(e,t){if(!i(e))throw new n("command is required.");this._command=e,t=r(t,r.EMPTY_OBJECT),this.toggled=r(t.toggled,!1),this.tooltip=r(t.tooltip,""),o.track(this,["toggled","tooltip"])}return e(t.prototype,{command:{get:function(){return this._command}}}),t}),define("Widgets/Animation/AnimationViewModel",["../../Core/binarySearch","../../Core/ClockRange","../../Core/ClockStep","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/JulianDate","../../ThirdParty/knockout","../../ThirdParty/sprintf","../createCommand","../ToggleButtonViewModel"],function(i,l,u,c,e,d,h,o,n,a,p){"use strict";var s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],f=15,m=105;function g(e,t){return e-t}function _(e,t){var r=i(t,e,g);return r<0?~r:r}function v(e){if(!c(e))throw new d("clockViewModel is required.");var s=this;this._clockViewModel=e,this._allShuttleRingTicks=[],this._dateFormatter=v.defaultDateFormatter,this._timeFormatter=v.defaultTimeFormatter,this.shuttleRingDragging=!1,this.snapToTicks=!1,o.track(this,["_allShuttleRingTicks","_dateFormatter","_timeFormatter","shuttleRingDragging","snapToTicks"]),this._sortedFilteredPositiveTicks=[],this.setShuttleRingTicks(v.defaultTicks),this.timeLabel=void 0,o.defineProperty(this,"timeLabel",function(){return s._timeFormatter(s._clockViewModel.currentTime,s)}),this.dateLabel=void 0,o.defineProperty(this,"dateLabel",function(){return s._dateFormatter(s._clockViewModel.currentTime,s)}),this.multiplierLabel=void 0,o.defineProperty(this,"multiplierLabel",function(){var e=s._clockViewModel;if(e.clockStep===u.SYSTEM_CLOCK)return"Today";var t=e.multiplier;return t%1==0?t.toFixed(0)+"x":t.toFixed(3).replace(/0{0,3}$/,"")+"x"}),this.shuttleRingAngle=void 0,o.defineProperty(this,"shuttleRingAngle",{get:function(){return function(e,t,r){if(r.clockStep===u.SYSTEM_CLOCK)return f;if(Math.abs(e)<=1)return e*f;var i=t[t.length-1];i<e?e=i:e<-i&&(e=-i);var n,o=f,a=m;return 0<e?(n=(Math.log(i)-0)/(a-o),(Math.log(e)-0)/n+o):(n=(Math.log(-t[0])-0)/(a-o),-((Math.log(Math.abs(e))-0)/n+o))}(e.multiplier,s._allShuttleRingTicks,e)},set:function(e){e=Math.max(Math.min(e,m),-m);var t=s._allShuttleRingTicks,r=s._clockViewModel;if(r.clockStep=u.SYSTEM_CLOCK_MULTIPLIER,Math.abs(e)!==m){var i=function(e,t){if(Math.abs(e)<=f)return e/f;var r,i=f,n=m;return 0<e?(r=(Math.log(t[t.length-1])-0)/(n-i),Math.exp(0+r*(e-i))):(r=(Math.log(-t[0])-0)/(n-i),-Math.exp(0+r*(Math.abs(e)-i)))}(e,t);if(s.snapToTicks)i=t[_(i,t)];else if(0!==i){var n=Math.abs(i);if(100<n){var o=n.toFixed(0).length-2,a=Math.pow(10,o);i=Math.round(i/a)*a|0}else f<n?i=Math.round(i):1<n?i=+i.toFixed(1):0<n&&(i=+i.toFixed(2))}r.multiplier=i}else r.multiplier=0<e?t[t.length-1]:t[0]}}),this._canAnimate=void 0,o.defineProperty(this,"_canAnimate",function(){var e=s._clockViewModel,t=e.clockRange;if(s.shuttleRingDragging||t===l.UNBOUNDED)return!0;var r=e.multiplier,i=e.currentTime,n=e.startTime,o=!1;if(t===l.LOOP_STOP)o=h.greaterThan(i,n)||i.equals(n)&&0<r;else{var a=e.stopTime;o=h.greaterThan(i,n)&&h.lessThan(i,a)||i.equals(n)&&0<r||i.equals(a)&&r<0}return o||(e.shouldAnimate=!1),o}),this._isSystemTimeAvailable=void 0,o.defineProperty(this,"_isSystemTimeAvailable",function(){var e=s._clockViewModel;if(e.clockRange===l.UNBOUNDED)return!0;var t=e.systemTime;return h.greaterThanOrEquals(t,e.startTime)&&h.lessThanOrEquals(t,e.stopTime)}),this._isAnimating=void 0,o.defineProperty(this,"_isAnimating",function(){return s._clockViewModel.shouldAnimate&&(s._canAnimate||s.shuttleRingDragging)});var t=a(function(){var e=s._clockViewModel;e.shouldAnimate?e.shouldAnimate=!1:s._canAnimate&&(e.shouldAnimate=!0)});this._pauseViewModel=new p(t,{toggled:o.computed(function(){return!s._isAnimating}),tooltip:"Pause"});var r=a(function(){var e=s._clockViewModel,t=e.multiplier;0<t&&(e.multiplier=-t),e.shouldAnimate=!0});this._playReverseViewModel=new p(r,{toggled:o.computed(function(){return s._isAnimating&&e.multiplier<0}),tooltip:"Play Reverse"});var i=a(function(){var e=s._clockViewModel,t=e.multiplier;t<0&&(e.multiplier=-t),e.shouldAnimate=!0});this._playForwardViewModel=new p(i,{toggled:o.computed(function(){return s._isAnimating&&0<e.multiplier&&e.clockStep!==u.SYSTEM_CLOCK}),tooltip:"Play Forward"});var n=a(function(){s._clockViewModel.clockStep=u.SYSTEM_CLOCK},o.getObservable(this,"_isSystemTimeAvailable"));this._playRealtimeViewModel=new p(n,{toggled:o.computed(function(){return e.clockStep===u.SYSTEM_CLOCK}),tooltip:o.computed(function(){return s._isSystemTimeAvailable?"Today (real-time)":"Current time not in range"})}),this._slower=a(function(){var e=s._clockViewModel,t=s._allShuttleRingTicks,r=_(e.multiplier,t)-1;0<=r&&(e.multiplier=t[r])}),this._faster=a(function(){var e=s._clockViewModel,t=s._allShuttleRingTicks,r=_(e.multiplier,t)+1;r<t.length&&(e.multiplier=t[r])})}return v.defaultDateFormatter=function(e,t){var r=h.toGregorianDate(e);return s[r.month-1]+" "+r.day+" "+r.year},v.defaultTicks=[.001,.002,.005,.01,.02,.05,.1,.25,.5,1,2,5,10,15,30,60,120,300,600,900,1800,3600,7200,14400,21600,43200,86400,172800,345600,604800],v.defaultTimeFormatter=function(e,t){var r=h.toGregorianDate(e),i=Math.round(r.millisecond);return Math.abs(t._clockViewModel.multiplier)<1?n("%02d:%02d:%02d.%03d",r.hour,r.minute,r.second,i):n("%02d:%02d:%02d UTC",r.hour,r.minute,r.second)},v.prototype.getShuttleRingTicks=function(){return this._sortedFilteredPositiveTicks.slice(0)},v.prototype.setShuttleRingTicks=function(e){if(!c(e))throw new d("positiveTicks is required.");var t,r,i,n={},o=this._sortedFilteredPositiveTicks;for(t=o.length=0,r=e.length;t<r;++t)i=e[t],n.hasOwnProperty(i)||(n[i]=!0,o.push(i));o.sort(g);var a=[];for(t=(r=o.length)-1;0<=t;--t)0!==(i=o[t])&&a.push(-i);Array.prototype.push.apply(a,o),this._allShuttleRingTicks=a},e(v.prototype,{slower:{get:function(){return this._slower}},faster:{get:function(){return this._faster}},clockViewModel:{get:function(){return this._clockViewModel}},pauseViewModel:{get:function(){return this._pauseViewModel}},playReverseViewModel:{get:function(){return this._playReverseViewModel}},playForwardViewModel:{get:function(){return this._playForwardViewModel}},playRealtimeViewModel:{get:function(){return this._playRealtimeViewModel}},dateFormatter:{get:function(){return this._dateFormatter},set:function(e){if("function"!=typeof e)throw new d("dateFormatter must be a function");this._dateFormatter=e}},timeFormatter:{get:function(){return this._timeFormatter},set:function(e){if("function"!=typeof e)throw new d("timeFormatter must be a function");this._timeFormatter=e}}}),v._maxShuttleRingAngle=m,v._realtimeShuttleRingAngle=f,v}),define("Widgets/BaseLayerPicker/BaseLayerPickerViewModel",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/EllipsoidTerrainProvider","../../Core/isArray","../../ThirdParty/knockout","../createCommand"],function(a,c,e,s,l,d,h,p){"use strict";function t(e){var t=(e=a(e,a.EMPTY_OBJECT)).globe,r=a(e.imageryProviderViewModels,[]),i=a(e.terrainProviderViewModels,[]);if(!c(t))throw new s("globe is required");this._globe=t,this.imageryProviderViewModels=r.slice(0),this.terrainProviderViewModels=i.slice(0),this.dropDownVisible=!1,h.track(this,["imageryProviderViewModels","terrainProviderViewModels","dropDownVisible"]),this.buttonTooltip=void 0,h.defineProperty(this,"buttonTooltip",function(){var e=this.selectedImagery,t=this.selectedTerrain,r=c(e)?e.name:void 0,i=c(t)?t.name:void 0;return c(r)&&c(i)?r+"\n"+i:c(r)?r:i}),this.buttonImageUrl=void 0,h.defineProperty(this,"buttonImageUrl",function(){var e=this.selectedImagery;return c(e)?e.iconUrl:void 0}),this.selectedImagery=void 0;var u=h.observable();this._currentImageryProviders=[],h.defineProperty(this,"selectedImagery",{get:function(){return u()},set:function(e){if(u()!==e){var t,r=this._currentImageryProviders,i=r.length,n=this._globe.imageryLayers;for(t=0;t<i;t++)for(var o=n.length,a=0;a<o;a++){var s=n.get(a);if(s.imageryProvider===r[t]){n.remove(s);break}}if(c(e)){var l=e.creationCommand();if(d(l)){for(t=l.length-1;0<=t;t--)n.addImageryProvider(l[t],0);this._currentImageryProviders=l.slice(0)}else this._currentImageryProviders=[l],n.addImageryProvider(l,0)}u(e),this.dropDownVisible=!1}else this.dropDownVisible=!1}}),this.selectedTerrain=void 0;var n=h.observable();h.defineProperty(this,"selectedTerrain",{get:function(){return n()},set:function(e){var t;n()!==e?(c(e)&&(t=e.creationCommand()),this._globe.depthTestAgainstTerrain=!(t instanceof l),this._globe.terrainProvider=t,n(e),this.dropDownVisible=!1):this.dropDownVisible=!1}});var o=this;this._toggleDropDown=p(function(){o.dropDownVisible=!o.dropDownVisible}),this.selectedImagery=a(e.selectedImageryProviderViewModel,r[0]),this.selectedTerrain=a(e.selectedTerrainProviderViewModel,i[0])}return e(t.prototype,{toggleDropDown:{get:function(){return this._toggleDropDown}},globe:{get:function(){return this._globe}}}),t}),define("Widgets/BaseLayerPicker/BaseLayerPicker",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/FeatureDetection","../../ThirdParty/knockout","../getElement","./BaseLayerPickerViewModel"],function(g,e,t,_,v,y,b,C){"use strict";function r(e,t){if(!g(e))throw new _("container is required.");e=b(e);var r=new C(t),i=document.createElement("button");i.type="button",i.className="cesium-button cesium-toolbar-button",i.setAttribute("data-bind","attr: { title: buttonTooltip },click: toggleDropDown"),e.appendChild(i);var n=document.createElement("img");n.setAttribute("draggable","false"),n.className="cesium-baseLayerPicker-selected",n.setAttribute("data-bind","attr: { src: buttonImageUrl }"),i.appendChild(n);var o=document.createElement("div");o.className="cesium-baseLayerPicker-dropDown",o.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-dropDown-visible" : dropDownVisible }'),e.appendChild(o);var a=document.createElement("div");a.className="cesium-baseLayerPicker-sectionTitle",a.setAttribute("data-bind","visible: imageryProviderViewModels.length > 0"),a.innerHTML="Imagery",o.appendChild(a);var s=document.createElement("div");s.className="cesium-baseLayerPicker-choices",s.setAttribute("data-bind","foreach: imageryProviderViewModels"),o.appendChild(s);var l=document.createElement("div");l.className="cesium-baseLayerPicker-item",l.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-selectedItem" : $data === $parent.selectedImagery },attr: { title: tooltip },visible: creationCommand.canExecute,click: function($data) { $parent.selectedImagery = $data; }'),s.appendChild(l);var u=document.createElement("img");u.className="cesium-baseLayerPicker-itemIcon",u.setAttribute("data-bind","attr: { src: iconUrl }"),u.setAttribute("draggable","false"),l.appendChild(u);var c=document.createElement("div");c.className="cesium-baseLayerPicker-itemLabel",c.setAttribute("data-bind","text: name"),l.appendChild(c);var d=document.createElement("div");d.className="cesium-baseLayerPicker-sectionTitle",d.setAttribute("data-bind","visible: terrainProviderViewModels.length > 0"),d.innerHTML="Terrain",o.appendChild(d);var h=document.createElement("div");h.className="cesium-baseLayerPicker-choices",h.setAttribute("data-bind","foreach: terrainProviderViewModels"),o.appendChild(h);var p=document.createElement("div");p.className="cesium-baseLayerPicker-item",p.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-selectedItem" : $data === $parent.selectedTerrain },attr: { title: tooltip },visible: creationCommand.canExecute,click: function($data) { $parent.selectedTerrain = $data; }'),h.appendChild(p);var f=document.createElement("img");f.className="cesium-baseLayerPicker-itemIcon",f.setAttribute("data-bind","attr: { src: iconUrl }"),f.setAttribute("draggable","false"),p.appendChild(f);var m=document.createElement("div");m.className="cesium-baseLayerPicker-itemLabel",m.setAttribute("data-bind","text: name"),p.appendChild(m),y.applyBindings(r,i),y.applyBindings(r,o),this._viewModel=r,this._container=e,this._element=i,this._dropPanel=o,this._closeDropDown=function(e){i.contains(e.target)||o.contains(e.target)||(r.dropDownVisible=!1)},v.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeDropDown,!0):(document.addEventListener("mousedown",this._closeDropDown,!0),document.addEventListener("touchstart",this._closeDropDown,!0))}return e(r.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return v.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeDropDown,!0):(document.removeEventListener("mousedown",this._closeDropDown,!0),document.removeEventListener("touchstart",this._closeDropDown,!0)),y.cleanNode(this._element),y.cleanNode(this._dropPanel),this._container.removeChild(this._element),this._container.removeChild(this._dropPanel),t(this)},r}),define("Widgets/BaseLayerPicker/ProviderViewModel",["../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../ThirdParty/knockout","../createCommand"],function(r,e,i,n,o){"use strict";function t(e){if(!r(e.name))throw new i("options.name is required.");if(!r(e.tooltip))throw new i("options.tooltip is required.");if(!r(e.iconUrl))throw new i("options.iconUrl is required.");if("function"!=typeof e.creationFunction)throw new i("options.creationFunction is required.");var t=e.creationFunction;r(t.canExecute)||(t=o(t)),this._creationCommand=t,this.name=e.name,this.tooltip=e.tooltip,this.iconUrl=e.iconUrl,n.track(this,["name","tooltip","iconUrl"])}return e(t.prototype,{creationCommand:{get:function(){return this._creationCommand}}}),t}),define("Widgets/BaseLayerPicker/createDefaultImageryProviderViewModels",["../../Core/buildModuleUrl","../../Scene/ArcGisMapServerImageryProvider","../../Scene/BingMapsImageryProvider","../../Scene/BingMapsStyle","../../Scene/createOpenStreetMapImageryProvider","../../Scene/createTileMapServiceImageryProvider","../../Scene/MapboxImageryProvider","../BaseLayerPicker/ProviderViewModel"],function(t,r,i,n,o,a,s,l){"use strict";return function(){var e=[];return e.push(new l({name:"Bing Maps Aerial",iconUrl:t("Widgets/Images/ImageryProviders/bingAerial.png"),tooltip:"Bing Maps aerial imagery \nhttp://www.bing.com/maps",creationFunction:function(){return new i({url:"https://dev.virtualearth.net",mapStyle:n.AERIAL})}})),e.push(new l({name:"Bing Maps Aerial with Labels",iconUrl:t("Widgets/Images/ImageryProviders/bingAerialLabels.png"),tooltip:"Bing Maps aerial imagery with label overlays \nhttp://www.bing.com/maps",creationFunction:function(){return new i({url:"https://dev.virtualearth.net",mapStyle:n.AERIAL_WITH_LABELS})}})),e.push(new l({name:"Bing Maps Roads",iconUrl:t("Widgets/Images/ImageryProviders/bingRoads.png"),tooltip:"Bing Maps standard road maps\nhttp://www.bing.com/maps",creationFunction:function(){return new i({url:"https://dev.virtualearth.net",mapStyle:n.ROAD})}})),e.push(new l({name:"Mapbox Satellite",tooltip:"Mapbox satellite imagery https://www.mapbox.com/maps/",iconUrl:t("Widgets/Images/ImageryProviders/mapboxSatellite.png"),creationFunction:function(){return new s({mapId:"mapbox.satellite"})}})),e.push(new l({name:"Mapbox Streets",tooltip:"Mapbox streets imagery https://www.mapbox.com/maps/",iconUrl:t("Widgets/Images/ImageryProviders/mapboxTerrain.png"),creationFunction:function(){return new s({mapId:"mapbox.streets"})}})),e.push(new l({name:"Mapbox Streets Classic",tooltip:"Mapbox streets basic imagery https://www.mapbox.com/maps/",iconUrl:t("Widgets/Images/ImageryProviders/mapboxStreets.png"),creationFunction:function(){return new s({mapId:"mapbox.streets-basic"})}})),e.push(new l({name:"ESRI World Imagery",iconUrl:t("Widgets/Images/ImageryProviders/esriWorldImagery.png"),tooltip:"World Imagery provides one meter or better satellite and aerial imagery in many parts of the world and lower resolution satellite imagery worldwide.  The map includes NASA Blue Marble: Next Generation 500m resolution imagery at small scales (above 1:1,000,000), i-cubed 15m eSAT imagery at medium-to-large scales (down to 1:70,000) for the world, and USGS 15m Landsat imagery for Antarctica. The map features 0.3m resolution imagery in the continental United States and 0.6m resolution imagery in parts of Western Europe from DigitalGlobe. In other parts of the world, 1 meter resolution imagery is available from GeoEye IKONOS, i-cubed Nationwide Prime, Getmapping, AeroGRID, IGN Spain, and IGP Portugal.  Additionally, imagery at different resolutions has been contributed by the GIS User Community.\nhttp://www.esri.com",creationFunction:function(){return new r({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",enablePickFeatures:!1})}})),e.push(new l({name:"ESRI World Street Map",iconUrl:t("Widgets/Images/ImageryProviders/esriWorldStreetMap.png"),tooltip:"This worldwide street map presents highway-level data for the world. Street-level data includes the United States; much of Canada; Japan; most countries in Europe; Australia and New Zealand; India; parts of South America including Argentina, Brazil, Chile, Colombia, and Venezuela; Ghana; and parts of southern Africa including Botswana, Lesotho, Namibia, South Africa, and Swaziland.\nhttp://www.esri.com",creationFunction:function(){return new r({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer",enablePickFeatures:!1})}})),e.push(new l({name:"ESRI National Geographic",iconUrl:t("Widgets/Images/ImageryProviders/esriNationalGeographic.png"),tooltip:"This web map contains the National Geographic World Map service. This map service is designed to be used as a general reference map for informational and educational purposes as well as a basemap by GIS professionals and other users for creating web maps and web mapping applications.\nhttp://www.esri.com",creationFunction:function(){return new r({url:"https://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/",enablePickFeatures:!1})}})),e.push(new l({name:"OpenStreetMap",iconUrl:t("Widgets/Images/ImageryProviders/openStreetMap.png"),tooltip:"OpenStreetMap (OSM) is a collaborative project to create a free editable map of the world.\nhttp://www.openstreetmap.org",creationFunction:function(){return o({url:"https://a.tile.openstreetmap.org/"})}})),e.push(new l({name:"Stamen Watercolor",iconUrl:t("Widgets/Images/ImageryProviders/stamenWatercolor.png"),tooltip:"Reminiscent of hand drawn maps, Stamen watercolor maps apply raster effect area washes and organic edges over a paper texture to add warm pop to any map.\nhttp://maps.stamen.com",creationFunction:function(){return o({url:"https://stamen-tiles.a.ssl.fastly.net/watercolor/",credit:"Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under CC BY SA."})}})),e.push(new l({name:"Stamen Toner",iconUrl:t("Widgets/Images/ImageryProviders/stamenToner.png"),tooltip:"A high contrast black and white map.\nhttp://maps.stamen.com",creationFunction:function(){return o({url:"https://stamen-tiles.a.ssl.fastly.net/toner/",credit:"Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under CC BY SA."})}})),e.push(new l({name:"The Black Marble",iconUrl:t("Widgets/Images/ImageryProviders/blackMarble.png"),tooltip:"The lights of cities and villages trace the outlines of civilization in this global view of the Earth at night as seen by NASA/NOAA's Suomi NPP satellite.",creationFunction:function(){return a({url:"https://cesiumjs.org/blackmarble",flipXY:!0,credit:"Black Marble imagery courtesy NASA Earth Observatory"})}})),e.push(new l({name:"Natural EarthII",iconUrl:t("Widgets/Images/ImageryProviders/naturalEarthII.png"),tooltip:"Natural Earth II, darkened for contrast.\nhttp://www.naturalearthdata.com/",creationFunction:function(){return a({url:t("Assets/Textures/NaturalEarthII")})}})),e}}),define("Widgets/BaseLayerPicker/createDefaultTerrainProviderViewModels",["../../Core/buildModuleUrl","../../Core/CesiumTerrainProvider","../../Core/EllipsoidTerrainProvider","../BaseLayerPicker/ProviderViewModel"],function(t,r,i,n){"use strict";return function(){var e=[];return e.push(new n({name:"WGS84 Ellipsoid",iconUrl:t("Widgets/Images/TerrainProviders/Ellipsoid.png"),tooltip:"WGS84 standard ellipsoid, also known as EPSG:4326",creationFunction:function(){return new i}})),e.push(new n({name:"STK World Terrain meshes",iconUrl:t("Widgets/Images/TerrainProviders/STK.png"),tooltip:"High-resolution, mesh-based terrain for the entire globe. Free for use on the Internet. Closed-network options are available.\nhttp://www.agi.com",creationFunction:function(){return new r({url:"https://assets.agi.com/stk-terrain/v1/tilesets/world/tiles",requestWaterMask:!0,requestVertexNormals:!0})}})),e}});define("Widgets/Cesium3DTilesInspector/Cesium3DTilesInspectorViewModel",["../../Core/Check","../../Core/Color","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/ScreenSpaceEventHandler","../../Core/ScreenSpaceEventType","../../Scene/Cesium3DTileColorBlendMode","../../Scene/Cesium3DTileFeature","../../Scene/Cesium3DTileset","../../Scene/Cesium3DTileStyle","../../Scene/PerformanceDisplay","../../ThirdParty/knockout"],function(F,i,B,e,r,U,V,z,q,G,t,W,H){"use strict";function j(r,e){e?r._eventHandler.setInputAction(function(e){var t=r._scene.pick(e.endPosition);B(t)&&t.primitive instanceof G&&(r.tileset=t.primitive)},V.MOUSE_MOVE):(r._eventHandler.removeInputAction(V.MOUSE_MOVE),r.picking=r.picking)}var n={maximumFractionDigits:3};function o(e){var t=e/1048576;return t<1?t.toLocaleString(void 0,n):Math.round(t).toLocaleString()}function s(e,t){if(!B(e))return"";var r=e.statistics,i='<ul class="cesium-cesiumInspector-statistics">';return i+="<li><strong>Visited: </strong>"+r.visited.toLocaleString()+"</li><li><strong>Selected: </strong>"+e._selectedTiles.length.toLocaleString()+"</li><li><strong>Commands: </strong>"+r.numberOfCommands.toLocaleString()+"</li>",i+="</ul>",t||(i+='<ul class="cesium-cesiumInspector-statistics">',i+="<li><strong>Requests: </strong>"+r.numberOfPendingRequests.toLocaleString()+"</li><li><strong>Attempted: </strong>"+r.numberOfAttemptedRequests.toLocaleString()+"</li><li><strong>Processing: </strong>"+r.numberOfTilesProcessing.toLocaleString()+"</li><li><strong>Content Ready: </strong>"+r.numberOfTilesWithContentReady.toLocaleString()+"</li><li><strong>Total: </strong>"+r.numberOfTilesTotal.toLocaleString()+"</li>",i+="</ul>",i+='<ul class="cesium-cesiumInspector-statistics">',i+="<li><strong>Features Selected: </strong>"+r.numberOfFeaturesSelected.toLocaleString()+"</li><li><strong>Features Loaded: </strong>"+r.numberOfFeaturesLoaded.toLocaleString()+"</li><li><strong>Points Selected: </strong>"+r.numberOfPointsSelected.toLocaleString()+"</li><li><strong>Points Loaded: </strong>"+r.numberOfPointsLoaded.toLocaleString()+"</li><li><strong>Triangles Selected: </strong>"+r.numberOfTrianglesSelected.toLocaleString()+"</li>",i+="</ul>",i+='<ul class="cesium-cesiumInspector-statistics">',i+="<li><strong>Tiles styled: </strong>"+r.numberOfTilesStyled.toLocaleString()+"</li><li><strong>Features styled: </strong>"+r.numberOfFeaturesStyled.toLocaleString()+"</li>",i+="</ul>",i+='<ul class="cesium-cesiumInspector-statistics">',i+="<li><strong>Children Union Culled: </strong>"+r.numberOfTilesCulledWithChildrenUnion.toLocaleString()+"</li>",i+="</ul>",i+='<ul class="cesium-cesiumInspector-statistics">',i+="<li><strong>Geometry Memory (MB): </strong>"+o(r.geometryByteLength)+"</li><li><strong>Texture Memory (MB): </strong>"+o(r.texturesByteLength)+"</li><li><strong>Batch Table Memory (MB): </strong>"+o(r.batchTableByteLength)+"</li>",i+="</ul>"),i}var a=[{text:"Highlight",value:z.HIGHLIGHT},{text:"Replace",value:z.REPLACE},{text:"Mix",value:z.MIX}],l=new i(1,1,0,.4),u=new i,c=new i;function d(i,e){F.typeOf.object("scene",i),F.typeOf.object("performanceContainer",e);var n=this,t=i.canvas;this._eventHandler=new U(t),this._scene=i,this._performanceContainer=e,this._canvas=t,this._performanceDisplay=new W({container:e}),this._statisticsText="",this._pickStatisticsText="",this._editorError="",this.performance=!1,this.showStatistics=!0,this.showPickStatistics=!0,this.inspectorVisible=!0,this.tilesetVisible=!1,this.displayVisible=!1,this.updateVisible=!1,this.loggingVisible=!1,this.styleVisible=!1,this.tileDebugLabelsVisible=!1,this.optimizationVisible=!1,this.styleString="{}",this._tileset=void 0,this._feature=void 0,this._tile=void 0,H.track(this,["performance","inspectorVisible","_statisticsText","_pickStatisticsText","_editorError","showPickStatistics","showStatistics","tilesetVisible","displayVisible","updateVisible","loggingVisible","styleVisible","optimizationVisible","tileDebugLabelsVisible","styleString","_feature","_tile"]),this._properties=H.observable({}),this.properties=[],H.defineProperty(this,"properties",function(){var e=[],t=n._properties();for(var r in t)t.hasOwnProperty(r)&&e.push(r);return e});var r=H.observable();H.defineProperty(this,"dynamicScreenSpaceError",{get:function(){return r()},set:function(e){r(e),B(n._tileset)&&(n._tileset.dynamicScreenSpaceError=e)}}),this.dynamicScreenSpaceError=!1;var o=H.observable();H.defineProperty(this,"colorBlendMode",{get:function(){return o()},set:function(e){o(e),B(n._tileset)&&(n._tileset.colorBlendMode=e,n._scene.requestRender())}}),this.colorBlendMode=z.HIGHLIGHT;var a=H.observable();H.defineProperty(this,"picking",{get:function(){return a()},set:function(e){a(e),e?n._eventHandler.setInputAction(function(e){var t=i.pick(e.endPosition);if(t instanceof q?(n.feature=t,n.tile=t.content.tile):B(t)&&B(t.content)?(n.feature=void 0,n.tile=t.content.tile):(n.feature=void 0,n.tile=void 0),B(n._tileset)){var r;if(p&&B(t)&&B(t.content))i.pickPositionSupported&&(r=i.pickPosition(e.endPosition),B(r)&&(n._tileset.debugPickPosition=r)),n._tileset.debugPickedTile=t.content.tile;else n._tileset.debugPickedTile=void 0;n._scene.requestRender()}},V.MOUSE_MOVE):(n.feature=void 0,n.tile=void 0,n._eventHandler.removeInputAction(V.MOUSE_MOVE))}}),this.picking=!0;var s=H.observable();H.defineProperty(this,"colorize",{get:function(){return s()},set:function(e){s(e),B(n._tileset)&&(n._tileset.debugColorizeTiles=e,n._scene.requestRender())}}),this.colorize=!1;var l=H.observable();H.defineProperty(this,"wireframe",{get:function(){return l()},set:function(e){l(e),B(n._tileset)&&(n._tileset.debugWireframe=e,n._scene.requestRender())}}),this.wireframe=!1;var u=H.observable();H.defineProperty(this,"showBoundingVolumes",{get:function(){return u()},set:function(e){u(e),B(n._tileset)&&(n._tileset.debugShowBoundingVolume=e,n._scene.requestRender())}}),this.showBoundingVolumes=!1;var c=H.observable();H.defineProperty(this,"showContentBoundingVolumes",{get:function(){return c()},set:function(e){c(e),B(n._tileset)&&(n._tileset.debugShowContentBoundingVolume=e,n._scene.requestRender())}}),this.showContentBoundingVolumes=!1;var d=H.observable();H.defineProperty(this,"showRequestVolumes",{get:function(){return d()},set:function(e){d(e),B(n._tileset)&&(n._tileset.debugShowViewerRequestVolume=e,n._scene.requestRender())}}),this.showRequestVolumes=!1;var h=H.observable();H.defineProperty(this,"freezeFrame",{get:function(){return h()},set:function(e){h(e),B(n._tileset)&&(n._tileset.debugFreezeFrame=e,n._scene.debugShowFrustumPlanes=e,n._scene.requestRender())}}),this.freezeFrame=!1;var p=H.observable();H.defineProperty(this,"showOnlyPickedTileDebugLabel",{get:function(){return p()},set:function(e){p(e),B(n._tileset)&&(n._tileset.debugPickedTileLabelOnly=e,n._scene.requestRender())}}),this.showOnlyPickedTileDebugLabel=!1;var f=H.observable();H.defineProperty(this,"showGeometricError",{get:function(){return f()},set:function(e){f(e),B(n._tileset)&&(n._tileset.debugShowGeometricError=e,n._scene.requestRender())}}),this.showGeometricError=!1;var m=H.observable();H.defineProperty(this,"showRenderingStatistics",{get:function(){return m()},set:function(e){m(e),B(n._tileset)&&(n._tileset.debugShowRenderingStatistics=e,n._scene.requestRender())}}),this.showRenderingStatistics=!1;var g=H.observable();H.defineProperty(this,"showMemoryUsage",{get:function(){return g()},set:function(e){g(e),B(n._tileset)&&(n._tileset.debugShowMemoryUsage=e,n._scene.requestRender())}}),this.showMemoryUsage=!1;var _=H.observable();H.defineProperty(this,"showUrl",{get:function(){return _()},set:function(e){_(e),B(n._tileset)&&(n._tileset.debugShowUrl=e,n._scene.requestRender())}}),this.showUrl=!1;var v=H.observable();H.defineProperty(this,"maximumScreenSpaceError",{get:function(){return v()},set:function(e){e=Number(e),isNaN(e)||(v(e),B(n._tileset)&&(n._tileset.maximumScreenSpaceError=e))}}),this.maximumScreenSpaceError=16;var y=H.observable();H.defineProperty(this,"dynamicScreenSpaceErrorDensity",{get:function(){return y()},set:function(e){e=Number(e),isNaN(e)||(y(e),B(n._tileset)&&(n._tileset.dynamicScreenSpaceErrorDensity=e))}}),this.dynamicScreenSpaceErrorDensity=.00278,this.dynamicScreenSpaceErrorDensitySliderValue=void 0,H.defineProperty(this,"dynamicScreenSpaceErrorDensitySliderValue",{get:function(){return Math.pow(y(),1/6)},set:function(e){y(Math.pow(e,6))}});var b=H.observable();H.defineProperty(this,"dynamicScreenSpaceErrorFactor",{get:function(){return b()},set:function(e){e=Number(e),isNaN(e)||(b(e),B(n._tileset)&&(n._tileset.dynamicScreenSpaceErrorFactor=e))}}),this.dynamicScreenSpaceErrorFactor=4;var C,w=(C=this,function(e){var t=C._scene.pick(e.position);B(t)&&t.primitive instanceof G&&(C.tileset=t.primitive),C.pickActive=!1}),S=H.observable();H.defineProperty(this,"pickActive",{get:function(){return S()},set:function(e){S(e),e?n._eventHandler.setInputAction(w,V.LEFT_CLICK):n._eventHandler.removeInputAction(V.LEFT_CLICK)}});var T=H.observable();H.defineProperty(this,"pointCloudShading",{get:function(){return T()},set:function(e){T(e),B(n._tileset)&&(n._tileset.pointCloudShading.attenuation=e)}}),this.pointCloudShading=!1;var E=H.observable();H.defineProperty(this,"geometricErrorScale",{get:function(){return E()},set:function(e){e=Number(e),isNaN(e)||(E(e),B(n._tileset)&&(n._tileset.pointCloudShading.geometricErrorScale=e))}}),this.geometricErrorScale=1;var A=H.observable();H.defineProperty(this,"maximumAttenuation",{get:function(){return A()},set:function(e){e=Number(e),isNaN(e)||(A(e),B(n._tileset)&&(n._tileset.pointCloudShading.maximumAttenuation=0===e?void 0:e))}}),this.maximumAttenuation=0;var x=H.observable();H.defineProperty(this,"baseResolution",{get:function(){return x()},set:function(e){e=Number(e),isNaN(e)||(x(e),B(n._tileset)&&(n._tileset.pointCloudShading.baseResolution=0===e?void 0:e))}}),this.baseResolution=0;var P=H.observable();H.defineProperty(this,"eyeDomeLighting",{get:function(){return P()},set:function(e){P(e),B(n._tileset)&&(n._tileset.pointCloudShading.eyeDomeLighting=e)}}),this.eyeDomeLighting=!1;var D=H.observable();H.defineProperty(this,"eyeDomeLightingStrength",{get:function(){return D()},set:function(e){e=Number(e),isNaN(e)||(D(e),B(n._tileset)&&(n._tileset.pointCloudShading.eyeDomeLightingStrength=e))}}),this.eyeDomeLightingStrength=1;var O=H.observable();H.defineProperty(this,"eyeDomeLightingRadius",{get:function(){return O()},set:function(e){e=Number(e),isNaN(e)||(O(e),B(n._tileset)&&(n._tileset.pointCloudShading.eyeDomeLightingRadius=e))}}),this.eyeDomeLightingRadius=1,this.pickActive=!1;var I=H.observable();H.defineProperty(this,"skipLevelOfDetail",{get:function(){return I()},set:function(e){I(e),B(n._tileset)&&(n._tileset.skipLevelOfDetail=e)}}),this.skipLevelOfDetail=!0;var M=H.observable();H.defineProperty(this,"skipScreenSpaceErrorFactor",{get:function(){return M()},set:function(e){e=Number(e),isNaN(e)||(M(e),B(n._tileset)&&(n._tileset.skipScreenSpaceErrorFactor=e))}}),this.skipScreenSpaceErrorFactor=16;var R=H.observable();H.defineProperty(this,"baseScreenSpaceError",{get:function(){return R()},set:function(e){e=Number(e),isNaN(e)||(R(e),B(n._tileset)&&(n._tileset.baseScreenSpaceError=e))}}),this.baseScreenSpaceError=1024;var L=H.observable();H.defineProperty(this,"skipLevels",{get:function(){return L()},set:function(e){e=Number(e),isNaN(e)||(L(e),B(n._tileset)&&(n._tileset.skipLevels=e))}}),this.skipLevels=1;var N=H.observable();H.defineProperty(this,"immediatelyLoadDesiredLevelOfDetail",{get:function(){return N()},set:function(e){N(e),B(n._tileset)&&(n._tileset.immediatelyLoadDesiredLevelOfDetail=e)}}),this.immediatelyLoadDesiredLevelOfDetail=!1;var k=H.observable();H.defineProperty(this,"loadSiblings",{get:function(){k()},set:function(e){k(e),B(n._tileset)&&(n._tileset.loadSiblings=e)}}),this.loadSiblings=!1,this._style=void 0,this._shouldStyle=!1,this._definedProperties=["properties","dynamicScreenSpaceError","colorBlendMode","picking","colorize","wireframe","showBoundingVolumes","showContentBoundingVolumes","showRequestVolumes","freezeFrame","maximumScreenSpaceError","dynamicScreenSpaceErrorDensity","baseScreenSpaceError","skipScreenSpaceErrorFactor","skipLevelOfDetail","skipLevels","immediatelyLoadDesiredLevelOfDetail","loadSiblings","dynamicScreenSpaceErrorDensitySliderValue","dynamicScreenSpaceErrorFactor","pickActive","showOnlyPickedTileDebugLabel","showGeometricError","showRenderingStatistics","showMemoryUsage","showUrl","pointCloudShading","geometricErrorScale","maximumAttenuation","baseResolution","eyeDomeLighting","eyeDomeLightingStrength","eyeDomeLightingRadius"],this._removePostRenderEvent=i.postRender.addEventListener(function(){n._update()}),B(this._tileset)||j(this,!0)}function h(e){if(0<e.featuresLength)return!0;var t=e.innerContents;if(B(t)){for(var r=t.length,i=0;i<r;++i)if(!h(t[i]))return!1;return!0}return!1}return e(d.prototype,{scene:{get:function(){return this._scene}},performanceContainer:{get:function(){return this._performanceContainer}},statisticsText:{get:function(){return this._statisticsText}},pickStatisticsText:{get:function(){return this._pickStatisticsText}},colorBlendModes:{get:function(){return a}},editorError:{get:function(){return this._editorError}},tileset:{get:function(){return this._tileset},set:function(e){if(this._tileset=e,this._style=void 0,this.styleString="{}",this.feature=void 0,this.tile=void 0,B(e)){var t=this;e.readyPromise.then(function(e){t.isDestroyed()||t._properties(e.properties)});for(var r=["colorize","wireframe","showBoundingVolumes","showContentBoundingVolumes","showRequestVolumes","freezeFrame","showOnlyPickedTileDebugLabel","showGeometricError","showRenderingStatistics","showMemoryUsage","showUrl"],i=r.length,n=0;n<i;++n){var o=r[n];this[o]=this[o]}this.maximumScreenSpaceError=e.maximumScreenSpaceError,this.dynamicScreenSpaceError=e.dynamicScreenSpaceError,this.dynamicScreenSpaceErrorDensity=e.dynamicScreenSpaceErrorDensity,this.dynamicScreenSpaceErrorFactor=e.dynamicScreenSpaceErrorFactor,this.colorBlendMode=e.colorBlendMode,this.skipLevelOfDetail=e.skipLevelOfDetail,this.skipScreenSpaceErrorFactor=e.skipScreenSpaceErrorFactor,this.baseScreenSpaceError=e.baseScreenSpaceError,this.skipLevels=e.skipLevels,this.immediatelyLoadDesiredLevelOfDetail=e.immediatelyLoadDesiredLevelOfDetail,this.loadSiblings=e.loadSiblings;var a=e.pointCloudShading;this.pointCloudShading=a.attenuation,this.geometricErrorScale=a.geometricErrorScale,this.maximumAttenuation=a.maximumAttenuation?a.maximumAttenuation:0,this.baseResolution=a.baseResolution?a.baseResolution:0,this.eyeDomeLighting=a.eyeDomeLighting,this.eyeDomeLightingStrength=a.eyeDomeLightingStrength,this.eyeDomeLightingRadius=a.eyeDomeLightingRadius,this._scene.requestRender()}else this._properties({});this._statisticsText=s(e,!1),this._pickStatisticsText=s(e,!0),j(this,!1)}},feature:{get:function(){return this._feature},set:function(e){if(this._feature!==e){var t=this._feature;if(B(t)&&!t.content.isDestroyed()){var r=this._scene.frameState;!this.colorize&&B(this._style)?t.color=B(this._style.color)?this._style.color.evaluateColor(r,t,u):i.WHITE:t.color=c,this._scene.requestRender()}B(e)&&(i.clone(e.color,c),e.color=l,this._scene.requestRender()),this._feature=e}}},tile:{get:function(){return this._tile},set:function(e){if(this._tile!==e){var t=this._tile;!B(t)||t.isDestroyed()||h(t.content)||(t.color=c,this._scene.requestRender()),B(e)&&!h(e.content)&&(i.clone(e.color,c),e.color=l,this._scene.requestRender()),this._tile=e}}}}),d.prototype.togglePickTileset=function(){this.pickActive=!this.pickActive},d.prototype.toggleInspector=function(){this.inspectorVisible=!this.inspectorVisible},d.prototype.toggleTileset=function(){this.tilesetVisible=!this.tilesetVisible},d.prototype.toggleDisplay=function(){this.displayVisible=!this.displayVisible},d.prototype.toggleUpdate=function(){this.updateVisible=!this.updateVisible},d.prototype.toggleLogging=function(){this.loggingVisible=!this.loggingVisible},d.prototype.toggleStyle=function(){this.styleVisible=!this.styleVisible},d.prototype.toggleTileDebugLabels=function(){this.tileDebugLabelsVisible=!this.tileDebugLabelsVisible},d.prototype.toggleOptimization=function(){this.optimizationVisible=!this.optimizationVisible},d.prototype.trimTilesCache=function(){B(this._tileset)&&this._tileset.trimLoadedTiles()},d.prototype.compileStyle=function(){var e=this._tileset;if(B(e)&&this.styleString!==JSON.stringify(e.style)){this._editorError="";try{0===this.styleString.length&&(this.styleString="{}"),this._style=new t(JSON.parse(this.styleString)),this._shouldStyle=!0,this._scene.requestRender()}catch(e){this._editorError=e.toString()}this.feature=this._feature,this.tile=this._tile}},d.prototype.styleEditorKeyPress=function(e,t){if(9===t.keyCode){t.preventDefault();var r,i=t.target,n=i.selectionStart,o=i.selectionEnd,a=o,s=i.value.slice(n,o).split("\n"),l=s.length;if(t.shiftKey)for(r=0;r<l;++r)" "===s[r][0]&&(" "===s[r][1]?(s[r]=s[r].substr(2),a-=2):(s[r]=s[r].substr(1),a-=1));else for(r=0;r<l;++r)s[r]="  "+s[r],a+=2;var u=s.join("\n");i.value=i.value.slice(0,n)+u+i.value.slice(o),i.selectionStart=n!==o?n:a,i.selectionEnd=a}else!t.ctrlKey||10!==t.keyCode&&13!==t.keyCode||this.compileStyle();return!0},d.prototype._update=function(){var e=this._tileset;if(this.performance&&this._performanceDisplay.update(),B(e)){if(e.isDestroyed())return this.tile=void 0,this.feature=void 0,void(this.tileset=void 0);var t=e.style;this._style!==e.style&&(this._shouldStyle?(e.style=this._style,this._shouldStyle=!1):(this._style=t,this.styleString=JSON.stringify(t.style,null,"  ")))}this.showStatistics&&(this._statisticsText=s(e,!1),this._pickStatisticsText=s(e,!0))},d.prototype.isDestroyed=function(){return!1},d.prototype.destroy=function(){this._eventHandler.destroy(),this._removePostRenderEvent();var t=this;return this._definedProperties.forEach(function(e){H.getObservable(t,e).dispose()}),r(this)},d.getStatistics=s,d}),define("Widgets/Cesium3DTilesInspector/Cesium3DTilesInspector",["../../Core/Check","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../ThirdParty/knockout","../getElement","./Cesium3DTilesInspectorViewModel"],function(k,c,o,e,t,F,B,U){"use strict";function r(e,t){k.defined("container",e),k.typeOf.object("scene",t),e=B(e);var r=document.createElement("div"),i=document.createElement("div");i.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : performance, "cesium-cesiumInspector-hide" : !performance}');var n=new U(t,i);this._viewModel=n,this._container=e,this._element=r;var o=document.createElement("div");o.textContent="3D Tiles Inspector",o.className="cesium-cesiumInspector-button",o.setAttribute("data-bind","click: toggleInspector"),r.appendChild(o),r.className="cesium-cesiumInspector cesium-3DTilesInspector",r.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : inspectorVisible, "cesium-cesiumInspector-hidden" : !inspectorVisible}'),e.appendChild(r);var a=document.createElement("div"),s=document.createElement("div"),l=document.createElement("div"),u=document.createElement("div"),c=document.createElement("div"),d=document.createElement("div"),h=document.createElement("div"),p=document.createElement("div");p.className="field-group";var f=document.createElement("label");f.className="field-label",f.appendChild(document.createTextNode("Properties: "));var m=document.createElement("div");m.setAttribute("data-bind","text: properties"),p.appendChild(f),p.appendChild(m),a.appendChild(p),a.appendChild(G("togglePickTileset","Pick Tileset","pickActive")),a.appendChild(G("trimTilesCache","Trim Tiles Cache")),a.appendChild(z("picking","Enable Picking")),s.appendChild(z("colorize","Colorize")),s.appendChild(z("wireframe","Wireframe")),s.appendChild(z("showBoundingVolumes","Bounding Volumes")),s.appendChild(z("showContentBoundingVolumes","Content Volumes")),s.appendChild(z("showRequestVolumes","Request Volumes")),s.appendChild(z("pointCloudShading","Point Cloud Shading"));var g=document.createElement("div");g.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : pointCloudShading, "cesium-cesiumInspector-hide" : !pointCloudShading}'),g.appendChild(q("geometricErrorScale",0,2,.01,"Geometric Error Scale")),g.appendChild(q("maximumAttenuation",0,32,1,"Maximum Attenuation")),g.appendChild(q("baseResolution",0,1,.01,"Base Resolution")),g.appendChild(z("eyeDomeLighting","Eye Dome Lighting (EDL)")),s.appendChild(g);var _=document.createElement("div");_.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : eyeDomeLighting, "cesium-cesiumInspector-hide" : !eyeDomeLighting}'),_.appendChild(q("eyeDomeLightingStrength",0,2,.1,"EDL Strength")),_.appendChild(q("eyeDomeLightingRadius",0,4,.1,"EDL Radius")),g.appendChild(_),l.appendChild(z("freezeFrame","Freeze Frame")),l.appendChild(z("dynamicScreenSpaceError","Dynamic Screen Space Error"));var v=document.createElement("div");v.appendChild(q("maximumScreenSpaceError",0,128,1,"Maximum Screen Space Error")),l.appendChild(v);var y=document.createElement("div");y.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : dynamicScreenSpaceError, "cesium-cesiumInspector-hide" : !dynamicScreenSpaceError}'),y.appendChild(q("dynamicScreenSpaceErrorDensitySliderValue",0,1,.005,"Screen Space Error Density","dynamicScreenSpaceErrorDensity")),y.appendChild(q("dynamicScreenSpaceErrorFactor",1,10,.1,"Screen Space Error Factor")),l.appendChild(y),u.appendChild(z("performance","Performance")),u.appendChild(i),u.appendChild(z("showStatistics","Statistics"));var b=document.createElement("div");b.className="cesium-3dTilesInspector-statistics",b.setAttribute("data-bind","html: statisticsText, visible: showStatistics"),u.appendChild(b),u.appendChild(z("showPickStatistics","Pick Statistics"));var C=document.createElement("div");C.className="cesium-3dTilesInspector-statistics",C.setAttribute("data-bind","html: pickStatisticsText, visible: showPickStatistics"),u.appendChild(C),d.appendChild(document.createTextNode("Color Blend Mode: "));var w=document.createElement("select");w.setAttribute("data-bind",'options: colorBlendModes, optionsText: "text", optionsValue: "value", value: colorBlendMode'),d.appendChild(w);var S=document.createElement("textarea");S.setAttribute("data-bind","textInput: styleString, event: { keydown: styleEditorKeyPress }"),d.className="cesium-cesiumInspector-styleEditor",d.appendChild(S);var T=G("compileStyle","Compile (Ctrl+Enter)");d.appendChild(T);var E=document.createElement("div");E.className="cesium-cesiumInspector-error",E.setAttribute("data-bind","text: editorError"),d.appendChild(E),c.appendChild(z("showOnlyPickedTileDebugLabel","Show Picked Only")),c.appendChild(z("showGeometricError","Geometric Error")),c.appendChild(z("showRenderingStatistics","Rendering Statistics")),c.appendChild(z("showMemoryUsage","Memory Usage (MB)")),c.appendChild(z("showUrl","Url")),h.appendChild(z("skipLevelOfDetail","Skip Tile LODs"));var A=document.createElement("div");A.appendChild(q("skipScreenSpaceErrorFactor",1,50,1,"Skip SSE Factor")),h.appendChild(A);var x=document.createElement("div");x.appendChild(q("baseScreenSpaceError",0,4096,1,"SSE before skipping LOD")),h.appendChild(x);var P=document.createElement("div");P.appendChild(q("skipLevels",0,10,1,"Min. levels to skip")),h.appendChild(P),h.appendChild(z("immediatelyLoadDesiredLevelOfDetail","Load only tiles that meet the max. SSE.")),h.appendChild(z("loadSiblings","Load siblings of visible tiles."));var D=V("Tileset","tilesetVisible","toggleTileset",a),O=V("Display","displayVisible","toggleDisplay",s),I=V("Update","updateVisible","toggleUpdate",l),M=V("Logging","loggingVisible","toggleLogging",u),R=V("Tile Debug Labels","tileDebugLabelsVisible","toggleTileDebugLabels",c),L=V("Style","styleVisible","toggleStyle",d),N=V("Optimization","optimizationVisible","toggleOptimization",h);r.appendChild(D),r.appendChild(O),r.appendChild(I),r.appendChild(M),r.appendChild(R),r.appendChild(L),r.appendChild(N),F.applyBindings(n,r)}function V(e,t,r,i){var n=document.createElement("span");n.className="cesium-cesiumInspector-toggleSwitch",n.setAttribute("data-bind","text: "+t+' ? "-" : "+", click: '+r);var o=document.createElement("div");o.className="cesium-cesiumInspector-sectionHeader",o.appendChild(n),o.appendChild(document.createTextNode(e));var a=document.createElement("div");a.className="cesium-cesiumInspector-section",a.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : '+t+', "cesium-cesiumInspector-hide" : !'+t+"}"),a.appendChild(i);var s=document.createElement("div");return s.className="cesium-cesiumInspector-dropDown",s.appendChild(o),s.appendChild(a),s}function z(e,t){var r=document.createElement("input");r.type="checkbox",r.setAttribute("data-bind","checked: "+e);var i=document.createElement("div");return i.appendChild(r),i.appendChild(document.createTextNode(t)),i}function q(e,t,r,i,n,o){o=c(o,e);var a=document.createElement("input");a.setAttribute("data-bind","value: "+o),a.type="number";var s=document.createElement("input");s.type="range",s.min=t,s.max=r,s.step=i,s.setAttribute("data-bind",'valueUpdate: "input", value: '+e);var l=document.createElement("div");l.appendChild(s);var u=document.createElement("div");return u.className="cesium-cesiumInspector-slider",u.appendChild(document.createTextNode(n)),u.appendChild(a),u.appendChild(l),u}function G(e,t,r){var i=document.createElement("button");i.type="button",i.textContent=t,i.className="cesium-cesiumInspector-pickButton";var n="click: "+e;return o(r)&&(n+=', css: {"cesium-cesiumInspector-pickButtonHighlight" : '+r+"}"),i.setAttribute("data-bind",n),i}return e(r.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return F.cleanNode(this._element),this._container.removeChild(this._element),this.viewModel.destroy(),t(this)},r}),define("Widgets/CesiumInspector/CesiumInspectorViewModel",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/Rectangle","../../Core/ScreenSpaceEventHandler","../../Core/ScreenSpaceEventType","../../Scene/DebugModelMatrixPrimitive","../../Scene/PerformanceDisplay","../../Scene/TileCoordinatesImageryProvider","../../ThirdParty/knockout","../createCommand"],function(h,e,t,s,p,l,u,f,m,g,_,v){"use strict";function y(e,t,r){var i=Math.min(r,t);return i=Math.max(i,e)}function r(e,t){if(!h(e))throw new s("scene is required");if(!h(t))throw new s("performanceContainer is required");var c=this,r=e.canvas,i=new l(r);this._eventHandler=i,this._scene=e,this._canvas=r,this._primitive=void 0,this._tile=void 0,this._modelMatrixPrimitive=void 0,this._performanceDisplay=void 0,this._performanceContainer=t;var n,d=this._scene.globe;function o(e){var t=c._scene.pick({x:e.position.x,y:e.position.y});h(t)&&(c.primitive=h(t.collection)?t.collection:t.primitive),c._scene.requestRender(),c.pickPrimitiveActive=!1}function a(e){var t,r=d.ellipsoid,i=c._scene.camera.pickEllipsoid({x:e.position.x,y:e.position.y},r);if(h(i))for(var n=r.cartesianToCartographic(i),o=d._surface.tileProvider._tilesToRenderByTextureCount,a=0;!t&&a<o.length;++a){var s=o[a];if(h(s))for(var l=0;!t&&l<s.length;++l){var u=s[l];p.contains(u.rectangle,n)&&(t=u)}}c.tile=t,c.pickTileActive=!1}d.depthTestAgainstTerrain=!0,this.frustums=!1,this.frustumPlanes=!1,this.performance=!1,this.shaderCacheText="",this.primitiveBoundingSphere=!1,this.primitiveReferenceFrame=!1,this.filterPrimitive=!1,this.tileBoundingSphere=!1,this.filterTile=!1,this.wireframe=!1,this.globeDepth=!1,this.pickDepth=!1,this.depthFrustum=1,this._numberOfFrustums=1,this.suspendUpdates=!1,this.tileCoordinates=!1,this.frustumStatisticText=!1,this.tileText="",this.hasPickedPrimitive=!1,this.hasPickedTile=!1,this.pickPrimitiveActive=!1,this.pickTileActive=!1,this.dropDownVisible=!0,this.generalVisible=!0,this.primitivesVisible=!1,this.terrainVisible=!1,this.depthFrustumText="",this.generalSwitchText=_.pureComputed(function(){return c.generalVisible?"-":"+"}),this.primitivesSwitchText=_.pureComputed(function(){return c.primitivesVisible?"-":"+"}),this.terrainSwitchText=_.pureComputed(function(){return c.terrainVisible?"-":"+"}),_.track(this,["frustums","frustumPlanes","performance","shaderCacheText","primitiveBoundingSphere","primitiveReferenceFrame","filterPrimitive","tileBoundingSphere","filterTile","wireframe","globeDepth","pickDepth","depthFrustum","suspendUpdates","tileCoordinates","frustumStatisticText","tileText","hasPickedPrimitive","hasPickedTile","pickPrimitiveActive","pickTileActive","dropDownVisible","generalVisible","primitivesVisible","terrainVisible","depthFrustumText"]),this._toggleDropDown=v(function(){c.dropDownVisible=!c.dropDownVisible}),this._toggleGeneral=v(function(){c.generalVisible=!c.generalVisible}),this._togglePrimitives=v(function(){c.primitivesVisible=!c.primitivesVisible}),this._toggleTerrain=v(function(){c.terrainVisible=!c.terrainVisible}),this._frustumsSubscription=_.getObservable(this,"frustums").subscribe(function(e){c._scene.debugShowFrustums=e,c._scene.requestRender()}),this._frustumPlanesSubscription=_.getObservable(this,"frustumPlanes").subscribe(function(e){c._scene.debugShowFrustumPlanes=e,c._scene.requestRender()}),this._performanceSubscription=_.getObservable(this,"performance").subscribe(function(e){e?c._performanceDisplay=new m({container:c._performanceContainer}):c._performanceContainer.innerHTML=""}),this._showPrimitiveBoundingSphere=v(function(){return c._primitive.debugShowBoundingVolume=c.primitiveBoundingSphere,c._scene.requestRender(),!0}),this._primitiveBoundingSphereSubscription=_.getObservable(this,"primitiveBoundingSphere").subscribe(function(){c._showPrimitiveBoundingSphere()}),this._showPrimitiveReferenceFrame=v(function(){if(c.primitiveReferenceFrame){var e=c._primitive.modelMatrix;c._modelMatrixPrimitive=new f({modelMatrix:e}),c._scene.primitives.add(c._modelMatrixPrimitive)}else h(c._modelMatrixPrimitive)&&(c._scene.primitives.remove(c._modelMatrixPrimitive),c._modelMatrixPrimitive=void 0);return c._scene.requestRender(),!0}),this._primitiveReferenceFrameSubscription=_.getObservable(this,"primitiveReferenceFrame").subscribe(function(){c._showPrimitiveReferenceFrame()}),this._doFilterPrimitive=v(function(){return c.filterPrimitive?c._scene.debugCommandFilter=function(e){return!(!h(c._modelMatrixPrimitive)||e.owner!==c._modelMatrixPrimitive._primitive)||!!h(c._primitive)&&(e.owner===c._primitive||e.owner===c._primitive._billboardCollection||e.owner.primitive===c._primitive)}:c._scene.debugCommandFilter=void 0,!0}),this._filterPrimitiveSubscription=_.getObservable(this,"filterPrimitive").subscribe(function(){c._doFilterPrimitive(),c._scene.requestRender()}),this._wireframeSubscription=_.getObservable(this,"wireframe").subscribe(function(e){d._surface.tileProvider._debug.wireframe=e,c._scene.requestRender()}),this._globeDepthSubscription=_.getObservable(this,"globeDepth").subscribe(function(e){c._scene.debugShowGlobeDepth=e,c._scene.requestRender()}),this._pickDepthSubscription=_.getObservable(this,"pickDepth").subscribe(function(e){c._scene.debugShowPickDepth=e,c._scene.requestRender()}),this._depthFrustumSubscription=_.getObservable(this,"depthFrustum").subscribe(function(e){c._scene.debugShowDepthFrustum=e,c._scene.requestRender()}),this._incrementDepthFrustum=v(function(){var e=c.depthFrustum+1;return c.depthFrustum=y(1,c._numberOfFrustums,e),c._scene.requestRender(),!0}),this._decrementDepthFrustum=v(function(){var e=c.depthFrustum-1;return c.depthFrustum=y(1,c._numberOfFrustums,e),c._scene.requestRender(),!0}),this._suspendUpdatesSubscription=_.getObservable(this,"suspendUpdates").subscribe(function(e){(d._surface._debug.suspendLodUpdate=e)||(c.filterTile=!1)}),this._showTileCoordinates=v(function(){return c.tileCoordinates&&!h(n)?n=e.imageryLayers.addImageryProvider(new g({tilingScheme:e.terrainProvider.tilingScheme})):!c.tileCoordinates&&h(n)&&(e.imageryLayers.remove(n),n=void 0),!0}),this._tileCoordinatesSubscription=_.getObservable(this,"tileCoordinates").subscribe(function(){c._showTileCoordinates(),c._scene.requestRender()}),this._tileBoundingSphereSubscription=_.getObservable(this,"tileBoundingSphere").subscribe(function(){c._showTileBoundingSphere(),c._scene.requestRender()}),this._showTileBoundingSphere=v(function(){return c.tileBoundingSphere?d._surface.tileProvider._debug.boundingSphereTile=c._tile:d._surface.tileProvider._debug.boundingSphereTile=void 0,c._scene.requestRender(),!0}),this._doFilterTile=v(function(){return c.filterTile?(c.suspendUpdates=!0,d._surface._tilesToRender=[],h(c._tile)&&c._tile.renderable&&d._surface._tilesToRender.push(c._tile)):c.suspendUpdates=!1,!0}),this._filterTileSubscription=_.getObservable(this,"filterTile").subscribe(function(){c.doFilterTile(),c._scene.requestRender()}),this._pickPrimitive=v(function(){c.pickPrimitiveActive=!c.pickPrimitiveActive}),this._pickPrimitiveActiveSubscription=_.getObservable(this,"pickPrimitiveActive").subscribe(function(e){e?i.setInputAction(o,u.LEFT_CLICK):i.removeInputAction(u.LEFT_CLICK)}),this._pickTile=v(function(){c.pickTileActive=!c.pickTileActive}),this._pickTileActiveSubscription=_.getObservable(this,"pickTileActive").subscribe(function(e){e?i.setInputAction(a,u.LEFT_CLICK):i.removeInputAction(u.LEFT_CLICK)}),this._removePostRenderEvent=e.postRender.addEventListener(function(){c._update()})}return e(r.prototype,{scene:{get:function(){return this._scene}},performanceContainer:{get:function(){return this._performanceContainer}},toggleDropDown:{get:function(){return this._toggleDropDown}},showPrimitiveBoundingSphere:{get:function(){return this._showPrimitiveBoundingSphere}},showPrimitiveReferenceFrame:{get:function(){return this._showPrimitiveReferenceFrame}},doFilterPrimitive:{get:function(){return this._doFilterPrimitive}},incrementDepthFrustum:{get:function(){return this._incrementDepthFrustum}},decrementDepthFrustum:{get:function(){return this._decrementDepthFrustum}},showTileCoordinates:{get:function(){return this._showTileCoordinates}},showTileBoundingSphere:{get:function(){return this._showTileBoundingSphere}},doFilterTile:{get:function(){return this._doFilterTile}},toggleGeneral:{get:function(){return this._toggleGeneral}},togglePrimitives:{get:function(){return this._togglePrimitives}},toggleTerrain:{get:function(){return this._toggleTerrain}},pickPrimitive:{get:function(){return this._pickPrimitive}},pickTile:{get:function(){return this._pickTile}},selectParent:{get:function(){var e=this;return v(function(){e.tile=e.tile.parent})}},selectNW:{get:function(){var e=this;return v(function(){e.tile=e.tile.northwestChild})}},selectNE:{get:function(){var e=this;return v(function(){e.tile=e.tile.northeastChild})}},selectSW:{get:function(){var e=this;return v(function(){e.tile=e.tile.southwestChild})}},selectSE:{get:function(){var e=this;return v(function(){e.tile=e.tile.southeastChild})}},primitive:{get:function(){return this._primitive},set:function(e){var t=this._primitive;e!==t&&(this.hasPickedPrimitive=!0,h(t)&&(t.debugShowBoundingVolume=!1),this._scene.debugCommandFilter=void 0,h(this._modelMatrixPrimitive)&&(this._scene.primitives.remove(this._modelMatrixPrimitive),this._modelMatrixPrimitive=void 0),(this._primitive=e).show=!1,setTimeout(function(){e.show=!0},50),this.showPrimitiveBoundingSphere(),this.showPrimitiveReferenceFrame(),this.doFilterPrimitive())}},tile:{get:function(){return this._tile},set:function(e){if(h(e)){if(this.hasPickedTile=!0,e!==this._tile){this.tileText="L: "+e.level+" X: "+e.x+" Y: "+e.y,this.tileText+="<br>SW corner: "+e.rectangle.west+", "+e.rectangle.south,this.tileText+="<br>NE corner: "+e.rectangle.east+", "+e.rectangle.north;var t=e.data;h(t)?this.tileText+="<br>Min: "+t.minimumHeight+" Max: "+t.maximumHeight:this.tileText+="<br>(Tile is not loaded)"}this._tile=e,this.showTileBoundingSphere(),this.doFilterTile()}else this.hasPickedTile=!1,this._tile=void 0}}}),r.prototype._update=function(){this.frustums&&(this.frustumStatisticText=function(e){var t;if(h(e)){t="Command Statistics";var r=e.commandsInFrustums;for(var i in r)if(r.hasOwnProperty(i)){var n,o=parseInt(i,10);if(7===o)n="1, 2 and 3";else{for(var a=[],s=2;0<=s;s--){var l=Math.pow(2,s);l<=o&&(a.push(s+1),o-=l)}n=a.reverse().join(" and ")}t+="<br>&nbsp;&nbsp;&nbsp;&nbsp;"+r[i]+" in frustum "+n}t+="<br>Total: "+e.totalCommands}return t}(this._scene.debugFrustumStatistics));var e=this._scene.numberOfFrustums;this._numberOfFrustums=e,this.depthFrustum=y(1,e,this.depthFrustum),this.depthFrustumText=this.depthFrustum+" of "+e,this.performance&&this._performanceDisplay.update(),this.primitiveReferenceFrame&&(this._modelMatrixPrimitive.modelMatrix=this._primitive.modelMatrix),this.shaderCacheText="Cached shaders: "+this._scene.context.shaderCache.numberOfShaders},r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return this._eventHandler.destroy(),this._removePostRenderEvent(),this._frustumsSubscription.dispose(),this._frustumPlanesSubscription.dispose(),this._performanceSubscription.dispose(),this._primitiveBoundingSphereSubscription.dispose(),this._primitiveReferenceFrameSubscription.dispose(),this._filterPrimitiveSubscription.dispose(),this._wireframeSubscription.dispose(),this._globeDepthSubscription.dispose(),this._pickDepthSubscription.dispose(),this._depthFrustumSubscription.dispose(),this._suspendUpdatesSubscription.dispose(),this._tileCoordinatesSubscription.dispose(),this._tileBoundingSphereSubscription.dispose(),this._filterTileSubscription.dispose(),this._pickPrimitiveActiveSubscription.dispose(),this._pickTileActiveSubscription.dispose(),t(this)},r}),define("Widgets/CesiumInspector/CesiumInspector",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./CesiumInspectorViewModel"],function(ge,e,t,_e,ve,ye,be){"use strict";function r(e,t){if(!ge(e))throw new _e("container is required.");if(!ge(t))throw new _e("scene is required.");e=ye(e);var r=document.createElement("div"),i=new be(t,r);this._viewModel=i,this._container=e;var n=document.createElement("div");this._element=n;var o=document.createElement("div");o.textContent="Cesium Inspector",o.className="cesium-cesiumInspector-button",o.setAttribute("data-bind","click: toggleDropDown"),n.appendChild(o),n.className="cesium-cesiumInspector",n.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : dropDownVisible, "cesium-cesiumInspector-hidden" : !dropDownVisible }'),e.appendChild(this._element);var a=document.createElement("div");(this._panel=a).className="cesium-cesiumInspector-dropDown",n.appendChild(a);var s=document.createElement("div");s.className="cesium-cesiumInspector-sectionHeader";var l=document.createElement("span");l.className="cesium-cesiumInspector-toggleSwitch",l.setAttribute("data-bind","click: toggleGeneral, text: generalSwitchText"),s.appendChild(l),s.appendChild(document.createTextNode("General")),a.appendChild(s);var u=document.createElement("div");u.className="cesium-cesiumInspector-section",u.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : generalVisible, "cesium-cesiumInspector-hide" : !generalVisible}'),a.appendChild(u);var c=document.createElement("div");u.appendChild(c);var d=document.createElement("div");d.className="cesium-cesiumInspector-frustumStatistics",d.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : frustums, "cesium-cesiumInspector-hide" :  !frustums}, html: frustumStatisticText');var h=document.createElement("input");h.type="checkbox",h.setAttribute("data-bind","checked: frustums"),c.appendChild(h),c.appendChild(document.createTextNode("Show Frustums")),c.appendChild(d);var p=document.createElement("div");u.appendChild(p);var f=document.createElement("input");f.type="checkbox",f.setAttribute("data-bind","checked: frustumPlanes"),p.appendChild(f),p.appendChild(document.createTextNode("Show Frustum Planes"));var m=document.createElement("div");u.appendChild(m);var g=document.createElement("input");g.type="checkbox",g.setAttribute("data-bind","checked: performance"),m.appendChild(g),m.appendChild(document.createTextNode("Performance Display")),r.className="cesium-cesiumInspector-performanceDisplay",u.appendChild(r);var _=document.createElement("div");_.className="cesium-cesiumInspector-shaderCache",_.setAttribute("data-bind","html: shaderCacheText"),u.appendChild(_);var v=document.createElement("div");u.appendChild(v);var y=document.createElement("input");y.type="checkbox",y.setAttribute("data-bind","checked: globeDepth"),v.appendChild(y),v.appendChild(document.createTextNode("Show globe depth"));var b=document.createElement("div");v.appendChild(b);var C=document.createElement("div");u.appendChild(C);var w=document.createElement("input");w.type="checkbox",w.setAttribute("data-bind","checked: pickDepth"),C.appendChild(w),C.appendChild(document.createTextNode("Show pick depth"));var S=document.createElement("div");u.appendChild(S);var T=document.createElement("span");T.setAttribute("data-bind",'html: "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Frustum:"'),S.appendChild(T);var E=document.createElement("span");E.setAttribute("data-bind","text: depthFrustumText"),S.appendChild(E);var A=document.createElement("input");A.type="button",A.value="-",A.className="cesium-cesiumInspector-pickButton",A.setAttribute("data-bind","click: decrementDepthFrustum"),S.appendChild(A);var x=document.createElement("input");x.type="button",x.value="+",x.className="cesium-cesiumInspector-pickButton",x.setAttribute("data-bind","click: incrementDepthFrustum"),S.appendChild(x);var P=document.createElement("div");P.className="cesium-cesiumInspector-sectionHeader",(l=document.createElement("span")).className="cesium-cesiumInspector-toggleSwitch",l.setAttribute("data-bind","click: togglePrimitives, text: primitivesSwitchText"),P.appendChild(l),P.appendChild(document.createTextNode("Primitives")),a.appendChild(P);var D=document.createElement("div");D.className="cesium-cesiumInspector-section",D.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : primitivesVisible, "cesium-cesiumInspector-hide" : !primitivesVisible}'),a.appendChild(D);var O=document.createElement("div");O.className="cesium-cesiumInspector-pickSection",D.appendChild(O);var I=document.createElement("input");I.type="button",I.value="Pick a primitive",I.className="cesium-cesiumInspector-pickButton",I.setAttribute("data-bind",'css: {"cesium-cesiumInspector-pickButtonHighlight" : pickPrimitiveActive}, click: pickPrimitive');var M=document.createElement("div");M.className="cesium-cesiumInspector-center",M.appendChild(I),O.appendChild(M);var R=document.createElement("div");O.appendChild(R);var L=document.createElement("input");L.type="checkbox",L.setAttribute("data-bind","checked: primitiveBoundingSphere, enable: hasPickedPrimitive"),R.appendChild(L),R.appendChild(document.createTextNode("Show bounding sphere"));var N=document.createElement("div");O.appendChild(N);var k=document.createElement("input");k.type="checkbox",k.setAttribute("data-bind","checked: primitiveReferenceFrame, enable: hasPickedPrimitive"),N.appendChild(k),N.appendChild(document.createTextNode("Show reference frame"));var F=document.createElement("div");this._primitiveOnly=F,O.appendChild(F);var B=document.createElement("input");B.type="checkbox",B.setAttribute("data-bind","checked: filterPrimitive, enable: hasPickedPrimitive"),F.appendChild(B),F.appendChild(document.createTextNode("Show only selected"));var U=document.createElement("div");U.className="cesium-cesiumInspector-sectionHeader",(l=document.createElement("span")).className="cesium-cesiumInspector-toggleSwitch",l.setAttribute("data-bind","click: toggleTerrain, text: terrainSwitchText"),U.appendChild(l),U.appendChild(document.createTextNode("Terrain")),a.appendChild(U);var V=document.createElement("div");V.className="cesium-cesiumInspector-section",V.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : terrainVisible, "cesium-cesiumInspector-hide" :  !terrainVisible}'),a.appendChild(V);var z=document.createElement("div");z.className="cesium-cesiumInspector-pickSection",V.appendChild(z);var q=document.createElement("input");q.type="button",q.value="Pick a tile",q.className="cesium-cesiumInspector-pickButton",q.setAttribute("data-bind",'css: {"cesium-cesiumInspector-pickButtonHighlight" : pickTileActive}, click: pickTile'),(M=document.createElement("div")).appendChild(q),M.className="cesium-cesiumInspector-center",z.appendChild(M);var G=document.createElement("div");z.appendChild(G);var W=document.createElement("input");W.type="button",W.value="Parent",W.className="cesium-cesiumInspector-pickButton",W.setAttribute("data-bind","click: selectParent");var H=document.createElement("input");H.type="button",H.value="NW",H.className="cesium-cesiumInspector-pickButton",H.setAttribute("data-bind","click: selectNW");var j=document.createElement("input");j.type="button",j.value="NE",j.className="cesium-cesiumInspector-pickButton",j.setAttribute("data-bind","click: selectNE");var Y=document.createElement("input");Y.type="button",Y.value="SW",Y.className="cesium-cesiumInspector-pickButton",Y.setAttribute("data-bind","click: selectSW");var X=document.createElement("input");X.type="button",X.value="SE",X.className="cesium-cesiumInspector-pickButton",X.setAttribute("data-bind","click: selectSE");var Q=document.createElement("div");Q.className="cesium-cesiumInspector-tileText",G.className="cesium-cesiumInspector-frustumStatistics",G.appendChild(Q),G.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : hasPickedTile, "cesium-cesiumInspector-hide" :  !hasPickedTile}'),Q.setAttribute("data-bind","html: tileText");var Z=document.createElement("div");Z.className="cesium-cesiumInspector-relativeText",Z.textContent="Select relative:",G.appendChild(Z);var K=document.createElement("table"),J=document.createElement("tr"),$=document.createElement("tr"),ee=document.createElement("td");ee.appendChild(W);var te=document.createElement("td");te.appendChild(H);var re=document.createElement("td");re.appendChild(j),J.appendChild(ee),J.appendChild(te),J.appendChild(re);var ie=document.createElement("td"),ne=document.createElement("td");ne.appendChild(Y);var oe=document.createElement("td");oe.appendChild(X),$.appendChild(ie),$.appendChild(ne),$.appendChild(oe),K.appendChild(J),K.appendChild($),G.appendChild(K);var ae=document.createElement("div");z.appendChild(ae);var se=document.createElement("input");se.type="checkbox",se.setAttribute("data-bind","checked: tileBoundingSphere, enable: hasPickedTile"),ae.appendChild(se),ae.appendChild(document.createTextNode("Show bounding volume"));var le=document.createElement("div");z.appendChild(le);var ue=document.createElement("input");ue.type="checkbox",ue.setAttribute("data-bind","checked: filterTile, enable: hasPickedTile"),le.appendChild(ue),le.appendChild(document.createTextNode("Show only selected"));var ce=document.createElement("div");V.appendChild(ce);var de=document.createElement("input");de.type="checkbox",de.setAttribute("data-bind","checked: wireframe"),ce.appendChild(de),ce.appendChild(document.createTextNode("Wireframe"));var he=document.createElement("div");V.appendChild(he);var pe=document.createElement("input");pe.type="checkbox",pe.setAttribute("data-bind","checked: suspendUpdates"),he.appendChild(pe),he.appendChild(document.createTextNode("Suspend LOD update"));var fe=document.createElement("div");V.appendChild(fe);var me=document.createElement("input");me.type="checkbox",me.setAttribute("data-bind","checked: tileCoordinates"),fe.appendChild(me),fe.appendChild(document.createTextNode("Show tile coordinates")),ve.applyBindings(i,this._element)}return e(r.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return ve.cleanNode(this._element),this._container.removeChild(this._element),this.viewModel.destroy(),t(this)},r}),define("Widgets/CesiumWidget/CesiumWidget",["../../Core/buildModuleUrl","../../Core/Cartesian3","../../Core/Clock","../../Core/Credit","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/Ellipsoid","../../Core/FeatureDetection","../../Core/formatError","../../Core/requestAnimationFrame","../../Core/ScreenSpaceEventHandler","../../Scene/BingMapsImageryProvider","../../Scene/Globe","../../Scene/Moon","../../Scene/Scene","../../Scene/SceneMode","../../Scene/ShadowMode","../../Scene/SkyAtmosphere","../../Scene/SkyBox","../../Scene/Sun","../getElement"],function(t,v,y,b,C,w,e,r,S,T,E,f,s,A,x,P,D,O,I,M,R,L,N,k){"use strict";function F(e){return t("Assets/Textures/SkyBox/tycho2t3_80_"+e+".jpg")}function B(e){var t=e._canvas,r=t.clientWidth,i=t.clientHeight,n=e._resolutionScale;e._supportsImageRenderingPixelated||(n*=C(window.devicePixelRatio,1)),e._canvasWidth=r,e._canvasHeight=i,r*=n,i*=n,t.width=r,t.height=i,e._canRender=0!==r&&0!==i}function U(e){var t=e._canvas,r=t.width,i=t.height;if(0!==r&&0!==i){var n=e._scene.camera.frustum;w(n.aspectRatio)?n.aspectRatio=r/i:(n.top=n.right*(i/r),n.bottom=-n.top)}}function i(e,t){if(!w(e))throw new S("container is required.");e=k(e),t=C(t,{});var r=document.createElement("div");r.className="cesium-widget",e.appendChild(r);var i=document.createElement("canvas"),n=E.supportsImageRenderingPixelated();(this._supportsImageRenderingPixelated=n)&&(i.style.imageRendering=E.imageRenderingValue()),i.oncontextmenu=function(){return!1},i.onselectstart=function(){return!1},r.appendChild(i);var o=document.createElement("div");o.className="cesium-widget-credits";var a=w(t.creditContainer)?k(t.creditContainer):r;a.appendChild(o);var s=w(t.creditViewport)?k(t.creditViewport):r,l=C(t.showRenderLoopErrors,!0);this._element=r,this._container=e,this._canvas=i,this._canvasWidth=0,this._canvasHeight=0,this._creditViewport=s,this._creditContainer=a,this._innerCreditContainer=o,this._canRender=!1,this._renderLoopRunning=!1,this._showRenderLoopErrors=l,this._resolutionScale=1,this._forceResize=!1,this._clock=w(t.clock)?t.clock:new y,B(this);try{var u=new O({canvas:i,contextOptions:t.contextOptions,creditContainer:o,creditViewport:s,mapProjection:t.mapProjection,orderIndependentTranslucency:t.orderIndependentTranslucency,scene3DOnly:C(t.scene3DOnly,!1),terrainExaggeration:t.terrainExaggeration,shadows:t.shadows,mapMode2D:t.mapMode2D,requestRenderMode:t.requestRenderMode,maximumRenderTimeChange:t.maximumRenderTimeChange});(this._scene=u).camera.constrainedAxis=v.UNIT_Z,U(this);var c=C(u.mapProjection.ellipsoid,T.WGS84),d=u.frameState.creditDisplay,h=new b({text:"Cesium",imageUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHYAAAAeCAYAAAD5AOomAAAQWUlEQVR42u1beXxOxxpudrEktkbUkriI4lZpq5JbW6pJuFG0qrFeexVRak3TBm3RUgS1hFhrCdKgQWKLrUGQBiVBJMgiq0Qiuyxzn/fzTu74ZPnS9nfrj4zf8/ty5sw7M+c8824zx0svVa3oAfqAAWAIGAHGCoy43oDb6TGqywta9JgsIq4GUAswB+oDDRXU5/ragCm3N6gm+MUkVJ+1kAg1AyyA5oAN8BrQCXiTfzsArwLWgCVQF6jJBOtXk/tikWrMGkiEtgTeAOyBfsAQS0vL8YMHD/aws7ObiuthwAeAA/A20AZozAvCRNHe6vI3k2rCprUp8DoR1qVLF1c/P7+A5OTkhyUlJaKwuETkPSkRBUUlgkpmZmbW2bNnQyZOnLgA7Z2BzkALNtM1qsl9MTSVSLUCugADAwMDTxKZVI7cfCw8DiWK6fselMLtlwSxJyxDPM4vFsXFxSWRkZFRkBsOdAdaAw2qyf37ij77RDMm1a5evXojY2NjH5BW7ruaIab4xotPd8cJV/xO0cKkPXGae97n0kR6TpHIzs7O7d279xdsvoncemwJqn3u/1lbDTnqfYXN6JCUlJS03CfFwt0/4TkiK8IEEBydWiBIy21tbaejr24cWJlpBVT6ShpVFvS10iddZP6MbFkyqpw2Kor6K5P9M33onG1Iv0omsz3Q//79+7HpuUViDsys697KyZy89ynk9Wc/x4u7DwvE48ePs2mRcARtqUTLRjxmDa6rpYWanDqZKHmyzJ+lTFlyUrZGGbIm3GdF49VQcnMjZUwTJW83Ua4NtayQmlEYKW1NlOc11RrLoAxLpqdYUSmnPlOlbk1qa21OZ7ovX758E/lTz1MpOmvp5gvp4qeL6c8sAjLNOQXF4sKFC6Hotw+nSrR46rAfb8hkN+WxVTTlyPplNuNmDArGGgFNgGZloClbHQtua8bj1eW+GnObZspY2nL1WKaOkreraKDk7jXLsEJGXG+u1b4Bz/0VZayyUkO5f2DCc5DvyZL/1inb0ONVU5+1dSBMcHrIvRwNMbqQ6u6fKGSZ4POszFaQDZNc0q9fvzkcjFkzKf/gfJjSo3c40OrBoL+7cvvXeUFYM17l1MuOTbxEV8a/uE8pZ8Ww4bouPJ62bFlyzXmebRg2jLY8jxa8WGopxEiX9jLff1Vp357zfluefyeOPxpp9WHAGl2fn/k1do+Ef/K86lYWs+hzJ7SSbXv06OFGAfAMRLtlBUjkPyfuidMyw3Fi37UM8TMCLFVj6W9qW1BYIg4ePBjEWkukdCTyZsyYMcvX13f7iRMnDv36669B0OxTBKRNx4OCggIPHDiwa+XKld+j7Xv84v/l4+Oz6PLlywHnzp07Su0gdyw4OPgYXQNHzp8/f+TixYuHw8LCDuDeGiaLXqLj6tWrlyLC9ztz5gy1PwEcV3AU89i3detWT2NjYyeWedvLy2va77//7hcREeHfsWPH91HX6/r16/7h4eH+6H+ZVtQvN3ToujXm9wPJYS6+FhYWzggmh4eGhh6hsTHnE/j7eN++fQczWY1Yc6WrIVJb0SLEu9iJ93I0JCTkKMY+PHLkSGe2MLV5TL3ytgxr88pwuHLlyvXY9CcaH6mSR5HwwRuPRWZekTgXnfPcfW0QqfMDk0Qc+nqCnDc+Pj6FNzJoE+PfeDEXhQ6FtD0rKyu9Tp06LpAbBN9/S+hYEJmnck79EazQA5myVTKeyM/Pp7jgI2AAXv4JeW/AgAGzUTdKXj969CiOF04T1jhj/qXrzrgfQ+0KUdq1azdt6tSpntrjxcTEUGroyBrdkLmoy3x0HT9+vIe2zIoVK9y5fT0eU688/2rOJqY/bTRcjsl5hqRPYF5P38nSdJrwMErzezMpX1NfHrELjiQ9fbl56SIjO5leViH6nwwMnjZt2gL5EmWh/Lf4f+U5BtauXbsJshPu3LkTLQl/+PBhVmpqagZ+HxHS0tLSCShpGRkZqXhp12i8RYsWrVP7wr1ctM9E2wy0lch88uRJoWwTFRV1A7JjoVnBss7BwWEJ6ubIa/SRgOt32VybKduvZILtMbd4JraoZcuWC8eMGbNN+7noWTt06DCVXUIL9rtNOdj8uABFW+bbb7/9js34y4o5fo5YI14h7QwNDV1yc3MLAsIfP0PS9kvpmg6Db+wXn6/pKrwOztBcn7mTXWbEPHlPvMguKBFFxYXiq819hZu3k6Y9xpgFjN+xY8cBOcmkpKQ0rh8HDCUieHNjHExgmGwHQomkKbdu3bpP10VFRcU2NjZ7UbcKWATMB74C3IBpSn8jTp48eVb2k5iYSNq4BVjJcl8zFrq5ue3Py8vLB/Kg4USa6+nTp0OkLNwUmfYFckGiTRJZH1YKc3Zp5mye+yQnJydQOyyYImtr65XDhw/3lX2B7BJlgaSxhXiL+6K99z4wwadkG/RRLP/28PBYxpaiES+mcokllW4PczcUz1Twy++ZpSTRrhJtUCSnx4gvNzkL9419xBfevUVIxEHNIEuDUp4j90ZCHjSqUHj+/AnaOmnkmFgyIa6Y8Hk5SScnp6VMwLs82Tc5wOkJv9Tfz89v3f79+73xMPTyJyrEloCI8+PGjTs0adIkX1dXVx+Yuu2ff/75tlmzZm1A+xUDBw6kHHo4/GqQHA8Lt9DT0/OSu7v70SlTpuwdMmTIFhC2tlmzZivQ9geAtOFLgLRoGhbFJSnbrVu3DahbrEXs+4pZrMm/FGj1xaJNlMRaWVmtGTZs2D7ZV3R0dA6sWJG8Riayhd1GNzbNo0nTpWWbP3/+dYXY5fyOLCsjti5Hbh/hwfODbmeVkkS5rCgpFgt2DNaQKjHTy16kZsRpBpp1IKE0uNoSkqapO3llp2YBUFuPLf01Jgf9007UFAQCv8lJmpubf4Y6J478rNgMWfHL6cRBE+1e9SXTKInVpdy7d+8KmbOhQ4d+rasMLRjML5xMLlkSBFShCrEbiXxJLDQymQ8/2rN/lKkJXQ+AdUiSxDZv3nydSuzNmzczQWaEvIZbeESuhhf5mLt375Y+Z0BAQDQW7Dl5PXfu3KW6EGvIfoEisL6Ya+p1aBz5z/N3czQdbQ5w12ieSizhu13DEPHmajYiKDXyPJmiaX8t6pSYs8FB04bM8ObAL2ijIg/9zyCtU4lFBDqJA6p2nE/KPLMVmyRbToGcq0osAq0rrFEu8Eve5IfJhOsiCxN8FXJzjx07FqYQ6426JZJYaGQKu463eO4W/EvXLiqx0Ni1MMV+ig9PR5ut0PosWbd582bKHL50cXHZIOMMGqtJkybrQWZpEDdv3rwfdCHWgCM5yo3s/f39j9G8H2Y/tRKXbgUItw2Oz5EqSfMJWvT0dCefA5PsVPHNTx+VtpkFzb4Ve0ncuHHjLq/I0UhJSv1W27Zt57F/6cpp0Gv8awfz6Lxq1ar5P/7448KxY8eSH/5UNcUffPBBQKdOnTZ37tx5la2t7VI7O7vv33nnnYUwrR6Ojo7TEIm6sFkjckfxwvIAaMyvTE1NPRC4LEFQtAH9+yOVSFYiXvLFC48ePXpF1nXv3n09mWqF2Ie4/oTHeIM19Q2+/iQhISFVIXb1iBEj9irWhCL2pXPmzPlF9aOoW4+gL13W7d69+ywtMASApe1glhez2yqXWJnH1uDVRv5tpMY0PE4Qu4IWlkmoNlb6TRKRcaHiQoS/+Ir9sMTCnYM1q27NmjW+tIqJxMOHDwfISe7bty8YdZ8pZ7r9aZOEruE7F2lFqZ+pwRNI8WG/SGTNZuKm8gIawlrusGDBgi+wsEJ+Q8Fq38W+fg7LkHv4hoKwUaNGlWoFLEwuEatqrL29PQVq86TW5+Tk5LP8aDK9PN4AvnaXPhKBbSEW6bLRo0fvkH3FxsYmcaA3m6JzWR8ZGVlKKmUoHAhORFywSysqfqui4Enbz1JE5nz16tXwrNx0nUh9Gkw5QTPfFbPX93pWo6Hpp6740EqkVOc/lNzTZgM0cKVq9qAdmSlPS5IEHjaN8h7Z5iAKpUt48LsyTYCGPcBc7+L3DvLi2xEREYSbt2/fDkdwci0sLOwwRZfbt29frmhFIdpEgehIkqFfRN9RQAzmkSvbQdvIzLqdOnWqNN+GFaAoeircVYr68rHoohG138KYN+mXji1Rny1NKeKWXDMzM/cJEyZskHIPUMiX0ntp06aNm5riSYsA0+zLpn6Ql5fXRnl/8eLFX7NVsygv3VHNcU3ev+xC23800NlrvqUBUFVBckv3jNZMBNHnSvajr/OEHLDaM3X1lSCjoFGjRmRKhyGoiKziBgWZRWf0kSeqUGbOnOlJmod44Iys+/DDD8kiuMAULlMXXWUFUfkhIhB9LpZ1WBwxHBDSexmIBXFTlcHCeMQuqidh586dK+S91atXu3EkXp83KPQrOt0xZq2loMVh2bJlmmT6+OVt0MT3qkiqk1jsM0LkFWQL0iI2rx2UjXfyo73gPzZCu64iyIhHYJMMJU2RoJ0ikBiOiNBn0KBBY/gB7UNDQ3/B/QTcT1SRmpqaQEA/D3A/HtoXGxcXd07uy3bt2nUQSPKHJkbLthIsnwifGY/5/oZ0gnxwb5ojTPG6jIyMGCySBCz4gTJKnz59+szg4OBAjBEFkuIg+wxQojHXszD983hx9Zw8efI4EBZHgFYHsjnV7JdjfkMw50R+hnikauM4QKJspb23t/dkuAeaR9ySJUuG8Lusw9ZWr7KvEU15N4P2Lt9HZKjZdTkeuk3MRcpSVmT8DKEbe2vaePlPFyX4B8IoHfiYH6AJJ+/m7PRtuL47r9revJfch/92YDK78Hxas0xHDrTeU2R6c8rkWIZcK/5mqx1vondnWUeWUdGL++7EL9SG5Tooc2ihFbH3VPpzVOZgz4ugI6durVjLpNV6lRd5Y/5tx3Puxv3Kzf5G3KaFcpjQvCqfHKmH7Y15An3hqDeRWaZo1+fkIjFjXQ9NKiNNNJFJvpR87JLdI8X95HCNj6CjOtrJ4uituXLUZKwk8pbKCUpr5fSkNZNhxe6hIbeXR3bNFBlttOKX0Izb1mfZhtyXFcu20kFOfmZrwQteHtXJI8AmvKfbUulPLiRrTtvk8WFdPhyw4P4b8DupxZrXgOfXTHnmOvyu5P6x/NxX7nIZVuXA3Yg7asyrxoG+RER4HoMorzj/SY64ijw18OIm4Xd2uTh4fq04f+OASEy7pyGUvrqYPXv2CvYfb/JEzbUOlA342lR5MDNFo+UZam1+MBPlgNuU69X25mXI1lIO6qVsTUXWrAK5GloH49qH3Ophf21l/mZlzL2G1gG9aTkfEJgoHwDU1LpvqIxZ0eG8TuTKM8VWbCKcoYGj1q1btwehegJtPVIuSVEmnd8iQDhtbW3tamxs/CGbs7a8OOooDr68z1QMlQdUH0b7kxX1sxbDSmBQzqcoBpXIGJQjo/1ZSmVzqaivyvozqOB96f+Z78b0lLPFumwabFgDe3K+NpDz0kH8rXEvNrttWUvr6/DRuJ6O+CMyf0a2Ku+pqn390Xt/6QduBopPNFe2zFrJaI2dfmv2XZbsz2op5qL6v3m8oF8vqv9/R/oB+Q1RPf41U3yT0R+x/9Xlryn/BY268qsf3smdAAAAAElFTkSuQmCC",link:"https://cesiumjs.org/",showOnScreen:!0});d.addDefaultCredit(h);var p=t.globe;w(p)||(p=new P(c)),!1!==p&&(u.globe=p,u.globe.shadows=C(t.terrainShadows,M.RECEIVE_ONLY));var f=t.skyBox;w(f)||(f=new L({sources:{positiveX:F("px"),negativeX:F("mx"),positiveY:F("py"),negativeY:F("my"),positiveZ:F("pz"),negativeZ:F("mz")}})),!1!==f&&(u.skyBox=f,u.sun=new N,u.moon=new D);var m=t.skyAtmosphere;w(m)||(m=new R(c)),!1!==m&&(u.skyAtmosphere=m);var g=!1!==t.globe&&t.imageryProvider;w(g)||(g=new x({url:"https://dev.virtualearth.net"})),!1!==g&&u.imageryLayers.addImageryProvider(g),w(t.terrainProvider)&&!1!==t.globe&&(u.terrainProvider=t.terrainProvider),this._screenSpaceEventHandler=new A(i,!1),w(t.sceneMode)&&(t.sceneMode===I.SCENE2D&&this._scene.morphTo2D(0),t.sceneMode===I.COLUMBUS_VIEW&&this._scene.morphToColumbusView(0)),this._useDefaultRenderLoop=void 0,this.useDefaultRenderLoop=C(t.useDefaultRenderLoop,!0),this._targetFrameRate=void 0,this.targetFrameRate=t.targetFrameRate;var _=this;u.renderError.addEventListener(function(e,t){if(_._useDefaultRenderLoop=!1,_._renderLoopRunning=!1,_._showRenderLoopErrors){_.showErrorPanel("An error occurred while rendering.  Rendering has stopped.",void 0,t)}})}catch(e){if(l){this.showErrorPanel("Error constructing CesiumWidget.",'Visit <a href="http://get.webgl.org">http://get.webgl.org</a> to verify that your web browser and hardware support WebGL.  Consider trying a different web browser or updating your video drivers.  Detailed error information is below:',e)}throw e}}return e(i.prototype,{container:{get:function(){return this._container}},canvas:{get:function(){return this._canvas}},creditContainer:{get:function(){return this._creditContainer}},creditViewport:{get:function(){return this._creditViewport}},scene:{get:function(){return this._scene}},imageryLayers:{get:function(){return this._scene.imageryLayers}},terrainProvider:{get:function(){return this._scene.terrainProvider},set:function(e){this._scene.terrainProvider=e}},camera:{get:function(){return this._scene.camera}},clock:{get:function(){return this._clock}},screenSpaceEventHandler:{get:function(){return this._screenSpaceEventHandler}},targetFrameRate:{get:function(){return this._targetFrameRate},set:function(e){if(e<=0)throw new S("targetFrameRate must be greater than 0, or undefined.");this._targetFrameRate=e}},useDefaultRenderLoop:{get:function(){return this._useDefaultRenderLoop},set:function(e){this._useDefaultRenderLoop!==e&&(this._useDefaultRenderLoop=e)&&!this._renderLoopRunning&&function(o){o._renderLoopRunning=!0;var a=0;s(function e(t){if(!o.isDestroyed())if(o._useDefaultRenderLoop)try{var r=o._targetFrameRate;if(w(r)){var i=1e3/r,n=t-a;i<n&&(o.resize(),o.render(),a=t-n%i),s(e)}else o.resize(),o.render(),s(e)}catch(e){o._useDefaultRenderLoop=!1,o._renderLoopRunning=!1,o._showRenderLoopErrors&&o.showErrorPanel("An error occurred while rendering.  Rendering has stopped.",void 0,e)}else o._renderLoopRunning=!1})}(this)}},resolutionScale:{get:function(){return this._resolutionScale},set:function(e){if(e<=0)throw new S("resolutionScale must be greater than 0.");this._resolutionScale=e,this._forceResize=!0}}}),i.prototype.showErrorPanel=function(e,t,r){var i=this._element,n=document.createElement("div");n.className="cesium-widget-errorPanel";var o=document.createElement("div");o.className="cesium-widget-errorPanel-content",n.appendChild(o);var a=document.createElement("div");a.className="cesium-widget-errorPanel-header",a.appendChild(document.createTextNode(e)),o.appendChild(a);var s=document.createElement("div");function l(){s.style.maxHeight=Math.max(Math.round(.9*i.clientHeight-100),30)+"px"}if(s.className="cesium-widget-errorPanel-scroll",o.appendChild(s),l(),w(window.addEventListener)&&window.addEventListener("resize",l,!1),w(t)){var u=document.createElement("div");u.className="cesium-widget-errorPanel-message",u.innerHTML="<p>"+t+"</p>",s.appendChild(u)}var c="(no error details available)";w(r)&&(c=f(r));var d=document.createElement("div");d.className="cesium-widget-errorPanel-message",d.appendChild(document.createTextNode(c)),s.appendChild(d);var h=document.createElement("div");h.className="cesium-widget-errorPanel-buttonPanel",o.appendChild(h);var p=document.createElement("button");p.setAttribute("type","button"),p.className="cesium-button",p.appendChild(document.createTextNode("OK")),p.onclick=function(){w(l)&&w(window.removeEventListener)&&window.removeEventListener("resize",l,!1),i.removeChild(n)},h.appendChild(p),i.appendChild(n),"undefined"!=typeof console&&console.error(e+"\n"+t+"\n"+c)},i.prototype.isDestroyed=function(){return!1},i.prototype.destroy=function(){this._scene=this._scene&&this._scene.destroy(),this._container.removeChild(this._element),this._creditContainer.removeChild(this._innerCreditContainer),r(this)},i.prototype.resize=function(){var e=this._canvas,t=e.clientWidth,r=e.clientHeight;(this._forceResize||this._canvasWidth!==t||this._canvasHeight!==r)&&(this._forceResize=!1,B(this),U(this),this._scene.requestRender())},i.prototype.render=function(){if(this._canRender){this._scene.initializeFrame();var e=this._clock.tick();this._scene.render(e)}else this._clock.tick()},i}),define("Widgets/ClockViewModel",["../Core/Clock","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/EventHelper","../Core/JulianDate","../ThirdParty/knockout"],function(e,r,t,i,n,o,a){"use strict";function s(t){r(t)||(t=new e),this._clock=t,this._eventHelper=new n,this._eventHelper.add(t.onTick,this.synchronize,this),this.systemTime=a.observable(o.now()),this.systemTime.equalityComparer=o.equals,this.startTime=a.observable(t.startTime),this.startTime.equalityComparer=o.equals,this.startTime.subscribe(function(e){t.startTime=e,this.synchronize()},this),this.stopTime=a.observable(t.stopTime),this.stopTime.equalityComparer=o.equals,this.stopTime.subscribe(function(e){t.stopTime=e,this.synchronize()},this),this.currentTime=a.observable(t.currentTime),this.currentTime.equalityComparer=o.equals,this.currentTime.subscribe(function(e){t.currentTime=e,this.synchronize()},this),this.multiplier=a.observable(t.multiplier),this.multiplier.subscribe(function(e){t.multiplier=e,this.synchronize()},this),this.clockStep=a.observable(t.clockStep),this.clockStep.subscribe(function(e){t.clockStep=e,this.synchronize()},this),this.clockRange=a.observable(t.clockRange),this.clockRange.subscribe(function(e){t.clockRange=e,this.synchronize()},this),this.canAnimate=a.observable(t.canAnimate),this.canAnimate.subscribe(function(e){t.canAnimate=e,this.synchronize()},this),this.shouldAnimate=a.observable(t.shouldAnimate),this.shouldAnimate.subscribe(function(e){t.shouldAnimate=e,this.synchronize()},this),a.track(this,["systemTime","startTime","stopTime","currentTime","multiplier","clockStep","clockRange","canAnimate","shouldAnimate"])}return t(s.prototype,{clock:{get:function(){return this._clock}}}),s.prototype.synchronize=function(){var e=this._clock;this.systemTime=o.now(),this.startTime=e.startTime,this.stopTime=e.stopTime,this.currentTime=e.currentTime,this.multiplier=e.multiplier,this.clockStep=e.clockStep,this.clockRange=e.clockRange,this.canAnimate=e.canAnimate,this.shouldAnimate=e.shouldAnimate},s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){this._eventHelper.removeAll(),i(this)},s}),define("Widgets/Command",["../Core/DeveloperError"],function(e){"use strict";return function(){this.canExecute=void 0,this.beforeExecute=void 0,this.afterExecute=void 0,e.throwInstantiationError()}}),define("Widgets/FullscreenButton/FullscreenButtonViewModel",["../../Core/defaultValue","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/Fullscreen","../../ThirdParty/knockout","../createCommand","../getElement"],function(n,e,t,r,o,a,s,l){"use strict";function i(e){var t=this,r=a.observable(o.fullscreen),i=a.observable(o.enabled);this.isFullscreen=void 0,a.defineProperty(this,"isFullscreen",{get:function(){return r()}}),this.isFullscreenEnabled=void 0,a.defineProperty(this,"isFullscreenEnabled",{get:function(){return i()},set:function(e){i(e&&o.enabled)}}),this.tooltip=void 0,a.defineProperty(this,"tooltip",function(){return this.isFullscreenEnabled?r()?"Exit full screen":"Full screen":"Full screen unavailable"}),this._command=s(function(){o.fullscreen?o.exitFullscreen():o.requestFullscreen(t._fullscreenElement)},a.getObservable(this,"isFullscreenEnabled")),this._fullscreenElement=n(l(e),document.body),this._callback=function(){r(o.fullscreen)},document.addEventListener(o.changeEventName,this._callback)}return e(i.prototype,{fullscreenElement:{get:function(){return this._fullscreenElement},set:function(e){if(!(e instanceof Element))throw new r("value must be a valid Element.");this._fullscreenElement=e}},command:{get:function(){return this._command}}}),i.prototype.isDestroyed=function(){return!1},i.prototype.destroy=function(){document.removeEventListener(o.changeEventName,this._callback),t(this)},i}),define("Widgets/FullscreenButton/FullscreenButton",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./FullscreenButtonViewModel"],function(n,e,t,o,a,s,l){"use strict";function r(e,t){if(!n(e))throw new o("container is required.");e=s(e);var r=new l(t);r._exitFullScreenPath="M 104.34375 17.5625 L 83.5 38.4375 L 83.40625 18.21875 L 76.125 25.5 L 76.09375 51.78125 L 102.3125 51.8125 L 102.3125 51.78125 L 109.625 44.5 L 89.1875 44.40625 L 110.1875 23.40625 L 104.34375 17.5625 z M 23.75 17.59375 L 17.90625 23.4375 L 38.90625 44.4375 L 18.5 44.53125 L 25.78125 51.8125 L 52 51.78125 L 51.96875 25.53125 L 44.6875 18.25 L 44.625 38.46875 L 23.75 17.59375 z M 25.6875 76.03125 L 18.375 83.3125 L 38.78125 83.40625 L 17.8125 104.40625 L 23.625 110.25 L 44.5 89.375 L 44.59375 109.59375 L 51.875 102.3125 L 51.875 76.0625 L 25.6875 76.03125 z M 102.375 76.15625 L 76.15625 76.1875 L 76.1875 102.4375 L 83.46875 109.71875 L 83.5625 89.53125 L 104.40625 110.375 L 110.25 104.53125 L 89.25 83.53125 L 109.6875 83.46875 L 102.375 76.15625 z",r._enterFullScreenPath="M 83.96875 17.5625 L 83.96875 17.59375 L 76.65625 24.875 L 97.09375 24.96875 L 76.09375 45.96875 L 81.9375 51.8125 L 102.78125 30.9375 L 102.875 51.15625 L 110.15625 43.875 L 110.1875 17.59375 L 83.96875 17.5625 z M 44.125 17.59375 L 17.90625 17.625 L 17.9375 43.90625 L 25.21875 51.1875 L 25.3125 30.96875 L 46.15625 51.8125 L 52 45.96875 L 31 25 L 51.4375 24.90625 L 44.125 17.59375 z M 46.0625 76.03125 L 25.1875 96.875 L 25.09375 76.65625 L 17.8125 83.9375 L 17.8125 110.21875 L 44 110.25 L 51.3125 102.9375 L 30.90625 102.84375 L 51.875 81.875 L 46.0625 76.03125 z M 82 76.15625 L 76.15625 82 L 97.15625 103 L 76.71875 103.0625 L 84.03125 110.375 L 110.25 110.34375 L 110.21875 84.0625 L 102.9375 76.8125 L 102.84375 97 L 82 76.15625 z";var i=document.createElement("button");i.type="button",i.className="cesium-button cesium-fullscreenButton",i.setAttribute("data-bind","attr: { title: tooltip },click: command,enable: isFullscreenEnabled,cesiumSvgPath: { path: isFullscreen ? _exitFullScreenPath : _enterFullScreenPath, width: 128, height: 128 }"),e.appendChild(i),a.applyBindings(r,i),this._container=e,this._viewModel=r,this._element=i}return e(r.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return this._viewModel.destroy(),a.cleanNode(this._element),this._container.removeChild(this._element),t(this)},r}),define("Widgets/Geocoder/GeocoderViewModel",["../../Core/BingMapsGeocoderService","../../Core/CartographicGeocoderService","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/Event","../../Core/Matrix4","../../ThirdParty/knockout","../../ThirdParty/when","../createCommand","../getElement"],function(r,i,n,a,e,s,l,o,u,c,d,h){"use strict";function t(e){if(!a(e)||!a(e.scene))throw new s("options.scene is required.");a(e.geocoderServices)?this._geocoderServices=e.geocoderServices:this._geocoderServices=[new i,new r({scene:e.scene})],this._viewContainer=e.container,this._scene=e.scene,this._flightDuration=e.flightDuration,this._searchText="",this._isSearchInProgress=!1,this._geocodePromise=void 0,this._complete=new l,this._suggestions=[],this._selectedSuggestion=void 0,this._showSuggestions=!0,this._updateCamera=m,this._adjustSuggestionsScroll=_,this._updateSearchSuggestions=b,this._handleArrowDown=f,this._handleArrowUp=p;var o=this;this._suggestionsVisible=u.pureComputed(function(){var e=0<u.getObservable(o,"_suggestions")().length,t=u.getObservable(o,"_showSuggestions")();return e&&t}),this._searchCommand=d(function(){if(o._focusTextbox=!1,a(o._selectedSuggestion))return o.activateSuggestion(o._selectedSuggestion),!1;var e;o.hideSuggestions(),o.isSearchInProgress?((e=o)._isSearchInProgress=!1,a(e._geocodePromise)&&(e._geocodePromise.cancel=!0,e._geocodePromise=void 0)):function(r,e){var i=r._searchText;if(v(i))return r.showSuggestions();r._isSearchInProgress=!0;for(var n=c.resolve(),t=0;t<e.length;t++)n=g(n,e[t],i);(r._geocodePromise=n).then(function(e){if(!n.cancel){r._isSearchInProgress=!1;var t=e.value;if("fulfilled"===e.state&&a(t)&&0<t.length)return r._searchText=t[0].displayName,void m(r,t[0].destination);r._searchText=i+" (not found)"}})}(o,o._geocoderServices)}),this.deselectSuggestion=function(){o._selectedSuggestion=void 0},this.handleKeyDown=function(e,t){var r="ArrowDown"===t.key||"Down"===t.key||40===t.keyCode,i="ArrowUp"===t.key||"Up"===t.key||38===t.keyCode;return(r||i)&&t.preventDefault(),!0},this.handleKeyUp=function(e,t){var r="ArrowDown"===t.key||"Down"===t.key||40===t.keyCode,i="ArrowUp"===t.key||"Up"===t.key||38===t.keyCode,n="Enter"===t.key||13===t.keyCode;return i?p(o):r?f(o):n&&o._searchCommand(),!0},this.activateSuggestion=function(e){o.hideSuggestions(),o._searchText=e.displayName;var t=e.destination;y(o),m(o,t)},this.hideSuggestions=function(){o._showSuggestions=!1,o._selectedSuggestion=void 0},this.showSuggestions=function(){o._showSuggestions=!0},this.handleMouseover=function(e,t){e!==o._selectedSuggestion&&(o._selectedSuggestion=e)},this.keepExpanded=!1,this.autoComplete=n(e.autocomplete,!0),this._focusTextbox=!1,u.track(this,["_searchText","_isSearchInProgress","keepExpanded","_suggestions","_selectedSuggestion","_showSuggestions","_focusTextbox"]);var t=u.getObservable(this,"_searchText");t.extend({rateLimit:{timeout:500}}),this._suggestionSubscription=t.subscribe(function(){b(o)}),this.isSearchInProgress=void 0,u.defineProperty(this,"isSearchInProgress",{get:function(){return this._isSearchInProgress}}),this.searchText=void 0,u.defineProperty(this,"searchText",{get:function(){return this.isSearchInProgress?"Searching...":this._searchText},set:function(e){if("string"!=typeof e)throw new s("value must be a valid string.");this._searchText=e}}),this.flightDuration=void 0,u.defineProperty(this,"flightDuration",{get:function(){return this._flightDuration},set:function(e){if(a(e)&&e<0)throw new s("value must be positive.");this._flightDuration=e}})}function p(e){if(0!==e._suggestions.length){var t,r=e._suggestions.indexOf(e._selectedSuggestion);-1!==r&&0!==r?(t=r-1,e._selectedSuggestion=e._suggestions[t],_(e,t)):e._selectedSuggestion=void 0}}function f(e){if(0!==e._suggestions.length){var t=e._suggestions.length,r=(e._suggestions.indexOf(e._selectedSuggestion)+1)%t;e._selectedSuggestion=e._suggestions[r],_(e,r)}}function m(e,t){e._scene.camera.flyTo({destination:t,complete:function(){e._complete.raiseEvent()},duration:e._flightDuration,endTransform:o.IDENTITY})}function g(e,t,r){return e.then(function(e){return a(e)&&"fulfilled"===e.state&&0<e.value.length?e:t.geocode(r).then(function(e){return{state:"fulfilled",value:e}}).otherwise(function(e){return{state:"rejected",reason:e}})})}function _(e,t){var r=h(e._viewContainer),i=r.getElementsByClassName("search-results")[0],n=r.getElementsByTagName("li")[t];if(0!==t){var o=n.offsetTop;o+n.clientHeight>i.clientHeight?i.scrollTop=o+n.clientHeight:o<i.scrollTop&&(i.scrollTop=o)}else i.scrollTop=0}function v(e){return/^\s*$/.test(e)}function y(e){u.getObservable(e,"_suggestions").removeAll()}function b(i){if(i.autoComplete){var r=i._searchText;if(y(i),!v(r)){var t=c.resolve([]);i._geocoderServices.forEach(function(e){t=t.then(function(t){return 5<=t.length?t:e.geocode(r).then(function(e){return t=t.concat(e)})})}),t.then(function(e){for(var t=i._suggestions,r=0;r<e.length;r++)t.push(e[r])})}}}return e(t.prototype,{complete:{get:function(){return this._complete}},scene:{get:function(){return this._scene}},search:{get:function(){return this._searchCommand}},selectedSuggestion:{get:function(){return this._selectedSuggestion}},suggestions:{get:function(){return this._suggestions}}}),t.prototype.destroy=function(){this._suggestionSubscription.dispose()},t}),define("Widgets/Geocoder/Geocoder",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/FeatureDetection","../../ThirdParty/knockout","../getElement","./GeocoderViewModel"],function(u,e,t,c,d,h,p,f){"use strict";function r(e){if(!u(e)||!u(e.container))throw new c("options.container is required.");if(!u(e.scene))throw new c("options.scene is required.");var t=p(e.container),r=new f(e);r._startSearchPath="M29.772,26.433l-7.126-7.126c0.96-1.583,1.523-3.435,1.524-5.421C24.169,8.093,19.478,3.401,13.688,3.399C7.897,3.401,3.204,8.093,3.204,13.885c0,5.789,4.693,10.481,10.484,10.481c1.987,0,3.839-0.563,5.422-1.523l7.128,7.127L29.772,26.433zM7.203,13.885c0.006-3.582,2.903-6.478,6.484-6.486c3.579,0.008,6.478,2.904,6.484,6.486c-0.007,3.58-2.905,6.476-6.484,6.484C10.106,20.361,7.209,17.465,7.203,13.885z",r._stopSearchPath="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z";var i=document.createElement("form");i.setAttribute("data-bind","submit: search");var n=document.createElement("input");n.type="search",n.className="cesium-geocoder-input",n.setAttribute("placeholder","Enter an address or landmark..."),n.setAttribute("data-bind",'textInput: searchText,disable: isSearchInProgress,event: { keyup: handleKeyUp, keydown: handleKeyDown, mouseover: deselectSuggestion },css: { "cesium-geocoder-input-wide" : keepExpanded || searchText.length > 0 },hasFocus: _focusTextbox'),this._onTextBoxFocus=function(){setTimeout(function(){n.select()},0)},n.addEventListener("focus",this._onTextBoxFocus,!1),i.appendChild(n),this._textBox=n;var o=document.createElement("span");o.className="cesium-geocoder-searchButton",o.setAttribute("data-bind","click: search,cesiumSvgPath: { path: isSearchInProgress ? _stopSearchPath : _startSearchPath, width: 32, height: 32 }"),i.appendChild(o),t.appendChild(i);var a=document.createElement("div");a.className="search-results",a.setAttribute("data-bind","visible: _suggestionsVisible");var s=document.createElement("ul");s.setAttribute("data-bind","foreach: _suggestions");var l=document.createElement("li");s.appendChild(l),l.setAttribute("data-bind","text: $data.displayName, click: $parent.activateSuggestion, event: { mouseover: $parent.handleMouseover}, css: { active: $data === $parent._selectedSuggestion }"),a.appendChild(s),t.appendChild(a),h.applyBindings(r,i),h.applyBindings(r,a),this._container=t,this._searchSuggestionsContainer=a,this._viewModel=r,this._form=i,this._onInputBegin=function(e){t.contains(e.target)||(r._focusTextbox=!1,r.hideSuggestions())},this._onInputEnd=function(e){t.contains(e.target)&&(r._focusTextbox=!0,r.showSuggestions())},d.supportsPointerEvents()?(document.addEventListener("pointerdown",this._onInputBegin,!0),document.addEventListener("pointerup",this._onInputEnd,!0),document.addEventListener("pointercancel",this._onInputEnd,!0)):(document.addEventListener("mousedown",this._onInputBegin,!0),document.addEventListener("mouseup",this._onInputEnd,!0),document.addEventListener("touchstart",this._onInputBegin,!0),document.addEventListener("touchend",this._onInputEnd,!0),document.addEventListener("touchcancel",this._onInputEnd,!0))}return e(r.prototype,{container:{get:function(){return this._container}},searchSuggestionsContainer:{get:function(){return this._searchSuggestionsContainer}},viewModel:{get:function(){return this._viewModel}}}),r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return d.supportsPointerEvents()?(document.removeEventListener("pointerdown",this._onInputBegin,!0),document.removeEventListener("pointerup",this._onInputEnd,!0)):(document.removeEventListener("mousedown",this._onInputBegin,!0),document.removeEventListener("mouseup",this._onInputEnd,!0),document.removeEventListener("touchstart",this._onInputBegin,!0),document.removeEventListener("touchend",this._onInputEnd,!0)),this._viewModel.destroy(),h.cleanNode(this._form),h.cleanNode(this._searchSuggestionsContainer),this._container.removeChild(this._form),this._container.removeChild(this._searchSuggestionsContainer),this._textBox.removeEventListener("focus",this._onTextBoxFocus,!1),t(this)},r}),define("Widgets/HomeButton/HomeButtonViewModel",["../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../ThirdParty/knockout","../createCommand"],function(i,e,n,o,a){"use strict";function t(e,t){if(!i(e))throw new n("scene is required.");this._scene=e,this._duration=t;var r=this;this._command=a(function(){r._scene.camera.flyHome(r._duration)}),this.tooltip="View Home",o.track(this,["tooltip"])}return e(t.prototype,{scene:{get:function(){return this._scene}},command:{get:function(){return this._command}},duration:{get:function(){return this._duration},set:function(e){if(i(e)&&e<0)throw new n("value must be positive.");this._duration=e}}}),t}),define("Widgets/HomeButton/HomeButton",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./HomeButtonViewModel"],function(o,e,t,a,s,l,u){"use strict";function r(e,t,r){if(!o(e))throw new a("container is required.");e=l(e);var i=new u(t,r);i._svgPath="M14,4l-10,8.75h20l-4.25-3.7188v-4.6562h-2.812v2.1875l-2.938-2.5625zm-7.0938,9.906v10.094h14.094v-10.094h-14.094zm2.1876,2.313h3.3122v4.25h-3.3122v-4.25zm5.8442,1.281h3.406v6.438h-3.406v-6.438z";var n=document.createElement("button");n.type="button",n.className="cesium-button cesium-toolbar-button cesium-home-button",n.setAttribute("data-bind","attr: { title: tooltip },click: command,cesiumSvgPath: { path: _svgPath, width: 28, height: 28 }"),e.appendChild(n),s.applyBindings(i,n),this._container=e,this._viewModel=i,this._element=n}return e(r.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return s.cleanNode(this._element),this._container.removeChild(this._element),t(this)},r}),define("Widgets/InfoBox/InfoBoxViewModel",["../../Core/defined","../../Core/defineProperties","../../Core/Event","../../ThirdParty/knockout"],function(e,t,r,i){"use strict";function n(){this._cameraClicked=new r,this._closeClicked=new r,this.maxHeight=500,this.enableCamera=!1,this.isCameraTracking=!1,this.showInfo=!1,this.titleText="",this.description="",i.track(this,["showInfo","titleText","description","maxHeight","enableCamera","isCameraTracking"]),this._loadingIndicatorHtml='<div class="cesium-infoBox-loadingContainer"><span class="cesium-infoBox-loading"></span></div>',this.cameraIconPath=void 0,i.defineProperty(this,"cameraIconPath",{get:function(){return!this.enableCamera||this.isCameraTracking?"M 27.34375 1.65625 L 5.28125 27.9375 L 8.09375 30.3125 L 30.15625 4.03125 L 27.34375 1.65625 z M 13.84375 7.03125 C 11.412798 7.03125 9.46875 8.975298 9.46875 11.40625 L 9.46875 11.59375 L 2.53125 7.21875 L 2.53125 24.0625 L 9.46875 19.6875 C 9.4724893 20.232036 9.5676108 20.7379 9.75 21.21875 L 21.65625 7.03125 L 13.84375 7.03125 z M 28.21875 7.71875 L 14.53125 24.0625 L 25.875 24.0625 C 28.305952 24.0625 30.28125 22.087202 30.28125 19.65625 L 30.28125 11.40625 C 30.28125 9.8371439 29.456025 8.4902779 28.21875 7.71875 z":"M 13.84375 7.03125 C 11.412798 7.03125 9.46875 8.975298 9.46875 11.40625 L 9.46875 11.59375 L 2.53125 7.21875 L 2.53125 24.0625 L 9.46875 19.6875 C 9.4853444 22.104033 11.423165 24.0625 13.84375 24.0625 L 25.875 24.0625 C 28.305952 24.0625 30.28125 22.087202 30.28125 19.65625 L 30.28125 11.40625 C 30.28125 8.975298 28.305952 7.03125 25.875 7.03125 L 13.84375 7.03125 z"}}),i.defineProperty(this,"_bodyless",{get:function(){return!e(this.description)||0===this.description.length}})}return n.prototype.maxHeightOffset=function(e){return this.maxHeight-e+"px"},t(n.prototype,{cameraClicked:{get:function(){return this._cameraClicked}},closeClicked:{get:function(){return this._closeClicked}}}),n}),define("Widgets/InfoBox/InfoBox",["../../Core/buildModuleUrl","../../Core/Check","../../Core/Color","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../ThirdParty/knockout","../getElement","../subscribeAndEvaluate","./InfoBoxViewModel"],function(a,s,c,d,e,t,h,p,f,m){"use strict";function r(e){s.defined("container",e),e=p(e);var l=document.createElement("div");l.className="cesium-infoBox",l.setAttribute("data-bind",'css: { "cesium-infoBox-visible" : showInfo, "cesium-infoBox-bodyless" : _bodyless }'),e.appendChild(l);var t=document.createElement("div");t.className="cesium-infoBox-title",t.setAttribute("data-bind","text: titleText"),l.appendChild(t);var r=document.createElement("button");r.type="button",r.className="cesium-button cesium-infoBox-camera",r.setAttribute("data-bind",'attr: { title: "Focus camera on object" },click: function () { cameraClicked.raiseEvent(this); },enable: enableCamera,cesiumSvgPath: { path: cameraIconPath, width: 32, height: 32 }'),l.appendChild(r);var i=document.createElement("button");i.type="button",i.className="cesium-infoBox-close",i.setAttribute("data-bind","click: function () { closeClicked.raiseEvent(this); }"),i.innerHTML="&times;",l.appendChild(i);var u=document.createElement("iframe");u.className="cesium-infoBox-iframe",u.setAttribute("sandbox","allow-same-origin allow-popups allow-forms"),u.setAttribute("data-bind","style : { maxHeight : maxHeightOffset(40) }"),u.setAttribute("allowfullscreen",!0),l.appendChild(u);var n=new m;h.applyBindings(n,l),this._container=e,this._element=l,this._frame=u,this._viewModel=n,this._descriptionSubscription=void 0;var o=this;u.addEventListener("load",function(){var e=u.contentDocument,t=e.createElement("link");t.href=a("Widgets/InfoBox/InfoBoxDescription.css"),t.rel="stylesheet",t.type="text/css";var s=e.createElement("div");s.className="cesium-infoBox-description",e.head.appendChild(t),e.body.appendChild(s),o._descriptionSubscription=f(n,"description",function(e){u.style.height="5px",s.innerHTML=e;var t=null,r=s.firstElementChild;if(null!==r&&1===s.childNodes.length){var i=window.getComputedStyle(r);if(null!==i){var n=i["background-color"],o=c.fromCssColorString(n);d(o)&&0!==o.alpha&&(t=i["background-color"])}}l.style["background-color"]=t;var a=s.getBoundingClientRect().height;u.style.height=a+"px"})}),u.setAttribute("src","about:blank")}return e(r.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}},frame:{get:function(){return this._frame}}}),r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){var e=this._container;return h.cleanNode(this._element),e.removeChild(this._element),d(this._descriptionSubscription)&&this._descriptionSubscription.dispose(),t(this)},r}),define("Widgets/NavigationHelpButton/NavigationHelpButtonViewModel",["../../Core/defineProperties","../../ThirdParty/knockout","../createCommand"],function(e,t,r){"use strict";function i(){this.showInstructions=!1;var e=this;this._command=r(function(){e.showInstructions=!e.showInstructions}),this._showClick=r(function(){e._touch=!1}),this._showTouch=r(function(){e._touch=!0}),this._touch=!1,this.tooltip="Navigation Instructions",t.track(this,["tooltip","showInstructions","_touch"])}return e(i.prototype,{command:{get:function(){return this._command}},showClick:{get:function(){return this._showClick}},showTouch:{get:function(){return this._showTouch}}}),i}),define("Widgets/NavigationHelpButton/NavigationHelpButton",["../../Core/buildModuleUrl","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/FeatureDetection","../../ThirdParty/knockout","../getElement","./NavigationHelpButtonViewModel"],function(p,f,m,e,t,g,_,v,y,b){"use strict";function r(e){if(!m(e)||!m(e.container))throw new g("options.container is required.");var t=y(e.container),r=new b,i=f(e.instructionsInitiallyVisible,!1);r.showInstructions=i,r._svgPath="M16,1.466C7.973,1.466,1.466,7.973,1.466,16c0,8.027,6.507,14.534,14.534,14.534c8.027,0,14.534-6.507,14.534-14.534C30.534,7.973,24.027,1.466,16,1.466z M17.328,24.371h-2.707v-2.596h2.707V24.371zM17.328,19.003v0.858h-2.707v-1.057c0-3.19,3.63-3.696,3.63-5.963c0-1.034-0.924-1.826-2.134-1.826c-1.254,0-2.354,0.924-2.354,0.924l-1.541-1.915c0,0,1.519-1.584,4.137-1.584c2.487,0,4.796,1.54,4.796,4.136C21.156,16.208,17.328,16.627,17.328,19.003z";var n=document.createElement("span");n.className="cesium-navigationHelpButton-wrapper",t.appendChild(n);var o=document.createElement("button");o.type="button",o.className="cesium-button cesium-toolbar-button cesium-navigation-help-button",o.setAttribute("data-bind","attr: { title: tooltip },click: command,cesiumSvgPath: { path: _svgPath, width: 32, height: 32 }"),n.appendChild(o);var a=document.createElement("div");a.className="cesium-navigation-help",a.setAttribute("data-bind",'css: { "cesium-navigation-help-visible" : showInstructions}'),n.appendChild(a);var s=document.createElement("button");s.type="button",s.className="cesium-navigation-button cesium-navigation-button-left",s.setAttribute("data-bind",'click: showClick, css: {"cesium-navigation-button-selected": !_touch, "cesium-navigation-button-unselected": _touch}');var l=document.createElement("img");l.src=p("Widgets/Images/NavigationHelp/Mouse.svg"),l.className="cesium-navigation-button-icon",l.style.width="25px",l.style.height="25px",s.appendChild(l),s.appendChild(document.createTextNode("Mouse"));var u=document.createElement("button");u.type="button",u.className="cesium-navigation-button cesium-navigation-button-right",u.setAttribute("data-bind",'click: showTouch, css: {"cesium-navigation-button-selected": _touch, "cesium-navigation-button-unselected": !_touch}');var c=document.createElement("img");c.src=p("Widgets/Images/NavigationHelp/Touch.svg"),c.className="cesium-navigation-button-icon",c.style.width="25px",c.style.height="25px",u.appendChild(c),u.appendChild(document.createTextNode("Touch")),a.appendChild(s),a.appendChild(u);var d=document.createElement("div");d.className="cesium-click-navigation-help cesium-navigation-help-instructions",d.setAttribute("data-bind",'css: { "cesium-click-navigation-help-visible" : !_touch}'),d.innerHTML='            <table>                <tr>                    <td><img src="'+p("Widgets/Images/NavigationHelp/MouseLeft.svg")+'" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-pan">Pan view</div>                        <div class="cesium-navigation-help-details">Left click + drag</div>                    </td>                </tr>                <tr>                    <td><img src="'+p("Widgets/Images/NavigationHelp/MouseRight.svg")+'" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-zoom">Zoom view</div>                        <div class="cesium-navigation-help-details">Right click + drag, or</div>                        <div class="cesium-navigation-help-details">Mouse wheel scroll</div>                    </td>                </tr>                <tr>                    <td><img src="'+p("Widgets/Images/NavigationHelp/MouseMiddle.svg")+'" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-rotate">Rotate view</div>                        <div class="cesium-navigation-help-details">Middle click + drag, or</div>                        <div class="cesium-navigation-help-details">CTRL + Left/Right click + drag</div>                    </td>                </tr>            </table>',a.appendChild(d);var h=document.createElement("div");h.className="cesium-touch-navigation-help cesium-navigation-help-instructions",h.setAttribute("data-bind",'css: { "cesium-touch-navigation-help-visible" : _touch}'),h.innerHTML='            <table>                <tr>                    <td><img src="'+p("Widgets/Images/NavigationHelp/TouchDrag.svg")+'" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-pan">Pan view</div>                        <div class="cesium-navigation-help-details">One finger drag</div>                    </td>                </tr>                <tr>                    <td><img src="'+p("Widgets/Images/NavigationHelp/TouchZoom.svg")+'" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-zoom">Zoom view</div>                        <div class="cesium-navigation-help-details">Two finger pinch</div>                    </td>                </tr>                <tr>                    <td><img src="'+p("Widgets/Images/NavigationHelp/TouchTilt.svg")+'" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-rotate">Tilt view</div>                        <div class="cesium-navigation-help-details">Two finger drag, same direction</div>                    </td>                </tr>                <tr>                    <td><img src="'+p("Widgets/Images/NavigationHelp/TouchRotate.svg")+'" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-tilt">Rotate view</div>                        <div class="cesium-navigation-help-details">Two finger drag, opposite direction</div>                    </td>                </tr>            </table>',a.appendChild(h),v.applyBindings(r,n),this._container=t,this._viewModel=r,this._wrapper=n,this._closeInstructions=function(e){n.contains(e.target)||(r.showInstructions=!1)},_.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeInstructions,!0):(document.addEventListener("mousedown",this._closeInstructions,!0),document.addEventListener("touchstart",this._closeInstructions,!0))}return e(r.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return _.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeInstructions,!0):(document.removeEventListener("mousedown",this._closeInstructions,!0),document.removeEventListener("touchstart",this._closeInstructions,!0)),v.cleanNode(this._wrapper),this._container.removeChild(this._wrapper),t(this)},r}),define("Widgets/PerformanceWatchdog/PerformanceWatchdogViewModel",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Scene/FrameRateMonitor","../../ThirdParty/knockout","../createCommand"],function(i,n,e,t,o,a,s,l){"use strict";function r(e){if(!n(e)||!n(e.scene))throw new o("options.scene is required.");this._scene=e.scene,this.lowFrameRateMessage=i(e.lowFrameRateMessage,"This application appears to be performing poorly on your system.  Please try using a different web browser or updating your video drivers."),this.lowFrameRateMessageDismissed=!1,this.showingLowFrameRateMessage=!1,s.track(this,["lowFrameRateMessage","lowFrameRateMessageDismissed","showingLowFrameRateMessage"]);var t=this;this._dismissMessage=l(function(){t.showingLowFrameRateMessage=!1,t.lowFrameRateMessageDismissed=!0});var r=a.fromScene(e.scene);this._unsubscribeLowFrameRate=r.lowFrameRate.addEventListener(function(){t.lowFrameRateMessageDismissed||(t.showingLowFrameRateMessage=!0)}),this._unsubscribeNominalFrameRate=r.nominalFrameRate.addEventListener(function(){t.showingLowFrameRateMessage=!1})}return e(r.prototype,{scene:{get:function(){return this._scene}},dismissMessage:{get:function(){return this._dismissMessage}}}),r.prototype.destroy=function(){return this._unsubscribeLowFrameRate(),this._unsubscribeNominalFrameRate(),t(this)},r}),define("Widgets/PerformanceWatchdog/PerformanceWatchdog",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./PerformanceWatchdogViewModel"],function(a,e,t,s,l,u,c){"use strict";function r(e){if(!a(e)||!a(e.container))throw new s("options.container is required.");if(!a(e.scene))throw new s("options.scene is required.");var t=u(e.container),r=new c(e),i=document.createElement("div");i.className="cesium-performance-watchdog-message-area",i.setAttribute("data-bind","visible: showingLowFrameRateMessage");var n=document.createElement("button");n.setAttribute("type","button"),n.className="cesium-performance-watchdog-message-dismiss",n.innerHTML="&times;",n.setAttribute("data-bind","click: dismissMessage"),i.appendChild(n);var o=document.createElement("div");o.className="cesium-performance-watchdog-message",o.setAttribute("data-bind","html: lowFrameRateMessage"),i.appendChild(o),t.appendChild(i),l.applyBindings(r,i),this._container=t,this._viewModel=r,this._element=i}return e(r.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return this._viewModel.destroy(),l.cleanNode(this._element),this._container.removeChild(this._element),t(this)},r}),define("Widgets/ProjectionPicker/ProjectionPickerViewModel",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/EventHelper","../../Core/OrthographicFrustum","../../Scene/SceneMode","../../ThirdParty/knockout","../createCommand"],function(t,e,r,i,o,a,s,l,u){"use strict";function n(e){if(!t(e))throw new i("scene is required.");this._scene=e,this._orthographic=e.camera.frustum instanceof a,this._flightInProgress=!1,this.dropDownVisible=!1,this.tooltipPerspective="Perspective Projection",this.tooltipOrthographic="Orthographic Projection",this.selectedTooltip=void 0,this.sceneMode=e.mode,l.track(this,["_orthographic","_flightInProgress","sceneMode","dropDownVisible","tooltipPerspective","tooltipOrthographic"]);var n=this;l.defineProperty(this,"selectedTooltip",function(){return n._orthographic?n.tooltipOrthographic:n.tooltipPerspective}),this._toggleDropDown=u(function(){n.sceneMode===s.SCENE2D||n._flightInProgress||(n.dropDownVisible=!n.dropDownVisible)}),this._eventHelper=new o,this._eventHelper.add(e.morphComplete,function(e,t,r,i){n.sceneMode=r,n._orthographic=r===s.SCENE2D||n._scene.camera.frustum instanceof a}),this._eventHelper.add(e.preRender,function(){n._flightInProgress=t(e.camera._currentFlight)}),this._switchToPerspective=u(function(){n.sceneMode!==s.SCENE2D&&(n._scene.camera.switchToPerspectiveFrustum(),n._orthographic=!1,n.dropDownVisible=!1)}),this._switchToOrthographic=u(function(){n.sceneMode!==s.SCENE2D&&(n._scene.camera.switchToOrthographicFrustum(),n._orthographic=!0,n.dropDownVisible=!1)}),this._sceneMode=s}return e(n.prototype,{scene:{get:function(){return this._scene}},toggleDropDown:{get:function(){return this._toggleDropDown}},switchToPerspective:{get:function(){return this._switchToPerspective}},switchToOrthographic:{get:function(){return this._switchToOrthographic}},isOrthographicProjection:{get:function(){return this._orthographic}}}),n.prototype.isDestroyed=function(){return!1},n.prototype.destroy=function(){this._eventHelper.removeAll(),r(this)},n}),define("Widgets/ProjectionPicker/ProjectionPicker",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/FeatureDetection","../../ThirdParty/knockout","../getElement","./ProjectionPickerViewModel"],function(s,e,t,l,u,c,d,h){"use strict";function r(e,t){if(!s(e))throw new l("container is required.");if(!s(t))throw new l("scene is required.");e=d(e);var r=new h(t);r._perspectivePath="M 28.15625,10.4375 9.125,13.21875 13.75,43.25 41.75,55.09375 50.8125,37 54.5,11.9375 z m 0.125,3 19.976451,0.394265 L 43.03125,16.875 22.6875,14.28125 z M 50.971746,15.705477 47.90625,36.03125 42.53125,46 44.84375,19.3125 z M 12.625,16.03125 l 29.15625,3.6875 -2.65625,31 L 16.4375,41.125 z",r._orthographicPath="m 31.560594,6.5254438 -20.75,12.4687502 0.1875,24.5625 22.28125,11.8125 19.5,-12 0.65625,-0.375 0,-0.75 0.0312,-23.21875 z m 0.0625,3.125 16.65625,9.5000002 -16.125,10.28125 -17.34375,-9.71875 z m 18.96875,11.1875002 0.15625,20.65625 -17.46875,10.59375 0.15625,-20.28125 z m -37.0625,1.25 17.21875,9.625 -0.15625,19.21875 -16.9375,-9 z";var i=document.createElement("span");i.className="cesium-projectionPicker-wrapper cesium-toolbar-button",e.appendChild(i);var n=document.createElement("button");n.type="button",n.className="cesium-button cesium-toolbar-button",n.setAttribute("data-bind",'css: { "cesium-projectionPicker-buttonPerspective": !_orthographic,       "cesium-projectionPicker-buttonOrthographic": _orthographic,       "cesium-button-disabled" : sceneMode === _sceneMode.SCENE2D || _flightInProgress,        "cesium-projectionPicker-selected": dropDownVisible },attr: { title: selectedTooltip },click: toggleDropDown'),n.innerHTML='\x3c!-- ko cesiumSvgPath: { path: _perspectivePath, width: 64, height: 64, css: "cesium-projectionPicker-iconPerspective" } --\x3e\x3c!-- /ko --\x3e\x3c!-- ko cesiumSvgPath: { path: _orthographicPath, width: 64, height: 64, css: "cesium-projectionPicker-iconOrthographic" } --\x3e\x3c!-- /ko --\x3e',i.appendChild(n);var o=document.createElement("button");o.type="button",o.className="cesium-button cesium-toolbar-button cesium-projectionPicker-dropDown-icon",o.setAttribute("data-bind",'css: { "cesium-projectionPicker-visible" : (dropDownVisible && _orthographic),       "cesium-projectionPicker-none" : !_orthographic,       "cesium-projectionPicker-hidden" : !dropDownVisible },attr: { title: tooltipPerspective },click: switchToPerspective,cesiumSvgPath: { path: _perspectivePath, width: 64, height: 64 }'),i.appendChild(o);var a=document.createElement("button");a.type="button",a.className="cesium-button cesium-toolbar-button cesium-projectionPicker-dropDown-icon",a.setAttribute("data-bind",'css: { "cesium-projectionPicker-visible" : (dropDownVisible && !_orthographic),       "cesium-projectionPicker-none" : _orthographic,       "cesium-projectionPicker-hidden" : !dropDownVisible},attr: { title: tooltipOrthographic },click: switchToOrthographic,cesiumSvgPath: { path: _orthographicPath, width: 64, height: 64 }'),i.appendChild(a),c.applyBindings(r,i),this._viewModel=r,this._container=e,this._wrapper=i,this._closeDropDown=function(e){i.contains(e.target)||(r.dropDownVisible=!1)},u.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeDropDown,!0):(document.addEventListener("mousedown",this._closeDropDown,!0),document.addEventListener("touchstart",this._closeDropDown,!0))}return e(r.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return this._viewModel.destroy(),u.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeDropDown,!0):(document.removeEventListener("mousedown",this._closeDropDown,!0),document.removeEventListener("touchstart",this._closeDropDown,!0)),c.cleanNode(this._wrapper),this._container.removeChild(this._wrapper),t(this)},r}),define("Widgets/SceneModePicker/SceneModePickerViewModel",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/EventHelper","../../Scene/SceneMode","../../ThirdParty/knockout","../createCommand"],function(r,i,e,t,o,a,s,l,u){"use strict";function n(e,t){if(!i(e))throw new o("scene is required.");this._scene=e;var n=this;this._eventHelper=new a,this._eventHelper.add(e.morphStart,function(e,t,r,i){n.sceneMode=r,n.dropDownVisible=!1}),this._duration=r(t,2),this.sceneMode=e.mode,this.dropDownVisible=!1,this.tooltip2D="2D",this.tooltip3D="3D",this.tooltipColumbusView="Columbus View",l.track(this,["sceneMode","dropDownVisible","tooltip2D","tooltip3D","tooltipColumbusView"]),this.selectedTooltip=void 0,l.defineProperty(this,"selectedTooltip",function(){var e=n.sceneMode;return e===s.SCENE2D?n.tooltip2D:e===s.SCENE3D?n.tooltip3D:n.tooltipColumbusView}),this._toggleDropDown=u(function(){n.dropDownVisible=!n.dropDownVisible}),this._morphTo2D=u(function(){e.morphTo2D(n._duration)}),this._morphTo3D=u(function(){e.morphTo3D(n._duration)}),this._morphToColumbusView=u(function(){e.morphToColumbusView(n._duration)}),this._sceneMode=s}return e(n.prototype,{scene:{get:function(){return this._scene}},duration:{get:function(){return this._duration},set:function(e){if(e<0)throw new o("duration value must be positive.");this._duration=e}},toggleDropDown:{get:function(){return this._toggleDropDown}},morphTo2D:{get:function(){return this._morphTo2D}},morphTo3D:{get:function(){return this._morphTo3D}},morphToColumbusView:{get:function(){return this._morphToColumbusView}}}),n.prototype.isDestroyed=function(){return!1},n.prototype.destroy=function(){this._eventHelper.removeAll(),t(this)},n}),define("Widgets/SceneModePicker/SceneModePicker",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/FeatureDetection","../../ThirdParty/knockout","../getElement","./SceneModePickerViewModel"],function(u,e,t,c,d,h,p,f){"use strict";function r(e,t,r){if(!u(e))throw new c("container is required.");if(!u(t))throw new c("scene is required.");e=p(e);var i=new f(t,r);i._globePath="m 32.401392,4.9330437 c -7.087603,0 -14.096095,2.884602 -19.10793,7.8946843 -5.0118352,5.010083 -7.9296167,11.987468 -7.9296167,19.072999 0,7.085531 2.9177815,14.097848 7.9296167,19.107931 4.837653,4.835961 11.541408,7.631372 18.374354,7.82482 0.05712,0.01231 0.454119,0.139729 0.454119,0.139729 l 0.03493,-0.104797 c 0.08246,7.84e-4 0.162033,0.03493 0.244525,0.03493 0.08304,0 0.161515,-0.03414 0.244526,-0.03493 l 0.03493,0.104797 c 0,0 0.309474,-0.129487 0.349323,-0.139729 6.867765,-0.168094 13.582903,-2.965206 18.444218,-7.82482 2.558195,-2.5573 4.551081,-5.638134 5.903547,-8.977584 1.297191,-3.202966 2.02607,-6.661489 2.02607,-10.130347 0,-6.237309 -2.366261,-12.31219 -6.322734,-17.116794 -0.0034,-0.02316 0.0049,-0.04488 0,-0.06986 -0.01733,-0.08745 -0.104529,-0.278855 -0.104797,-0.279458 -5.31e-4,-0.0012 -0.522988,-0.628147 -0.523984,-0.62878         -3.47e-4,-2.2e-4 -0.133444,-0.03532 -0.244525,-0.06987 C 51.944299,13.447603 51.751076,13.104317 51.474391,12.827728 46.462556,7.8176457 39.488996,4.9330437 32.401392,4.9330437 z m -2.130866,3.5281554 0.104797,9.6762289 c -4.111695,-0.08361 -7.109829,-0.423664 -9.257041,-0.943171 1.198093,-2.269271 2.524531,-4.124404 3.91241,-5.414496 2.167498,-2.0147811 3.950145,-2.8540169 5.239834,-3.3185619 z m 2.794579,0 c 1.280302,0.4754953 3.022186,1.3285948 5.065173,3.2486979 1.424667,1.338973 2.788862,3.303645 3.982275,5.728886 -2.29082,0.403367 -5.381258,0.621049 -8.942651,0.698645 L 33.065105,8.4611991 z m 5.728886,0.2445256 c 4.004072,1.1230822 7.793098,3.1481363 10.724195,6.0782083 0.03468,0.03466 0.07033,0.06991 0.104797,0.104797 -0.45375,0.313891 -0.923054,0.663002 -1.956205,1.082899 -0.647388,0.263114 -1.906242,0.477396 -2.829511,0.733577 -1.382296,-2.988132         -3.027146,-5.368585 -4.785716,-7.0213781 -0.422866,-0.397432 -0.835818,-0.6453247 -1.25756,-0.9781032 z m -15.33525,0.7685092 c -0.106753,0.09503 -0.207753,0.145402 -0.31439,0.244526 -1.684973,1.5662541 -3.298068,3.8232211 -4.680919,6.5672591 -0.343797,-0.14942 -1.035052,-0.273198 -1.292493,-0.419186 -0.956528,-0.542427 -1.362964,-1.022024 -1.537018,-1.292493 -0.0241,-0.03745 -0.01868,-0.0401 -0.03493,-0.06986 2.250095,-2.163342 4.948824,-3.869984 7.859752,-5.0302421 z m -9.641296,7.0912431 c 0.464973,0.571618 0.937729,1.169056 1.956205,1.746612 0.349907,0.198425 1.107143,0.335404 1.537018,0.523983 -1.20166,3.172984 -1.998037,7.051901 -2.165798,11.772162 C 14.256557,30.361384 12.934823,30.161483 12.280427,29.90959 10.644437,29.279855 9.6888882,28.674891 9.1714586,28.267775 8.6540289,27.860658 8.6474751,27.778724 8.6474751,27.778724 l -0.069864,0.03493 C 9.3100294,23.691285         11.163248,19.798527 13.817445,16.565477 z m 37.552149,0.523984 c 2.548924,3.289983 4.265057,7.202594 4.890513,11.318043 -0.650428,0.410896 -1.756876,1.001936 -3.563088,1.606882 -1.171552,0.392383 -3.163859,0.759153 -4.960377,1.117832 -0.04367,-4.752703 -0.784809,-8.591423 -1.88634,-11.807094 0.917574,-0.263678 2.170552,-0.486495 2.864443,-0.76851 1.274693,-0.518066 2.003942,-1.001558 2.654849,-1.467153 z m -31.439008,2.619917 c 2.487341,0.672766 5.775813,1.137775 10.479669,1.222628 l 0.104797,10.689263 0,0.03493 0,0.733577 c -5.435005,-0.09059 -9.512219,-0.519044 -12.610536,-1.117831 0.106127,-4.776683 0.879334,-8.55791 2.02607,-11.562569 z m 23.264866,0.31439 c 1.073459,3.067541 1.833795,6.821314 1.816476,11.702298 -3.054474,0.423245 -7.062018,0.648559 -11.702298,0.698644 l 0,-0.838373 -0.104796,-10.654331 c 4.082416,-0.0864 7.404468,-0.403886 9.990618,-0.908238 z         M 8.2632205,30.922625 c 0.7558676,0.510548 1.5529563,1.013339 3.0041715,1.57195 0.937518,0.360875 2.612202,0.647642 3.91241,0.978102 0.112814,3.85566 0.703989,7.107756 1.606883,9.920754 -1.147172,-0.324262 -2.644553,-0.640648 -3.423359,-0.978102 -1.516688,-0.657177 -2.386627,-1.287332 -2.864443,-1.71168 -0.477816,-0.424347 -0.489051,-0.489051 -0.489051,-0.489051 L 9.8002387,40.319395 C 8.791691,37.621767 8.1584238,34.769583 8.1584238,31.900727 c 0,-0.330153 0.090589,-0.648169 0.1047967,-0.978102 z m 48.2763445,0.419186 c 0.0047,0.188973 0.06986,0.36991 0.06986,0.558916 0,2.938869 -0.620228,5.873558 -1.676747,8.628261 -0.07435,0.07583 -0.06552,0.07411 -0.454119,0.349323 -0.606965,0.429857 -1.631665,1.042044 -3.318562,1.676747 -1.208528,0.454713 -3.204964,0.850894 -5.135038,1.25756 0.84593,-2.765726 1.41808,-6.005357 1.606883,-9.815957 2.232369,-0.413371 4.483758,-0.840201         5.938479,-1.327425 1.410632,-0.472457 2.153108,-0.89469 2.96924,-1.327425 z m -38.530252,2.864443 c 3.208141,0.56697 7.372279,0.898588 12.575603,0.978103 l 0.174662,9.885821 c -4.392517,-0.06139 -8.106722,-0.320566 -10.863925,-0.803441 -1.051954,-2.664695 -1.692909,-6.043794 -1.88634,-10.060483 z m 26.793022,0.31439 c -0.246298,3.923551 -0.877762,7.263679 -1.816476,9.885822 -2.561957,0.361954 -5.766249,0.560708 -9.431703,0.62878 l -0.174661,-9.815957 c 4.491734,-0.04969 8.334769,-0.293032 11.42284,-0.698645 z M 12.035901,44.860585 c 0.09977,0.04523 0.105535,0.09465 0.209594,0.139729 1.337656,0.579602 3.441099,1.058072 5.589157,1.537018 1.545042,3.399208 3.548524,5.969402 5.589157,7.789888 -3.034411,-1.215537 -5.871615,-3.007978 -8.174142,-5.309699 -1.245911,-1.245475 -2.271794,-2.662961 -3.213766,-4.156936 z m 40.69605,0 c -0.941972,1.493975 -1.967855,2.911461         -3.213765,4.156936 -2.74253,2.741571 -6.244106,4.696717 -9.955686,5.868615 0.261347,-0.241079 0.507495,-0.394491 0.768509,-0.663713 1.674841,-1.727516 3.320792,-4.181056 4.645987,-7.265904 2.962447,-0.503021 5.408965,-1.122293 7.161107,-1.781544 0.284034,-0.106865 0.337297,-0.207323 0.593848,-0.31439 z m -31.404076,2.305527 c 2.645807,0.376448 5.701178,0.649995 9.466635,0.698645 l 0.139729,7.789888 c -1.38739,-0.480844 -3.316218,-1.29837 -5.659022,-3.388427 -1.388822,-1.238993 -2.743668,-3.0113 -3.947342,-5.100106 z m 20.365491,0.104797 c -1.04872,2.041937 -2.174337,3.779068 -3.353494,4.995309 -1.853177,1.911459 -3.425515,2.82679 -4.611055,3.353494 l -0.139729,-7.789887 c 3.13091,-0.05714 5.728238,-0.278725 8.104278,-0.558916 z",i._flatMapPath="m 2.9825053,17.550598 0,1.368113 0,26.267766 0,1.368113 1.36811,0 54.9981397,0 1.36811,0 0,-1.368113 0,-26.267766 0,-1.368113 -1.36811,0 -54.9981397,0 -1.36811,0 z m 2.73623,2.736226 10.3292497,0 0,10.466063 -10.3292497,0 0,-10.466063 z m 13.0654697,0 11.69737,0 0,10.466063 -11.69737,0 0,-10.466063 z m 14.43359,0 11.69737,0 0,10.466063 -11.69737,0 0,-10.466063 z m 14.43359,0 10.32926,0 0,10.466063 -10.32926,0 0,-10.466063 z m -41.9326497,13.202288 10.3292497,0 0,10.329252 -10.3292497,0 0,-10.329252 z m 13.0654697,0 11.69737,0 0,10.329252 -11.69737,0 0,-10.329252 z m 14.43359,0 11.69737,0 0,10.329252 -11.69737,0 0,-10.329252 z m 14.43359,0 10.32926,0 0,10.329252 -10.32926,0 0,-10.329252 z",i._columbusViewPath="m 14.723969,17.675598 -0.340489,0.817175 -11.1680536,26.183638 -0.817175,1.872692 2.076986,0 54.7506996,0 2.07698,0 -0.81717,-1.872692 -11.16805,-26.183638 -0.34049,-0.817175 -0.91933,0 -32.414586,0 -0.919322,0 z m 1.838643,2.723916 6.196908,0 -2.928209,10.418977 -7.729111,0 4.460412,-10.418977 z m 9.02297,0 4.903049,0 0,10.418977 -7.831258,0 2.928209,-10.418977 z m 7.626964,0 5.584031,0 2.62176,10.418977 -8.205791,0 0,-10.418977 z m 8.410081,0 5.51593,0 4.46042,10.418977 -7.38863,0 -2.58772,-10.418977 z m -30.678091,13.142892 8.103649,0 -2.89416,10.282782 -9.6018026,0 4.3923136,-10.282782 z m 10.929711,0 8.614384,0 0,10.282782 -11.508544,0 2.89416,-10.282782 z m 11.338299,0 8.852721,0 2.58772,10.282782 -11.440441,0 0,-10.282782 z m 11.678781,0 7.86531,0 4.39231,10.282782 -9.6699,0 -2.58772,-10.282782 z";var n=document.createElement("span");n.className="cesium-sceneModePicker-wrapper cesium-toolbar-button",e.appendChild(n);var o=document.createElement("button");o.type="button",o.className="cesium-button cesium-toolbar-button",o.setAttribute("data-bind",'css: { "cesium-sceneModePicker-button2D": sceneMode === _sceneMode.SCENE2D,       "cesium-sceneModePicker-button3D": sceneMode === _sceneMode.SCENE3D,       "cesium-sceneModePicker-buttonColumbusView": sceneMode === _sceneMode.COLUMBUS_VIEW,       "cesium-sceneModePicker-selected": dropDownVisible },attr: { title: selectedTooltip },click: toggleDropDown'),o.innerHTML='\x3c!-- ko cesiumSvgPath: { path: _globePath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-icon3D" } --\x3e\x3c!-- /ko --\x3e\x3c!-- ko cesiumSvgPath: { path: _flatMapPath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-icon2D" } --\x3e\x3c!-- /ko --\x3e\x3c!-- ko cesiumSvgPath: { path: _columbusViewPath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-iconColumbusView" } --\x3e\x3c!-- /ko --\x3e',n.appendChild(o);var a=document.createElement("button");a.type="button",a.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon",a.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.SCENE3D)) || (!dropDownVisible && (sceneMode === _sceneMode.SCENE3D)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.SCENE3D,       "cesium-sceneModePicker-hidden" : !dropDownVisible },attr: { title: tooltip3D },click: morphTo3D,cesiumSvgPath: { path: _globePath, width: 64, height: 64 }'),n.appendChild(a);var s=document.createElement("button");s.type="button",s.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon",s.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.SCENE2D)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.SCENE2D,       "cesium-sceneModePicker-hidden" : !dropDownVisible },attr: { title: tooltip2D },click: morphTo2D,cesiumSvgPath: { path: _flatMapPath, width: 64, height: 64 }'),n.appendChild(s);var l=document.createElement("button");l.type="button",l.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon",l.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.COLUMBUS_VIEW)) || (!dropDownVisible && (sceneMode === _sceneMode.COLUMBUS_VIEW)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.COLUMBUS_VIEW,       "cesium-sceneModePicker-hidden" : !dropDownVisible},attr: { title: tooltipColumbusView },click: morphToColumbusView,cesiumSvgPath: { path: _columbusViewPath, width: 64, height: 64 }'),n.appendChild(l),h.applyBindings(i,n),this._viewModel=i,this._container=e,this._wrapper=n,this._closeDropDown=function(e){n.contains(e.target)||(i.dropDownVisible=!1)},d.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeDropDown,!0):(document.addEventListener("mousedown",this._closeDropDown,!0),document.addEventListener("touchstart",this._closeDropDown,!0))}return e(r.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return this._viewModel.destroy(),d.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeDropDown,!0):(document.removeEventListener("mousedown",this._closeDropDown,!0),document.removeEventListener("touchstart",this._closeDropDown,!0)),h.cleanNode(this._wrapper),this._container.removeChild(this._wrapper),t(this)},r}),define("Widgets/SelectionIndicator/SelectionIndicatorViewModel",["../../Core/Cartesian2","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/EasingFunction","../../Scene/SceneTransforms","../../ThirdParty/knockout"],function(e,i,a,t,n,r,o,s){"use strict";var l=new e,u="-1000px";function c(r,e,t){if(!a(r))throw new n("scene is required.");if(!a(e))throw new n("selectionIndicatorElement is required.");if(!a(t))throw new n("container is required.");this._scene=r,this._screenPositionX=u,this._screenPositionY=u,this._tweens=r.tweens,this._container=i(t,document.body),this._selectionIndicatorElement=e,this._scale=1,this.position=void 0,this.showSelection=!1,s.track(this,["position","_screenPositionX","_screenPositionY","_scale","showSelection"]),this.isVisible=void 0,s.defineProperty(this,"isVisible",{get:function(){return this.showSelection&&a(this.position)}}),s.defineProperty(this,"_transform",{get:function(){return"scale("+this._scale+")"}}),this.computeScreenSpacePosition=function(e,t){return o.wgs84ToWindowCoordinates(r,e,t)}}return c.prototype.update=function(){if(this.showSelection&&a(this.position)){var e=this.computeScreenSpacePosition(this.position,l);if(a(e)){var t=this._container,r=t.parentNode.clientWidth,i=t.parentNode.clientHeight,n=this._selectionIndicatorElement.clientWidth,o=.5*n;e.x=Math.min(Math.max(e.x,-n),r+n)-o,e.y=Math.min(Math.max(e.y,-n),i+n)-o,this._screenPositionX=Math.floor(e.x+.25)+"px",this._screenPositionY=Math.floor(e.y+.25)+"px"}else this._screenPositionX=u,this._screenPositionY=u}},c.prototype.animateAppear=function(){this._tweens.addProperty({object:this,property:"_scale",startValue:2,stopValue:1,duration:.8,easingFunction:r.EXPONENTIAL_OUT})},c.prototype.animateDepart=function(){this._tweens.addProperty({object:this,property:"_scale",startValue:this._scale,stopValue:1.5,duration:.8,easingFunction:r.EXPONENTIAL_OUT})},t(c.prototype,{container:{get:function(){return this._container}},selectionIndicatorElement:{get:function(){return this._selectionIndicatorElement}},scene:{get:function(){return this._scene}}}),c}),define("Widgets/SelectionIndicator/SelectionIndicator",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./SelectionIndicatorViewModel"],function(l,e,t,u,c,d,h){"use strict";function r(e,t){if(!l(e))throw new u("container is required.");e=d(e),this._container=e;var r=document.createElement("div");r.className="cesium-selection-wrapper",r.setAttribute("data-bind",'style: { "top" : _screenPositionY, "left" : _screenPositionX },css: { "cesium-selection-wrapper-visible" : isVisible }'),e.appendChild(r),this._element=r;var i="http://www.w3.org/2000/svg",n=document.createElementNS(i,"svg:svg");n.setAttribute("width",160),n.setAttribute("height",160),n.setAttribute("viewBox","0 0 160 160");var o=document.createElementNS(i,"g");o.setAttribute("transform","translate(80,80)"),n.appendChild(o);var a=document.createElementNS(i,"path");a.setAttribute("data-bind","attr: { transform: _transform }"),a.setAttribute("d","M -34 -34 L -34 -11.25 L -30 -15.25 L -30 -30 L -15.25 -30 L -11.25 -34 L -34 -34 z M 11.25 -34 L 15.25 -30 L 30 -30 L 30 -15.25 L 34 -11.25 L 34 -34 L 11.25 -34 z M -34 11.25 L -34 34 L -11.25 34 L -15.25 30 L -30 30 L -30 15.25 L -34 11.25 z M 34 11.25 L 30 15.25 L 30 30 L 15.25 30 L 11.25 34 L 34 34 L 34 11.25 z"),o.appendChild(a),r.appendChild(n);var s=new h(t,this._element,this._container);this._viewModel=s,c.applyBindings(this._viewModel,this._element)}return e(r.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){var e=this._container;return c.cleanNode(this._element),e.removeChild(this._element),t(this)},r}),define("Widgets/Timeline/TimelineHighlightRange",["../../Core/defaultValue","../../Core/JulianDate"],function(i,a){"use strict";function e(e,t,r){this._color=e,this._height=t,this._base=i(r,0)}return e.prototype.getHeight=function(){return this._height},e.prototype.getBase=function(){return this._base},e.prototype.getStartTime=function(){return this._start},e.prototype.getStopTime=function(){return this._stop},e.prototype.setRange=function(e,t){this._start=e,this._stop=t},e.prototype.render=function(e){var t="";if(this._start&&this._stop&&this._color){var r=a.secondsDifference(this._start,e.epochJulian),i=Math.round(e.timeBarWidth*e.getAlpha(r)),n=a.secondsDifference(this._stop,e.epochJulian),o=Math.round(e.timeBarWidth*e.getAlpha(n))-i;i<0&&(o+=i,i=0),i+o>e.timeBarWidth&&(o=e.timeBarWidth-i),0<o&&(t='<span class="cesium-timeline-highlight" style="left: '+i.toString()+"px; width: "+o.toString()+"px; bottom: "+this._base.toString()+"px; height: "+this._height+"px; background-color: "+this._color+';"></span>')}return t},e}),define("Widgets/Timeline/TimelineTrack",["../../Core/Color","../../Core/defined","../../Core/JulianDate"],function(n,c,d){"use strict";function e(e,t,r,i){this.interval=e,this.height=t,this.color=r||new n(.5,.5,.5,1),this.backgroundColor=i||new n(0,0,0,0)}return e.prototype.render=function(e,t){var r=this.interval.start,i=this.interval.stop,n=t.startJulian,o=d.addSeconds(t.startJulian,t.duration,new d);if(d.lessThan(r,n)&&d.greaterThan(i,o))e.fillStyle=this.color.toCssColorString(),e.fillRect(0,t.y,t.timeBarWidth,this.height);else if(d.lessThanOrEquals(r,o)&&d.greaterThanOrEquals(i,n)){var a,s,l;for(a=0;a<t.timeBarWidth;++a){var u=d.addSeconds(t.startJulian,a/t.timeBarWidth*t.duration,new d);!c(s)&&d.greaterThanOrEquals(u,r)?s=a:!c(l)&&d.greaterThanOrEquals(u,i)&&(l=a)}e.fillStyle=this.backgroundColor.toCssColorString(),e.fillRect(0,t.y,t.timeBarWidth,this.height),c(s)&&(c(l)||(l=t.timeBarWidth),e.fillStyle=this.color.toCssColorString(),e.fillRect(s,t.y,Math.max(l-s,1),this.height))}},e}),define("Widgets/Timeline/Timeline",["../../Core/ClockRange","../../Core/defined","../../Core/destroyObject","../../Core/DeveloperError","../../Core/JulianDate","../getElement","./TimelineHighlightRange","./TimelineTrack"],function(l,d,t,h,z,p,n,o){"use strict";var f=1e12,m={none:0,scrub:1,slide:2,zoom:3,touchOnly:4},g={none:0,scrub:1,slideZoom:2,singleTap:3,ignore:4},q=[.001,.002,.005,.01,.02,.05,.1,.25,.5,1,2,5,10,15,30,60,120,300,600,900,1800,3600,7200,14400,21600,43200,86400,172800,345600,604800,1296e3,2592e3,5184e3,7776e3,15552e3,31536e3,63072e3,126144e3,15768e4,31536e4,63072e4,126144e4,15768e5,31536e5,63072e5,126144e5,15768e6,31536e6],a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function e(e,t){if(!d(e))throw new h("container is required.");if(!d(t))throw new h("clock is required.");e=p(e),this.container=e;var r,i,n,o,a,u,s,l=document.createElement("div");l.className="cesium-timeline-main",e.appendChild(l),this._topDiv=l,this._endJulian=void 0,this._epochJulian=void 0,this._lastXPos=void 0,this._scrubElement=void 0,this._startJulian=void 0,this._timeBarSecondsSpan=void 0,this._clock=t,this._scrubJulian=t.currentTime,this._mainTicSpan=-1,this._mouseMode=m.none,this._touchMode=g.none,this._touchState={centerX:0,spanX:0},this._mouseX=0,this._timelineDrag=0,this._timelineDragLocation=void 0,this._lastHeight=void 0,this._lastWidth=void 0,this._topDiv.innerHTML='<div class="cesium-timeline-bar"></div><div class="cesium-timeline-trackContainer"><canvas class="cesium-timeline-tracks" width="10" height="1"></canvas></div><div class="cesium-timeline-needle"></div><span class="cesium-timeline-ruler"></span>',this._timeBarEle=this._topDiv.childNodes[0],this._trackContainer=this._topDiv.childNodes[1],this._trackListEle=this._topDiv.childNodes[1].childNodes[0],this._needleEle=this._topDiv.childNodes[2],this._rulerEle=this._topDiv.childNodes[3],this._context=this._trackListEle.getContext("2d"),this._trackList=[],this._highlightRanges=[],this.zoomTo(t.startTime,t.stopTime),this._onMouseDown=(r=this,function(e){r._mouseMode!==m.touchOnly&&(0===e.button?(r._mouseMode=m.scrub,r._scrubElement&&(r._scrubElement.style.backgroundPosition="-16px 0"),r._onMouseMove(e)):(r._mouseX=e.clientX,2===e.button?r._mouseMode=m.zoom:r._mouseMode=m.slide)),e.preventDefault()}),this._onMouseUp=(i=this,function(e){i._mouseMode=m.none,i._scrubElement&&(i._scrubElement.style.backgroundPosition="0 0"),i._timelineDrag=0,i._timelineDragLocation=void 0}),this._onMouseMove=(n=this,function(e){var t;if(n._mouseMode===m.scrub){e.preventDefault();var r=e.clientX-n._topDiv.getBoundingClientRect().left;r<0?(n._timelineDragLocation=0,n._timelineDrag=-.01*n._timeBarSecondsSpan):r>n._topDiv.clientWidth?(n._timelineDragLocation=n._topDiv.clientWidth,n._timelineDrag=.01*n._timeBarSecondsSpan):(n._timelineDragLocation=void 0,n._setTimeBarTime(r,r*n._timeBarSecondsSpan/n._topDiv.clientWidth))}else if(n._mouseMode===m.slide){if(t=n._mouseX-e.clientX,n._mouseX=e.clientX,0!==t){var i=t*n._timeBarSecondsSpan/n._topDiv.clientWidth;n.zoomTo(z.addSeconds(n._startJulian,i,new z),z.addSeconds(n._endJulian,i,new z))}}else n._mouseMode===m.zoom&&(t=n._mouseX-e.clientX,n._mouseX=e.clientX,0!==t&&n.zoomFrom(Math.pow(1.01,t)))}),this._onMouseWheel=(o=this,function(e){var t=e.wheelDeltaY||e.wheelDelta||-e.detail;f=Math.max(Math.min(Math.abs(t),f),1),t/=f,o.zoomFrom(Math.pow(1.05,-t))}),this._onTouchStart=(a=this,function(e){var t,r,i=e.touches.length,n=a._topDiv.getBoundingClientRect().left;e.preventDefault(),a._mouseMode=m.touchOnly,1===i?(t=z.secondsDifference(a._scrubJulian,a._startJulian),r=Math.round(t*a._topDiv.clientWidth/a._timeBarSecondsSpan+n),Math.abs(e.touches[0].clientX-r)<50?(a._touchMode=g.scrub,a._scrubElement&&(a._scrubElement.style.backgroundPosition=1===i?"-16px 0":"0 0")):(a._touchMode=g.singleTap,a._touchState.centerX=e.touches[0].clientX-n)):2===i?(a._touchMode=g.slideZoom,a._touchState.centerX=.5*(e.touches[0].clientX+e.touches[1].clientX)-n,a._touchState.spanX=Math.abs(e.touches[0].clientX-e.touches[1].clientX)):a._touchMode=g.ignore}),this._onTouchMove=(u=this,function(e){var t,r,i,n,o,a,s=1,l=u._topDiv.getBoundingClientRect().left;u._touchMode===g.singleTap&&(u._touchMode=g.slideZoom),u._mouseMode=m.touchOnly,u._touchMode===g.scrub?(e.preventDefault(),1===e.changedTouches.length&&0<=(r=e.changedTouches[0].clientX-l)&&r<=u._topDiv.clientWidth&&u._setTimeBarTime(r,r*u._timeBarSecondsSpan/u._topDiv.clientWidth)):u._touchMode===g.slideZoom&&(2===(i=e.touches.length)?(n=.5*(e.touches[0].clientX+e.touches[1].clientX)-l,o=Math.abs(e.touches[0].clientX-e.touches[1].clientX)):1===i&&(n=e.touches[0].clientX-l,o=0),d(n)&&(a=0<o&&0<u._touchState.spanX?(s=u._touchState.spanX/o,z.addSeconds(u._startJulian,(u._touchState.centerX*u._timeBarSecondsSpan-n*u._timeBarSecondsSpan*s)/u._topDiv.clientWidth,new z)):(t=u._touchState.centerX-n,z.addSeconds(u._startJulian,t*u._timeBarSecondsSpan/u._topDiv.clientWidth,new z)),u.zoomTo(a,z.addSeconds(a,u._timeBarSecondsSpan*s,new z)),u._touchState.centerX=n,u._touchState.spanX=o))}),this._onTouchEnd=(s=this,function(e){var t=e.touches.length,r=s._topDiv.getBoundingClientRect().left;s._touchMode===g.singleTap?(s._touchMode=g.scrub,s._onTouchMove(e)):s._touchMode===g.scrub&&s._onTouchMove(e),s._mouseMode=m.touchOnly,1!==t?s._touchMode=0<t?g.ignore:g.none:s._touchMode===g.slideZoom&&(s._touchState.centerX=e.touches[0].clientX-r),s._scrubElement&&(s._scrubElement.style.backgroundPosition="0 0")});var c=this._timeBarEle;document.addEventListener("mouseup",this._onMouseUp,!1),document.addEventListener("mousemove",this._onMouseMove,!1),c.addEventListener("mousedown",this._onMouseDown,!1),c.addEventListener("DOMMouseScroll",this._onMouseWheel,!1),c.addEventListener("mousewheel",this._onMouseWheel,!1),c.addEventListener("touchstart",this._onTouchStart,!1),c.addEventListener("touchmove",this._onTouchMove,!1),c.addEventListener("touchend",this._onTouchEnd,!1),c.addEventListener("touchcancel",this._onTouchEnd,!1),this._topDiv.oncontextmenu=function(){return!1},t.onTick.addEventListener(this.updateFromClock,this),this.updateFromClock()}function s(e){return e<10?"0"+e.toString():e.toString()}return e.prototype.addEventListener=function(e,t,r){this._topDiv.addEventListener(e,t,r)},e.prototype.removeEventListener=function(e,t,r){this._topDiv.removeEventListener(e,t,r)},e.prototype.isDestroyed=function(){return!1},e.prototype.destroy=function(){this._clock.onTick.removeEventListener(this.updateFromClock,this),document.removeEventListener("mouseup",this._onMouseUp,!1),document.removeEventListener("mousemove",this._onMouseMove,!1);var e=this._timeBarEle;e.removeEventListener("mousedown",this._onMouseDown,!1),e.removeEventListener("DOMMouseScroll",this._onMouseWheel,!1),e.removeEventListener("mousewheel",this._onMouseWheel,!1),e.removeEventListener("touchstart",this._onTouchStart,!1),e.removeEventListener("touchmove",this._onTouchMove,!1),e.removeEventListener("touchend",this._onTouchEnd,!1),e.removeEventListener("touchcancel",this._onTouchEnd,!1),this.container.removeChild(this._topDiv),t(this)},e.prototype.addHighlightRange=function(e,t,r){var i=new n(e,t,r);return this._highlightRanges.push(i),this.resize(),i},e.prototype.addTrack=function(e,t,r,i){var n=new o(e,t,r,i);return this._trackList.push(n),this._lastHeight=void 0,this.resize(),n},e.prototype.zoomTo=function(e,t){if(!d(e))throw new h("startTime is required.");if(!d(t))throw new h("stopTime is required");if(z.lessThanOrEquals(t,e))throw new h("Start time must come before end time.");if(this._startJulian=e,this._endJulian=t,this._timeBarSecondsSpan=z.secondsDifference(t,e),this._clock&&this._clock.clockRange!==l.UNBOUNDED){var r=this._clock.startTime,i=this._clock.stopTime,n=z.secondsDifference(i,r),o=z.secondsDifference(r,this._startJulian),a=z.secondsDifference(i,this._endJulian);this._timeBarSecondsSpan>=n?(this._timeBarSecondsSpan=n,this._startJulian=this._clock.startTime,this._endJulian=this._clock.stopTime):0<o?(this._endJulian=z.addSeconds(this._endJulian,o,new z),this._startJulian=r,this._timeBarSecondsSpan=z.secondsDifference(this._endJulian,this._startJulian)):a<0&&(this._startJulian=z.addSeconds(this._startJulian,a,new z),this._endJulian=i,this._timeBarSecondsSpan=z.secondsDifference(this._endJulian,this._startJulian))}this._makeTics();var s=document.createEvent("Event");s.initEvent("setzoom",!0,!0),s.startJulian=this._startJulian,s.endJulian=this._endJulian,s.epochJulian=this._epochJulian,s.totalSpan=this._timeBarSecondsSpan,s.mainTicSpan=this._mainTicSpan,this._topDiv.dispatchEvent(s)},e.prototype.zoomFrom=function(e){var t=z.secondsDifference(this._scrubJulian,this._startJulian);1<e||t<0||t>this._timeBarSecondsSpan?t=.5*this._timeBarSecondsSpan:t+=t-.5*this._timeBarSecondsSpan;var r=this._timeBarSecondsSpan-t;this.zoomTo(z.addSeconds(this._startJulian,t-t*e,new z),z.addSeconds(this._endJulian,r*e-r,new z))},e.prototype.makeLabel=function(e){var t=z.toGregorianDate(e),r=t.millisecond,i=" UTC";if(0<r&&this._timeBarSecondsSpan<3600){for(i=Math.floor(r).toString();i.length<3;)i="0"+i;i="."+i}return a[t.month-1]+" "+t.day+" "+t.year+" "+s(t.hour)+":"+s(t.minute)+":"+s(t.second)+i},e.prototype.smallestTicInPixels=7,e.prototype._makeTics=function(){var e,t=this._timeBarEle,r=z.secondsDifference(this._scrubJulian,this._startJulian),i=Math.round(r*this._topDiv.clientWidth/this._timeBarSecondsSpan),n=i-8,o=this;this._needleEle.style.left=i.toString()+"px";var a="",s=31536e6,l=0,u=this._timeBarSecondsSpan;u<.01?(u=.01,this._timeBarSecondsSpan=.01,this._endJulian=z.addSeconds(this._startJulian,.01,new z)):s<u&&(u=s,this._timeBarSecondsSpan=s,this._endJulian=z.addSeconds(this._startJulian,s,new z));var c=this._timeBarEle.clientWidth;c<10&&(c=10);var d,h=this._startJulian,p=Math.min(u/c*1e-5,.4),f=z.toGregorianDate(h);d=31536e4<u?z.fromDate(new Date(Date.UTC(100*Math.floor(f.year/100),0))):31536e3<u?z.fromDate(new Date(Date.UTC(10*Math.floor(f.year/10),0))):86400<u?z.fromDate(new Date(Date.UTC(f.year,0))):z.fromDate(new Date(Date.UTC(f.year,f.month,f.day)));var m=z.secondsDifference(this._startJulian,z.addSeconds(d,p,new z)),g=m+u;function _(e){return Math.floor(m/e)*e}function v(e,t){return Math.ceil(e/t+.5)*t}function y(e){return(e-m)/u}function b(e,t){return e-t*Math.round(e/t)}this._epochJulian=d,this._rulerEle.innerHTML=this.makeLabel(z.addSeconds(this._endJulian,-.01,new z));var C=this._rulerEle.offsetWidth+20;C<30&&(C=180);var w=l;l-=1e-10;var S={startTime:m,startJulian:h,epochJulian:d,duration:u,timeBarWidth:c,getAlpha:y};this._highlightRanges.forEach(function(e){a+=e.render(S)});var T=0,E=0,A=0,x=C/c;1<x&&(x=1),x*=this._timeBarSecondsSpan;var P,D=-1,O=-1,I=q.length;for(P=0;P<I;++P){var M=q[P];if(++D,x<(T=M)&&l<M)break;O<0&&c*(M/this._timeBarSecondsSpan)>=this.smallestTicInPixels&&(O=D)}if(0<D){for(;0<D;)if(--D,Math.abs(b(T,q[D]))<1e-5){l<=q[D]&&(E=q[D]);break}if(0<=O)for(;O<D;){if(Math.abs(b(E,q[O]))<1e-5&&l<=q[O]){A=q[O];break}++O}}1e-10<(l=w)&&A<1e-5&&1e-10<Math.abs(l-T)&&(A=l)<=T+1e-10&&(E=0);var R,L=-999999;if(3<=c*(A/this._timeBarSecondsSpan))for(e=_(A);e<=g;e=v(e,A))a+='<span class="cesium-timeline-ticTiny" style="left: '+Math.round(c*y(e)).toString()+'px;"></span>';if(3<=c*(E/this._timeBarSecondsSpan))for(e=_(E);e<=g;e=v(e,E))a+='<span class="cesium-timeline-ticSub" style="left: '+Math.round(c*y(e)).toString()+'px;"></span>';if(2<=c*(T/this._timeBarSecondsSpan)){g+=this._mainTicSpan=T,e=_(T);for(var N=z.computeTaiMinusUtc(d);e<=g;){var k=z.addSeconds(h,e-m,new z);if(2.1<T){var F=z.computeTaiMinusUtc(k);.1<Math.abs(F-N)&&(e+=F-N,k=z.addSeconds(h,e-m,new z))}var B=Math.round(c*y(e)),U=this.makeLabel(k);this._rulerEle.innerHTML=U,(R=this._rulerEle.offsetWidth)<10&&(R=C);var V=B-(R/2-1);L<V?(L=V+R+5,a+='<span class="cesium-timeline-ticMain" style="left: '+B.toString()+'px;"></span><span class="cesium-timeline-ticLabel" style="left: '+V.toString()+'px;">'+U+"</span>"):a+='<span class="cesium-timeline-ticSub" style="left: '+B.toString()+'px;"></span>',e=v(e,T)}}else this._mainTicSpan=-1;a+='<span class="cesium-timeline-icon16" style="left:'+n+'px;bottom:0;background-position: 0 0;"></span>',t.innerHTML=a,this._scrubElement=t.lastChild,this._context.clearRect(0,0,this._trackListEle.width,this._trackListEle.height),S.y=0,this._trackList.forEach(function(e){e.render(o._context,S),S.y+=e.height})},e.prototype.updateFromClock=function(){this._scrubJulian=this._clock.currentTime;var e=this._scrubElement;if(d(this._scrubElement)){var t=z.secondsDifference(this._scrubJulian,this._startJulian),r=Math.round(t*this._topDiv.clientWidth/this._timeBarSecondsSpan);this._lastXPos!==r&&(this._lastXPos=r,e.style.left=r-8+"px",this._needleEle.style.left=r+"px")}d(this._timelineDragLocation)&&(this._setTimeBarTime(this._timelineDragLocation,this._timelineDragLocation*this._timeBarSecondsSpan/this._topDiv.clientWidth),this.zoomTo(z.addSeconds(this._startJulian,this._timelineDrag,new z),z.addSeconds(this._endJulian,this._timelineDrag,new z)))},e.prototype._setTimeBarTime=function(e,t){if(e=Math.round(e),this._scrubJulian=z.addSeconds(this._startJulian,t,new z),this._scrubElement){var r=e-8;this._scrubElement.style.left=r.toString()+"px",this._needleEle.style.left=e.toString()+"px"}var i=document.createEvent("Event");i.initEvent("settime",!0,!0),i.clientX=e,i.timeSeconds=t,i.timeJulian=this._scrubJulian,i.clock=this._clock,this._topDiv.dispatchEvent(i)},e.prototype.resize=function(){var e=this.container.clientWidth,t=this.container.clientHeight;if(e!==this._lastWidth||t!==this._lastHeight){this._trackContainer.style.height=t+"px";var r=1;this._trackList.forEach(function(e){r+=e.height}),this._trackListEle.style.height=r.toString()+"px",this._trackListEle.width=this._trackListEle.clientWidth,this._trackListEle.height=r,this._makeTics(),this._lastXPos=void 0,this._lastWidth=e,this._lastHeight=t}},e}),define("Widgets/VRButton/VRButtonViewModel",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/EventHelper","../../Core/Fullscreen","../../Core/OrthographicFrustum","../../ThirdParty/knockout","../../ThirdParty/NoSleep","../createCommand","../getElement"],function(a,s,e,t,l,u,c,d,h,p,f,m){"use strict";function g(){var e=window.screen;s(e)&&(s(e.unlockOrientation)?e.unlockOrientation():s(e.mozUnlockOrientation)?e.mozUnlockOrientation():s(e.msUnlockOrientation)?e.msUnlockOrientation():s(e.orientation&&e.orientation.unlock)&&e.orientation.unlock())}function _(e,t,r,i){var n,o,a;i()||(r()?(t.useWebVR=!1,e._locked&&(g(),e._locked=!1),e._noSleep.disable(),c.exitFullscreen(),r(!1)):(c.fullscreen||c.requestFullscreen(e._vrElement),e._noSleep.enable(),e._locked||(e._locked=(o=!(n="landscape"),a=window.screen,s(a)&&(s(a.lockOrientation)?o=a.lockOrientation(n):s(a.mozLockOrientation)?o=a.mozLockOrientation(n):s(a.msLockOrientation)?o=a.msLockOrientation(n):s(a.orientation&&a.orientation.lock)&&(o=a.orientation.lock(n))),o)),r(t.useWebVR=!0)))}function r(e,t){if(!s(e))throw new l("scene is required.");var r=this,i=h.observable(c.enabled),n=h.observable(!1);this.isVRMode=void 0,h.defineProperty(this,"isVRMode",{get:function(){return n()}}),this.isVREnabled=void 0,h.defineProperty(this,"isVREnabled",{get:function(){return i()},set:function(e){i(e&&c.enabled)}}),this.tooltip=void 0,h.defineProperty(this,"tooltip",function(){return i()?n()?"Exit VR mode":"Enter VR mode":"VR mode is unavailable"});var o=h.observable(!1);this._isOrthographic=void 0,h.defineProperty(this,"_isOrthographic",{get:function(){return o()}}),this._eventHelper=new u,this._eventHelper.add(e.preRender,function(){o(e.camera.frustum instanceof d)}),this._locked=!1,this._noSleep=new p,this._command=f(function(){_(r,e,n,o)},h.getObservable(this,"isVREnabled")),this._vrElement=a(m(t),document.body),this._callback=function(){!c.fullscreen&&n()&&(e.useWebVR=!1,r._locked&&(g(),r._locked=!1),r._noSleep.disable(),n(!1))},document.addEventListener(c.changeEventName,this._callback)}return e(r.prototype,{vrElement:{get:function(){return this._vrElement},set:function(e){if(!(e instanceof Element))throw new l("value must be a valid Element.");this._vrElement=e}},command:{get:function(){return this._command}}}),r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){this._eventHelper.removeAll(),document.removeEventListener(c.changeEventName,this._callback),t(this)},r}),define("Widgets/VRButton/VRButton",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./VRButtonViewModel"],function(o,e,t,a,s,l,u){"use strict";function r(e,t,r){if(!o(e))throw new a("container is required.");if(!o(t))throw new a("scene is required.");e=l(e);var i=new u(t,r);i._exitVRPath="M 25.770585,2.4552065 C 15.72282,13.962707 10.699956,19.704407 8.1768352,22.580207 c -1.261561,1.4379 -1.902282,2.1427 -2.21875,2.5 -0.141624,0.1599 -0.208984,0.2355 -0.25,0.2813 l 0.6875,0.75 c 10e-5,-10e-5 0.679191,0.727 0.6875,0.7187 0.01662,-0.016 0.02451,-0.024 0.03125,-0.031 0.01348,-0.014 0.04013,-0.038 0.0625,-0.062 0.04474,-0.05 0.120921,-0.1315 0.28125,-0.3126 0.320657,-0.3619 0.956139,-1.0921 2.2187499,-2.5312 2.5252219,-2.8781 7.5454589,-8.6169 17.5937499,-20.1250005 l -1.5,-1.3125 z m -20.5624998,3.9063 c -1.304375,0 -2.34375,1.0391 -2.34375,2.3437 l 0,10.8125005 c 0,1.3043 1.039375,2.375 2.34375,2.375 l 2.25,0 c 1.9518039,-2.2246 7.4710958,-8.5584 13.5624998,-15.5312005 l -15.8124998,0 z m 21.1249998,0 c -1.855467,2.1245 -2.114296,2.4005 -3.59375,4.0936995 1.767282,0.1815 3.15625,1.685301 3.15625,3.500001 0,1.9349 -1.56511,3.5 -3.5,3.5 -1.658043,0 -3.043426,-1.1411 -3.40625,-2.6875 -1.089617,1.2461 -2.647139,2.9988 -3.46875,3.9375 0.191501,-0.062 0.388502,-0.094 0.59375,-0.094 1.373338,0 2.50006,1.4614 2.5625,3.2812 l 8.3125,0 c 1.304375,0 2.34375,-1.0707 2.34375,-2.375 l 0,-10.8125005 c 0,-1.3046 -1.039375,-2.3437 -2.34375,-2.3437 l -0.65625,0 z M 9.5518351,10.423906 c 1.9348899,0 3.4999999,1.596401 3.4999999,3.531301 0,1.9349 -1.56511,3.5 -3.4999999,3.5 -1.9348899,0 -3.4999999,-1.5651 -3.4999999,-3.5 0,-1.9349 1.56511,-3.531301 3.4999999,-3.531301 z m 4.2187499,10.312601 c -0.206517,0.2356 -0.844218,0.9428 -1.03125,1.1562 l 0.8125,0 c 0.01392,-0.4081 0.107026,-0.7968 0.21875,-1.1562 z",i._enterVRPath="M 5.3125 6.375 C 4.008126 6.375 2.96875 7.4141499 2.96875 8.71875 L 2.96875 19.5 C 2.96875 20.8043 4.008126 21.875 5.3125 21.875 L 13.65625 21.875 C 13.71832 20.0547 14.845166 18.59375 16.21875 18.59375 C 17.592088 18.59375 18.71881 20.0552 18.78125 21.875 L 27.09375 21.875 C 28.398125 21.875 29.4375 20.8043 29.4375 19.5 L 29.4375 8.71875 C 29.4375 7.4141499 28.398125 6.375 27.09375 6.375 L 5.3125 6.375 z M 9.625 10.4375 C 11.55989 10.4375 13.125 12.03385 13.125 13.96875 C 13.125 15.90365 11.55989 17.46875 9.625 17.46875 C 7.69011 17.46875 6.125 15.90365 6.125 13.96875 C 6.125 12.03385 7.69011 10.4375 9.625 10.4375 z M 22.46875 10.4375 C 24.40364 10.4375 25.96875 12.03385 25.96875 13.96875 C 25.96875 15.90365 24.40364 17.46875 22.46875 17.46875 C 20.53386 17.46875 18.96875 15.90365 18.96875 13.96875 C 18.96875 12.03385 20.53386 10.4375 22.46875 10.4375 z";var n=document.createElement("button");n.type="button",n.className="cesium-button cesium-vrButton",n.setAttribute("data-bind",'css: { "cesium-button-disabled" : _isOrthographic }, attr: { title: tooltip },click: command,enable: isVREnabled,cesiumSvgPath: { path: isVRMode ? _exitVRPath : _enterVRPath, width: 32, height: 32 }'),e.appendChild(n),s.applyBindings(i,n),this._container=e,this._viewModel=i,this._element=n}return e(r.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return this._viewModel.destroy(),s.cleanNode(this._element),this._container.removeChild(this._element),t(this)},r}),define("Widgets/Viewer/Viewer",["../../Core/BoundingSphere","../../Core/Cartesian3","../../Core/Check","../../Core/Clock","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/Event","../../Core/EventHelper","../../Core/HeadingPitchRange","../../Core/isArray","../../Core/Matrix4","../../Core/Rectangle","../../Core/ScreenSpaceEventType","../../DataSources/BoundingSphereState","../../DataSources/ConstantPositionProperty","../../DataSources/DataSourceCollection","../../DataSources/DataSourceDisplay","../../DataSources/Entity","../../DataSources/EntityView","../../DataSources/Property","../../Scene/Cesium3DTileset","../../Scene/ImageryLayer","../../Scene/SceneMode","../../ThirdParty/knockout","../../ThirdParty/when","../Animation/Animation","../Animation/AnimationViewModel","../BaseLayerPicker/BaseLayerPicker","../BaseLayerPicker/createDefaultImageryProviderViewModels","../BaseLayerPicker/createDefaultTerrainProviderViewModels","../CesiumWidget/CesiumWidget","../ClockViewModel","../FullscreenButton/FullscreenButton","../Geocoder/Geocoder","../getElement","../HomeButton/HomeButton","../InfoBox/InfoBox","../NavigationHelpButton/NavigationHelpButton","../ProjectionPicker/ProjectionPicker","../SceneModePicker/SceneModePicker","../SelectionIndicator/SelectionIndicator","../subscribeAndEvaluate","../Timeline/Timeline","../VRButton/VRButton"],function(h,d,e,Y,X,Q,t,i,Z,K,J,p,$,f,m,ee,g,a,te,re,s,l,ie,_,o,v,ne,u,oe,ae,se,le,ue,ce,de,he,pe,fe,me,ge,_e,ve,ye,be,Ce,we,Se){"use strict";var y=new h;function Te(e){var t=e.clock;t.currentTime=e.timeJulian,t.shouldAnimate=!1}function Ee(e,t){var r=e.scene.pick(t.position);if(Q(r)){var i=X(r.id,r.primitive.id);if(i instanceof s)return i}if(Q(e.scene.globe))return function(n,e){var t=n.scene,r=t.camera.getPickRay(e),i=t.imageryLayers.pickImageryLayerFeatures(r,t);if(!Q(i))return;var o=new s({id:"Loading...",description:"Loading feature information..."});return u(i,function(e){if(n.selectedEntity===o)if(Q(e)&&0!==e.length){var t=e[0],r=new s({id:t.name,description:t.description});if(Q(t.position)){var i=n.scene.globe.ellipsoid.cartographicToCartesian(t.position,c);r.position=new a(i)}n.selectedEntity=r}else n.selectedEntity=b()},function(){n.selectedEntity===o&&(n.selectedEntity=b())}),o}(e,t.position)}function r(e,t,r){if(Q(r)){var i=r.clock;Q(i)&&(i.getValue(t),Q(e)&&(e.updateFromClock(),e.zoomTo(i.startTime,i.stopTime)))}}var c=new d;function b(){return new s({id:"None",description:"No features found."})}function Ae(e,t){if(!Q(e))throw new Z("container is required.");e=fe(e),t=X(t,X.EMPTY_OBJECT);var r=!(Q(t.globe)&&!1===t.globe||Q(t.baseLayerPicker)&&!1===t.baseLayerPicker);if(r&&Q(t.imageryProvider))throw new Z("options.imageryProvider is not available when using the BaseLayerPicker widget. Either specify options.selectedImageryProviderViewModel instead or set options.baseLayerPicker to false.");if(!r&&Q(t.selectedImageryProviderViewModel))throw new Z("options.selectedImageryProviderViewModel is not available when not using the BaseLayerPicker widget. Either specify options.imageryProvider instead or set options.baseLayerPicker to true.");if(r&&Q(t.terrainProvider))throw new Z("options.terrainProvider is not available when using the BaseLayerPicker widget. Either specify options.selectedTerrainProviderViewModel instead or set options.baseLayerPicker to false.");if(!r&&Q(t.selectedTerrainProviderViewModel))throw new Z("options.selectedTerrainProviderViewModel is not available when not using the BaseLayerPicker widget. Either specify options.terrainProvider instead or set options.baseLayerPicker to true.");var i=this,n=document.createElement("div");n.className="cesium-viewer",e.appendChild(n);var o=document.createElement("div");o.className="cesium-viewer-cesiumWidgetContainer",n.appendChild(o);var a=document.createElement("div");a.className="cesium-viewer-bottom",n.appendChild(a);var s,l,u=X(t.scene3DOnly,!1),c=!1;Q(t.clockViewModel)?s=(l=t.clockViewModel).clock:(s=new Y,l=new de(s),c=!0),Q(t.shouldAnimate)&&(s.shouldAnimate=t.shouldAnimate);var d=new ce(o,{terrainProvider:t.terrainProvider,imageryProvider:!r&&t.imageryProvider,clock:s,skyBox:t.skyBox,skyAtmosphere:t.skyAtmosphere,sceneMode:t.sceneMode,mapProjection:t.mapProjection,globe:t.globe,orderIndependentTranslucency:t.orderIndependentTranslucency,contextOptions:t.contextOptions,useDefaultRenderLoop:t.useDefaultRenderLoop,targetFrameRate:t.targetFrameRate,showRenderLoopErrors:t.showRenderLoopErrors,creditContainer:Q(t.creditContainer)?t.creditContainer:a,creditViewport:t.creditViewport,scene3DOnly:u,terrainExaggeration:t.terrainExaggeration,shadows:t.shadows,terrainShadows:t.terrainShadows,mapMode2D:t.mapMode2D,requestRenderMode:t.requestRenderMode,maximumRenderTimeChange:t.maximumRenderTimeChange}),h=t.dataSources,p=!1;Q(h)||(h=new te,p=!0);var f,m,g=new re({scene:d.scene,dataSourceCollection:h}),_=new J;if(_.add(s.onTick,Ae.prototype._onTick,this),_.add(d.scene.morphStart,Ae.prototype._clearTrackedObject,this),!Q(t.selectionIndicator)||!1!==t.selectionIndicator){var v=document.createElement("div");v.className="cesium-viewer-selectionIndicatorContainer",n.appendChild(v),f=new be(v,d.scene)}if(!Q(t.infoBox)||!1!==t.infoBox){var y=document.createElement("div");y.className="cesium-viewer-infoBoxContainer",n.appendChild(y);var b=(m=new ge(y)).viewModel;_.add(b.cameraClicked,Ae.prototype._onInfoBoxCameraClicked,this),_.add(b.closeClicked,Ae.prototype._onInfoBoxClockClicked,this)}var C,w,S,T,E,A,x,P,D,O,I,M,R,L,N,k=document.createElement("div");if(k.className="cesium-viewer-toolbar",n.appendChild(k),!Q(t.geocoder)||!1!==t.geocoder){var F=document.createElement("div");F.className="cesium-viewer-geocoderContainer",k.appendChild(F),C=new pe({container:F,geocoderServices:Q(t.geocoder)?$(t.geocoder)?t.geocoder:[t.geocoder]:void 0,scene:d.scene}),_.add(C.viewModel.search.beforeExecute,Ae.prototype._clearObjects,this)}if(Q(t.homeButton)&&!1===t.homeButton||(w=new me(k,d.scene),Q(C)&&_.add(w.viewModel.command.afterExecute,function(){var e=C.viewModel;e.searchText="",e.isSearchInProgress&&e.search()}),_.add(w.viewModel.command.beforeExecute,Ae.prototype._clearTrackedObject,this)),!0===t.sceneModePicker&&u)throw new Z("options.sceneModePicker is not available when options.scene3DOnly is set to true.");if(u||Q(t.sceneModePicker)&&!1===t.sceneModePicker||(S=new ye(k,d.scene)),t.projectionPicker&&(T=new ve(k,d.scene)),r){var B=X(t.imageryProviderViewModels,le()),U=X(t.terrainProviderViewModels,ue());E=new se(k,{globe:d.scene.globe,imageryProviderViewModels:B,selectedImageryProviderViewModel:t.selectedImageryProviderViewModel,terrainProviderViewModels:U,selectedTerrainProviderViewModel:t.selectedTerrainProviderViewModel}),A=k.getElementsByClassName("cesium-baseLayerPicker-dropDown")[0]}if(!Q(t.navigationHelpButton)||!1!==t.navigationHelpButton){var V=!0;try{if(Q(window.localStorage)){var z=window.localStorage.getItem("cesium-hasSeenNavHelp");Q(z)&&Boolean(z)?V=!1:window.localStorage.setItem("cesium-hasSeenNavHelp","true")}}catch(e){}x=new _e({container:k,instructionsInitiallyVisible:X(t.navigationInstructionsInitiallyVisible,V)})}if(!Q(t.animation)||!1!==t.animation){var q=document.createElement("div");q.className="cesium-viewer-animationContainer",n.appendChild(q),P=new oe(q,new ae(l))}if(!Q(t.timeline)||!1!==t.timeline){var G=document.createElement("div");G.className="cesium-viewer-timelineContainer",n.appendChild(G),(D=new we(G,s)).addEventListener("settime",Te,!1),D.zoomTo(s.startTime,s.stopTime)}if(Q(t.fullscreenButton)&&!1===t.fullscreenButton||((M=document.createElement("div")).className="cesium-viewer-fullscreenContainer",n.appendChild(M),O=new he(M,t.fullscreenElement),I=Ce(O.viewModel,"isFullscreenEnabled",function(e){M.style.display=e?"block":"none",Q(D)&&(D.container.style.right=M.clientWidth+"px",D.resize())})),t.vrButton){var W=document.createElement("div");W.className="cesium-viewer-vrContainer",n.appendChild(W),R=new Se(W,d.scene,t.fullScreenElement),L=Ce(R.viewModel,"isVREnabled",function(e){W.style.display=e?"block":"none",Q(O)&&(W.style.right=M.clientWidth+"px"),Q(D)&&(D.container.style.right=W.clientWidth+"px",D.resize())}),N=Ce(R.viewModel,"isVRMode",function(e){!function(e,t){var r=e._geocoder,i=e._homeButton,n=e._sceneModePicker,o=e._projectionPicker,a=e._baseLayerPicker,s=e._animation,l=e._timeline,u=e._fullscreenButton,c=e._infoBox,d=e._selectionIndicator,h=t?"hidden":"visible";if(Q(r)&&(r.container.style.visibility=h),Q(i)&&(i.container.style.visibility=h),Q(n)&&(n.container.style.visibility=h),Q(o)&&(o.container.style.visibility=h),Q(a)&&(a.container.style.visibility=h),Q(s)&&(s.container.style.visibility=h),Q(l)&&(l.container.style.visibility=h),Q(u)&&u.viewModel.isFullscreenEnabled&&(u.container.style.visibility=h),Q(c)&&(c.container.style.visibility=h),Q(d)&&(d.container.style.visibility=h),e._container){var p=t||!Q(u)?0:u.container.clientWidth;e._vrButton.container.style.right=p+"px",e.forceResize()}}(i,e)})}this._baseLayerPickerDropDown=A,this._fullscreenSubscription=I,this._vrSubscription=L,this._vrModeSubscription=N,this._dataSourceChangedListeners={},this._automaticallyTrackDataSourceClocks=X(t.automaticallyTrackDataSourceClocks,!0),this._container=e,this._bottomContainer=a,this._element=n,this._cesiumWidget=d,this._selectionIndicator=f,this._infoBox=m,this._dataSourceCollection=h,this._destroyDataSourceCollection=p,this._dataSourceDisplay=g,this._clockViewModel=l,this._destroyClockViewModel=c,this._toolbar=k,this._homeButton=w,this._sceneModePicker=S,this._projectionPicker=T,this._baseLayerPicker=E,this._navigationHelpButton=x,this._animation=P,this._timeline=D,this._fullscreenButton=O,this._vrButton=R,this._geocoder=C,this._eventHelper=_,this._lastWidth=0,this._lastHeight=0,this._allowDataSourcesToSuspendAnimation=!0,this._entityView=void 0,this._enableInfoOrSelection=Q(m)||Q(f),this._clockTrackedDataSource=void 0,this._trackedEntity=void 0,this._needTrackedEntityUpdate=!1,this._selectedEntity=void 0,this._clockTrackedDataSource=void 0,this._forceResize=!1,this._zoomIsFlight=!1,this._zoomTarget=void 0,this._zoomPromise=void 0,this._zoomOptions=void 0,this._selectedEntityChanged=new K,this._trackedEntityChanged=new K,ne.track(this,["_trackedEntity","_selectedEntity","_clockTrackedDataSource"]),_.add(h.dataSourceAdded,Ae.prototype._onDataSourceAdded,this),_.add(h.dataSourceRemoved,Ae.prototype._onDataSourceRemoved,this),_.add(d.scene.postUpdate,Ae.prototype.resize,this),_.add(d.scene.postRender,Ae.prototype._postRender,this);for(var H=h.length,j=0;j<H;j++)this._dataSourceAdded(h,h.get(j));this._dataSourceAdded(void 0,g.defaultDataSource),_.add(h.dataSourceAdded,Ae.prototype._dataSourceAdded,this),_.add(h.dataSourceRemoved,Ae.prototype._dataSourceRemoved,this),d.screenSpaceEventHandler.setInputAction(function(e){i.selectedEntity=Ee(i,e)},ee.LEFT_CLICK),d.screenSpaceEventHandler.setInputAction(function(e){var t=Ee(i,e);Q(t)&&(ie.getValueOrUndefined(t.position,i.clock.currentTime)?i.trackedEntity=t:i.zoomTo(t))},ee.LEFT_DOUBLE_CLICK)}function n(r,e,t,i){if(!Q(e))throw new Z("zoomTarget is required.");w(r);var n=u.defer();return r._zoomPromise=n,r._zoomIsFlight=i,r._zoomOptions=t,u(e,function(e){if(r._zoomPromise===n)if(e instanceof o)e.getViewableRectangle().then(function(e){r._zoomPromise===n&&(r._zoomTarget=e)});else if(e instanceof _)r._zoomTarget=e;else if(e.isLoading&&Q(e.loadingEvent))var t=e.loadingEvent.addEventListener(function(){t(),r._zoomPromise===n&&(r._zoomTarget=e.entities.values.slice(0))});else $(e)?r._zoomTarget=e.slice(0):(e=X(e.values,e),Q(e.entities)&&(e=e.entities.values),$(e)?r._zoomTarget=e.slice(0):r._zoomTarget=[e])}),r.scene.requestRender(),n.promise}function C(e){e._zoomPromise=void 0,e._zoomTarget=void 0,e._zoomOptions=void 0}function w(e){var t=e._zoomPromise;Q(t)&&(C(e),t.resolve(!1))}return t(Ae.prototype,{container:{get:function(){return this._container}},bottomContainer:{get:function(){return this._bottomContainer}},cesiumWidget:{get:function(){return this._cesiumWidget}},selectionIndicator:{get:function(){return this._selectionIndicator}},infoBox:{get:function(){return this._infoBox}},geocoder:{get:function(){return this._geocoder}},homeButton:{get:function(){return this._homeButton}},sceneModePicker:{get:function(){return this._sceneModePicker}},projectionPicker:{get:function(){return this._projectionPicker}},baseLayerPicker:{get:function(){return this._baseLayerPicker}},navigationHelpButton:{get:function(){return this._navigationHelpButton}},animation:{get:function(){return this._animation}},timeline:{get:function(){return this._timeline}},fullscreenButton:{get:function(){return this._fullscreenButton}},vrButton:{get:function(){return this._vrButton}},dataSourceDisplay:{get:function(){return this._dataSourceDisplay}},entities:{get:function(){return this._dataSourceDisplay.defaultDataSource.entities}},dataSources:{get:function(){return this._dataSourceCollection}},canvas:{get:function(){return this._cesiumWidget.canvas}},cesiumLogo:{get:function(){return this._cesiumWidget.cesiumLogo}},scene:{get:function(){return this._cesiumWidget.scene}},shadows:{get:function(){return this.scene.shadowMap.enabled},set:function(e){this.scene.shadowMap.enabled=e}},terrainShadows:{get:function(){return this.scene.globe.shadows},set:function(e){this.scene.globe.shadows=e}},shadowMap:{get:function(){return this.scene.shadowMap}},imageryLayers:{get:function(){return this.scene.imageryLayers}},terrainProvider:{get:function(){return this.scene.terrainProvider},set:function(e){this.scene.terrainProvider=e}},camera:{get:function(){return this.scene.camera}},clock:{get:function(){return this._clockViewModel.clock}},clockViewModel:{get:function(){return this._clockViewModel}},screenSpaceEventHandler:{get:function(){return this._cesiumWidget.screenSpaceEventHandler}},targetFrameRate:{get:function(){return this._cesiumWidget.targetFrameRate},set:function(e){this._cesiumWidget.targetFrameRate=e}},useDefaultRenderLoop:{get:function(){return this._cesiumWidget.useDefaultRenderLoop},set:function(e){this._cesiumWidget.useDefaultRenderLoop=e}},resolutionScale:{get:function(){return this._cesiumWidget.resolutionScale},set:function(e){this._cesiumWidget.resolutionScale=e,this._forceResize=!0}},allowDataSourcesToSuspendAnimation:{get:function(){return this._allowDataSourcesToSuspendAnimation},set:function(e){this._allowDataSourcesToSuspendAnimation=e}},trackedEntity:{get:function(){return this._trackedEntity},set:function(e){if(this._trackedEntity!==e){this._trackedEntity=e,w(this);var t=this.scene,r=t.mode;Q(e)&&Q(e.position)?this._needTrackedEntityUpdate=!0:(this._needTrackedEntityUpdate=!1,r!==v.COLUMBUS_VIEW&&r!==v.SCENE2D||(t.screenSpaceCameraController.enableTranslate=!0),r!==v.COLUMBUS_VIEW&&r!==v.SCENE3D||(t.screenSpaceCameraController.enableTilt=!0),this._entityView=void 0,this.camera.lookAtTransform(f.IDENTITY)),this._trackedEntityChanged.raiseEvent(e),this.scene.requestRender()}}},selectedEntity:{get:function(){return this._selectedEntity},set:function(e){if(this._selectedEntity!==e){this._selectedEntity=e;var t=Q(this._selectionIndicator)?this._selectionIndicator.viewModel:void 0;Q(e)?Q(t)&&t.animateAppear():Q(t)&&t.animateDepart(),this._selectedEntityChanged.raiseEvent(e)}}},selectedEntityChanged:{get:function(){return this._selectedEntityChanged}},trackedEntityChanged:{get:function(){return this._trackedEntityChanged}},clockTrackedDataSource:{get:function(){return this._clockTrackedDataSource},set:function(e){this._clockTrackedDataSource!==e&&(this._clockTrackedDataSource=e,r(this._timeline,this.clock,e))}}}),Ae.prototype.extend=function(e,t){if(!Q(e))throw new Z("mixin is required.");e(this,t)},Ae.prototype.resize=function(){var e=this._cesiumWidget,t=this._container,r=t.clientWidth,i=t.clientHeight,n=Q(this._animation),o=Q(this._timeline);if(this._forceResize||r!==this._lastWidth||i!==this._lastHeight){e.resize(),this._forceResize=!1;var a=i-125,s=this._baseLayerPickerDropDown;if(Q(s)&&(s.style.maxHeight=a+"px"),Q(this._geocoder))this._geocoder.searchSuggestionsContainer.style.maxHeight=a+"px";Q(this._infoBox)&&(this._infoBox.viewModel.maxHeight=a);var l,u=this._timeline,c=0,d=0,h=0;if(n&&"hidden"!==window.getComputedStyle(this._animation.container).visibility){var p=this._lastWidth;l=this._animation.container,900<r?(c=169,p<=900&&(l.style.width="169px",l.style.height="112px",this._animation.resize())):600<=r?(c=136,(p<600||900<p)&&(l.style.width="136px",l.style.height="90px",this._animation.resize())):(c=106,(600<p||0===p)&&(l.style.width="106px",l.style.height="70px",this._animation.resize())),d=c+5}if(o&&"hidden"!==window.getComputedStyle(this._timeline.container).visibility){var f=this._fullscreenButton,m=this._vrButton,g=u.container,_=g.style;h=g.clientHeight+3,_.left=c+"px";var v=0;Q(f)&&(v+=f.container.clientWidth),Q(m)&&(v+=m.container.clientWidth),_.right=v+"px",u.resize()}this._bottomContainer.style.left=d+"px",this._bottomContainer.style.bottom=h+"px",this._lastWidth=r,this._lastHeight=i}},Ae.prototype.forceResize=function(){this._lastWidth=0,this.resize()},Ae.prototype.render=function(){this._cesiumWidget.render()},Ae.prototype.isDestroyed=function(){return!1},Ae.prototype.destroy=function(){var e;this.screenSpaceEventHandler.removeInputAction(ee.LEFT_CLICK),this.screenSpaceEventHandler.removeInputAction(ee.LEFT_DOUBLE_CLICK);var t=this.dataSources,r=t.length;for(e=0;e<r;e++)this._dataSourceRemoved(t,t.get(e));return this._dataSourceRemoved(void 0,this._dataSourceDisplay.defaultDataSource),this._container.removeChild(this._element),this._element.removeChild(this._toolbar),this._eventHelper.removeAll(),Q(this._geocoder)&&(this._geocoder=this._geocoder.destroy()),Q(this._homeButton)&&(this._homeButton=this._homeButton.destroy()),Q(this._sceneModePicker)&&(this._sceneModePicker=this._sceneModePicker.destroy()),Q(this._projectionPicker)&&(this._projectionPicker=this._projectionPicker.destroy()),Q(this._baseLayerPicker)&&(this._baseLayerPicker=this._baseLayerPicker.destroy()),Q(this._animation)&&(this._element.removeChild(this._animation.container),this._animation=this._animation.destroy()),Q(this._timeline)&&(this._timeline.removeEventListener("settime",Te,!1),this._element.removeChild(this._timeline.container),this._timeline=this._timeline.destroy()),Q(this._fullscreenButton)&&(this._fullscreenSubscription.dispose(),this._element.removeChild(this._fullscreenButton.container),this._fullscreenButton=this._fullscreenButton.destroy()),Q(this._vrButton)&&(this._vrSubscription.dispose(),this._vrModeSubscription.dispose(),this._element.removeChild(this._vrButton.container),this._vrButton=this._vrButton.destroy()),Q(this._infoBox)&&(this._element.removeChild(this._infoBox.container),this._infoBox=this._infoBox.destroy()),Q(this._selectionIndicator)&&(this._element.removeChild(this._selectionIndicator.container),this._selectionIndicator=this._selectionIndicator.destroy()),this._destroyClockViewModel&&(this._clockViewModel=this._clockViewModel.destroy()),this._dataSourceDisplay=this._dataSourceDisplay.destroy(),this._cesiumWidget=this._cesiumWidget.destroy(),this._destroyDataSourceCollection&&(this._dataSourceCollection=this._dataSourceCollection.destroy()),i(this)},Ae.prototype._dataSourceAdded=function(e,t){t.entities.collectionChanged.addEventListener(Ae.prototype._onEntityCollectionChanged,this)},Ae.prototype._dataSourceRemoved=function(e,t){var r=t.entities;r.collectionChanged.removeEventListener(Ae.prototype._onEntityCollectionChanged,this),Q(this.trackedEntity)&&r.getById(this.trackedEntity.id)===this.trackedEntity&&(this.trackedEntity=void 0),Q(this.selectedEntity)&&r.getById(this.selectedEntity.id)===this.selectedEntity&&(this.selectedEntity=void 0)},Ae.prototype._onTick=function(e){var t=e.currentTime,r=this._dataSourceDisplay.update(t);this._allowDataSourcesToSuspendAnimation&&(this._clockViewModel.canAnimate=r);var i,n=this._entityView;if(Q(n)){var o=this._trackedEntity;this._dataSourceDisplay.getBoundingSphere(o,!1,y)===g.DONE&&n.update(t,y)}var a=!1,s=this.selectedEntity,l=Q(s)&&this._enableInfoOrSelection;l&&s.isShowing&&s.isAvailable(t)&&(this._dataSourceDisplay.getBoundingSphere(s,!0,y)!==g.FAILED?i=y.center:Q(s.position)&&(i=s.position.getValue(t,i)),a=Q(i));var u=Q(this._selectionIndicator)?this._selectionIndicator.viewModel:void 0;Q(u)&&(u.position=d.clone(i,u.position),u.showSelection=l&&a,u.update());var c=Q(this._infoBox)?this._infoBox.viewModel:void 0;Q(c)&&(c.showInfo=l,c.enableCamera=a,c.isCameraTracking=this.trackedEntity===this.selectedEntity,c.description=l?(c.titleText=X(s.name,s.id),ie.getValueOrDefault(s.description,t,"")):c.titleText="")},Ae.prototype._onEntityCollectionChanged=function(e,t,r){for(var i=r.length,n=0;n<i;n++){var o=r[n];this.trackedEntity===o&&(this.trackedEntity=void 0),this.selectedEntity===o&&(this.selectedEntity=void 0)}},Ae.prototype._onInfoBoxCameraClicked=function(e){if(e.isCameraTracking&&this.trackedEntity===this.selectedEntity)this.trackedEntity=void 0;else{var t=this.selectedEntity.position;Q(t)?this.trackedEntity=this.selectedEntity:this.zoomTo(this.selectedEntity)}},Ae.prototype._clearTrackedObject=function(){this.trackedEntity=void 0},Ae.prototype._onInfoBoxClockClicked=function(e){this.selectedEntity=void 0},Ae.prototype._clearObjects=function(){this.trackedEntity=void 0,this.selectedEntity=void 0},Ae.prototype._onDataSourceChanged=function(e){this.clockTrackedDataSource===e&&r(this.timeline,this.clock,e)},Ae.prototype._onDataSourceAdded=function(e,t){this._automaticallyTrackDataSourceClocks&&(this.clockTrackedDataSource=t);var r=t.entities.id,i=this._eventHelper.add(t.changedEvent,Ae.prototype._onDataSourceChanged,this);this._dataSourceChangedListeners[r]=i},Ae.prototype._onDataSourceRemoved=function(e,t){var r=this.clockTrackedDataSource===t,i=t.entities.id;if(this._dataSourceChangedListeners[i](),this._dataSourceChangedListeners[i]=void 0,r){var n=e.length;this._automaticallyTrackDataSourceClocks&&0<n?this.clockTrackedDataSource=e.get(n-1):this.clockTrackedDataSource=void 0}},Ae.prototype.zoomTo=function(e,t){return n(this,e,{offset:t},!1)},Ae.prototype.flyTo=function(e,t){return n(this,e,t,!0)},Ae.prototype._postRender=function(){!function(t){var r=t._zoomTarget;if(!Q(r)||t.scene.mode===v.MORPHING)return;var i,n=t.scene.camera,o=t._zoomPromise,a=X(t._zoomOptions,{});if(r instanceof _)return r.readyPromise.then(function(){var e=r.boundingSphere;Q(a.offset)||(a.offset=new p(0,-.5,e.radius)),i={offset:a.offset,duration:a.duration,maximumHeight:a.maximumHeight,complete:function(){o.resolve(!0)},cancel:function(){o.resolve(!1)}},t._zoomIsFlight?n.flyToBoundingSphere(r.boundingSphere,i):(n.viewBoundingSphere(e,a.offset),n.lookAtTransform(f.IDENTITY),o.resolve(!0)),C(t)});if(r instanceof m)return i={destination:r,duration:a.duration,maximumHeight:a.maximumHeight,complete:function(){o.resolve(!0)},cancel:function(){o.resolve(!1)}},t._zoomIsFlight?n.flyTo(i):(n.setView(i),o.resolve(!0)),C(t);for(var e=r,s=[],l=0,u=e.length;l<u;l++){var c=t._dataSourceDisplay.getBoundingSphere(e[l],!1,y);if(c===g.PENDING)return;c!==g.FAILED&&s.push(h.clone(y))}if(0===s.length)return w(t);t.trackedEntity=void 0;var d=h.fromBoundingSpheres(s);t._zoomIsFlight?(C(t),n.flyToBoundingSphere(d,{duration:a.duration,maximumHeight:a.maximumHeight,complete:function(){o.resolve(!0)},cancel:function(){o.resolve(!1)},offset:a.offset})):(n.viewBoundingSphere(d,t._zoomOptions.offset),n.lookAtTransform(f.IDENTITY),C(t),o.resolve(!0))}(this),function(e){if(!e._needTrackedEntityUpdate)return;var t=e._trackedEntity,r=e.clock.currentTime,i=ie.getValueOrUndefined(t.position,r);if(!Q(i))return;var n=e.scene,o=e._dataSourceDisplay.getBoundingSphere(t,!1,y);if(o===g.PENDING)return;var a=n.mode;a!==v.COLUMBUS_VIEW&&a!==v.SCENE2D||(n.screenSpaceCameraController.enableTranslate=!1);a!==v.COLUMBUS_VIEW&&a!==v.SCENE3D||(n.screenSpaceCameraController.enableTilt=!1);var s=o!==g.FAILED?y:void 0;e._entityView=new l(t,n,n.mapProjection.ellipsoid),e._entityView.update(r,s),e._needTrackedEntityUpdate=!1}(this)},Ae}),define("Widgets/Viewer/viewerCesium3DTilesInspectorMixin",["../../Core/Check","../../Core/defineProperties","../Cesium3DTilesInspector/Cesium3DTilesInspector"],function(i,n,o){"use strict";return function(e){i.typeOf.object("viewer",e);var t=document.createElement("div");t.className="cesium-viewer-cesium3DTilesInspectorContainer",e.container.appendChild(t);var r=new o(t,e.scene);n(e,{cesium3DTilesInspector:{get:function(){return r}}})}}),define("Widgets/Viewer/viewerCesiumInspectorMixin",["../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../CesiumInspector/CesiumInspector"],function(i,n,o,a){"use strict";return function(e){if(!i(e))throw new o("viewer is required.");var t=document.createElement("div");t.className="cesium-viewer-cesiumInspectorContainer",e.container.appendChild(t);var r=new a(t,e.scene);n(e,{cesiumInspector:{get:function(){return r}}})}}),define("Widgets/Viewer/viewerDragDropMixin",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/Event","../../Core/wrapFunction","../../DataSources/CzmlDataSource","../../DataSources/GeoJsonDataSource","../../DataSources/KmlDataSource","../getElement"],function(c,d,h,p,f,m,l,u,g,_){"use strict";function v(e){e.stopPropagation(),e.preventDefault()}function y(e,t){var r=e;d(r)&&(r.removeEventListener("drop",t,!1),r.removeEventListener("dragenter",v,!1),r.removeEventListener("dragover",v,!1),r.removeEventListener("dragexit",v,!1))}function b(e,t){e.addEventListener("drop",t,!1),e.addEventListener("dragenter",v,!1),e.addEventListener("dragover",v,!1),e.addEventListener("dragexit",v,!1)}function C(i,n,o,a){var s=i.scene;return function(e){var t=n.name;try{var r;if(/\.czml$/i.test(t))r=l.load(JSON.parse(e.target.result),{sourceUri:t});else if(/\.geojson$/i.test(t)||/\.json$/i.test(t)||/\.topojson$/i.test(t))r=u.load(JSON.parse(e.target.result),{sourceUri:t,clampToGround:a});else{if(!/\.(kml|kmz)$/i.test(t))return void i.dropError.raiseEvent(i,t,"Unrecognized file: "+t);r=g.load(n,{sourceUri:t,proxy:o,camera:s.camera,canvas:s.canvas})}d(r)&&i.dataSources.add(r).then(function(e){i.flyToOnDrop&&i.flyTo(e)}).otherwise(function(e){i.dropError.raiseEvent(i,t,e)})}catch(e){i.dropError.raiseEvent(i,t,e)}}}function w(t,r){return function(e){t.dropError.raiseEvent(t,r.name,e.target.error)}}return function(a,e){if(!d(a))throw new p("viewer is required.");if(a.hasOwnProperty("dropTarget"))throw new p("dropTarget is already defined by another mixin.");if(a.hasOwnProperty("dropEnabled"))throw new p("dropEnabled is already defined by another mixin.");if(a.hasOwnProperty("dropError"))throw new p("dropError is already defined by another mixin.");if(a.hasOwnProperty("clearOnDrop"))throw new p("clearOnDrop is already defined by another mixin.");if(a.hasOwnProperty("flyToOnDrop"))throw new p("flyToOnDrop is already defined by another mixin.");e=c(e,c.EMPTY_OBJECT);var t=!0,r=c(e.flyToOnDrop,!0),i=new f,s=c(e.clearOnDrop,!0),n=c(e.dropTarget,a.container),l=c(e.clampToGround,!0),u=e.proxy;function o(e){v(e),s&&(a.entities.removeAll(),a.dataSources.removeAll());for(var t=e.dataTransfer.files,r=t.length,i=0;i<r;i++){var n=t[i],o=new FileReader;o.onload=C(a,n,u,l),o.onerror=w(a,n),o.readAsText(n)}}n=_(n),h(a,{dropTarget:{get:function(){return n},set:function(e){if(!d(e))throw new p("value is required.");y(n,o),b(n=e,o)}},dropEnabled:{get:function(){return t},set:function(e){e!==t&&(e?b(n,o):y(n,o),t=e)}},dropError:{get:function(){return i}},clearOnDrop:{get:function(){return s},set:function(e){s=e}},flyToOnDrop:{get:function(){return r},set:function(e){r=e}},proxy:{get:function(){return u},set:function(e){u=e}},clampToGround:{get:function(){return l},set:function(e){l=e}}}),b(n,o),a.destroy=m(a,a.destroy,function(){a.dropEnabled=!1}),a._handleDrop=o}}),define("Widgets/Viewer/viewerPerformanceWatchdogMixin",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../PerformanceWatchdog/PerformanceWatchdog"],function(i,n,o,a,s){"use strict";return function(e,t){if(!n(e))throw new a("viewer is required.");t=i(t,i.EMPTY_OBJECT);var r=new s({scene:e.scene,container:e.bottomContainer,lowFrameRateMessage:t.lowFrameRateMessage});o(e,{performanceWatchdog:{get:function(){return r}}})}}),define("Workers/createTaskProcessorWorker",["../Core/defaultValue","../Core/defined","../Core/formatError"],function(a,s,l){"use strict";return function(r){var i,n=[],o={id:void 0,result:void 0,error:void 0};return function(e){var t=e.data;n.length=0,o.id=t.id,o.error=void 0,o.result=void 0;try{o.result=r(t.parameters,n)}catch(e){e instanceof Error?o.error={name:e.name,message:e.message,stack:e.stack}:o.error=e}s(i)||(i=a(self.webkitPostMessage,self.postMessage)),t.canTransferArrayBuffer||(n.length=0);try{i(o,n)}catch(e){o.result=void 0,o.error="postMessage failed with error: "+l(e)+"\n  with responseMessage: "+JSON.stringify(o),i(o)}}}}),define("Cesium",["./Core/appendForwardSlash","./Core/arrayFill","./Core/arrayRemoveDuplicates","./Core/arraySlice","./Core/AssociativeArray","./Core/AttributeCompression","./Core/AxisAlignedBoundingBox","./Core/barycentricCoordinates","./Core/binarySearch","./Core/BingMapsApi","./Core/BingMapsGeocoderService","./Core/BoundingRectangle","./Core/BoundingSphere","./Core/BoxGeometry","./Core/BoxOutlineGeometry","./Core/buildModuleUrl","./Core/cancelAnimationFrame","./Core/Cartesian2","./Core/Cartesian3","./Core/Cartesian4","./Core/Cartographic","./Core/CartographicGeocoderService","./Core/CatmullRomSpline","./Core/CesiumTerrainProvider","./Core/Check","./Core/CircleGeometry","./Core/CircleOutlineGeometry","./Core/ClippingPlaneCollection","./Core/Clock","./Core/ClockRange","./Core/ClockStep","./Core/clone","./Core/Color","./Core/ColorGeometryInstanceAttribute","./Core/combine","./Core/ComponentDatatype","./Core/CompressedTextureBuffer","./Core/CornerType","./Core/CorridorGeometry","./Core/CorridorGeometryLibrary","./Core/CorridorOutlineGeometry","./Core/createGuid","./Core/Credit","./Core/CubicRealPolynomial","./Core/CullingVolume","./Core/CylinderGeometry","./Core/CylinderGeometryLibrary","./Core/CylinderOutlineGeometry","./Core/decodeGoogleEarthEnterpriseData","./Core/DefaultProxy","./Core/defaultValue","./Core/defined","./Core/defineProperties","./Core/deprecationWarning","./Core/destroyObject","./Core/DeveloperError","./Core/DistanceDisplayCondition","./Core/DistanceDisplayConditionGeometryInstanceAttribute","./Core/DoublyLinkedList","./Core/EarthOrientationParameters","./Core/EarthOrientationParametersSample","./Core/EasingFunction","./Core/EllipseGeometry","./Core/EllipseGeometryLibrary","./Core/EllipseOutlineGeometry","./Core/Ellipsoid","./Core/EllipsoidalOccluder","./Core/EllipsoidGeodesic","./Core/EllipsoidGeometry","./Core/EllipsoidOutlineGeometry","./Core/EllipsoidTangentPlane","./Core/EllipsoidTerrainProvider","./Core/EncodedCartesian3","./Core/Event","./Core/EventHelper","./Core/ExtrapolationType","./Core/FeatureDetection","./Core/formatError","./Core/freezeObject","./Core/FrustumGeometry","./Core/FrustumOutlineGeometry","./Core/Fullscreen","./Core/GeocoderService","./Core/GeographicProjection","./Core/GeographicTilingScheme","./Core/Geometry","./Core/GeometryAttribute","./Core/GeometryAttributes","./Core/GeometryInstance","./Core/GeometryInstanceAttribute","./Core/GeometryPipeline","./Core/GeometryType","./Core/getAbsoluteUri","./Core/getBaseUri","./Core/getExtensionFromUri","./Core/getFilenameFromUri","./Core/getImagePixels","./Core/getMagic","./Core/getStringFromTypedArray","./Core/getTimestamp","./Core/GoogleEarthEnterpriseMetadata","./Core/GoogleEarthEnterpriseTerrainData","./Core/GoogleEarthEnterpriseTerrainProvider","./Core/GoogleEarthEnterpriseTileInformation","./Core/GregorianDate","./Core/HeadingPitchRange","./Core/HeadingPitchRoll","./Core/Heap","./Core/HeightmapTerrainData","./Core/HeightmapTessellator","./Core/HermitePolynomialApproximation","./Core/HermiteSpline","./Core/Iau2000Orientation","./Core/Iau2006XysData","./Core/Iau2006XysSample","./Core/IauOrientationAxes","./Core/IauOrientationParameters","./Core/IndexDatatype","./Core/InterpolationAlgorithm","./Core/Intersect","./Core/Intersections2D","./Core/IntersectionTests","./Core/Interval","./Core/isArray","./Core/isBitSet","./Core/isBlobUri","./Core/isCrossOriginUrl","./Core/isDataUri","./Core/isLeapYear","./Core/Iso8601","./Core/JulianDate","./Core/KeyboardEventModifier","./Core/LagrangePolynomialApproximation","./Core/LeapSecond","./Core/LinearApproximation","./Core/LinearSpline","./Core/loadArrayBuffer","./Core/loadBlob","./Core/loadCRN","./Core/loadImage","./Core/loadImageFromTypedArray","./Core/loadImageViaBlob","./Core/loadJson","./Core/loadJsonp","./Core/loadKTX","./Core/loadText","./Core/loadWithXhr","./Core/loadXML","./Core/ManagedArray","./Core/MapboxApi","./Core/MapProjection","./Core/Math","./Core/Matrix2","./Core/Matrix3","./Core/Matrix4","./Core/mergeSort","./Core/NearFarScalar","./Core/objectToQuery","./Core/Occluder","./Core/oneTimeWarning","./Core/OrientedBoundingBox","./Core/OrthographicFrustum","./Core/OrthographicOffCenterFrustum","./Core/Packable","./Core/PackableForInterpolation","./Core/parseResponseHeaders","./Core/PerspectiveFrustum","./Core/PerspectiveOffCenterFrustum","./Core/PinBuilder","./Core/PixelFormat","./Core/Plane","./Core/PlaneGeometry","./Core/PlaneOutlineGeometry","./Core/pointInsideTriangle","./Core/PolygonGeometry","./Core/PolygonGeometryLibrary","./Core/PolygonHierarchy","./Core/PolygonOutlineGeometry","./Core/PolygonPipeline","./Core/PolylineGeometry","./Core/PolylinePipeline","./Core/PolylineVolumeGeometry","./Core/PolylineVolumeGeometryLibrary","./Core/PolylineVolumeOutlineGeometry","./Core/PrimitiveType","./Core/QuadraticRealPolynomial","./Core/QuantizedMeshTerrainData","./Core/QuarticRealPolynomial","./Core/Quaternion","./Core/QuaternionSpline","./Core/queryToObject","./Core/Queue","./Core/Ray","./Core/Rectangle","./Core/RectangleGeometry","./Core/RectangleGeometryLibrary","./Core/RectangleOutlineGeometry","./Core/ReferenceFrame","./Core/Request","./Core/requestAnimationFrame","./Core/RequestErrorEvent","./Core/RequestScheduler","./Core/RequestState","./Core/RequestType","./Core/Resource","./Core/RuntimeError","./Core/sampleTerrain","./Core/sampleTerrainMostDetailed","./Core/scaleToGeodeticSurface","./Core/ScreenSpaceEventHandler","./Core/ScreenSpaceEventType","./Core/ShowGeometryInstanceAttribute","./Core/Simon1994PlanetaryPositions","./Core/SimplePolylineGeometry","./Core/SphereGeometry","./Core/SphereOutlineGeometry","./Core/Spherical","./Core/Spline","./Core/subdivideArray","./Core/TaskProcessor","./Core/TerrainData","./Core/TerrainEncoding","./Core/TerrainMesh","./Core/TerrainProvider","./Core/TerrainQuantization","./Core/TileAvailability","./Core/TileProviderError","./Core/TilingScheme","./Core/TimeConstants","./Core/TimeInterval","./Core/TimeIntervalCollection","./Core/TimeStandard","./Core/Tipsify","./Core/Transforms","./Core/TranslationRotationScale","./Core/TridiagonalSystemSolver","./Core/TrustedServers","./Core/VertexFormat","./Core/VideoSynchronizer","./Core/Visibility","./Core/VRTheWorldTerrainProvider","./Core/WallGeometry","./Core/WallGeometryLibrary","./Core/WallOutlineGeometry","./Core/WebGLConstants","./Core/WebMercatorProjection","./Core/WebMercatorTilingScheme","./Core/WeightSpline","./Core/WindingOrder","./Core/wrapFunction","./Core/writeTextToCanvas","./DataSources/BillboardGraphics","./DataSources/BillboardVisualizer","./DataSources/BoundingSphereState","./DataSources/BoxGeometryUpdater","./DataSources/BoxGraphics","./DataSources/CallbackProperty","./DataSources/CheckerboardMaterialProperty","./DataSources/ColorMaterialProperty","./DataSources/CompositeEntityCollection","./DataSources/CompositeMaterialProperty","./DataSources/CompositePositionProperty","./DataSources/CompositeProperty","./DataSources/ConstantPositionProperty","./DataSources/ConstantProperty","./DataSources/CorridorGeometryUpdater","./DataSources/CorridorGraphics","./DataSources/createMaterialPropertyDescriptor","./DataSources/createPropertyDescriptor","./DataSources/createRawPropertyDescriptor","./DataSources/CustomDataSource","./DataSources/CylinderGeometryUpdater","./DataSources/CylinderGraphics","./DataSources/CzmlDataSource","./DataSources/DataSource","./DataSources/DataSourceClock","./DataSources/DataSourceCollection","./DataSources/DataSourceDisplay","./DataSources/dynamicGeometryGetBoundingSphere","./DataSources/DynamicGeometryUpdater","./DataSources/EllipseGeometryUpdater","./DataSources/EllipseGraphics","./DataSources/EllipsoidGeometryUpdater","./DataSources/EllipsoidGraphics","./DataSources/Entity","./DataSources/EntityCluster","./DataSources/EntityCollection","./DataSources/EntityView","./DataSources/GeoJsonDataSource","./DataSources/GeometryUpdater","./DataSources/GeometryVisualizer","./DataSources/GridMaterialProperty","./DataSources/ImageMaterialProperty","./DataSources/KmlCamera","./DataSources/KmlDataSource","./DataSources/KmlLookAt","./DataSources/KmlTour","./DataSources/KmlTourFlyTo","./DataSources/KmlTourWait","./DataSources/LabelGraphics","./DataSources/LabelVisualizer","./DataSources/MaterialProperty","./DataSources/ModelGraphics","./DataSources/ModelVisualizer","./DataSources/NodeTransformationProperty","./DataSources/PathGraphics","./DataSources/PathVisualizer","./DataSources/PlaneGeometryUpdater","./DataSources/PlaneGraphics","./DataSources/PointGraphics","./DataSources/PointVisualizer","./DataSources/PolygonGeometryUpdater","./DataSources/PolygonGraphics","./DataSources/PolylineArrowMaterialProperty","./DataSources/PolylineDashMaterialProperty","./DataSources/PolylineGeometryUpdater","./DataSources/PolylineGlowMaterialProperty","./DataSources/PolylineGraphics","./DataSources/PolylineOutlineMaterialProperty","./DataSources/PolylineVolumeGeometryUpdater","./DataSources/PolylineVolumeGraphics","./DataSources/PositionProperty","./DataSources/PositionPropertyArray","./DataSources/Property","./DataSources/PropertyArray","./DataSources/PropertyBag","./DataSources/RectangleGeometryUpdater","./DataSources/RectangleGraphics","./DataSources/ReferenceProperty","./DataSources/Rotation","./DataSources/SampledPositionProperty","./DataSources/SampledProperty","./DataSources/ScaledPositionProperty","./DataSources/StaticGeometryColorBatch","./DataSources/StaticGeometryPerMaterialBatch","./DataSources/StaticGroundGeometryColorBatch","./DataSources/StaticOutlineGeometryBatch","./DataSources/StripeMaterialProperty","./DataSources/StripeOrientation","./DataSources/TimeIntervalCollectionPositionProperty","./DataSources/TimeIntervalCollectionProperty","./DataSources/VelocityOrientationProperty","./DataSources/VelocityVectorProperty","./DataSources/Visualizer","./DataSources/WallGeometryUpdater","./DataSources/WallGraphics","./Renderer/AutomaticUniforms","./Renderer/Buffer","./Renderer/BufferUsage","./Renderer/ClearCommand","./Renderer/ComputeCommand","./Renderer/ComputeEngine","./Renderer/Context","./Renderer/ContextLimits","./Renderer/createUniform","./Renderer/createUniformArray","./Renderer/CubeMap","./Renderer/CubeMapFace","./Renderer/DrawCommand","./Renderer/Framebuffer","./Renderer/freezeRenderState","./Renderer/loadCubeMap","./Renderer/MipmapHint","./Renderer/modernizeShader","./Renderer/Pass","./Renderer/PassState","./Renderer/PickFramebuffer","./Renderer/PixelDatatype","./Renderer/Renderbuffer","./Renderer/RenderbufferFormat","./Renderer/RenderState","./Renderer/Sampler","./Renderer/ShaderCache","./Renderer/ShaderProgram","./Renderer/ShaderSource","./Renderer/Texture","./Renderer/TextureMagnificationFilter","./Renderer/TextureMinificationFilter","./Renderer/TextureWrap","./Renderer/UniformState","./Renderer/VertexArray","./Renderer/VertexArrayFacade","./Scene/Appearance","./Scene/ArcGisMapServerImageryProvider","./Scene/AttributeType","./Scene/Axis","./Scene/Batched3DModel3DTileContent","./Scene/BatchTable","./Scene/Billboard","./Scene/BillboardCollection","./Scene/BingMapsImageryProvider","./Scene/BingMapsStyle","./Scene/BlendEquation","./Scene/BlendFunction","./Scene/BlendingState","./Scene/BlendOption","./Scene/BoxEmitter","./Scene/BrdfLutGenerator","./Scene/Camera","./Scene/CameraEventAggregator","./Scene/CameraEventType","./Scene/CameraFlightPath","./Scene/Cesium3DTile","./Scene/Cesium3DTileBatchTable","./Scene/Cesium3DTileChildrenVisibility","./Scene/Cesium3DTileColorBlendMode","./Scene/Cesium3DTileContent","./Scene/Cesium3DTileContentFactory","./Scene/Cesium3DTileContentState","./Scene/Cesium3DTileFeature","./Scene/Cesium3DTileFeatureTable","./Scene/Cesium3DTileOptimizationHint","./Scene/Cesium3DTileOptimizations","./Scene/Cesium3DTilePointFeature","./Scene/Cesium3DTileRefine","./Scene/Cesium3DTileset","./Scene/Cesium3DTilesetStatistics","./Scene/Cesium3DTilesetTraversal","./Scene/Cesium3DTileStyle","./Scene/Cesium3DTileStyleEngine","./Scene/CesiumIon","./Scene/CesiumIonResource","./Scene/CircleEmitter","./Scene/ClassificationModel","./Scene/ClassificationPrimitive","./Scene/ClassificationType","./Scene/ColorBlendMode","./Scene/Composite3DTileContent","./Scene/ConditionsExpression","./Scene/ConeEmitter","./Scene/createBillboardPointCallback","./Scene/createOpenStreetMapImageryProvider","./Scene/createTangentSpaceDebugPrimitive","./Scene/createTileMapServiceImageryProvider","./Scene/CreditDisplay","./Scene/CullFace","./Scene/DebugAppearance","./Scene/DebugCameraPrimitive","./Scene/DebugModelMatrixPrimitive","./Scene/DepthFunction","./Scene/DepthPlane","./Scene/DeviceOrientationCameraController","./Scene/DiscardMissingTileImagePolicy","./Scene/EllipsoidPrimitive","./Scene/EllipsoidSurfaceAppearance","./Scene/Empty3DTileContent","./Scene/Expression","./Scene/ExpressionNodeType","./Scene/Fog","./Scene/FrameRateMonitor","./Scene/FrameState","./Scene/FrustumCommands","./Scene/FXAA","./Scene/Geometry3DTileContent","./Scene/getBinaryAccessor","./Scene/GetFeatureInfoFormat","./Scene/Globe","./Scene/GlobeDepth","./Scene/GlobeSurfaceShaderSet","./Scene/GlobeSurfaceTile","./Scene/GlobeSurfaceTileProvider","./Scene/GoogleEarthEnterpriseImageryProvider","./Scene/GoogleEarthEnterpriseMapsProvider","./Scene/GridImageryProvider","./Scene/GroundPrimitive","./Scene/HeightReference","./Scene/HorizontalOrigin","./Scene/Imagery","./Scene/ImageryLayer","./Scene/ImageryLayerCollection","./Scene/ImageryLayerFeatureInfo","./Scene/ImageryProvider","./Scene/ImagerySplitDirection","./Scene/ImageryState","./Scene/Instanced3DModel3DTileContent","./Scene/InvertClassification","./Scene/JobScheduler","./Scene/JobType","./Scene/Label","./Scene/LabelCollection","./Scene/LabelStyle","./Scene/MapboxImageryProvider","./Scene/MapMode2D","./Scene/Material","./Scene/MaterialAppearance","./Scene/Model","./Scene/ModelAnimation","./Scene/ModelAnimationCache","./Scene/ModelAnimationCollection","./Scene/ModelAnimationLoop","./Scene/ModelAnimationState","./Scene/ModelInstance","./Scene/ModelInstanceCollection","./Scene/ModelLoadResources","./Scene/ModelMaterial","./Scene/ModelMesh","./Scene/ModelNode","./Scene/ModelUtility","./Scene/Moon","./Scene/NeverTileDiscardPolicy","./Scene/OIT","./Scene/Particle","./Scene/ParticleBurst","./Scene/ParticleEmitter","./Scene/ParticleSystem","./Scene/PerformanceDisplay","./Scene/PerInstanceColorAppearance","./Scene/PickDepth","./Scene/PointCloud3DTileContent","./Scene/PointCloudEyeDomeLighting","./Scene/PointCloudShading","./Scene/PointPrimitive","./Scene/PointPrimitiveCollection","./Scene/Polyline","./Scene/PolylineCollection","./Scene/PolylineColorAppearance","./Scene/PolylineMaterialAppearance","./Scene/Primitive","./Scene/PrimitiveCollection","./Scene/PrimitivePipeline","./Scene/PrimitiveState","./Scene/QuadtreeOccluders","./Scene/QuadtreePrimitive","./Scene/QuadtreeTile","./Scene/QuadtreeTileLoadState","./Scene/QuadtreeTileProvider","./Scene/Scene","./Scene/SceneMode","./Scene/SceneTransforms","./Scene/SceneTransitioner","./Scene/ScreenSpaceCameraController","./Scene/ShadowMap","./Scene/ShadowMapShader","./Scene/ShadowMode","./Scene/SingleTileImageryProvider","./Scene/SkyAtmosphere","./Scene/SkyBox","./Scene/SphereEmitter","./Scene/StencilFunction","./Scene/StencilOperation","./Scene/StyleExpression","./Scene/Sun","./Scene/SunPostProcess","./Scene/TerrainState","./Scene/TextureAtlas","./Scene/TileBoundingRegion","./Scene/TileBoundingSphere","./Scene/TileBoundingVolume","./Scene/TileCoordinatesImageryProvider","./Scene/TileDiscardPolicy","./Scene/TileImagery","./Scene/TileOrientedBoundingBox","./Scene/TileReplacementQueue","./Scene/Tileset3DTileContent","./Scene/TileState","./Scene/TileTerrain","./Scene/TimeDynamicImagery","./Scene/TweenCollection","./Scene/UrlTemplateImageryProvider","./Scene/Vector3DTileBatch","./Scene/Vector3DTileContent","./Scene/Vector3DTileGeometry","./Scene/Vector3DTilePoints","./Scene/Vector3DTilePolygons","./Scene/Vector3DTilePolylines","./Scene/Vector3DTilePrimitive","./Scene/VerticalOrigin","./Scene/ViewportQuad","./Scene/WebMapServiceImageryProvider","./Scene/WebMapTileServiceImageryProvider","./Shaders/AdjustTranslucentFS","./Shaders/Appearances/AllMaterialAppearanceFS","./Shaders/Appearances/AllMaterialAppearanceVS","./Shaders/Appearances/BasicMaterialAppearanceFS","./Shaders/Appearances/BasicMaterialAppearanceVS","./Shaders/Appearances/EllipsoidSurfaceAppearanceFS","./Shaders/Appearances/EllipsoidSurfaceAppearanceVS","./Shaders/Appearances/PerInstanceColorAppearanceFS","./Shaders/Appearances/PerInstanceColorAppearanceVS","./Shaders/Appearances/PerInstanceFlatColorAppearanceFS","./Shaders/Appearances/PerInstanceFlatColorAppearanceVS","./Shaders/Appearances/PolylineColorAppearanceVS","./Shaders/Appearances/PolylineMaterialAppearanceVS","./Shaders/Appearances/TexturedMaterialAppearanceFS","./Shaders/Appearances/TexturedMaterialAppearanceVS","./Shaders/BillboardCollectionFS","./Shaders/BillboardCollectionVS","./Shaders/BrdfLutGeneratorFS","./Shaders/Builtin/Constants/degreesPerRadian","./Shaders/Builtin/Constants/depthRange","./Shaders/Builtin/Constants/epsilon1","./Shaders/Builtin/Constants/epsilon2","./Shaders/Builtin/Constants/epsilon3","./Shaders/Builtin/Constants/epsilon4","./Shaders/Builtin/Constants/epsilon5","./Shaders/Builtin/Constants/epsilon6","./Shaders/Builtin/Constants/epsilon7","./Shaders/Builtin/Constants/infinity","./Shaders/Builtin/Constants/maxClippingPlanes","./Shaders/Builtin/Constants/oneOverPi","./Shaders/Builtin/Constants/oneOverTwoPi","./Shaders/Builtin/Constants/passCesium3DTile","./Shaders/Builtin/Constants/passCesium3DTileClassification","./Shaders/Builtin/Constants/passCesium3DTileClassificationIgnoreShow","./Shaders/Builtin/Constants/passClassification","./Shaders/Builtin/Constants/passCompute","./Shaders/Builtin/Constants/passEnvironment","./Shaders/Builtin/Constants/passGlobe","./Shaders/Builtin/Constants/passOpaque","./Shaders/Builtin/Constants/passOverlay","./Shaders/Builtin/Constants/passTerrainClassification","./Shaders/Builtin/Constants/passTranslucent","./Shaders/Builtin/Constants/pi","./Shaders/Builtin/Constants/piOverFour","./Shaders/Builtin/Constants/piOverSix","./Shaders/Builtin/Constants/piOverThree","./Shaders/Builtin/Constants/piOverTwo","./Shaders/Builtin/Constants/radiansPerDegree","./Shaders/Builtin/Constants/sceneMode2D","./Shaders/Builtin/Constants/sceneMode3D","./Shaders/Builtin/Constants/sceneModeColumbusView","./Shaders/Builtin/Constants/sceneModeMorphing","./Shaders/Builtin/Constants/solarRadius","./Shaders/Builtin/Constants/threePiOver2","./Shaders/Builtin/Constants/twoPi","./Shaders/Builtin/Constants/webMercatorMaxLatitude","./Shaders/Builtin/CzmBuiltins","./Shaders/Builtin/Functions/alphaWeight","./Shaders/Builtin/Functions/antialias","./Shaders/Builtin/Functions/cascadeColor","./Shaders/Builtin/Functions/cascadeDistance","./Shaders/Builtin/Functions/cascadeMatrix","./Shaders/Builtin/Functions/cascadeWeights","./Shaders/Builtin/Functions/columbusViewMorph","./Shaders/Builtin/Functions/computePosition","./Shaders/Builtin/Functions/cosineAndSine","./Shaders/Builtin/Functions/decompressTextureCoordinates","./Shaders/Builtin/Functions/depthClampFarPlane","./Shaders/Builtin/Functions/discardIfClippedWithIntersect","./Shaders/Builtin/Functions/discardIfClippedWithUnion","./Shaders/Builtin/Functions/eastNorthUpToEyeCoordinates","./Shaders/Builtin/Functions/ellipsoidContainsPoint","./Shaders/Builtin/Functions/ellipsoidNew","./Shaders/Builtin/Functions/ellipsoidWgs84TextureCoordinates","./Shaders/Builtin/Functions/equalsEpsilon","./Shaders/Builtin/Functions/eyeOffset","./Shaders/Builtin/Functions/eyeToWindowCoordinates","./Shaders/Builtin/Functions/fog","./Shaders/Builtin/Functions/geodeticSurfaceNormal","./Shaders/Builtin/Functions/getDefaultMaterial","./Shaders/Builtin/Functions/getLambertDiffuse","./Shaders/Builtin/Functions/getSpecular","./Shaders/Builtin/Functions/getWaterNoise","./Shaders/Builtin/Functions/getWgs84EllipsoidEC","./Shaders/Builtin/Functions/HSBToRGB","./Shaders/Builtin/Functions/HSLToRGB","./Shaders/Builtin/Functions/hue","./Shaders/Builtin/Functions/isEmpty","./Shaders/Builtin/Functions/isFull","./Shaders/Builtin/Functions/latitudeToWebMercatorFraction","./Shaders/Builtin/Functions/luminance","./Shaders/Builtin/Functions/metersPerPixel","./Shaders/Builtin/Functions/modelToWindowCoordinates","./Shaders/Builtin/Functions/multiplyWithColorBalance","./Shaders/Builtin/Functions/nearFarScalar","./Shaders/Builtin/Functions/octDecode","./Shaders/Builtin/Functions/packDepth","./Shaders/Builtin/Functions/phong","./Shaders/Builtin/Functions/pointAlongRay","./Shaders/Builtin/Functions/rayEllipsoidIntersectionInterval","./Shaders/Builtin/Functions/RGBToHSB","./Shaders/Builtin/Functions/RGBToHSL","./Shaders/Builtin/Functions/RGBToXYZ","./Shaders/Builtin/Functions/saturation","./Shaders/Builtin/Functions/shadowDepthCompare","./Shaders/Builtin/Functions/shadowVisibility","./Shaders/Builtin/Functions/signNotZero","./Shaders/Builtin/Functions/tangentToEyeSpaceMatrix","./Shaders/Builtin/Functions/translateRelativeToEye","./Shaders/Builtin/Functions/translucentPhong","./Shaders/Builtin/Functions/transpose","./Shaders/Builtin/Functions/unpackDepth","./Shaders/Builtin/Functions/windowToEyeCoordinates","./Shaders/Builtin/Functions/writeDepthClampedToFarPlane","./Shaders/Builtin/Functions/XYZToRGB","./Shaders/Builtin/Structs/depthRangeStruct","./Shaders/Builtin/Structs/ellipsoid","./Shaders/Builtin/Structs/material","./Shaders/Builtin/Structs/materialInput","./Shaders/Builtin/Structs/ray","./Shaders/Builtin/Structs/raySegment","./Shaders/Builtin/Structs/shadowParameters","./Shaders/CompositeOITFS","./Shaders/DepthPlaneFS","./Shaders/DepthPlaneVS","./Shaders/EllipsoidFS","./Shaders/EllipsoidVS","./Shaders/GlobeFS","./Shaders/GlobeVS","./Shaders/GroundAtmosphere","./Shaders/Materials/BumpMapMaterial","./Shaders/Materials/CheckerboardMaterial","./Shaders/Materials/DotMaterial","./Shaders/Materials/ElevationContourMaterial","./Shaders/Materials/ElevationRampMaterial","./Shaders/Materials/FadeMaterial","./Shaders/Materials/GridMaterial","./Shaders/Materials/NormalMapMaterial","./Shaders/Materials/PolylineArrowMaterial","./Shaders/Materials/PolylineDashMaterial","./Shaders/Materials/PolylineGlowMaterial","./Shaders/Materials/PolylineOutlineMaterial","./Shaders/Materials/RimLightingMaterial","./Shaders/Materials/SlopeRampMaterial","./Shaders/Materials/StripeMaterial","./Shaders/Materials/Water","./Shaders/PointPrimitiveCollectionFS","./Shaders/PointPrimitiveCollectionVS","./Shaders/PolylineCommon","./Shaders/PolylineFS","./Shaders/PolylineVS","./Shaders/PostProcessFilters/AdditiveBlend","./Shaders/PostProcessFilters/BrightPass","./Shaders/PostProcessFilters/FXAA","./Shaders/PostProcessFilters/GaussianBlur1D","./Shaders/PostProcessFilters/PassThrough","./Shaders/PostProcessFilters/PointCloudEyeDomeLighting","./Shaders/ReprojectWebMercatorFS","./Shaders/ReprojectWebMercatorVS","./Shaders/ShadowVolumeFS","./Shaders/ShadowVolumeVS","./Shaders/SkyAtmosphereFS","./Shaders/SkyAtmosphereVS","./Shaders/SkyBoxFS","./Shaders/SkyBoxVS","./Shaders/SunFS","./Shaders/SunTextureFS","./Shaders/SunVS","./Shaders/Vector3DTilePolylinesVS","./Shaders/ViewportQuadFS","./Shaders/ViewportQuadVS","./ThirdParty/Autolinker","./ThirdParty/crunch","./ThirdParty/earcut-2.1.1","./ThirdParty/GltfPipeline/addDefaults","./ThirdParty/GltfPipeline/addExtensionsRequired","./ThirdParty/GltfPipeline/addExtensionsUsed","./ThirdParty/GltfPipeline/addPipelineExtras","./ThirdParty/GltfPipeline/addToArray","./ThirdParty/GltfPipeline/byteLengthForComponentType","./ThirdParty/GltfPipeline/findAccessorMinMax","./ThirdParty/GltfPipeline/ForEach","./ThirdParty/GltfPipeline/getAccessorByteStride","./ThirdParty/GltfPipeline/getJointCountForMaterials","./ThirdParty/GltfPipeline/glslTypeToWebGLConstant","./ThirdParty/GltfPipeline/numberOfComponentsForType","./ThirdParty/GltfPipeline/parseBinaryGltf","./ThirdParty/GltfPipeline/processModelMaterialsCommon","./ThirdParty/GltfPipeline/processPbrMetallicRoughness","./ThirdParty/GltfPipeline/removeExtensionsRequired","./ThirdParty/GltfPipeline/removeExtensionsUsed","./ThirdParty/GltfPipeline/removePipelineExtras","./ThirdParty/GltfPipeline/techniqueParameterForSemantic","./ThirdParty/GltfPipeline/updateVersion","./ThirdParty/GltfPipeline/webGLConstantToGlslType","./ThirdParty/google-earth-dbroot-parser","./ThirdParty/jsep","./ThirdParty/kdbush","./ThirdParty/knockout-3.4.2","./ThirdParty/knockout-es5","./ThirdParty/knockout","./ThirdParty/measureText","./ThirdParty/mersenne-twister","./ThirdParty/NoSleep","./ThirdParty/pako_inflate","./ThirdParty/protobuf-minimal","./ThirdParty/Shaders/FXAA3_11","./ThirdParty/sprintf","./ThirdParty/topojson","./ThirdParty/Tween","./ThirdParty/Uri","./ThirdParty/when","./ThirdParty/zip","./Widgets/Animation/Animation","./Widgets/Animation/AnimationViewModel","./Widgets/BaseLayerPicker/BaseLayerPicker","./Widgets/BaseLayerPicker/BaseLayerPickerViewModel","./Widgets/BaseLayerPicker/createDefaultImageryProviderViewModels","./Widgets/BaseLayerPicker/createDefaultTerrainProviderViewModels","./Widgets/BaseLayerPicker/ProviderViewModel","./Widgets/Cesium3DTilesInspector/Cesium3DTilesInspector","./Widgets/Cesium3DTilesInspector/Cesium3DTilesInspectorViewModel","./Widgets/CesiumInspector/CesiumInspector","./Widgets/CesiumInspector/CesiumInspectorViewModel","./Widgets/CesiumWidget/CesiumWidget","./Widgets/ClockViewModel","./Widgets/Command","./Widgets/createCommand","./Widgets/FullscreenButton/FullscreenButton","./Widgets/FullscreenButton/FullscreenButtonViewModel","./Widgets/Geocoder/Geocoder","./Widgets/Geocoder/GeocoderViewModel","./Widgets/getElement","./Widgets/HomeButton/HomeButton","./Widgets/HomeButton/HomeButtonViewModel","./Widgets/InfoBox/InfoBox","./Widgets/InfoBox/InfoBoxViewModel","./Widgets/NavigationHelpButton/NavigationHelpButton","./Widgets/NavigationHelpButton/NavigationHelpButtonViewModel","./Widgets/PerformanceWatchdog/PerformanceWatchdog","./Widgets/PerformanceWatchdog/PerformanceWatchdogViewModel","./Widgets/ProjectionPicker/ProjectionPicker","./Widgets/ProjectionPicker/ProjectionPickerViewModel","./Widgets/SceneModePicker/SceneModePicker","./Widgets/SceneModePicker/SceneModePickerViewModel","./Widgets/SelectionIndicator/SelectionIndicator","./Widgets/SelectionIndicator/SelectionIndicatorViewModel","./Widgets/subscribeAndEvaluate","./Widgets/SvgPathBindingHandler","./Widgets/Timeline/Timeline","./Widgets/Timeline/TimelineHighlightRange","./Widgets/Timeline/TimelineTrack","./Widgets/ToggleButtonViewModel","./Widgets/Viewer/Viewer","./Widgets/Viewer/viewerCesium3DTilesInspectorMixin","./Widgets/Viewer/viewerCesiumInspectorMixin","./Widgets/Viewer/viewerDragDropMixin","./Widgets/Viewer/viewerPerformanceWatchdogMixin","./Widgets/VRButton/VRButton","./Widgets/VRButton/VRButtonViewModel","./Workers/createTaskProcessorWorker"],function(e,t,r,i,n,o,a,s,l,u,c,d,h,p,f,m,g,_,v,y,b,C,w,S,T,E,A,x,P,D,O,I,M,R,L,N,k,F,B,U,V,z,q,G,W,H,j,Y,X,Q,Z,K,J,$,ee,te,re,ie,ne,oe,ae,se,le,ue,ce,de,he,pe,fe,me,ge,_e,ve,ye,be,Ce,we,Se,Te,Ee,Ae,xe,Pe,De,Oe,Ie,Me,Re,Le,Ne,ke,Fe,Be,Ue,Ve,ze,qe,Ge,We,He,je,Ye,Xe,Qe,Ze,Ke,Je,$e,et,tt,rt,it,nt,ot,at,st,lt,ut,ct,dt,ht,pt,ft,mt,gt,_t,vt,yt,bt,Ct,wt,St,Tt,Et,At,xt,Pt,Dt,Ot,It,Mt,Rt,Lt,Nt,kt,Ft,Bt,Ut,Vt,zt,qt,Gt,Wt,Ht,jt,Yt,Xt,Qt,Zt,Kt,Jt,$t,er,tr,rr,ir,nr,or,ar,sr,lr,ur,cr,dr,hr,pr,fr,mr,gr,_r,vr,yr,br,Cr,wr,Sr,Tr,Er,Ar,xr,Pr,Dr,Or,Ir,Mr,Rr,Lr,Nr,kr,Fr,Br,Ur,Vr,zr,qr,Gr,Wr,Hr,jr,Yr,Xr,Qr,Zr,Kr,Jr,$r,ei,ti,ri,ii,ni,oi,ai,si,li,ui,ci,di,hi,pi,fi,mi,gi,_i,vi,yi,bi,Ci,wi,Si,Ti,Ei,Ai,xi,Pi,Di,Oi,Ii,Mi,Ri,Li,Ni,ki,Fi,Bi,Ui,Vi,zi,qi,Gi,Wi,Hi,ji,Yi,Xi,Qi,Zi,Ki,Ji,$i,en,tn,rn,nn,on,an,sn,ln,un,cn,dn,hn,pn,fn,mn,gn,_n,vn,yn,bn,Cn,wn,Sn,Tn,En,An,xn,Pn,Dn,On,In,Mn,Rn,Ln,Nn,kn,Fn,Bn,Un,Vn,zn,qn,Gn,Wn,Hn,jn,Yn,Xn,Qn,Zn,Kn,Jn,$n,eo,to,ro,io,no,oo,ao,so,lo,uo,co,ho,po,fo,mo,go,_o,vo,yo,bo,Co,wo,So,To,Eo,Ao,xo,Po,Do,Oo,Io,Mo,Ro,Lo,No,ko,Fo,Bo,Uo,Vo,zo,qo,Go,Wo,Ho,jo,Yo,Xo,Qo,Zo,Ko,Jo,$o,ea,ta,ra,ia,na,oa,aa,sa,la,ua,ca,da,ha,pa,fa,ma,ga,_a,va,ya,ba,Ca,wa,Sa,Ta,Ea,Aa,xa,Pa,Da,Oa,Ia,Ma,Ra,La,Na,ka,Fa,Ba,Ua,Va,za,qa,Ga,Wa,Ha,ja,Ya,Xa,Qa,Za,Ka,Ja,$a,es,ts,rs,is,ns,os,as,ss,ls,us,cs,ds,hs,ps,fs,ms,gs,_s,vs,ys,bs,Cs,ws,Ss,Ts,Es,As,xs,Ps,Ds,Os,Is,Ms,Rs,Ls,Ns,ks,Fs,Bs,Us,Vs,zs,qs,Gs,Ws,Hs,js,Ys,Xs,Qs,Zs,Ks,Js,$s,el,tl,rl,il,nl,ol,al,sl,ll,ul,cl,dl,hl,pl,fl,ml,gl,_l,vl,yl,bl,Cl,wl,Sl,Tl,El,Al,xl,Pl,Dl,Ol,Il,Ml,Rl,Ll,Nl,kl,Fl,Bl,Ul,Vl,zl,ql,Gl,Wl,Hl,jl,Yl,Xl,Ql,Zl,Kl,Jl,$l,eu,tu,ru,iu,nu,ou,au,su,lu,uu,cu,du,hu,pu,fu,mu,gu,_u,vu,yu,bu,Cu,wu,Su,Tu,Eu,Au,xu,Pu,Du,Ou,Iu,Mu,Ru,Lu,Nu,ku,Fu,Bu,Uu,Vu,zu,qu,Gu,Wu,Hu,ju,Yu,Xu,Qu,Zu,Ku,Ju,$u,ec,tc,rc,ic,nc,oc,ac,sc,lc,uc,cc,dc,hc,pc,fc,mc,gc,_c,vc,yc,bc,Cc,wc,Sc,Tc,Ec,Ac,xc,Pc,Dc,Oc,Ic,Mc,Rc,Lc,Nc,kc,Fc,Bc,Uc,Vc,zc,qc,Gc,Wc,Hc,jc,Yc,Xc,Qc,Zc,Kc,Jc,$c,ed,td,rd,id,nd,od,ad,sd,ld,ud,cd,dd,hd,pd,fd,md,gd,_d,vd,yd,bd,Cd,wd,Sd,Td,Ed,Ad,xd,Pd,Dd,Od,Id,Md,Rd,Ld,Nd,kd,Fd,Bd,Ud,Vd,zd,qd,Gd,Wd,Hd,jd,Yd,Xd,Qd,Zd,Kd,Jd,$d,eh,th,rh,ih,nh,oh,ah,sh,lh,uh,ch,dh,hh,ph,fh,mh,gh,_h,vh,yh,bh,Ch,wh,Sh,Th,Eh,Ah,xh,Ph,Dh,Oh,Ih,Mh,Rh,Lh,Nh,kh,Fh,Bh,Uh,Vh,zh,qh,Gh,Wh,Hh,jh,Yh,Xh,Qh,Zh,Kh,Jh,$h,ep,tp,rp,ip,np,op,ap,sp,lp,up,cp,dp,hp,pp,fp,mp,gp,_p,vp,yp,bp,Cp,wp,Sp,Tp,Ep,Ap,xp,Pp,Dp,Op,Ip,Mp,Rp,Lp,Np,kp,Fp,Bp,Up,Vp,zp,qp,Gp,Wp,Hp,jp,Yp,Xp,Qp,Zp,Kp,Jp,$p,ef,tf,rf,nf,of,af,sf,lf,uf,cf,df,hf,pf,ff,mf,gf,_f,vf,yf,bf,Cf,wf,Sf){"use strict";var Tf={VERSION:"1.42",_shaders:{}};return Tf.appendForwardSlash=e,Tf.arrayFill=t,Tf.arrayRemoveDuplicates=r,Tf.arraySlice=i,Tf.AssociativeArray=n,Tf.AttributeCompression=o,Tf.AxisAlignedBoundingBox=a,Tf.barycentricCoordinates=s,Tf.binarySearch=l,Tf.BingMapsApi=u,Tf.BingMapsGeocoderService=c,Tf.BoundingRectangle=d,Tf.BoundingSphere=h,Tf.BoxGeometry=p,Tf.BoxOutlineGeometry=f,Tf.buildModuleUrl=m,Tf.cancelAnimationFrame=g,Tf.Cartesian2=_,Tf.Cartesian3=v,Tf.Cartesian4=y,Tf.Cartographic=b,Tf.CartographicGeocoderService=C,Tf.CatmullRomSpline=w,Tf.CesiumTerrainProvider=S,Tf.Check=T,Tf.CircleGeometry=E,Tf.CircleOutlineGeometry=A,Tf.ClippingPlaneCollection=x,Tf.Clock=P,Tf.ClockRange=D,Tf.ClockStep=O,Tf.clone=I,Tf.Color=M,Tf.ColorGeometryInstanceAttribute=R,Tf.combine=L,Tf.ComponentDatatype=N,Tf.CompressedTextureBuffer=k,Tf.CornerType=F,Tf.CorridorGeometry=B,Tf.CorridorGeometryLibrary=U,Tf.CorridorOutlineGeometry=V,Tf.createGuid=z,Tf.Credit=q,Tf.CubicRealPolynomial=G,Tf.CullingVolume=W,Tf.CylinderGeometry=H,Tf.CylinderGeometryLibrary=j,Tf.CylinderOutlineGeometry=Y,Tf.decodeGoogleEarthEnterpriseData=X,Tf.DefaultProxy=Q,Tf.defaultValue=Z,Tf.defined=K,Tf.defineProperties=J,Tf.deprecationWarning=$,Tf.destroyObject=ee,Tf.DeveloperError=te,Tf.DistanceDisplayCondition=re,Tf.DistanceDisplayConditionGeometryInstanceAttribute=ie,Tf.DoublyLinkedList=ne,Tf.EarthOrientationParameters=oe,Tf.EarthOrientationParametersSample=ae,Tf.EasingFunction=se,Tf.EllipseGeometry=le,Tf.EllipseGeometryLibrary=ue,Tf.EllipseOutlineGeometry=ce,Tf.Ellipsoid=de,Tf.EllipsoidalOccluder=he,Tf.EllipsoidGeodesic=pe,Tf.EllipsoidGeometry=fe,Tf.EllipsoidOutlineGeometry=me,Tf.EllipsoidTangentPlane=ge,Tf.EllipsoidTerrainProvider=_e,Tf.EncodedCartesian3=ve,Tf.Event=ye,Tf.EventHelper=be,Tf.ExtrapolationType=Ce,Tf.FeatureDetection=we,Tf.formatError=Se,Tf.freezeObject=Te,Tf.FrustumGeometry=Ee,Tf.FrustumOutlineGeometry=Ae,Tf.Fullscreen=xe,Tf.GeocoderService=Pe,Tf.GeographicProjection=De,Tf.GeographicTilingScheme=Oe,Tf.Geometry=Ie,Tf.GeometryAttribute=Me,Tf.GeometryAttributes=Re,Tf.GeometryInstance=Le,Tf.GeometryInstanceAttribute=Ne,Tf.GeometryPipeline=ke,Tf.GeometryType=Fe,Tf.getAbsoluteUri=Be,Tf.getBaseUri=Ue,Tf.getExtensionFromUri=Ve,Tf.getFilenameFromUri=ze,Tf.getImagePixels=qe,Tf.getMagic=Ge,Tf.getStringFromTypedArray=We,Tf.getTimestamp=He,Tf.GoogleEarthEnterpriseMetadata=je,Tf.GoogleEarthEnterpriseTerrainData=Ye,Tf.GoogleEarthEnterpriseTerrainProvider=Xe,Tf.GoogleEarthEnterpriseTileInformation=Qe,Tf.GregorianDate=Ze,Tf.HeadingPitchRange=Ke,Tf.HeadingPitchRoll=Je,Tf.Heap=$e,Tf.HeightmapTerrainData=et,Tf.HeightmapTessellator=tt,Tf.HermitePolynomialApproximation=rt,Tf.HermiteSpline=it,Tf.Iau2000Orientation=nt,Tf.Iau2006XysData=ot,Tf.Iau2006XysSample=at,Tf.IauOrientationAxes=st,Tf.IauOrientationParameters=lt,Tf.IndexDatatype=ut,Tf.InterpolationAlgorithm=ct,Tf.Intersect=dt,Tf.Intersections2D=ht,Tf.IntersectionTests=pt,Tf.Interval=ft,Tf.isArray=mt,Tf.isBitSet=gt,Tf.isBlobUri=_t,Tf.isCrossOriginUrl=vt,Tf.isDataUri=yt,Tf.isLeapYear=bt,Tf.Iso8601=Ct,Tf.JulianDate=wt,Tf.KeyboardEventModifier=St,Tf.LagrangePolynomialApproximation=Tt,Tf.LeapSecond=Et,Tf.LinearApproximation=At,Tf.LinearSpline=xt,Tf.loadArrayBuffer=Pt,Tf.loadBlob=Dt,Tf.loadCRN=Ot,Tf.loadImage=It,Tf.loadImageFromTypedArray=Mt,Tf.loadImageViaBlob=Rt,Tf.loadJson=Lt,Tf.loadJsonp=Nt,Tf.loadKTX=kt,Tf.loadText=Ft,Tf.loadWithXhr=Bt,Tf.loadXML=Ut,Tf.ManagedArray=Vt,Tf.MapboxApi=zt,Tf.MapProjection=qt,Tf.Math=Gt,Tf.Matrix2=Wt,Tf.Matrix3=Ht,Tf.Matrix4=jt,Tf.mergeSort=Yt,Tf.NearFarScalar=Xt,Tf.objectToQuery=Qt,Tf.Occluder=Zt,Tf.oneTimeWarning=Kt,Tf.OrientedBoundingBox=Jt,Tf.OrthographicFrustum=$t,Tf.OrthographicOffCenterFrustum=er,Tf.Packable=tr,Tf.PackableForInterpolation=rr,Tf.parseResponseHeaders=ir,Tf.PerspectiveFrustum=nr,Tf.PerspectiveOffCenterFrustum=or,Tf.PinBuilder=ar,Tf.PixelFormat=sr,Tf.Plane=lr,Tf.PlaneGeometry=ur,Tf.PlaneOutlineGeometry=cr,Tf.pointInsideTriangle=dr,Tf.PolygonGeometry=hr,Tf.PolygonGeometryLibrary=pr,Tf.PolygonHierarchy=fr,Tf.PolygonOutlineGeometry=mr,Tf.PolygonPipeline=gr,Tf.PolylineGeometry=_r,Tf.PolylinePipeline=vr,Tf.PolylineVolumeGeometry=yr,Tf.PolylineVolumeGeometryLibrary=br,Tf.PolylineVolumeOutlineGeometry=Cr,Tf.PrimitiveType=wr,Tf.QuadraticRealPolynomial=Sr,Tf.QuantizedMeshTerrainData=Tr,Tf.QuarticRealPolynomial=Er,Tf.Quaternion=Ar,Tf.QuaternionSpline=xr,Tf.queryToObject=Pr,Tf.Queue=Dr,Tf.Ray=Or,Tf.Rectangle=Ir,Tf.RectangleGeometry=Mr,Tf.RectangleGeometryLibrary=Rr,Tf.RectangleOutlineGeometry=Lr,Tf.ReferenceFrame=Nr,Tf.Request=kr,Tf.requestAnimationFrame=Fr,Tf.RequestErrorEvent=Br,Tf.RequestScheduler=Ur,Tf.RequestState=Vr,Tf.RequestType=zr,Tf.Resource=qr,Tf.RuntimeError=Gr,Tf.sampleTerrain=Wr,Tf.sampleTerrainMostDetailed=Hr,Tf.scaleToGeodeticSurface=jr,Tf.ScreenSpaceEventHandler=Yr,Tf.ScreenSpaceEventType=Xr,Tf.ShowGeometryInstanceAttribute=Qr,Tf.Simon1994PlanetaryPositions=Zr,Tf.SimplePolylineGeometry=Kr,Tf.SphereGeometry=Jr,Tf.SphereOutlineGeometry=$r,Tf.Spherical=ei,Tf.Spline=ti,Tf.subdivideArray=ri,Tf.TaskProcessor=ii,Tf.TerrainData=ni,Tf.TerrainEncoding=oi,Tf.TerrainMesh=ai,Tf.TerrainProvider=si,Tf.TerrainQuantization=li,Tf.TileAvailability=ui,Tf.TileProviderError=ci,Tf.TilingScheme=di,Tf.TimeConstants=hi,Tf.TimeInterval=pi,Tf.TimeIntervalCollection=fi,Tf.TimeStandard=mi,Tf.Tipsify=gi,Tf.Transforms=_i,Tf.TranslationRotationScale=vi,Tf.TridiagonalSystemSolver=yi,Tf.TrustedServers=bi,Tf.VertexFormat=Ci,Tf.VideoSynchronizer=wi,Tf.Visibility=Si,Tf.VRTheWorldTerrainProvider=Ti,Tf.WallGeometry=Ei,Tf.WallGeometryLibrary=Ai,Tf.WallOutlineGeometry=xi,Tf.WebGLConstants=Pi,Tf.WebMercatorProjection=Di,Tf.WebMercatorTilingScheme=Oi,Tf.WeightSpline=Ii,Tf.WindingOrder=Mi,Tf.wrapFunction=Ri,Tf.writeTextToCanvas=Li,Tf.BillboardGraphics=Ni,Tf.BillboardVisualizer=ki,Tf.BoundingSphereState=Fi,Tf.BoxGeometryUpdater=Bi,Tf.BoxGraphics=Ui,Tf.CallbackProperty=Vi,Tf.CheckerboardMaterialProperty=zi,Tf.ColorMaterialProperty=qi,Tf.CompositeEntityCollection=Gi,Tf.CompositeMaterialProperty=Wi,Tf.CompositePositionProperty=Hi,Tf.CompositeProperty=ji,Tf.ConstantPositionProperty=Yi,Tf.ConstantProperty=Xi,Tf.CorridorGeometryUpdater=Qi,Tf.CorridorGraphics=Zi,Tf.createMaterialPropertyDescriptor=Ki,Tf.createPropertyDescriptor=Ji,Tf.createRawPropertyDescriptor=$i,Tf.CustomDataSource=en,Tf.CylinderGeometryUpdater=tn,Tf.CylinderGraphics=rn,Tf.CzmlDataSource=nn,Tf.DataSource=on,Tf.DataSourceClock=an,Tf.DataSourceCollection=sn,Tf.DataSourceDisplay=ln,Tf.dynamicGeometryGetBoundingSphere=un,Tf.DynamicGeometryUpdater=cn,Tf.EllipseGeometryUpdater=dn,Tf.EllipseGraphics=hn,Tf.EllipsoidGeometryUpdater=pn,Tf.EllipsoidGraphics=fn,Tf.Entity=mn,Tf.EntityCluster=gn,Tf.EntityCollection=_n,Tf.EntityView=vn,Tf.GeoJsonDataSource=yn,Tf.GeometryUpdater=bn,Tf.GeometryVisualizer=Cn,Tf.GridMaterialProperty=wn,Tf.ImageMaterialProperty=Sn,Tf.KmlCamera=Tn,Tf.KmlDataSource=En,Tf.KmlLookAt=An,Tf.KmlTour=xn,Tf.KmlTourFlyTo=Pn,Tf.KmlTourWait=Dn,Tf.LabelGraphics=On,Tf.LabelVisualizer=In,Tf.MaterialProperty=Mn,Tf.ModelGraphics=Rn,Tf.ModelVisualizer=Ln,Tf.NodeTransformationProperty=Nn,Tf.PathGraphics=kn,Tf.PathVisualizer=Fn,Tf.PlaneGeometryUpdater=Bn,Tf.PlaneGraphics=Un,Tf.PointGraphics=Vn,Tf.PointVisualizer=zn,Tf.PolygonGeometryUpdater=qn,Tf.PolygonGraphics=Gn,Tf.PolylineArrowMaterialProperty=Wn,Tf.PolylineDashMaterialProperty=Hn,Tf.PolylineGeometryUpdater=jn,Tf.PolylineGlowMaterialProperty=Yn,Tf.PolylineGraphics=Xn,Tf.PolylineOutlineMaterialProperty=Qn,Tf.PolylineVolumeGeometryUpdater=Zn,Tf.PolylineVolumeGraphics=Kn,Tf.PositionProperty=Jn,Tf.PositionPropertyArray=$n,Tf.Property=eo,Tf.PropertyArray=to,Tf.PropertyBag=ro,Tf.RectangleGeometryUpdater=io,Tf.RectangleGraphics=no,Tf.ReferenceProperty=oo,Tf.Rotation=ao,Tf.SampledPositionProperty=so,Tf.SampledProperty=lo,Tf.ScaledPositionProperty=uo,Tf.StaticGeometryColorBatch=co,Tf.StaticGeometryPerMaterialBatch=ho,Tf.StaticGroundGeometryColorBatch=po,Tf.StaticOutlineGeometryBatch=fo,Tf.StripeMaterialProperty=mo,Tf.StripeOrientation=go,Tf.TimeIntervalCollectionPositionProperty=_o,Tf.TimeIntervalCollectionProperty=vo,Tf.VelocityOrientationProperty=yo,Tf.VelocityVectorProperty=bo,Tf.Visualizer=Co,Tf.WallGeometryUpdater=wo,Tf.WallGraphics=So,Tf.AutomaticUniforms=To,Tf.Buffer=Eo,Tf.BufferUsage=Ao,Tf.ClearCommand=xo,Tf.ComputeCommand=Po,Tf.ComputeEngine=Do,Tf.Context=Oo,Tf.ContextLimits=Io,Tf.createUniform=Mo,Tf.createUniformArray=Ro,Tf.CubeMap=Lo,Tf.CubeMapFace=No,Tf.DrawCommand=ko,Tf.Framebuffer=Fo,Tf.freezeRenderState=Bo,Tf.loadCubeMap=Uo,Tf.MipmapHint=Vo,Tf.modernizeShader=zo,Tf.Pass=qo,Tf.PassState=Go,Tf.PickFramebuffer=Wo,Tf.PixelDatatype=Ho,Tf.Renderbuffer=jo,Tf.RenderbufferFormat=Yo,Tf.RenderState=Xo,Tf.Sampler=Qo,Tf.ShaderCache=Zo,Tf.ShaderProgram=Ko,Tf.ShaderSource=Jo,Tf.Texture=$o,Tf.TextureMagnificationFilter=ea,Tf.TextureMinificationFilter=ta,Tf.TextureWrap=ra,Tf.UniformState=ia,Tf.VertexArray=na,Tf.VertexArrayFacade=oa,Tf.Appearance=aa,Tf.ArcGisMapServerImageryProvider=sa,Tf.AttributeType=la,Tf.Axis=ua,Tf.Batched3DModel3DTileContent=ca,Tf.BatchTable=da,Tf.Billboard=ha,Tf.BillboardCollection=pa,Tf.BingMapsImageryProvider=fa,Tf.BingMapsStyle=ma,Tf.BlendEquation=ga,Tf.BlendFunction=_a,Tf.BlendingState=va,Tf.BlendOption=ya,Tf.BoxEmitter=ba,Tf.BrdfLutGenerator=Ca,Tf.Camera=wa,Tf.CameraEventAggregator=Sa,Tf.CameraEventType=Ta,Tf.CameraFlightPath=Ea,Tf.Cesium3DTile=Aa,Tf.Cesium3DTileBatchTable=xa,Tf.Cesium3DTileChildrenVisibility=Pa,Tf.Cesium3DTileColorBlendMode=Da,Tf.Cesium3DTileContent=Oa,Tf.Cesium3DTileContentFactory=Ia,Tf.Cesium3DTileContentState=Ma,Tf.Cesium3DTileFeature=Ra,Tf.Cesium3DTileFeatureTable=La,Tf.Cesium3DTileOptimizationHint=Na,Tf.Cesium3DTileOptimizations=ka,Tf.Cesium3DTilePointFeature=Fa,Tf.Cesium3DTileRefine=Ba,Tf.Cesium3DTileset=Ua,Tf.Cesium3DTilesetStatistics=Va,Tf.Cesium3DTilesetTraversal=za,Tf.Cesium3DTileStyle=qa,Tf.Cesium3DTileStyleEngine=Ga,Tf.CesiumIon=Wa,Tf.CesiumIonResource=Ha,Tf.CircleEmitter=ja,Tf.ClassificationModel=Ya,Tf.ClassificationPrimitive=Xa,Tf.ClassificationType=Qa,Tf.ColorBlendMode=Za,Tf.Composite3DTileContent=Ka,Tf.ConditionsExpression=Ja,Tf.ConeEmitter=$a,Tf.createBillboardPointCallback=es,Tf.createOpenStreetMapImageryProvider=ts,Tf.createTangentSpaceDebugPrimitive=rs,Tf.createTileMapServiceImageryProvider=is,Tf.CreditDisplay=ns,Tf.CullFace=os,Tf.DebugAppearance=as,Tf.DebugCameraPrimitive=ss,Tf.DebugModelMatrixPrimitive=ls,Tf.DepthFunction=us,Tf.DepthPlane=cs,Tf.DeviceOrientationCameraController=ds,Tf.DiscardMissingTileImagePolicy=hs,Tf.EllipsoidPrimitive=ps,Tf.EllipsoidSurfaceAppearance=fs,Tf.Empty3DTileContent=ms,Tf.Expression=gs,Tf.ExpressionNodeType=_s,Tf.Fog=vs,Tf.FrameRateMonitor=ys,Tf.FrameState=bs,Tf.FrustumCommands=Cs,Tf.FXAA=ws,Tf.Geometry3DTileContent=Ss,Tf.getBinaryAccessor=Ts,Tf.GetFeatureInfoFormat=Es,Tf.Globe=As,Tf.GlobeDepth=xs,Tf.GlobeSurfaceShaderSet=Ps,Tf.GlobeSurfaceTile=Ds,Tf.GlobeSurfaceTileProvider=Os,Tf.GoogleEarthEnterpriseImageryProvider=Is,Tf.GoogleEarthEnterpriseMapsProvider=Ms,Tf.GridImageryProvider=Rs,Tf.GroundPrimitive=Ls,Tf.HeightReference=Ns,Tf.HorizontalOrigin=ks,Tf.Imagery=Fs,Tf.ImageryLayer=Bs,Tf.ImageryLayerCollection=Us,Tf.ImageryLayerFeatureInfo=Vs,Tf.ImageryProvider=zs,Tf.ImagerySplitDirection=qs,Tf.ImageryState=Gs,Tf.Instanced3DModel3DTileContent=Ws,Tf.InvertClassification=Hs,Tf.JobScheduler=js,Tf.JobType=Ys,Tf.Label=Xs,Tf.LabelCollection=Qs,Tf.LabelStyle=Zs,Tf.MapboxImageryProvider=Ks,Tf.MapMode2D=Js,Tf.Material=$s,Tf.MaterialAppearance=el,Tf.Model=tl,Tf.ModelAnimation=rl,Tf.ModelAnimationCache=il,Tf.ModelAnimationCollection=nl,Tf.ModelAnimationLoop=ol,Tf.ModelAnimationState=al,Tf.ModelInstance=sl,Tf.ModelInstanceCollection=ll,Tf.ModelLoadResources=ul,Tf.ModelMaterial=cl,Tf.ModelMesh=dl,Tf.ModelNode=hl,Tf.ModelUtility=pl,Tf.Moon=fl,Tf.NeverTileDiscardPolicy=ml,Tf.OIT=gl,Tf.Particle=_l,Tf.ParticleBurst=vl,Tf.ParticleEmitter=yl,Tf.ParticleSystem=bl,Tf.PerformanceDisplay=Cl,Tf.PerInstanceColorAppearance=wl,Tf.PickDepth=Sl,Tf.PointCloud3DTileContent=Tl,Tf.PointCloudEyeDomeLighting=El,Tf.PointCloudShading=Al,Tf.PointPrimitive=xl,Tf.PointPrimitiveCollection=Pl,Tf.Polyline=Dl,Tf.PolylineCollection=Ol,Tf.PolylineColorAppearance=Il,Tf.PolylineMaterialAppearance=Ml,Tf.Primitive=Rl,Tf.PrimitiveCollection=Ll,Tf.PrimitivePipeline=Nl,Tf.PrimitiveState=kl,Tf.QuadtreeOccluders=Fl,Tf.QuadtreePrimitive=Bl,Tf.QuadtreeTile=Ul,Tf.QuadtreeTileLoadState=Vl,Tf.QuadtreeTileProvider=zl,Tf.Scene=ql,Tf.SceneMode=Gl,Tf.SceneTransforms=Wl,Tf.SceneTransitioner=Hl,Tf.ScreenSpaceCameraController=jl,Tf.ShadowMap=Yl,Tf.ShadowMapShader=Xl,Tf.ShadowMode=Ql,Tf.SingleTileImageryProvider=Zl,Tf.SkyAtmosphere=Kl,Tf.SkyBox=Jl,Tf.SphereEmitter=$l,Tf.StencilFunction=eu,Tf.StencilOperation=tu,Tf.StyleExpression=ru,Tf.Sun=iu,Tf.SunPostProcess=nu,Tf.TerrainState=ou,Tf.TextureAtlas=au,Tf.TileBoundingRegion=su,Tf.TileBoundingSphere=lu,Tf.TileBoundingVolume=uu,Tf.TileCoordinatesImageryProvider=cu,Tf.TileDiscardPolicy=du,Tf.TileImagery=hu,Tf.TileOrientedBoundingBox=pu,Tf.TileReplacementQueue=fu,Tf.Tileset3DTileContent=mu,Tf.TileState=gu,Tf.TileTerrain=_u,Tf.TimeDynamicImagery=vu,Tf.TweenCollection=yu,Tf.UrlTemplateImageryProvider=bu,Tf.Vector3DTileBatch=Cu,Tf.Vector3DTileContent=wu,Tf.Vector3DTileGeometry=Su,Tf.Vector3DTilePoints=Tu,Tf.Vector3DTilePolygons=Eu,Tf.Vector3DTilePolylines=Au,Tf.Vector3DTilePrimitive=xu,Tf.VerticalOrigin=Pu,Tf.ViewportQuad=Du,Tf.WebMapServiceImageryProvider=Ou,Tf.WebMapTileServiceImageryProvider=Iu,Tf._shaders.AdjustTranslucentFS=Mu,Tf._shaders.AllMaterialAppearanceFS=Ru,Tf._shaders.AllMaterialAppearanceVS=Lu,Tf._shaders.BasicMaterialAppearanceFS=Nu,Tf._shaders.BasicMaterialAppearanceVS=ku,Tf._shaders.EllipsoidSurfaceAppearanceFS=Fu,Tf._shaders.EllipsoidSurfaceAppearanceVS=Bu,Tf._shaders.PerInstanceColorAppearanceFS=Uu,Tf._shaders.PerInstanceColorAppearanceVS=Vu,Tf._shaders.PerInstanceFlatColorAppearanceFS=zu,Tf._shaders.PerInstanceFlatColorAppearanceVS=qu,Tf._shaders.PolylineColorAppearanceVS=Gu,Tf._shaders.PolylineMaterialAppearanceVS=Wu,Tf._shaders.TexturedMaterialAppearanceFS=Hu,Tf._shaders.TexturedMaterialAppearanceVS=ju,Tf._shaders.BillboardCollectionFS=Yu,Tf._shaders.BillboardCollectionVS=Xu,Tf._shaders.BrdfLutGeneratorFS=Qu,Tf._shaders.degreesPerRadian=Zu,Tf._shaders.depthRange=Ku,Tf._shaders.epsilon1=Ju,Tf._shaders.epsilon2=$u,Tf._shaders.epsilon3=ec,Tf._shaders.epsilon4=tc,Tf._shaders.epsilon5=rc,Tf._shaders.epsilon6=ic,Tf._shaders.epsilon7=nc,Tf._shaders.infinity=oc,Tf._shaders.maxClippingPlanes=ac,Tf._shaders.oneOverPi=sc,Tf._shaders.oneOverTwoPi=lc,Tf._shaders.passCesium3DTile=uc,Tf._shaders.passCesium3DTileClassification=cc,Tf._shaders.passCesium3DTileClassificationIgnoreShow=dc,Tf._shaders.passClassification=hc,Tf._shaders.passCompute=pc,Tf._shaders.passEnvironment=fc,Tf._shaders.passGlobe=mc,Tf._shaders.passOpaque=gc,Tf._shaders.passOverlay=_c,Tf._shaders.passTerrainClassification=vc,Tf._shaders.passTranslucent=yc,Tf._shaders.pi=bc,Tf._shaders.piOverFour=Cc,Tf._shaders.piOverSix=wc,Tf._shaders.piOverThree=Sc,Tf._shaders.piOverTwo=Tc,Tf._shaders.radiansPerDegree=Ec,Tf._shaders.sceneMode2D=Ac,Tf._shaders.sceneMode3D=xc,Tf._shaders.sceneModeColumbusView=Pc,Tf._shaders.sceneModeMorphing=Dc,Tf._shaders.solarRadius=Oc,Tf._shaders.threePiOver2=Ic,Tf._shaders.twoPi=Mc,Tf._shaders.webMercatorMaxLatitude=Rc,Tf._shaders.CzmBuiltins=Lc,Tf._shaders.alphaWeight=Nc,Tf._shaders.antialias=kc,Tf._shaders.cascadeColor=Fc,Tf._shaders.cascadeDistance=Bc,Tf._shaders.cascadeMatrix=Uc,Tf._shaders.cascadeWeights=Vc,Tf._shaders.columbusViewMorph=zc,Tf._shaders.computePosition=qc,Tf._shaders.cosineAndSine=Gc,Tf._shaders.decompressTextureCoordinates=Wc,Tf._shaders.depthClampFarPlane=Hc,Tf._shaders.discardIfClippedWithIntersect=jc,Tf._shaders.discardIfClippedWithUnion=Yc,Tf._shaders.eastNorthUpToEyeCoordinates=Xc,Tf._shaders.ellipsoidContainsPoint=Qc,Tf._shaders.ellipsoidNew=Zc,Tf._shaders.ellipsoidWgs84TextureCoordinates=Kc,Tf._shaders.equalsEpsilon=Jc,Tf._shaders.eyeOffset=$c,Tf._shaders.eyeToWindowCoordinates=ed,Tf._shaders.fog=td,Tf._shaders.geodeticSurfaceNormal=rd,Tf._shaders.getDefaultMaterial=id,Tf._shaders.getLambertDiffuse=nd,Tf._shaders.getSpecular=od,Tf._shaders.getWaterNoise=ad,Tf._shaders.getWgs84EllipsoidEC=sd,Tf._shaders.HSBToRGB=ld,Tf._shaders.HSLToRGB=ud,Tf._shaders.hue=cd,Tf._shaders.isEmpty=dd,Tf._shaders.isFull=hd,Tf._shaders.latitudeToWebMercatorFraction=pd,Tf._shaders.luminance=fd,Tf._shaders.metersPerPixel=md,Tf._shaders.modelToWindowCoordinates=gd,Tf._shaders.multiplyWithColorBalance=_d,Tf._shaders.nearFarScalar=vd,Tf._shaders.octDecode=yd,Tf._shaders.packDepth=bd,Tf._shaders.phong=Cd,Tf._shaders.pointAlongRay=wd,Tf._shaders.rayEllipsoidIntersectionInterval=Sd,Tf._shaders.RGBToHSB=Td,Tf._shaders.RGBToHSL=Ed,Tf._shaders.RGBToXYZ=Ad,Tf._shaders.saturation=xd,Tf._shaders.shadowDepthCompare=Pd,Tf._shaders.shadowVisibility=Dd,Tf._shaders.signNotZero=Od,Tf._shaders.tangentToEyeSpaceMatrix=Id,Tf._shaders.translateRelativeToEye=Md,Tf._shaders.translucentPhong=Rd,Tf._shaders.transpose=Ld,Tf._shaders.unpackDepth=Nd,Tf._shaders.windowToEyeCoordinates=kd,Tf._shaders.writeDepthClampedToFarPlane=Fd,Tf._shaders.XYZToRGB=Bd,Tf._shaders.depthRangeStruct=Ud,Tf._shaders.ellipsoid=Vd,Tf._shaders.material=zd,Tf._shaders.materialInput=qd,Tf._shaders.ray=Gd,Tf._shaders.raySegment=Wd,Tf._shaders.shadowParameters=Hd,Tf._shaders.CompositeOITFS=jd,Tf._shaders.DepthPlaneFS=Yd,Tf._shaders.DepthPlaneVS=Xd,Tf._shaders.EllipsoidFS=Qd,Tf._shaders.EllipsoidVS=Zd,Tf._shaders.GlobeFS=Kd,Tf._shaders.GlobeVS=Jd,Tf._shaders.GroundAtmosphere=$d,Tf._shaders.BumpMapMaterial=eh,Tf._shaders.CheckerboardMaterial=th,Tf._shaders.DotMaterial=rh,Tf._shaders.ElevationContourMaterial=ih,Tf._shaders.ElevationRampMaterial=nh,Tf._shaders.FadeMaterial=oh,Tf._shaders.GridMaterial=ah,Tf._shaders.NormalMapMaterial=sh,Tf._shaders.PolylineArrowMaterial=lh,Tf._shaders.PolylineDashMaterial=uh,Tf._shaders.PolylineGlowMaterial=ch,Tf._shaders.PolylineOutlineMaterial=dh,Tf._shaders.RimLightingMaterial=hh,Tf._shaders.SlopeRampMaterial=ph,Tf._shaders.StripeMaterial=fh,Tf._shaders.Water=mh,Tf._shaders.PointPrimitiveCollectionFS=gh,Tf._shaders.PointPrimitiveCollectionVS=_h,Tf._shaders.PolylineCommon=vh,Tf._shaders.PolylineFS=yh,Tf._shaders.PolylineVS=bh,Tf._shaders.AdditiveBlend=Ch,Tf._shaders.BrightPass=wh,Tf._shaders.FXAA=Sh,Tf._shaders.GaussianBlur1D=Th,Tf._shaders.PassThrough=Eh,Tf._shaders.PointCloudEyeDomeLighting=Ah,Tf._shaders.ReprojectWebMercatorFS=xh,Tf._shaders.ReprojectWebMercatorVS=Ph,Tf._shaders.ShadowVolumeFS=Dh,Tf._shaders.ShadowVolumeVS=Oh,Tf._shaders.SkyAtmosphereFS=Ih,Tf._shaders.SkyAtmosphereVS=Mh,Tf._shaders.SkyBoxFS=Rh,Tf._shaders.SkyBoxVS=Lh,Tf._shaders.SunFS=Nh,Tf._shaders.SunTextureFS=kh,Tf._shaders.SunVS=Fh,Tf._shaders.Vector3DTilePolylinesVS=Bh,Tf._shaders.ViewportQuadFS=Uh,Tf._shaders.ViewportQuadVS=Vh,Tf.Autolinker=zh,Tf.crunch=qh,Tf["earcut-2.1.1"]=Gh,Tf.addDefaults=Wh,Tf.addExtensionsRequired=Hh,Tf.addExtensionsUsed=jh,Tf.addPipelineExtras=Yh,Tf.addToArray=Xh,Tf.byteLengthForComponentType=Qh,Tf.findAccessorMinMax=Zh,Tf.ForEach=Kh,Tf.getAccessorByteStride=Jh,Tf.getJointCountForMaterials=$h,Tf.glslTypeToWebGLConstant=ep,Tf.numberOfComponentsForType=tp,Tf.parseBinaryGltf=rp,Tf.processModelMaterialsCommon=ip,Tf.processPbrMetallicRoughness=np,Tf.removeExtensionsRequired=op,Tf.removeExtensionsUsed=ap,Tf.removePipelineExtras=sp,Tf.techniqueParameterForSemantic=lp,Tf.updateVersion=up,Tf.webGLConstantToGlslType=cp,Tf["google-earth-dbroot-parser"]=dp,Tf.jsep=hp,Tf.kdbush=pp,Tf["knockout-3.4.2"]=fp,Tf["knockout-es5"]=mp,Tf.knockout=gp,Tf.measureText=_p,Tf["mersenne-twister"]=vp,Tf.NoSleep=yp,Tf.pako_inflate=bp,Tf["protobuf-minimal"]=Cp,Tf.FXAA3_11=wp,Tf.sprintf=Sp,Tf.topojson=Tp,Tf.Tween=Ep,Tf.Uri=Ap,Tf.when=xp,Tf.zip=Pp,Tf.Animation=Dp,Tf.AnimationViewModel=Op,Tf.BaseLayerPicker=Ip,Tf.BaseLayerPickerViewModel=Mp,Tf.createDefaultImageryProviderViewModels=Rp,Tf.createDefaultTerrainProviderViewModels=Lp,Tf.ProviderViewModel=Np,Tf.Cesium3DTilesInspector=kp,Tf.Cesium3DTilesInspectorViewModel=Fp,Tf.CesiumInspector=Bp,Tf.CesiumInspectorViewModel=Up,Tf.CesiumWidget=Vp,Tf.ClockViewModel=zp,Tf.Command=qp,Tf.createCommand=Gp,Tf.FullscreenButton=Wp,Tf.FullscreenButtonViewModel=Hp,Tf.Geocoder=jp,Tf.GeocoderViewModel=Yp,Tf.getElement=Xp,Tf.HomeButton=Qp,Tf.HomeButtonViewModel=Zp,Tf.InfoBox=Kp,Tf.InfoBoxViewModel=Jp,Tf.NavigationHelpButton=$p,Tf.NavigationHelpButtonViewModel=ef,Tf.PerformanceWatchdog=tf,Tf.PerformanceWatchdogViewModel=rf,Tf.ProjectionPicker=nf,Tf.ProjectionPickerViewModel=of,Tf.SceneModePicker=af,Tf.SceneModePickerViewModel=sf,Tf.SelectionIndicator=lf,Tf.SelectionIndicatorViewModel=uf,Tf.subscribeAndEvaluate=cf,Tf.SvgPathBindingHandler=df,Tf.Timeline=hf,Tf.TimelineHighlightRange=pf,Tf.TimelineTrack=ff,Tf.ToggleButtonViewModel=mf,Tf.Viewer=gf,Tf.viewerCesium3DTilesInspectorMixin=_f,Tf.viewerCesiumInspectorMixin=vf,Tf.viewerDragDropMixin=yf,Tf.viewerPerformanceWatchdogMixin=bf,Tf.VRButton=Cf,Tf.VRButtonViewModel=wf,Tf.createTaskProcessorWorker=Sf,Tf}),require(["Cesium"],function(e){"use strict";("undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Cesium=e},void 0,!0)}();
